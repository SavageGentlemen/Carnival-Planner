(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var EP=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Pb(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Ab={exports:{}},Af={},Nb={exports:{}},Fe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zc=Symbol.for("react.element"),TP=Symbol.for("react.portal"),IP=Symbol.for("react.fragment"),kP=Symbol.for("react.strict_mode"),SP=Symbol.for("react.profiler"),PP=Symbol.for("react.provider"),AP=Symbol.for("react.context"),NP=Symbol.for("react.forward_ref"),CP=Symbol.for("react.suspense"),RP=Symbol.for("react.memo"),jP=Symbol.for("react.lazy"),s0=Symbol.iterator;function LP(t){return t===null||typeof t!="object"?null:(t=s0&&t[s0]||t["@@iterator"],typeof t=="function"?t:null)}var Cb={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Rb=Object.assign,jb={};function Ul(t,e,n){this.props=t,this.context=e,this.refs=jb,this.updater=n||Cb}Ul.prototype.isReactComponent={};Ul.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ul.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Lb(){}Lb.prototype=Ul.prototype;function oy(t,e,n){this.props=t,this.context=e,this.refs=jb,this.updater=n||Cb}var ay=oy.prototype=new Lb;ay.constructor=oy;Rb(ay,Ul.prototype);ay.isPureReactComponent=!0;var o0=Array.isArray,Db=Object.prototype.hasOwnProperty,ly={current:null},Mb={key:!0,ref:!0,__self:!0,__source:!0};function Ob(t,e,n){var r,i={},o=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(o=""+e.key),e)Db.call(e,r)&&!Mb.hasOwnProperty(r)&&(i[r]=e[r]);var c=arguments.length-2;if(c===1)i.children=n;else if(1<c){for(var h=Array(c),p=0;p<c;p++)h[p]=arguments[p+2];i.children=h}if(t&&t.defaultProps)for(r in c=t.defaultProps,c)i[r]===void 0&&(i[r]=c[r]);return{$$typeof:zc,type:t,key:o,ref:a,props:i,_owner:ly.current}}function DP(t,e){return{$$typeof:zc,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function uy(t){return typeof t=="object"&&t!==null&&t.$$typeof===zc}function MP(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var a0=/\/+/g;function Mp(t,e){return typeof t=="object"&&t!==null&&t.key!=null?MP(""+t.key):e.toString(36)}function nh(t,e,n,r,i){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(o){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case zc:case TP:a=!0}}if(a)return a=t,i=i(a),t=r===""?"."+Mp(a,0):r,o0(i)?(n="",t!=null&&(n=t.replace(a0,"$&/")+"/"),nh(i,e,n,"",function(p){return p})):i!=null&&(uy(i)&&(i=DP(i,n+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(a0,"$&/")+"/")+t)),e.push(i)),1;if(a=0,r=r===""?".":r+":",o0(t))for(var c=0;c<t.length;c++){o=t[c];var h=r+Mp(o,c);a+=nh(o,e,n,h,i)}else if(h=LP(t),typeof h=="function")for(t=h.call(t),c=0;!(o=t.next()).done;)o=o.value,h=r+Mp(o,c++),a+=nh(o,e,n,h,i);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function kd(t,e,n){if(t==null)return t;var r=[],i=0;return nh(t,r,"","",function(o){return e.call(n,o,i++)}),r}function OP(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var In={current:null},rh={transition:null},VP={ReactCurrentDispatcher:In,ReactCurrentBatchConfig:rh,ReactCurrentOwner:ly};function Vb(){throw Error("act(...) is not supported in production builds of React.")}Fe.Children={map:kd,forEach:function(t,e,n){kd(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return kd(t,function(){e++}),e},toArray:function(t){return kd(t,function(e){return e})||[]},only:function(t){if(!uy(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Fe.Component=Ul;Fe.Fragment=IP;Fe.Profiler=SP;Fe.PureComponent=oy;Fe.StrictMode=kP;Fe.Suspense=CP;Fe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=VP;Fe.act=Vb;Fe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Rb({},t.props),i=t.key,o=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,a=ly.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(h in e)Db.call(e,h)&&!Mb.hasOwnProperty(h)&&(r[h]=e[h]===void 0&&c!==void 0?c[h]:e[h])}var h=arguments.length-2;if(h===1)r.children=n;else if(1<h){c=Array(h);for(var p=0;p<h;p++)c[p]=arguments[p+2];r.children=c}return{$$typeof:zc,type:t.type,key:i,ref:o,props:r,_owner:a}};Fe.createContext=function(t){return t={$$typeof:AP,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:PP,_context:t},t.Consumer=t};Fe.createElement=Ob;Fe.createFactory=function(t){var e=Ob.bind(null,t);return e.type=t,e};Fe.createRef=function(){return{current:null}};Fe.forwardRef=function(t){return{$$typeof:NP,render:t}};Fe.isValidElement=uy;Fe.lazy=function(t){return{$$typeof:jP,_payload:{_status:-1,_result:t},_init:OP}};Fe.memo=function(t,e){return{$$typeof:RP,type:t,compare:e===void 0?null:e}};Fe.startTransition=function(t){var e=rh.transition;rh.transition={};try{t()}finally{rh.transition=e}};Fe.unstable_act=Vb;Fe.useCallback=function(t,e){return In.current.useCallback(t,e)};Fe.useContext=function(t){return In.current.useContext(t)};Fe.useDebugValue=function(){};Fe.useDeferredValue=function(t){return In.current.useDeferredValue(t)};Fe.useEffect=function(t,e){return In.current.useEffect(t,e)};Fe.useId=function(){return In.current.useId()};Fe.useImperativeHandle=function(t,e,n){return In.current.useImperativeHandle(t,e,n)};Fe.useInsertionEffect=function(t,e){return In.current.useInsertionEffect(t,e)};Fe.useLayoutEffect=function(t,e){return In.current.useLayoutEffect(t,e)};Fe.useMemo=function(t,e){return In.current.useMemo(t,e)};Fe.useReducer=function(t,e,n){return In.current.useReducer(t,e,n)};Fe.useRef=function(t){return In.current.useRef(t)};Fe.useState=function(t){return In.current.useState(t)};Fe.useSyncExternalStore=function(t,e,n){return In.current.useSyncExternalStore(t,e,n)};Fe.useTransition=function(){return In.current.useTransition()};Fe.version="18.3.1";Nb.exports=Fe;var B=Nb.exports;const Nh=Pb(B);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FP=B,UP=Symbol.for("react.element"),BP=Symbol.for("react.fragment"),zP=Object.prototype.hasOwnProperty,qP=FP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,$P={key:!0,ref:!0,__self:!0,__source:!0};function Fb(t,e,n){var r,i={},o=null,a=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)zP.call(e,r)&&!$P.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:UP,type:t,key:o,ref:a,props:i,_owner:qP.current}}Af.Fragment=BP;Af.jsx=Fb;Af.jsxs=Fb;Ab.exports=Af;var u=Ab.exports,Nm={},Ub={exports:{}},ir={},Bb={exports:{}},zb={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(G,se){var X=G.length;G.push(se);e:for(;0<X;){var ue=X-1>>>1,de=G[ue];if(0<i(de,se))G[ue]=se,G[X]=de,X=ue;else break e}}function n(G){return G.length===0?null:G[0]}function r(G){if(G.length===0)return null;var se=G[0],X=G.pop();if(X!==se){G[0]=X;e:for(var ue=0,de=G.length,ve=de>>>1;ue<ve;){var Te=2*(ue+1)-1,xe=G[Te],ge=Te+1,Je=G[ge];if(0>i(xe,X))ge<de&&0>i(Je,xe)?(G[ue]=Je,G[ge]=X,ue=ge):(G[ue]=xe,G[Te]=X,ue=Te);else if(ge<de&&0>i(Je,X))G[ue]=Je,G[ge]=X,ue=ge;else break e}}return se}function i(G,se){var X=G.sortIndex-se.sortIndex;return X!==0?X:G.id-se.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,c=a.now();t.unstable_now=function(){return a.now()-c}}var h=[],p=[],y=1,v=null,w=3,S=!1,N=!1,A=!1,U=typeof setTimeout=="function"?setTimeout:null,j=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function R(G){for(var se=n(p);se!==null;){if(se.callback===null)r(p);else if(se.startTime<=G)r(p),se.sortIndex=se.expirationTime,e(h,se);else break;se=n(p)}}function z(G){if(A=!1,R(G),!N)if(n(h)!==null)N=!0,De(K);else{var se=n(p);se!==null&&ut(z,se.startTime-G)}}function K(G,se){N=!1,A&&(A=!1,j(b),b=-1),S=!0;var X=w;try{for(R(se),v=n(h);v!==null&&(!(v.expirationTime>se)||G&&!O());){var ue=v.callback;if(typeof ue=="function"){v.callback=null,w=v.priorityLevel;var de=ue(v.expirationTime<=se);se=t.unstable_now(),typeof de=="function"?v.callback=de:v===n(h)&&r(h),R(se)}else r(h);v=n(h)}if(v!==null)var ve=!0;else{var Te=n(p);Te!==null&&ut(z,Te.startTime-se),ve=!1}return ve}finally{v=null,w=X,S=!1}}var H=!1,T=null,b=-1,C=5,P=-1;function O(){return!(t.unstable_now()-P<C)}function F(){if(T!==null){var G=t.unstable_now();P=G;var se=!0;try{se=T(!0,G)}finally{se?M():(H=!1,T=null)}}else H=!1}var M;if(typeof k=="function")M=function(){k(F)};else if(typeof MessageChannel<"u"){var be=new MessageChannel,Re=be.port2;be.port1.onmessage=F,M=function(){Re.postMessage(null)}}else M=function(){U(F,0)};function De(G){T=G,H||(H=!0,M())}function ut(G,se){b=U(function(){G(t.unstable_now())},se)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(G){G.callback=null},t.unstable_continueExecution=function(){N||S||(N=!0,De(K))},t.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<G?Math.floor(1e3/G):5},t.unstable_getCurrentPriorityLevel=function(){return w},t.unstable_getFirstCallbackNode=function(){return n(h)},t.unstable_next=function(G){switch(w){case 1:case 2:case 3:var se=3;break;default:se=w}var X=w;w=se;try{return G()}finally{w=X}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(G,se){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var X=w;w=G;try{return se()}finally{w=X}},t.unstable_scheduleCallback=function(G,se,X){var ue=t.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?ue+X:ue):X=ue,G){case 1:var de=-1;break;case 2:de=250;break;case 5:de=1073741823;break;case 4:de=1e4;break;default:de=5e3}return de=X+de,G={id:y++,callback:se,priorityLevel:G,startTime:X,expirationTime:de,sortIndex:-1},X>ue?(G.sortIndex=X,e(p,G),n(h)===null&&G===n(p)&&(A?(j(b),b=-1):A=!0,ut(z,X-ue))):(G.sortIndex=de,e(h,G),N||S||(N=!0,De(K))),G},t.unstable_shouldYield=O,t.unstable_wrapCallback=function(G){var se=w;return function(){var X=w;w=se;try{return G.apply(this,arguments)}finally{w=X}}}})(zb);Bb.exports=zb;var HP=Bb.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var WP=B,tr=HP;function re(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var qb=new Set,ac={};function sa(t,e){_l(t,e),_l(t+"Capture",e)}function _l(t,e){for(ac[t]=e,t=0;t<e.length;t++)qb.add(e[t])}var $i=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Cm=Object.prototype.hasOwnProperty,GP=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,l0={},u0={};function KP(t){return Cm.call(u0,t)?!0:Cm.call(l0,t)?!1:GP.test(t)?u0[t]=!0:(l0[t]=!0,!1)}function ZP(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function QP(t,e,n,r){if(e===null||typeof e>"u"||ZP(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function kn(t,e,n,r,i,o,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=a}var nn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){nn[t]=new kn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];nn[e]=new kn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){nn[t]=new kn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){nn[t]=new kn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){nn[t]=new kn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){nn[t]=new kn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){nn[t]=new kn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){nn[t]=new kn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){nn[t]=new kn(t,5,!1,t.toLowerCase(),null,!1,!1)});var cy=/[\-:]([a-z])/g;function dy(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(cy,dy);nn[e]=new kn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(cy,dy);nn[e]=new kn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(cy,dy);nn[e]=new kn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){nn[t]=new kn(t,1,!1,t.toLowerCase(),null,!1,!1)});nn.xlinkHref=new kn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){nn[t]=new kn(t,1,!1,t.toLowerCase(),null,!0,!0)});function hy(t,e,n,r){var i=nn.hasOwnProperty(e)?nn[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(QP(e,n,i,r)&&(n=null),r||i===null?KP(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Ji=WP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Sd=Symbol.for("react.element"),Ka=Symbol.for("react.portal"),Za=Symbol.for("react.fragment"),fy=Symbol.for("react.strict_mode"),Rm=Symbol.for("react.profiler"),$b=Symbol.for("react.provider"),Hb=Symbol.for("react.context"),py=Symbol.for("react.forward_ref"),jm=Symbol.for("react.suspense"),Lm=Symbol.for("react.suspense_list"),my=Symbol.for("react.memo"),ks=Symbol.for("react.lazy"),Wb=Symbol.for("react.offscreen"),c0=Symbol.iterator;function gu(t){return t===null||typeof t!="object"?null:(t=c0&&t[c0]||t["@@iterator"],typeof t=="function"?t:null)}var kt=Object.assign,Op;function ju(t){if(Op===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Op=e&&e[1]||""}return`
`+Op+t}var Vp=!1;function Fp(t,e){if(!t||Vp)return"";Vp=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(p){var r=p}Reflect.construct(t,[],e)}else{try{e.call()}catch(p){r=p}t.call(e.prototype)}else{try{throw Error()}catch(p){r=p}t()}}catch(p){if(p&&r&&typeof p.stack=="string"){for(var i=p.stack.split(`
`),o=r.stack.split(`
`),a=i.length-1,c=o.length-1;1<=a&&0<=c&&i[a]!==o[c];)c--;for(;1<=a&&0<=c;a--,c--)if(i[a]!==o[c]){if(a!==1||c!==1)do if(a--,c--,0>c||i[a]!==o[c]){var h=`
`+i[a].replace(" at new "," at ");return t.displayName&&h.includes("<anonymous>")&&(h=h.replace("<anonymous>",t.displayName)),h}while(1<=a&&0<=c);break}}}finally{Vp=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?ju(t):""}function YP(t){switch(t.tag){case 5:return ju(t.type);case 16:return ju("Lazy");case 13:return ju("Suspense");case 19:return ju("SuspenseList");case 0:case 2:case 15:return t=Fp(t.type,!1),t;case 11:return t=Fp(t.type.render,!1),t;case 1:return t=Fp(t.type,!0),t;default:return""}}function Dm(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Za:return"Fragment";case Ka:return"Portal";case Rm:return"Profiler";case fy:return"StrictMode";case jm:return"Suspense";case Lm:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Hb:return(t.displayName||"Context")+".Consumer";case $b:return(t._context.displayName||"Context")+".Provider";case py:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case my:return e=t.displayName||null,e!==null?e:Dm(t.type)||"Memo";case ks:e=t._payload,t=t._init;try{return Dm(t(e))}catch{}}return null}function JP(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Dm(e);case 8:return e===fy?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Js(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Gb(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function XP(t){var e=Gb(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){r=""+a,o.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Pd(t){t._valueTracker||(t._valueTracker=XP(t))}function Kb(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Gb(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Ch(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Mm(t,e){var n=e.checked;return kt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function d0(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Js(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Zb(t,e){e=e.checked,e!=null&&hy(t,"checked",e,!1)}function Om(t,e){Zb(t,e);var n=Js(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Vm(t,e.type,n):e.hasOwnProperty("defaultValue")&&Vm(t,e.type,Js(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function h0(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Vm(t,e,n){(e!=="number"||Ch(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Lu=Array.isArray;function al(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Js(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Fm(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(re(91));return kt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function f0(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(re(92));if(Lu(n)){if(1<n.length)throw Error(re(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Js(n)}}function Qb(t,e){var n=Js(e.value),r=Js(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function p0(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Yb(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Um(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Yb(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ad,Jb=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ad=Ad||document.createElement("div"),Ad.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ad.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function lc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var $u={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},eA=["Webkit","ms","Moz","O"];Object.keys($u).forEach(function(t){eA.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),$u[e]=$u[t]})});function Xb(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||$u.hasOwnProperty(t)&&$u[t]?(""+e).trim():e+"px"}function eE(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=Xb(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var tA=kt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Bm(t,e){if(e){if(tA[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(re(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(re(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(re(61))}if(e.style!=null&&typeof e.style!="object")throw Error(re(62))}}function zm(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var qm=null;function gy(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var $m=null,ll=null,ul=null;function m0(t){if(t=Hc(t)){if(typeof $m!="function")throw Error(re(280));var e=t.stateNode;e&&(e=Lf(e),$m(t.stateNode,t.type,e))}}function tE(t){ll?ul?ul.push(t):ul=[t]:ll=t}function nE(){if(ll){var t=ll,e=ul;if(ul=ll=null,m0(t),e)for(t=0;t<e.length;t++)m0(e[t])}}function rE(t,e){return t(e)}function iE(){}var Up=!1;function sE(t,e,n){if(Up)return t(e,n);Up=!0;try{return rE(t,e,n)}finally{Up=!1,(ll!==null||ul!==null)&&(iE(),nE())}}function uc(t,e){var n=t.stateNode;if(n===null)return null;var r=Lf(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(re(231,e,typeof n));return n}var Hm=!1;if($i)try{var yu={};Object.defineProperty(yu,"passive",{get:function(){Hm=!0}}),window.addEventListener("test",yu,yu),window.removeEventListener("test",yu,yu)}catch{Hm=!1}function nA(t,e,n,r,i,o,a,c,h){var p=Array.prototype.slice.call(arguments,3);try{e.apply(n,p)}catch(y){this.onError(y)}}var Hu=!1,Rh=null,jh=!1,Wm=null,rA={onError:function(t){Hu=!0,Rh=t}};function iA(t,e,n,r,i,o,a,c,h){Hu=!1,Rh=null,nA.apply(rA,arguments)}function sA(t,e,n,r,i,o,a,c,h){if(iA.apply(this,arguments),Hu){if(Hu){var p=Rh;Hu=!1,Rh=null}else throw Error(re(198));jh||(jh=!0,Wm=p)}}function oa(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function oE(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function g0(t){if(oa(t)!==t)throw Error(re(188))}function oA(t){var e=t.alternate;if(!e){if(e=oa(t),e===null)throw Error(re(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return g0(i),t;if(o===r)return g0(i),e;o=o.sibling}throw Error(re(188))}if(n.return!==r.return)n=i,r=o;else{for(var a=!1,c=i.child;c;){if(c===n){a=!0,n=i,r=o;break}if(c===r){a=!0,r=i,n=o;break}c=c.sibling}if(!a){for(c=o.child;c;){if(c===n){a=!0,n=o,r=i;break}if(c===r){a=!0,r=o,n=i;break}c=c.sibling}if(!a)throw Error(re(189))}}if(n.alternate!==r)throw Error(re(190))}if(n.tag!==3)throw Error(re(188));return n.stateNode.current===n?t:e}function aE(t){return t=oA(t),t!==null?lE(t):null}function lE(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=lE(t);if(e!==null)return e;t=t.sibling}return null}var uE=tr.unstable_scheduleCallback,y0=tr.unstable_cancelCallback,aA=tr.unstable_shouldYield,lA=tr.unstable_requestPaint,Lt=tr.unstable_now,uA=tr.unstable_getCurrentPriorityLevel,yy=tr.unstable_ImmediatePriority,cE=tr.unstable_UserBlockingPriority,Lh=tr.unstable_NormalPriority,cA=tr.unstable_LowPriority,dE=tr.unstable_IdlePriority,Nf=null,di=null;function dA(t){if(di&&typeof di.onCommitFiberRoot=="function")try{di.onCommitFiberRoot(Nf,t,void 0,(t.current.flags&128)===128)}catch{}}var Ur=Math.clz32?Math.clz32:pA,hA=Math.log,fA=Math.LN2;function pA(t){return t>>>=0,t===0?32:31-(hA(t)/fA|0)|0}var Nd=64,Cd=4194304;function Du(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Dh(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,o=t.pingedLanes,a=n&268435455;if(a!==0){var c=a&~i;c!==0?r=Du(c):(o&=a,o!==0&&(r=Du(o)))}else a=n&~i,a!==0?r=Du(a):o!==0&&(r=Du(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,o=e&-e,i>=o||i===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Ur(e),i=1<<n,r|=t[n],e&=~i;return r}function mA(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function gA(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,o=t.pendingLanes;0<o;){var a=31-Ur(o),c=1<<a,h=i[a];h===-1?(!(c&n)||c&r)&&(i[a]=mA(c,e)):h<=e&&(t.expiredLanes|=c),o&=~c}}function Gm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function hE(){var t=Nd;return Nd<<=1,!(Nd&4194240)&&(Nd=64),t}function Bp(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function qc(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ur(e),t[e]=n}function yA(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Ur(n),o=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~o}}function _y(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Ur(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var rt=0;function fE(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var pE,vy,mE,gE,yE,Km=!1,Rd=[],Bs=null,zs=null,qs=null,cc=new Map,dc=new Map,Ps=[],_A="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function _0(t,e){switch(t){case"focusin":case"focusout":Bs=null;break;case"dragenter":case"dragleave":zs=null;break;case"mouseover":case"mouseout":qs=null;break;case"pointerover":case"pointerout":cc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":dc.delete(e.pointerId)}}function _u(t,e,n,r,i,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},e!==null&&(e=Hc(e),e!==null&&vy(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function vA(t,e,n,r,i){switch(e){case"focusin":return Bs=_u(Bs,t,e,n,r,i),!0;case"dragenter":return zs=_u(zs,t,e,n,r,i),!0;case"mouseover":return qs=_u(qs,t,e,n,r,i),!0;case"pointerover":var o=i.pointerId;return cc.set(o,_u(cc.get(o)||null,t,e,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,dc.set(o,_u(dc.get(o)||null,t,e,n,r,i)),!0}return!1}function _E(t){var e=No(t.target);if(e!==null){var n=oa(e);if(n!==null){if(e=n.tag,e===13){if(e=oE(n),e!==null){t.blockedOn=e,yE(t.priority,function(){mE(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ih(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Zm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);qm=r,n.target.dispatchEvent(r),qm=null}else return e=Hc(n),e!==null&&vy(e),t.blockedOn=n,!1;e.shift()}return!0}function v0(t,e,n){ih(t)&&n.delete(e)}function xA(){Km=!1,Bs!==null&&ih(Bs)&&(Bs=null),zs!==null&&ih(zs)&&(zs=null),qs!==null&&ih(qs)&&(qs=null),cc.forEach(v0),dc.forEach(v0)}function vu(t,e){t.blockedOn===e&&(t.blockedOn=null,Km||(Km=!0,tr.unstable_scheduleCallback(tr.unstable_NormalPriority,xA)))}function hc(t){function e(i){return vu(i,t)}if(0<Rd.length){vu(Rd[0],t);for(var n=1;n<Rd.length;n++){var r=Rd[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Bs!==null&&vu(Bs,t),zs!==null&&vu(zs,t),qs!==null&&vu(qs,t),cc.forEach(e),dc.forEach(e),n=0;n<Ps.length;n++)r=Ps[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Ps.length&&(n=Ps[0],n.blockedOn===null);)_E(n),n.blockedOn===null&&Ps.shift()}var cl=Ji.ReactCurrentBatchConfig,Mh=!0;function wA(t,e,n,r){var i=rt,o=cl.transition;cl.transition=null;try{rt=1,xy(t,e,n,r)}finally{rt=i,cl.transition=o}}function bA(t,e,n,r){var i=rt,o=cl.transition;cl.transition=null;try{rt=4,xy(t,e,n,r)}finally{rt=i,cl.transition=o}}function xy(t,e,n,r){if(Mh){var i=Zm(t,e,n,r);if(i===null)Yp(t,e,r,Oh,n),_0(t,r);else if(vA(i,t,e,n,r))r.stopPropagation();else if(_0(t,r),e&4&&-1<_A.indexOf(t)){for(;i!==null;){var o=Hc(i);if(o!==null&&pE(o),o=Zm(t,e,n,r),o===null&&Yp(t,e,r,Oh,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else Yp(t,e,r,null,n)}}var Oh=null;function Zm(t,e,n,r){if(Oh=null,t=gy(r),t=No(t),t!==null)if(e=oa(t),e===null)t=null;else if(n=e.tag,n===13){if(t=oE(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Oh=t,null}function vE(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(uA()){case yy:return 1;case cE:return 4;case Lh:case cA:return 16;case dE:return 536870912;default:return 16}default:return 16}}var Ms=null,wy=null,sh=null;function xE(){if(sh)return sh;var t,e=wy,n=e.length,r,i="value"in Ms?Ms.value:Ms.textContent,o=i.length;for(t=0;t<n&&e[t]===i[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===i[o-r];r++);return sh=i.slice(t,1<r?1-r:void 0)}function oh(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function jd(){return!0}function x0(){return!1}function sr(t){function e(n,r,i,o,a){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=a,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(n=t[c],this[c]=n?n(o):o[c]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?jd:x0,this.isPropagationStopped=x0,this}return kt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=jd)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=jd)},persist:function(){},isPersistent:jd}),e}var Bl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},by=sr(Bl),$c=kt({},Bl,{view:0,detail:0}),EA=sr($c),zp,qp,xu,Cf=kt({},$c,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ey,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==xu&&(xu&&t.type==="mousemove"?(zp=t.screenX-xu.screenX,qp=t.screenY-xu.screenY):qp=zp=0,xu=t),zp)},movementY:function(t){return"movementY"in t?t.movementY:qp}}),w0=sr(Cf),TA=kt({},Cf,{dataTransfer:0}),IA=sr(TA),kA=kt({},$c,{relatedTarget:0}),$p=sr(kA),SA=kt({},Bl,{animationName:0,elapsedTime:0,pseudoElement:0}),PA=sr(SA),AA=kt({},Bl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),NA=sr(AA),CA=kt({},Bl,{data:0}),b0=sr(CA),RA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},LA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function DA(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=LA[t])?!!e[t]:!1}function Ey(){return DA}var MA=kt({},$c,{key:function(t){if(t.key){var e=RA[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=oh(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?jA[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ey,charCode:function(t){return t.type==="keypress"?oh(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?oh(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),OA=sr(MA),VA=kt({},Cf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),E0=sr(VA),FA=kt({},$c,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ey}),UA=sr(FA),BA=kt({},Bl,{propertyName:0,elapsedTime:0,pseudoElement:0}),zA=sr(BA),qA=kt({},Cf,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),$A=sr(qA),HA=[9,13,27,32],Ty=$i&&"CompositionEvent"in window,Wu=null;$i&&"documentMode"in document&&(Wu=document.documentMode);var WA=$i&&"TextEvent"in window&&!Wu,wE=$i&&(!Ty||Wu&&8<Wu&&11>=Wu),T0=" ",I0=!1;function bE(t,e){switch(t){case"keyup":return HA.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function EE(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Qa=!1;function GA(t,e){switch(t){case"compositionend":return EE(e);case"keypress":return e.which!==32?null:(I0=!0,T0);case"textInput":return t=e.data,t===T0&&I0?null:t;default:return null}}function KA(t,e){if(Qa)return t==="compositionend"||!Ty&&bE(t,e)?(t=xE(),sh=wy=Ms=null,Qa=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return wE&&e.locale!=="ko"?null:e.data;default:return null}}var ZA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function k0(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!ZA[t.type]:e==="textarea"}function TE(t,e,n,r){tE(r),e=Vh(e,"onChange"),0<e.length&&(n=new by("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Gu=null,fc=null;function QA(t){DE(t,0)}function Rf(t){var e=Xa(t);if(Kb(e))return t}function YA(t,e){if(t==="change")return e}var IE=!1;if($i){var Hp;if($i){var Wp="oninput"in document;if(!Wp){var S0=document.createElement("div");S0.setAttribute("oninput","return;"),Wp=typeof S0.oninput=="function"}Hp=Wp}else Hp=!1;IE=Hp&&(!document.documentMode||9<document.documentMode)}function P0(){Gu&&(Gu.detachEvent("onpropertychange",kE),fc=Gu=null)}function kE(t){if(t.propertyName==="value"&&Rf(fc)){var e=[];TE(e,fc,t,gy(t)),sE(QA,e)}}function JA(t,e,n){t==="focusin"?(P0(),Gu=e,fc=n,Gu.attachEvent("onpropertychange",kE)):t==="focusout"&&P0()}function XA(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Rf(fc)}function eN(t,e){if(t==="click")return Rf(e)}function tN(t,e){if(t==="input"||t==="change")return Rf(e)}function nN(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var $r=typeof Object.is=="function"?Object.is:nN;function pc(t,e){if($r(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Cm.call(e,i)||!$r(t[i],e[i]))return!1}return!0}function A0(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function N0(t,e){var n=A0(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=A0(n)}}function SE(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?SE(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function PE(){for(var t=window,e=Ch();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Ch(t.document)}return e}function Iy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function rN(t){var e=PE(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&SE(n.ownerDocument.documentElement,n)){if(r!==null&&Iy(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!t.extend&&o>r&&(i=r,r=o,o=i),i=N0(n,o);var a=N0(n,r);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var iN=$i&&"documentMode"in document&&11>=document.documentMode,Ya=null,Qm=null,Ku=null,Ym=!1;function C0(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Ym||Ya==null||Ya!==Ch(r)||(r=Ya,"selectionStart"in r&&Iy(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ku&&pc(Ku,r)||(Ku=r,r=Vh(Qm,"onSelect"),0<r.length&&(e=new by("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Ya)))}function Ld(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ja={animationend:Ld("Animation","AnimationEnd"),animationiteration:Ld("Animation","AnimationIteration"),animationstart:Ld("Animation","AnimationStart"),transitionend:Ld("Transition","TransitionEnd")},Gp={},AE={};$i&&(AE=document.createElement("div").style,"AnimationEvent"in window||(delete Ja.animationend.animation,delete Ja.animationiteration.animation,delete Ja.animationstart.animation),"TransitionEvent"in window||delete Ja.transitionend.transition);function jf(t){if(Gp[t])return Gp[t];if(!Ja[t])return t;var e=Ja[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in AE)return Gp[t]=e[n];return t}var NE=jf("animationend"),CE=jf("animationiteration"),RE=jf("animationstart"),jE=jf("transitionend"),LE=new Map,R0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ro(t,e){LE.set(t,e),sa(e,[t])}for(var Kp=0;Kp<R0.length;Kp++){var Zp=R0[Kp],sN=Zp.toLowerCase(),oN=Zp[0].toUpperCase()+Zp.slice(1);ro(sN,"on"+oN)}ro(NE,"onAnimationEnd");ro(CE,"onAnimationIteration");ro(RE,"onAnimationStart");ro("dblclick","onDoubleClick");ro("focusin","onFocus");ro("focusout","onBlur");ro(jE,"onTransitionEnd");_l("onMouseEnter",["mouseout","mouseover"]);_l("onMouseLeave",["mouseout","mouseover"]);_l("onPointerEnter",["pointerout","pointerover"]);_l("onPointerLeave",["pointerout","pointerover"]);sa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));sa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));sa("onBeforeInput",["compositionend","keypress","textInput","paste"]);sa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));sa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));sa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),aN=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mu));function j0(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,sA(r,e,void 0,t),t.currentTarget=null}function DE(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var a=r.length-1;0<=a;a--){var c=r[a],h=c.instance,p=c.currentTarget;if(c=c.listener,h!==o&&i.isPropagationStopped())break e;j0(i,c,p),o=h}else for(a=0;a<r.length;a++){if(c=r[a],h=c.instance,p=c.currentTarget,c=c.listener,h!==o&&i.isPropagationStopped())break e;j0(i,c,p),o=h}}}if(jh)throw t=Wm,jh=!1,Wm=null,t}function ht(t,e){var n=e[ng];n===void 0&&(n=e[ng]=new Set);var r=t+"__bubble";n.has(r)||(ME(e,t,2,!1),n.add(r))}function Qp(t,e,n){var r=0;e&&(r|=4),ME(n,t,r,e)}var Dd="_reactListening"+Math.random().toString(36).slice(2);function mc(t){if(!t[Dd]){t[Dd]=!0,qb.forEach(function(n){n!=="selectionchange"&&(aN.has(n)||Qp(n,!1,t),Qp(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Dd]||(e[Dd]=!0,Qp("selectionchange",!1,e))}}function ME(t,e,n,r){switch(vE(e)){case 1:var i=wA;break;case 4:i=bA;break;default:i=xy}n=i.bind(null,e,n,t),i=void 0,!Hm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Yp(t,e,n,r,i){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var c=r.stateNode.containerInfo;if(c===i||c.nodeType===8&&c.parentNode===i)break;if(a===4)for(a=r.return;a!==null;){var h=a.tag;if((h===3||h===4)&&(h=a.stateNode.containerInfo,h===i||h.nodeType===8&&h.parentNode===i))return;a=a.return}for(;c!==null;){if(a=No(c),a===null)return;if(h=a.tag,h===5||h===6){r=o=a;continue e}c=c.parentNode}}r=r.return}sE(function(){var p=o,y=gy(n),v=[];e:{var w=LE.get(t);if(w!==void 0){var S=by,N=t;switch(t){case"keypress":if(oh(n)===0)break e;case"keydown":case"keyup":S=OA;break;case"focusin":N="focus",S=$p;break;case"focusout":N="blur",S=$p;break;case"beforeblur":case"afterblur":S=$p;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":S=w0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":S=IA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":S=UA;break;case NE:case CE:case RE:S=PA;break;case jE:S=zA;break;case"scroll":S=EA;break;case"wheel":S=$A;break;case"copy":case"cut":case"paste":S=NA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":S=E0}var A=(e&4)!==0,U=!A&&t==="scroll",j=A?w!==null?w+"Capture":null:w;A=[];for(var k=p,R;k!==null;){R=k;var z=R.stateNode;if(R.tag===5&&z!==null&&(R=z,j!==null&&(z=uc(k,j),z!=null&&A.push(gc(k,z,R)))),U)break;k=k.return}0<A.length&&(w=new S(w,N,null,n,y),v.push({event:w,listeners:A}))}}if(!(e&7)){e:{if(w=t==="mouseover"||t==="pointerover",S=t==="mouseout"||t==="pointerout",w&&n!==qm&&(N=n.relatedTarget||n.fromElement)&&(No(N)||N[Hi]))break e;if((S||w)&&(w=y.window===y?y:(w=y.ownerDocument)?w.defaultView||w.parentWindow:window,S?(N=n.relatedTarget||n.toElement,S=p,N=N?No(N):null,N!==null&&(U=oa(N),N!==U||N.tag!==5&&N.tag!==6)&&(N=null)):(S=null,N=p),S!==N)){if(A=w0,z="onMouseLeave",j="onMouseEnter",k="mouse",(t==="pointerout"||t==="pointerover")&&(A=E0,z="onPointerLeave",j="onPointerEnter",k="pointer"),U=S==null?w:Xa(S),R=N==null?w:Xa(N),w=new A(z,k+"leave",S,n,y),w.target=U,w.relatedTarget=R,z=null,No(y)===p&&(A=new A(j,k+"enter",N,n,y),A.target=R,A.relatedTarget=U,z=A),U=z,S&&N)t:{for(A=S,j=N,k=0,R=A;R;R=Va(R))k++;for(R=0,z=j;z;z=Va(z))R++;for(;0<k-R;)A=Va(A),k--;for(;0<R-k;)j=Va(j),R--;for(;k--;){if(A===j||j!==null&&A===j.alternate)break t;A=Va(A),j=Va(j)}A=null}else A=null;S!==null&&L0(v,w,S,A,!1),N!==null&&U!==null&&L0(v,U,N,A,!0)}}e:{if(w=p?Xa(p):window,S=w.nodeName&&w.nodeName.toLowerCase(),S==="select"||S==="input"&&w.type==="file")var K=YA;else if(k0(w))if(IE)K=tN;else{K=XA;var H=JA}else(S=w.nodeName)&&S.toLowerCase()==="input"&&(w.type==="checkbox"||w.type==="radio")&&(K=eN);if(K&&(K=K(t,p))){TE(v,K,n,y);break e}H&&H(t,w,p),t==="focusout"&&(H=w._wrapperState)&&H.controlled&&w.type==="number"&&Vm(w,"number",w.value)}switch(H=p?Xa(p):window,t){case"focusin":(k0(H)||H.contentEditable==="true")&&(Ya=H,Qm=p,Ku=null);break;case"focusout":Ku=Qm=Ya=null;break;case"mousedown":Ym=!0;break;case"contextmenu":case"mouseup":case"dragend":Ym=!1,C0(v,n,y);break;case"selectionchange":if(iN)break;case"keydown":case"keyup":C0(v,n,y)}var T;if(Ty)e:{switch(t){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Qa?bE(t,n)&&(b="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(b="onCompositionStart");b&&(wE&&n.locale!=="ko"&&(Qa||b!=="onCompositionStart"?b==="onCompositionEnd"&&Qa&&(T=xE()):(Ms=y,wy="value"in Ms?Ms.value:Ms.textContent,Qa=!0)),H=Vh(p,b),0<H.length&&(b=new b0(b,t,null,n,y),v.push({event:b,listeners:H}),T?b.data=T:(T=EE(n),T!==null&&(b.data=T)))),(T=WA?GA(t,n):KA(t,n))&&(p=Vh(p,"onBeforeInput"),0<p.length&&(y=new b0("onBeforeInput","beforeinput",null,n,y),v.push({event:y,listeners:p}),y.data=T))}DE(v,e)})}function gc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Vh(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=uc(t,n),o!=null&&r.unshift(gc(t,o,i)),o=uc(t,e),o!=null&&r.push(gc(t,o,i))),t=t.return}return r}function Va(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function L0(t,e,n,r,i){for(var o=e._reactName,a=[];n!==null&&n!==r;){var c=n,h=c.alternate,p=c.stateNode;if(h!==null&&h===r)break;c.tag===5&&p!==null&&(c=p,i?(h=uc(n,o),h!=null&&a.unshift(gc(n,h,c))):i||(h=uc(n,o),h!=null&&a.push(gc(n,h,c)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var lN=/\r\n?/g,uN=/\u0000|\uFFFD/g;function D0(t){return(typeof t=="string"?t:""+t).replace(lN,`
`).replace(uN,"")}function Md(t,e,n){if(e=D0(e),D0(t)!==e&&n)throw Error(re(425))}function Fh(){}var Jm=null,Xm=null;function eg(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var tg=typeof setTimeout=="function"?setTimeout:void 0,cN=typeof clearTimeout=="function"?clearTimeout:void 0,M0=typeof Promise=="function"?Promise:void 0,dN=typeof queueMicrotask=="function"?queueMicrotask:typeof M0<"u"?function(t){return M0.resolve(null).then(t).catch(hN)}:tg;function hN(t){setTimeout(function(){throw t})}function Jp(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),hc(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);hc(e)}function $s(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function O0(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var zl=Math.random().toString(36).slice(2),ai="__reactFiber$"+zl,yc="__reactProps$"+zl,Hi="__reactContainer$"+zl,ng="__reactEvents$"+zl,fN="__reactListeners$"+zl,pN="__reactHandles$"+zl;function No(t){var e=t[ai];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Hi]||n[ai]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=O0(t);t!==null;){if(n=t[ai])return n;t=O0(t)}return e}t=n,n=t.parentNode}return null}function Hc(t){return t=t[ai]||t[Hi],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Xa(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(re(33))}function Lf(t){return t[yc]||null}var rg=[],el=-1;function io(t){return{current:t}}function ft(t){0>el||(t.current=rg[el],rg[el]=null,el--)}function ct(t,e){el++,rg[el]=t.current,t.current=e}var Xs={},pn=io(Xs),Un=io(!1),Uo=Xs;function vl(t,e){var n=t.type.contextTypes;if(!n)return Xs;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in n)i[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Bn(t){return t=t.childContextTypes,t!=null}function Uh(){ft(Un),ft(pn)}function V0(t,e,n){if(pn.current!==Xs)throw Error(re(168));ct(pn,e),ct(Un,n)}function OE(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(re(108,JP(t)||"Unknown",i));return kt({},n,r)}function Bh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Xs,Uo=pn.current,ct(pn,t),ct(Un,Un.current),!0}function F0(t,e,n){var r=t.stateNode;if(!r)throw Error(re(169));n?(t=OE(t,e,Uo),r.__reactInternalMemoizedMergedChildContext=t,ft(Un),ft(pn),ct(pn,t)):ft(Un),ct(Un,n)}var Ni=null,Df=!1,Xp=!1;function VE(t){Ni===null?Ni=[t]:Ni.push(t)}function mN(t){Df=!0,VE(t)}function so(){if(!Xp&&Ni!==null){Xp=!0;var t=0,e=rt;try{var n=Ni;for(rt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Ni=null,Df=!1}catch(i){throw Ni!==null&&(Ni=Ni.slice(t+1)),uE(yy,so),i}finally{rt=e,Xp=!1}}return null}var tl=[],nl=0,zh=null,qh=0,gr=[],yr=0,Bo=null,ji=1,Li="";function wo(t,e){tl[nl++]=qh,tl[nl++]=zh,zh=t,qh=e}function FE(t,e,n){gr[yr++]=ji,gr[yr++]=Li,gr[yr++]=Bo,Bo=t;var r=ji;t=Li;var i=32-Ur(r)-1;r&=~(1<<i),n+=1;var o=32-Ur(e)+i;if(30<o){var a=i-i%5;o=(r&(1<<a)-1).toString(32),r>>=a,i-=a,ji=1<<32-Ur(e)+i|n<<i|r,Li=o+t}else ji=1<<o|n<<i|r,Li=t}function ky(t){t.return!==null&&(wo(t,1),FE(t,1,0))}function Sy(t){for(;t===zh;)zh=tl[--nl],tl[nl]=null,qh=tl[--nl],tl[nl]=null;for(;t===Bo;)Bo=gr[--yr],gr[yr]=null,Li=gr[--yr],gr[yr]=null,ji=gr[--yr],gr[yr]=null}var Jn=null,Zn=null,gt=!1,Vr=null;function UE(t,e){var n=_r(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function U0(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Jn=t,Zn=$s(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Jn=t,Zn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Bo!==null?{id:ji,overflow:Li}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=_r(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Jn=t,Zn=null,!0):!1;default:return!1}}function ig(t){return(t.mode&1)!==0&&(t.flags&128)===0}function sg(t){if(gt){var e=Zn;if(e){var n=e;if(!U0(t,e)){if(ig(t))throw Error(re(418));e=$s(n.nextSibling);var r=Jn;e&&U0(t,e)?UE(r,n):(t.flags=t.flags&-4097|2,gt=!1,Jn=t)}}else{if(ig(t))throw Error(re(418));t.flags=t.flags&-4097|2,gt=!1,Jn=t}}}function B0(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Jn=t}function Od(t){if(t!==Jn)return!1;if(!gt)return B0(t),gt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!eg(t.type,t.memoizedProps)),e&&(e=Zn)){if(ig(t))throw BE(),Error(re(418));for(;e;)UE(t,e),e=$s(e.nextSibling)}if(B0(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(re(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Zn=$s(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Zn=null}}else Zn=Jn?$s(t.stateNode.nextSibling):null;return!0}function BE(){for(var t=Zn;t;)t=$s(t.nextSibling)}function xl(){Zn=Jn=null,gt=!1}function Py(t){Vr===null?Vr=[t]:Vr.push(t)}var gN=Ji.ReactCurrentBatchConfig;function wu(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(re(309));var r=n.stateNode}if(!r)throw Error(re(147,t));var i=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(a){var c=i.refs;a===null?delete c[o]:c[o]=a},e._stringRef=o,e)}if(typeof t!="string")throw Error(re(284));if(!n._owner)throw Error(re(290,t))}return t}function Vd(t,e){throw t=Object.prototype.toString.call(e),Error(re(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function z0(t){var e=t._init;return e(t._payload)}function zE(t){function e(j,k){if(t){var R=j.deletions;R===null?(j.deletions=[k],j.flags|=16):R.push(k)}}function n(j,k){if(!t)return null;for(;k!==null;)e(j,k),k=k.sibling;return null}function r(j,k){for(j=new Map;k!==null;)k.key!==null?j.set(k.key,k):j.set(k.index,k),k=k.sibling;return j}function i(j,k){return j=Ks(j,k),j.index=0,j.sibling=null,j}function o(j,k,R){return j.index=R,t?(R=j.alternate,R!==null?(R=R.index,R<k?(j.flags|=2,k):R):(j.flags|=2,k)):(j.flags|=1048576,k)}function a(j){return t&&j.alternate===null&&(j.flags|=2),j}function c(j,k,R,z){return k===null||k.tag!==6?(k=om(R,j.mode,z),k.return=j,k):(k=i(k,R),k.return=j,k)}function h(j,k,R,z){var K=R.type;return K===Za?y(j,k,R.props.children,z,R.key):k!==null&&(k.elementType===K||typeof K=="object"&&K!==null&&K.$$typeof===ks&&z0(K)===k.type)?(z=i(k,R.props),z.ref=wu(j,k,R),z.return=j,z):(z=fh(R.type,R.key,R.props,null,j.mode,z),z.ref=wu(j,k,R),z.return=j,z)}function p(j,k,R,z){return k===null||k.tag!==4||k.stateNode.containerInfo!==R.containerInfo||k.stateNode.implementation!==R.implementation?(k=am(R,j.mode,z),k.return=j,k):(k=i(k,R.children||[]),k.return=j,k)}function y(j,k,R,z,K){return k===null||k.tag!==7?(k=Mo(R,j.mode,z,K),k.return=j,k):(k=i(k,R),k.return=j,k)}function v(j,k,R){if(typeof k=="string"&&k!==""||typeof k=="number")return k=om(""+k,j.mode,R),k.return=j,k;if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Sd:return R=fh(k.type,k.key,k.props,null,j.mode,R),R.ref=wu(j,null,k),R.return=j,R;case Ka:return k=am(k,j.mode,R),k.return=j,k;case ks:var z=k._init;return v(j,z(k._payload),R)}if(Lu(k)||gu(k))return k=Mo(k,j.mode,R,null),k.return=j,k;Vd(j,k)}return null}function w(j,k,R,z){var K=k!==null?k.key:null;if(typeof R=="string"&&R!==""||typeof R=="number")return K!==null?null:c(j,k,""+R,z);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case Sd:return R.key===K?h(j,k,R,z):null;case Ka:return R.key===K?p(j,k,R,z):null;case ks:return K=R._init,w(j,k,K(R._payload),z)}if(Lu(R)||gu(R))return K!==null?null:y(j,k,R,z,null);Vd(j,R)}return null}function S(j,k,R,z,K){if(typeof z=="string"&&z!==""||typeof z=="number")return j=j.get(R)||null,c(k,j,""+z,K);if(typeof z=="object"&&z!==null){switch(z.$$typeof){case Sd:return j=j.get(z.key===null?R:z.key)||null,h(k,j,z,K);case Ka:return j=j.get(z.key===null?R:z.key)||null,p(k,j,z,K);case ks:var H=z._init;return S(j,k,R,H(z._payload),K)}if(Lu(z)||gu(z))return j=j.get(R)||null,y(k,j,z,K,null);Vd(k,z)}return null}function N(j,k,R,z){for(var K=null,H=null,T=k,b=k=0,C=null;T!==null&&b<R.length;b++){T.index>b?(C=T,T=null):C=T.sibling;var P=w(j,T,R[b],z);if(P===null){T===null&&(T=C);break}t&&T&&P.alternate===null&&e(j,T),k=o(P,k,b),H===null?K=P:H.sibling=P,H=P,T=C}if(b===R.length)return n(j,T),gt&&wo(j,b),K;if(T===null){for(;b<R.length;b++)T=v(j,R[b],z),T!==null&&(k=o(T,k,b),H===null?K=T:H.sibling=T,H=T);return gt&&wo(j,b),K}for(T=r(j,T);b<R.length;b++)C=S(T,j,b,R[b],z),C!==null&&(t&&C.alternate!==null&&T.delete(C.key===null?b:C.key),k=o(C,k,b),H===null?K=C:H.sibling=C,H=C);return t&&T.forEach(function(O){return e(j,O)}),gt&&wo(j,b),K}function A(j,k,R,z){var K=gu(R);if(typeof K!="function")throw Error(re(150));if(R=K.call(R),R==null)throw Error(re(151));for(var H=K=null,T=k,b=k=0,C=null,P=R.next();T!==null&&!P.done;b++,P=R.next()){T.index>b?(C=T,T=null):C=T.sibling;var O=w(j,T,P.value,z);if(O===null){T===null&&(T=C);break}t&&T&&O.alternate===null&&e(j,T),k=o(O,k,b),H===null?K=O:H.sibling=O,H=O,T=C}if(P.done)return n(j,T),gt&&wo(j,b),K;if(T===null){for(;!P.done;b++,P=R.next())P=v(j,P.value,z),P!==null&&(k=o(P,k,b),H===null?K=P:H.sibling=P,H=P);return gt&&wo(j,b),K}for(T=r(j,T);!P.done;b++,P=R.next())P=S(T,j,b,P.value,z),P!==null&&(t&&P.alternate!==null&&T.delete(P.key===null?b:P.key),k=o(P,k,b),H===null?K=P:H.sibling=P,H=P);return t&&T.forEach(function(F){return e(j,F)}),gt&&wo(j,b),K}function U(j,k,R,z){if(typeof R=="object"&&R!==null&&R.type===Za&&R.key===null&&(R=R.props.children),typeof R=="object"&&R!==null){switch(R.$$typeof){case Sd:e:{for(var K=R.key,H=k;H!==null;){if(H.key===K){if(K=R.type,K===Za){if(H.tag===7){n(j,H.sibling),k=i(H,R.props.children),k.return=j,j=k;break e}}else if(H.elementType===K||typeof K=="object"&&K!==null&&K.$$typeof===ks&&z0(K)===H.type){n(j,H.sibling),k=i(H,R.props),k.ref=wu(j,H,R),k.return=j,j=k;break e}n(j,H);break}else e(j,H);H=H.sibling}R.type===Za?(k=Mo(R.props.children,j.mode,z,R.key),k.return=j,j=k):(z=fh(R.type,R.key,R.props,null,j.mode,z),z.ref=wu(j,k,R),z.return=j,j=z)}return a(j);case Ka:e:{for(H=R.key;k!==null;){if(k.key===H)if(k.tag===4&&k.stateNode.containerInfo===R.containerInfo&&k.stateNode.implementation===R.implementation){n(j,k.sibling),k=i(k,R.children||[]),k.return=j,j=k;break e}else{n(j,k);break}else e(j,k);k=k.sibling}k=am(R,j.mode,z),k.return=j,j=k}return a(j);case ks:return H=R._init,U(j,k,H(R._payload),z)}if(Lu(R))return N(j,k,R,z);if(gu(R))return A(j,k,R,z);Vd(j,R)}return typeof R=="string"&&R!==""||typeof R=="number"?(R=""+R,k!==null&&k.tag===6?(n(j,k.sibling),k=i(k,R),k.return=j,j=k):(n(j,k),k=om(R,j.mode,z),k.return=j,j=k),a(j)):n(j,k)}return U}var wl=zE(!0),qE=zE(!1),$h=io(null),Hh=null,rl=null,Ay=null;function Ny(){Ay=rl=Hh=null}function Cy(t){var e=$h.current;ft($h),t._currentValue=e}function og(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function dl(t,e){Hh=t,Ay=rl=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(On=!0),t.firstContext=null)}function xr(t){var e=t._currentValue;if(Ay!==t)if(t={context:t,memoizedValue:e,next:null},rl===null){if(Hh===null)throw Error(re(308));rl=t,Hh.dependencies={lanes:0,firstContext:t}}else rl=rl.next=t;return e}var Co=null;function Ry(t){Co===null?Co=[t]:Co.push(t)}function $E(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Ry(e)):(n.next=i.next,i.next=n),e.interleaved=n,Wi(t,r)}function Wi(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ss=!1;function jy(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function HE(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ui(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Hs(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ge&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Wi(t,n)}return i=r.interleaved,i===null?(e.next=e,Ry(r)):(e.next=i.next,i.next=e),r.interleaved=e,Wi(t,n)}function ah(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,_y(t,n)}}function q0(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?i=o=a:o=o.next=a,n=n.next}while(n!==null);o===null?i=o=e:o=o.next=e}else i=o=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Wh(t,e,n,r){var i=t.updateQueue;Ss=!1;var o=i.firstBaseUpdate,a=i.lastBaseUpdate,c=i.shared.pending;if(c!==null){i.shared.pending=null;var h=c,p=h.next;h.next=null,a===null?o=p:a.next=p,a=h;var y=t.alternate;y!==null&&(y=y.updateQueue,c=y.lastBaseUpdate,c!==a&&(c===null?y.firstBaseUpdate=p:c.next=p,y.lastBaseUpdate=h))}if(o!==null){var v=i.baseState;a=0,y=p=h=null,c=o;do{var w=c.lane,S=c.eventTime;if((r&w)===w){y!==null&&(y=y.next={eventTime:S,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var N=t,A=c;switch(w=e,S=n,A.tag){case 1:if(N=A.payload,typeof N=="function"){v=N.call(S,v,w);break e}v=N;break e;case 3:N.flags=N.flags&-65537|128;case 0:if(N=A.payload,w=typeof N=="function"?N.call(S,v,w):N,w==null)break e;v=kt({},v,w);break e;case 2:Ss=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,w=i.effects,w===null?i.effects=[c]:w.push(c))}else S={eventTime:S,lane:w,tag:c.tag,payload:c.payload,callback:c.callback,next:null},y===null?(p=y=S,h=v):y=y.next=S,a|=w;if(c=c.next,c===null){if(c=i.shared.pending,c===null)break;w=c,c=w.next,w.next=null,i.lastBaseUpdate=w,i.shared.pending=null}}while(!0);if(y===null&&(h=v),i.baseState=h,i.firstBaseUpdate=p,i.lastBaseUpdate=y,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else o===null&&(i.shared.lanes=0);qo|=a,t.lanes=a,t.memoizedState=v}}function $0(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(re(191,i));i.call(r)}}}var Wc={},hi=io(Wc),_c=io(Wc),vc=io(Wc);function Ro(t){if(t===Wc)throw Error(re(174));return t}function Ly(t,e){switch(ct(vc,e),ct(_c,t),ct(hi,Wc),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Um(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Um(e,t)}ft(hi),ct(hi,e)}function bl(){ft(hi),ft(_c),ft(vc)}function WE(t){Ro(vc.current);var e=Ro(hi.current),n=Um(e,t.type);e!==n&&(ct(_c,t),ct(hi,n))}function Dy(t){_c.current===t&&(ft(hi),ft(_c))}var bt=io(0);function Gh(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var em=[];function My(){for(var t=0;t<em.length;t++)em[t]._workInProgressVersionPrimary=null;em.length=0}var lh=Ji.ReactCurrentDispatcher,tm=Ji.ReactCurrentBatchConfig,zo=0,It=null,zt=null,Qt=null,Kh=!1,Zu=!1,xc=0,yN=0;function rn(){throw Error(re(321))}function Oy(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!$r(t[n],e[n]))return!1;return!0}function Vy(t,e,n,r,i,o){if(zo=o,It=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,lh.current=t===null||t.memoizedState===null?wN:bN,t=n(r,i),Zu){o=0;do{if(Zu=!1,xc=0,25<=o)throw Error(re(301));o+=1,Qt=zt=null,e.updateQueue=null,lh.current=EN,t=n(r,i)}while(Zu)}if(lh.current=Zh,e=zt!==null&&zt.next!==null,zo=0,Qt=zt=It=null,Kh=!1,e)throw Error(re(300));return t}function Fy(){var t=xc!==0;return xc=0,t}function ii(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Qt===null?It.memoizedState=Qt=t:Qt=Qt.next=t,Qt}function wr(){if(zt===null){var t=It.alternate;t=t!==null?t.memoizedState:null}else t=zt.next;var e=Qt===null?It.memoizedState:Qt.next;if(e!==null)Qt=e,zt=t;else{if(t===null)throw Error(re(310));zt=t,t={memoizedState:zt.memoizedState,baseState:zt.baseState,baseQueue:zt.baseQueue,queue:zt.queue,next:null},Qt===null?It.memoizedState=Qt=t:Qt=Qt.next=t}return Qt}function wc(t,e){return typeof e=="function"?e(t):e}function nm(t){var e=wr(),n=e.queue;if(n===null)throw Error(re(311));n.lastRenderedReducer=t;var r=zt,i=r.baseQueue,o=n.pending;if(o!==null){if(i!==null){var a=i.next;i.next=o.next,o.next=a}r.baseQueue=i=o,n.pending=null}if(i!==null){o=i.next,r=r.baseState;var c=a=null,h=null,p=o;do{var y=p.lane;if((zo&y)===y)h!==null&&(h=h.next={lane:0,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null}),r=p.hasEagerState?p.eagerState:t(r,p.action);else{var v={lane:y,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null};h===null?(c=h=v,a=r):h=h.next=v,It.lanes|=y,qo|=y}p=p.next}while(p!==null&&p!==o);h===null?a=r:h.next=c,$r(r,e.memoizedState)||(On=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=h,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do o=i.lane,It.lanes|=o,qo|=o,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function rm(t){var e=wr(),n=e.queue;if(n===null)throw Error(re(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,o=e.memoizedState;if(i!==null){n.pending=null;var a=i=i.next;do o=t(o,a.action),a=a.next;while(a!==i);$r(o,e.memoizedState)||(On=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function GE(){}function KE(t,e){var n=It,r=wr(),i=e(),o=!$r(r.memoizedState,i);if(o&&(r.memoizedState=i,On=!0),r=r.queue,Uy(YE.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||Qt!==null&&Qt.memoizedState.tag&1){if(n.flags|=2048,bc(9,QE.bind(null,n,r,i,e),void 0,null),Yt===null)throw Error(re(349));zo&30||ZE(n,e,i)}return i}function ZE(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=It.updateQueue,e===null?(e={lastEffect:null,stores:null},It.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function QE(t,e,n,r){e.value=n,e.getSnapshot=r,JE(e)&&XE(t)}function YE(t,e,n){return n(function(){JE(e)&&XE(t)})}function JE(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!$r(t,n)}catch{return!0}}function XE(t){var e=Wi(t,1);e!==null&&Br(e,t,1,-1)}function H0(t){var e=ii();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wc,lastRenderedState:t},e.queue=t,t=t.dispatch=xN.bind(null,It,t),[e.memoizedState,t]}function bc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=It.updateQueue,e===null?(e={lastEffect:null,stores:null},It.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function eT(){return wr().memoizedState}function uh(t,e,n,r){var i=ii();It.flags|=t,i.memoizedState=bc(1|e,n,void 0,r===void 0?null:r)}function Mf(t,e,n,r){var i=wr();r=r===void 0?null:r;var o=void 0;if(zt!==null){var a=zt.memoizedState;if(o=a.destroy,r!==null&&Oy(r,a.deps)){i.memoizedState=bc(e,n,o,r);return}}It.flags|=t,i.memoizedState=bc(1|e,n,o,r)}function W0(t,e){return uh(8390656,8,t,e)}function Uy(t,e){return Mf(2048,8,t,e)}function tT(t,e){return Mf(4,2,t,e)}function nT(t,e){return Mf(4,4,t,e)}function rT(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function iT(t,e,n){return n=n!=null?n.concat([t]):null,Mf(4,4,rT.bind(null,e,t),n)}function By(){}function sT(t,e){var n=wr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Oy(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function oT(t,e){var n=wr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Oy(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function aT(t,e,n){return zo&21?($r(n,e)||(n=hE(),It.lanes|=n,qo|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,On=!0),t.memoizedState=n)}function _N(t,e){var n=rt;rt=n!==0&&4>n?n:4,t(!0);var r=tm.transition;tm.transition={};try{t(!1),e()}finally{rt=n,tm.transition=r}}function lT(){return wr().memoizedState}function vN(t,e,n){var r=Gs(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},uT(t))cT(e,n);else if(n=$E(t,e,n,r),n!==null){var i=bn();Br(n,t,r,i),dT(n,e,r)}}function xN(t,e,n){var r=Gs(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(uT(t))cT(e,i);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var a=e.lastRenderedState,c=o(a,n);if(i.hasEagerState=!0,i.eagerState=c,$r(c,a)){var h=e.interleaved;h===null?(i.next=i,Ry(e)):(i.next=h.next,h.next=i),e.interleaved=i;return}}catch{}finally{}n=$E(t,e,i,r),n!==null&&(i=bn(),Br(n,t,r,i),dT(n,e,r))}}function uT(t){var e=t.alternate;return t===It||e!==null&&e===It}function cT(t,e){Zu=Kh=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function dT(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,_y(t,n)}}var Zh={readContext:xr,useCallback:rn,useContext:rn,useEffect:rn,useImperativeHandle:rn,useInsertionEffect:rn,useLayoutEffect:rn,useMemo:rn,useReducer:rn,useRef:rn,useState:rn,useDebugValue:rn,useDeferredValue:rn,useTransition:rn,useMutableSource:rn,useSyncExternalStore:rn,useId:rn,unstable_isNewReconciler:!1},wN={readContext:xr,useCallback:function(t,e){return ii().memoizedState=[t,e===void 0?null:e],t},useContext:xr,useEffect:W0,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,uh(4194308,4,rT.bind(null,e,t),n)},useLayoutEffect:function(t,e){return uh(4194308,4,t,e)},useInsertionEffect:function(t,e){return uh(4,2,t,e)},useMemo:function(t,e){var n=ii();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=ii();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=vN.bind(null,It,t),[r.memoizedState,t]},useRef:function(t){var e=ii();return t={current:t},e.memoizedState=t},useState:H0,useDebugValue:By,useDeferredValue:function(t){return ii().memoizedState=t},useTransition:function(){var t=H0(!1),e=t[0];return t=_N.bind(null,t[1]),ii().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=It,i=ii();if(gt){if(n===void 0)throw Error(re(407));n=n()}else{if(n=e(),Yt===null)throw Error(re(349));zo&30||ZE(r,e,n)}i.memoizedState=n;var o={value:n,getSnapshot:e};return i.queue=o,W0(YE.bind(null,r,o,t),[t]),r.flags|=2048,bc(9,QE.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=ii(),e=Yt.identifierPrefix;if(gt){var n=Li,r=ji;n=(r&~(1<<32-Ur(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=xc++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=yN++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},bN={readContext:xr,useCallback:sT,useContext:xr,useEffect:Uy,useImperativeHandle:iT,useInsertionEffect:tT,useLayoutEffect:nT,useMemo:oT,useReducer:nm,useRef:eT,useState:function(){return nm(wc)},useDebugValue:By,useDeferredValue:function(t){var e=wr();return aT(e,zt.memoizedState,t)},useTransition:function(){var t=nm(wc)[0],e=wr().memoizedState;return[t,e]},useMutableSource:GE,useSyncExternalStore:KE,useId:lT,unstable_isNewReconciler:!1},EN={readContext:xr,useCallback:sT,useContext:xr,useEffect:Uy,useImperativeHandle:iT,useInsertionEffect:tT,useLayoutEffect:nT,useMemo:oT,useReducer:rm,useRef:eT,useState:function(){return rm(wc)},useDebugValue:By,useDeferredValue:function(t){var e=wr();return zt===null?e.memoizedState=t:aT(e,zt.memoizedState,t)},useTransition:function(){var t=rm(wc)[0],e=wr().memoizedState;return[t,e]},useMutableSource:GE,useSyncExternalStore:KE,useId:lT,unstable_isNewReconciler:!1};function Mr(t,e){if(t&&t.defaultProps){e=kt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function ag(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:kt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Of={isMounted:function(t){return(t=t._reactInternals)?oa(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=bn(),i=Gs(t),o=Ui(r,i);o.payload=e,n!=null&&(o.callback=n),e=Hs(t,o,i),e!==null&&(Br(e,t,i,r),ah(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=bn(),i=Gs(t),o=Ui(r,i);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=Hs(t,o,i),e!==null&&(Br(e,t,i,r),ah(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=bn(),r=Gs(t),i=Ui(n,r);i.tag=2,e!=null&&(i.callback=e),e=Hs(t,i,r),e!==null&&(Br(e,t,r,n),ah(e,t,r))}};function G0(t,e,n,r,i,o,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,a):e.prototype&&e.prototype.isPureReactComponent?!pc(n,r)||!pc(i,o):!0}function hT(t,e,n){var r=!1,i=Xs,o=e.contextType;return typeof o=="object"&&o!==null?o=xr(o):(i=Bn(e)?Uo:pn.current,r=e.contextTypes,o=(r=r!=null)?vl(t,i):Xs),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Of,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function K0(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Of.enqueueReplaceState(e,e.state,null)}function lg(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},jy(t);var o=e.contextType;typeof o=="object"&&o!==null?i.context=xr(o):(o=Bn(e)?Uo:pn.current,i.context=vl(t,o)),i.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(ag(t,e,o,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Of.enqueueReplaceState(i,i.state,null),Wh(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function El(t,e){try{var n="",r=e;do n+=YP(r),r=r.return;while(r);var i=n}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:i,digest:null}}function im(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function ug(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var TN=typeof WeakMap=="function"?WeakMap:Map;function fT(t,e,n){n=Ui(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Yh||(Yh=!0,vg=r),ug(t,e)},n}function pT(t,e,n){n=Ui(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){ug(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){ug(t,e),typeof r!="function"&&(Ws===null?Ws=new Set([this]):Ws.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function Z0(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new TN;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=VN.bind(null,t,e,n),e.then(t,t))}function Q0(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Y0(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Ui(-1,1),e.tag=2,Hs(n,e,1))),n.lanes|=1),t)}var IN=Ji.ReactCurrentOwner,On=!1;function wn(t,e,n,r){e.child=t===null?qE(e,null,n,r):wl(e,t.child,n,r)}function J0(t,e,n,r,i){n=n.render;var o=e.ref;return dl(e,i),r=Vy(t,e,n,r,o,i),n=Fy(),t!==null&&!On?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Gi(t,e,i)):(gt&&n&&ky(e),e.flags|=1,wn(t,e,r,i),e.child)}function X0(t,e,n,r,i){if(t===null){var o=n.type;return typeof o=="function"&&!Zy(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,mT(t,e,o,r,i)):(t=fh(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&i)){var a=o.memoizedProps;if(n=n.compare,n=n!==null?n:pc,n(a,r)&&t.ref===e.ref)return Gi(t,e,i)}return e.flags|=1,t=Ks(o,r),t.ref=e.ref,t.return=e,e.child=t}function mT(t,e,n,r,i){if(t!==null){var o=t.memoizedProps;if(pc(o,r)&&t.ref===e.ref)if(On=!1,e.pendingProps=r=o,(t.lanes&i)!==0)t.flags&131072&&(On=!0);else return e.lanes=t.lanes,Gi(t,e,i)}return cg(t,e,n,r,i)}function gT(t,e,n){var r=e.pendingProps,i=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ct(sl,Kn),Kn|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ct(sl,Kn),Kn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,ct(sl,Kn),Kn|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,ct(sl,Kn),Kn|=r;return wn(t,e,i,n),e.child}function yT(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function cg(t,e,n,r,i){var o=Bn(n)?Uo:pn.current;return o=vl(e,o),dl(e,i),n=Vy(t,e,n,r,o,i),r=Fy(),t!==null&&!On?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Gi(t,e,i)):(gt&&r&&ky(e),e.flags|=1,wn(t,e,n,i),e.child)}function ex(t,e,n,r,i){if(Bn(n)){var o=!0;Bh(e)}else o=!1;if(dl(e,i),e.stateNode===null)ch(t,e),hT(e,n,r),lg(e,n,r,i),r=!0;else if(t===null){var a=e.stateNode,c=e.memoizedProps;a.props=c;var h=a.context,p=n.contextType;typeof p=="object"&&p!==null?p=xr(p):(p=Bn(n)?Uo:pn.current,p=vl(e,p));var y=n.getDerivedStateFromProps,v=typeof y=="function"||typeof a.getSnapshotBeforeUpdate=="function";v||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(c!==r||h!==p)&&K0(e,a,r,p),Ss=!1;var w=e.memoizedState;a.state=w,Wh(e,r,a,i),h=e.memoizedState,c!==r||w!==h||Un.current||Ss?(typeof y=="function"&&(ag(e,n,y,r),h=e.memoizedState),(c=Ss||G0(e,n,c,r,w,h,p))?(v||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=h),a.props=r,a.state=h,a.context=p,r=c):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,HE(t,e),c=e.memoizedProps,p=e.type===e.elementType?c:Mr(e.type,c),a.props=p,v=e.pendingProps,w=a.context,h=n.contextType,typeof h=="object"&&h!==null?h=xr(h):(h=Bn(n)?Uo:pn.current,h=vl(e,h));var S=n.getDerivedStateFromProps;(y=typeof S=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(c!==v||w!==h)&&K0(e,a,r,h),Ss=!1,w=e.memoizedState,a.state=w,Wh(e,r,a,i);var N=e.memoizedState;c!==v||w!==N||Un.current||Ss?(typeof S=="function"&&(ag(e,n,S,r),N=e.memoizedState),(p=Ss||G0(e,n,p,r,w,N,h)||!1)?(y||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,N,h),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,N,h)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||c===t.memoizedProps&&w===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&w===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=N),a.props=r,a.state=N,a.context=h,r=p):(typeof a.componentDidUpdate!="function"||c===t.memoizedProps&&w===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&w===t.memoizedState||(e.flags|=1024),r=!1)}return dg(t,e,n,r,o,i)}function dg(t,e,n,r,i,o){yT(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return i&&F0(e,n,!1),Gi(t,e,o);r=e.stateNode,IN.current=e;var c=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=wl(e,t.child,null,o),e.child=wl(e,null,c,o)):wn(t,e,c,o),e.memoizedState=r.state,i&&F0(e,n,!0),e.child}function _T(t){var e=t.stateNode;e.pendingContext?V0(t,e.pendingContext,e.pendingContext!==e.context):e.context&&V0(t,e.context,!1),Ly(t,e.containerInfo)}function tx(t,e,n,r,i){return xl(),Py(i),e.flags|=256,wn(t,e,n,r),e.child}var hg={dehydrated:null,treeContext:null,retryLane:0};function fg(t){return{baseLanes:t,cachePool:null,transitions:null}}function vT(t,e,n){var r=e.pendingProps,i=bt.current,o=!1,a=(e.flags&128)!==0,c;if((c=a)||(c=t!==null&&t.memoizedState===null?!1:(i&2)!==0),c?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),ct(bt,i&1),t===null)return sg(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,o?(r=e.mode,o=e.child,a={mode:"hidden",children:a},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=a):o=Uf(a,r,0,null),t=Mo(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=fg(n),e.memoizedState=hg,t):zy(e,a));if(i=t.memoizedState,i!==null&&(c=i.dehydrated,c!==null))return kN(t,e,a,r,c,i,n);if(o){o=r.fallback,a=e.mode,i=t.child,c=i.sibling;var h={mode:"hidden",children:r.children};return!(a&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=h,e.deletions=null):(r=Ks(i,h),r.subtreeFlags=i.subtreeFlags&14680064),c!==null?o=Ks(c,o):(o=Mo(o,a,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,a=t.child.memoizedState,a=a===null?fg(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},o.memoizedState=a,o.childLanes=t.childLanes&~n,e.memoizedState=hg,r}return o=t.child,t=o.sibling,r=Ks(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function zy(t,e){return e=Uf({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Fd(t,e,n,r){return r!==null&&Py(r),wl(e,t.child,null,n),t=zy(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function kN(t,e,n,r,i,o,a){if(n)return e.flags&256?(e.flags&=-257,r=im(Error(re(422))),Fd(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,i=e.mode,r=Uf({mode:"visible",children:r.children},i,0,null),o=Mo(o,i,a,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&wl(e,t.child,null,a),e.child.memoizedState=fg(a),e.memoizedState=hg,o);if(!(e.mode&1))return Fd(t,e,a,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var c=r.dgst;return r=c,o=Error(re(419)),r=im(o,r,void 0),Fd(t,e,a,r)}if(c=(a&t.childLanes)!==0,On||c){if(r=Yt,r!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|a)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,Wi(t,i),Br(r,t,i,-1))}return Ky(),r=im(Error(re(421))),Fd(t,e,a,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=FN.bind(null,t),i._reactRetry=e,null):(t=o.treeContext,Zn=$s(i.nextSibling),Jn=e,gt=!0,Vr=null,t!==null&&(gr[yr++]=ji,gr[yr++]=Li,gr[yr++]=Bo,ji=t.id,Li=t.overflow,Bo=e),e=zy(e,r.children),e.flags|=4096,e)}function nx(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),og(t.return,e,n)}function sm(t,e,n,r,i){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function xT(t,e,n){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(wn(t,e,r.children,n),r=bt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&nx(t,n,e);else if(t.tag===19)nx(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ct(bt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Gh(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),sm(e,!1,i,n,o);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Gh(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}sm(e,!0,n,null,o);break;case"together":sm(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ch(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Gi(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),qo|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(re(153));if(e.child!==null){for(t=e.child,n=Ks(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ks(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function SN(t,e,n){switch(e.tag){case 3:_T(e),xl();break;case 5:WE(e);break;case 1:Bn(e.type)&&Bh(e);break;case 4:Ly(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;ct($h,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ct(bt,bt.current&1),e.flags|=128,null):n&e.child.childLanes?vT(t,e,n):(ct(bt,bt.current&1),t=Gi(t,e,n),t!==null?t.sibling:null);ct(bt,bt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return xT(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ct(bt,bt.current),r)break;return null;case 22:case 23:return e.lanes=0,gT(t,e,n)}return Gi(t,e,n)}var wT,pg,bT,ET;wT=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};pg=function(){};bT=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Ro(hi.current);var o=null;switch(n){case"input":i=Mm(t,i),r=Mm(t,r),o=[];break;case"select":i=kt({},i,{value:void 0}),r=kt({},r,{value:void 0}),o=[];break;case"textarea":i=Fm(t,i),r=Fm(t,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Fh)}Bm(n,r);var a;n=null;for(p in i)if(!r.hasOwnProperty(p)&&i.hasOwnProperty(p)&&i[p]!=null)if(p==="style"){var c=i[p];for(a in c)c.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else p!=="dangerouslySetInnerHTML"&&p!=="children"&&p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&p!=="autoFocus"&&(ac.hasOwnProperty(p)?o||(o=[]):(o=o||[]).push(p,null));for(p in r){var h=r[p];if(c=i!=null?i[p]:void 0,r.hasOwnProperty(p)&&h!==c&&(h!=null||c!=null))if(p==="style")if(c){for(a in c)!c.hasOwnProperty(a)||h&&h.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in h)h.hasOwnProperty(a)&&c[a]!==h[a]&&(n||(n={}),n[a]=h[a])}else n||(o||(o=[]),o.push(p,n)),n=h;else p==="dangerouslySetInnerHTML"?(h=h?h.__html:void 0,c=c?c.__html:void 0,h!=null&&c!==h&&(o=o||[]).push(p,h)):p==="children"?typeof h!="string"&&typeof h!="number"||(o=o||[]).push(p,""+h):p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&(ac.hasOwnProperty(p)?(h!=null&&p==="onScroll"&&ht("scroll",t),o||c===h||(o=[])):(o=o||[]).push(p,h))}n&&(o=o||[]).push("style",n);var p=o;(e.updateQueue=p)&&(e.flags|=4)}};ET=function(t,e,n,r){n!==r&&(e.flags|=4)};function bu(t,e){if(!gt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function sn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function PN(t,e,n){var r=e.pendingProps;switch(Sy(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return sn(e),null;case 1:return Bn(e.type)&&Uh(),sn(e),null;case 3:return r=e.stateNode,bl(),ft(Un),ft(pn),My(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Od(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Vr!==null&&(bg(Vr),Vr=null))),pg(t,e),sn(e),null;case 5:Dy(e);var i=Ro(vc.current);if(n=e.type,t!==null&&e.stateNode!=null)bT(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(re(166));return sn(e),null}if(t=Ro(hi.current),Od(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[ai]=e,r[yc]=o,t=(e.mode&1)!==0,n){case"dialog":ht("cancel",r),ht("close",r);break;case"iframe":case"object":case"embed":ht("load",r);break;case"video":case"audio":for(i=0;i<Mu.length;i++)ht(Mu[i],r);break;case"source":ht("error",r);break;case"img":case"image":case"link":ht("error",r),ht("load",r);break;case"details":ht("toggle",r);break;case"input":d0(r,o),ht("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},ht("invalid",r);break;case"textarea":f0(r,o),ht("invalid",r)}Bm(n,o),i=null;for(var a in o)if(o.hasOwnProperty(a)){var c=o[a];a==="children"?typeof c=="string"?r.textContent!==c&&(o.suppressHydrationWarning!==!0&&Md(r.textContent,c,t),i=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(o.suppressHydrationWarning!==!0&&Md(r.textContent,c,t),i=["children",""+c]):ac.hasOwnProperty(a)&&c!=null&&a==="onScroll"&&ht("scroll",r)}switch(n){case"input":Pd(r),h0(r,o,!0);break;case"textarea":Pd(r),p0(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=Fh)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Yb(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[ai]=e,t[yc]=r,wT(t,e,!1,!1),e.stateNode=t;e:{switch(a=zm(n,r),n){case"dialog":ht("cancel",t),ht("close",t),i=r;break;case"iframe":case"object":case"embed":ht("load",t),i=r;break;case"video":case"audio":for(i=0;i<Mu.length;i++)ht(Mu[i],t);i=r;break;case"source":ht("error",t),i=r;break;case"img":case"image":case"link":ht("error",t),ht("load",t),i=r;break;case"details":ht("toggle",t),i=r;break;case"input":d0(t,r),i=Mm(t,r),ht("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=kt({},r,{value:void 0}),ht("invalid",t);break;case"textarea":f0(t,r),i=Fm(t,r),ht("invalid",t);break;default:i=r}Bm(n,i),c=i;for(o in c)if(c.hasOwnProperty(o)){var h=c[o];o==="style"?eE(t,h):o==="dangerouslySetInnerHTML"?(h=h?h.__html:void 0,h!=null&&Jb(t,h)):o==="children"?typeof h=="string"?(n!=="textarea"||h!=="")&&lc(t,h):typeof h=="number"&&lc(t,""+h):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(ac.hasOwnProperty(o)?h!=null&&o==="onScroll"&&ht("scroll",t):h!=null&&hy(t,o,h,a))}switch(n){case"input":Pd(t),h0(t,r,!1);break;case"textarea":Pd(t),p0(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Js(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?al(t,!!r.multiple,o,!1):r.defaultValue!=null&&al(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Fh)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return sn(e),null;case 6:if(t&&e.stateNode!=null)ET(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(re(166));if(n=Ro(vc.current),Ro(hi.current),Od(e)){if(r=e.stateNode,n=e.memoizedProps,r[ai]=e,(o=r.nodeValue!==n)&&(t=Jn,t!==null))switch(t.tag){case 3:Md(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Md(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[ai]=e,e.stateNode=r}return sn(e),null;case 13:if(ft(bt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(gt&&Zn!==null&&e.mode&1&&!(e.flags&128))BE(),xl(),e.flags|=98560,o=!1;else if(o=Od(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(re(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(re(317));o[ai]=e}else xl(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;sn(e),o=!1}else Vr!==null&&(bg(Vr),Vr=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||bt.current&1?qt===0&&(qt=3):Ky())),e.updateQueue!==null&&(e.flags|=4),sn(e),null);case 4:return bl(),pg(t,e),t===null&&mc(e.stateNode.containerInfo),sn(e),null;case 10:return Cy(e.type._context),sn(e),null;case 17:return Bn(e.type)&&Uh(),sn(e),null;case 19:if(ft(bt),o=e.memoizedState,o===null)return sn(e),null;if(r=(e.flags&128)!==0,a=o.rendering,a===null)if(r)bu(o,!1);else{if(qt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Gh(t),a!==null){for(e.flags|=128,bu(o,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,a=o.alternate,a===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=a.childLanes,o.lanes=a.lanes,o.child=a.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=a.memoizedProps,o.memoizedState=a.memoizedState,o.updateQueue=a.updateQueue,o.type=a.type,t=a.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ct(bt,bt.current&1|2),e.child}t=t.sibling}o.tail!==null&&Lt()>Tl&&(e.flags|=128,r=!0,bu(o,!1),e.lanes=4194304)}else{if(!r)if(t=Gh(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),bu(o,!0),o.tail===null&&o.tailMode==="hidden"&&!a.alternate&&!gt)return sn(e),null}else 2*Lt()-o.renderingStartTime>Tl&&n!==1073741824&&(e.flags|=128,r=!0,bu(o,!1),e.lanes=4194304);o.isBackwards?(a.sibling=e.child,e.child=a):(n=o.last,n!==null?n.sibling=a:e.child=a,o.last=a)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=Lt(),e.sibling=null,n=bt.current,ct(bt,r?n&1|2:n&1),e):(sn(e),null);case 22:case 23:return Gy(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Kn&1073741824&&(sn(e),e.subtreeFlags&6&&(e.flags|=8192)):sn(e),null;case 24:return null;case 25:return null}throw Error(re(156,e.tag))}function AN(t,e){switch(Sy(e),e.tag){case 1:return Bn(e.type)&&Uh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return bl(),ft(Un),ft(pn),My(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Dy(e),null;case 13:if(ft(bt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(re(340));xl()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ft(bt),null;case 4:return bl(),null;case 10:return Cy(e.type._context),null;case 22:case 23:return Gy(),null;case 24:return null;default:return null}}var Ud=!1,ln=!1,NN=typeof WeakSet=="function"?WeakSet:Set,pe=null;function il(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){At(t,e,r)}else n.current=null}function mg(t,e,n){try{n()}catch(r){At(t,e,r)}}var rx=!1;function CN(t,e){if(Jm=Mh,t=PE(),Iy(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var a=0,c=-1,h=-1,p=0,y=0,v=t,w=null;t:for(;;){for(var S;v!==n||i!==0&&v.nodeType!==3||(c=a+i),v!==o||r!==0&&v.nodeType!==3||(h=a+r),v.nodeType===3&&(a+=v.nodeValue.length),(S=v.firstChild)!==null;)w=v,v=S;for(;;){if(v===t)break t;if(w===n&&++p===i&&(c=a),w===o&&++y===r&&(h=a),(S=v.nextSibling)!==null)break;v=w,w=v.parentNode}v=S}n=c===-1||h===-1?null:{start:c,end:h}}else n=null}n=n||{start:0,end:0}}else n=null;for(Xm={focusedElem:t,selectionRange:n},Mh=!1,pe=e;pe!==null;)if(e=pe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,pe=t;else for(;pe!==null;){e=pe;try{var N=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(N!==null){var A=N.memoizedProps,U=N.memoizedState,j=e.stateNode,k=j.getSnapshotBeforeUpdate(e.elementType===e.type?A:Mr(e.type,A),U);j.__reactInternalSnapshotBeforeUpdate=k}break;case 3:var R=e.stateNode.containerInfo;R.nodeType===1?R.textContent="":R.nodeType===9&&R.documentElement&&R.removeChild(R.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(re(163))}}catch(z){At(e,e.return,z)}if(t=e.sibling,t!==null){t.return=e.return,pe=t;break}pe=e.return}return N=rx,rx=!1,N}function Qu(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var o=i.destroy;i.destroy=void 0,o!==void 0&&mg(e,n,o)}i=i.next}while(i!==r)}}function Vf(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function gg(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function TT(t){var e=t.alternate;e!==null&&(t.alternate=null,TT(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[ai],delete e[yc],delete e[ng],delete e[fN],delete e[pN])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function IT(t){return t.tag===5||t.tag===3||t.tag===4}function ix(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||IT(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function yg(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Fh));else if(r!==4&&(t=t.child,t!==null))for(yg(t,e,n),t=t.sibling;t!==null;)yg(t,e,n),t=t.sibling}function _g(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(_g(t,e,n),t=t.sibling;t!==null;)_g(t,e,n),t=t.sibling}var Xt=null,Or=!1;function bs(t,e,n){for(n=n.child;n!==null;)kT(t,e,n),n=n.sibling}function kT(t,e,n){if(di&&typeof di.onCommitFiberUnmount=="function")try{di.onCommitFiberUnmount(Nf,n)}catch{}switch(n.tag){case 5:ln||il(n,e);case 6:var r=Xt,i=Or;Xt=null,bs(t,e,n),Xt=r,Or=i,Xt!==null&&(Or?(t=Xt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Xt.removeChild(n.stateNode));break;case 18:Xt!==null&&(Or?(t=Xt,n=n.stateNode,t.nodeType===8?Jp(t.parentNode,n):t.nodeType===1&&Jp(t,n),hc(t)):Jp(Xt,n.stateNode));break;case 4:r=Xt,i=Or,Xt=n.stateNode.containerInfo,Or=!0,bs(t,e,n),Xt=r,Or=i;break;case 0:case 11:case 14:case 15:if(!ln&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,a=o.destroy;o=o.tag,a!==void 0&&(o&2||o&4)&&mg(n,e,a),i=i.next}while(i!==r)}bs(t,e,n);break;case 1:if(!ln&&(il(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){At(n,e,c)}bs(t,e,n);break;case 21:bs(t,e,n);break;case 22:n.mode&1?(ln=(r=ln)||n.memoizedState!==null,bs(t,e,n),ln=r):bs(t,e,n);break;default:bs(t,e,n)}}function sx(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new NN),e.forEach(function(r){var i=UN.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Dr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var o=t,a=e,c=a;e:for(;c!==null;){switch(c.tag){case 5:Xt=c.stateNode,Or=!1;break e;case 3:Xt=c.stateNode.containerInfo,Or=!0;break e;case 4:Xt=c.stateNode.containerInfo,Or=!0;break e}c=c.return}if(Xt===null)throw Error(re(160));kT(o,a,i),Xt=null,Or=!1;var h=i.alternate;h!==null&&(h.return=null),i.return=null}catch(p){At(i,e,p)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)ST(e,t),e=e.sibling}function ST(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Dr(e,t),ri(t),r&4){try{Qu(3,t,t.return),Vf(3,t)}catch(A){At(t,t.return,A)}try{Qu(5,t,t.return)}catch(A){At(t,t.return,A)}}break;case 1:Dr(e,t),ri(t),r&512&&n!==null&&il(n,n.return);break;case 5:if(Dr(e,t),ri(t),r&512&&n!==null&&il(n,n.return),t.flags&32){var i=t.stateNode;try{lc(i,"")}catch(A){At(t,t.return,A)}}if(r&4&&(i=t.stateNode,i!=null)){var o=t.memoizedProps,a=n!==null?n.memoizedProps:o,c=t.type,h=t.updateQueue;if(t.updateQueue=null,h!==null)try{c==="input"&&o.type==="radio"&&o.name!=null&&Zb(i,o),zm(c,a);var p=zm(c,o);for(a=0;a<h.length;a+=2){var y=h[a],v=h[a+1];y==="style"?eE(i,v):y==="dangerouslySetInnerHTML"?Jb(i,v):y==="children"?lc(i,v):hy(i,y,v,p)}switch(c){case"input":Om(i,o);break;case"textarea":Qb(i,o);break;case"select":var w=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var S=o.value;S!=null?al(i,!!o.multiple,S,!1):w!==!!o.multiple&&(o.defaultValue!=null?al(i,!!o.multiple,o.defaultValue,!0):al(i,!!o.multiple,o.multiple?[]:"",!1))}i[yc]=o}catch(A){At(t,t.return,A)}}break;case 6:if(Dr(e,t),ri(t),r&4){if(t.stateNode===null)throw Error(re(162));i=t.stateNode,o=t.memoizedProps;try{i.nodeValue=o}catch(A){At(t,t.return,A)}}break;case 3:if(Dr(e,t),ri(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{hc(e.containerInfo)}catch(A){At(t,t.return,A)}break;case 4:Dr(e,t),ri(t);break;case 13:Dr(e,t),ri(t),i=t.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(Hy=Lt())),r&4&&sx(t);break;case 22:if(y=n!==null&&n.memoizedState!==null,t.mode&1?(ln=(p=ln)||y,Dr(e,t),ln=p):Dr(e,t),ri(t),r&8192){if(p=t.memoizedState!==null,(t.stateNode.isHidden=p)&&!y&&t.mode&1)for(pe=t,y=t.child;y!==null;){for(v=pe=y;pe!==null;){switch(w=pe,S=w.child,w.tag){case 0:case 11:case 14:case 15:Qu(4,w,w.return);break;case 1:il(w,w.return);var N=w.stateNode;if(typeof N.componentWillUnmount=="function"){r=w,n=w.return;try{e=r,N.props=e.memoizedProps,N.state=e.memoizedState,N.componentWillUnmount()}catch(A){At(r,n,A)}}break;case 5:il(w,w.return);break;case 22:if(w.memoizedState!==null){ax(v);continue}}S!==null?(S.return=w,pe=S):ax(v)}y=y.sibling}e:for(y=null,v=t;;){if(v.tag===5){if(y===null){y=v;try{i=v.stateNode,p?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(c=v.stateNode,h=v.memoizedProps.style,a=h!=null&&h.hasOwnProperty("display")?h.display:null,c.style.display=Xb("display",a))}catch(A){At(t,t.return,A)}}}else if(v.tag===6){if(y===null)try{v.stateNode.nodeValue=p?"":v.memoizedProps}catch(A){At(t,t.return,A)}}else if((v.tag!==22&&v.tag!==23||v.memoizedState===null||v===t)&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===t)break e;for(;v.sibling===null;){if(v.return===null||v.return===t)break e;y===v&&(y=null),v=v.return}y===v&&(y=null),v.sibling.return=v.return,v=v.sibling}}break;case 19:Dr(e,t),ri(t),r&4&&sx(t);break;case 21:break;default:Dr(e,t),ri(t)}}function ri(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(IT(n)){var r=n;break e}n=n.return}throw Error(re(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(lc(i,""),r.flags&=-33);var o=ix(t);_g(t,o,i);break;case 3:case 4:var a=r.stateNode.containerInfo,c=ix(t);yg(t,c,a);break;default:throw Error(re(161))}}catch(h){At(t,t.return,h)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function RN(t,e,n){pe=t,PT(t)}function PT(t,e,n){for(var r=(t.mode&1)!==0;pe!==null;){var i=pe,o=i.child;if(i.tag===22&&r){var a=i.memoizedState!==null||Ud;if(!a){var c=i.alternate,h=c!==null&&c.memoizedState!==null||ln;c=Ud;var p=ln;if(Ud=a,(ln=h)&&!p)for(pe=i;pe!==null;)a=pe,h=a.child,a.tag===22&&a.memoizedState!==null?lx(i):h!==null?(h.return=a,pe=h):lx(i);for(;o!==null;)pe=o,PT(o),o=o.sibling;pe=i,Ud=c,ln=p}ox(t)}else i.subtreeFlags&8772&&o!==null?(o.return=i,pe=o):ox(t)}}function ox(t){for(;pe!==null;){var e=pe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ln||Vf(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!ln)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Mr(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&$0(e,o,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}$0(e,a,n)}break;case 5:var c=e.stateNode;if(n===null&&e.flags&4){n=c;var h=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":h.autoFocus&&n.focus();break;case"img":h.src&&(n.src=h.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var p=e.alternate;if(p!==null){var y=p.memoizedState;if(y!==null){var v=y.dehydrated;v!==null&&hc(v)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(re(163))}ln||e.flags&512&&gg(e)}catch(w){At(e,e.return,w)}}if(e===t){pe=null;break}if(n=e.sibling,n!==null){n.return=e.return,pe=n;break}pe=e.return}}function ax(t){for(;pe!==null;){var e=pe;if(e===t){pe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,pe=n;break}pe=e.return}}function lx(t){for(;pe!==null;){var e=pe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Vf(4,e)}catch(h){At(e,n,h)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(h){At(e,i,h)}}var o=e.return;try{gg(e)}catch(h){At(e,o,h)}break;case 5:var a=e.return;try{gg(e)}catch(h){At(e,a,h)}}}catch(h){At(e,e.return,h)}if(e===t){pe=null;break}var c=e.sibling;if(c!==null){c.return=e.return,pe=c;break}pe=e.return}}var jN=Math.ceil,Qh=Ji.ReactCurrentDispatcher,qy=Ji.ReactCurrentOwner,vr=Ji.ReactCurrentBatchConfig,Ge=0,Yt=null,Ut=null,tn=0,Kn=0,sl=io(0),qt=0,Ec=null,qo=0,Ff=0,$y=0,Yu=null,Ln=null,Hy=0,Tl=1/0,Pi=null,Yh=!1,vg=null,Ws=null,Bd=!1,Os=null,Jh=0,Ju=0,xg=null,dh=-1,hh=0;function bn(){return Ge&6?Lt():dh!==-1?dh:dh=Lt()}function Gs(t){return t.mode&1?Ge&2&&tn!==0?tn&-tn:gN.transition!==null?(hh===0&&(hh=hE()),hh):(t=rt,t!==0||(t=window.event,t=t===void 0?16:vE(t.type)),t):1}function Br(t,e,n,r){if(50<Ju)throw Ju=0,xg=null,Error(re(185));qc(t,n,r),(!(Ge&2)||t!==Yt)&&(t===Yt&&(!(Ge&2)&&(Ff|=n),qt===4&&As(t,tn)),zn(t,r),n===1&&Ge===0&&!(e.mode&1)&&(Tl=Lt()+500,Df&&so()))}function zn(t,e){var n=t.callbackNode;gA(t,e);var r=Dh(t,t===Yt?tn:0);if(r===0)n!==null&&y0(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&y0(n),e===1)t.tag===0?mN(ux.bind(null,t)):VE(ux.bind(null,t)),dN(function(){!(Ge&6)&&so()}),n=null;else{switch(fE(r)){case 1:n=yy;break;case 4:n=cE;break;case 16:n=Lh;break;case 536870912:n=dE;break;default:n=Lh}n=MT(n,AT.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function AT(t,e){if(dh=-1,hh=0,Ge&6)throw Error(re(327));var n=t.callbackNode;if(hl()&&t.callbackNode!==n)return null;var r=Dh(t,t===Yt?tn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Xh(t,r);else{e=r;var i=Ge;Ge|=2;var o=CT();(Yt!==t||tn!==e)&&(Pi=null,Tl=Lt()+500,Do(t,e));do try{MN();break}catch(c){NT(t,c)}while(!0);Ny(),Qh.current=o,Ge=i,Ut!==null?e=0:(Yt=null,tn=0,e=qt)}if(e!==0){if(e===2&&(i=Gm(t),i!==0&&(r=i,e=wg(t,i))),e===1)throw n=Ec,Do(t,0),As(t,r),zn(t,Lt()),n;if(e===6)As(t,r);else{if(i=t.current.alternate,!(r&30)&&!LN(i)&&(e=Xh(t,r),e===2&&(o=Gm(t),o!==0&&(r=o,e=wg(t,o))),e===1))throw n=Ec,Do(t,0),As(t,r),zn(t,Lt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(re(345));case 2:bo(t,Ln,Pi);break;case 3:if(As(t,r),(r&130023424)===r&&(e=Hy+500-Lt(),10<e)){if(Dh(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){bn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=tg(bo.bind(null,t,Ln,Pi),e);break}bo(t,Ln,Pi);break;case 4:if(As(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var a=31-Ur(r);o=1<<a,a=e[a],a>i&&(i=a),r&=~o}if(r=i,r=Lt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*jN(r/1960))-r,10<r){t.timeoutHandle=tg(bo.bind(null,t,Ln,Pi),r);break}bo(t,Ln,Pi);break;case 5:bo(t,Ln,Pi);break;default:throw Error(re(329))}}}return zn(t,Lt()),t.callbackNode===n?AT.bind(null,t):null}function wg(t,e){var n=Yu;return t.current.memoizedState.isDehydrated&&(Do(t,e).flags|=256),t=Xh(t,e),t!==2&&(e=Ln,Ln=n,e!==null&&bg(e)),t}function bg(t){Ln===null?Ln=t:Ln.push.apply(Ln,t)}function LN(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!$r(o(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function As(t,e){for(e&=~$y,e&=~Ff,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Ur(e),r=1<<n;t[n]=-1,e&=~r}}function ux(t){if(Ge&6)throw Error(re(327));hl();var e=Dh(t,0);if(!(e&1))return zn(t,Lt()),null;var n=Xh(t,e);if(t.tag!==0&&n===2){var r=Gm(t);r!==0&&(e=r,n=wg(t,r))}if(n===1)throw n=Ec,Do(t,0),As(t,e),zn(t,Lt()),n;if(n===6)throw Error(re(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,bo(t,Ln,Pi),zn(t,Lt()),null}function Wy(t,e){var n=Ge;Ge|=1;try{return t(e)}finally{Ge=n,Ge===0&&(Tl=Lt()+500,Df&&so())}}function $o(t){Os!==null&&Os.tag===0&&!(Ge&6)&&hl();var e=Ge;Ge|=1;var n=vr.transition,r=rt;try{if(vr.transition=null,rt=1,t)return t()}finally{rt=r,vr.transition=n,Ge=e,!(Ge&6)&&so()}}function Gy(){Kn=sl.current,ft(sl)}function Do(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,cN(n)),Ut!==null)for(n=Ut.return;n!==null;){var r=n;switch(Sy(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Uh();break;case 3:bl(),ft(Un),ft(pn),My();break;case 5:Dy(r);break;case 4:bl();break;case 13:ft(bt);break;case 19:ft(bt);break;case 10:Cy(r.type._context);break;case 22:case 23:Gy()}n=n.return}if(Yt=t,Ut=t=Ks(t.current,null),tn=Kn=e,qt=0,Ec=null,$y=Ff=qo=0,Ln=Yu=null,Co!==null){for(e=0;e<Co.length;e++)if(n=Co[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,o=n.pending;if(o!==null){var a=o.next;o.next=i,r.next=a}n.pending=r}Co=null}return t}function NT(t,e){do{var n=Ut;try{if(Ny(),lh.current=Zh,Kh){for(var r=It.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Kh=!1}if(zo=0,Qt=zt=It=null,Zu=!1,xc=0,qy.current=null,n===null||n.return===null){qt=1,Ec=e,Ut=null;break}e:{var o=t,a=n.return,c=n,h=e;if(e=tn,c.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){var p=h,y=c,v=y.tag;if(!(y.mode&1)&&(v===0||v===11||v===15)){var w=y.alternate;w?(y.updateQueue=w.updateQueue,y.memoizedState=w.memoizedState,y.lanes=w.lanes):(y.updateQueue=null,y.memoizedState=null)}var S=Q0(a);if(S!==null){S.flags&=-257,Y0(S,a,c,o,e),S.mode&1&&Z0(o,p,e),e=S,h=p;var N=e.updateQueue;if(N===null){var A=new Set;A.add(h),e.updateQueue=A}else N.add(h);break e}else{if(!(e&1)){Z0(o,p,e),Ky();break e}h=Error(re(426))}}else if(gt&&c.mode&1){var U=Q0(a);if(U!==null){!(U.flags&65536)&&(U.flags|=256),Y0(U,a,c,o,e),Py(El(h,c));break e}}o=h=El(h,c),qt!==4&&(qt=2),Yu===null?Yu=[o]:Yu.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var j=fT(o,h,e);q0(o,j);break e;case 1:c=h;var k=o.type,R=o.stateNode;if(!(o.flags&128)&&(typeof k.getDerivedStateFromError=="function"||R!==null&&typeof R.componentDidCatch=="function"&&(Ws===null||!Ws.has(R)))){o.flags|=65536,e&=-e,o.lanes|=e;var z=pT(o,c,e);q0(o,z);break e}}o=o.return}while(o!==null)}jT(n)}catch(K){e=K,Ut===n&&n!==null&&(Ut=n=n.return);continue}break}while(!0)}function CT(){var t=Qh.current;return Qh.current=Zh,t===null?Zh:t}function Ky(){(qt===0||qt===3||qt===2)&&(qt=4),Yt===null||!(qo&268435455)&&!(Ff&268435455)||As(Yt,tn)}function Xh(t,e){var n=Ge;Ge|=2;var r=CT();(Yt!==t||tn!==e)&&(Pi=null,Do(t,e));do try{DN();break}catch(i){NT(t,i)}while(!0);if(Ny(),Ge=n,Qh.current=r,Ut!==null)throw Error(re(261));return Yt=null,tn=0,qt}function DN(){for(;Ut!==null;)RT(Ut)}function MN(){for(;Ut!==null&&!aA();)RT(Ut)}function RT(t){var e=DT(t.alternate,t,Kn);t.memoizedProps=t.pendingProps,e===null?jT(t):Ut=e,qy.current=null}function jT(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=AN(n,e),n!==null){n.flags&=32767,Ut=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{qt=6,Ut=null;return}}else if(n=PN(n,e,Kn),n!==null){Ut=n;return}if(e=e.sibling,e!==null){Ut=e;return}Ut=e=t}while(e!==null);qt===0&&(qt=5)}function bo(t,e,n){var r=rt,i=vr.transition;try{vr.transition=null,rt=1,ON(t,e,n,r)}finally{vr.transition=i,rt=r}return null}function ON(t,e,n,r){do hl();while(Os!==null);if(Ge&6)throw Error(re(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(re(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(yA(t,o),t===Yt&&(Ut=Yt=null,tn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Bd||(Bd=!0,MT(Lh,function(){return hl(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=vr.transition,vr.transition=null;var a=rt;rt=1;var c=Ge;Ge|=4,qy.current=null,CN(t,n),ST(n,t),rN(Xm),Mh=!!Jm,Xm=Jm=null,t.current=n,RN(n),lA(),Ge=c,rt=a,vr.transition=o}else t.current=n;if(Bd&&(Bd=!1,Os=t,Jh=i),o=t.pendingLanes,o===0&&(Ws=null),dA(n.stateNode),zn(t,Lt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Yh)throw Yh=!1,t=vg,vg=null,t;return Jh&1&&t.tag!==0&&hl(),o=t.pendingLanes,o&1?t===xg?Ju++:(Ju=0,xg=t):Ju=0,so(),null}function hl(){if(Os!==null){var t=fE(Jh),e=vr.transition,n=rt;try{if(vr.transition=null,rt=16>t?16:t,Os===null)var r=!1;else{if(t=Os,Os=null,Jh=0,Ge&6)throw Error(re(331));var i=Ge;for(Ge|=4,pe=t.current;pe!==null;){var o=pe,a=o.child;if(pe.flags&16){var c=o.deletions;if(c!==null){for(var h=0;h<c.length;h++){var p=c[h];for(pe=p;pe!==null;){var y=pe;switch(y.tag){case 0:case 11:case 15:Qu(8,y,o)}var v=y.child;if(v!==null)v.return=y,pe=v;else for(;pe!==null;){y=pe;var w=y.sibling,S=y.return;if(TT(y),y===p){pe=null;break}if(w!==null){w.return=S,pe=w;break}pe=S}}}var N=o.alternate;if(N!==null){var A=N.child;if(A!==null){N.child=null;do{var U=A.sibling;A.sibling=null,A=U}while(A!==null)}}pe=o}}if(o.subtreeFlags&2064&&a!==null)a.return=o,pe=a;else e:for(;pe!==null;){if(o=pe,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Qu(9,o,o.return)}var j=o.sibling;if(j!==null){j.return=o.return,pe=j;break e}pe=o.return}}var k=t.current;for(pe=k;pe!==null;){a=pe;var R=a.child;if(a.subtreeFlags&2064&&R!==null)R.return=a,pe=R;else e:for(a=k;pe!==null;){if(c=pe,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:Vf(9,c)}}catch(K){At(c,c.return,K)}if(c===a){pe=null;break e}var z=c.sibling;if(z!==null){z.return=c.return,pe=z;break e}pe=c.return}}if(Ge=i,so(),di&&typeof di.onPostCommitFiberRoot=="function")try{di.onPostCommitFiberRoot(Nf,t)}catch{}r=!0}return r}finally{rt=n,vr.transition=e}}return!1}function cx(t,e,n){e=El(n,e),e=fT(t,e,1),t=Hs(t,e,1),e=bn(),t!==null&&(qc(t,1,e),zn(t,e))}function At(t,e,n){if(t.tag===3)cx(t,t,n);else for(;e!==null;){if(e.tag===3){cx(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ws===null||!Ws.has(r))){t=El(n,t),t=pT(e,t,1),e=Hs(e,t,1),t=bn(),e!==null&&(qc(e,1,t),zn(e,t));break}}e=e.return}}function VN(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=bn(),t.pingedLanes|=t.suspendedLanes&n,Yt===t&&(tn&n)===n&&(qt===4||qt===3&&(tn&130023424)===tn&&500>Lt()-Hy?Do(t,0):$y|=n),zn(t,e)}function LT(t,e){e===0&&(t.mode&1?(e=Cd,Cd<<=1,!(Cd&130023424)&&(Cd=4194304)):e=1);var n=bn();t=Wi(t,e),t!==null&&(qc(t,e,n),zn(t,n))}function FN(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),LT(t,n)}function UN(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(re(314))}r!==null&&r.delete(e),LT(t,n)}var DT;DT=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Un.current)On=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return On=!1,SN(t,e,n);On=!!(t.flags&131072)}else On=!1,gt&&e.flags&1048576&&FE(e,qh,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;ch(t,e),t=e.pendingProps;var i=vl(e,pn.current);dl(e,n),i=Vy(null,e,r,t,i,n);var o=Fy();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Bn(r)?(o=!0,Bh(e)):o=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,jy(e),i.updater=Of,e.stateNode=i,i._reactInternals=e,lg(e,r,t,n),e=dg(null,e,r,!0,o,n)):(e.tag=0,gt&&o&&ky(e),wn(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(ch(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=zN(r),t=Mr(r,t),i){case 0:e=cg(null,e,r,t,n);break e;case 1:e=ex(null,e,r,t,n);break e;case 11:e=J0(null,e,r,t,n);break e;case 14:e=X0(null,e,r,Mr(r.type,t),n);break e}throw Error(re(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Mr(r,i),cg(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Mr(r,i),ex(t,e,r,i,n);case 3:e:{if(_T(e),t===null)throw Error(re(387));r=e.pendingProps,o=e.memoizedState,i=o.element,HE(t,e),Wh(e,r,null,n);var a=e.memoizedState;if(r=a.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){i=El(Error(re(423)),e),e=tx(t,e,r,n,i);break e}else if(r!==i){i=El(Error(re(424)),e),e=tx(t,e,r,n,i);break e}else for(Zn=$s(e.stateNode.containerInfo.firstChild),Jn=e,gt=!0,Vr=null,n=qE(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(xl(),r===i){e=Gi(t,e,n);break e}wn(t,e,r,n)}e=e.child}return e;case 5:return WE(e),t===null&&sg(e),r=e.type,i=e.pendingProps,o=t!==null?t.memoizedProps:null,a=i.children,eg(r,i)?a=null:o!==null&&eg(r,o)&&(e.flags|=32),yT(t,e),wn(t,e,a,n),e.child;case 6:return t===null&&sg(e),null;case 13:return vT(t,e,n);case 4:return Ly(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=wl(e,null,r,n):wn(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Mr(r,i),J0(t,e,r,i,n);case 7:return wn(t,e,e.pendingProps,n),e.child;case 8:return wn(t,e,e.pendingProps.children,n),e.child;case 12:return wn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,o=e.memoizedProps,a=i.value,ct($h,r._currentValue),r._currentValue=a,o!==null)if($r(o.value,a)){if(o.children===i.children&&!Un.current){e=Gi(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var c=o.dependencies;if(c!==null){a=o.child;for(var h=c.firstContext;h!==null;){if(h.context===r){if(o.tag===1){h=Ui(-1,n&-n),h.tag=2;var p=o.updateQueue;if(p!==null){p=p.shared;var y=p.pending;y===null?h.next=h:(h.next=y.next,y.next=h),p.pending=h}}o.lanes|=n,h=o.alternate,h!==null&&(h.lanes|=n),og(o.return,n,e),c.lanes|=n;break}h=h.next}}else if(o.tag===10)a=o.type===e.type?null:o.child;else if(o.tag===18){if(a=o.return,a===null)throw Error(re(341));a.lanes|=n,c=a.alternate,c!==null&&(c.lanes|=n),og(a,n,e),a=o.sibling}else a=o.child;if(a!==null)a.return=o;else for(a=o;a!==null;){if(a===e){a=null;break}if(o=a.sibling,o!==null){o.return=a.return,a=o;break}a=a.return}o=a}wn(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,dl(e,n),i=xr(i),r=r(i),e.flags|=1,wn(t,e,r,n),e.child;case 14:return r=e.type,i=Mr(r,e.pendingProps),i=Mr(r.type,i),X0(t,e,r,i,n);case 15:return mT(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Mr(r,i),ch(t,e),e.tag=1,Bn(r)?(t=!0,Bh(e)):t=!1,dl(e,n),hT(e,r,i),lg(e,r,i,n),dg(null,e,r,!0,t,n);case 19:return xT(t,e,n);case 22:return gT(t,e,n)}throw Error(re(156,e.tag))};function MT(t,e){return uE(t,e)}function BN(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function _r(t,e,n,r){return new BN(t,e,n,r)}function Zy(t){return t=t.prototype,!(!t||!t.isReactComponent)}function zN(t){if(typeof t=="function")return Zy(t)?1:0;if(t!=null){if(t=t.$$typeof,t===py)return 11;if(t===my)return 14}return 2}function Ks(t,e){var n=t.alternate;return n===null?(n=_r(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function fh(t,e,n,r,i,o){var a=2;if(r=t,typeof t=="function")Zy(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Za:return Mo(n.children,i,o,e);case fy:a=8,i|=8;break;case Rm:return t=_r(12,n,e,i|2),t.elementType=Rm,t.lanes=o,t;case jm:return t=_r(13,n,e,i),t.elementType=jm,t.lanes=o,t;case Lm:return t=_r(19,n,e,i),t.elementType=Lm,t.lanes=o,t;case Wb:return Uf(n,i,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case $b:a=10;break e;case Hb:a=9;break e;case py:a=11;break e;case my:a=14;break e;case ks:a=16,r=null;break e}throw Error(re(130,t==null?t:typeof t,""))}return e=_r(a,n,e,i),e.elementType=t,e.type=r,e.lanes=o,e}function Mo(t,e,n,r){return t=_r(7,t,r,e),t.lanes=n,t}function Uf(t,e,n,r){return t=_r(22,t,r,e),t.elementType=Wb,t.lanes=n,t.stateNode={isHidden:!1},t}function om(t,e,n){return t=_r(6,t,null,e),t.lanes=n,t}function am(t,e,n){return e=_r(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function qN(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Bp(0),this.expirationTimes=Bp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Bp(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Qy(t,e,n,r,i,o,a,c,h){return t=new qN(t,e,n,c,h),e===1?(e=1,o===!0&&(e|=8)):e=0,o=_r(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},jy(o),t}function $N(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ka,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function OT(t){if(!t)return Xs;t=t._reactInternals;e:{if(oa(t)!==t||t.tag!==1)throw Error(re(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Bn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(re(171))}if(t.tag===1){var n=t.type;if(Bn(n))return OE(t,n,e)}return e}function VT(t,e,n,r,i,o,a,c,h){return t=Qy(n,r,!0,t,i,o,a,c,h),t.context=OT(null),n=t.current,r=bn(),i=Gs(n),o=Ui(r,i),o.callback=e??null,Hs(n,o,i),t.current.lanes=i,qc(t,i,r),zn(t,r),t}function Bf(t,e,n,r){var i=e.current,o=bn(),a=Gs(i);return n=OT(n),e.context===null?e.context=n:e.pendingContext=n,e=Ui(o,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Hs(i,e,a),t!==null&&(Br(t,i,a,o),ah(t,i,a)),a}function ef(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function dx(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Yy(t,e){dx(t,e),(t=t.alternate)&&dx(t,e)}function HN(){return null}var FT=typeof reportError=="function"?reportError:function(t){console.error(t)};function Jy(t){this._internalRoot=t}zf.prototype.render=Jy.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(re(409));Bf(t,e,null,null)};zf.prototype.unmount=Jy.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;$o(function(){Bf(null,t,null,null)}),e[Hi]=null}};function zf(t){this._internalRoot=t}zf.prototype.unstable_scheduleHydration=function(t){if(t){var e=gE();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ps.length&&e!==0&&e<Ps[n].priority;n++);Ps.splice(n,0,t),n===0&&_E(t)}};function Xy(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function qf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function hx(){}function WN(t,e,n,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var p=ef(a);o.call(p)}}var a=VT(e,r,t,0,null,!1,!1,"",hx);return t._reactRootContainer=a,t[Hi]=a.current,mc(t.nodeType===8?t.parentNode:t),$o(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var c=r;r=function(){var p=ef(h);c.call(p)}}var h=Qy(t,0,!1,null,null,!1,!1,"",hx);return t._reactRootContainer=h,t[Hi]=h.current,mc(t.nodeType===8?t.parentNode:t),$o(function(){Bf(e,h,n,r)}),h}function $f(t,e,n,r,i){var o=n._reactRootContainer;if(o){var a=o;if(typeof i=="function"){var c=i;i=function(){var h=ef(a);c.call(h)}}Bf(e,a,t,i)}else a=WN(n,e,t,i,r);return ef(a)}pE=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Du(e.pendingLanes);n!==0&&(_y(e,n|1),zn(e,Lt()),!(Ge&6)&&(Tl=Lt()+500,so()))}break;case 13:$o(function(){var r=Wi(t,1);if(r!==null){var i=bn();Br(r,t,1,i)}}),Yy(t,1)}};vy=function(t){if(t.tag===13){var e=Wi(t,134217728);if(e!==null){var n=bn();Br(e,t,134217728,n)}Yy(t,134217728)}};mE=function(t){if(t.tag===13){var e=Gs(t),n=Wi(t,e);if(n!==null){var r=bn();Br(n,t,e,r)}Yy(t,e)}};gE=function(){return rt};yE=function(t,e){var n=rt;try{return rt=t,e()}finally{rt=n}};$m=function(t,e,n){switch(e){case"input":if(Om(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Lf(r);if(!i)throw Error(re(90));Kb(r),Om(r,i)}}}break;case"textarea":Qb(t,n);break;case"select":e=n.value,e!=null&&al(t,!!n.multiple,e,!1)}};rE=Wy;iE=$o;var GN={usingClientEntryPoint:!1,Events:[Hc,Xa,Lf,tE,nE,Wy]},Eu={findFiberByHostInstance:No,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},KN={bundleType:Eu.bundleType,version:Eu.version,rendererPackageName:Eu.rendererPackageName,rendererConfig:Eu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ji.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=aE(t),t===null?null:t.stateNode},findFiberByHostInstance:Eu.findFiberByHostInstance||HN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zd.isDisabled&&zd.supportsFiber)try{Nf=zd.inject(KN),di=zd}catch{}}ir.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=GN;ir.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Xy(e))throw Error(re(200));return $N(t,e,null,n)};ir.createRoot=function(t,e){if(!Xy(t))throw Error(re(299));var n=!1,r="",i=FT;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Qy(t,1,!1,null,null,n,!1,r,i),t[Hi]=e.current,mc(t.nodeType===8?t.parentNode:t),new Jy(e)};ir.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(re(188)):(t=Object.keys(t).join(","),Error(re(268,t)));return t=aE(e),t=t===null?null:t.stateNode,t};ir.flushSync=function(t){return $o(t)};ir.hydrate=function(t,e,n){if(!qf(e))throw Error(re(200));return $f(null,t,e,!0,n)};ir.hydrateRoot=function(t,e,n){if(!Xy(t))throw Error(re(405));var r=n!=null&&n.hydratedSources||null,i=!1,o="",a=FT;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=VT(e,null,t,1,n??null,i,!1,o,a),t[Hi]=e.current,mc(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new zf(e)};ir.render=function(t,e,n){if(!qf(e))throw Error(re(200));return $f(null,t,e,!1,n)};ir.unmountComponentAtNode=function(t){if(!qf(t))throw Error(re(40));return t._reactRootContainer?($o(function(){$f(null,null,t,!1,function(){t._reactRootContainer=null,t[Hi]=null})}),!0):!1};ir.unstable_batchedUpdates=Wy;ir.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!qf(n))throw Error(re(200));if(t==null||t._reactInternals===void 0)throw Error(re(38));return $f(t,e,n,!1,r)};ir.version="18.3.1-next-f1338f8080-20240426";function UT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(UT)}catch(t){console.error(t)}}UT(),Ub.exports=ir;var BT=Ub.exports,fx=BT;Nm.createRoot=fx.createRoot,Nm.hydrateRoot=fx.hydrateRoot;const ZN="modulepreload",QN=function(t){return"/"+t},px={},YN=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),c=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(n.map(h=>{if(h=QN(h),h in px)return;px[h]=!0;const p=h.endsWith(".css"),y=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${y}`))return;const v=document.createElement("link");if(v.rel=p?"stylesheet":ZN,p||(v.as="script"),v.crossOrigin="",v.href=h,c&&v.setAttribute("nonce",c),document.head.appendChild(v),p)return new Promise((w,S)=>{v.addEventListener("load",w),v.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${h}`)))})}))}function o(a){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=a,window.dispatchEvent(c),!c.defaultPrevented)throw a}return i.then(a=>{for(const c of a||[])c.status==="rejected"&&o(c.reason);return e().catch(o)})};var mx={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zT=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},JN=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const o=t[n++];e[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=t[n++],a=t[n++],c=t[n++],h=((i&7)<<18|(o&63)<<12|(a&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{const o=t[n++],a=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|a&63)}}return e.join("")},qT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const o=t[i],a=i+1<t.length,c=a?t[i+1]:0,h=i+2<t.length,p=h?t[i+2]:0,y=o>>2,v=(o&3)<<4|c>>4;let w=(c&15)<<2|p>>6,S=p&63;h||(S=64,a||(w=64)),r.push(n[y],n[v],n[w],n[S])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(zT(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):JN(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const o=n[t.charAt(i++)],c=i<t.length?n[t.charAt(i)]:0;++i;const p=i<t.length?n[t.charAt(i)]:64;++i;const v=i<t.length?n[t.charAt(i)]:64;if(++i,o==null||c==null||p==null||v==null)throw new XN;const w=o<<2|c>>4;if(r.push(w),p!==64){const S=c<<4&240|p>>2;if(r.push(S),v!==64){const N=p<<6&192|v;r.push(N)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class XN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const eC=function(t){const e=zT(t);return qT.encodeByteArray(e,!0)},tf=function(t){return eC(t).replace(/\./g,"")},$T=function(t){try{return qT.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nC=()=>tC().__FIREBASE_DEFAULTS__,rC=()=>{if(typeof process>"u"||typeof mx>"u")return;const t=mx.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},iC=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&$T(t[1]);return e&&JSON.parse(e)},Hf=()=>{try{return nC()||rC()||iC()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},HT=t=>{var e,n;return(n=(e=Hf())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},WT=t=>{const e=HT(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},GT=()=>{var t;return(t=Hf())===null||t===void 0?void 0:t.config},KT=t=>{var e;return(e=Hf())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oC(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},t);return[tf(JSON.stringify(n)),tf(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $t(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function aC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test($t())}function lC(){var t;const e=(t=Hf())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function uC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function cC(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function dC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function hC(){const t=$t();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function ZT(){return!lC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function e_(){try{return typeof indexedDB=="object"}catch{return!1}}function QT(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var o;e(((o=i.error)===null||o===void 0?void 0:o.message)||"")}}catch(n){e(n)}})}function fC(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pC="FirebaseError";class Tr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=pC,Object.setPrototypeOf(this,Tr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,aa.prototype.create)}}class aa{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,o=this.errors[e],a=o?mC(o,r):"Error",c=`${this.serviceName}: ${a} (${i}).`;return new Tr(i,c,r)}}function mC(t,e){return t.replace(gC,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const gC=/\{\$([^}]+)}/g;function yC(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Il(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const o=t[i],a=e[i];if(gx(o)&&gx(a)){if(!Il(o,a))return!1}else if(o!==a)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function gx(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gc(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Ou(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,o]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(o)}}),e}function Vu(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function _C(t,e){const n=new vC(t,e);return n.subscribe.bind(n)}class vC{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");xC(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=lm),i.error===void 0&&(i.error=lm),i.complete===void 0&&(i.complete=lm);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function xC(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function lm(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ye(t){return t&&t._delegate?t._delegate:t}class nr{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wC{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new sC;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(EC(e))try{this.getOrInitializeService({instanceIdentifier:Eo})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(e=Eo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Eo){return this.instances.has(e)}getOptions(e=Eo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[o,a]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(o);r===c&&a.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),o=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;o.add(e),this.onInitCallbacks.set(i,o);const a=this.instances.get(i);return a&&e(a,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:bC(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Eo){return this.component?this.component.multipleInstances?e:Eo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function bC(t){return t===Eo?void 0:t}function EC(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new wC(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Be;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Be||(Be={}));const IC={debug:Be.DEBUG,verbose:Be.VERBOSE,info:Be.INFO,warn:Be.WARN,error:Be.ERROR,silent:Be.SILENT},kC=Be.INFO,SC={[Be.DEBUG]:"log",[Be.VERBOSE]:"log",[Be.INFO]:"info",[Be.WARN]:"warn",[Be.ERROR]:"error"},PC=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=SC[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class t_{constructor(e){this.name=e,this._logLevel=kC,this._logHandler=PC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Be))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?IC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Be.DEBUG,...e),this._logHandler(this,Be.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Be.VERBOSE,...e),this._logHandler(this,Be.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Be.INFO,...e),this._logHandler(this,Be.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Be.WARN,...e),this._logHandler(this,Be.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Be.ERROR,...e),this._logHandler(this,Be.ERROR,...e)}}const AC=(t,e)=>e.some(n=>t instanceof n);let yx,_x;function NC(){return yx||(yx=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function CC(){return _x||(_x=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const YT=new WeakMap,Eg=new WeakMap,JT=new WeakMap,um=new WeakMap,n_=new WeakMap;function RC(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",o),t.removeEventListener("error",a)},o=()=>{n(Bi(t.result)),i()},a=()=>{r(t.error),i()};t.addEventListener("success",o),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&YT.set(n,t)}).catch(()=>{}),n_.set(e,t),e}function jC(t){if(Eg.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",a),t.removeEventListener("abort",a)},o=()=>{n(),i()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",o),t.addEventListener("error",a),t.addEventListener("abort",a)});Eg.set(t,e)}let Tg={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Eg.get(t);if(e==="objectStoreNames")return t.objectStoreNames||JT.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Bi(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function LC(t){Tg=t(Tg)}function DC(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(cm(this),e,...n);return JT.set(r,e.sort?e.sort():[e]),Bi(r)}:CC().includes(t)?function(...e){return t.apply(cm(this),e),Bi(YT.get(this))}:function(...e){return Bi(t.apply(cm(this),e))}}function MC(t){return typeof t=="function"?DC(t):(t instanceof IDBTransaction&&jC(t),AC(t,NC())?new Proxy(t,Tg):t)}function Bi(t){if(t instanceof IDBRequest)return RC(t);if(um.has(t))return um.get(t);const e=MC(t);return e!==t&&(um.set(t,e),n_.set(e,t)),e}const cm=t=>n_.get(t);function Wf(t,e,{blocked:n,upgrade:r,blocking:i,terminated:o}={}){const a=indexedDB.open(t,e),c=Bi(a);return r&&a.addEventListener("upgradeneeded",h=>{r(Bi(a.result),h.oldVersion,h.newVersion,Bi(a.transaction),h)}),n&&a.addEventListener("blocked",h=>n(h.oldVersion,h.newVersion,h)),c.then(h=>{o&&h.addEventListener("close",()=>o()),i&&h.addEventListener("versionchange",p=>i(p.oldVersion,p.newVersion,p))}).catch(()=>{}),c}function dm(t,{blocked:e}={}){const n=indexedDB.deleteDatabase(t);return e&&n.addEventListener("blocked",r=>e(r.oldVersion,r)),Bi(n).then(()=>{})}const OC=["get","getKey","getAll","getAllKeys","count"],VC=["put","add","delete","clear"],hm=new Map;function vx(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(hm.get(e))return hm.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=VC.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||OC.includes(n)))return;const o=async function(a,...c){const h=this.transaction(a,i?"readwrite":"readonly");let p=h.store;return r&&(p=p.index(c.shift())),(await Promise.all([p[n](...c),i&&h.done]))[0]};return hm.set(e,o),o}LC(t=>({...t,get:(e,n,r)=>vx(e,n)||t.get(e,n,r),has:(e,n)=>!!vx(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FC{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(UC(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function UC(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Ig="@firebase/app",xx="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ki=new t_("@firebase/app"),BC="@firebase/app-compat",zC="@firebase/analytics-compat",qC="@firebase/analytics",$C="@firebase/app-check-compat",HC="@firebase/app-check",WC="@firebase/auth",GC="@firebase/auth-compat",KC="@firebase/database",ZC="@firebase/data-connect",QC="@firebase/database-compat",YC="@firebase/functions",JC="@firebase/functions-compat",XC="@firebase/installations",e2="@firebase/installations-compat",t2="@firebase/messaging",n2="@firebase/messaging-compat",r2="@firebase/performance",i2="@firebase/performance-compat",s2="@firebase/remote-config",o2="@firebase/remote-config-compat",a2="@firebase/storage",l2="@firebase/storage-compat",u2="@firebase/firestore",c2="@firebase/vertexai-preview",d2="@firebase/firestore-compat",h2="firebase",f2="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kg="[DEFAULT]",p2={[Ig]:"fire-core",[BC]:"fire-core-compat",[qC]:"fire-analytics",[zC]:"fire-analytics-compat",[HC]:"fire-app-check",[$C]:"fire-app-check-compat",[WC]:"fire-auth",[GC]:"fire-auth-compat",[KC]:"fire-rtdb",[ZC]:"fire-data-connect",[QC]:"fire-rtdb-compat",[YC]:"fire-fn",[JC]:"fire-fn-compat",[XC]:"fire-iid",[e2]:"fire-iid-compat",[t2]:"fire-fcm",[n2]:"fire-fcm-compat",[r2]:"fire-perf",[i2]:"fire-perf-compat",[s2]:"fire-rc",[o2]:"fire-rc-compat",[a2]:"fire-gcs",[l2]:"fire-gcs-compat",[u2]:"fire-fst",[d2]:"fire-fst-compat",[c2]:"fire-vertex","fire-js":"fire-js",[h2]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nf=new Map,m2=new Map,Sg=new Map;function wx(t,e){try{t.container.addComponent(e)}catch(n){Ki.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function br(t){const e=t.name;if(Sg.has(e))return Ki.debug(`There were multiple attempts to register component ${e}.`),!1;Sg.set(e,t);for(const n of nf.values())wx(n,t);for(const n of m2.values())wx(n,t);return!0}function oo(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Fr(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g2={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Zs=new aa("app","Firebase",g2);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y2{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new nr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Zs.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const la=f2;function XT(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:kg,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Zs.create("bad-app-name",{appName:String(i)});if(n||(n=GT()),!n)throw Zs.create("no-options");const o=nf.get(i);if(o){if(Il(n,o.options)&&Il(r,o.config))return o;throw Zs.create("duplicate-app",{appName:i})}const a=new TC(i);for(const h of Sg.values())a.addComponent(h);const c=new y2(n,r,a);return nf.set(i,c),c}function Gf(t=kg){const e=nf.get(t);if(!e&&t===kg&&GT())return XT();if(!e)throw Zs.create("no-app",{appName:t});return e}function dn(t,e,n){var r;let i=(r=p2[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const o=i.match(/\s|\//),a=e.match(/\s|\//);if(o||a){const c=[`Unable to register library "${i}" with version "${e}":`];o&&c.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&a&&c.push("and"),a&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ki.warn(c.join(" "));return}br(new nr(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _2="firebase-heartbeat-database",v2=1,Tc="firebase-heartbeat-store";let fm=null;function eI(){return fm||(fm=Wf(_2,v2,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Tc)}catch(n){console.warn(n)}}}}).catch(t=>{throw Zs.create("idb-open",{originalErrorMessage:t.message})})),fm}async function x2(t){try{const n=(await eI()).transaction(Tc),r=await n.objectStore(Tc).get(tI(t));return await n.done,r}catch(e){if(e instanceof Tr)Ki.warn(e.message);else{const n=Zs.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ki.warn(n.message)}}}async function bx(t,e){try{const r=(await eI()).transaction(Tc,"readwrite");await r.objectStore(Tc).put(e,tI(t)),await r.done}catch(n){if(n instanceof Tr)Ki.warn(n.message);else{const r=Zs.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Ki.warn(r.message)}}}function tI(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w2=1024,b2=30*24*60*60*1e3;class E2{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new I2(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=Ex();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(a=>a.date===o)?void 0:(this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const c=new Date(a.date).valueOf();return Date.now()-c<=b2}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Ki.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Ex(),{heartbeatsToSend:r,unsentEntries:i}=T2(this._heartbeatsCache.heartbeats),o=tf(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(n){return Ki.warn(n),""}}}function Ex(){return new Date().toISOString().substring(0,10)}function T2(t,e=w2){const n=[];let r=t.slice();for(const i of t){const o=n.find(a=>a.agent===i.agent);if(o){if(o.dates.push(i.date),Tx(n)>e){o.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Tx(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class I2{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return e_()?QT().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await x2(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return bx(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return bx(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Tx(t){return tf(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k2(t){br(new nr("platform-logger",e=>new FC(e),"PRIVATE")),br(new nr("heartbeat",e=>new E2(e),"PRIVATE")),dn(Ig,xx,t),dn(Ig,xx,"esm2017"),dn("fire-js","")}k2("");function r_(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function nI(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const S2=nI,rI=new aa("auth","Firebase",nI());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rf=new t_("@firebase/auth");function P2(t,...e){rf.logLevel<=Be.WARN&&rf.warn(`Auth (${la}): ${t}`,...e)}function ph(t,...e){rf.logLevel<=Be.ERROR&&rf.error(`Auth (${la}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Er(t,...e){throw s_(t,...e)}function zr(t,...e){return s_(t,...e)}function i_(t,e,n){const r=Object.assign(Object.assign({},S2()),{[e]:n});return new aa("auth","Firebase",r).create(e,{appName:t.name})}function zi(t){return i_(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function A2(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Er(t,"argument-error"),i_(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function s_(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return rI.create(t,...e)}function Ae(t,e,...n){if(!t)throw s_(e,...n)}function Di(t){const e="INTERNAL ASSERTION FAILED: "+t;throw ph(e),new Error(e)}function Zi(t,e){t||Di(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pg(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function N2(){return Ix()==="http:"||Ix()==="https:"}function Ix(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C2(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(N2()||cC()||"connection"in navigator)?navigator.onLine:!0}function R2(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kc{constructor(e,n){this.shortDelay=e,this.longDelay=n,Zi(n>e,"Short delay should be less than long delay!"),this.isMobile=aC()||dC()}get(){return C2()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o_(t,e){Zi(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iI{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Di("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Di("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Di("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j2={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L2=new Kc(3e4,6e4);function Xi(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function es(t,e,n,r,i={}){return sI(t,i,async()=>{let o={},a={};r&&(e==="GET"?a=r:o={body:JSON.stringify(r)});const c=Gc(Object.assign({key:t.config.apiKey},a)).slice(1),h=await t._getAdditionalHeaders();h["Content-Type"]="application/json",t.languageCode&&(h["X-Firebase-Locale"]=t.languageCode);const p=Object.assign({method:e,headers:h},o);return uC()||(p.referrerPolicy="no-referrer"),iI.fetch()(oI(t,t.config.apiHost,n,c),p)})}async function sI(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},j2),e);try{const i=new M2(t),o=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const a=await o.json();if("needConfirmation"in a)throw qd(t,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{const c=o.ok?a.errorMessage:a.error.message,[h,p]=c.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw qd(t,"credential-already-in-use",a);if(h==="EMAIL_EXISTS")throw qd(t,"email-already-in-use",a);if(h==="USER_DISABLED")throw qd(t,"user-disabled",a);const y=r[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw i_(t,y,p);Er(t,y)}}catch(i){if(i instanceof Tr)throw i;Er(t,"network-request-failed",{message:String(i)})}}async function Zc(t,e,n,r,i={}){const o=await es(t,e,n,r,i);return"mfaPendingCredential"in o&&Er(t,"multi-factor-auth-required",{_serverResponse:o}),o}function oI(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?o_(t.config,i):`${t.config.apiScheme}://${i}`}function D2(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class M2{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(zr(this.auth,"network-request-failed")),L2.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function qd(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=zr(t,e,r);return i.customData._tokenResponse=n,i}function kx(t){return t!==void 0&&t.enterprise!==void 0}class O2{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return D2(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function V2(t,e){return es(t,"GET","/v2/recaptchaConfig",Xi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F2(t,e){return es(t,"POST","/v1/accounts:delete",e)}async function aI(t,e){return es(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xu(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function U2(t,e=!1){const n=Ye(t),r=await n.getIdToken(e),i=a_(r);Ae(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const o=typeof i.firebase=="object"?i.firebase:void 0,a=o==null?void 0:o.sign_in_provider;return{claims:i,token:r,authTime:Xu(pm(i.auth_time)),issuedAtTime:Xu(pm(i.iat)),expirationTime:Xu(pm(i.exp)),signInProvider:a||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function pm(t){return Number(t)*1e3}function a_(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return ph("JWT malformed, contained fewer than 3 sections"),null;try{const i=$T(n);return i?JSON.parse(i):(ph("Failed to decode base64 JWT payload"),null)}catch(i){return ph("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function Sx(t){const e=a_(t);return Ae(e,"internal-error"),Ae(typeof e.exp<"u","internal-error"),Ae(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ic(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Tr&&B2(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function B2({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z2{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ag{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Xu(this.lastLoginAt),this.creationTime=Xu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sf(t){var e;const n=t.auth,r=await t.getIdToken(),i=await Ic(t,aI(n,{idToken:r}));Ae(i==null?void 0:i.users.length,n,"internal-error");const o=i.users[0];t._notifyReloadListener(o);const a=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?lI(o.providerUserInfo):[],c=$2(t.providerData,a),h=t.isAnonymous,p=!(t.email&&o.passwordHash)&&!(c!=null&&c.length),y=h?p:!1,v={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:c,metadata:new Ag(o.createdAt,o.lastLoginAt),isAnonymous:y};Object.assign(t,v)}async function q2(t){const e=Ye(t);await sf(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function $2(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function lI(t){return t.map(e=>{var{providerId:n}=e,r=r_(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function H2(t,e){const n=await sI(t,{},async()=>{const r=Gc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=t.config,a=oI(t,i,"/v1/token",`key=${o}`),c=await t._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",iI.fetch()(a,{method:"POST",headers:c,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function W2(t,e){return es(t,"POST","/v2/accounts:revokeToken",Xi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ae(e.idToken,"internal-error"),Ae(typeof e.idToken<"u","internal-error"),Ae(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Sx(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Ae(e.length!==0,"internal-error");const n=Sx(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Ae(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:o}=await H2(e,n);this.updateTokensAndExpiration(r,i,Number(o))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:o}=n,a=new fl;return r&&(Ae(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(Ae(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),o&&(Ae(typeof o=="number","internal-error",{appName:e}),a.expirationTime=o),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new fl,this.toJSON())}_performRefresh(){return Di("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Es(t,e){Ae(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Mi{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,o=r_(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new z2(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new Ag(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const n=await Ic(this,this.stsTokenManager.getToken(this.auth,e));return Ae(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return U2(this,e)}reload(){return q2(this)}_assign(e){this!==e&&(Ae(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Mi(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){Ae(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await sf(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Fr(this.auth.app))return Promise.reject(zi(this.auth));const e=await this.getIdToken();return await Ic(this,F2(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,o,a,c,h,p,y;const v=(r=n.displayName)!==null&&r!==void 0?r:void 0,w=(i=n.email)!==null&&i!==void 0?i:void 0,S=(o=n.phoneNumber)!==null&&o!==void 0?o:void 0,N=(a=n.photoURL)!==null&&a!==void 0?a:void 0,A=(c=n.tenantId)!==null&&c!==void 0?c:void 0,U=(h=n._redirectEventId)!==null&&h!==void 0?h:void 0,j=(p=n.createdAt)!==null&&p!==void 0?p:void 0,k=(y=n.lastLoginAt)!==null&&y!==void 0?y:void 0,{uid:R,emailVerified:z,isAnonymous:K,providerData:H,stsTokenManager:T}=n;Ae(R&&T,e,"internal-error");const b=fl.fromJSON(this.name,T);Ae(typeof R=="string",e,"internal-error"),Es(v,e.name),Es(w,e.name),Ae(typeof z=="boolean",e,"internal-error"),Ae(typeof K=="boolean",e,"internal-error"),Es(S,e.name),Es(N,e.name),Es(A,e.name),Es(U,e.name),Es(j,e.name),Es(k,e.name);const C=new Mi({uid:R,auth:e,email:w,emailVerified:z,displayName:v,isAnonymous:K,photoURL:N,phoneNumber:S,tenantId:A,stsTokenManager:b,createdAt:j,lastLoginAt:k});return H&&Array.isArray(H)&&(C.providerData=H.map(P=>Object.assign({},P))),U&&(C._redirectEventId=U),C}static async _fromIdTokenResponse(e,n,r=!1){const i=new fl;i.updateFromServerResponse(n);const o=new Mi({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await sf(o),o}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];Ae(i.localId!==void 0,"internal-error");const o=i.providerUserInfo!==void 0?lI(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(o!=null&&o.length),c=new fl;c.updateFromIdToken(r);const h=new Mi({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:a}),p={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Ag(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(o!=null&&o.length)};return Object.assign(h,p),h}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Px=new Map;function Oi(t){Zi(t instanceof Function,"Expected a class definition");let e=Px.get(t);return e?(Zi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Px.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uI{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}uI.type="NONE";const Ax=uI;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mh(t,e,n){return`firebase:${t}:${e}:${n}`}class pl{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:o}=this.auth;this.fullUserKey=mh(this.userKey,i.apiKey,o),this.fullPersistenceKey=mh("persistence",i.apiKey,o),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Mi._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new pl(Oi(Ax),e,r);const i=(await Promise.all(n.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let o=i[0]||Oi(Ax);const a=mh(r,e.config.apiKey,e.name);let c=null;for(const p of n)try{const y=await p._get(a);if(y){const v=Mi._fromJSON(e,y);p!==o&&(c=v),o=p;break}}catch{}const h=i.filter(p=>p._shouldAllowMigration);return!o._shouldAllowMigration||!h.length?new pl(o,e,r):(o=h[0],c&&await o._set(a,c.toJSON()),await Promise.all(n.map(async p=>{if(p!==o)try{await p._remove(a)}catch{}})),new pl(o,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nx(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(fI(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(cI(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(mI(e))return"Blackberry";if(gI(e))return"Webos";if(dI(e))return"Safari";if((e.includes("chrome/")||hI(e))&&!e.includes("edge/"))return"Chrome";if(pI(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function cI(t=$t()){return/firefox\//i.test(t)}function dI(t=$t()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function hI(t=$t()){return/crios\//i.test(t)}function fI(t=$t()){return/iemobile/i.test(t)}function pI(t=$t()){return/android/i.test(t)}function mI(t=$t()){return/blackberry/i.test(t)}function gI(t=$t()){return/webos/i.test(t)}function l_(t=$t()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function G2(t=$t()){var e;return l_(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function K2(){return hC()&&document.documentMode===10}function yI(t=$t()){return l_(t)||pI(t)||gI(t)||mI(t)||/windows phone/i.test(t)||fI(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _I(t,e=[]){let n;switch(t){case"Browser":n=Nx($t());break;case"Worker":n=`${Nx($t())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${la}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z2{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=o=>new Promise((a,c)=>{try{const h=e(o);a(h)}catch(h){c(h)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Q2(t,e={}){return es(t,"GET","/v2/passwordPolicy",Xi(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y2=6;class J2{constructor(e){var n,r,i,o;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=a.minPasswordLength)!==null&&n!==void 0?n:Y2,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,o,a,c;const h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(n=h.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),h.isValid&&(h.isValid=(r=h.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(i=h.containsLowercaseLetter)!==null&&i!==void 0?i:!0),h.isValid&&(h.isValid=(o=h.containsUppercaseLetter)!==null&&o!==void 0?o:!0),h.isValid&&(h.isValid=(a=h.containsNumericCharacter)!==null&&a!==void 0?a:!0),h.isValid&&(h.isValid=(c=h.containsNonAlphanumericCharacter)!==null&&c!==void 0?c:!0),h}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X2{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Cx(this),this.idTokenSubscription=new Cx(this),this.beforeStateQueue=new Z2(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=rI,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Oi(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await pl.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await aI(this,{idToken:e}),r=await Mi._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(Fr(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(c,c))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,c=i==null?void 0:i._redirectEventId,h=await this.tryRedirectSignIn(e);(!a||a===c)&&(h!=null&&h.user)&&(i=h.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Ae(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await sf(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=R2()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Fr(this.app))return Promise.reject(zi(this));const n=e?Ye(e):null;return n&&Ae(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Ae(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Fr(this.app)?Promise.reject(zi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Fr(this.app)?Promise.reject(zi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Oi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Q2(this),n=new J2(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new aa("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await W2(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Oi(e)||this._popupRedirectResolver;Ae(n,this,"argument-error"),this.redirectPersistenceManager=await pl.create(this,[Oi(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const o=typeof n=="function"?n:n.next.bind(n);let a=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ae(c,this,"internal-error"),c.then(()=>{a||o(this.currentUser)}),typeof n=="function"){const h=e.addObserver(n,r,i);return()=>{a=!0,h()}}else{const h=e.addObserver(n);return()=>{a=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ae(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=_I(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&P2(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function gi(t){return Ye(t)}class Cx{constructor(e){this.auth=e,this.observer=null,this.addObserver=_C(n=>this.observer=n)}get next(){return Ae(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Kf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function eR(t){Kf=t}function vI(t){return Kf.loadJS(t)}function tR(){return Kf.recaptchaEnterpriseScript}function nR(){return Kf.gapiScript}function rR(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const iR="recaptcha-enterprise",sR="NO_RECAPTCHA";class oR{constructor(e){this.type=iR,this.auth=gi(e)}async verify(e="verify",n=!1){async function r(o){if(!n){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(a,c)=>{V2(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const p=new O2(h);return o.tenantId==null?o._agentRecaptchaConfig=p:o._tenantRecaptchaConfigs[o.tenantId]=p,a(p.siteKey)}}).catch(h=>{c(h)})})}function i(o,a,c){const h=window.grecaptcha;kx(h)?h.enterprise.ready(()=>{h.enterprise.execute(o,{action:e}).then(p=>{a(p)}).catch(()=>{a(sR)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((o,a)=>{r(this.auth).then(c=>{if(!n&&kx(window.grecaptcha))i(c,o,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let h=tR();h.length!==0&&(h+=c),vI(h).then(()=>{i(c,o,a)}).catch(p=>{a(p)})}}).catch(c=>{a(c)})})}}async function Rx(t,e,n,r=!1){const i=new oR(t);let o;try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const a=Object.assign({},e);return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function of(t,e,n,r){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await Rx(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await Rx(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aR(t,e){const n=oo(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),o=n.getOptions();if(Il(o,e??{}))return i;Er(i,"already-initialized")}return n.initialize({options:e})}function lR(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Oi);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function uR(t,e,n){const r=gi(t);Ae(r._canInitEmulator,r,"emulator-config-failed"),Ae(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,o=xI(e),{host:a,port:c}=cR(e),h=c===null?"":`:${c}`;r.config.emulator={url:`${o}//${a}${h}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:c,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})}),dR()}function xI(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function cR(t){const e=xI(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const o=i[1];return{host:o,port:jx(r.substr(o.length+1))}}else{const[o,a]=r.split(":");return{host:o,port:jx(a)}}}function jx(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function dR(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u_{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Di("not implemented")}_getIdTokenResponse(e){return Di("not implemented")}_linkToIdToken(e,n){return Di("not implemented")}_getReauthenticationResolver(e){return Di("not implemented")}}async function hR(t,e){return es(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fR(t,e){return Zc(t,"POST","/v1/accounts:signInWithPassword",Xi(t,e))}async function wI(t,e){return es(t,"POST","/v1/accounts:sendOobCode",Xi(t,e))}async function pR(t,e){return wI(t,e)}async function mR(t,e){return wI(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gR(t,e){return Zc(t,"POST","/v1/accounts:signInWithEmailLink",Xi(t,e))}async function yR(t,e){return Zc(t,"POST","/v1/accounts:signInWithEmailLink",Xi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kc extends u_{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new kc(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new kc(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return of(e,n,"signInWithPassword",fR);case"emailLink":return gR(e,{email:this._email,oobCode:this._password});default:Er(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return of(e,r,"signUpPassword",hR);case"emailLink":return yR(e,{idToken:n,email:this._email,oobCode:this._password});default:Er(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ml(t,e){return Zc(t,"POST","/v1/accounts:signInWithIdp",Xi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _R="http://localhost";class Ho extends u_{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ho(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Er("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,o=r_(n,["providerId","signInMethod"]);if(!r||!i)return null;const a=new Ho(r,i);return a.idToken=o.idToken||void 0,a.accessToken=o.accessToken||void 0,a.secret=o.secret,a.nonce=o.nonce,a.pendingToken=o.pendingToken||null,a}_getIdTokenResponse(e){const n=this.buildRequest();return ml(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,ml(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ml(e,n)}buildRequest(){const e={requestUri:_R,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Gc(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vR(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function xR(t){const e=Ou(Vu(t)).link,n=e?Ou(Vu(e)).deep_link_id:null,r=Ou(Vu(t)).deep_link_id;return(r?Ou(Vu(r)).link:null)||r||n||e||t}class c_{constructor(e){var n,r,i,o,a,c;const h=Ou(Vu(e)),p=(n=h.apiKey)!==null&&n!==void 0?n:null,y=(r=h.oobCode)!==null&&r!==void 0?r:null,v=vR((i=h.mode)!==null&&i!==void 0?i:null);Ae(p&&y&&v,"argument-error"),this.apiKey=p,this.operation=v,this.code=y,this.continueUrl=(o=h.continueUrl)!==null&&o!==void 0?o:null,this.languageCode=(a=h.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(c=h.tenantId)!==null&&c!==void 0?c:null}static parseLink(e){const n=xR(e);try{return new c_(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ql{constructor(){this.providerId=ql.PROVIDER_ID}static credential(e,n){return kc._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=c_.parseLink(n);return Ae(r,"argument-error"),kc._fromEmailAndCode(e,r.code,r.tenantId)}}ql.PROVIDER_ID="password";ql.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ql.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d_{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc extends d_{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ns extends Qc{constructor(){super("facebook.com")}static credential(e){return Ho._fromParams({providerId:Ns.PROVIDER_ID,signInMethod:Ns.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ns.credentialFromTaggedObject(e)}static credentialFromError(e){return Ns.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ns.credential(e.oauthAccessToken)}catch{return null}}}Ns.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ns.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci extends Qc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ho._fromParams({providerId:Ci.PROVIDER_ID,signInMethod:Ci.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Ci.credentialFromTaggedObject(e)}static credentialFromError(e){return Ci.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Ci.credential(n,r)}catch{return null}}}Ci.GOOGLE_SIGN_IN_METHOD="google.com";Ci.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cs extends Qc{constructor(){super("github.com")}static credential(e){return Ho._fromParams({providerId:Cs.PROVIDER_ID,signInMethod:Cs.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Cs.credentialFromTaggedObject(e)}static credentialFromError(e){return Cs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Cs.credential(e.oauthAccessToken)}catch{return null}}}Cs.GITHUB_SIGN_IN_METHOD="github.com";Cs.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rs extends Qc{constructor(){super("twitter.com")}static credential(e,n){return Ho._fromParams({providerId:Rs.PROVIDER_ID,signInMethod:Rs.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Rs.credentialFromTaggedObject(e)}static credentialFromError(e){return Rs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Rs.credential(n,r)}catch{return null}}}Rs.TWITTER_SIGN_IN_METHOD="twitter.com";Rs.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wR(t,e){return Zc(t,"POST","/v1/accounts:signUp",Xi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const o=await Mi._fromIdTokenResponse(e,r,i),a=Lx(r);return new Wo({user:o,providerId:a,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=Lx(r);return new Wo({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function Lx(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class af extends Tr{constructor(e,n,r,i){var o;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,af.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new af(e,n,r,i)}}function bI(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?af._fromErrorAndOperation(t,o,e,r):o})}async function bR(t,e,n=!1){const r=await Ic(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Wo._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ER(t,e,n=!1){const{auth:r}=t;if(Fr(r.app))return Promise.reject(zi(r));const i="reauthenticate";try{const o=await Ic(t,bI(r,i,e,t),n);Ae(o.idToken,r,"internal-error");const a=a_(o.idToken);Ae(a,r,"internal-error");const{sub:c}=a;return Ae(t.uid===c,r,"user-mismatch"),Wo._forOperation(t,i,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&Er(r,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EI(t,e,n=!1){if(Fr(t.app))return Promise.reject(zi(t));const r="signIn",i=await bI(t,r,e),o=await Wo._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(o.user),o}async function TR(t,e){return EI(gi(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TI(t){const e=gi(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function IR(t,e,n){const r=gi(t);await of(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",mR)}async function kR(t,e,n){if(Fr(t.app))return Promise.reject(zi(t));const r=gi(t),a=await of(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",wR).catch(h=>{throw h.code==="auth/password-does-not-meet-requirements"&&TI(t),h}),c=await Wo._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(c.user),c}function SR(t,e,n){return Fr(t.app)?Promise.reject(zi(t)):TR(Ye(t),ql.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&TI(t),r})}async function II(t,e){const n=Ye(t),i={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()},{email:o}=await pR(n.auth,i);o!==t.email&&await t.reload()}function PR(t,e,n,r){return Ye(t).onIdTokenChanged(e,n,r)}function AR(t,e,n){return Ye(t).beforeAuthStateChanged(e,n)}function NR(t,e,n,r){return Ye(t).onAuthStateChanged(e,n,r)}function kI(t){return Ye(t).signOut()}const lf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SI{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(lf,"1"),this.storage.removeItem(lf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CR=1e3,RR=10;class PI extends SI{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=yI(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((a,c,h)=>{this.notifyListeners(a,h)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(r);!n&&this.localCache[r]===a||this.notifyListeners(r,a)},o=this.storage.getItem(r);K2()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,RR):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},CR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}PI.type="LOCAL";const jR=PI;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AI extends SI{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}AI.type="SESSION";const NI=AI;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LR(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new Zf(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:o}=n.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const c=Array.from(a).map(async p=>p(n.origin,o)),h=await LR(c);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:h})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Zf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h_(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DR{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,a;return new Promise((c,h)=>{const p=h_("",20);i.port1.start();const y=setTimeout(()=>{h(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(v){const w=v;if(w.data.eventId===p)switch(w.data.status){case"ack":clearTimeout(y),o=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),c(w.data.response);break;default:clearTimeout(y),clearTimeout(o),h(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:p,data:n},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fi(){return window}function MR(t){fi().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CI(){return typeof fi().WorkerGlobalScope<"u"&&typeof fi().importScripts=="function"}async function OR(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function VR(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function FR(){return CI()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RI="firebaseLocalStorageDb",UR=1,uf="firebaseLocalStorage",jI="fbase_key";class Yc{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Qf(t,e){return t.transaction([uf],e?"readwrite":"readonly").objectStore(uf)}function BR(){const t=indexedDB.deleteDatabase(RI);return new Yc(t).toPromise()}function Ng(){const t=indexedDB.open(RI,UR);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(uf,{keyPath:jI})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(uf)?e(r):(r.close(),await BR(),e(await Ng()))})})}async function Dx(t,e,n){const r=Qf(t,!0).put({[jI]:e,value:n});return new Yc(r).toPromise()}async function zR(t,e){const n=Qf(t,!1).get(e),r=await new Yc(n).toPromise();return r===void 0?null:r.value}function Mx(t,e){const n=Qf(t,!0).delete(e);return new Yc(n).toPromise()}const qR=800,$R=3;class LI{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Ng(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>$R)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return CI()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Zf._getInstance(FR()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await OR(),!this.activeServiceWorker)return;this.sender=new DR(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||VR()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ng();return await Dx(e,lf,"1"),await Mx(e,lf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Dx(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>zR(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Mx(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const o=Qf(i,!1).getAll();return new Yc(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:o}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(o)&&(this.notifyListeners(i,o),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),qR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}LI.type="LOCAL";const HR=LI;new Kc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DI(t,e){return e?Oi(e):(Ae(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f_ extends u_{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ml(e,this._buildIdpRequest())}_linkToIdToken(e,n){return ml(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return ml(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function WR(t){return EI(t.auth,new f_(t),t.bypassAuthState)}function GR(t){const{auth:e,user:n}=t;return Ae(n,e,"internal-error"),ER(n,new f_(t),t.bypassAuthState)}async function KR(t){const{auth:e,user:n}=t;return Ae(n,e,"internal-error"),bR(n,new f_(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MI{constructor(e,n,r,i,o=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:o,error:a,type:c}=e;if(a){this.reject(a);return}const h={auth:this.auth,requestUri:n,sessionId:r,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(h))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return WR;case"linkViaPopup":case"linkViaRedirect":return KR;case"reauthViaPopup":case"reauthViaRedirect":return GR;default:Er(this.auth,"internal-error")}}resolve(e){Zi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Zi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZR=new Kc(2e3,1e4);async function QR(t,e,n){if(Fr(t.app))return Promise.reject(zr(t,"operation-not-supported-in-this-environment"));const r=gi(t);A2(t,e,d_);const i=DI(r,n);return new jo(r,"signInViaPopup",e,i).executeNotNull()}class jo extends MI{constructor(e,n,r,i,o){super(e,n,i,o),this.provider=r,this.authWindow=null,this.pollId=null,jo.currentPopupAction&&jo.currentPopupAction.cancel(),jo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ae(e,this.auth,"internal-error"),e}async onExecution(){Zi(this.filter.length===1,"Popup operations only handle one event");const e=h_();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(zr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(zr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,jo.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(zr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,ZR.get())};e()}}jo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YR="pendingRedirect",gh=new Map;class JR extends MI{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=gh.get(this.auth._key());if(!e){try{const r=await XR(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}gh.set(this.auth._key(),e)}return this.bypassAuthState||gh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function XR(t,e){const n=nj(e),r=tj(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function ej(t,e){gh.set(t._key(),e)}function tj(t){return Oi(t._redirectPersistence)}function nj(t){return mh(YR,t.config.apiKey,t.name)}async function rj(t,e){return await gi(t)._initializationPromise,OI(t,e,!1)}async function OI(t,e,n=!1){if(Fr(t.app))return Promise.reject(zi(t));const r=gi(t),i=DI(r,e),a=await new JR(r,i,n).execute();return a&&!n&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ij=10*60*1e3;class sj{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!oj(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!VI(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(zr(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=ij&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ox(e))}saveEventToCache(e){this.cachedEventUids.add(Ox(e)),this.lastProcessedEventTime=Date.now()}}function Ox(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function VI({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function oj(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return VI(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aj(t,e={}){return es(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lj=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,uj=/^https?/;async function cj(t){if(t.config.emulator)return;const{authorizedDomains:e}=await aj(t);for(const n of e)try{if(dj(n))return}catch{}Er(t,"unauthorized-domain")}function dj(t){const e=Pg(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&a.hostname===r}if(!uj.test(n))return!1;if(lj.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hj=new Kc(3e4,6e4);function Vx(){const t=fi().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function fj(t){return new Promise((e,n)=>{var r,i,o;function a(){Vx(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Vx(),n(zr(t,"network-request-failed"))},timeout:hj.get()})}if(!((i=(r=fi().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((o=fi().gapi)===null||o===void 0)&&o.load)a();else{const c=rR("iframefcb");return fi()[c]=()=>{gapi.load?a():n(zr(t,"network-request-failed"))},vI(`${nR()}?onload=${c}`).catch(h=>n(h))}}).catch(e=>{throw yh=null,e})}let yh=null;function pj(t){return yh=yh||fj(t),yh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mj=new Kc(5e3,15e3),gj="__/auth/iframe",yj="emulator/auth/iframe",_j={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},vj=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function xj(t){const e=t.config;Ae(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?o_(e,yj):`https://${t.config.authDomain}/${gj}`,r={apiKey:e.apiKey,appName:t.name,v:la},i=vj.get(t.config.apiHost);i&&(r.eid=i);const o=t._getFrameworks();return o.length&&(r.fw=o.join(",")),`${n}?${Gc(r).slice(1)}`}async function wj(t){const e=await pj(t),n=fi().gapi;return Ae(n,t,"internal-error"),e.open({where:document.body,url:xj(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:_j,dontclear:!0},r=>new Promise(async(i,o)=>{await r.restyle({setHideOnLeave:!1});const a=zr(t,"network-request-failed"),c=fi().setTimeout(()=>{o(a)},mj.get());function h(){fi().clearTimeout(c),i(r)}r.ping(h).then(h,()=>{o(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bj={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Ej=500,Tj=600,Ij="_blank",kj="http://localhost";class Fx{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Sj(t,e,n,r=Ej,i=Tj){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const h=Object.assign(Object.assign({},bj),{width:r.toString(),height:i.toString(),top:o,left:a}),p=$t().toLowerCase();n&&(c=hI(p)?Ij:n),cI(p)&&(e=e||kj,h.scrollbars="yes");const y=Object.entries(h).reduce((w,[S,N])=>`${w}${S}=${N},`,"");if(G2(p)&&c!=="_self")return Pj(e||"",c),new Fx(null);const v=window.open(e||"",c,y);Ae(v,t,"popup-blocked");try{v.focus()}catch{}return new Fx(v)}function Pj(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aj="__/auth/handler",Nj="emulator/auth/handler",Cj=encodeURIComponent("fac");async function Ux(t,e,n,r,i,o){Ae(t.config.authDomain,t,"auth-domain-config-required"),Ae(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:la,eventId:i};if(e instanceof d_){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",yC(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[y,v]of Object.entries({}))a[y]=v}if(e instanceof Qc){const y=e.getScopes().filter(v=>v!=="");y.length>0&&(a.scopes=y.join(","))}t.tenantId&&(a.tid=t.tenantId);const c=a;for(const y of Object.keys(c))c[y]===void 0&&delete c[y];const h=await t._getAppCheckToken(),p=h?`#${Cj}=${encodeURIComponent(h)}`:"";return`${Rj(t)}?${Gc(c).slice(1)}${p}`}function Rj({config:t}){return t.emulator?o_(t,Nj):`https://${t.authDomain}/${Aj}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mm="webStorageSupport";class jj{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=NI,this._completeRedirectFn=OI,this._overrideRedirectResult=ej}async _openPopup(e,n,r,i){var o;Zi((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");const a=await Ux(e,n,r,Pg(),i);return Sj(e,a,h_())}async _openRedirect(e,n,r,i){await this._originValidation(e);const o=await Ux(e,n,r,Pg(),i);return MR(o),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:o}=this.eventManagers[n];return i?Promise.resolve(i):(Zi(o,"If manager is not set, promise should be"),o)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await wj(e),r=new sj(e);return n.register("authEvent",i=>(Ae(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(mm,{type:mm},i=>{var o;const a=(o=i==null?void 0:i[0])===null||o===void 0?void 0:o[mm];a!==void 0&&n(!!a),Er(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=cj(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return yI()||dI()||l_()}}const Lj=jj;var Bx="@firebase/auth",zx="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dj{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Ae(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mj(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Oj(t){br(new nr("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=r.options;Ae(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const h={apiKey:a,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:_I(t)},p=new X2(r,i,o,h);return lR(p,n),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),br(new nr("auth-internal",e=>{const n=gi(e.getProvider("auth").getImmediate());return(r=>new Dj(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),dn(Bx,zx,Mj(t)),dn(Bx,zx,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vj=5*60,Fj=KT("authIdTokenMaxAge")||Vj;let qx=null;const Uj=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>Fj)return;const i=n==null?void 0:n.token;qx!==i&&(qx=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function Bj(t=Gf()){const e=oo(t,"auth");if(e.isInitialized())return e.getImmediate();const n=aR(t,{popupRedirectResolver:Lj,persistence:[HR,jR,NI]}),r=KT("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(r,location.origin);if(location.origin===o.origin){const a=Uj(o.toString());AR(n,a,()=>a(n.currentUser)),PR(n,c=>a(c))}}const i=HT("auth");return i&&uR(n,`http://${i}`),n}function zj(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}eR({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const o=zr("internal-error");o.customData=i,n(o)},r.type="text/javascript",r.charset="UTF-8",zj().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Oj("Browser");var $x=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Oo,FI;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(T,b){function C(){}C.prototype=b.prototype,T.D=b.prototype,T.prototype=new C,T.prototype.constructor=T,T.C=function(P,O,F){for(var M=Array(arguments.length-2),be=2;be<arguments.length;be++)M[be-2]=arguments[be];return b.prototype[O].apply(P,M)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(T,b,C){C||(C=0);var P=Array(16);if(typeof b=="string")for(var O=0;16>O;++O)P[O]=b.charCodeAt(C++)|b.charCodeAt(C++)<<8|b.charCodeAt(C++)<<16|b.charCodeAt(C++)<<24;else for(O=0;16>O;++O)P[O]=b[C++]|b[C++]<<8|b[C++]<<16|b[C++]<<24;b=T.g[0],C=T.g[1],O=T.g[2];var F=T.g[3],M=b+(F^C&(O^F))+P[0]+3614090360&4294967295;b=C+(M<<7&4294967295|M>>>25),M=F+(O^b&(C^O))+P[1]+3905402710&4294967295,F=b+(M<<12&4294967295|M>>>20),M=O+(C^F&(b^C))+P[2]+606105819&4294967295,O=F+(M<<17&4294967295|M>>>15),M=C+(b^O&(F^b))+P[3]+3250441966&4294967295,C=O+(M<<22&4294967295|M>>>10),M=b+(F^C&(O^F))+P[4]+4118548399&4294967295,b=C+(M<<7&4294967295|M>>>25),M=F+(O^b&(C^O))+P[5]+1200080426&4294967295,F=b+(M<<12&4294967295|M>>>20),M=O+(C^F&(b^C))+P[6]+2821735955&4294967295,O=F+(M<<17&4294967295|M>>>15),M=C+(b^O&(F^b))+P[7]+4249261313&4294967295,C=O+(M<<22&4294967295|M>>>10),M=b+(F^C&(O^F))+P[8]+1770035416&4294967295,b=C+(M<<7&4294967295|M>>>25),M=F+(O^b&(C^O))+P[9]+2336552879&4294967295,F=b+(M<<12&4294967295|M>>>20),M=O+(C^F&(b^C))+P[10]+4294925233&4294967295,O=F+(M<<17&4294967295|M>>>15),M=C+(b^O&(F^b))+P[11]+2304563134&4294967295,C=O+(M<<22&4294967295|M>>>10),M=b+(F^C&(O^F))+P[12]+1804603682&4294967295,b=C+(M<<7&4294967295|M>>>25),M=F+(O^b&(C^O))+P[13]+4254626195&4294967295,F=b+(M<<12&4294967295|M>>>20),M=O+(C^F&(b^C))+P[14]+2792965006&4294967295,O=F+(M<<17&4294967295|M>>>15),M=C+(b^O&(F^b))+P[15]+1236535329&4294967295,C=O+(M<<22&4294967295|M>>>10),M=b+(O^F&(C^O))+P[1]+4129170786&4294967295,b=C+(M<<5&4294967295|M>>>27),M=F+(C^O&(b^C))+P[6]+3225465664&4294967295,F=b+(M<<9&4294967295|M>>>23),M=O+(b^C&(F^b))+P[11]+643717713&4294967295,O=F+(M<<14&4294967295|M>>>18),M=C+(F^b&(O^F))+P[0]+3921069994&4294967295,C=O+(M<<20&4294967295|M>>>12),M=b+(O^F&(C^O))+P[5]+3593408605&4294967295,b=C+(M<<5&4294967295|M>>>27),M=F+(C^O&(b^C))+P[10]+38016083&4294967295,F=b+(M<<9&4294967295|M>>>23),M=O+(b^C&(F^b))+P[15]+3634488961&4294967295,O=F+(M<<14&4294967295|M>>>18),M=C+(F^b&(O^F))+P[4]+3889429448&4294967295,C=O+(M<<20&4294967295|M>>>12),M=b+(O^F&(C^O))+P[9]+568446438&4294967295,b=C+(M<<5&4294967295|M>>>27),M=F+(C^O&(b^C))+P[14]+3275163606&4294967295,F=b+(M<<9&4294967295|M>>>23),M=O+(b^C&(F^b))+P[3]+4107603335&4294967295,O=F+(M<<14&4294967295|M>>>18),M=C+(F^b&(O^F))+P[8]+1163531501&4294967295,C=O+(M<<20&4294967295|M>>>12),M=b+(O^F&(C^O))+P[13]+2850285829&4294967295,b=C+(M<<5&4294967295|M>>>27),M=F+(C^O&(b^C))+P[2]+4243563512&4294967295,F=b+(M<<9&4294967295|M>>>23),M=O+(b^C&(F^b))+P[7]+1735328473&4294967295,O=F+(M<<14&4294967295|M>>>18),M=C+(F^b&(O^F))+P[12]+2368359562&4294967295,C=O+(M<<20&4294967295|M>>>12),M=b+(C^O^F)+P[5]+4294588738&4294967295,b=C+(M<<4&4294967295|M>>>28),M=F+(b^C^O)+P[8]+2272392833&4294967295,F=b+(M<<11&4294967295|M>>>21),M=O+(F^b^C)+P[11]+1839030562&4294967295,O=F+(M<<16&4294967295|M>>>16),M=C+(O^F^b)+P[14]+4259657740&4294967295,C=O+(M<<23&4294967295|M>>>9),M=b+(C^O^F)+P[1]+2763975236&4294967295,b=C+(M<<4&4294967295|M>>>28),M=F+(b^C^O)+P[4]+1272893353&4294967295,F=b+(M<<11&4294967295|M>>>21),M=O+(F^b^C)+P[7]+4139469664&4294967295,O=F+(M<<16&4294967295|M>>>16),M=C+(O^F^b)+P[10]+3200236656&4294967295,C=O+(M<<23&4294967295|M>>>9),M=b+(C^O^F)+P[13]+681279174&4294967295,b=C+(M<<4&4294967295|M>>>28),M=F+(b^C^O)+P[0]+3936430074&4294967295,F=b+(M<<11&4294967295|M>>>21),M=O+(F^b^C)+P[3]+3572445317&4294967295,O=F+(M<<16&4294967295|M>>>16),M=C+(O^F^b)+P[6]+76029189&4294967295,C=O+(M<<23&4294967295|M>>>9),M=b+(C^O^F)+P[9]+3654602809&4294967295,b=C+(M<<4&4294967295|M>>>28),M=F+(b^C^O)+P[12]+3873151461&4294967295,F=b+(M<<11&4294967295|M>>>21),M=O+(F^b^C)+P[15]+530742520&4294967295,O=F+(M<<16&4294967295|M>>>16),M=C+(O^F^b)+P[2]+3299628645&4294967295,C=O+(M<<23&4294967295|M>>>9),M=b+(O^(C|~F))+P[0]+4096336452&4294967295,b=C+(M<<6&4294967295|M>>>26),M=F+(C^(b|~O))+P[7]+1126891415&4294967295,F=b+(M<<10&4294967295|M>>>22),M=O+(b^(F|~C))+P[14]+2878612391&4294967295,O=F+(M<<15&4294967295|M>>>17),M=C+(F^(O|~b))+P[5]+4237533241&4294967295,C=O+(M<<21&4294967295|M>>>11),M=b+(O^(C|~F))+P[12]+1700485571&4294967295,b=C+(M<<6&4294967295|M>>>26),M=F+(C^(b|~O))+P[3]+2399980690&4294967295,F=b+(M<<10&4294967295|M>>>22),M=O+(b^(F|~C))+P[10]+4293915773&4294967295,O=F+(M<<15&4294967295|M>>>17),M=C+(F^(O|~b))+P[1]+2240044497&4294967295,C=O+(M<<21&4294967295|M>>>11),M=b+(O^(C|~F))+P[8]+1873313359&4294967295,b=C+(M<<6&4294967295|M>>>26),M=F+(C^(b|~O))+P[15]+4264355552&4294967295,F=b+(M<<10&4294967295|M>>>22),M=O+(b^(F|~C))+P[6]+2734768916&4294967295,O=F+(M<<15&4294967295|M>>>17),M=C+(F^(O|~b))+P[13]+1309151649&4294967295,C=O+(M<<21&4294967295|M>>>11),M=b+(O^(C|~F))+P[4]+4149444226&4294967295,b=C+(M<<6&4294967295|M>>>26),M=F+(C^(b|~O))+P[11]+3174756917&4294967295,F=b+(M<<10&4294967295|M>>>22),M=O+(b^(F|~C))+P[2]+718787259&4294967295,O=F+(M<<15&4294967295|M>>>17),M=C+(F^(O|~b))+P[9]+3951481745&4294967295,T.g[0]=T.g[0]+b&4294967295,T.g[1]=T.g[1]+(O+(M<<21&4294967295|M>>>11))&4294967295,T.g[2]=T.g[2]+O&4294967295,T.g[3]=T.g[3]+F&4294967295}r.prototype.u=function(T,b){b===void 0&&(b=T.length);for(var C=b-this.blockSize,P=this.B,O=this.h,F=0;F<b;){if(O==0)for(;F<=C;)i(this,T,F),F+=this.blockSize;if(typeof T=="string"){for(;F<b;)if(P[O++]=T.charCodeAt(F++),O==this.blockSize){i(this,P),O=0;break}}else for(;F<b;)if(P[O++]=T[F++],O==this.blockSize){i(this,P),O=0;break}}this.h=O,this.o+=b},r.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var b=1;b<T.length-8;++b)T[b]=0;var C=8*this.o;for(b=T.length-8;b<T.length;++b)T[b]=C&255,C/=256;for(this.u(T),T=Array(16),b=C=0;4>b;++b)for(var P=0;32>P;P+=8)T[C++]=this.g[b]>>>P&255;return T};function o(T,b){var C=c;return Object.prototype.hasOwnProperty.call(C,T)?C[T]:C[T]=b(T)}function a(T,b){this.h=b;for(var C=[],P=!0,O=T.length-1;0<=O;O--){var F=T[O]|0;P&&F==b||(C[O]=F,P=!1)}this.g=C}var c={};function h(T){return-128<=T&&128>T?o(T,function(b){return new a([b|0],0>b?-1:0)}):new a([T|0],0>T?-1:0)}function p(T){if(isNaN(T)||!isFinite(T))return v;if(0>T)return U(p(-T));for(var b=[],C=1,P=0;T>=C;P++)b[P]=T/C|0,C*=4294967296;return new a(b,0)}function y(T,b){if(T.length==0)throw Error("number format error: empty string");if(b=b||10,2>b||36<b)throw Error("radix out of range: "+b);if(T.charAt(0)=="-")return U(y(T.substring(1),b));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var C=p(Math.pow(b,8)),P=v,O=0;O<T.length;O+=8){var F=Math.min(8,T.length-O),M=parseInt(T.substring(O,O+F),b);8>F?(F=p(Math.pow(b,F)),P=P.j(F).add(p(M))):(P=P.j(C),P=P.add(p(M)))}return P}var v=h(0),w=h(1),S=h(16777216);t=a.prototype,t.m=function(){if(A(this))return-U(this).m();for(var T=0,b=1,C=0;C<this.g.length;C++){var P=this.i(C);T+=(0<=P?P:4294967296+P)*b,b*=4294967296}return T},t.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(N(this))return"0";if(A(this))return"-"+U(this).toString(T);for(var b=p(Math.pow(T,6)),C=this,P="";;){var O=z(C,b).g;C=j(C,O.j(b));var F=((0<C.g.length?C.g[0]:C.h)>>>0).toString(T);if(C=O,N(C))return F+P;for(;6>F.length;)F="0"+F;P=F+P}},t.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function N(T){if(T.h!=0)return!1;for(var b=0;b<T.g.length;b++)if(T.g[b]!=0)return!1;return!0}function A(T){return T.h==-1}t.l=function(T){return T=j(this,T),A(T)?-1:N(T)?0:1};function U(T){for(var b=T.g.length,C=[],P=0;P<b;P++)C[P]=~T.g[P];return new a(C,~T.h).add(w)}t.abs=function(){return A(this)?U(this):this},t.add=function(T){for(var b=Math.max(this.g.length,T.g.length),C=[],P=0,O=0;O<=b;O++){var F=P+(this.i(O)&65535)+(T.i(O)&65535),M=(F>>>16)+(this.i(O)>>>16)+(T.i(O)>>>16);P=M>>>16,F&=65535,M&=65535,C[O]=M<<16|F}return new a(C,C[C.length-1]&-2147483648?-1:0)};function j(T,b){return T.add(U(b))}t.j=function(T){if(N(this)||N(T))return v;if(A(this))return A(T)?U(this).j(U(T)):U(U(this).j(T));if(A(T))return U(this.j(U(T)));if(0>this.l(S)&&0>T.l(S))return p(this.m()*T.m());for(var b=this.g.length+T.g.length,C=[],P=0;P<2*b;P++)C[P]=0;for(P=0;P<this.g.length;P++)for(var O=0;O<T.g.length;O++){var F=this.i(P)>>>16,M=this.i(P)&65535,be=T.i(O)>>>16,Re=T.i(O)&65535;C[2*P+2*O]+=M*Re,k(C,2*P+2*O),C[2*P+2*O+1]+=F*Re,k(C,2*P+2*O+1),C[2*P+2*O+1]+=M*be,k(C,2*P+2*O+1),C[2*P+2*O+2]+=F*be,k(C,2*P+2*O+2)}for(P=0;P<b;P++)C[P]=C[2*P+1]<<16|C[2*P];for(P=b;P<2*b;P++)C[P]=0;return new a(C,0)};function k(T,b){for(;(T[b]&65535)!=T[b];)T[b+1]+=T[b]>>>16,T[b]&=65535,b++}function R(T,b){this.g=T,this.h=b}function z(T,b){if(N(b))throw Error("division by zero");if(N(T))return new R(v,v);if(A(T))return b=z(U(T),b),new R(U(b.g),U(b.h));if(A(b))return b=z(T,U(b)),new R(U(b.g),b.h);if(30<T.g.length){if(A(T)||A(b))throw Error("slowDivide_ only works with positive integers.");for(var C=w,P=b;0>=P.l(T);)C=K(C),P=K(P);var O=H(C,1),F=H(P,1);for(P=H(P,2),C=H(C,2);!N(P);){var M=F.add(P);0>=M.l(T)&&(O=O.add(C),F=M),P=H(P,1),C=H(C,1)}return b=j(T,O.j(b)),new R(O,b)}for(O=v;0<=T.l(b);){for(C=Math.max(1,Math.floor(T.m()/b.m())),P=Math.ceil(Math.log(C)/Math.LN2),P=48>=P?1:Math.pow(2,P-48),F=p(C),M=F.j(b);A(M)||0<M.l(T);)C-=P,F=p(C),M=F.j(b);N(F)&&(F=w),O=O.add(F),T=j(T,M)}return new R(O,T)}t.A=function(T){return z(this,T).h},t.and=function(T){for(var b=Math.max(this.g.length,T.g.length),C=[],P=0;P<b;P++)C[P]=this.i(P)&T.i(P);return new a(C,this.h&T.h)},t.or=function(T){for(var b=Math.max(this.g.length,T.g.length),C=[],P=0;P<b;P++)C[P]=this.i(P)|T.i(P);return new a(C,this.h|T.h)},t.xor=function(T){for(var b=Math.max(this.g.length,T.g.length),C=[],P=0;P<b;P++)C[P]=this.i(P)^T.i(P);return new a(C,this.h^T.h)};function K(T){for(var b=T.g.length+1,C=[],P=0;P<b;P++)C[P]=T.i(P)<<1|T.i(P-1)>>>31;return new a(C,T.h)}function H(T,b){var C=b>>5;b%=32;for(var P=T.g.length-C,O=[],F=0;F<P;F++)O[F]=0<b?T.i(F+C)>>>b|T.i(F+C+1)<<32-b:T.i(F+C);return new a(O,T.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,FI=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=p,a.fromString=y,Oo=a}).apply(typeof $x<"u"?$x:typeof self<"u"?self:typeof window<"u"?window:{});var $d=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var UI,Fu,BI,_h,Cg,zI,qI,$I;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(d,g,x){return d==Array.prototype||d==Object.prototype||(d[g]=x.value),d};function n(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof $d=="object"&&$d];for(var g=0;g<d.length;++g){var x=d[g];if(x&&x.Math==Math)return x}throw Error("Cannot find global object")}var r=n(this);function i(d,g){if(g)e:{var x=r;d=d.split(".");for(var I=0;I<d.length-1;I++){var q=d[I];if(!(q in x))break e;x=x[q]}d=d[d.length-1],I=x[d],g=g(I),g!=I&&g!=null&&e(x,d,{configurable:!0,writable:!0,value:g})}}function o(d,g){d instanceof String&&(d+="");var x=0,I=!1,q={next:function(){if(!I&&x<d.length){var Q=x++;return{value:g(Q,d[Q]),done:!1}}return I=!0,{done:!0,value:void 0}}};return q[Symbol.iterator]=function(){return q},q}i("Array.prototype.values",function(d){return d||function(){return o(this,function(g,x){return x})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},c=this||self;function h(d){var g=typeof d;return g=g!="object"?g:d?Array.isArray(d)?"array":g:"null",g=="array"||g=="object"&&typeof d.length=="number"}function p(d){var g=typeof d;return g=="object"&&d!=null||g=="function"}function y(d,g,x){return d.call.apply(d.bind,arguments)}function v(d,g,x){if(!d)throw Error();if(2<arguments.length){var I=Array.prototype.slice.call(arguments,2);return function(){var q=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(q,I),d.apply(g,q)}}return function(){return d.apply(g,arguments)}}function w(d,g,x){return w=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?y:v,w.apply(null,arguments)}function S(d,g){var x=Array.prototype.slice.call(arguments,1);return function(){var I=x.slice();return I.push.apply(I,arguments),d.apply(this,I)}}function N(d,g){function x(){}x.prototype=g.prototype,d.aa=g.prototype,d.prototype=new x,d.prototype.constructor=d,d.Qb=function(I,q,Q){for(var ae=Array(arguments.length-2),tt=2;tt<arguments.length;tt++)ae[tt-2]=arguments[tt];return g.prototype[q].apply(I,ae)}}function A(d){const g=d.length;if(0<g){const x=Array(g);for(let I=0;I<g;I++)x[I]=d[I];return x}return[]}function U(d,g){for(let x=1;x<arguments.length;x++){const I=arguments[x];if(h(I)){const q=d.length||0,Q=I.length||0;d.length=q+Q;for(let ae=0;ae<Q;ae++)d[q+ae]=I[ae]}else d.push(I)}}class j{constructor(g,x){this.i=g,this.j=x,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function k(d){return/^[\s\xa0]*$/.test(d)}function R(){var d=c.navigator;return d&&(d=d.userAgent)?d:""}function z(d){return z[" "](d),d}z[" "]=function(){};var K=R().indexOf("Gecko")!=-1&&!(R().toLowerCase().indexOf("webkit")!=-1&&R().indexOf("Edge")==-1)&&!(R().indexOf("Trident")!=-1||R().indexOf("MSIE")!=-1)&&R().indexOf("Edge")==-1;function H(d,g,x){for(const I in d)g.call(x,d[I],I,d)}function T(d,g){for(const x in d)g.call(void 0,d[x],x,d)}function b(d){const g={};for(const x in d)g[x]=d[x];return g}const C="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function P(d,g){let x,I;for(let q=1;q<arguments.length;q++){I=arguments[q];for(x in I)d[x]=I[x];for(let Q=0;Q<C.length;Q++)x=C[Q],Object.prototype.hasOwnProperty.call(I,x)&&(d[x]=I[x])}}function O(d){var g=1;d=d.split(":");const x=[];for(;0<g&&d.length;)x.push(d.shift()),g--;return d.length&&x.push(d.join(":")),x}function F(d){c.setTimeout(()=>{throw d},0)}function M(){var d=se;let g=null;return d.g&&(g=d.g,d.g=d.g.next,d.g||(d.h=null),g.next=null),g}class be{constructor(){this.h=this.g=null}add(g,x){const I=Re.get();I.set(g,x),this.h?this.h.next=I:this.g=I,this.h=I}}var Re=new j(()=>new De,d=>d.reset());class De{constructor(){this.next=this.g=this.h=null}set(g,x){this.h=g,this.g=x,this.next=null}reset(){this.next=this.g=this.h=null}}let ut,G=!1,se=new be,X=()=>{const d=c.Promise.resolve(void 0);ut=()=>{d.then(ue)}};var ue=()=>{for(var d;d=M();){try{d.h.call(d.g)}catch(x){F(x)}var g=Re;g.j(d),100>g.h&&(g.h++,d.next=g.g,g.g=d)}G=!1};function de(){this.s=this.s,this.C=this.C}de.prototype.s=!1,de.prototype.ma=function(){this.s||(this.s=!0,this.N())},de.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ve(d,g){this.type=d,this.g=this.target=g,this.defaultPrevented=!1}ve.prototype.h=function(){this.defaultPrevented=!0};var Te=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var d=!1,g=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const x=()=>{};c.addEventListener("test",x,g),c.removeEventListener("test",x,g)}catch{}return d}();function xe(d,g){if(ve.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d){var x=this.type=d.type,I=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;if(this.target=d.target||d.srcElement,this.g=g,g=d.relatedTarget){if(K){e:{try{z(g.nodeName);var q=!0;break e}catch{}q=!1}q||(g=null)}}else x=="mouseover"?g=d.fromElement:x=="mouseout"&&(g=d.toElement);this.relatedTarget=g,I?(this.clientX=I.clientX!==void 0?I.clientX:I.pageX,this.clientY=I.clientY!==void 0?I.clientY:I.pageY,this.screenX=I.screenX||0,this.screenY=I.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=typeof d.pointerType=="string"?d.pointerType:ge[d.pointerType]||"",this.state=d.state,this.i=d,d.defaultPrevented&&xe.aa.h.call(this)}}N(xe,ve);var ge={2:"touch",3:"pen",4:"mouse"};xe.prototype.h=function(){xe.aa.h.call(this);var d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var Je="closure_listenable_"+(1e6*Math.random()|0),Jt=0;function St(d,g,x,I,q){this.listener=d,this.proxy=null,this.src=g,this.type=x,this.capture=!!I,this.ha=q,this.key=++Jt,this.da=this.fa=!1}function it(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function Ue(d){this.src=d,this.g={},this.h=0}Ue.prototype.add=function(d,g,x,I,q){var Q=d.toString();d=this.g[Q],d||(d=this.g[Q]=[],this.h++);var ae=Ze(d,g,I,q);return-1<ae?(g=d[ae],x||(g.fa=!1)):(g=new St(g,this.src,Q,!!I,q),g.fa=x,d.push(g)),g};function yt(d,g){var x=g.type;if(x in d.g){var I=d.g[x],q=Array.prototype.indexOf.call(I,g,void 0),Q;(Q=0<=q)&&Array.prototype.splice.call(I,q,1),Q&&(it(g),d.g[x].length==0&&(delete d.g[x],d.h--))}}function Ze(d,g,x,I){for(var q=0;q<d.length;++q){var Q=d[q];if(!Q.da&&Q.listener==g&&Q.capture==!!x&&Q.ha==I)return q}return-1}var mn="closure_lm_"+(1e6*Math.random()|0),or={};function rs(d,g,x,I,q){if(Array.isArray(g)){for(var Q=0;Q<g.length;Q++)rs(d,g[Q],x,I,q);return null}return x=fo(x),d&&d[Je]?d.K(g,x,p(I)?!!I.capture:!1,q):yi(d,g,x,!1,I,q)}function yi(d,g,x,I,q,Q){if(!g)throw Error("Invalid event type");var ae=p(q)?!!q.capture:!!q,tt=_i(d);if(tt||(d[mn]=tt=new Ue(d)),x=tt.add(g,x,I,ae,Q),x.proxy)return x;if(I=is(),x.proxy=I,I.src=d,I.listener=x,d.addEventListener)Te||(q=ae),q===void 0&&(q=!1),d.addEventListener(g.toString(),I,q);else if(d.attachEvent)d.attachEvent(Hr(g.toString()),I);else if(d.addListener&&d.removeListener)d.addListener(I);else throw Error("addEventListener and attachEvent are unavailable.");return x}function is(){function d(x){return g.call(d.src,d.listener,x)}const g=Ir;return d}function da(d,g,x,I,q){if(Array.isArray(g))for(var Q=0;Q<g.length;Q++)da(d,g[Q],x,I,q);else I=p(I)?!!I.capture:!!I,x=fo(x),d&&d[Je]?(d=d.i,g=String(g).toString(),g in d.g&&(Q=d.g[g],x=Ze(Q,x,I,q),-1<x&&(it(Q[x]),Array.prototype.splice.call(Q,x,1),Q.length==0&&(delete d.g[g],d.h--)))):d&&(d=_i(d))&&(g=d.g[g.toString()],d=-1,g&&(d=Ze(g,x,I,q)),(x=-1<d?g[d]:null)&&ss(x))}function ss(d){if(typeof d!="number"&&d&&!d.da){var g=d.src;if(g&&g[Je])yt(g.i,d);else{var x=d.type,I=d.proxy;g.removeEventListener?g.removeEventListener(x,I,d.capture):g.detachEvent?g.detachEvent(Hr(x),I):g.addListener&&g.removeListener&&g.removeListener(I),(x=_i(g))?(yt(x,d),x.h==0&&(x.src=null,g[mn]=null)):it(d)}}}function Hr(d){return d in or?or[d]:or[d]="on"+d}function Ir(d,g){if(d.da)d=!0;else{g=new xe(g,this);var x=d.listener,I=d.ha||d.src;d.fa&&ss(d),d=x.call(I,g)}return d}function _i(d){return d=d[mn],d instanceof Ue?d:null}var ho="__closure_events_fn_"+(1e9*Math.random()>>>0);function fo(d){return typeof d=="function"?d:(d[ho]||(d[ho]=function(g){return d.handleEvent(g)}),d[ho])}function _t(){de.call(this),this.i=new Ue(this),this.M=this,this.F=null}N(_t,de),_t.prototype[Je]=!0,_t.prototype.removeEventListener=function(d,g,x,I){da(this,d,g,x,I)};function Pt(d,g){var x,I=d.F;if(I)for(x=[];I;I=I.F)x.push(I);if(d=d.M,I=g.type||g,typeof g=="string")g=new ve(g,d);else if(g instanceof ve)g.target=g.target||d;else{var q=g;g=new ve(I,d),P(g,q)}if(q=!0,x)for(var Q=x.length-1;0<=Q;Q--){var ae=g.g=x[Q];q=Wr(ae,I,!0,g)&&q}if(ae=g.g=d,q=Wr(ae,I,!0,g)&&q,q=Wr(ae,I,!1,g)&&q,x)for(Q=0;Q<x.length;Q++)ae=g.g=x[Q],q=Wr(ae,I,!1,g)&&q}_t.prototype.N=function(){if(_t.aa.N.call(this),this.i){var d=this.i,g;for(g in d.g){for(var x=d.g[g],I=0;I<x.length;I++)it(x[I]);delete d.g[g],d.h--}}this.F=null},_t.prototype.K=function(d,g,x,I){return this.i.add(String(d),g,!1,x,I)},_t.prototype.L=function(d,g,x,I){return this.i.add(String(d),g,!0,x,I)};function Wr(d,g,x,I){if(g=d.i.g[String(g)],!g)return!0;g=g.concat();for(var q=!0,Q=0;Q<g.length;++Q){var ae=g[Q];if(ae&&!ae.da&&ae.capture==x){var tt=ae.listener,Ot=ae.ha||ae.src;ae.fa&&yt(d.i,ae),q=tt.call(Ot,I)!==!1&&q}}return q&&!I.defaultPrevented}function po(d,g,x){if(typeof d=="function")x&&(d=w(d,x));else if(d&&typeof d.handleEvent=="function")d=w(d.handleEvent,d);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:c.setTimeout(d,g||0)}function Sn(d){d.g=po(()=>{d.g=null,d.i&&(d.i=!1,Sn(d))},d.l);const g=d.h;d.h=null,d.m.apply(null,g)}class ha extends de{constructor(g,x){super(),this.m=g,this.l=x,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:Sn(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function kr(d){de.call(this),this.h=d,this.g={}}N(kr,de);var Sr=[];function Pr(d){H(d.g,function(g,x){this.g.hasOwnProperty(x)&&ss(g)},d),d.g={}}kr.prototype.N=function(){kr.aa.N.call(this),Pr(this)},kr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var os=c.JSON.stringify,fa=c.JSON.parse,Gr=class{stringify(d){return c.JSON.stringify(d,void 0)}parse(d){return c.JSON.parse(d,void 0)}};function as(){}as.prototype.h=null;function pa(d){return d.h||(d.h=d.i())}function ls(){}var Ar={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function us(){ve.call(this,"d")}N(us,ve);function mo(){ve.call(this,"c")}N(mo,ve);var Nr={},ma=null;function vi(){return ma=ma||new _t}Nr.La="serverreachability";function ga(d){ve.call(this,Nr.La,d)}N(ga,ve);function gn(d){const g=vi();Pt(g,new ga(g))}Nr.STAT_EVENT="statevent";function vt(d,g){ve.call(this,Nr.STAT_EVENT,d),this.stat=g}N(vt,ve);function lt(d){const g=vi();Pt(g,new vt(g,d))}Nr.Ma="timingevent";function Wt(d,g){ve.call(this,Nr.Ma,d),this.size=g}N(Wt,ve);function Kr(d,g){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){d()},g)}function Zr(){this.g=!0}Zr.prototype.xa=function(){this.g=!1};function yn(d,g,x,I,q,Q){d.info(function(){if(d.g)if(Q)for(var ae="",tt=Q.split("&"),Ot=0;Ot<tt.length;Ot++){var He=tt[Ot].split("=");if(1<He.length){var ot=He[0];He=He[1];var wt=ot.split("_");ae=2<=wt.length&&wt[1]=="type"?ae+(ot+"="+He+"&"):ae+(ot+"=redacted&")}}else ae=null;else ae=Q;return"XMLHTTP REQ ("+I+") [attempt "+q+"]: "+g+`
`+x+`
`+ae})}function oe(d,g,x,I,q,Q,ae){d.info(function(){return"XMLHTTP RESP ("+I+") [ attempt "+q+"]: "+g+`
`+x+`
`+Q+" "+ae})}function Cr(d,g,x,I){d.info(function(){return"XMLHTTP TEXT ("+g+"): "+_a(d,x)+(I?" "+I:"")})}function ya(d,g){d.info(function(){return"TIMEOUT: "+g})}Zr.prototype.info=function(){};function _a(d,g){if(!d.g)return g;if(!g)return null;try{var x=JSON.parse(g);if(x){for(d=0;d<x.length;d++)if(Array.isArray(x[d])){var I=x[d];if(!(2>I.length)){var q=I[1];if(Array.isArray(q)&&!(1>q.length)){var Q=q[0];if(Q!="noop"&&Q!="stop"&&Q!="close")for(var ae=1;ae<q.length;ae++)q[ae]=""}}}}return os(x)}catch{return g}}var xi={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},cs={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},wi;function qn(){}N(qn,as),qn.prototype.g=function(){return new XMLHttpRequest},qn.prototype.i=function(){return{}},wi=new qn;function $n(d,g,x,I){this.j=d,this.i=g,this.l=x,this.R=I||1,this.U=new kr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new va}function va(){this.i=null,this.g="",this.h=!1}var xa={},go={};function ds(d,g,x){d.L=1,d.v=Pn($e(g)),d.m=x,d.P=!0,yo(d,null)}function yo(d,g){d.F=Date.now(),fs(d),d.A=$e(d.v);var x=d.A,I=d.R;Array.isArray(I)||(I=[String(I)]),od(x.i,"t",I),d.C=0,x=d.j.J,d.h=new va,d.g=fd(d.j,x?g:null,!d.m),0<d.O&&(d.M=new ha(w(d.Y,d,d.g),d.O)),g=d.U,x=d.g,I=d.ca;var q="readystatechange";Array.isArray(q)||(q&&(Sr[0]=q.toString()),q=Sr);for(var Q=0;Q<q.length;Q++){var ae=rs(x,q[Q],I||g.handleEvent,!1,g.h||g);if(!ae)break;g.g[ae.key]=ae}g=d.H?b(d.H):{},d.m?(d.u||(d.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.A,d.u,d.m,g)):(d.u="GET",d.g.ea(d.A,d.u,null,g)),gn(),yn(d.i,d.u,d.A,d.l,d.R,d.m)}$n.prototype.ca=function(d){d=d.target;const g=this.M;g&&_n(d)==3?g.j():this.Y(d)},$n.prototype.Y=function(d){try{if(d==this.g)e:{const wt=_n(this.g);var g=this.g.Ba();const xs=this.g.Z();if(!(3>wt)&&(wt!=3||this.g&&(this.h.h||this.g.oa()||au(this.g)))){this.J||wt!=4||g==7||(g==8||0>=xs?gn(3):gn(2)),Se(this);var x=this.g.Z();this.X=x;t:if(wa(this)){var I=au(this.g);d="";var q=I.length,Q=_n(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){lr(this),Qr(this);var ae="";break t}this.h.i=new c.TextDecoder}for(g=0;g<q;g++)this.h.h=!0,d+=this.h.i.decode(I[g],{stream:!(Q&&g==q-1)});I.length=0,this.h.g+=d,this.C=0,ae=this.h.g}else ae=this.g.oa();if(this.o=x==200,oe(this.i,this.u,this.A,this.l,this.R,wt,x),this.o){if(this.T&&!this.K){t:{if(this.g){var tt,Ot=this.g;if((tt=Ot.g?Ot.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(tt)){var He=tt;break t}}He=null}if(x=He)Cr(this.i,this.l,x,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Yr(this,x);else{this.o=!1,this.s=3,lt(12),lr(this),Qr(this);break e}}if(this.P){x=!0;let jt;for(;!this.J&&this.C<ae.length;)if(jt=hs(this,ae),jt==go){wt==4&&(this.s=4,lt(14),x=!1),Cr(this.i,this.l,null,"[Incomplete Response]");break}else if(jt==xa){this.s=4,lt(15),Cr(this.i,this.l,ae,"[Invalid Chunk]"),x=!1;break}else Cr(this.i,this.l,jt,null),Yr(this,jt);if(wa(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),wt!=4||ae.length!=0||this.h.h||(this.s=1,lt(16),x=!1),this.o=this.o&&x,!x)Cr(this.i,this.l,ae,"[Invalid Chunked Response]"),lr(this),Qr(this);else if(0<ae.length&&!this.W){this.W=!0;var ot=this.j;ot.g==this&&ot.ba&&!ot.M&&(ot.j.info("Great, no buffering proxy detected. Bytes received: "+ae.length),Aa(ot),ot.M=!0,lt(11))}}else Cr(this.i,this.l,ae,null),Yr(this,ae);wt==4&&lr(this),this.o&&!this.J&&(wt==4?uu(this.j,this):(this.o=!1,fs(this)))}else Ap(this.g),x==400&&0<ae.indexOf("Unknown SID")?(this.s=3,lt(12)):(this.s=0,lt(13)),lr(this),Qr(this)}}}catch{}finally{}};function wa(d){return d.g?d.u=="GET"&&d.L!=2&&d.j.Ca:!1}function hs(d,g){var x=d.C,I=g.indexOf(`
`,x);return I==-1?go:(x=Number(g.substring(x,I)),isNaN(x)?xa:(I+=1,I+x>g.length?go:(g=g.slice(I,I+x),d.C=I+x,g)))}$n.prototype.cancel=function(){this.J=!0,lr(this)};function fs(d){d.S=Date.now()+d.I,ar(d,d.I)}function ar(d,g){if(d.B!=null)throw Error("WatchDog timer not null");d.B=Kr(w(d.ba,d),g)}function Se(d){d.B&&(c.clearTimeout(d.B),d.B=null)}$n.prototype.ba=function(){this.B=null;const d=Date.now();0<=d-this.S?(ya(this.i,this.A),this.L!=2&&(gn(),lt(17)),lr(this),this.s=2,Qr(this)):ar(this,this.S-d)};function Qr(d){d.j.G==0||d.J||uu(d.j,d)}function lr(d){Se(d);var g=d.M;g&&typeof g.ma=="function"&&g.ma(),d.M=null,Pr(d.U),d.g&&(g=d.g,d.g=null,g.abort(),g.ma())}function Yr(d,g){try{var x=d.j;if(x.G!=0&&(x.g==d||je(x.h,d))){if(!d.K&&je(x.h,d)&&x.G==3){try{var I=x.Da.g.parse(g)}catch{I=null}if(Array.isArray(I)&&I.length==3){var q=I;if(q[0]==0){e:if(!x.u){if(x.g)if(x.g.F+3e3<d.F)Ca(x),Sa(x);else break e;Pa(x),lt(18)}}else x.za=q[1],0<x.za-x.T&&37500>q[2]&&x.F&&x.v==0&&!x.C&&(x.C=Kr(w(x.Za,x),6e3));if(1>=Rr(x.h)&&x.ca){try{x.ca()}catch{}x.ca=void 0}}else Ti(x,11)}else if((d.K||x.g==d)&&Ca(x),!k(g))for(q=x.Da.g.parse(g),g=0;g<q.length;g++){let He=q[g];if(x.T=He[0],He=He[1],x.G==2)if(He[0]=="c"){x.K=He[1],x.ia=He[2];const ot=He[3];ot!=null&&(x.la=ot,x.j.info("VER="+x.la));const wt=He[4];wt!=null&&(x.Aa=wt,x.j.info("SVER="+x.Aa));const xs=He[5];xs!=null&&typeof xs=="number"&&0<xs&&(I=1.5*xs,x.L=I,x.j.info("backChannelRequestTimeoutMs_="+I)),I=x;const jt=d.g;if(jt){const ja=jt.g?jt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ja){var Q=I.h;Q.g||ja.indexOf("spdy")==-1&&ja.indexOf("quic")==-1&&ja.indexOf("h2")==-1||(Q.j=Q.l,Q.g=new Set,Q.h&&(Xe(Q,Q.h),Q.h=null))}if(I.D){const ti=jt.g?jt.g.getResponseHeader("X-HTTP-Session-Id"):null;ti&&(I.ya=ti,Pe(I.I,I.D,ti))}}x.G=3,x.l&&x.l.ua(),x.ba&&(x.R=Date.now()-d.F,x.j.info("Handshake RTT: "+x.R+"ms")),I=x;var ae=d;if(I.qa=Ra(I,I.J?I.ia:null,I.W),ae.K){Xr(I.h,ae);var tt=ae,Ot=I.L;Ot&&(tt.I=Ot),tt.B&&(Se(tt),fs(tt)),I.g=ae}else Lr(I);0<x.i.length&&vs(x)}else He[0]!="stop"&&He[0]!="close"||Ti(x,7);else x.G==3&&(He[0]=="stop"||He[0]=="close"?He[0]=="stop"?Ti(x,7):ka(x):He[0]!="noop"&&x.l&&x.l.ta(He),x.v=0)}}gn(4)}catch{}}var Jr=class{constructor(d,g){this.g=d,this.map=g}};function ps(d){this.l=d||10,c.PerformanceNavigationTiming?(d=c.performance.getEntriesByType("navigation"),d=0<d.length&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ms(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function Rr(d){return d.h?1:d.g?d.g.size:0}function je(d,g){return d.h?d.h==g:d.g?d.g.has(g):!1}function Xe(d,g){d.g?d.g.add(g):d.h=g}function Xr(d,g){d.h&&d.h==g?d.h=null:d.g&&d.g.has(g)&&d.g.delete(g)}ps.prototype.cancel=function(){if(this.i=D(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function D(d){if(d.h!=null)return d.i.concat(d.h.D);if(d.g!=null&&d.g.size!==0){let g=d.i;for(const x of d.g.values())g=g.concat(x.D);return g}return A(d.i)}function Y(d){if(d.V&&typeof d.V=="function")return d.V();if(typeof Map<"u"&&d instanceof Map||typeof Set<"u"&&d instanceof Set)return Array.from(d.values());if(typeof d=="string")return d.split("");if(h(d)){for(var g=[],x=d.length,I=0;I<x;I++)g.push(d[I]);return g}g=[],x=0;for(I in d)g[x++]=d[I];return g}function ne(d){if(d.na&&typeof d.na=="function")return d.na();if(!d.V||typeof d.V!="function"){if(typeof Map<"u"&&d instanceof Map)return Array.from(d.keys());if(!(typeof Set<"u"&&d instanceof Set)){if(h(d)||typeof d=="string"){var g=[];d=d.length;for(var x=0;x<d;x++)g.push(x);return g}g=[],x=0;for(const I in d)g[x++]=I;return g}}}function ie(d,g){if(d.forEach&&typeof d.forEach=="function")d.forEach(g,void 0);else if(h(d)||typeof d=="string")Array.prototype.forEach.call(d,g,void 0);else for(var x=ne(d),I=Y(d),q=I.length,Q=0;Q<q;Q++)g.call(void 0,I[Q],x&&x[Q],d)}var fe=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Qe(d,g){if(d){d=d.split("&");for(var x=0;x<d.length;x++){var I=d[x].indexOf("="),q=null;if(0<=I){var Q=d[x].substring(0,I);q=d[x].substring(I+1)}else Q=d[x];g(Q,q?decodeURIComponent(q.replace(/\+/g," ")):"")}}}function Ce(d){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,d instanceof Ce){this.h=d.h,Bt(this,d.j),this.o=d.o,this.g=d.g,ur(this,d.s),this.l=d.l;var g=d.i,x=new bi;x.i=g.i,g.g&&(x.g=new Map(g.g),x.h=g.h),cr(this,x),this.m=d.m}else d&&(g=String(d).match(fe))?(this.h=!1,Bt(this,g[1]||"",!0),this.o=An(g[2]||""),this.g=An(g[3]||"",!0),ur(this,g[4]),this.l=An(g[5]||"",!0),cr(this,g[6]||"",!0),this.m=An(g[7]||"")):(this.h=!1,this.i=new bi(null,this.h))}Ce.prototype.toString=function(){var d=[],g=this.j;g&&d.push(jr(g,gs,!0),":");var x=this.g;return(x||g=="file")&&(d.push("//"),(g=this.o)&&d.push(jr(g,gs,!0),"@"),d.push(encodeURIComponent(String(x)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),x=this.s,x!=null&&d.push(":",String(x))),(x=this.l)&&(this.g&&x.charAt(0)!="/"&&d.push("/"),d.push(jr(x,x.charAt(0)=="/"?Xl:Jl,!0))),(x=this.i.toString())&&d.push("?",x),(x=this.m)&&d.push("#",jr(x,eu)),d.join("")};function $e(d){return new Ce(d)}function Bt(d,g,x){d.j=x?An(g,!0):g,d.j&&(d.j=d.j.replace(/:$/,""))}function ur(d,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);d.s=g}else d.s=null}function cr(d,g,x){g instanceof bi?(d.i=g,dr(d.i,d.h)):(x||(g=jr(g,ba)),d.i=new bi(g,d.h))}function Pe(d,g,x){d.i.set(g,x)}function Pn(d){return Pe(d,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),d}function An(d,g){return d?g?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function jr(d,g,x){return typeof d=="string"?(d=encodeURI(d).replace(g,Yl),x&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function Yl(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var gs=/[#\/\?@]/g,Jl=/[#\?:]/g,Xl=/[#\?]/g,ba=/[#\?@]/g,eu=/#/g;function bi(d,g){this.h=this.g=null,this.i=d||null,this.j=!!g}function Hn(d){d.g||(d.g=new Map,d.h=0,d.i&&Qe(d.i,function(g,x){d.add(decodeURIComponent(g.replace(/\+/g," ")),x)}))}t=bi.prototype,t.add=function(d,g){Hn(this),this.i=null,d=Ie(this,d);var x=this.g.get(d);return x||this.g.set(d,x=[]),x.push(g),this.h+=1,this};function tu(d,g){Hn(d),g=Ie(d,g),d.g.has(g)&&(d.i=null,d.h-=d.g.get(g).length,d.g.delete(g))}function Ea(d,g){return Hn(d),g=Ie(d,g),d.g.has(g)}t.forEach=function(d,g){Hn(this),this.g.forEach(function(x,I){x.forEach(function(q){d.call(g,q,I,this)},this)},this)},t.na=function(){Hn(this);const d=Array.from(this.g.values()),g=Array.from(this.g.keys()),x=[];for(let I=0;I<g.length;I++){const q=d[I];for(let Q=0;Q<q.length;Q++)x.push(g[I])}return x},t.V=function(d){Hn(this);let g=[];if(typeof d=="string")Ea(this,d)&&(g=g.concat(this.g.get(Ie(this,d))));else{d=Array.from(this.g.values());for(let x=0;x<d.length;x++)g=g.concat(d[x])}return g},t.set=function(d,g){return Hn(this),this.i=null,d=Ie(this,d),Ea(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[g]),this.h+=1,this},t.get=function(d,g){return d?(d=this.V(d),0<d.length?String(d[0]):g):g};function od(d,g,x){tu(d,g),0<x.length&&(d.i=null,d.g.set(Ie(d,g),A(x)),d.h+=x.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],g=Array.from(this.g.keys());for(var x=0;x<g.length;x++){var I=g[x];const Q=encodeURIComponent(String(I)),ae=this.V(I);for(I=0;I<ae.length;I++){var q=Q;ae[I]!==""&&(q+="="+encodeURIComponent(String(ae[I]))),d.push(q)}}return this.i=d.join("&")};function Ie(d,g){return g=String(g),d.j&&(g=g.toLowerCase()),g}function dr(d,g){g&&!d.j&&(Hn(d),d.i=null,d.g.forEach(function(x,I){var q=I.toLowerCase();I!=q&&(tu(this,I),od(this,q,x))},d)),d.j=g}function st(d,g){const x=new Zr;if(c.Image){const I=new Image;I.onload=S(hr,x,"TestLoadImage: loaded",!0,g,I),I.onerror=S(hr,x,"TestLoadImage: error",!1,g,I),I.onabort=S(hr,x,"TestLoadImage: abort",!1,g,I),I.ontimeout=S(hr,x,"TestLoadImage: timeout",!1,g,I),c.setTimeout(function(){I.ontimeout&&I.ontimeout()},1e4),I.src=d}else g(!1)}function ad(d,g){const x=new Zr,I=new AbortController,q=setTimeout(()=>{I.abort(),hr(x,"TestPingServer: timeout",!1,g)},1e4);fetch(d,{signal:I.signal}).then(Q=>{clearTimeout(q),Q.ok?hr(x,"TestPingServer: ok",!0,g):hr(x,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(q),hr(x,"TestPingServer: error",!1,g)})}function hr(d,g,x,I,q){try{q&&(q.onload=null,q.onerror=null,q.onabort=null,q.ontimeout=null),I(x)}catch{}}function nu(){this.g=new Gr}function ru(d,g,x){const I=x||"";try{ie(d,function(q,Q){let ae=q;p(q)&&(ae=os(q)),g.push(I+Q+"="+encodeURIComponent(ae))})}catch(q){throw g.push(I+"type="+encodeURIComponent("_badmap")),q}}function fr(d){this.l=d.Ub||null,this.j=d.eb||!1}N(fr,as),fr.prototype.g=function(){return new ys(this.l,this.j)},fr.prototype.i=function(d){return function(){return d}}({});function ys(d,g){_t.call(this),this.D=d,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}N(ys,_t),t=ys.prototype,t.open=function(d,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=d,this.A=g,this.readyState=1,Wn(this)},t.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};d&&(g.body=d),(this.D||c).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,xt(this)),this.readyState=0},t.Sa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,Wn(this)),this.g&&(this.readyState=3,Wn(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;_s(this)}else d.text().then(this.Ra.bind(this),this.ga.bind(this))};function _s(d){d.j.read().then(d.Pa.bind(d)).catch(d.ga.bind(d))}t.Pa=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var g=d.value?d.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!d.done}))&&(this.response=this.responseText+=g)}d.done?xt(this):Wn(this),this.readyState==3&&_s(this)}},t.Ra=function(d){this.g&&(this.response=this.responseText=d,xt(this))},t.Qa=function(d){this.g&&(this.response=d,xt(this))},t.ga=function(){this.g&&xt(this)};function xt(d){d.readyState=4,d.l=null,d.j=null,d.v=null,Wn(d)}t.setRequestHeader=function(d,g){this.u.append(d,g)},t.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],g=this.h.entries();for(var x=g.next();!x.done;)x=x.value,d.push(x[0]+": "+x[1]),x=g.next();return d.join(`\r
`)};function Wn(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(ys.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function iu(d){let g="";return H(d,function(x,I){g+=I,g+=":",g+=x,g+=`\r
`}),g}function Ta(d,g,x){e:{for(I in x){var I=!1;break e}I=!0}I||(x=iu(x),typeof d=="string"?x!=null&&encodeURIComponent(String(x)):Pe(d,g,x))}function pt(d){_t.call(this),this.headers=new Map,this.o=d||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}N(pt,_t);var ld=/^https?$/i,su=["POST","PUT"];t=pt.prototype,t.Ha=function(d){this.J=d},t.ea=function(d,g,x,I){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);g=g?g.toUpperCase():"GET",this.D=d,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():wi.g(),this.v=this.o?pa(this.o):pa(wi),this.g.onreadystatechange=w(this.Ea,this);try{this.B=!0,this.g.open(g,String(d),!0),this.B=!1}catch(Q){ud(this,Q);return}if(d=x||"",x=new Map(this.headers),I)if(Object.getPrototypeOf(I)===Object.prototype)for(var q in I)x.set(q,I[q]);else if(typeof I.keys=="function"&&typeof I.get=="function")for(const Q of I.keys())x.set(Q,I.get(Q));else throw Error("Unknown input type for opt_headers: "+String(I));I=Array.from(x.keys()).find(Q=>Q.toLowerCase()=="content-type"),q=c.FormData&&d instanceof c.FormData,!(0<=Array.prototype.indexOf.call(su,g,void 0))||I||q||x.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Q,ae]of x)this.g.setRequestHeader(Q,ae);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Nn(this),this.u=!0,this.g.send(d),this.u=!1}catch(Q){ud(this,Q)}};function ud(d,g){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=g,d.m=5,ou(d),Ia(d)}function ou(d){d.A||(d.A=!0,Pt(d,"complete"),Pt(d,"error"))}t.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=d||7,Pt(this,"complete"),Pt(this,"abort"),Ia(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ia(this,!0)),pt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Ve(this):this.bb())},t.bb=function(){Ve(this)};function Ve(d){if(d.h&&typeof a<"u"&&(!d.v[1]||_n(d)!=4||d.Z()!=2)){if(d.u&&_n(d)==4)po(d.Ea,0,d);else if(Pt(d,"readystatechange"),_n(d)==4){d.h=!1;try{const ae=d.Z();e:switch(ae){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var x;if(!(x=g)){var I;if(I=ae===0){var q=String(d.D).match(fe)[1]||null;!q&&c.self&&c.self.location&&(q=c.self.location.protocol.slice(0,-1)),I=!ld.test(q?q.toLowerCase():"")}x=I}if(x)Pt(d,"complete"),Pt(d,"success");else{d.m=6;try{var Q=2<_n(d)?d.g.statusText:""}catch{Q=""}d.l=Q+" ["+d.Z()+"]",ou(d)}}finally{Ia(d)}}}}function Ia(d,g){if(d.g){Nn(d);const x=d.g,I=d.v[0]?()=>{}:null;d.g=null,d.v=null,g||Pt(d,"ready");try{x.onreadystatechange=I}catch{}}}function Nn(d){d.I&&(c.clearTimeout(d.I),d.I=null)}t.isActive=function(){return!!this.g};function _n(d){return d.g?d.g.readyState:0}t.Z=function(){try{return 2<_n(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(d){if(this.g){var g=this.g.responseText;return d&&g.indexOf(d)==0&&(g=g.substring(d.length)),fa(g)}};function au(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.H){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function Ap(d){const g={};d=(d.g&&2<=_n(d)&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let I=0;I<d.length;I++){if(k(d[I]))continue;var x=O(d[I]);const q=x[0];if(x=x[1],typeof x!="string")continue;x=x.trim();const Q=g[q]||[];g[q]=Q,Q.push(x)}T(g,function(I){return I.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ei(d,g,x){return x&&x.internalChannelParams&&x.internalChannelParams[d]||g}function cd(d){this.Aa=0,this.i=[],this.j=new Zr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ei("failFast",!1,d),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ei("baseRetryDelayMs",5e3,d),this.cb=Ei("retryDelaySeedMs",1e4,d),this.Wa=Ei("forwardChannelMaxRetries",2,d),this.wa=Ei("forwardChannelRequestTimeoutMs",2e4,d),this.pa=d&&d.xmlHttpFactory||void 0,this.Xa=d&&d.Tb||void 0,this.Ca=d&&d.useFetchStreams||!1,this.L=void 0,this.J=d&&d.supportsCrossDomainXhr||!1,this.K="",this.h=new ps(d&&d.concurrentRequestLimit),this.Da=new nu,this.P=d&&d.fastHandshake||!1,this.O=d&&d.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=d&&d.Rb||!1,d&&d.xa&&this.j.xa(),d&&d.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&d&&d.detectBufferingProxy||!1,this.ja=void 0,d&&d.longPollingTimeout&&0<d.longPollingTimeout&&(this.ja=d.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=cd.prototype,t.la=8,t.G=1,t.connect=function(d,g,x,I){lt(0),this.W=d,this.H=g||{},x&&I!==void 0&&(this.H.OSID=x,this.H.OAID=I),this.F=this.X,this.I=Ra(this,null,this.W),vs(this)};function ka(d){if(dd(d),d.G==3){var g=d.U++,x=$e(d.I);if(Pe(x,"SID",d.K),Pe(x,"RID",g),Pe(x,"TYPE","terminate"),_o(d,x),g=new $n(d,d.j,g),g.L=2,g.v=Pn($e(x)),x=!1,c.navigator&&c.navigator.sendBeacon)try{x=c.navigator.sendBeacon(g.v.toString(),"")}catch{}!x&&c.Image&&(new Image().src=g.v,x=!0),x||(g.g=fd(g.j,null),g.g.ea(g.v)),g.F=Date.now(),fs(g)}hd(d)}function Sa(d){d.g&&(Aa(d),d.g.cancel(),d.g=null)}function dd(d){Sa(d),d.u&&(c.clearTimeout(d.u),d.u=null),Ca(d),d.h.cancel(),d.s&&(typeof d.s=="number"&&c.clearTimeout(d.s),d.s=null)}function vs(d){if(!ms(d.h)&&!d.s){d.s=!0;var g=d.Ga;ut||X(),G||(ut(),G=!0),se.add(g,d),d.B=0}}function Np(d,g){return Rr(d.h)>=d.h.j-(d.s?1:0)?!1:d.s?(d.i=g.D.concat(d.i),!0):d.G==1||d.G==2||d.B>=(d.Va?0:d.Wa)?!1:(d.s=Kr(w(d.Ga,d,g),cu(d,d.B)),d.B++,!0)}t.Ga=function(d){if(this.s)if(this.s=null,this.G==1){if(!d){this.U=Math.floor(1e5*Math.random()),d=this.U++;const q=new $n(this,this.j,d);let Q=this.o;if(this.S&&(Q?(Q=b(Q),P(Q,this.S)):Q=this.S),this.m!==null||this.O||(q.H=Q,Q=null),this.P)e:{for(var g=0,x=0;x<this.i.length;x++){t:{var I=this.i[x];if("__data__"in I.map&&(I=I.map.__data__,typeof I=="string")){I=I.length;break t}I=void 0}if(I===void 0)break;if(g+=I,4096<g){g=x;break e}if(g===4096||x===this.i.length-1){g=x+1;break e}}g=1e3}else g=1e3;g=lu(this,q,g),x=$e(this.I),Pe(x,"RID",d),Pe(x,"CVER",22),this.D&&Pe(x,"X-HTTP-Session-Id",this.D),_o(this,x),Q&&(this.O?g="headers="+encodeURIComponent(String(iu(Q)))+"&"+g:this.m&&Ta(x,this.m,Q)),Xe(this.h,q),this.Ua&&Pe(x,"TYPE","init"),this.P?(Pe(x,"$req",g),Pe(x,"SID","null"),q.T=!0,ds(q,x,null)):ds(q,x,g),this.G=2}}else this.G==3&&(d?Gn(this,d):this.i.length==0||ms(this.h)||Gn(this))};function Gn(d,g){var x;g?x=g.l:x=d.U++;const I=$e(d.I);Pe(I,"SID",d.K),Pe(I,"RID",x),Pe(I,"AID",d.T),_o(d,I),d.m&&d.o&&Ta(I,d.m,d.o),x=new $n(d,d.j,x,d.B+1),d.m===null&&(x.H=d.o),g&&(d.i=g.D.concat(d.i)),g=lu(d,x,1e3),x.I=Math.round(.5*d.wa)+Math.round(.5*d.wa*Math.random()),Xe(d.h,x),ds(x,I,g)}function _o(d,g){d.H&&H(d.H,function(x,I){Pe(g,I,x)}),d.l&&ie({},function(x,I){Pe(g,I,x)})}function lu(d,g,x){x=Math.min(d.i.length,x);var I=d.l?w(d.l.Na,d.l,d):null;e:{var q=d.i;let Q=-1;for(;;){const ae=["count="+x];Q==-1?0<x?(Q=q[0].g,ae.push("ofs="+Q)):Q=0:ae.push("ofs="+Q);let tt=!0;for(let Ot=0;Ot<x;Ot++){let He=q[Ot].g;const ot=q[Ot].map;if(He-=Q,0>He)Q=Math.max(0,q[Ot].g-100),tt=!1;else try{ru(ot,ae,"req"+He+"_")}catch{I&&I(ot)}}if(tt){I=ae.join("&");break e}}}return d=d.i.splice(0,x),g.D=d,I}function Lr(d){if(!d.g&&!d.u){d.Y=1;var g=d.Fa;ut||X(),G||(ut(),G=!0),se.add(g,d),d.v=0}}function Pa(d){return d.g||d.u||3<=d.v?!1:(d.Y++,d.u=Kr(w(d.Fa,d),cu(d,d.v)),d.v++,!0)}t.Fa=function(){if(this.u=null,Na(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var d=2*this.R;this.j.info("BP detection timer enabled: "+d),this.A=Kr(w(this.ab,this),d)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,lt(10),Sa(this),Na(this))};function Aa(d){d.A!=null&&(c.clearTimeout(d.A),d.A=null)}function Na(d){d.g=new $n(d,d.j,"rpc",d.Y),d.m===null&&(d.g.H=d.o),d.g.O=0;var g=$e(d.qa);Pe(g,"RID","rpc"),Pe(g,"SID",d.K),Pe(g,"AID",d.T),Pe(g,"CI",d.F?"0":"1"),!d.F&&d.ja&&Pe(g,"TO",d.ja),Pe(g,"TYPE","xmlhttp"),_o(d,g),d.m&&d.o&&Ta(g,d.m,d.o),d.L&&(d.g.I=d.L);var x=d.g;d=d.ia,x.L=1,x.v=Pn($e(g)),x.m=null,x.P=!0,yo(x,d)}t.Za=function(){this.C!=null&&(this.C=null,Sa(this),Pa(this),lt(19))};function Ca(d){d.C!=null&&(c.clearTimeout(d.C),d.C=null)}function uu(d,g){var x=null;if(d.g==g){Ca(d),Aa(d),d.g=null;var I=2}else if(je(d.h,g))x=g.D,Xr(d.h,g),I=1;else return;if(d.G!=0){if(g.o)if(I==1){x=g.m?g.m.length:0,g=Date.now()-g.F;var q=d.B;I=vi(),Pt(I,new Wt(I,x)),vs(d)}else Lr(d);else if(q=g.s,q==3||q==0&&0<g.X||!(I==1&&Np(d,g)||I==2&&Pa(d)))switch(x&&0<x.length&&(g=d.h,g.i=g.i.concat(x)),q){case 1:Ti(d,5);break;case 4:Ti(d,10);break;case 3:Ti(d,6);break;default:Ti(d,2)}}}function cu(d,g){let x=d.Ta+Math.floor(Math.random()*d.cb);return d.isActive()||(x*=2),x*g}function Ti(d,g){if(d.j.info("Error code "+g),g==2){var x=w(d.fb,d),I=d.Xa;const q=!I;I=new Ce(I||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||Bt(I,"https"),Pn(I),q?st(I.toString(),x):ad(I.toString(),x)}else lt(2);d.G=0,d.l&&d.l.sa(g),hd(d),dd(d)}t.fb=function(d){d?(this.j.info("Successfully pinged google.com"),lt(2)):(this.j.info("Failed to ping google.com"),lt(1))};function hd(d){if(d.G=0,d.ka=[],d.l){const g=D(d.h);(g.length!=0||d.i.length!=0)&&(U(d.ka,g),U(d.ka,d.i),d.h.i.length=0,A(d.i),d.i.length=0),d.l.ra()}}function Ra(d,g,x){var I=x instanceof Ce?$e(x):new Ce(x);if(I.g!="")g&&(I.g=g+"."+I.g),ur(I,I.s);else{var q=c.location;I=q.protocol,g=g?g+"."+q.hostname:q.hostname,q=+q.port;var Q=new Ce(null);I&&Bt(Q,I),g&&(Q.g=g),q&&ur(Q,q),x&&(Q.l=x),I=Q}return x=d.D,g=d.ya,x&&g&&Pe(I,x,g),Pe(I,"VER",d.la),_o(d,I),I}function fd(d,g,x){if(g&&!d.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=d.Ca&&!d.pa?new pt(new fr({eb:x})):new pt(d.pa),g.Ha(d.J),g}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function du(){}t=du.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function vo(){}vo.prototype.g=function(d,g){return new Gt(d,g)};function Gt(d,g){_t.call(this),this.g=new cd(g),this.l=d,this.h=g&&g.messageUrlParams||null,d=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(d?d["X-WebChannel-Content-Type"]=g.messageContentType:d={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(d?d["X-WebChannel-Client-Profile"]=g.va:d={"X-WebChannel-Client-Profile":g.va}),this.g.S=d,(d=g&&g.Sb)&&!k(d)&&(this.g.m=d),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!k(g)&&(this.g.D=g,d=this.h,d!==null&&g in d&&(d=this.h,g in d&&delete d[g])),this.j=new pr(this)}N(Gt,_t),Gt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Gt.prototype.close=function(){ka(this.g)},Gt.prototype.o=function(d){var g=this.g;if(typeof d=="string"){var x={};x.__data__=d,d=x}else this.u&&(x={},x.__data__=os(d),d=x);g.i.push(new Jr(g.Ya++,d)),g.G==3&&vs(g)},Gt.prototype.N=function(){this.g.l=null,delete this.j,ka(this.g),delete this.g,Gt.aa.N.call(this)};function ei(d){us.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var g=d.__sm__;if(g){e:{for(const x in g){d=x;break e}d=void 0}(this.i=d)&&(d=this.i,g=g!==null&&d in g?g[d]:void 0),this.data=g}else this.data=d}N(ei,us);function pd(){mo.call(this),this.status=1}N(pd,mo);function pr(d){this.g=d}N(pr,du),pr.prototype.ua=function(){Pt(this.g,"a")},pr.prototype.ta=function(d){Pt(this.g,new ei(d))},pr.prototype.sa=function(d){Pt(this.g,new pd)},pr.prototype.ra=function(){Pt(this.g,"b")},vo.prototype.createWebChannel=vo.prototype.g,Gt.prototype.send=Gt.prototype.o,Gt.prototype.open=Gt.prototype.m,Gt.prototype.close=Gt.prototype.close,$I=function(){return new vo},qI=function(){return vi()},zI=Nr,Cg={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},xi.NO_ERROR=0,xi.TIMEOUT=8,xi.HTTP_ERROR=6,_h=xi,cs.COMPLETE="complete",BI=cs,ls.EventType=Ar,Ar.OPEN="a",Ar.CLOSE="b",Ar.ERROR="c",Ar.MESSAGE="d",_t.prototype.listen=_t.prototype.K,Fu=ls,pt.prototype.listenOnce=pt.prototype.L,pt.prototype.getLastError=pt.prototype.Ka,pt.prototype.getLastErrorCode=pt.prototype.Ba,pt.prototype.getStatus=pt.prototype.Z,pt.prototype.getResponseJson=pt.prototype.Oa,pt.prototype.getResponseText=pt.prototype.oa,pt.prototype.send=pt.prototype.ea,pt.prototype.setWithCredentials=pt.prototype.Ha,UI=pt}).apply(typeof $d<"u"?$d:typeof self<"u"?self:typeof window<"u"?window:{});const Hx="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let an=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};an.UNAUTHENTICATED=new an(null),an.GOOGLE_CREDENTIALS=new an("google-credentials-uid"),an.FIRST_PARTY=new an("first-party-uid"),an.MOCK_USER=new an("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $l="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Go=new t_("@firebase/firestore");function qa(){return Go.logLevel}function te(t,...e){if(Go.logLevel<=Be.DEBUG){const n=e.map(p_);Go.debug(`Firestore (${$l}): ${t}`,...n)}}function Dt(t,...e){if(Go.logLevel<=Be.ERROR){const n=e.map(p_);Go.error(`Firestore (${$l}): ${t}`,...n)}}function Sc(t,...e){if(Go.logLevel<=Be.WARN){const n=e.map(p_);Go.warn(`Firestore (${$l}): ${t}`,...n)}}function p_(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function me(t="Unexpected state"){const e=`FIRESTORE (${$l}) INTERNAL ASSERTION FAILED: `+t;throw Dt(e),new Error(e)}function _e(t,e){t||me()}function ye(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class le extends Tr{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qj{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class $j{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(an.UNAUTHENTICATED))}shutdown(){}}class Hj{constructor(e){this.t=e,this.currentUser=an.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){_e(this.o===void 0);let r=this.i;const i=h=>this.i!==r?(r=this.i,n(h)):Promise.resolve();let o=new pi;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new pi,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const h=o;e.enqueueRetryable(async()=>{await h.promise,await i(this.currentUser)})},c=h=>{te("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(h=>c(h)),setTimeout(()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?c(h):(te("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new pi)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(te("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(_e(typeof r.accessToken=="string"),new qj(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return _e(e===null||typeof e=="string"),new an(e)}}class Wj{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=an.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Gj{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new Wj(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(an.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Kj{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Zj{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){_e(this.o===void 0);const r=o=>{o.error!=null&&te("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const a=o.token!==this.R;return this.R=o.token,te("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};const i=o=>{te("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){const o=this.A.getImmediate({optional:!0});o?i(o):te("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(_e(typeof n.token=="string"),this.R=n.token,new Kj(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qj(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HI{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=Qj(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<n&&(r+=e.charAt(i[o]%e.length))}return r}}function Ne(t,e){return t<e?-1:t>e?1:0}function kl(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function WI(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ke{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new le(J.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new le(J.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new le(J.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new le(J.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ke.fromMillis(Date.now())}static fromDate(e){return Ke.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Ke(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ne(this.nanoseconds,e.nanoseconds):Ne(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{constructor(e){this.timestamp=e}static fromTimestamp(e){return new we(e)}static min(){return new we(new Ke(0,0))}static max(){return new we(new Ke(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pc{constructor(e,n,r){n===void 0?n=0:n>e.length&&me(),r===void 0?r=e.length-n:r>e.length-n&&me(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Pc.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Pc?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const o=e.get(i),a=n.get(i);if(o<a)return-1;if(o>a)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class et extends Pc{construct(e,n,r){return new et(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new le(J.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new et(n)}static emptyPath(){return new et([])}}const Yj=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Tt extends Pc{construct(e,n,r){return new Tt(e,n,r)}static isValidIdentifier(e){return Yj.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Tt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Tt(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const o=()=>{if(r.length===0)throw new le(J.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let a=!1;for(;i<e.length;){const c=e[i];if(c==="\\"){if(i+1===e.length)throw new le(J.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new le(J.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,i+=2}else c==="`"?(a=!a,i++):c!=="."||a?(r+=c,i++):(o(),i++)}if(o(),a)throw new le(J.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Tt(n)}static emptyPath(){return new Tt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ce{constructor(e){this.path=e}static fromPath(e){return new ce(et.fromString(e))}static fromName(e){return new ce(et.fromString(e).popFirst(5))}static empty(){return new ce(et.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&et.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return et.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ce(new et(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cf{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function Rg(t){return t.fields.find(e=>e.kind===2)}function To(t){return t.fields.filter(e=>e.kind!==2)}cf.UNKNOWN_ID=-1;class vh{constructor(e,n){this.fieldPath=e,this.kind=n}}class Ac{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Ac(0,rr.min())}}function GI(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=we.fromTimestamp(r===1e9?new Ke(n+1,0):new Ke(n,r));return new rr(i,ce.empty(),e)}function KI(t){return new rr(t.readTime,t.key,-1)}class rr{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new rr(we.min(),ce.empty(),-1)}static max(){return new rr(we.max(),ce.empty(),-1)}}function m_(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ce.comparator(t.documentKey,e.documentKey),n!==0?n:Ne(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class QI{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ao(t){if(t.code!==J.FAILED_PRECONDITION||t.message!==ZI)throw t;te("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&me(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new W((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(n,o).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof W?n:W.resolve(n)}catch(n){return W.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):W.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):W.reject(n)}static resolve(e){return new W((n,r)=>{n(e)})}static reject(e){return new W((n,r)=>{r(e)})}static waitFor(e){return new W((n,r)=>{let i=0,o=0,a=!1;e.forEach(c=>{++i,c.next(()=>{++o,a&&o===i&&n()},h=>r(h))}),a=!0,o===i&&n()})}static or(e){let n=W.resolve(!1);for(const r of e)n=n.next(i=>i?W.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,o)=>{r.push(n.call(this,i,o))}),this.waitFor(r)}static mapArray(e,n){return new W((r,i)=>{const o=e.length,a=new Array(o);let c=0;for(let h=0;h<o;h++){const p=h;n(e[p]).next(y=>{a[p]=y,++c,c===o&&r(a)},y=>i(y))}})}static doWhile(e,n){return new W((r,i)=>{const o=()=>{e()===!0?n().next(()=>{o()},i):r()};o()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yf{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new pi,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new ec(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=g_(r.target.error);this.V.reject(new ec(e,i))}}static open(e,n,r,i){try{return new Yf(n,e.transaction(i,r))}catch(o){throw new ec(n,o)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(te("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new Xj(n)}}class Qs{constructor(e,n,r){this.name=e,this.version=n,this.p=r,Qs.S($t())===12.2&&Dt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return te("SimpleDb","Removing database:",e),ko(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!e_())return!1;if(Qs.v())return!0;const e=$t(),n=Qs.S(e),r=0<n&&n<10,i=YI(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(te("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=o=>{const a=o.target.result;n(a)},i.onblocked=()=>{r(new ec(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=o=>{const a=o.target.error;a.name==="VersionError"?r(new le(J.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):a.name==="InvalidStateError"?r(new le(J.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a)):r(new ec(e,a))},i.onupgradeneeded=o=>{te("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);const a=o.target.result;this.p.O(a,i.transaction,o.oldVersion,this.version).next(()=>{te("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=n=>this.N(n)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const o=n==="readonly";let a=0;for(;;){++a;try{this.db=await this.M(e);const c=Yf.open(this.db,e,o?"readonly":"readwrite",r),h=i(c).next(p=>(c.g(),p)).catch(p=>(c.abort(p),W.reject(p))).toPromise();return h.catch(()=>{}),await c.m,h}catch(c){const h=c,p=h.name!=="FirebaseError"&&a<3;if(te("SimpleDb","Transaction failed with error:",h.message,"Retrying:",p),this.close(),!p)return Promise.reject(h)}}}close(){this.db&&this.db.close(),this.db=void 0}}function YI(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class Jj{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return ko(this.B.delete())}}class ec extends le{constructor(e,n){super(J.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function lo(t){return t.name==="IndexedDbTransactionError"}class Xj{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(te("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(te("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),ko(r)}add(e){return te("SimpleDb","ADD",this.store.name,e,e),ko(this.store.add(e))}get(e){return ko(this.store.get(e)).next(n=>(n===void 0&&(n=null),te("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return te("SimpleDb","DELETE",this.store.name,e),ko(this.store.delete(e))}count(){return te("SimpleDb","COUNT",this.store.name),ko(this.store.count())}U(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const o=i.getAll(r.range);return new W((a,c)=>{o.onerror=h=>{c(h.target.error)},o.onsuccess=h=>{a(h.target.result)}})}{const o=this.cursor(r),a=[];return this.W(o,(c,h)=>{a.push(h)}).next(()=>a)}}G(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new W((i,o)=>{r.onerror=a=>{o(a.target.error)},r.onsuccess=a=>{i(a.target.result)}})}j(e,n){te("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.H=!1;const i=this.cursor(r);return this.W(i,(o,a,c)=>c.delete())}J(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.W(i,n)}Y(e){const n=this.cursor({});return new W((r,i)=>{n.onerror=o=>{const a=g_(o.target.error);i(a)},n.onsuccess=o=>{const a=o.target.result;a?e(a.primaryKey,a.value).next(c=>{c?a.continue():r()}):r()}})}W(e,n){const r=[];return new W((i,o)=>{e.onerror=a=>{o(a.target.error)},e.onsuccess=a=>{const c=a.target.result;if(!c)return void i();const h=new Jj(c),p=n(c.primaryKey,c.value,h);if(p instanceof W){const y=p.catch(v=>(h.done(),W.reject(v)));r.push(y)}h.isDone?i():h.K===null?c.continue():c.continue(h.K)}}).next(()=>W.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function ko(t){return new W((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=g_(r.target.error);n(i)}})}let Wx=!1;function g_(t){const e=Qs.S($t());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new le("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Wx||(Wx=!0,setTimeout(()=>{throw r},0)),r}}return t}class eL{constructor(e,n){this.asyncQueue=e,this.Z=n,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){te("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{te("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(n){lo(n)?te("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):await ao(n)}await this.X(6e4)})}}class tL{constructor(e,n){this.localStore=e,this.persistence=n}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.te(n,e))}te(e,n){const r=new Set;let i=n,o=!0;return W.doWhile(()=>o===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(a=>{if(a!==null&&!r.has(a))return te("IndexBackfiller",`Processing collection: ${a}`),this.ne(e,a,i).next(c=>{i-=c,r.add(a)});o=!1})).next(()=>n-i)}ne(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(o=>{const a=o.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next(()=>this.re(i,o)).next(c=>(te("IndexBackfiller",`Updating offset: ${c}`),this.localStore.indexManager.updateCollectionGroup(e,n,c))).next(()=>a.size)}))}re(e,n){let r=e;return n.changes.forEach((i,o)=>{const a=KI(o);m_(a,r)>0&&(r=a)}),new rr(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Vn.oe=-1;function Jf(t){return t==null}function Nc(t){return t===0&&1/t==-1/0}function JI(t){return typeof t=="number"&&Number.isInteger(t)&&!Nc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function En(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=Gx(e)),e=nL(t.get(n),e);return Gx(e)}function nL(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function Gx(t){return t+""}function li(t){const e=t.length;if(_e(e>=2),e===2)return _e(t.charAt(0)===""&&t.charAt(1)===""),et.emptyPath();const n=e-2,r=[];let i="";for(let o=0;o<e;){const a=t.indexOf("",o);switch((a<0||a>n)&&me(),t.charAt(a+1)){case"":const c=t.substring(o,a);let h;i.length===0?h=c:(i+=c,h=i,i=""),r.push(h);break;case"":i+=t.substring(o,a),i+="\0";break;case"":i+=t.substring(o,a+1);break;default:me()}o=a+2}return new et(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kx=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xh(t,e){return[t,En(e)]}function XI(t,e,n){return[t,En(e),n]}const rL={},iL=["prefixPath","collectionGroup","readTime","documentId"],sL=["prefixPath","collectionGroup","documentId"],oL=["collectionGroup","readTime","prefixPath","documentId"],aL=["canonicalId","targetId"],lL=["targetId","path"],uL=["path","targetId"],cL=["collectionId","parent"],dL=["indexId","uid"],hL=["uid","sequenceNumber"],fL=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],pL=["indexId","uid","orderedDocumentKey"],mL=["userId","collectionPath","documentId"],gL=["userId","collectionPath","largestBatchId"],yL=["userId","collectionGroup","largestBatchId"],ek=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],_L=[...ek,"documentOverlays"],tk=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],nk=tk,y_=[...nk,"indexConfiguration","indexState","indexEntries"],vL=y_,xL=[...y_,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jg extends QI{constructor(e,n){super(),this._e=e,this.currentSequenceNumber=n}}function Ht(t,e){const n=ye(t);return Qs.F(n._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zx(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ua(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function rk(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt{constructor(e,n){this.comparator=e,this.root=n||en.EMPTY}insert(e,n){return new dt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,en.BLACK,null,null))}remove(e){return new dt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,en.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Hd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Hd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Hd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Hd(this.root,e,this.comparator,!0)}}class Hd{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=n?r(e.key,n):1,n&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class en{constructor(e,n,r,i,o){this.key=e,this.value=n,this.color=r??en.RED,this.left=i??en.EMPTY,this.right=o??en.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,o){return new en(e??this.key,n??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,n,r),null):o===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return en.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return en.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,en.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,en.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw me();const e=this.left.check();if(e!==this.right.check())throw me();return e+(this.isRed()?0:1)}}en.EMPTY=null,en.RED=!0,en.BLACK=!1;en.EMPTY=new class{constructor(){this.size=0}get key(){throw me()}get value(){throw me()}get color(){throw me()}get left(){throw me()}get right(){throw me()}copy(e,n,r,i,o){return this}insert(e,n,r){return new en(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{constructor(e){this.comparator=e,this.data=new dt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Qx(this.data.getIterator())}getIteratorFrom(e){return new Qx(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof at)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new at(this.comparator);return n.data=e,n}}class Qx{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Fa(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(e){this.fields=e,e.sort(Tt.comparator)}static empty(){return new Fn([])}unionWith(e){let n=new at(Tt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Fn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return kl(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ik extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new ik("Invalid base64 string: "+o):o}}(e);return new Mt(n)}static fromUint8Array(e){const n=function(i){let o="";for(let a=0;a<i.length;++a)o+=String.fromCharCode(i[a]);return o}(e);return new Mt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ne(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Mt.EMPTY_BYTE_STRING=new Mt("");const wL=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Qi(t){if(_e(!!t),typeof t=="string"){let e=0;const n=wL.exec(t);if(_e(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:mt(t.seconds),nanos:mt(t.nanos)}}function mt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function eo(t){return typeof t=="string"?Mt.fromBase64String(t):Mt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function v_(t){const e=t.mapValue.fields.__previous_value__;return __(e)?v_(e):e}function Cc(t){const e=Qi(t.mapValue.fields.__local_write_time__.timestampValue);return new Ke(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bL{constructor(e,n,r,i,o,a,c,h,p){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=h,this.useFetchStreams=p}}class Ko{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Ko("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Ko&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vs={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},wh={nullValue:"NULL_VALUE"};function Zo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?__(t)?4:sk(t)?9007199254740991:Xf(t)?10:11:me()}function mi(t,e){if(t===e)return!0;const n=Zo(t);if(n!==Zo(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Cc(t).isEqual(Cc(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const a=Qi(i.timestampValue),c=Qi(o.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,o){return eo(i.bytesValue).isEqual(eo(o.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,o){return mt(i.geoPointValue.latitude)===mt(o.geoPointValue.latitude)&&mt(i.geoPointValue.longitude)===mt(o.geoPointValue.longitude)}(t,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return mt(i.integerValue)===mt(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const a=mt(i.doubleValue),c=mt(o.doubleValue);return a===c?Nc(a)===Nc(c):isNaN(a)&&isNaN(c)}return!1}(t,e);case 9:return kl(t.arrayValue.values||[],e.arrayValue.values||[],mi);case 10:case 11:return function(i,o){const a=i.mapValue.fields||{},c=o.mapValue.fields||{};if(Zx(a)!==Zx(c))return!1;for(const h in a)if(a.hasOwnProperty(h)&&(c[h]===void 0||!mi(a[h],c[h])))return!1;return!0}(t,e);default:return me()}}function Rc(t,e){return(t.values||[]).find(n=>mi(n,e))!==void 0}function to(t,e){if(t===e)return 0;const n=Zo(t),r=Zo(e);if(n!==r)return Ne(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ne(t.booleanValue,e.booleanValue);case 2:return function(o,a){const c=mt(o.integerValue||o.doubleValue),h=mt(a.integerValue||a.doubleValue);return c<h?-1:c>h?1:c===h?0:isNaN(c)?isNaN(h)?0:-1:1}(t,e);case 3:return Yx(t.timestampValue,e.timestampValue);case 4:return Yx(Cc(t),Cc(e));case 5:return Ne(t.stringValue,e.stringValue);case 6:return function(o,a){const c=eo(o),h=eo(a);return c.compareTo(h)}(t.bytesValue,e.bytesValue);case 7:return function(o,a){const c=o.split("/"),h=a.split("/");for(let p=0;p<c.length&&p<h.length;p++){const y=Ne(c[p],h[p]);if(y!==0)return y}return Ne(c.length,h.length)}(t.referenceValue,e.referenceValue);case 8:return function(o,a){const c=Ne(mt(o.latitude),mt(a.latitude));return c!==0?c:Ne(mt(o.longitude),mt(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Jx(t.arrayValue,e.arrayValue);case 10:return function(o,a){var c,h,p,y;const v=o.fields||{},w=a.fields||{},S=(c=v.value)===null||c===void 0?void 0:c.arrayValue,N=(h=w.value)===null||h===void 0?void 0:h.arrayValue,A=Ne(((p=S==null?void 0:S.values)===null||p===void 0?void 0:p.length)||0,((y=N==null?void 0:N.values)===null||y===void 0?void 0:y.length)||0);return A!==0?A:Jx(S,N)}(t.mapValue,e.mapValue);case 11:return function(o,a){if(o===Vs.mapValue&&a===Vs.mapValue)return 0;if(o===Vs.mapValue)return 1;if(a===Vs.mapValue)return-1;const c=o.fields||{},h=Object.keys(c),p=a.fields||{},y=Object.keys(p);h.sort(),y.sort();for(let v=0;v<h.length&&v<y.length;++v){const w=Ne(h[v],y[v]);if(w!==0)return w;const S=to(c[h[v]],p[y[v]]);if(S!==0)return S}return Ne(h.length,y.length)}(t.mapValue,e.mapValue);default:throw me()}}function Yx(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ne(t,e);const n=Qi(t),r=Qi(e),i=Ne(n.seconds,r.seconds);return i!==0?i:Ne(n.nanos,r.nanos)}function Jx(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const o=to(n[i],r[i]);if(o)return o}return Ne(n.length,r.length)}function Sl(t){return Lg(t)}function Lg(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Qi(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return eo(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ce.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const o of n.values||[])i?i=!1:r+=",",r+=Lg(o);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",o=!0;for(const a of r)o?o=!1:i+=",",i+=`${a}:${Lg(n.fields[a])}`;return i+"}"}(t.mapValue):me()}function jc(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Dg(t){return!!t&&"integerValue"in t}function Lc(t){return!!t&&"arrayValue"in t}function Xx(t){return!!t&&"nullValue"in t}function ew(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function bh(t){return!!t&&"mapValue"in t}function Xf(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function tc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return ua(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=tc(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=tc(t.arrayValue.values[n]);return e}return Object.assign({},t)}function sk(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const ok={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function EL(t){return"nullValue"in t?wh:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?jc(Ko.empty(),ce.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?Xf(t)?ok:{mapValue:{}}:me()}function TL(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?jc(Ko.empty(),ce.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?ok:"mapValue"in t?Xf(t)?{mapValue:{}}:Vs:me()}function tw(t,e){const n=to(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function nw(t,e){const n=to(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(e){this.value=e}static empty(){return new un({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!bh(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=tc(n)}setAll(e){let n=Tt.emptyPath(),r={},i=[];e.forEach((a,c)=>{if(!n.isImmediateParentOf(c)){const h=this.getFieldsMap(n);this.applyChanges(h,r,i),r={},i=[],n=c.popLast()}a?r[c.lastSegment()]=tc(a):i.push(c.lastSegment())});const o=this.getFieldsMap(n);this.applyChanges(o,r,i)}delete(e){const n=this.field(e.popLast());bh(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return mi(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];bh(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){ua(n,(i,o)=>e[i]=o);for(const i of r)delete e[i]}clone(){return new un(tc(this.value))}}function ak(t){const e=[];return ua(t.fields,(n,r)=>{const i=new Tt([n]);if(bh(r)){const o=ak(r.mapValue).fields;if(o.length===0)e.push(i);else for(const a of o)e.push(i.child(a))}else e.push(i)}),new Fn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nt{constructor(e,n,r,i,o,a,c){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=o,this.data=a,this.documentState=c}static newInvalidDocument(e){return new Nt(e,0,we.min(),we.min(),we.min(),un.empty(),0)}static newFoundDocument(e,n,r,i){return new Nt(e,1,n,we.min(),r,i,0)}static newNoDocument(e,n){return new Nt(e,2,n,we.min(),we.min(),un.empty(),0)}static newUnknownDocument(e,n){return new Nt(e,3,n,we.min(),we.min(),un.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(we.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=un.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=un.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=we.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Nt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Nt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pl{constructor(e,n){this.position=e,this.inclusive=n}}function rw(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const o=e[i],a=t.position[i];if(o.field.isKeyField()?r=ce.comparator(ce.fromName(a.referenceValue),n.key):r=to(a,n.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function iw(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!mi(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dc{constructor(e,n="asc"){this.field=e,this.dir=n}}function IL(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lk{}class qe extends lk{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new kL(e,n,r):n==="array-contains"?new AL(e,r):n==="in"?new pk(e,r):n==="not-in"?new NL(e,r):n==="array-contains-any"?new CL(e,r):new qe(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new SL(e,r):new PL(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(to(n,this.value)):n!==null&&Zo(this.value)===Zo(n)&&this.matchesComparison(to(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return me()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class nt extends lk{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new nt(e,n)}matches(e){return Al(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Al(t){return t.op==="and"}function Mg(t){return t.op==="or"}function x_(t){return uk(t)&&Al(t)}function uk(t){for(const e of t.filters)if(e instanceof nt)return!1;return!0}function Og(t){if(t instanceof qe)return t.field.canonicalString()+t.op.toString()+Sl(t.value);if(x_(t))return t.filters.map(e=>Og(e)).join(",");{const e=t.filters.map(n=>Og(n)).join(",");return`${t.op}(${e})`}}function ck(t,e){return t instanceof qe?function(r,i){return i instanceof qe&&r.op===i.op&&r.field.isEqual(i.field)&&mi(r.value,i.value)}(t,e):t instanceof nt?function(r,i){return i instanceof nt&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,a,c)=>o&&ck(a,i.filters[c]),!0):!1}(t,e):void me()}function dk(t,e){const n=t.filters.concat(e);return nt.create(n,t.op)}function hk(t){return t instanceof qe?function(n){return`${n.field.canonicalString()} ${n.op} ${Sl(n.value)}`}(t):t instanceof nt?function(n){return n.op.toString()+" {"+n.getFilters().map(hk).join(" ,")+"}"}(t):"Filter"}class kL extends qe{constructor(e,n,r){super(e,n,r),this.key=ce.fromName(r.referenceValue)}matches(e){const n=ce.comparator(e.key,this.key);return this.matchesComparison(n)}}class SL extends qe{constructor(e,n){super(e,"in",n),this.keys=fk("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class PL extends qe{constructor(e,n){super(e,"not-in",n),this.keys=fk("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function fk(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>ce.fromName(r.referenceValue))}class AL extends qe{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Lc(n)&&Rc(n.arrayValue,this.value)}}class pk extends qe{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Rc(this.value.arrayValue,n)}}class NL extends qe{constructor(e,n){super(e,"not-in",n)}matches(e){if(Rc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Rc(this.value.arrayValue,n)}}class CL extends qe{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Lc(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Rc(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RL{constructor(e,n=null,r=[],i=[],o=null,a=null,c=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=a,this.endAt=c,this.ue=null}}function Vg(t,e=null,n=[],r=[],i=null,o=null,a=null){return new RL(t,e,n,r,i,o,a)}function Qo(t){const e=ye(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Og(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),Jf(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Sl(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Sl(r)).join(",")),e.ue=n}return e.ue}function Jc(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!IL(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!ck(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!iw(t.startAt,e.startAt)&&iw(t.endAt,e.endAt)}function df(t){return ce.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function hf(t,e){return t.filters.filter(n=>n instanceof qe&&n.field.isEqual(e))}function sw(t,e,n){let r=wh,i=!0;for(const o of hf(t,e)){let a=wh,c=!0;switch(o.op){case"<":case"<=":a=EL(o.value);break;case"==":case"in":case">=":a=o.value;break;case">":a=o.value,c=!1;break;case"!=":case"not-in":a=wh}tw({value:r,inclusive:i},{value:a,inclusive:c})<0&&(r=a,i=c)}if(n!==null){for(let o=0;o<t.orderBy.length;++o)if(t.orderBy[o].field.isEqual(e)){const a=n.position[o];tw({value:r,inclusive:i},{value:a,inclusive:n.inclusive})<0&&(r=a,i=n.inclusive);break}}return{value:r,inclusive:i}}function ow(t,e,n){let r=Vs,i=!0;for(const o of hf(t,e)){let a=Vs,c=!0;switch(o.op){case">=":case">":a=TL(o.value),c=!1;break;case"==":case"in":case"<=":a=o.value;break;case"<":a=o.value,c=!1;break;case"!=":case"not-in":a=Vs}nw({value:r,inclusive:i},{value:a,inclusive:c})>0&&(r=a,i=c)}if(n!==null){for(let o=0;o<t.orderBy.length;++o)if(t.orderBy[o].field.isEqual(e)){const a=n.position[o];nw({value:r,inclusive:i},{value:a,inclusive:n.inclusive})>0&&(r=a,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hl{constructor(e,n=null,r=[],i=[],o=null,a="F",c=null,h=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=a,this.startAt=c,this.endAt=h,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function mk(t,e,n,r,i,o,a,c){return new Hl(t,e,n,r,i,o,a,c)}function Xc(t){return new Hl(t)}function aw(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function gk(t){return t.collectionGroup!==null}function nc(t){const e=ye(t);if(e.ce===null){e.ce=[];const n=new Set;for(const o of e.explicitOrderBy)e.ce.push(o),n.add(o.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new at(Tt.comparator);return a.filters.forEach(h=>{h.getFlattenedFilters().forEach(p=>{p.isInequality()&&(c=c.add(p.field))})}),c})(e).forEach(o=>{n.has(o.canonicalString())||o.isKeyField()||e.ce.push(new Dc(o,r))}),n.has(Tt.keyField().canonicalString())||e.ce.push(new Dc(Tt.keyField(),r))}return e.ce}function Xn(t){const e=ye(t);return e.le||(e.le=jL(e,nc(t))),e.le}function jL(t,e){if(t.limitType==="F")return Vg(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const o=i.dir==="desc"?"asc":"desc";return new Dc(i.field,o)});const n=t.endAt?new Pl(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Pl(t.startAt.position,t.startAt.inclusive):null;return Vg(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Fg(t,e){const n=t.filters.concat([e]);return new Hl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function ff(t,e,n){return new Hl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ep(t,e){return Jc(Xn(t),Xn(e))&&t.limitType===e.limitType}function yk(t){return`${Qo(Xn(t))}|lt:${t.limitType}`}function $a(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>hk(i)).join(", ")}]`),Jf(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Sl(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Sl(i)).join(",")),`Target(${r})`}(Xn(t))}; limitType=${t.limitType})`}function ed(t,e){return e.isFoundDocument()&&function(r,i){const o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):ce.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(t,e)&&function(r,i){for(const o of nc(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const o of r.filters)if(!o.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(a,c,h){const p=rw(a,c,h);return a.inclusive?p<=0:p<0}(r.startAt,nc(r),i)||r.endAt&&!function(a,c,h){const p=rw(a,c,h);return a.inclusive?p>=0:p>0}(r.endAt,nc(r),i))}(t,e)}function _k(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function vk(t){return(e,n)=>{let r=!1;for(const i of nc(t)){const o=LL(i,e,n);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function LL(t,e,n){const r=t.field.isKeyField()?ce.comparator(e.key,n.key):function(o,a,c){const h=a.data.field(o),p=c.data.field(o);return h!==null&&p!==null?to(h,p):me()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return me()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uo{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ua(this.inner,(n,r)=>{for(const[i,o]of r)e(i,o)})}isEmpty(){return rk(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DL=new dt(ce.comparator);function Qn(){return DL}const xk=new dt(ce.comparator);function Uu(...t){let e=xk;for(const n of t)e=e.insert(n.key,n);return e}function wk(t){let e=xk;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function ui(){return rc()}function bk(){return rc()}function rc(){return new uo(t=>t.toString(),(t,e)=>t.isEqual(e))}const ML=new dt(ce.comparator),OL=new at(ce.comparator);function Le(...t){let e=OL;for(const n of t)e=e.add(n);return e}const VL=new at(Ne);function w_(){return VL}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b_(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Nc(e)?"-0":e}}function Ek(t){return{integerValue:""+t}}function FL(t,e){return JI(e)?Ek(e):b_(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tp{constructor(){this._=void 0}}function UL(t,e,n){return t instanceof Nl?function(i,o){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&__(o)&&(o=v_(o)),o&&(a.fields.__previous_value__=o),{mapValue:a}}(n,e):t instanceof Cl?Ik(t,e):t instanceof Yo?kk(t,e):function(i,o){const a=Tk(i,o),c=lw(a)+lw(i.Pe);return Dg(a)&&Dg(i.Pe)?Ek(c):b_(i.serializer,c)}(t,e)}function BL(t,e,n){return t instanceof Cl?Ik(t,e):t instanceof Yo?kk(t,e):n}function Tk(t,e){return t instanceof Mc?function(r){return Dg(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}class Nl extends tp{}class Cl extends tp{constructor(e){super(),this.elements=e}}function Ik(t,e){const n=Sk(e);for(const r of t.elements)n.some(i=>mi(i,r))||n.push(r);return{arrayValue:{values:n}}}class Yo extends tp{constructor(e){super(),this.elements=e}}function kk(t,e){let n=Sk(e);for(const r of t.elements)n=n.filter(i=>!mi(i,r));return{arrayValue:{values:n}}}class Mc extends tp{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function lw(t){return mt(t.integerValue||t.doubleValue)}function Sk(t){return Lc(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E_{constructor(e,n){this.field=e,this.transform=n}}function zL(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Cl&&i instanceof Cl||r instanceof Yo&&i instanceof Yo?kl(r.elements,i.elements,mi):r instanceof Mc&&i instanceof Mc?mi(r.Pe,i.Pe):r instanceof Nl&&i instanceof Nl}(t.transform,e.transform)}class qL{constructor(e,n){this.version=e,this.transformResults=n}}class cn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new cn}static exists(e){return new cn(void 0,e)}static updateTime(e){return new cn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Eh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class np{}function Pk(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new rp(t.key,cn.none()):new Wl(t.key,t.data,cn.none());{const n=t.data,r=un.empty();let i=new at(Tt.comparator);for(let o of e.fields)if(!i.has(o)){let a=n.field(o);a===null&&o.length>1&&(o=o.popLast(),a=n.field(o)),a===null?r.delete(o):r.set(o,a),i=i.add(o)}return new ts(t.key,r,new Fn(i.toArray()),cn.none())}}function $L(t,e,n){t instanceof Wl?function(i,o,a){const c=i.value.clone(),h=cw(i.fieldTransforms,o,a.transformResults);c.setAll(h),o.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,n):t instanceof ts?function(i,o,a){if(!Eh(i.precondition,o))return void o.convertToUnknownDocument(a.version);const c=cw(i.fieldTransforms,o,a.transformResults),h=o.data;h.setAll(Ak(i)),h.setAll(c),o.convertToFoundDocument(a.version,h).setHasCommittedMutations()}(t,e,n):function(i,o,a){o.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function ic(t,e,n,r){return t instanceof Wl?function(o,a,c,h){if(!Eh(o.precondition,a))return c;const p=o.value.clone(),y=dw(o.fieldTransforms,h,a);return p.setAll(y),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),null}(t,e,n,r):t instanceof ts?function(o,a,c,h){if(!Eh(o.precondition,a))return c;const p=dw(o.fieldTransforms,h,a),y=a.data;return y.setAll(Ak(o)),y.setAll(p),a.convertToFoundDocument(a.version,y).setHasLocalMutations(),c===null?null:c.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(v=>v.field))}(t,e,n,r):function(o,a,c){return Eh(o.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c}(t,e,n)}function HL(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),o=Tk(r.transform,i||null);o!=null&&(n===null&&(n=un.empty()),n.set(r.field,o))}return n||null}function uw(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&kl(r,i,(o,a)=>zL(o,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Wl extends np{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ts extends np{constructor(e,n,r,i,o=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function Ak(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function cw(t,e,n){const r=new Map;_e(t.length===n.length);for(let i=0;i<n.length;i++){const o=t[i],a=o.transform,c=e.data.field(o.field);r.set(o.field,BL(a,c,n[i]))}return r}function dw(t,e,n){const r=new Map;for(const i of t){const o=i.transform,a=n.data.field(i.field);r.set(i.field,UL(o,a,e))}return r}class rp extends np{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Nk extends np{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T_{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&$L(o,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=ic(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=ic(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=bk();return this.mutations.forEach(i=>{const o=e.get(i.key),a=o.overlayedDocument;let c=this.applyToLocalView(a,o.mutatedFields);c=n.has(i.key)?null:c;const h=Pk(a,c);h!==null&&r.set(i.key,h),a.isValidDocument()||a.convertToNoDocument(we.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Le())}isEqual(e){return this.batchId===e.batchId&&kl(this.mutations,e.mutations,(n,r)=>uw(n,r))&&kl(this.baseMutations,e.baseMutations,(n,r)=>uw(n,r))}}class I_{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){_e(e.mutations.length===r.length);let i=function(){return ML}();const o=e.mutations;for(let a=0;a<o.length;a++)i=i.insert(o[a].key,r[a].version);return new I_(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k_{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WL{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ft,We;function GL(t){switch(t){default:return me();case J.CANCELLED:case J.UNKNOWN:case J.DEADLINE_EXCEEDED:case J.RESOURCE_EXHAUSTED:case J.INTERNAL:case J.UNAVAILABLE:case J.UNAUTHENTICATED:return!1;case J.INVALID_ARGUMENT:case J.NOT_FOUND:case J.ALREADY_EXISTS:case J.PERMISSION_DENIED:case J.FAILED_PRECONDITION:case J.ABORTED:case J.OUT_OF_RANGE:case J.UNIMPLEMENTED:case J.DATA_LOSS:return!0}}function Ck(t){if(t===void 0)return Dt("GRPC error has no .code"),J.UNKNOWN;switch(t){case Ft.OK:return J.OK;case Ft.CANCELLED:return J.CANCELLED;case Ft.UNKNOWN:return J.UNKNOWN;case Ft.DEADLINE_EXCEEDED:return J.DEADLINE_EXCEEDED;case Ft.RESOURCE_EXHAUSTED:return J.RESOURCE_EXHAUSTED;case Ft.INTERNAL:return J.INTERNAL;case Ft.UNAVAILABLE:return J.UNAVAILABLE;case Ft.UNAUTHENTICATED:return J.UNAUTHENTICATED;case Ft.INVALID_ARGUMENT:return J.INVALID_ARGUMENT;case Ft.NOT_FOUND:return J.NOT_FOUND;case Ft.ALREADY_EXISTS:return J.ALREADY_EXISTS;case Ft.PERMISSION_DENIED:return J.PERMISSION_DENIED;case Ft.FAILED_PRECONDITION:return J.FAILED_PRECONDITION;case Ft.ABORTED:return J.ABORTED;case Ft.OUT_OF_RANGE:return J.OUT_OF_RANGE;case Ft.UNIMPLEMENTED:return J.UNIMPLEMENTED;case Ft.DATA_LOSS:return J.DATA_LOSS;default:return me()}}(We=Ft||(Ft={}))[We.OK=0]="OK",We[We.CANCELLED=1]="CANCELLED",We[We.UNKNOWN=2]="UNKNOWN",We[We.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",We[We.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",We[We.NOT_FOUND=5]="NOT_FOUND",We[We.ALREADY_EXISTS=6]="ALREADY_EXISTS",We[We.PERMISSION_DENIED=7]="PERMISSION_DENIED",We[We.UNAUTHENTICATED=16]="UNAUTHENTICATED",We[We.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",We[We.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",We[We.ABORTED=10]="ABORTED",We[We.OUT_OF_RANGE=11]="OUT_OF_RANGE",We[We.UNIMPLEMENTED=12]="UNIMPLEMENTED",We[We.INTERNAL=13]="INTERNAL",We[We.UNAVAILABLE=14]="UNAVAILABLE",We[We.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KL(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZL=new Oo([4294967295,4294967295],0);function hw(t){const e=KL().encode(t),n=new FI;return n.update(e),new Uint8Array(n.digest())}function fw(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Oo([n,r],0),new Oo([i,o],0)]}class S_{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Bu(`Invalid padding: ${n}`);if(r<0)throw new Bu(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Bu(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Bu(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Oo.fromNumber(this.Ie)}Ee(e,n,r){let i=e.add(n.multiply(Oo.fromNumber(r)));return i.compare(ZL)===1&&(i=new Oo([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=hw(e),[r,i]=fw(n);for(let o=0;o<this.hashCount;o++){const a=this.Ee(r,i,o);if(!this.de(a))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),a=new S_(o,i,n);return r.forEach(c=>a.insert(c)),a}insert(e){if(this.Ie===0)return;const n=hw(e),[r,i]=fw(n);for(let o=0;o<this.hashCount;o++){const a=this.Ee(r,i,o);this.Ae(a)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Bu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td{constructor(e,n,r,i,o){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,nd.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new td(we.min(),i,new dt(Ne),Qn(),Le())}}class nd{constructor(e,n,r,i,o){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new nd(r,n,Le(),Le(),Le())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Th{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}}class Rk{constructor(e,n){this.targetId=e,this.me=n}}class jk{constructor(e,n,r=Mt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class pw{constructor(){this.fe=0,this.ge=gw(),this.pe=Mt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Le(),n=Le(),r=Le();return this.ge.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:me()}}),new nd(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=gw()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,_e(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class QL{constructor(e){this.Le=e,this.Be=new Map,this.ke=Qn(),this.qe=mw(),this.Qe=new dt(Ne)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:me()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.ze(i)&&n(i)})}He(e){const n=e.targetId,r=e.me.count,i=this.Je(n);if(i){const o=i.target;if(df(o))if(r===0){const a=new ce(o.path);this.Ue(n,a,Nt.newNoDocument(a,we.min()))}else _e(r===1);else{const a=this.Ye(n);if(a!==r){const c=this.Ze(e),h=c?this.Xe(c,e,a):1;if(h!==0){this.je(n);const p=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,p)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=n;let a,c;try{a=eo(r).toUint8Array()}catch(h){if(h instanceof ik)return Sc("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{c=new S_(a,i,o)}catch(h){return Sc(h instanceof Bu?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return c.Ie===0?null:c}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(o=>{const a=this.Le.tt(),c=`projects/${a.projectId}/databases/${a.database}/documents/${o.path.canonicalString()}`;e.mightContain(c)||(this.Ue(n,o,null),i++)}),i}rt(e){const n=new Map;this.Be.forEach((o,a)=>{const c=this.Je(a);if(c){if(o.current&&df(c.target)){const h=new ce(c.target.path);this.ke.get(h)!==null||this.it(a,h)||this.Ue(a,h,Nt.newNoDocument(h,e))}o.be&&(n.set(a,o.ve()),o.Ce())}});let r=Le();this.qe.forEach((o,a)=>{let c=!0;a.forEachWhile(h=>{const p=this.Je(h);return!p||p.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(r=r.add(o))}),this.ke.forEach((o,a)=>a.setReadTime(e));const i=new td(e,n,this.Qe,this.ke,r);return this.ke=Qn(),this.qe=mw(),this.Qe=new dt(Ne),i}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,n)?i.Fe(n,1):i.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new pw,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new at(Ne),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||te("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new pw),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function mw(){return new dt(ce.comparator)}function gw(){return new dt(ce.comparator)}const YL={asc:"ASCENDING",desc:"DESCENDING"},JL={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},XL={and:"AND",or:"OR"};class eD{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Ug(t,e){return t.useProto3Json||Jf(e)?e:{value:e}}function Rl(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Lk(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function tD(t,e){return Rl(t,e.toTimestamp())}function Tn(t){return _e(!!t),we.fromTimestamp(function(n){const r=Qi(n);return new Ke(r.seconds,r.nanos)}(t))}function P_(t,e){return Bg(t,e).canonicalString()}function Bg(t,e){const n=function(i){return new et(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function Dk(t){const e=et.fromString(t);return _e($k(e)),e}function pf(t,e){return P_(t.databaseId,e.path)}function Vo(t,e){const n=Dk(e);if(n.get(1)!==t.databaseId.projectId)throw new le(J.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new le(J.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ce(Vk(n))}function Mk(t,e){return P_(t.databaseId,e)}function Ok(t){const e=Dk(t);return e.length===4?et.emptyPath():Vk(e)}function zg(t){return new et(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Vk(t){return _e(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function yw(t,e,n){return{name:pf(t,e),fields:n.value.mapValue.fields}}function nD(t,e,n){const r=Vo(t,e.name),i=Tn(e.updateTime),o=e.createTime?Tn(e.createTime):we.min(),a=new un({mapValue:{fields:e.fields}}),c=Nt.newFoundDocument(r,i,o,a);return n&&c.setHasCommittedMutations(),n?c.setHasCommittedMutations():c}function rD(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:me()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(p,y){return p.useProto3Json?(_e(y===void 0||typeof y=="string"),Mt.fromBase64String(y||"")):(_e(y===void 0||y instanceof Buffer||y instanceof Uint8Array),Mt.fromUint8Array(y||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&function(p){const y=p.code===void 0?J.UNKNOWN:Ck(p.code);return new le(y,p.message||"")}(a);n=new jk(r,i,o,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Vo(t,r.document.name),o=Tn(r.document.updateTime),a=r.document.createTime?Tn(r.document.createTime):we.min(),c=new un({mapValue:{fields:r.document.fields}}),h=Nt.newFoundDocument(i,o,a,c),p=r.targetIds||[],y=r.removedTargetIds||[];n=new Th(p,y,h.key,h)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Vo(t,r.document),o=r.readTime?Tn(r.readTime):we.min(),a=Nt.newNoDocument(i,o),c=r.removedTargetIds||[];n=new Th([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Vo(t,r.document),o=r.removedTargetIds||[];n=new Th([],o,i,null)}else{if(!("filter"in e))return me();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:o}=r,a=new WL(i,o),c=r.targetId;n=new Rk(c,a)}}return n}function mf(t,e){let n;if(e instanceof Wl)n={update:yw(t,e.key,e.value)};else if(e instanceof rp)n={delete:pf(t,e.key)};else if(e instanceof ts)n={update:yw(t,e.key,e.data),updateMask:uD(e.fieldMask)};else{if(!(e instanceof Nk))return me();n={verify:pf(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(o,a){const c=a.transform;if(c instanceof Nl)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Cl)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Yo)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Mc)return{fieldPath:a.field.canonicalString(),increment:c.Pe};throw me()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:tD(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:me()}(t,e.precondition)),n}function qg(t,e){const n=e.currentDocument?function(o){return o.updateTime!==void 0?cn.updateTime(Tn(o.updateTime)):o.exists!==void 0?cn.exists(o.exists):cn.none()}(e.currentDocument):cn.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(a,c){let h=null;if("setToServerValue"in c)_e(c.setToServerValue==="REQUEST_TIME"),h=new Nl;else if("appendMissingElements"in c){const y=c.appendMissingElements.values||[];h=new Cl(y)}else if("removeAllFromArray"in c){const y=c.removeAllFromArray.values||[];h=new Yo(y)}else"increment"in c?h=new Mc(a,c.increment):me();const p=Tt.fromServerFormat(c.fieldPath);return new E_(p,h)}(t,i)):[];if(e.update){e.update.name;const i=Vo(t,e.update.name),o=new un({mapValue:{fields:e.update.fields}});if(e.updateMask){const a=function(h){const p=h.fieldPaths||[];return new Fn(p.map(y=>Tt.fromServerFormat(y)))}(e.updateMask);return new ts(i,o,a,n,r)}return new Wl(i,o,n,r)}if(e.delete){const i=Vo(t,e.delete);return new rp(i,n)}if(e.verify){const i=Vo(t,e.verify);return new Nk(i,n)}return me()}function iD(t,e){return t&&t.length>0?(_e(e!==void 0),t.map(n=>function(i,o){let a=i.updateTime?Tn(i.updateTime):Tn(o);return a.isEqual(we.min())&&(a=Tn(o)),new qL(a,i.transformResults||[])}(n,e))):[]}function Fk(t,e){return{documents:[Mk(t,e.path)]}}function Uk(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Mk(t,i);const o=function(p){if(p.length!==0)return qk(nt.create(p,"and"))}(e.filters);o&&(n.structuredQuery.where=o);const a=function(p){if(p.length!==0)return p.map(y=>function(w){return{field:Ha(w.field),direction:oD(w.dir)}}(y))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);const c=Ug(t,e.limit);return c!==null&&(n.structuredQuery.limit=c),e.startAt&&(n.structuredQuery.startAt=function(p){return{before:p.inclusive,values:p.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(p){return{before:!p.inclusive,values:p.position}}(e.endAt)),{_t:n,parent:i}}function Bk(t){let e=Ok(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){_e(r===1);const y=n.from[0];y.allDescendants?i=y.collectionId:e=e.child(y.collectionId)}let o=[];n.where&&(o=function(v){const w=zk(v);return w instanceof nt&&x_(w)?w.getFilters():[w]}(n.where));let a=[];n.orderBy&&(a=function(v){return v.map(w=>function(N){return new Dc(Wa(N.field),function(U){switch(U){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(N.direction))}(w))}(n.orderBy));let c=null;n.limit&&(c=function(v){let w;return w=typeof v=="object"?v.value:v,Jf(w)?null:w}(n.limit));let h=null;n.startAt&&(h=function(v){const w=!!v.before,S=v.values||[];return new Pl(S,w)}(n.startAt));let p=null;return n.endAt&&(p=function(v){const w=!v.before,S=v.values||[];return new Pl(S,w)}(n.endAt)),mk(e,i,a,o,c,"F",h,p)}function sD(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return me()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function zk(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Wa(n.unaryFilter.field);return qe.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Wa(n.unaryFilter.field);return qe.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Wa(n.unaryFilter.field);return qe.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Wa(n.unaryFilter.field);return qe.create(a,"!=",{nullValue:"NULL_VALUE"});default:return me()}}(t):t.fieldFilter!==void 0?function(n){return qe.create(Wa(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return me()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return nt.create(n.compositeFilter.filters.map(r=>zk(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return me()}}(n.compositeFilter.op))}(t):me()}function oD(t){return YL[t]}function aD(t){return JL[t]}function lD(t){return XL[t]}function Ha(t){return{fieldPath:t.canonicalString()}}function Wa(t){return Tt.fromServerFormat(t.fieldPath)}function qk(t){return t instanceof qe?function(n){if(n.op==="=="){if(ew(n.value))return{unaryFilter:{field:Ha(n.field),op:"IS_NAN"}};if(Xx(n.value))return{unaryFilter:{field:Ha(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(ew(n.value))return{unaryFilter:{field:Ha(n.field),op:"IS_NOT_NAN"}};if(Xx(n.value))return{unaryFilter:{field:Ha(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ha(n.field),op:aD(n.op),value:n.value}}}(t):t instanceof nt?function(n){const r=n.getFilters().map(i=>qk(i));return r.length===1?r[0]:{compositeFilter:{op:lD(n.op),filters:r}}}(t):me()}function uD(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function $k(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vi{constructor(e,n,r,i,o=we.min(),a=we.min(),c=Mt.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=h}withSequenceNumber(e){return new Vi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Vi(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Vi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Vi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hk{constructor(e){this.ct=e}}function cD(t,e){let n;if(e.document)n=nD(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ce.fromSegments(e.noDocument.path),i=Xo(e.noDocument.readTime);n=Nt.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return me();{const r=ce.fromSegments(e.unknownDocument.path),i=Xo(e.unknownDocument.version);n=Nt.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const o=new Ke(i[0],i[1]);return we.fromTimestamp(o)}(e.readTime)),n}function _w(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:gf(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(o,a){return{name:pf(o,a.key),fields:a.data.value.mapValue.fields,updateTime:Rl(o,a.version.toTimestamp()),createTime:Rl(o,a.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Jo(e.version)};else{if(!e.isUnknownDocument())return me();r.unknownDocument={path:n.path.toArray(),version:Jo(e.version)}}return r}function gf(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Jo(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Xo(t){const e=new Ke(t.seconds,t.nanoseconds);return we.fromTimestamp(e)}function So(t,e){const n=(e.baseMutations||[]).map(o=>qg(t.ct,o));for(let o=0;o<e.mutations.length-1;++o){const a=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){const c=e.mutations[o+1];a.updateTransforms=c.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}const r=e.mutations.map(o=>qg(t.ct,o)),i=Ke.fromMillis(e.localWriteTimeMs);return new T_(e.batchId,i,n,r)}function zu(t){const e=Xo(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Xo(t.lastLimboFreeSnapshotVersion):we.min();let r;return r=function(o){return o.documents!==void 0}(t.query)?function(o){return _e(o.documents.length===1),Xn(Xc(Ok(o.documents[0])))}(t.query):function(o){return Xn(Bk(o))}(t.query),new Vi(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Mt.fromBase64String(t.resumeToken))}function Wk(t,e){const n=Jo(e.snapshotVersion),r=Jo(e.lastLimboFreeSnapshotVersion);let i;i=df(e.target)?Fk(t.ct,e.target):Uk(t.ct,e.target)._t;const o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Qo(e.target),readTime:n,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Gk(t){const e=Bk({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?ff(e,e.limit,"L"):e}function gm(t,e){return new k_(e.largestBatchId,qg(t.ct,e.overlayMutation))}function vw(t,e){const n=e.path.lastSegment();return[t,En(e.path.popLast()),n]}function xw(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:Jo(r.readTime),documentKey:En(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dD{getBundleMetadata(e,n){return ww(e).get(n).next(r=>{if(r)return function(o){return{id:o.bundleId,createTime:Xo(o.createTime),version:o.version}}(r)})}saveBundleMetadata(e,n){return ww(e).put(function(i){return{bundleId:i.id,createTime:Jo(Tn(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return bw(e).get(n).next(r=>{if(r)return function(o){return{name:o.name,query:Gk(o.bundledQuery),readTime:Xo(o.readTime)}}(r)})}saveNamedQuery(e,n){return bw(e).put(function(i){return{name:i.name,readTime:Jo(Tn(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function ww(t){return Ht(t,"bundles")}function bw(t){return Ht(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ip{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){const r=n.uid||"";return new ip(e,r)}getOverlay(e,n){return Tu(e).get(vw(this.userId,n)).next(r=>r?gm(this.serializer,r):null)}getOverlays(e,n){const r=ui();return W.forEach(n,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((o,a)=>{const c=new k_(n,a);i.push(this.ht(e,c))}),W.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(a=>i.add(En(a.getCollectionPath())));const o=[];return i.forEach(a=>{const c=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,r+1],!1,!0);o.push(Tu(e).j("collectionPathOverlayIndex",c))}),W.waitFor(o)}getOverlaysForCollection(e,n,r){const i=ui(),o=En(n),a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,Number.POSITIVE_INFINITY],!0);return Tu(e).U("collectionPathOverlayIndex",a).next(c=>{for(const h of c){const p=gm(this.serializer,h);i.set(p.getKey(),p)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const o=ui();let a;const c=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Tu(e).J({index:"collectionGroupOverlayIndex",range:c},(h,p,y)=>{const v=gm(this.serializer,p);o.size()<i||v.largestBatchId===a?(o.set(v.getKey(),v),a=v.largestBatchId):y.done()}).next(()=>o)}ht(e,n){return Tu(e).put(function(i,o,a){const[c,h,p]=vw(o,a.mutation.key);return{userId:o,collectionPath:h,documentId:p,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:mf(i.ct,a.mutation)}}(this.serializer,this.userId,n))}}function Tu(t){return Ht(t,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hD{Pt(e){return Ht(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?Mt.fromUint8Array(r):Mt.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.Pt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po{constructor(){}It(e,n){this.Tt(e,n),n.Et()}Tt(e,n){if("nullValue"in e)this.dt(n,5);else if("booleanValue"in e)this.dt(n,10),n.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(n,15),n.At(mt(e.integerValue));else if("doubleValue"in e){const r=mt(e.doubleValue);isNaN(r)?this.dt(n,13):(this.dt(n,15),Nc(r)?n.At(0):n.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(n,20),typeof r=="string"&&(r=Qi(r)),n.Rt(`${r.seconds||""}`),n.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,n),this.ft(n);else if("bytesValue"in e)this.dt(n,30),n.gt(eo(e.bytesValue)),this.ft(n);else if("referenceValue"in e)this.yt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(n,45),n.At(r.latitude||0),n.At(r.longitude||0)}else"mapValue"in e?sk(e)?this.dt(n,Number.MAX_SAFE_INTEGER):Xf(e)?this.wt(e.mapValue,n):(this.St(e.mapValue,n),this.ft(n)):"arrayValue"in e?(this.bt(e.arrayValue,n),this.ft(n)):me()}Vt(e,n){this.dt(n,25),this.Dt(e,n)}Dt(e,n){n.Rt(e)}St(e,n){const r=e.fields||{};this.dt(n,55);for(const i of Object.keys(r))this.Vt(i,n),this.Tt(r[i],n)}wt(e,n){var r,i;const o=e.fields||{};this.dt(n,53);const a="value",c=((i=(r=o[a].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(n,15),n.At(mt(c)),this.Vt(a,n),this.Tt(o[a],n)}bt(e,n){const r=e.values||[];this.dt(n,50);for(const i of r)this.Tt(i,n)}yt(e,n){this.dt(n,37),ce.fromName(e).path.forEach(r=>{this.dt(n,60),this.Dt(r,n)})}dt(e,n){e.At(n)}ft(e){e.At(2)}}Po.vt=new Po;function fD(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function Ew(t){const e=64-function(r){let i=0;for(let o=0;o<8;++o){const a=fD(255&r[o]);if(i+=a,a!==8)break}return i}(t);return Math.ceil(e/8)}class pD{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ft(r.value),r=n.next();this.Mt()}xt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ot(r.value),r=n.next();this.Nt()}Lt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=n.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const i=n.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){const n=this.qt(e),r=Ew(n);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}Kt(e){const n=this.qt(e),r=Ew(n);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const n=function(o){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,o,!1),new Uint8Array(a.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Ft(e){const n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(n)}Ot(e){const n=255&e;n===0?(this.Gt(0),this.Gt(255)):n===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class mD{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class gD{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class Iu{constructor(){this.jt=new pD,this.Ht=new mD(this.jt),this.Jt=new gD(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Zt(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Ao(this.indexId,this.documentKey,this.arrayValue,r)}}function Ts(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=Tw(t.arrayValue,e.arrayValue),n!==0?n:(n=Tw(t.directionalValue,e.directionalValue),n!==0?n:ce.comparator(t.documentKey,e.documentKey)))}function Tw(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iw{constructor(e){this.Xt=new at((n,r)=>Tt.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const n of e.filters){const r=n;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(_e(e.collectionGroup===this.collectionId),this.nn)return!1;const n=Rg(e);if(n!==void 0&&!this.sn(n))return!1;const r=To(e);let i=new Set,o=0,a=0;for(;o<r.length&&this.sn(r[o]);++o)i=i.add(r[o].fieldPath.canonicalString());if(o===r.length)return!0;if(this.Xt.size>0){const c=this.Xt.getIterator().getNext();if(!i.has(c.field.canonicalString())){const h=r[o];if(!this.on(c,h)||!this._n(this.en[a++],h))return!1}++o}for(;o<r.length;++o){const c=r[o];if(a>=this.en.length||!this._n(this.en[a++],c))return!1}return!0}an(){if(this.nn)return null;let e=new at(Tt.comparator);const n=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new vh(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new vh(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new vh(r.field,r.dir==="asc"?0:1)));return new cf(cf.UNKNOWN_ID,this.collectionId,n,Ac.empty())}sn(e){for(const n of this.tn)if(this.on(n,e))return!0;return!1}on(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}_n(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kk(t){var e,n;if(_e(t instanceof qe||t instanceof nt),t instanceof qe){if(t instanceof pk){const i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(o=>qe.create(t.field,"==",o)))||[];return nt.create(i,"or")}return t}const r=t.filters.map(i=>Kk(i));return nt.create(r,t.op)}function yD(t){if(t.getFilters().length===0)return[];const e=Wg(Kk(t));return _e(Zk(e)),$g(e)||Hg(e)?[e]:e.getFilters()}function $g(t){return t instanceof qe}function Hg(t){return t instanceof nt&&x_(t)}function Zk(t){return $g(t)||Hg(t)||function(n){if(n instanceof nt&&Mg(n)){for(const r of n.getFilters())if(!$g(r)&&!Hg(r))return!1;return!0}return!1}(t)}function Wg(t){if(_e(t instanceof qe||t instanceof nt),t instanceof qe)return t;if(t.filters.length===1)return Wg(t.filters[0]);const e=t.filters.map(r=>Wg(r));let n=nt.create(e,t.op);return n=yf(n),Zk(n)?n:(_e(n instanceof nt),_e(Al(n)),_e(n.filters.length>1),n.filters.reduce((r,i)=>A_(r,i)))}function A_(t,e){let n;return _e(t instanceof qe||t instanceof nt),_e(e instanceof qe||e instanceof nt),n=t instanceof qe?e instanceof qe?function(i,o){return nt.create([i,o],"and")}(t,e):kw(t,e):e instanceof qe?kw(e,t):function(i,o){if(_e(i.filters.length>0&&o.filters.length>0),Al(i)&&Al(o))return dk(i,o.getFilters());const a=Mg(i)?i:o,c=Mg(i)?o:i,h=a.filters.map(p=>A_(p,c));return nt.create(h,"or")}(t,e),yf(n)}function kw(t,e){if(Al(e))return dk(e,t.getFilters());{const n=e.filters.map(r=>A_(t,r));return nt.create(n,"or")}}function yf(t){if(_e(t instanceof qe||t instanceof nt),t instanceof qe)return t;const e=t.getFilters();if(e.length===1)return yf(e[0]);if(uk(t))return t;const n=e.map(i=>yf(i)),r=[];return n.forEach(i=>{i instanceof qe?r.push(i):i instanceof nt&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:nt.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _D{constructor(){this.un=new N_}addToCollectionParentIndex(e,n){return this.un.add(n),W.resolve()}getCollectionParents(e,n){return W.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return W.resolve()}deleteFieldIndex(e,n){return W.resolve()}deleteAllFieldIndexes(e){return W.resolve()}createTargetIndexes(e,n){return W.resolve()}getDocumentsMatchingTarget(e,n){return W.resolve(null)}getIndexType(e,n){return W.resolve(0)}getFieldIndexes(e,n){return W.resolve([])}getNextCollectionGroupToUpdate(e){return W.resolve(null)}getMinOffset(e,n){return W.resolve(rr.min())}getMinOffsetFromCollectionGroup(e,n){return W.resolve(rr.min())}updateCollectionGroup(e,n,r){return W.resolve()}updateIndexEntries(e,n){return W.resolve()}}class N_{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new at(et.comparator),o=!i.has(r);return this.index[n]=i.add(r),o}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new at(et.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wd=new Uint8Array(0);class vD{constructor(e,n){this.databaseId=n,this.cn=new N_,this.ln=new uo(r=>Qo(r),(r,i)=>Jc(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.cn.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.cn.add(n)});const o={collectionId:r,parent:En(i)};return Sw(e).put(o)}return W.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[WI(n),""],!1,!0);return Sw(e).U(i).next(o=>{for(const a of o){if(a.collectionId!==n)break;r.push(li(a.parent))}return r})}addFieldIndex(e,n){const r=ku(e),i=function(c){return{indexId:c.indexId,collectionGroup:c.collectionGroup,fields:c.fields.map(h=>[h.fieldPath.canonicalString(),h.kind])}}(n);delete i.indexId;const o=r.add(i);if(n.indexState){const a=Ba(e);return o.next(c=>{a.put(xw(c,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return o.next()}deleteFieldIndex(e,n){const r=ku(e),i=Ba(e),o=Ua(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>o.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=ku(e),r=Ua(e),i=Ba(e);return n.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,n){return W.forEach(this.hn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const o=new Iw(r).an();if(o!=null)return this.addFieldIndex(e,o)}}))}getDocumentsMatchingTarget(e,n){const r=Ua(e);let i=!0;const o=new Map;return W.forEach(this.hn(n),a=>this.Pn(e,a).next(c=>{i&&(i=!!c),o.set(a,c)})).next(()=>{if(i){let a=Le();const c=[];return W.forEach(o,(h,p)=>{te("IndexedDbIndexManager",`Using index ${function(R){return`id=${R.indexId}|cg=${R.collectionGroup}|f=${R.fields.map(z=>`${z.fieldPath}:${z.kind}`).join(",")}`}(h)} to execute ${Qo(n)}`);const y=function(R,z){const K=Rg(z);if(K===void 0)return null;for(const H of hf(R,K.fieldPath))switch(H.op){case"array-contains-any":return H.value.arrayValue.values||[];case"array-contains":return[H.value]}return null}(p,h),v=function(R,z){const K=new Map;for(const H of To(z))for(const T of hf(R,H.fieldPath))switch(T.op){case"==":case"in":K.set(H.fieldPath.canonicalString(),T.value);break;case"not-in":case"!=":return K.set(H.fieldPath.canonicalString(),T.value),Array.from(K.values())}return null}(p,h),w=function(R,z){const K=[];let H=!0;for(const T of To(z)){const b=T.kind===0?sw(R,T.fieldPath,R.startAt):ow(R,T.fieldPath,R.startAt);K.push(b.value),H&&(H=b.inclusive)}return new Pl(K,H)}(p,h),S=function(R,z){const K=[];let H=!0;for(const T of To(z)){const b=T.kind===0?ow(R,T.fieldPath,R.endAt):sw(R,T.fieldPath,R.endAt);K.push(b.value),H&&(H=b.inclusive)}return new Pl(K,H)}(p,h),N=this.In(h,p,w),A=this.In(h,p,S),U=this.Tn(h,p,v),j=this.En(h.indexId,y,N,w.inclusive,A,S.inclusive,U);return W.forEach(j,k=>r.G(k,n.limit).next(R=>{R.forEach(z=>{const K=ce.fromSegments(z.documentKey);a.has(K)||(a=a.add(K),c.push(K))})}))}).next(()=>c)}return W.resolve(null)})}hn(e){let n=this.ln.get(e);return n||(e.filters.length===0?n=[e]:n=yD(nt.create(e.filters,"and")).map(r=>Vg(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,n),n)}En(e,n,r,i,o,a,c){const h=(n!=null?n.length:1)*Math.max(r.length,o.length),p=h/(n!=null?n.length:1),y=[];for(let v=0;v<h;++v){const w=n?this.dn(n[v/p]):Wd,S=this.An(e,w,r[v%p],i),N=this.Rn(e,w,o[v%p],a),A=c.map(U=>this.An(e,w,U,!0));y.push(...this.createRange(S,N,A))}return y}An(e,n,r,i){const o=new Ao(e,ce.empty(),n,r);return i?o:o.Zt()}Rn(e,n,r,i){const o=new Ao(e,ce.empty(),n,r);return i?o.Zt():o}Pn(e,n){const r=new Iw(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(o=>{let a=null;for(const c of o)r.rn(c)&&(!a||c.fields.length>a.fields.length)&&(a=c);return a})}getIndexType(e,n){let r=2;const i=this.hn(n);return W.forEach(i,o=>this.Pn(e,o).next(a=>{a?r!==0&&a.fields.length<function(h){let p=new at(Tt.comparator),y=!1;for(const v of h.filters)for(const w of v.getFlattenedFilters())w.field.isKeyField()||(w.op==="array-contains"||w.op==="array-contains-any"?y=!0:p=p.add(w.field));for(const v of h.orderBy)v.field.isKeyField()||(p=p.add(v.field));return p.size+(y?1:0)}(o)&&(r=1):r=0})).next(()=>function(a){return a.limit!==null}(n)&&i.length>1&&r===2?1:r)}Vn(e,n){const r=new Iu;for(const i of To(e)){const o=n.data.field(i.fieldPath);if(o==null)return null;const a=r.Yt(i.kind);Po.vt.It(o,a)}return r.zt()}dn(e){const n=new Iu;return Po.vt.It(e,n.Yt(0)),n.zt()}mn(e,n){const r=new Iu;return Po.vt.It(jc(this.databaseId,n),r.Yt(function(o){const a=To(o);return a.length===0?0:a[a.length-1].kind}(e))),r.zt()}Tn(e,n,r){if(r===null)return[];let i=[];i.push(new Iu);let o=0;for(const a of To(e)){const c=r[o++];for(const h of i)if(this.fn(n,a.fieldPath)&&Lc(c))i=this.gn(i,a,c);else{const p=h.Yt(a.kind);Po.vt.It(c,p)}}return this.pn(i)}In(e,n,r){return this.Tn(e,n,r.position)}pn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].zt();return n}gn(e,n,r){const i=[...e],o=[];for(const a of r.arrayValue.values||[])for(const c of i){const h=new Iu;h.seed(c.zt()),Po.vt.It(a,h.Yt(n.kind)),o.push(h)}return o}fn(e,n){return!!e.filters.find(r=>r instanceof qe&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=ku(e),i=Ba(e);return(n?r.U("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.U()).next(o=>{const a=[];return W.forEach(o,c=>i.get([c.indexId,this.uid]).next(h=>{a.push(function(y,v){const w=v?new Ac(v.sequenceNumber,new rr(Xo(v.readTime),new ce(li(v.documentKey)),v.largestBatchId)):Ac.empty(),S=y.fields.map(([N,A])=>new vh(Tt.fromServerFormat(N),A));return new cf(y.indexId,y.collectionGroup,S,w)}(c,h))})).next(()=>a)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const o=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return o!==0?o:Ne(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=ku(e),o=Ba(e);return this.yn(e).next(a=>i.U("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(c=>W.forEach(c,h=>o.put(xw(h.indexId,this.uid,a,r)))))}updateIndexEntries(e,n){const r=new Map;return W.forEach(n,(i,o)=>{const a=r.get(i.collectionGroup);return(a?W.resolve(a):this.getFieldIndexes(e,i.collectionGroup)).next(c=>(r.set(i.collectionGroup,c),W.forEach(c,h=>this.wn(e,i,h).next(p=>{const y=this.Sn(o,h);return p.isEqual(y)?W.resolve():this.bn(e,o,h,p,y)}))))})}Dn(e,n,r,i){return Ua(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(r,n.key),documentKey:n.key.path.toArray()})}vn(e,n,r,i){return Ua(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(r,n.key),n.key.path.toArray()])}wn(e,n,r){const i=Ua(e);let o=new at(Ts);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,n)])},(a,c)=>{o=o.add(new Ao(r.indexId,n,c.arrayValue,c.directionalValue))}).next(()=>o)}Sn(e,n){let r=new at(Ts);const i=this.Vn(n,e);if(i==null)return r;const o=Rg(n);if(o!=null){const a=e.data.field(o.fieldPath);if(Lc(a))for(const c of a.arrayValue.values||[])r=r.add(new Ao(n.indexId,e.key,this.dn(c),i))}else r=r.add(new Ao(n.indexId,e.key,Wd,i));return r}bn(e,n,r,i,o){te("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const a=[];return function(h,p,y,v,w){const S=h.getIterator(),N=p.getIterator();let A=Fa(S),U=Fa(N);for(;A||U;){let j=!1,k=!1;if(A&&U){const R=y(A,U);R<0?k=!0:R>0&&(j=!0)}else A!=null?k=!0:j=!0;j?(v(U),U=Fa(N)):k?(w(A),A=Fa(S)):(A=Fa(S),U=Fa(N))}}(i,o,Ts,c=>{a.push(this.Dn(e,n,r,c))},c=>{a.push(this.vn(e,n,r,c))}),W.waitFor(a)}yn(e){let n=1;return Ba(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,o)=>{o.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((a,c)=>Ts(a,c)).filter((a,c,h)=>!c||Ts(a,h[c-1])!==0);const i=[];i.push(e);for(const a of r){const c=Ts(a,e),h=Ts(a,n);if(c===0)i[0]=e.Zt();else if(c>0&&h<0)i.push(a),i.push(a.Zt());else if(h>0)break}i.push(n);const o=[];for(let a=0;a<i.length;a+=2){if(this.Cn(i[a],i[a+1]))return[];const c=[i[a].indexId,this.uid,i[a].arrayValue,i[a].directionalValue,Wd,[]],h=[i[a+1].indexId,this.uid,i[a+1].arrayValue,i[a+1].directionalValue,Wd,[]];o.push(IDBKeyRange.bound(c,h))}return o}Cn(e,n){return Ts(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(Pw)}getMinOffset(e,n){return W.mapArray(this.hn(n),r=>this.Pn(e,r).next(i=>i||me())).next(Pw)}}function Sw(t){return Ht(t,"collectionParents")}function Ua(t){return Ht(t,"indexEntries")}function ku(t){return Ht(t,"indexConfiguration")}function Ba(t){return Ht(t,"indexState")}function Pw(t){_e(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;m_(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new rr(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Rn{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Rn(e,Rn.DEFAULT_COLLECTION_PERCENTILE,Rn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qk(t,e,n){const r=t.store("mutations"),i=t.store("documentMutations"),o=[],a=IDBKeyRange.only(n.batchId);let c=0;const h=r.J({range:a},(y,v,w)=>(c++,w.delete()));o.push(h.next(()=>{_e(c===1)}));const p=[];for(const y of n.mutations){const v=XI(e,y.key.path,n.batchId);o.push(i.delete(v)),p.push(y.key)}return W.waitFor(o).next(()=>p)}function _f(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw me();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Rn.DEFAULT_COLLECTION_PERCENTILE=10,Rn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Rn.DEFAULT=new Rn(41943040,Rn.DEFAULT_COLLECTION_PERCENTILE,Rn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Rn.DISABLED=new Rn(-1,0,0);class sp{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Fn={}}static lt(e,n,r,i){_e(e.uid!=="");const o=e.isAuthenticated()?e.uid:"";return new sp(o,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Is(e).J({index:"userMutationsIndex",range:r},(i,o,a)=>{n=!1,a.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const o=Ga(e),a=Is(e);return a.add({}).next(c=>{_e(typeof c=="number");const h=new T_(c,n,r,i),p=function(S,N,A){const U=A.baseMutations.map(k=>mf(S.ct,k)),j=A.mutations.map(k=>mf(S.ct,k));return{userId:N,batchId:A.batchId,localWriteTimeMs:A.localWriteTime.toMillis(),baseMutations:U,mutations:j}}(this.serializer,this.userId,h),y=[];let v=new at((w,S)=>Ne(w.canonicalString(),S.canonicalString()));for(const w of i){const S=XI(this.userId,w.key.path,c);v=v.add(w.key.path.popLast()),y.push(a.put(p)),y.push(o.put(S,rL))}return v.forEach(w=>{y.push(this.indexManager.addToCollectionParentIndex(e,w))}),e.addOnCommittedListener(()=>{this.Fn[c]=h.keys()}),W.waitFor(y).next(()=>h)})}lookupMutationBatch(e,n){return Is(e).get(n).next(r=>r?(_e(r.userId===this.userId),So(this.serializer,r)):null)}Mn(e,n){return this.Fn[n]?W.resolve(this.Fn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Fn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let o=null;return Is(e).J({index:"userMutationsIndex",range:i},(a,c,h)=>{c.userId===this.userId&&(_e(c.batchId>=r),o=So(this.serializer,c)),h.done()}).next(()=>o)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Is(e).J({index:"userMutationsIndex",range:n,reverse:!0},(i,o,a)=>{r=o.batchId,a.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Is(e).U("userMutationsIndex",n).next(r=>r.map(i=>So(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=xh(this.userId,n.path),i=IDBKeyRange.lowerBound(r),o=[];return Ga(e).J({range:i},(a,c,h)=>{const[p,y,v]=a,w=li(y);if(p===this.userId&&n.path.isEqual(w))return Is(e).get(v).next(S=>{if(!S)throw me();_e(S.userId===this.userId),o.push(So(this.serializer,S))});h.done()}).next(()=>o)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new at(Ne);const i=[];return n.forEach(o=>{const a=xh(this.userId,o.path),c=IDBKeyRange.lowerBound(a),h=Ga(e).J({range:c},(p,y,v)=>{const[w,S,N]=p,A=li(S);w===this.userId&&o.path.isEqual(A)?r=r.add(N):v.done()});i.push(h)}),W.waitFor(i).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,o=xh(this.userId,r),a=IDBKeyRange.lowerBound(o);let c=new at(Ne);return Ga(e).J({range:a},(h,p,y)=>{const[v,w,S]=h,N=li(w);v===this.userId&&r.isPrefixOf(N)?N.length===i&&(c=c.add(S)):y.done()}).next(()=>this.xn(e,c))}xn(e,n){const r=[],i=[];return n.forEach(o=>{i.push(Is(e).get(o).next(a=>{if(a===null)throw me();_e(a.userId===this.userId),r.push(So(this.serializer,a))}))}),W.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return Qk(e._e,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.On(n.batchId)}),W.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return W.resolve();const r=IDBKeyRange.lowerBound(function(a){return[a]}(this.userId)),i=[];return Ga(e).J({range:r},(o,a,c)=>{if(o[0]===this.userId){const h=li(o[1]);i.push(h)}else c.done()}).next(()=>{_e(i.length===0)})})}containsKey(e,n){return Yk(e,this.userId,n)}Nn(e){return Jk(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function Yk(t,e,n){const r=xh(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r);let a=!1;return Ga(t).J({range:o,H:!0},(c,h,p)=>{const[y,v,w]=c;y===e&&v===i&&(a=!0),p.done()}).next(()=>a)}function Is(t){return Ht(t,"mutations")}function Ga(t){return Ht(t,"documentMutations")}function Jk(t){return Ht(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ea{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new ea(0)}static kn(){return new ea(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xD{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.qn(e).next(n=>{const r=new ea(n.highestTargetId);return n.highestTargetId=r.next(),this.Qn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(n=>we.fromTimestamp(new Ke(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.qn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.Qn(e,i)))}addTargetData(e,n){return this.Kn(e,n).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(n,r),this.Qn(e,r))))}updateTargetData(e,n){return this.Kn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>za(e).delete(n.targetId)).next(()=>this.qn(e)).next(r=>(_e(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,n,r){let i=0;const o=[];return za(e).J((a,c)=>{const h=zu(c);h.sequenceNumber<=n&&r.get(h.targetId)===null&&(i++,o.push(this.removeTargetData(e,h)))}).next(()=>W.waitFor(o)).next(()=>i)}forEachTarget(e,n){return za(e).J((r,i)=>{const o=zu(i);n(o)})}qn(e){return Nw(e).get("targetGlobalKey").next(n=>(_e(n!==null),n))}Qn(e,n){return Nw(e).put("targetGlobalKey",n)}Kn(e,n){return za(e).put(Wk(this.serializer,n))}$n(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=Qo(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let o=null;return za(e).J({range:i,index:"queryTargetsIndex"},(a,c,h)=>{const p=zu(c);Jc(n,p.target)&&(o=p,h.done())}).next(()=>o)}addMatchingKeys(e,n,r){const i=[],o=js(e);return n.forEach(a=>{const c=En(a.path);i.push(o.put({targetId:r,path:c})),i.push(this.referenceDelegate.addReference(e,r,a))}),W.waitFor(i)}removeMatchingKeys(e,n,r){const i=js(e);return W.forEach(n,o=>{const a=En(o.path);return W.waitFor([i.delete([r,a]),this.referenceDelegate.removeReference(e,r,o)])})}removeMatchingKeysForTargetId(e,n){const r=js(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=js(e);let o=Le();return i.J({range:r,H:!0},(a,c,h)=>{const p=li(a[1]),y=new ce(p);o=o.add(y)}).next(()=>o)}containsKey(e,n){const r=En(n.path),i=IDBKeyRange.bound([r],[WI(r)],!1,!0);let o=0;return js(e).J({index:"documentTargetsIndex",H:!0,range:i},([a,c],h,p)=>{a!==0&&(o++,p.done())}).next(()=>o>0)}ot(e,n){return za(e).get(n).next(r=>r?zu(r):null)}}function za(t){return Ht(t,"targets")}function Nw(t){return Ht(t,"targetGlobal")}function js(t){return Ht(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cw([t,e],[n,r]){const i=Ne(t,n);return i===0?Ne(e,r):i}class wD{constructor(e){this.Un=e,this.buffer=new at(Cw),this.Wn=0}Gn(){return++this.Wn}zn(e){const n=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Cw(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class bD{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){te("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){lo(n)?te("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await ao(n)}await this.Hn(3e5)})}}class ED{constructor(e,n){this.Jn=e,this.params=n}calculateTargetCount(e,n){return this.Jn.Yn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return W.resolve(Vn.oe);const r=new wD(n);return this.Jn.forEachTarget(e,i=>r.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>r.zn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(te("LruGarbageCollector","Garbage collection skipped; disabled"),W.resolve(Aw)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(te("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Aw):this.Xn(e,n))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,n){let r,i,o,a,c,h,p;const y=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(v=>(v>this.params.maximumSequenceNumbersToCollect?(te("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),i=this.params.maximumSequenceNumbersToCollect):i=v,a=Date.now(),this.nthSequenceNumber(e,i))).next(v=>(r=v,c=Date.now(),this.removeTargets(e,r,n))).next(v=>(o=v,h=Date.now(),this.removeOrphanedDocuments(e,r))).next(v=>(p=Date.now(),qa()<=Be.DEBUG&&te("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-y}ms
	Determined least recently used ${i} in `+(c-a)+`ms
	Removed ${o} targets in `+(h-c)+`ms
	Removed ${v} documents in `+(p-h)+`ms
Total Duration: ${p-y}ms`),W.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:v})))}}function TD(t,e){return new ED(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ID{constructor(e,n){this.db=e,this.garbageCollector=TD(this,n)}Yn(e){const n=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}er(e){let n=0;return this.Zn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Zn(e,n){return this.tr(e,(r,i)=>n(i))}addReference(e,n,r){return Gd(e,r)}removeReference(e,n,r){return Gd(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Gd(e,n)}nr(e,n){return function(i,o){let a=!1;return Jk(i).Y(c=>Yk(i,c,o).next(h=>(h&&(a=!0),W.resolve(!h)))).next(()=>a)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let o=0;return this.tr(e,(a,c)=>{if(c<=n){const h=this.nr(e,a).next(p=>{if(!p)return o++,r.getEntry(e,a).next(()=>(r.removeEntry(a,we.min()),js(e).delete(function(v){return[0,En(v.path)]}(a))))});i.push(h)}}).next(()=>W.waitFor(i)).next(()=>r.apply(e)).next(()=>o)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Gd(e,n)}tr(e,n){const r=js(e);let i,o=Vn.oe;return r.J({index:"documentTargetsIndex"},([a,c],{path:h,sequenceNumber:p})=>{a===0?(o!==Vn.oe&&n(new ce(li(i)),o),o=p,i=h):o=Vn.oe}).next(()=>{o!==Vn.oe&&n(new ce(li(i)),o)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Gd(t,e){return js(t).put(function(r,i){return{targetId:0,path:En(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xk{constructor(){this.changes=new uo(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Nt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?W.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kD{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return xo(e).put(r)}removeEntry(e,n,r){return xo(e).delete(function(o,a){const c=o.path.toArray();return[c.slice(0,c.length-2),c[c.length-2],gf(a),c[c.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.rr(e,r)))}getEntry(e,n){let r=Nt.newInvalidDocument(n);return xo(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Su(n))},(i,o)=>{r=this.ir(n,o)}).next(()=>r)}sr(e,n){let r={size:0,document:Nt.newInvalidDocument(n)};return xo(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Su(n))},(i,o)=>{r={document:this.ir(n,o),size:_f(o)}}).next(()=>r)}getEntries(e,n){let r=Qn();return this._r(e,n,(i,o)=>{const a=this.ir(i,o);r=r.insert(i,a)}).next(()=>r)}ar(e,n){let r=Qn(),i=new dt(ce.comparator);return this._r(e,n,(o,a)=>{const c=this.ir(o,a);r=r.insert(o,c),i=i.insert(o,_f(a))}).next(()=>({documents:r,ur:i}))}_r(e,n,r){if(n.isEmpty())return W.resolve();let i=new at(Lw);n.forEach(h=>i=i.add(h));const o=IDBKeyRange.bound(Su(i.first()),Su(i.last())),a=i.getIterator();let c=a.getNext();return xo(e).J({index:"documentKeyIndex",range:o},(h,p,y)=>{const v=ce.fromSegments([...p.prefixPath,p.collectionGroup,p.documentId]);for(;c&&Lw(c,v)<0;)r(c,null),c=a.getNext();c&&c.isEqual(v)&&(r(c,p),c=a.hasNext()?a.getNext():null),c?y.$(Su(c)):y.done()}).next(()=>{for(;c;)r(c,null),c=a.hasNext()?a.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,o){const a=n.path,c=[a.popLast().toArray(),a.lastSegment(),gf(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],h=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return xo(e).U(IDBKeyRange.bound(c,h,!0)).next(p=>{o==null||o.incrementDocumentReadCount(p.length);let y=Qn();for(const v of p){const w=this.ir(ce.fromSegments(v.prefixPath.concat(v.collectionGroup,v.documentId)),v);w.isFoundDocument()&&(ed(n,w)||i.has(w.key))&&(y=y.insert(w.key,w))}return y})}getAllFromCollectionGroup(e,n,r,i){let o=Qn();const a=jw(n,r),c=jw(n,rr.max());return xo(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(a,c,!0)},(h,p,y)=>{const v=this.ir(ce.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);o=o.insert(v.key,v),o.size===i&&y.done()}).next(()=>o)}newChangeBuffer(e){return new SD(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return Rw(e).get("remoteDocumentGlobalKey").next(n=>(_e(!!n),n))}rr(e,n){return Rw(e).put("remoteDocumentGlobalKey",n)}ir(e,n){if(n){const r=cD(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(we.min())))return r}return Nt.newInvalidDocument(e)}}function eS(t){return new kD(t)}class SD extends Xk{constructor(e,n){super(),this.cr=e,this.trackRemovals=n,this.lr=new uo(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new at((o,a)=>Ne(o.canonicalString(),a.canonicalString()));return this.changes.forEach((o,a)=>{const c=this.lr.get(o);if(n.push(this.cr.removeEntry(e,o,c.readTime)),a.isValidDocument()){const h=_w(this.cr.serializer,a);i=i.add(o.path.popLast());const p=_f(h);r+=p-c.size,n.push(this.cr.addEntry(e,o,h))}else if(r-=c.size,this.trackRemovals){const h=_w(this.cr.serializer,a.convertToNoDocument(we.min()));n.push(this.cr.addEntry(e,o,h))}}),i.forEach(o=>{n.push(this.cr.indexManager.addToCollectionParentIndex(e,o))}),n.push(this.cr.updateMetadata(e,r)),W.waitFor(n)}getFromCache(e,n){return this.cr.sr(e,n).next(r=>(this.lr.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.cr.ar(e,n).next(({documents:r,ur:i})=>(i.forEach((o,a)=>{this.lr.set(o,{size:a,readTime:r.get(o).readTime})}),r))}}function Rw(t){return Ht(t,"remoteDocumentGlobal")}function xo(t){return Ht(t,"remoteDocumentsV14")}function Su(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function jw(t,e){const n=e.documentKey.path.toArray();return[t,gf(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function Lw(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let o=0;o<n.length-2&&o<r.length-2;++o)if(i=Ne(n[o],r[o]),i)return i;return i=Ne(n.length,r.length),i||(i=Ne(n[n.length-2],r[r.length-2]),i||Ne(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PD{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tS{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&ic(r.mutation,i,Fn.empty(),Ke.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Le()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Le()){const i=ui();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(o=>{let a=Uu();return o.forEach((c,h)=>{a=a.insert(c,h.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const r=ui();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Le()))}populateOverlays(e,n,r){const i=[];return r.forEach(o=>{n.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((a,c)=>{n.set(a,c)})})}computeViews(e,n,r,i){let o=Qn();const a=rc(),c=function(){return rc()}();return n.forEach((h,p)=>{const y=r.get(p.key);i.has(p.key)&&(y===void 0||y.mutation instanceof ts)?o=o.insert(p.key,p):y!==void 0?(a.set(p.key,y.mutation.getFieldMask()),ic(y.mutation,p,y.mutation.getFieldMask(),Ke.now())):a.set(p.key,Fn.empty())}),this.recalculateAndSaveOverlays(e,o).next(h=>(h.forEach((p,y)=>a.set(p,y)),n.forEach((p,y)=>{var v;return c.set(p,new PD(y,(v=a.get(p))!==null&&v!==void 0?v:null))}),c))}recalculateAndSaveOverlays(e,n){const r=rc();let i=new dt((a,c)=>a-c),o=Le();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const c of a)c.keys().forEach(h=>{const p=n.get(h);if(p===null)return;let y=r.get(h)||Fn.empty();y=c.applyToLocalView(p,y),r.set(h,y);const v=(i.get(c.batchId)||Le()).add(h);i=i.insert(c.batchId,v)})}).next(()=>{const a=[],c=i.getReverseIterator();for(;c.hasNext();){const h=c.getNext(),p=h.key,y=h.value,v=bk();y.forEach(w=>{if(!o.has(w)){const S=Pk(n.get(w),r.get(w));S!==null&&v.set(w,S),o=o.add(w)}}),a.push(this.documentOverlayCache.saveOverlays(e,p,v))}return W.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(a){return ce.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):gk(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(o=>{const a=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-o.size):W.resolve(ui());let c=-1,h=o;return a.next(p=>W.forEach(p,(y,v)=>(c<v.largestBatchId&&(c=v.largestBatchId),o.get(y)?W.resolve():this.remoteDocumentCache.getEntry(e,y).next(w=>{h=h.insert(y,w)}))).next(()=>this.populateOverlays(e,p,o)).next(()=>this.computeViews(e,h,p,Le())).next(y=>({batchId:c,changes:wk(y)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ce(n)).next(r=>{let i=Uu();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const o=n.collectionGroup;let a=Uu();return this.indexManager.getCollectionParents(e,o).next(c=>W.forEach(c,h=>{const p=function(v,w){return new Hl(w,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)}(n,h.child(o));return this.getDocumentsMatchingCollectionQuery(e,p,r,i).next(y=>{y.forEach((v,w)=>{a=a.insert(v,w)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,o,i))).next(a=>{o.forEach((h,p)=>{const y=p.getKey();a.get(y)===null&&(a=a.insert(y,Nt.newInvalidDocument(y)))});let c=Uu();return a.forEach((h,p)=>{const y=o.get(h);y!==void 0&&ic(y.mutation,p,Fn.empty(),Ke.now()),ed(n,p)&&(c=c.insert(h,p))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AD{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return W.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Tn(i.createTime)}}(n)),W.resolve()}getNamedQuery(e,n){return W.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(i){return{name:i.name,query:Gk(i.bundledQuery),readTime:Tn(i.readTime)}}(n)),W.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ND{constructor(){this.overlays=new dt(ce.comparator),this.Ir=new Map}getOverlay(e,n){return W.resolve(this.overlays.get(n))}getOverlays(e,n){const r=ui();return W.forEach(n,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,o)=>{this.ht(e,n,o)}),W.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.Ir.delete(r)),W.resolve()}getOverlaysForCollection(e,n,r){const i=ui(),o=n.length+1,a=new ce(n.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){const h=c.getNext().value,p=h.getKey();if(!n.isPrefixOf(p.path))break;p.path.length===o&&h.largestBatchId>r&&i.set(h.getKey(),h)}return W.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let o=new dt((p,y)=>p-y);const a=this.overlays.getIterator();for(;a.hasNext();){const p=a.getNext().value;if(p.getKey().getCollectionGroup()===n&&p.largestBatchId>r){let y=o.get(p.largestBatchId);y===null&&(y=ui(),o=o.insert(p.largestBatchId,y)),y.set(p.getKey(),p)}}const c=ui(),h=o.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((p,y)=>c.set(p,y)),!(c.size()>=i)););return W.resolve(c)}ht(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const a=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new k_(n,r));let o=this.Ir.get(n);o===void 0&&(o=Le(),this.Ir.set(n,o)),this.Ir.set(n,o.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CD{constructor(){this.sessionToken=Mt.EMPTY_BYTE_STRING}getSessionToken(e){return W.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,W.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C_{constructor(){this.Tr=new at(Zt.Er),this.dr=new at(Zt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new Zt(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new Zt(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new ce(new et([])),r=new Zt(n,e),i=new Zt(n,e+1),o=[];return this.dr.forEachInRange([r,i],a=>{this.Vr(a),o.push(a.key)}),o}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new ce(new et([])),r=new Zt(n,e),i=new Zt(n,e+1);let o=Le();return this.dr.forEachInRange([r,i],a=>{o=o.add(a.key)}),o}containsKey(e){const n=new Zt(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Zt{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return ce.comparator(e.key,n.key)||Ne(e.wr,n.wr)}static Ar(e,n){return Ne(e.wr,n.wr)||ce.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RD{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new at(Zt.Er)}checkEmpty(e){return W.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const o=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new T_(o,n,r,i);this.mutationQueue.push(a);for(const c of i)this.br=this.br.add(new Zt(c.key,o)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return W.resolve(a)}lookupMutationBatch(e,n){return W.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.vr(r),o=i<0?0:i;return W.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return W.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return W.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Zt(n,0),i=new Zt(n,Number.POSITIVE_INFINITY),o=[];return this.br.forEachInRange([r,i],a=>{const c=this.Dr(a.wr);o.push(c)}),W.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new at(Ne);return n.forEach(i=>{const o=new Zt(i,0),a=new Zt(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([o,a],c=>{r=r.add(c.wr)})}),W.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let o=r;ce.isDocumentKey(o)||(o=o.child(""));const a=new Zt(new ce(o),0);let c=new at(Ne);return this.br.forEachWhile(h=>{const p=h.key.path;return!!r.isPrefixOf(p)&&(p.length===i&&(c=c.add(h.wr)),!0)},a),W.resolve(this.Cr(c))}Cr(e){const n=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){_e(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return W.forEach(n.mutations,i=>{const o=new Zt(i.key,n.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new Zt(n,0),i=this.br.firstAfterOrEqual(r);return W.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,W.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jD{constructor(e){this.Mr=e,this.docs=function(){return new dt(ce.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),o=i?i.size:0,a=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return W.resolve(r?r.document.mutableCopy():Nt.newInvalidDocument(n))}getEntries(e,n){let r=Qn();return n.forEach(i=>{const o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():Nt.newInvalidDocument(i))}),W.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let o=Qn();const a=n.path,c=new ce(a.child("")),h=this.docs.getIteratorFrom(c);for(;h.hasNext();){const{key:p,value:{document:y}}=h.getNext();if(!a.isPrefixOf(p.path))break;p.path.length>a.length+1||m_(KI(y),r)<=0||(i.has(y.key)||ed(n,y))&&(o=o.insert(y.key,y.mutableCopy()))}return W.resolve(o)}getAllFromCollectionGroup(e,n,r,i){me()}Or(e,n){return W.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new LD(this)}getSize(e){return W.resolve(this.size)}}class LD extends Xk{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),W.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DD{constructor(e){this.persistence=e,this.Nr=new uo(n=>Qo(n),Jc),this.lastRemoteSnapshotVersion=we.min(),this.highestTargetId=0,this.Lr=0,this.Br=new C_,this.targetCount=0,this.kr=ea.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,i)=>n(i)),W.resolve()}getLastRemoteSnapshotVersion(e){return W.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return W.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),W.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),W.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new ea(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,W.resolve()}updateTargetData(e,n){return this.Kn(n),W.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,W.resolve()}removeTargets(e,n,r){let i=0;const o=[];return this.Nr.forEach((a,c)=>{c.sequenceNumber<=n&&r.get(c.targetId)===null&&(this.Nr.delete(a),o.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)}),W.waitFor(o).next(()=>i)}getTargetCount(e){return W.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return W.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),W.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const i=this.persistence.referenceDelegate,o=[];return i&&n.forEach(a=>{o.push(i.markPotentiallyOrphaned(e,a))}),W.waitFor(o)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),W.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return W.resolve(r)}containsKey(e,n){return W.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nS{constructor(e,n){this.qr={},this.overlays={},this.Qr=new Vn(0),this.Kr=!1,this.Kr=!0,this.$r=new CD,this.referenceDelegate=e(this),this.Ur=new DD(this),this.indexManager=new _D,this.remoteDocumentCache=function(i){return new jD(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new Hk(n),this.Gr=new AD(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new ND,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new RD(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){te("MemoryPersistence","Starting transaction:",e);const i=new MD(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(o=>this.referenceDelegate.jr(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Hr(e,n){return W.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class MD extends QI{constructor(e){super(),this.currentSequenceNumber=e}}class op{constructor(e){this.persistence=e,this.Jr=new C_,this.Yr=null}static Zr(e){return new op(e)}get Xr(){if(this.Yr)return this.Yr;throw me()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),W.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),W.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),W.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(o=>this.Xr.add(o.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return W.forEach(this.Xr,r=>{const i=ce.fromPath(r);return this.ei(e,i).next(o=>{o||n.removeEntry(i,we.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return W.or([()=>W.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OD{constructor(e){this.serializer=e}O(e,n,r,i){const o=new Yf("createOrUpgrade",n);r<1&&i>=1&&(function(h){h.createObjectStore("owner")}(e),function(h){h.createObjectStore("mutationQueues",{keyPath:"userId"}),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Kx,{unique:!0}),h.createObjectStore("documentMutations")}(e),Dw(e),function(h){h.createObjectStore("remoteDocuments")}(e));let a=W.resolve();return r<3&&i>=3&&(r!==0&&(function(h){h.deleteObjectStore("targetDocuments"),h.deleteObjectStore("targets"),h.deleteObjectStore("targetGlobal")}(e),Dw(e)),a=a.next(()=>function(h){const p=h.store("targetGlobal"),y={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:we.min().toTimestamp(),targetCount:0};return p.put("targetGlobalKey",y)}(o))),r<4&&i>=4&&(r!==0&&(a=a.next(()=>function(h,p){return p.store("mutations").U().next(y=>{h.deleteObjectStore("mutations"),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Kx,{unique:!0});const v=p.store("mutations"),w=y.map(S=>v.put(S));return W.waitFor(w)})}(e,o))),a=a.next(()=>{(function(h){h.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(a=a.next(()=>this.ni(o))),r<6&&i>=6&&(a=a.next(()=>(function(h){h.createObjectStore("remoteDocumentGlobal")}(e),this.ri(o)))),r<7&&i>=7&&(a=a.next(()=>this.ii(o))),r<8&&i>=8&&(a=a.next(()=>this.si(e,o))),r<9&&i>=9&&(a=a.next(()=>{(function(h){h.objectStoreNames.contains("remoteDocumentChanges")&&h.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(a=a.next(()=>this.oi(o))),r<11&&i>=11&&(a=a.next(()=>{(function(h){h.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(h){h.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(a=a.next(()=>{(function(h){const p=h.createObjectStore("documentOverlays",{keyPath:mL});p.createIndex("collectionPathOverlayIndex",gL,{unique:!1}),p.createIndex("collectionGroupOverlayIndex",yL,{unique:!1})})(e)})),r<13&&i>=13&&(a=a.next(()=>function(h){const p=h.createObjectStore("remoteDocumentsV14",{keyPath:iL});p.createIndex("documentKeyIndex",sL),p.createIndex("collectionGroupIndex",oL)}(e)).next(()=>this._i(e,o)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(a=a.next(()=>this.ai(e,o))),r<15&&i>=15&&(a=a.next(()=>function(h){h.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),h.createObjectStore("indexState",{keyPath:dL}).createIndex("sequenceNumberIndex",hL,{unique:!1}),h.createObjectStore("indexEntries",{keyPath:fL}).createIndex("documentKeyIndex",pL,{unique:!1})}(e))),r<16&&i>=16&&(a=a.next(()=>{n.objectStore("indexState").clear()}).next(()=>{n.objectStore("indexEntries").clear()})),r<17&&i>=17&&(a=a.next(()=>{(function(h){h.createObjectStore("globals",{keyPath:"name"})})(e)})),a}ri(e){let n=0;return e.store("remoteDocuments").J((r,i)=>{n+=_f(i)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.U().next(i=>W.forEach(i,o=>{const a=IDBKeyRange.bound([o.userId,-1],[o.userId,o.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",a).next(c=>W.forEach(c,h=>{_e(h.userId===o.userId);const p=So(this.serializer,h);return Qk(e,o.userId,p).next(()=>{})}))}))}ii(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const o=[];return r.J((a,c)=>{const h=new et(a),p=function(v){return[0,En(v)]}(h);o.push(n.get(p).next(y=>y?W.resolve():(v=>n.put({targetId:0,path:En(v),sequenceNumber:i.highestListenSequenceNumber}))(h)))}).next(()=>W.waitFor(o))})}si(e,n){e.createObjectStore("collectionParents",{keyPath:cL});const r=n.store("collectionParents"),i=new N_,o=a=>{if(i.add(a)){const c=a.lastSegment(),h=a.popLast();return r.put({collectionId:c,parent:En(h)})}};return n.store("remoteDocuments").J({H:!0},(a,c)=>{const h=new et(a);return o(h.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([a,c,h],p)=>{const y=li(c);return o(y.popLast())}))}oi(e){const n=e.store("targets");return n.J((r,i)=>{const o=zu(i),a=Wk(this.serializer,o);return n.put(a)})}_i(e,n){const r=n.store("remoteDocuments"),i=[];return r.J((o,a)=>{const c=n.store("remoteDocumentsV14"),h=function(v){return v.document?new ce(et.fromString(v.document.name).popFirst(5)):v.noDocument?ce.fromSegments(v.noDocument.path):v.unknownDocument?ce.fromSegments(v.unknownDocument.path):me()}(a).path.toArray(),p={prefixPath:h.slice(0,h.length-2),collectionGroup:h[h.length-2],documentId:h[h.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};i.push(c.put(p))}).next(()=>W.waitFor(i))}ai(e,n){const r=n.store("mutations"),i=eS(this.serializer),o=new nS(op.Zr,this.serializer.ct);return r.U().next(a=>{const c=new Map;return a.forEach(h=>{var p;let y=(p=c.get(h.userId))!==null&&p!==void 0?p:Le();So(this.serializer,h).keys().forEach(v=>y=y.add(v)),c.set(h.userId,y)}),W.forEach(c,(h,p)=>{const y=new an(p),v=ip.lt(this.serializer,y),w=o.getIndexManager(y),S=sp.lt(y,this.serializer,w,o.referenceDelegate);return new tS(i,S,v,w).recalculateAndSaveOverlaysForDocumentKeys(new jg(n,Vn.oe),h).next()})})}}function Dw(t){t.createObjectStore("targetDocuments",{keyPath:lL}).createIndex("documentTargetsIndex",uL,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",aL,{unique:!0}),t.createObjectStore("targetGlobal")}const ym="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class R_{constructor(e,n,r,i,o,a,c,h,p,y,v=17){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.ui=o,this.window=a,this.document=c,this.ci=p,this.li=y,this.hi=v,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=w=>Promise.resolve(),!R_.D())throw new le(J.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new ID(this,i),this.Ai=n+"main",this.serializer=new Hk(h),this.Ri=new Qs(this.Ai,this.hi,new OD(this.serializer)),this.$r=new hD,this.Ur=new xD(this.referenceDelegate,this.serializer),this.remoteDocumentCache=eS(this.serializer),this.Gr=new dD,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,y===!1&&Dt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new le(J.FAILED_PRECONDITION,ym);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new Vn(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Kd(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(n=>{n||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(n=>this.isPrimary&&!n?this.bi(e).next(()=>!1):!!n&&this.Di(e).next(()=>!0))).catch(e=>{if(lo(e))return te("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return te("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return Pu(e).get("owner").next(n=>W.resolve(this.vi(n)))}Ci(e){return Kd(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Ht(n,"clientMetadata");return r.U().next(i=>{const o=this.xi(i,18e5),a=i.filter(c=>o.indexOf(c)===-1);return W.forEach(a,c=>r.delete(c.clientId)).next(()=>a)})}).catch(()=>[]);if(this.Vi)for(const n of e)this.Vi.removeItem(this.Oi(n.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?W.resolve(!0):Pu(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)){if(this.vi(n)&&this.networkEnabled)return!0;if(!this.vi(n)){if(!n.allowTabSynchronization)throw new le(J.FAILED_PRECONDITION,ym);return!1}}return!(!this.networkEnabled||!this.inForeground)||Kd(e).U().next(r=>this.xi(r,5e3).find(i=>{if(this.clientId!==i.clientId){const o=!this.networkEnabled&&i.networkEnabled,a=!this.inForeground&&i.inForeground,c=this.networkEnabled===i.networkEnabled;if(o||a&&c)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&te("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new jg(e,Vn.oe);return this.bi(n).next(()=>this.Ci(n))}),this.Ri.close(),this.qi()}xi(e,n){return e.filter(r=>this.Mi(r.updateTimeMs,n)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>Kd(e).U().next(n=>this.xi(n,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,n){return sp.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new vD(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return ip.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,n,r){te("IndexedDbPersistence","Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",o=function(h){return h===17?xL:h===16?vL:h===15?y_:h===14?nk:h===13?tk:h===12?_L:h===11?ek:void me()}(this.hi);let a;return this.Ri.runTransaction(e,i,o,c=>(a=new jg(c,this.Qr?this.Qr.next():Vn.oe),n==="readwrite-primary"?this.wi(a).next(h=>!!h||this.Si(a)).next(h=>{if(!h)throw Dt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new le(J.FAILED_PRECONDITION,ZI);return r(a)}).next(h=>this.Di(a).next(()=>h)):this.Ki(a).next(()=>r(a)))).then(c=>(a.raiseOnCommittedEvent(),c))}Ki(e){return Pu(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)&&!this.vi(n)&&!(this.li||this.allowTabSynchronization&&n.allowTabSynchronization))throw new le(J.FAILED_PRECONDITION,ym)})}Di(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Pu(e).put("owner",n)}static D(){return Qs.D()}bi(e){const n=Pu(e);return n.get("owner").next(r=>this.vi(r)?(te("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):W.resolve())}Mi(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(Dt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const n=/(?:Version|Mobile)\/1[456]/;ZT()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var n;try{const r=((n=this.Vi)===null||n===void 0?void 0:n.getItem(this.Oi(e)))!==null;return te("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Dt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){Dt("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Pu(t){return Ht(t,"owner")}function Kd(t){return Ht(t,"clientMetadata")}function rS(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j_{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=i}static Wi(e,n){let r=Le(),i=Le();for(const o of n.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new j_(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VD{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iS{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return ZT()?8:YI($t())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,i){const o={result:null};return this.Yi(e,n).next(a=>{o.result=a}).next(()=>{if(!o.result)return this.Zi(e,n,i,r).next(a=>{o.result=a})}).next(()=>{if(o.result)return;const a=new VD;return this.Xi(e,n,a).next(c=>{if(o.result=c,this.zi)return this.es(e,n,a,c.size)})}).next(()=>o.result)}es(e,n,r,i){return r.documentReadCount<this.ji?(qa()<=Be.DEBUG&&te("QueryEngine","SDK will not create cache indexes for query:",$a(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),W.resolve()):(qa()<=Be.DEBUG&&te("QueryEngine","Query:",$a(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(qa()<=Be.DEBUG&&te("QueryEngine","The SDK decides to create cache indexes for query:",$a(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Xn(n))):W.resolve())}Yi(e,n){if(aw(n))return W.resolve(null);let r=Xn(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=ff(n,null,"F"),r=Xn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{const a=Le(...o);return this.Ji.getDocuments(e,a).next(c=>this.indexManager.getMinOffset(e,r).next(h=>{const p=this.ts(n,c);return this.ns(n,p,a,h.readTime)?this.Yi(e,ff(n,null,"F")):this.rs(e,p,n,h)}))})))}Zi(e,n,r,i){return aw(n)||i.isEqual(we.min())?W.resolve(null):this.Ji.getDocuments(e,r).next(o=>{const a=this.ts(n,o);return this.ns(n,a,r,i)?W.resolve(null):(qa()<=Be.DEBUG&&te("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),$a(n)),this.rs(e,a,n,GI(i,-1)).next(c=>c))})}ts(e,n){let r=new at(vk(e));return n.forEach((i,o)=>{ed(e,o)&&(r=r.add(o))}),r}ns(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const o=e.limitType==="F"?n.last():n.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Xi(e,n,r){return qa()<=Be.DEBUG&&te("QueryEngine","Using full collection scan to execute query:",$a(n)),this.Ji.getDocumentsMatchingQuery(e,n,rr.min(),r)}rs(e,n,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(o=>(n.forEach(a=>{o=o.insert(a.key,a)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FD{constructor(e,n,r,i){this.persistence=e,this.ss=n,this.serializer=i,this.os=new dt(Ne),this._s=new uo(o=>Qo(o),Jc),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new tS(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function sS(t,e,n,r){return new FD(t,e,n,r)}async function oS(t,e){const n=ye(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(o=>{const a=[],c=[];let h=Le();for(const p of i){a.push(p.batchId);for(const y of p.mutations)h=h.add(y.key)}for(const p of o){c.push(p.batchId);for(const y of p.mutations)h=h.add(y.key)}return n.localDocuments.getDocuments(r,h).next(p=>({hs:p,removedBatchIds:a,addedBatchIds:c}))})})}function UD(t,e){const n=ye(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),o=n.cs.newChangeBuffer({trackRemovals:!0});return function(c,h,p,y){const v=p.batch,w=v.keys();let S=W.resolve();return w.forEach(N=>{S=S.next(()=>y.getEntry(h,N)).next(A=>{const U=p.docVersions.get(N);_e(U!==null),A.version.compareTo(U)<0&&(v.applyToRemoteDocument(A,p),A.isValidDocument()&&(A.setReadTime(p.commitVersion),y.addEntry(A)))})}),S.next(()=>c.mutationQueue.removeMutationBatch(h,v))}(n,r,e,o).next(()=>o.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(c){let h=Le();for(let p=0;p<c.mutationResults.length;++p)c.mutationResults[p].transformResults.length>0&&(h=h.add(c.batch.mutations[p].key));return h}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function aS(t){const e=ye(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function BD(t,e){const n=ye(t),r=e.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const a=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const c=[];e.targetChanges.forEach((y,v)=>{const w=i.get(v);if(!w)return;c.push(n.Ur.removeMatchingKeys(o,y.removedDocuments,v).next(()=>n.Ur.addMatchingKeys(o,y.addedDocuments,v)));let S=w.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(v)!==null?S=S.withResumeToken(Mt.EMPTY_BYTE_STRING,we.min()).withLastLimboFreeSnapshotVersion(we.min()):y.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(y.resumeToken,r)),i=i.insert(v,S),function(A,U,j){return A.resumeToken.approximateByteSize()===0||U.snapshotVersion.toMicroseconds()-A.snapshotVersion.toMicroseconds()>=3e8?!0:j.addedDocuments.size+j.modifiedDocuments.size+j.removedDocuments.size>0}(w,S,y)&&c.push(n.Ur.updateTargetData(o,S))});let h=Qn(),p=Le();if(e.documentUpdates.forEach(y=>{e.resolvedLimboDocuments.has(y)&&c.push(n.persistence.referenceDelegate.updateLimboDocument(o,y))}),c.push(zD(o,a,e.documentUpdates).next(y=>{h=y.Ps,p=y.Is})),!r.isEqual(we.min())){const y=n.Ur.getLastRemoteSnapshotVersion(o).next(v=>n.Ur.setTargetsMetadata(o,o.currentSequenceNumber,r));c.push(y)}return W.waitFor(c).next(()=>a.apply(o)).next(()=>n.localDocuments.getLocalViewOfDocuments(o,h,p)).next(()=>h)}).then(o=>(n.os=i,o))}function zD(t,e,n){let r=Le(),i=Le();return n.forEach(o=>r=r.add(o)),e.getEntries(t,r).next(o=>{let a=Qn();return n.forEach((c,h)=>{const p=o.get(c);h.isFoundDocument()!==p.isFoundDocument()&&(i=i.add(c)),h.isNoDocument()&&h.version.isEqual(we.min())?(e.removeEntry(c,h.readTime),a=a.insert(c,h)):!p.isValidDocument()||h.version.compareTo(p.version)>0||h.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(h),a=a.insert(c,h)):te("LocalStore","Ignoring outdated watch update for ",c,". Current version:",p.version," Watch version:",h.version)}),{Ps:a,Is:i}})}function qD(t,e){const n=ye(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function vf(t,e){const n=ye(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Ur.getTargetData(r,e).next(o=>o?(i=o,W.resolve(i)):n.Ur.allocateTargetId(r).next(a=>(i=new Vi(e,a,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function jl(t,e,n){const r=ye(t),i=r.os.get(e),o=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",o,a=>r.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!lo(a))throw a;te("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function Gg(t,e,n){const r=ye(t);let i=we.min(),o=Le();return r.persistence.runTransaction("Execute query","readwrite",a=>function(h,p,y){const v=ye(h),w=v._s.get(y);return w!==void 0?W.resolve(v.os.get(w)):v.Ur.getTargetData(p,y)}(r,a,Xn(e)).next(c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(a,c.targetId).next(h=>{o=h})}).next(()=>r.ss.getDocumentsMatchingQuery(a,e,n?i:we.min(),n?o:Le())).next(c=>(cS(r,_k(e),c),{documents:c,Ts:o})))}function lS(t,e){const n=ye(t),r=ye(n.Ur),i=n.os.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",o=>r.ot(o,e).next(a=>a?a.target:null))}function uS(t,e){const n=ye(t),r=n.us.get(e)||we.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.cs.getAllFromCollectionGroup(i,e,GI(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(cS(n,e,i),i))}function cS(t,e,n){let r=t.us.get(e)||we.min();n.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),t.us.set(e,r)}function Mw(t,e){return`firestore_clients_${t}_${e}`}function Ow(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function _m(t,e){return`firestore_targets_${t}_${e}`}class xf{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Rs(e,n,r){const i=JSON.parse(r);let o,a=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return a&&i.error&&(a=typeof i.error.message=="string"&&typeof i.error.code=="string",a&&(o=new le(i.error.code,i.error.message))),a?new xf(e,n,i.state,o):(Dt("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class sc{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Rs(e,n){const r=JSON.parse(n);let i,o=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return o&&r.error&&(o=typeof r.error.message=="string"&&typeof r.error.code=="string",o&&(i=new le(r.error.code,r.error.message))),o?new sc(e,r.state,i):(Dt("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class wf{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Rs(e,n){const r=JSON.parse(n);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,o=w_();for(let a=0;i&&a<r.activeTargetIds.length;++a)i=JI(r.activeTargetIds[a]),o=o.add(r.activeTargetIds[a]);return i?new wf(e,o):(Dt("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class L_{constructor(e,n){this.clientId=e,this.onlineState=n}static Rs(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new L_(n.clientId,n.onlineState):(Dt("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Kg{constructor(){this.activeTargetIds=w_()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class vm{constructor(e,n,r,i,o){this.window=e,this.ui=n,this.persistenceKey=r,this.ps=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new dt(Ne),this.started=!1,this.bs=[];const a=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.Ds=Mw(this.persistenceKey,this.ps),this.vs=function(h){return`firestore_sequence_number_${h}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new Kg),this.Cs=new RegExp(`^firestore_clients_${a}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${a}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${a}_(\\d+)$`),this.xs=function(h){return`firestore_online_state_${h}`}(this.persistenceKey),this.Os=function(h){return`firestore_bundle_loaded_v2_${h}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const r of e){if(r===this.ps)continue;const i=this.getItem(Mw(this.persistenceKey,r));if(i){const o=wf.Rs(r,i);o&&(this.Ss=this.Ss.insert(o.clientId,o))}}this.Ns();const n=this.storage.getItem(this.xs);if(n){const r=this.Ls(n);r&&this.Bs(r)}for(const r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let n=!1;return this.Ss.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,n,r){this.qs(e,n,r),this.Qs(e)}addLocalQueryTarget(e,n=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(_m(this.persistenceKey,e));if(i){const o=sc.Rs(e,i);o&&(r=o.state)}}return n&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(_m(this.persistenceKey,e))}updateQueryState(e,n,r){this.$s(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Qs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return te("SharedClientState","READ",e,n),n}setItem(e,n){te("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){te("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const n=e;if(n.storageArea===this.storage){if(te("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Ds)return void Dt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.Cs.test(n.key)){if(n.newValue==null){const r=this.Gs(n.key);return this.zs(r,null)}{const r=this.js(n.key,n.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(n.key)){if(n.newValue!==null){const r=this.Hs(n.key,n.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(n.key)){if(n.newValue!==null){const r=this.Ys(n.key,n.newValue);if(r)return this.Zs(r)}}else if(n.key===this.xs){if(n.newValue!==null){const r=this.Ls(n.newValue);if(r)return this.Bs(r)}}else if(n.key===this.vs){const r=function(o){let a=Vn.oe;if(o!=null)try{const c=JSON.parse(o);_e(typeof c=="number"),a=c}catch(c){Dt("SharedClientState","Failed to read sequence number from WebStorage",c)}return a}(n.newValue);r!==Vn.oe&&this.sequenceNumberHandler(r)}else if(n.key===this.Os){const r=this.Xs(n.newValue);await Promise.all(r.map(i=>this.syncEngine.eo(i)))}}}else this.bs.push(n)})}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,n,r){const i=new xf(this.currentUser,e,n,r),o=Ow(this.persistenceKey,this.currentUser,e);this.setItem(o,i.Vs())}Qs(e){const n=Ow(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Us(e){const n={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(n))}$s(e,n,r){const i=_m(this.persistenceKey,e),o=new sc(e,n,r);this.setItem(i,o.Vs())}Ws(e){const n=JSON.stringify(Array.from(e));this.setItem(this.Os,n)}Gs(e){const n=this.Cs.exec(e);return n?n[1]:null}js(e,n){const r=this.Gs(e);return wf.Rs(r,n)}Hs(e,n){const r=this.Fs.exec(e),i=Number(r[1]),o=r[2]!==void 0?r[2]:null;return xf.Rs(new an(o),i,n)}Ys(e,n){const r=this.Ms.exec(e),i=Number(r[1]);return sc.Rs(i,n)}Ls(e){return L_.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);te("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,n){const r=n?this.Ss.insert(e,n):this.Ss.remove(e),i=this.ks(this.Ss),o=this.ks(r),a=[],c=[];return o.forEach(h=>{i.has(h)||a.push(h)}),i.forEach(h=>{o.has(h)||c.push(h)}),this.syncEngine.io(a,c).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let n=w_();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}}class dS{constructor(){this.so=new Kg,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Kg,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $D{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vw{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){te("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){te("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zd=null;function xm(){return Zd===null?Zd=function(){return 268435456+Math.round(2147483648*Math.random())}():Zd++,"0x"+Zd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HD={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WD{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const on="WebChannelConnection";class GD extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${i}/databases/${o}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${o}`}get Fo(){return!1}Mo(n,r,i,o,a){const c=xm(),h=this.xo(n,r.toUriEncodedString());te("RestConnection",`Sending RPC '${n}' ${c}:`,h,i);const p={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(p,o,a),this.No(n,h,p,i).then(y=>(te("RestConnection",`Received RPC '${n}' ${c}: `,y),y),y=>{throw Sc("RestConnection",`RPC '${n}' ${c} failed with error: `,y,"url: ",h,"request:",i),y})}Lo(n,r,i,o,a,c){return this.Mo(n,r,i,o,a)}Oo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+$l}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((o,a)=>n[a]=o),i&&i.headers.forEach((o,a)=>n[a]=o)}xo(n,r){const i=HD[n];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,i){const o=xm();return new Promise((a,c)=>{const h=new UI;h.setWithCredentials(!0),h.listenOnce(BI.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case _h.NO_ERROR:const y=h.getResponseJson();te(on,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(y)),a(y);break;case _h.TIMEOUT:te(on,`RPC '${e}' ${o} timed out`),c(new le(J.DEADLINE_EXCEEDED,"Request time out"));break;case _h.HTTP_ERROR:const v=h.getStatus();if(te(on,`RPC '${e}' ${o} failed with status:`,v,"response text:",h.getResponseText()),v>0){let w=h.getResponseJson();Array.isArray(w)&&(w=w[0]);const S=w==null?void 0:w.error;if(S&&S.status&&S.message){const N=function(U){const j=U.toLowerCase().replace(/_/g,"-");return Object.values(J).indexOf(j)>=0?j:J.UNKNOWN}(S.status);c(new le(N,S.message))}else c(new le(J.UNKNOWN,"Server responded with status "+h.getStatus()))}else c(new le(J.UNAVAILABLE,"Connection failed."));break;default:me()}}finally{te(on,`RPC '${e}' ${o} completed.`)}});const p=JSON.stringify(i);te(on,`RPC '${e}' ${o} sending request:`,i),h.send(n,"POST",p,r,15)})}Bo(e,n,r){const i=xm(),o=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=$I(),c=qI(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(h.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(h.useFetchStreams=!0),this.Oo(h.initMessageHeaders,n,r),h.encodeInitMessageHeaders=!0;const y=o.join("");te(on,`Creating RPC '${e}' stream ${i}: ${y}`,h);const v=a.createWebChannel(y,h);let w=!1,S=!1;const N=new WD({Io:U=>{S?te(on,`Not sending because RPC '${e}' stream ${i} is closed:`,U):(w||(te(on,`Opening RPC '${e}' stream ${i} transport.`),v.open(),w=!0),te(on,`RPC '${e}' stream ${i} sending:`,U),v.send(U))},To:()=>v.close()}),A=(U,j,k)=>{U.listen(j,R=>{try{k(R)}catch(z){setTimeout(()=>{throw z},0)}})};return A(v,Fu.EventType.OPEN,()=>{S||(te(on,`RPC '${e}' stream ${i} transport opened.`),N.yo())}),A(v,Fu.EventType.CLOSE,()=>{S||(S=!0,te(on,`RPC '${e}' stream ${i} transport closed`),N.So())}),A(v,Fu.EventType.ERROR,U=>{S||(S=!0,Sc(on,`RPC '${e}' stream ${i} transport errored:`,U),N.So(new le(J.UNAVAILABLE,"The operation could not be completed")))}),A(v,Fu.EventType.MESSAGE,U=>{var j;if(!S){const k=U.data[0];_e(!!k);const R=k,z=R.error||((j=R[0])===null||j===void 0?void 0:j.error);if(z){te(on,`RPC '${e}' stream ${i} received error:`,z);const K=z.status;let H=function(C){const P=Ft[C];if(P!==void 0)return Ck(P)}(K),T=z.message;H===void 0&&(H=J.INTERNAL,T="Unknown error status: "+K+" with message "+z.message),S=!0,N.So(new le(H,T)),v.close()}else te(on,`RPC '${e}' stream ${i} received:`,k),N.bo(k)}}),A(c,zI.STAT_EVENT,U=>{U.stat===Cg.PROXY?te(on,`RPC '${e}' stream ${i} detected buffering proxy`):U.stat===Cg.NOPROXY&&te(on,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{N.wo()},0),N}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hS(){return typeof window<"u"?window:null}function Ih(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ap(t){return new eD(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fS{constructor(e,n,r=1e3,i=1.5,o=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=i,this.Qo=o,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,n-r);i>0&&te("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pS{constructor(e,n,r,i,o,a,c,h){this.ui=e,this.Ho=r,this.Jo=i,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=h,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new fS(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===J.RESOURCE_EXHAUSTED?(Dt(n.toString()),Dt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===J.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===n&&this.P_(r,i)},r=>{e(()=>{const i=new le(J.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return te("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(te("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class KD extends pS{constructor(e,n,r,i,o,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,a),this.serializer=o}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=rD(this.serializer,e),r=function(o){if(!("targetChange"in o))return we.min();const a=o.targetChange;return a.targetIds&&a.targetIds.length?we.min():a.readTime?Tn(a.readTime):we.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=zg(this.serializer),n.addTarget=function(o,a){let c;const h=a.target;if(c=df(h)?{documents:Fk(o,h)}:{query:Uk(o,h)._t},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=Lk(o,a.resumeToken);const p=Ug(o,a.expectedCount);p!==null&&(c.expectedCount=p)}else if(a.snapshotVersion.compareTo(we.min())>0){c.readTime=Rl(o,a.snapshotVersion.toTimestamp());const p=Ug(o,a.expectedCount);p!==null&&(c.expectedCount=p)}return c}(this.serializer,e);const r=sD(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=zg(this.serializer),n.removeTarget=e,this.a_(n)}}class ZD extends pS{constructor(e,n,r,i,o,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,a),this.serializer=o}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return _e(!!e.streamToken),this.lastStreamToken=e.streamToken,_e(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){_e(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=iD(e.writeResults,e.commitTime),r=Tn(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=zg(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>mf(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QD extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new le(J.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Mo(e,Bg(n,r),i,o,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===J.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new le(J.UNKNOWN,o.toString())})}Lo(e,n,r,i,o){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,c])=>this.connection.Lo(e,Bg(n,r),i,a,c,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===J.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new le(J.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class YD{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Dt(n),this.D_=!1):te("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JD{constructor(e,n,r,i,o){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=o,this.k_._o(a=>{r.enqueueAndForget(async()=>{ca(this)&&(te("RemoteStore","Restarting streams for network reachability change."),await async function(h){const p=ye(h);p.L_.add(4),await rd(p),p.q_.set("Unknown"),p.L_.delete(4),await lp(p)}(this))})}),this.q_=new YD(r,i)}}async function lp(t){if(ca(t))for(const e of t.B_)await e(!0)}async function rd(t){for(const e of t.B_)await e(!1)}function up(t,e){const n=ye(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),O_(n)?M_(n):Kl(n).r_()&&D_(n,e))}function Ll(t,e){const n=ye(t),r=Kl(n);n.N_.delete(e),r.r_()&&mS(n,e),n.N_.size===0&&(r.r_()?r.o_():ca(n)&&n.q_.set("Unknown"))}function D_(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(we.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Kl(t).A_(e)}function mS(t,e){t.Q_.xe(e),Kl(t).R_(e)}function M_(t){t.Q_=new QL({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Kl(t).start(),t.q_.v_()}function O_(t){return ca(t)&&!Kl(t).n_()&&t.N_.size>0}function ca(t){return ye(t).L_.size===0}function gS(t){t.Q_=void 0}async function XD(t){t.q_.set("Online")}async function eM(t){t.N_.forEach((e,n)=>{D_(t,e)})}async function tM(t,e){gS(t),O_(t)?(t.q_.M_(e),M_(t)):t.q_.set("Unknown")}async function nM(t,e,n){if(t.q_.set("Online"),e instanceof jk&&e.state===2&&e.cause)try{await async function(i,o){const a=o.cause;for(const c of o.targetIds)i.N_.has(c)&&(await i.remoteSyncer.rejectListen(c,a),i.N_.delete(c),i.Q_.removeTarget(c))}(t,e)}catch(r){te("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await bf(t,r)}else if(e instanceof Th?t.Q_.Ke(e):e instanceof Rk?t.Q_.He(e):t.Q_.We(e),!n.isEqual(we.min()))try{const r=await aS(t.localStore);n.compareTo(r)>=0&&await function(o,a){const c=o.Q_.rt(a);return c.targetChanges.forEach((h,p)=>{if(h.resumeToken.approximateByteSize()>0){const y=o.N_.get(p);y&&o.N_.set(p,y.withResumeToken(h.resumeToken,a))}}),c.targetMismatches.forEach((h,p)=>{const y=o.N_.get(h);if(!y)return;o.N_.set(h,y.withResumeToken(Mt.EMPTY_BYTE_STRING,y.snapshotVersion)),mS(o,h);const v=new Vi(y.target,h,p,y.sequenceNumber);D_(o,v)}),o.remoteSyncer.applyRemoteEvent(c)}(t,n)}catch(r){te("RemoteStore","Failed to raise snapshot:",r),await bf(t,r)}}async function bf(t,e,n){if(!lo(e))throw e;t.L_.add(1),await rd(t),t.q_.set("Offline"),n||(n=()=>aS(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{te("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await lp(t)})}function yS(t,e){return e().catch(n=>bf(t,n,e))}async function Gl(t){const e=ye(t),n=no(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;rM(e);)try{const i=await qD(e.localStore,r);if(i===null){e.O_.length===0&&n.o_();break}r=i.batchId,iM(e,i)}catch(i){await bf(e,i)}_S(e)&&vS(e)}function rM(t){return ca(t)&&t.O_.length<10}function iM(t,e){t.O_.push(e);const n=no(t);n.r_()&&n.V_&&n.m_(e.mutations)}function _S(t){return ca(t)&&!no(t).n_()&&t.O_.length>0}function vS(t){no(t).start()}async function sM(t){no(t).p_()}async function oM(t){const e=no(t);for(const n of t.O_)e.m_(n.mutations)}async function aM(t,e,n){const r=t.O_.shift(),i=I_.from(r,e,n);await yS(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Gl(t)}async function lM(t,e){e&&no(t).V_&&await async function(r,i){if(function(a){return GL(a)&&a!==J.ABORTED}(i.code)){const o=r.O_.shift();no(r).s_(),await yS(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),await Gl(r)}}(t,e),_S(t)&&vS(t)}async function Fw(t,e){const n=ye(t);n.asyncQueue.verifyOperationInProgress(),te("RemoteStore","RemoteStore received new credentials");const r=ca(n);n.L_.add(3),await rd(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await lp(n)}async function Zg(t,e){const n=ye(t);e?(n.L_.delete(2),await lp(n)):e||(n.L_.add(2),await rd(n),n.q_.set("Unknown"))}function Kl(t){return t.K_||(t.K_=function(n,r,i){const o=ye(n);return o.w_(),new KD(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Eo:XD.bind(null,t),Ro:eM.bind(null,t),mo:tM.bind(null,t),d_:nM.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),O_(t)?M_(t):t.q_.set("Unknown")):(await t.K_.stop(),gS(t))})),t.K_}function no(t){return t.U_||(t.U_=function(n,r,i){const o=ye(n);return o.w_(),new ZD(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:sM.bind(null,t),mo:lM.bind(null,t),f_:oM.bind(null,t),g_:aM.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Gl(t)):(await t.U_.stop(),t.O_.length>0&&(te("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V_{constructor(e,n,r,i,o){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new pi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,o){const a=Date.now()+r,c=new V_(e,n,a,i,o);return c.start(r),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new le(J.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function F_(t,e){if(Dt("AsyncQueue",`${e}: ${t}`),lo(t))return new le(J.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gl{constructor(e){this.comparator=e?(n,r)=>e(n,r)||ce.comparator(n.key,r.key):(n,r)=>ce.comparator(n.key,r.key),this.keyedMap=Uu(),this.sortedSet=new dt(this.comparator)}static emptySet(e){return new gl(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof gl)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new gl;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uw{constructor(){this.W_=new dt(ce.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):me():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Dl{constructor(e,n,r,i,o,a,c,h,p){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=h,this.hasCachedResults=p}static fromInitialDocuments(e,n,r,i,o){const a=[];return n.forEach(c=>{a.push({type:0,doc:c})}),new Dl(e,n,gl.emptySet(n),a,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ep(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uM{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class cM{constructor(){this.queries=Bw(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const i=ye(n),o=i.queries;i.queries=Bw(),o.forEach((a,c)=>{for(const h of c.j_)h.onError(r)})})(this,new le(J.ABORTED,"Firestore shutting down"))}}function Bw(){return new uo(t=>yk(t),ep)}async function U_(t,e){const n=ye(t);let r=3;const i=e.query;let o=n.queries.get(i);o?!o.H_()&&e.J_()&&(r=2):(o=new uM,r=e.J_()?0:1);try{switch(r){case 0:o.z_=await n.onListen(i,!0);break;case 1:o.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(a){const c=F_(a,`Initialization of query '${$a(e.query)}' failed`);return void e.onError(c)}n.queries.set(i,o),o.j_.push(e),e.Z_(n.onlineState),o.z_&&e.X_(o.z_)&&z_(n)}async function B_(t,e){const n=ye(t),r=e.query;let i=3;const o=n.queries.get(r);if(o){const a=o.j_.indexOf(e);a>=0&&(o.j_.splice(a,1),o.j_.length===0?i=e.J_()?0:1:!o.H_()&&e.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function dM(t,e){const n=ye(t);let r=!1;for(const i of e){const o=i.query,a=n.queries.get(o);if(a){for(const c of a.j_)c.X_(i)&&(r=!0);a.z_=i}}r&&z_(n)}function hM(t,e,n){const r=ye(t),i=r.queries.get(e);if(i)for(const o of i.j_)o.onError(n);r.queries.delete(e)}function z_(t){t.Y_.forEach(e=>{e.next()})}var Qg,zw;(zw=Qg||(Qg={})).ea="default",zw.Cache="cache";class q_{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Dl(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=Dl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Qg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xS{constructor(e){this.key=e}}class wS{constructor(e){this.key=e}}class fM{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Le(),this.mutatedKeys=Le(),this.Aa=vk(e),this.Ra=new gl(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new Uw,i=n?n.Ra:this.Ra;let o=n?n.mutatedKeys:this.mutatedKeys,a=i,c=!1;const h=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,p=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((y,v)=>{const w=i.get(y),S=ed(this.query,v)?v:null,N=!!w&&this.mutatedKeys.has(w.key),A=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations);let U=!1;w&&S?w.data.isEqual(S.data)?N!==A&&(r.track({type:3,doc:S}),U=!0):this.ga(w,S)||(r.track({type:2,doc:S}),U=!0,(h&&this.Aa(S,h)>0||p&&this.Aa(S,p)<0)&&(c=!0)):!w&&S?(r.track({type:0,doc:S}),U=!0):w&&!S&&(r.track({type:1,doc:w}),U=!0,(h||p)&&(c=!0)),U&&(S?(a=a.add(S),o=A?o.add(y):o.delete(y)):(a=a.delete(y),o=o.delete(y)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const y=this.query.limitType==="F"?a.last():a.first();a=a.delete(y.key),o=o.delete(y.key),r.track({type:1,doc:y})}return{Ra:a,fa:r,ns:c,mutatedKeys:o}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const o=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((y,v)=>function(S,N){const A=U=>{switch(U){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return me()}};return A(S)-A(N)}(y.type,v.type)||this.Aa(y.doc,v.doc)),this.pa(r),i=i!=null&&i;const c=n&&!i?this.ya():[],h=this.da.size===0&&this.current&&!i?1:0,p=h!==this.Ea;return this.Ea=h,a.length!==0||p?{snapshot:new Dl(this.query,e.Ra,o,a,e.mutatedKeys,h===0,p,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:c}:{wa:c}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Uw,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Le(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new wS(r))}),this.da.forEach(r=>{e.has(r)||n.push(new xS(r))}),n}ba(e){this.Ta=e.Ts,this.da=Le();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return Dl.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class pM{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class mM{constructor(e){this.key=e,this.va=!1}}class gM{constructor(e,n,r,i,o,a){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new uo(c=>yk(c),ep),this.Ma=new Map,this.xa=new Set,this.Oa=new dt(ce.comparator),this.Na=new Map,this.La=new C_,this.Ba={},this.ka=new Map,this.qa=ea.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function yM(t,e,n=!0){const r=cp(t);let i;const o=r.Fa.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.Da()):i=await bS(r,e,n,!0),i}async function _M(t,e){const n=cp(t);await bS(n,e,!0,!1)}async function bS(t,e,n,r){const i=await vf(t.localStore,Xn(e)),o=i.targetId,a=t.sharedClientState.addLocalQueryTarget(o,n);let c;return r&&(c=await $_(t,e,o,a==="current",i.resumeToken)),t.isPrimaryClient&&n&&up(t.remoteStore,i),c}async function $_(t,e,n,r,i){t.Ka=(v,w,S)=>async function(A,U,j,k){let R=U.view.ma(j);R.ns&&(R=await Gg(A.localStore,U.query,!1).then(({documents:T})=>U.view.ma(T,R)));const z=k&&k.targetChanges.get(U.targetId),K=k&&k.targetMismatches.get(U.targetId)!=null,H=U.view.applyChanges(R,A.isPrimaryClient,z,K);return Yg(A,U.targetId,H.wa),H.snapshot}(t,v,w,S);const o=await Gg(t.localStore,e,!0),a=new fM(e,o.Ts),c=a.ma(o.documents),h=nd.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),p=a.applyChanges(c,t.isPrimaryClient,h);Yg(t,n,p.wa);const y=new pM(e,n,a);return t.Fa.set(e,y),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),p.snapshot}async function vM(t,e,n){const r=ye(t),i=r.Fa.get(e),o=r.Ma.get(i.targetId);if(o.length>1)return r.Ma.set(i.targetId,o.filter(a=>!ep(a,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await jl(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Ll(r.remoteStore,i.targetId),Ml(r,i.targetId)}).catch(ao)):(Ml(r,i.targetId),await jl(r.localStore,i.targetId,!0))}async function xM(t,e){const n=ye(t),r=n.Fa.get(e),i=n.Ma.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Ll(n.remoteStore,r.targetId))}async function wM(t,e,n){const r=K_(t);try{const i=await function(a,c){const h=ye(a),p=Ke.now(),y=c.reduce((S,N)=>S.add(N.key),Le());let v,w;return h.persistence.runTransaction("Locally write mutations","readwrite",S=>{let N=Qn(),A=Le();return h.cs.getEntries(S,y).next(U=>{N=U,N.forEach((j,k)=>{k.isValidDocument()||(A=A.add(j))})}).next(()=>h.localDocuments.getOverlayedDocuments(S,N)).next(U=>{v=U;const j=[];for(const k of c){const R=HL(k,v.get(k.key).overlayedDocument);R!=null&&j.push(new ts(k.key,R,ak(R.value.mapValue),cn.exists(!0)))}return h.mutationQueue.addMutationBatch(S,p,j,c)}).next(U=>{w=U;const j=U.applyToLocalDocumentSet(v,A);return h.documentOverlayCache.saveOverlays(S,U.batchId,j)})}).then(()=>({batchId:w.batchId,changes:wk(v)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,c,h){let p=a.Ba[a.currentUser.toKey()];p||(p=new dt(Ne)),p=p.insert(c,h),a.Ba[a.currentUser.toKey()]=p}(r,i.batchId,n),await co(r,i.changes),await Gl(r.remoteStore)}catch(i){const o=F_(i,"Failed to persist write");n.reject(o)}}async function ES(t,e){const n=ye(t);try{const r=await BD(n.localStore,e);e.targetChanges.forEach((i,o)=>{const a=n.Na.get(o);a&&(_e(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?_e(a.va):i.removedDocuments.size>0&&(_e(a.va),a.va=!1))}),await co(n,r,e)}catch(r){await ao(r)}}function qw(t,e,n){const r=ye(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Fa.forEach((o,a)=>{const c=a.view.Z_(e);c.snapshot&&i.push(c.snapshot)}),function(a,c){const h=ye(a);h.onlineState=c;let p=!1;h.queries.forEach((y,v)=>{for(const w of v.j_)w.Z_(c)&&(p=!0)}),p&&z_(h)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function bM(t,e,n){const r=ye(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Na.get(e),o=i&&i.key;if(o){let a=new dt(ce.comparator);a=a.insert(o,Nt.newNoDocument(o,we.min()));const c=Le().add(o),h=new td(we.min(),new Map,new dt(Ne),a,c);await ES(r,h),r.Oa=r.Oa.remove(o),r.Na.delete(e),G_(r)}else await jl(r.localStore,e,!1).then(()=>Ml(r,e,n)).catch(ao)}async function EM(t,e){const n=ye(t),r=e.batch.batchId;try{const i=await UD(n.localStore,e);W_(n,r,null),H_(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await co(n,i)}catch(i){await ao(i)}}async function TM(t,e,n){const r=ye(t);try{const i=await function(a,c){const h=ye(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",p=>{let y;return h.mutationQueue.lookupMutationBatch(p,c).next(v=>(_e(v!==null),y=v.keys(),h.mutationQueue.removeMutationBatch(p,v))).next(()=>h.mutationQueue.performConsistencyCheck(p)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(p,y,c)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,y)).next(()=>h.localDocuments.getDocuments(p,y))})}(r.localStore,e);W_(r,e,n),H_(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await co(r,i)}catch(i){await ao(i)}}function H_(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function W_(t,e,n){const r=ye(t);let i=r.Ba[r.currentUser.toKey()];if(i){const o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function Ml(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||TS(t,r)})}function TS(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(Ll(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),G_(t))}function Yg(t,e,n){for(const r of n)r instanceof xS?(t.La.addReference(r.key,e),IM(t,r)):r instanceof wS?(te("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||TS(t,r.key)):me()}function IM(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(te("SyncEngine","New document in limbo: "+n),t.xa.add(r),G_(t))}function G_(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new ce(et.fromString(e)),r=t.qa.next();t.Na.set(r,new mM(n)),t.Oa=t.Oa.insert(n,r),up(t.remoteStore,new Vi(Xn(Xc(n.path)),r,"TargetPurposeLimboResolution",Vn.oe))}}async function co(t,e,n){const r=ye(t),i=[],o=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((c,h)=>{a.push(r.Ka(h,e,n).then(p=>{var y;if((p||n)&&r.isPrimaryClient){const v=p?!p.fromCache:(y=n==null?void 0:n.targetChanges.get(h.targetId))===null||y===void 0?void 0:y.current;r.sharedClientState.updateQueryState(h.targetId,v?"current":"not-current")}if(p){i.push(p);const v=j_.Wi(h.targetId,p);o.push(v)}}))}),await Promise.all(a),r.Ca.d_(i),await async function(h,p){const y=ye(h);try{await y.persistence.runTransaction("notifyLocalViewChanges","readwrite",v=>W.forEach(p,w=>W.forEach(w.$i,S=>y.persistence.referenceDelegate.addReference(v,w.targetId,S)).next(()=>W.forEach(w.Ui,S=>y.persistence.referenceDelegate.removeReference(v,w.targetId,S)))))}catch(v){if(!lo(v))throw v;te("LocalStore","Failed to update sequence numbers: "+v)}for(const v of p){const w=v.targetId;if(!v.fromCache){const S=y.os.get(w),N=S.snapshotVersion,A=S.withLastLimboFreeSnapshotVersion(N);y.os=y.os.insert(w,A)}}}(r.localStore,o))}async function kM(t,e){const n=ye(t);if(!n.currentUser.isEqual(e)){te("SyncEngine","User change. New user:",e.toKey());const r=await oS(n.localStore,e);n.currentUser=e,function(o,a){o.ka.forEach(c=>{c.forEach(h=>{h.reject(new le(J.CANCELLED,a))})}),o.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await co(n,r.hs)}}function SM(t,e){const n=ye(t),r=n.Na.get(e);if(r&&r.va)return Le().add(r.key);{let i=Le();const o=n.Ma.get(e);if(!o)return i;for(const a of o){const c=n.Fa.get(a);i=i.unionWith(c.view.Va)}return i}}async function PM(t,e){const n=ye(t),r=await Gg(n.localStore,e.query,!0),i=e.view.ba(r);return n.isPrimaryClient&&Yg(n,e.targetId,i.wa),i}async function AM(t,e){const n=ye(t);return uS(n.localStore,e).then(r=>co(n,r))}async function NM(t,e,n,r){const i=ye(t),o=await function(c,h){const p=ye(c),y=ye(p.mutationQueue);return p.persistence.runTransaction("Lookup mutation documents","readonly",v=>y.Mn(v,h).next(w=>w?p.localDocuments.getDocuments(v,w):W.resolve(null)))}(i.localStore,e);o!==null?(n==="pending"?await Gl(i.remoteStore):n==="acknowledged"||n==="rejected"?(W_(i,e,r||null),H_(i,e),function(c,h){ye(ye(c).mutationQueue).On(h)}(i.localStore,e)):me(),await co(i,o)):te("SyncEngine","Cannot apply mutation batch with id: "+e)}async function CM(t,e){const n=ye(t);if(cp(n),K_(n),e===!0&&n.Qa!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),i=await $w(n,r.toArray());n.Qa=!0,await Zg(n.remoteStore,!0);for(const o of i)up(n.remoteStore,o)}else if(e===!1&&n.Qa!==!1){const r=[];let i=Promise.resolve();n.Ma.forEach((o,a)=>{n.sharedClientState.isLocalQueryTarget(a)?r.push(a):i=i.then(()=>(Ml(n,a),jl(n.localStore,a,!0))),Ll(n.remoteStore,a)}),await i,await $w(n,r),function(a){const c=ye(a);c.Na.forEach((h,p)=>{Ll(c.remoteStore,p)}),c.La.pr(),c.Na=new Map,c.Oa=new dt(ce.comparator)}(n),n.Qa=!1,await Zg(n.remoteStore,!1)}}async function $w(t,e,n){const r=ye(t),i=[],o=[];for(const a of e){let c;const h=r.Ma.get(a);if(h&&h.length!==0){c=await vf(r.localStore,Xn(h[0]));for(const p of h){const y=r.Fa.get(p),v=await PM(r,y);v.snapshot&&o.push(v.snapshot)}}else{const p=await lS(r.localStore,a);c=await vf(r.localStore,p),await $_(r,IS(p),a,!1,c.resumeToken)}i.push(c)}return r.Ca.d_(o),i}function IS(t){return mk(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function RM(t){return function(n){return ye(ye(n).persistence).Qi()}(ye(t).localStore)}async function jM(t,e,n,r){const i=ye(t);if(i.Qa)return void te("SyncEngine","Ignoring unexpected query state notification.");const o=i.Ma.get(e);if(o&&o.length>0)switch(n){case"current":case"not-current":{const a=await uS(i.localStore,_k(o[0])),c=td.createSynthesizedRemoteEventForCurrentChange(e,n==="current",Mt.EMPTY_BYTE_STRING);await co(i,a,c);break}case"rejected":await jl(i.localStore,e,!0),Ml(i,e,r);break;default:me()}}async function LM(t,e,n){const r=cp(t);if(r.Qa){for(const i of e){if(r.Ma.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){te("SyncEngine","Adding an already active target "+i);continue}const o=await lS(r.localStore,i),a=await vf(r.localStore,o);await $_(r,IS(o),a.targetId,!1,a.resumeToken),up(r.remoteStore,a)}for(const i of n)r.Ma.has(i)&&await jl(r.localStore,i,!1).then(()=>{Ll(r.remoteStore,i),Ml(r,i)}).catch(ao)}}function cp(t){const e=ye(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=ES.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=SM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=bM.bind(null,e),e.Ca.d_=dM.bind(null,e.eventManager),e.Ca.$a=hM.bind(null,e.eventManager),e}function K_(t){const e=ye(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=EM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=TM.bind(null,e),e}class Oc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ap(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return sS(this.persistence,new iS,e.initialUser,this.serializer)}Ga(e){return new nS(op.Zr,this.serializer)}Wa(e){return new dS}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Oc.provider={build:()=>new Oc};class kS extends Oc{constructor(e,n,r){super(),this.Ja=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await K_(this.Ja.syncEngine),await Gl(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return sS(this.persistence,new iS,e.initialUser,this.serializer)}ja(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new bD(r,e.asyncQueue,n)}Ha(e,n){const r=new tL(n,this.persistence);return new eL(e.asyncQueue,r)}Ga(e){const n=rS(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Rn.withCacheSize(this.cacheSizeBytes):Rn.DEFAULT;return new R_(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,hS(),Ih(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new dS}}class DM extends kS{constructor(e,n){super(e,n,!1),this.Ja=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.Ja.syncEngine;this.sharedClientState instanceof vm&&(this.sharedClientState.syncEngine={no:NM.bind(null,n),ro:jM.bind(null,n),io:LM.bind(null,n),Qi:RM.bind(null,n),eo:AM.bind(null,n)},await this.sharedClientState.start()),await this.persistence.yi(async r=>{await CM(this.Ja.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Wa(e){const n=hS();if(!vm.D(n))throw new le(J.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=rS(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new vm(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class Vc{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>qw(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=kM.bind(null,this.syncEngine),await Zg(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new cM}()}createDatastore(e){const n=ap(e.databaseInfo.databaseId),r=function(o){return new GD(o)}(e.databaseInfo);return function(o,a,c,h){return new QD(o,a,c,h)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,o,a,c){return new JD(r,i,o,a,c)}(this.localStore,this.datastore,e.asyncQueue,n=>qw(this.syncEngine,n,0),function(){return Vw.D()?new Vw:new $D}())}createSyncEngine(e,n){return function(i,o,a,c,h,p,y){const v=new gM(i,o,a,c,h,p);return y&&(v.Qa=!0),v}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const o=ye(i);te("RemoteStore","RemoteStore shutting down."),o.L_.add(5),await rd(o),o.k_.shutdown(),o.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Vc.provider={build:()=>new Vc};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z_{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Dt("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MM{constructor(e,n,r,i,o){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=an.UNAUTHENTICATED,this.clientId=HI.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,async a=>{te("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(te("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new pi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=F_(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function wm(t,e){t.asyncQueue.verifyOperationInProgress(),te("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await oS(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Hw(t,e){t.asyncQueue.verifyOperationInProgress();const n=await OM(t);te("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Fw(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>Fw(e.remoteStore,i)),t._onlineComponents=e}async function OM(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){te("FirestoreClient","Using user provided OfflineComponentProvider");try{await wm(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===J.FAILED_PRECONDITION||i.code===J.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;Sc("Error using user provided cache. Falling back to memory cache: "+n),await wm(t,new Oc)}}else te("FirestoreClient","Using default OfflineComponentProvider"),await wm(t,new Oc);return t._offlineComponents}async function SS(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(te("FirestoreClient","Using user provided OnlineComponentProvider"),await Hw(t,t._uninitializedComponentsProvider._online)):(te("FirestoreClient","Using default OnlineComponentProvider"),await Hw(t,new Vc))),t._onlineComponents}function VM(t){return SS(t).then(e=>e.syncEngine)}async function Ef(t){const e=await SS(t),n=e.eventManager;return n.onListen=yM.bind(null,e.syncEngine),n.onUnlisten=vM.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=_M.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=xM.bind(null,e.syncEngine),n}function FM(t,e,n={}){const r=new pi;return t.asyncQueue.enqueueAndForget(async()=>function(o,a,c,h,p){const y=new Z_({next:w=>{y.Za(),a.enqueueAndForget(()=>B_(o,v));const S=w.docs.has(c);!S&&w.fromCache?p.reject(new le(J.UNAVAILABLE,"Failed to get document because the client is offline.")):S&&w.fromCache&&h&&h.source==="server"?p.reject(new le(J.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(w)},error:w=>p.reject(w)}),v=new q_(Xc(c.path),y,{includeMetadataChanges:!0,_a:!0});return U_(o,v)}(await Ef(t),t.asyncQueue,e,n,r)),r.promise}function UM(t,e,n={}){const r=new pi;return t.asyncQueue.enqueueAndForget(async()=>function(o,a,c,h,p){const y=new Z_({next:w=>{y.Za(),a.enqueueAndForget(()=>B_(o,v)),w.fromCache&&h.source==="server"?p.reject(new le(J.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(w)},error:w=>p.reject(w)}),v=new q_(c,y,{includeMetadataChanges:!0,_a:!0});return U_(o,v)}(await Ef(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PS(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ww=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AS(t,e,n){if(!n)throw new le(J.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function BM(t,e,n,r){if(e===!0&&r===!0)throw new le(J.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Gw(t){if(!ce.isDocumentKey(t))throw new le(J.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Kw(t){if(ce.isDocumentKey(t))throw new le(J.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function dp(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":me()}function er(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new le(J.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=dp(t);throw new le(J.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zw{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new le(J.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new le(J.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}BM("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=PS((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new le(J.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new le(J.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new le(J.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Q_{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Zw({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new le(J.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new le(J.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Zw(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new $j;switch(r.type){case"firstParty":return new Gj(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new le(J.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Ww.get(n);r&&(te("ComponentProvider","Removing Datastore"),Ww.delete(n),r.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new ns(this.firestore,e,this._query)}}class hn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ys(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new hn(this.firestore,e,this._key)}}class Ys extends ns{constructor(e,n,r){super(e,n,Xc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new hn(this.firestore,null,new ce(e))}withConverter(e){return new Ys(this.firestore,e,this._path)}}function Mn(t,e,...n){if(t=Ye(t),AS("collection","path",e),t instanceof Q_){const r=et.fromString(e,...n);return Kw(r),new Ys(t,null,r)}{if(!(t instanceof hn||t instanceof Ys))throw new le(J.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(et.fromString(e,...n));return Kw(r),new Ys(t.firestore,null,r)}}function Et(t,e,...n){if(t=Ye(t),arguments.length===1&&(e=HI.newId()),AS("doc","path",e),t instanceof Q_){const r=et.fromString(e,...n);return Gw(r),new hn(t,null,new ce(r))}{if(!(t instanceof hn||t instanceof Ys))throw new le(J.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(et.fromString(e,...n));return Gw(r),new hn(t.firestore,t instanceof Ys?t.converter:null,new ce(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qw{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new fS(this,"async_queue_retry"),this.Vu=()=>{const r=Ih();r&&te("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=Ih();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=Ih();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new pi;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!lo(e))throw e;te("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(a){let c=a.message||"";return a.stack&&(c=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),c}(r);throw Dt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const i=V_.createAndSchedule(this,e,n,r,o=>this.yu(o));return this.Tu.push(i),i}fu(){this.Eu&&me()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function Yw(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const o of r)if(o in i&&typeof i[o]=="function")return!0;return!1}(t,["next","error","complete"])}class Yi extends Q_{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new Qw,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Qw(e),this._firestoreClient=void 0,await e}}}function zM(t,e,n){const r=oo(t,"firestore");if(r.isInitialized(n)){const i=r.getImmediate({identifier:n}),o=r.getOptions(n);if(Il(o,e))return i;throw new le(J.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new le(J.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new le(J.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:n})}function hp(t){if(t._terminated)throw new le(J.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||qM(t),t._firestoreClient}function qM(t){var e,n,r;const i=t._freezeSettings(),o=function(c,h,p,y){return new bL(c,h,p,y.host,y.ssl,y.experimentalForceLongPolling,y.experimentalAutoDetectLongPolling,PS(y.experimentalLongPollingOptions),y.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new MM(t._authCredentials,t._appCheckCredentials,t._queue,o,t._componentsProvider&&function(c){const h=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(h),_online:h}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ol{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ol(Mt.fromBase64String(e))}catch(n){throw new le(J.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Ol(Mt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fp{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new le(J.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Tt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class id{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y_{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new le(J.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new le(J.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ne(this._lat,e._lat)||Ne(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J_{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $M=/^__.*__$/;class HM{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new ts(e,this.data,this.fieldMask,n,this.fieldTransforms):new Wl(e,this.data,n,this.fieldTransforms)}}class NS{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new ts(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function CS(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw me()}}class pp{constructor(e,n,r,i,o,a){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.vu(),this.fieldTransforms=o||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new pp(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Tf(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(CS(this.Cu)&&$M.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class WM{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||ap(e)}Qu(e,n,r,i=!1){return new pp({Cu:e,methodName:n,qu:r,path:Tt.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function mp(t){const e=t._freezeSettings(),n=ap(t._databaseId);return new WM(t._databaseId,!!e.ignoreUndefinedProperties,n)}function RS(t,e,n,r,i,o={}){const a=t.Qu(o.merge||o.mergeFields?2:0,e,n,i);tv("Data must be an object, but it was:",a,r);const c=jS(r,a);let h,p;if(o.merge)h=new Fn(a.fieldMask),p=a.fieldTransforms;else if(o.mergeFields){const y=[];for(const v of o.mergeFields){const w=Jg(e,v,n);if(!a.contains(w))throw new le(J.INVALID_ARGUMENT,`Field '${w}' is specified in your field mask but missing from your input data.`);DS(y,w)||y.push(w)}h=new Fn(y),p=a.fieldTransforms.filter(v=>h.covers(v.field))}else h=null,p=a.fieldTransforms;return new HM(new un(c),h,p)}class gp extends id{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof gp}}function GM(t,e,n){return new pp({Cu:3,qu:e.settings.qu,methodName:t._methodName,xu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class X_ extends id{_toFieldTransform(e){return new E_(e.path,new Nl)}isEqual(e){return e instanceof X_}}class ev extends id{constructor(e,n){super(e),this.Ku=n}_toFieldTransform(e){const n=GM(this,e,!0),r=this.Ku.map(o=>Zl(o,n)),i=new Yo(r);return new E_(e.path,i)}isEqual(e){return e instanceof ev&&Il(this.Ku,e.Ku)}}function KM(t,e,n,r){const i=t.Qu(1,e,n);tv("Data must be an object, but it was:",i,r);const o=[],a=un.empty();ua(r,(h,p)=>{const y=nv(e,h,n);p=Ye(p);const v=i.Nu(y);if(p instanceof gp)o.push(y);else{const w=Zl(p,v);w!=null&&(o.push(y),a.set(y,w))}});const c=new Fn(o);return new NS(a,c,i.fieldTransforms)}function ZM(t,e,n,r,i,o){const a=t.Qu(1,e,n),c=[Jg(e,r,n)],h=[i];if(o.length%2!=0)throw new le(J.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let w=0;w<o.length;w+=2)c.push(Jg(e,o[w])),h.push(o[w+1]);const p=[],y=un.empty();for(let w=c.length-1;w>=0;--w)if(!DS(p,c[w])){const S=c[w];let N=h[w];N=Ye(N);const A=a.Nu(S);if(N instanceof gp)p.push(S);else{const U=Zl(N,A);U!=null&&(p.push(S),y.set(S,U))}}const v=new Fn(p);return new NS(y,v,a.fieldTransforms)}function QM(t,e,n,r=!1){return Zl(n,t.Qu(r?4:3,e))}function Zl(t,e){if(LS(t=Ye(t)))return tv("Unsupported field value:",e,t),jS(t,e);if(t instanceof id)return function(r,i){if(!CS(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const o=[];let a=0;for(const c of r){let h=Zl(c,i.Lu(a));h==null&&(h={nullValue:"NULL_VALUE"}),o.push(h),a++}return{arrayValue:{values:o}}}(t,e)}return function(r,i){if((r=Ye(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return FL(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const o=Ke.fromDate(r);return{timestampValue:Rl(i.serializer,o)}}if(r instanceof Ke){const o=new Ke(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Rl(i.serializer,o)}}if(r instanceof Y_)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ol)return{bytesValue:Lk(i.serializer,r._byteString)};if(r instanceof hn){const o=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(o))throw i.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:P_(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof J_)return function(a,c){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(h=>{if(typeof h!="number")throw c.Bu("VectorValues must only contain numeric values.");return b_(c.serializer,h)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${dp(r)}`)}(t,e)}function jS(t,e){const n={};return rk(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ua(t,(r,i)=>{const o=Zl(i,e.Mu(r));o!=null&&(n[r]=o)}),{mapValue:{fields:n}}}function LS(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ke||t instanceof Y_||t instanceof Ol||t instanceof hn||t instanceof id||t instanceof J_)}function tv(t,e,n){if(!LS(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=dp(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function Jg(t,e,n){if((e=Ye(e))instanceof fp)return e._internalPath;if(typeof e=="string")return nv(t,e);throw Tf("Field path arguments must be of type string or ",t,!1,void 0,n)}const YM=new RegExp("[~\\*/\\[\\]]");function nv(t,e,n){if(e.search(YM)>=0)throw Tf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new fp(...e.split("."))._internalPath}catch{throw Tf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Tf(t,e,n,r,i){const o=r&&!r.isEmpty(),a=i!==void 0;let c=`Function ${e}() called with invalid data`;n&&(c+=" (via `toFirestore()`)"),c+=". ";let h="";return(o||a)&&(h+=" (found",o&&(h+=` in field ${r}`),a&&(h+=` in document ${i}`),h+=")"),new le(J.INVALID_ARGUMENT,c+t+h)}function DS(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MS{constructor(e,n,r,i,o){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new hn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new JM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(yp("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class JM extends MS{data(){return super.data()}}function yp(t,e){return typeof e=="string"?nv(t,e):e instanceof fp?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OS(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new le(J.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class rv{}class iv extends rv{}function sv(t,e,...n){let r=[];e instanceof rv&&r.push(e),r=r.concat(n),function(o){const a=o.filter(h=>h instanceof ov).length,c=o.filter(h=>h instanceof _p).length;if(a>1||a>0&&c>0)throw new le(J.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class _p extends iv{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new _p(e,n,r)}_apply(e){const n=this._parse(e);return FS(e._query,n),new ns(e.firestore,e.converter,Fg(e._query,n))}_parse(e){const n=mp(e.firestore);return function(o,a,c,h,p,y,v){let w;if(p.isKeyField()){if(y==="array-contains"||y==="array-contains-any")throw new le(J.INVALID_ARGUMENT,`Invalid Query. You can't perform '${y}' queries on documentId().`);if(y==="in"||y==="not-in"){Xw(v,y);const S=[];for(const N of v)S.push(Jw(h,o,N));w={arrayValue:{values:S}}}else w=Jw(h,o,v)}else y!=="in"&&y!=="not-in"&&y!=="array-contains-any"||Xw(v,y),w=QM(c,a,v,y==="in"||y==="not-in");return qe.create(p,y,w)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function XM(t,e,n){const r=e,i=yp("where",t);return _p._create(i,r,n)}class ov extends rv{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new ov(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:nt.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,o){let a=i;const c=o.getFlattenedFilters();for(const h of c)FS(a,h),a=Fg(a,h)}(e._query,n),new ns(e.firestore,e.converter,Fg(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class av extends iv{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new av(e,n)}_apply(e){const n=function(i,o,a){if(i.startAt!==null)throw new le(J.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new le(J.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Dc(o,a)}(e._query,this._field,this._direction);return new ns(e.firestore,e.converter,function(i,o){const a=i.explicitOrderBy.concat([o]);return new Hl(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}function VS(t,e="asc"){const n=e,r=yp("orderBy",t);return av._create(r,n)}class lv extends iv{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new lv(e,n,r)}_apply(e){return new ns(e.firestore,e.converter,ff(e._query,this._limit,this._limitType))}}function eO(t){return lv._create("limit",t,"F")}function Jw(t,e,n){if(typeof(n=Ye(n))=="string"){if(n==="")throw new le(J.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!gk(e)&&n.indexOf("/")!==-1)throw new le(J.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(et.fromString(n));if(!ce.isDocumentKey(r))throw new le(J.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return jc(t,new ce(r))}if(n instanceof hn)return jc(t,n._key);throw new le(J.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${dp(n)}.`)}function Xw(t,e){if(!Array.isArray(t)||t.length===0)throw new le(J.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function FS(t,e){const n=function(i,o){for(const a of i)for(const c of a.getFlattenedFilters())if(o.indexOf(c.op)>=0)return c.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new le(J.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new le(J.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class tO{convertValue(e,n="none"){switch(Zo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return mt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(eo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw me()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return ua(e,(i,o)=>{r[i]=this.convertValue(o,n)}),r}convertVectorValue(e){var n,r,i;const o=(i=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(a=>mt(a.doubleValue));return new J_(o)}convertGeoPoint(e){return new Y_(mt(e.latitude),mt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=v_(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Cc(e));default:return null}}convertTimestamp(e){const n=Qi(e);return new Ke(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=et.fromString(e);_e($k(r));const i=new Ko(r.get(1),r.get(3)),o=new ce(r.popFirst(5));return i.isEqual(n)||Dt(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function US(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qu{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class BS extends MS{constructor(e,n,r,i,o,a){super(e,n,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new kh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(yp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class kh extends BS{data(e={}){return super.data(e)}}class zS{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new qu(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new kh(this._firestore,this._userDataWriter,r.key,r,new qu(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new le(J.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(c=>{const h=new kh(i._firestore,i._userDataWriter,c.doc.key,c.doc,new qu(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:h,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(c=>o||c.type!==3).map(c=>{const h=new kh(i._firestore,i._userDataWriter,c.doc.key,c.doc,new qu(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);let p=-1,y=-1;return c.type!==0&&(p=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),y=a.indexOf(c.doc.key)),{type:nO(c.type),doc:h,oldIndex:p,newIndex:y}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function nO(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return me()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ol(t){t=er(t,hn);const e=er(t.firestore,Yi);return FM(hp(e),t._key).then(n=>$S(e,t,n))}class uv extends tO{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ol(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new hn(this.firestore,null,n)}}function Au(t){t=er(t,ns);const e=er(t.firestore,Yi),n=hp(e),r=new uv(e);return OS(t._query),UM(n,t._query).then(i=>new zS(e,r,t,i))}function qi(t,e,n){t=er(t,hn);const r=er(t.firestore,Yi),i=US(t.converter,e,n);return xp(r,[RS(mp(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,cn.none())])}function If(t,e,n,...r){t=er(t,hn);const i=er(t.firestore,Yi),o=mp(i);let a;return a=typeof(e=Ye(e))=="string"||e instanceof fp?ZM(o,"updateDoc",t._key,e,n,r):KM(o,"updateDoc",t._key,e),xp(i,[a.toMutation(t._key,cn.exists(!0))])}function qS(t){return xp(er(t.firestore,Yi),[new rp(t._key,cn.none())])}function vp(t,e){const n=er(t.firestore,Yi),r=Et(t),i=US(t.converter,e);return xp(n,[RS(mp(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,cn.exists(!1))]).then(()=>r)}function Fs(t,...e){var n,r,i;t=Ye(t);let o={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||Yw(e[a])||(o=e[a],a++);const c={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(Yw(e[a])){const v=e[a];e[a]=(n=v.next)===null||n===void 0?void 0:n.bind(v),e[a+1]=(r=v.error)===null||r===void 0?void 0:r.bind(v),e[a+2]=(i=v.complete)===null||i===void 0?void 0:i.bind(v)}let h,p,y;if(t instanceof hn)p=er(t.firestore,Yi),y=Xc(t._key.path),h={next:v=>{e[a]&&e[a]($S(p,t,v))},error:e[a+1],complete:e[a+2]};else{const v=er(t,ns);p=er(v.firestore,Yi),y=v._query;const w=new uv(p);h={next:S=>{e[a]&&e[a](new zS(p,w,v,S))},error:e[a+1],complete:e[a+2]},OS(t._query)}return function(w,S,N,A){const U=new Z_(A),j=new q_(S,U,N);return w.asyncQueue.enqueueAndForget(async()=>U_(await Ef(w),j)),()=>{U.Za(),w.asyncQueue.enqueueAndForget(async()=>B_(await Ef(w),j))}}(hp(p),y,c,h)}function xp(t,e){return function(r,i){const o=new pi;return r.asyncQueue.enqueueAndForget(async()=>wM(await VM(r),i,o)),o.promise}(hp(t),e)}function $S(t,e,n){const r=n.docs.get(e._key),i=new uv(t);return new BS(t,i,e._key,r,new qu(n.hasPendingWrites,n.fromCache),e.converter)}class rO{constructor(e){let n;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),n=e.tabManager):(n=aO(),n._initialize(e)),this._onlineComponentProvider=n._onlineComponentProvider,this._offlineComponentProvider=n._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function iO(t){return new rO(t)}class sO{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Vc.provider,this._offlineComponentProvider={build:n=>new kS(n,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class oO{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Vc.provider,this._offlineComponentProvider={build:n=>new DM(n,e==null?void 0:e.cacheSizeBytes)}}}function aO(t){return new sO(void 0)}function lO(){return new oO}function HS(){return new X_("serverTimestamp")}function uO(...t){return new ev("arrayRemove",t)}(function(e,n=!0){(function(i){$l=i})(la),br(new nr("firestore",(r,{instanceIdentifier:i,options:o})=>{const a=r.getProvider("app").getImmediate(),c=new Yi(new Hj(r.getProvider("auth-internal")),new Zj(r.getProvider("app-check-internal")),function(p,y){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new le(J.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ko(p.options.projectId,y)}(a,i),a);return o=Object.assign({useFetchStreams:n},o),c._setSettings(o),c},"PUBLIC").setMultipleInstances(!0)),dn(Hx,"4.7.3",e),dn(Hx,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cO="type.googleapis.com/google.protobuf.Int64Value",dO="type.googleapis.com/google.protobuf.UInt64Value";function WS(t,e){const n={};for(const r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}function Xg(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>Xg(e));if(typeof t=="function"||typeof t=="object")return WS(t,e=>Xg(e));throw new Error("Data cannot be encoded in JSON: "+t)}function kf(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case cO:case dO:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>kf(e)):typeof t=="function"||typeof t=="object"?WS(t,e=>kf(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cv="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eb={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class yl extends Tr{constructor(e,n,r){super(`${cv}/${e}`,n||""),this.details=r}}function hO(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function fO(t,e){let n=hO(t),r=n,i;try{const o=e&&e.error;if(o){const a=o.status;if(typeof a=="string"){if(!eb[a])return new yl("internal","internal");n=eb[a],r=a}const c=o.message;typeof c=="string"&&(r=c),i=o.details,i!==void 0&&(i=kf(i))}}catch{}return n==="ok"?null:new yl(n,r,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pO{constructor(e,n,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(i=>this.auth=i,()=>{}),this.messaging||n.get().then(i=>this.messaging=i,()=>{}),this.appCheck||r.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),i=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:i}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ey="us-central1";function mO(t){let e=null;return{promise:new Promise((n,r)=>{e=setTimeout(()=>{r(new yl("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class gO{constructor(e,n,r,i,o=ey,a){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new pO(n,r,i),this.cancelAllRequests=new Promise(c=>{this.deleteService=()=>Promise.resolve(c())});try{const c=new URL(o);this.customDomain=c.origin+(c.pathname==="/"?"":c.pathname),this.region=ey}catch{this.customDomain=null,this.region=o}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function yO(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}function _O(t,e,n){return r=>xO(t,e,r,{})}async function vO(t,e,n,r){n["Content-Type"]="application/json";let i;try{i=await r(t,{method:"POST",body:JSON.stringify(e),headers:n})}catch{return{status:0,json:null}}let o=null;try{o=await i.json()}catch{}return{status:i.status,json:o}}function xO(t,e,n,r){const i=t._url(e);return wO(t,i,n,r)}async function wO(t,e,n,r){n=Xg(n);const i={data:n},o={},a=await t.contextProvider.getContext(r.limitedUseAppCheckTokens);a.authToken&&(o.Authorization="Bearer "+a.authToken),a.messagingToken&&(o["Firebase-Instance-ID-Token"]=a.messagingToken),a.appCheckToken!==null&&(o["X-Firebase-AppCheck"]=a.appCheckToken);const c=r.timeout||7e4,h=mO(c),p=await Promise.race([vO(e,i,o,t.fetchImpl),h.promise,t.cancelAllRequests]);if(h.cancel(),!p)throw new yl("cancelled","Firebase Functions instance was deleted.");const y=fO(p.status,p.json);if(y)throw y;if(!p.json)throw new yl("internal","Response is not valid JSON object.");let v=p.json.data;if(typeof v>"u"&&(v=p.json.result),typeof v>"u")throw new yl("internal","Response is missing data field.");return{data:kf(v)}}const tb="@firebase/functions",nb="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bO="auth-internal",EO="app-check-internal",TO="messaging-internal";function IO(t,e){const n=(r,{instanceIdentifier:i})=>{const o=r.getProvider("app").getImmediate(),a=r.getProvider(bO),c=r.getProvider(TO),h=r.getProvider(EO);return new gO(o,a,c,h,i,t)};br(new nr(cv,n,"PUBLIC").setMultipleInstances(!0)),dn(tb,nb,e),dn(tb,nb,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function si(t=Gf(),e=ey){const r=oo(Ye(t),cv).getImmediate({identifier:e}),i=WT("functions");return i&&kO(r,...i),r}function kO(t,e,n){yO(Ye(t),e,n)}function oi(t,e,n){return _O(Ye(t),e)}IO(fetch.bind(self));var SO="firebase",PO="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */dn(SO,PO,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GS="firebasestorage.googleapis.com",KS="storageBucket",AO=2*60*1e3,NO=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt extends Tr{constructor(e,n,r=0){super(bm(e),`Firebase Storage: ${n} (${bm(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Rt.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return bm(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ct;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ct||(Ct={}));function bm(t){return"storage/"+t}function dv(){const t="An unknown error occurred, please check the error payload for server response.";return new Rt(Ct.UNKNOWN,t)}function CO(t){return new Rt(Ct.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function RO(t){return new Rt(Ct.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function jO(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Rt(Ct.UNAUTHENTICATED,t)}function LO(){return new Rt(Ct.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function DO(t){return new Rt(Ct.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function MO(){return new Rt(Ct.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function OO(){return new Rt(Ct.CANCELED,"User canceled the upload/download.")}function VO(t){return new Rt(Ct.INVALID_URL,"Invalid URL '"+t+"'.")}function FO(t){return new Rt(Ct.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function UO(){return new Rt(Ct.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+KS+"' property when initializing the app?")}function BO(){return new Rt(Ct.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function zO(){return new Rt(Ct.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function qO(t){return new Rt(Ct.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function ty(t){return new Rt(Ct.INVALID_ARGUMENT,t)}function ZS(){return new Rt(Ct.APP_DELETED,"The Firebase app was deleted.")}function $O(t){return new Rt(Ct.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function oc(t,e){return new Rt(Ct.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function Nu(t){throw new Rt(Ct.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Yn.makeFromUrl(e,n)}catch{return new Yn(e,"")}if(r.path==="")return r;throw FO(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)";function o(z){z.path.charAt(z.path.length-1)==="/"&&(z.path_=z.path_.slice(0,-1))}const a="(/(.*))?$",c=new RegExp("^gs://"+i+a,"i"),h={bucket:1,path:3};function p(z){z.path_=decodeURIComponent(z.path)}const y="v[A-Za-z0-9_]+",v=n.replace(/[.]/g,"\\."),w="(/([^?#]*).*)?$",S=new RegExp(`^https?://${v}/${y}/b/${i}/o${w}`,"i"),N={bucket:1,path:3},A=n===GS?"(?:storage.googleapis.com|storage.cloud.google.com)":n,U="([^?#]*)",j=new RegExp(`^https?://${A}/${i}/${U}`,"i"),R=[{regex:c,indices:h,postModify:o},{regex:S,indices:N,postModify:p},{regex:j,indices:{bucket:1,path:2},postModify:p}];for(let z=0;z<R.length;z++){const K=R[z],H=K.regex.exec(e);if(H){const T=H[K.indices.bucket];let b=H[K.indices.path];b||(b=""),r=new Yn(T,b),K.postModify(r);break}}if(r==null)throw VO(e);return r}}class HO{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WO(t,e,n){let r=1,i=null,o=null,a=!1,c=0;function h(){return c===2}let p=!1;function y(...U){p||(p=!0,e.apply(null,U))}function v(U){i=setTimeout(()=>{i=null,t(S,h())},U)}function w(){o&&clearTimeout(o)}function S(U,...j){if(p){w();return}if(U){w(),y.call(null,U,...j);return}if(h()||a){w(),y.call(null,U,...j);return}r<64&&(r*=2);let R;c===1?(c=2,R=0):R=(r+Math.random())*1e3,v(R)}let N=!1;function A(U){N||(N=!0,w(),!p&&(i!==null?(U||(c=2),clearTimeout(i),v(0)):U||(c=1)))}return v(0),o=setTimeout(()=>{a=!0,A(!0)},n),A}function GO(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KO(t){return t!==void 0}function ZO(t){return typeof t=="object"&&!Array.isArray(t)}function hv(t){return typeof t=="string"||t instanceof String}function rb(t){return fv()&&t instanceof Blob}function fv(){return typeof Blob<"u"}function ib(t,e,n,r){if(r<e)throw ty(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw ty(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wp(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function QS(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var Fo;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Fo||(Fo={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QO(t,e){const n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,o=e.indexOf(t)!==-1;return n||i||o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YO{constructor(e,n,r,i,o,a,c,h,p,y,v,w=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=o,this.additionalRetryCodes_=a,this.callback_=c,this.errorCallback_=h,this.timeout_=p,this.progressCallback_=y,this.connectionFactory_=v,this.retry=w,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((S,N)=>{this.resolve_=S,this.reject_=N,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new Qd(!1,null,!0));return}const o=this.connectionFactory_();this.pendingConnection_=o;const a=c=>{const h=c.loaded,p=c.lengthComputable?c.total:-1;this.progressCallback_!==null&&this.progressCallback_(h,p)};this.progressCallback_!==null&&o.addUploadProgressListener(a),o.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&o.removeUploadProgressListener(a),this.pendingConnection_=null;const c=o.getErrorCode()===Fo.NO_ERROR,h=o.getStatus();if(!c||QO(h,this.additionalRetryCodes_)&&this.retry){const y=o.getErrorCode()===Fo.ABORT;r(!1,new Qd(!1,null,y));return}const p=this.successCodes_.indexOf(h)!==-1;r(!0,new Qd(p,o))})},n=(r,i)=>{const o=this.resolve_,a=this.reject_,c=i.connection;if(i.wasSuccessCode)try{const h=this.callback_(c,c.getResponse());KO(h)?o(h):o()}catch(h){a(h)}else if(c!==null){const h=dv();h.serverResponse=c.getErrorText(),this.errorCallback_?a(this.errorCallback_(c,h)):a(h)}else if(i.canceled){const h=this.appDelete_?ZS():OO();a(h)}else{const h=MO();a(h)}};this.canceled_?n(!1,new Qd(!1,null,!0)):this.backoffId_=WO(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&GO(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Qd{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function JO(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function XO(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function e4(t,e){e&&(t["X-Firebase-GMPID"]=e)}function t4(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function n4(t,e,n,r,i,o,a=!0){const c=QS(t.urlParams),h=t.url+c,p=Object.assign({},t.headers);return e4(p,e),JO(p,n),XO(p,o),t4(p,r),new YO(h,t.method,p,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r4(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function i4(...t){const e=r4();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(fv())return new Blob(t);throw new Rt(Ct.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function s4(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o4(t){if(typeof atob>"u")throw qO("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ci={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Em{constructor(e,n){this.data=e,this.contentType=n||null}}function a4(t,e){switch(t){case ci.RAW:return new Em(YS(e));case ci.BASE64:case ci.BASE64URL:return new Em(JS(t,e));case ci.DATA_URL:return new Em(u4(e),c4(e))}throw dv()}function YS(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const o=r,a=t.charCodeAt(++n);r=65536|(o&1023)<<10|a&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function l4(t){let e;try{e=decodeURIComponent(t)}catch{throw oc(ci.DATA_URL,"Malformed data URL.")}return YS(e)}function JS(t,e){switch(t){case ci.BASE64:{const i=e.indexOf("-")!==-1,o=e.indexOf("_")!==-1;if(i||o)throw oc(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case ci.BASE64URL:{const i=e.indexOf("+")!==-1,o=e.indexOf("/")!==-1;if(i||o)throw oc(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=o4(e)}catch(i){throw i.message.includes("polyfill")?i:oc(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}class XS{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw oc(ci.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=d4(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function u4(t){const e=new XS(t);return e.base64?JS(ci.BASE64,e.rest):l4(e.rest)}function c4(t){return new XS(t).contentType}function d4(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ls{constructor(e,n){let r=0,i="";rb(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,n){if(rb(this.data_)){const r=this.data_,i=s4(r,e,n);return i===null?null:new Ls(i)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Ls(r,!0)}}static getBlob(...e){if(fv()){const n=e.map(r=>r instanceof Ls?r.data_:r);return new Ls(i4.apply(null,n))}else{const n=e.map(a=>hv(a)?a4(ci.RAW,a).data:a.data_);let r=0;n.forEach(a=>{r+=a.byteLength});const i=new Uint8Array(r);let o=0;return n.forEach(a=>{for(let c=0;c<a.length;c++)i[o++]=a[c]}),new Ls(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e1(t){let e;try{e=JSON.parse(t)}catch{return null}return ZO(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h4(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function f4(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function t1(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p4(t,e){return e}class xn{constructor(e,n,r,i){this.server=e,this.local=n||e,this.writable=!!r,this.xform=i||p4}}let Yd=null;function m4(t){return!hv(t)||t.length<2?t:t1(t)}function n1(){if(Yd)return Yd;const t=[];t.push(new xn("bucket")),t.push(new xn("generation")),t.push(new xn("metageneration")),t.push(new xn("name","fullPath",!0));function e(o,a){return m4(a)}const n=new xn("name");n.xform=e,t.push(n);function r(o,a){return a!==void 0?Number(a):a}const i=new xn("size");return i.xform=r,t.push(i),t.push(new xn("timeCreated")),t.push(new xn("updated")),t.push(new xn("md5Hash",null,!0)),t.push(new xn("cacheControl",null,!0)),t.push(new xn("contentDisposition",null,!0)),t.push(new xn("contentEncoding",null,!0)),t.push(new xn("contentLanguage",null,!0)),t.push(new xn("contentType",null,!0)),t.push(new xn("metadata","customMetadata",!0)),Yd=t,Yd}function g4(t,e){function n(){const r=t.bucket,i=t.fullPath,o=new Yn(r,i);return e._makeStorageReference(o)}Object.defineProperty(t,"ref",{get:n})}function y4(t,e,n){const r={};r.type="file";const i=n.length;for(let o=0;o<i;o++){const a=n[o];r[a.local]=a.xform(r,e[a.server])}return g4(r,t),r}function r1(t,e,n){const r=e1(e);return r===null?null:y4(t,r,n)}function _4(t,e,n,r){const i=e1(e);if(i===null||!hv(i.downloadTokens))return null;const o=i.downloadTokens;if(o.length===0)return null;const a=encodeURIComponent;return o.split(",").map(p=>{const y=t.bucket,v=t.fullPath,w="/b/"+a(y)+"/o/"+a(v),S=wp(w,n,r),N=QS({alt:"media",token:p});return S+N})[0]}function v4(t,e){const n={},r=e.length;for(let i=0;i<r;i++){const o=e[i];o.writable&&(n[o.server]=t[o.local])}return JSON.stringify(n)}class pv{constructor(e,n,r,i){this.url=e,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i1(t){if(!t)throw dv()}function x4(t,e){function n(r,i){const o=r1(t,i,e);return i1(o!==null),o}return n}function w4(t,e){function n(r,i){const o=r1(t,i,e);return i1(o!==null),_4(o,i,t.host,t._protocol)}return n}function s1(t){function e(n,r){let i;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?i=LO():i=jO():n.getStatus()===402?i=RO(t.bucket):n.getStatus()===403?i=DO(t.path):i=r,i.status=n.getStatus(),i.serverResponse=r.serverResponse,i}return e}function o1(t){const e=s1(t);function n(r,i){let o=e(r,i);return r.getStatus()===404&&(o=CO(t.path)),o.serverResponse=i.serverResponse,o}return n}function b4(t,e,n){const r=e.fullServerUrl(),i=wp(r,t.host,t._protocol),o="GET",a=t.maxOperationRetryTime,c=new pv(i,o,w4(t,n),a);return c.errorHandler=o1(e),c}function E4(t,e){const n=e.fullServerUrl(),r=wp(n,t.host,t._protocol),i="DELETE",o=t.maxOperationRetryTime;function a(h,p){}const c=new pv(r,i,a,o);return c.successCodes=[200,204],c.errorHandler=o1(e),c}function T4(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function I4(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=T4(null,e)),r}function k4(t,e,n,r,i){const o=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};function c(){let R="";for(let z=0;z<2;z++)R=R+Math.random().toString().slice(2);return R}const h=c();a["Content-Type"]="multipart/related; boundary="+h;const p=I4(e,r,i),y=v4(p,n),v="--"+h+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+y+`\r
--`+h+`\r
Content-Type: `+p.contentType+`\r
\r
`,w=`\r
--`+h+"--",S=Ls.getBlob(v,r,w);if(S===null)throw BO();const N={name:p.fullPath},A=wp(o,t.host,t._protocol),U="POST",j=t.maxUploadRetryTime,k=new pv(A,U,x4(t,n),j);return k.urlParams=N,k.headers=a,k.body=S.uploadData(),k.errorHandler=s1(e),k}class S4{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Fo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Fo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Fo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,i){if(this.sent_)throw Nu("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Nu("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Nu("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Nu("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Nu("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class P4 extends S4{initXhr(){this.xhr_.responseType="text"}}function mv(){return new P4}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ta{constructor(e,n){this._service=e,n instanceof Yn?this._location=n:this._location=Yn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new ta(e,n)}get root(){const e=new Yn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return t1(this._location.path)}get storage(){return this._service}get parent(){const e=h4(this._location.path);if(e===null)return null;const n=new Yn(this._location.bucket,e);return new ta(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw $O(e)}}function A4(t,e,n){t._throwIfRoot("uploadBytes");const r=k4(t.storage,t._location,n1(),new Ls(e,!0),n);return t.storage.makeRequestWithTokens(r,mv).then(i=>({metadata:i,ref:t}))}function N4(t){t._throwIfRoot("getDownloadURL");const e=b4(t.storage,t._location,n1());return t.storage.makeRequestWithTokens(e,mv).then(n=>{if(n===null)throw zO();return n})}function C4(t){t._throwIfRoot("deleteObject");const e=E4(t.storage,t._location);return t.storage.makeRequestWithTokens(e,mv)}function R4(t,e){const n=f4(t._location.path,e),r=new Yn(t._location.bucket,n);return new ta(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j4(t){return/^[A-Za-z]+:\/\//.test(t)}function L4(t,e){return new ta(t,e)}function a1(t,e){if(t instanceof gv){const n=t;if(n._bucket==null)throw UO();const r=new ta(n,n._bucket);return e!=null?a1(r,e):r}else return e!==void 0?R4(t,e):t}function D4(t,e){if(e&&j4(e)){if(t instanceof gv)return L4(t,e);throw ty("To use ref(service, url), the first argument must be a Storage instance.")}else return a1(t,e)}function sb(t,e){const n=e==null?void 0:e[KS];return n==null?null:Yn.makeFromBucketSpec(n,t)}function M4(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:oC(i,t.app.options.projectId))}class gv{constructor(e,n,r,i,o){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=o,this._bucket=null,this._host=GS,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=AO,this._maxUploadRetryTime=NO,this._requests=new Set,i!=null?this._bucket=Yn.makeFromBucketSpec(i,this._host):this._bucket=sb(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Yn.makeFromBucketSpec(this._url,e):this._bucket=sb(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){ib("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){ib("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ta(this,e)}_makeRequest(e,n,r,i,o=!0){if(this._deleted)return new HO(ZS());{const a=n4(e,this._appId,r,i,n,this._firebaseVersion,o);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,n){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()}}const ob="@firebase/storage",ab="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l1="storage";function bp(t,e,n){return t=Ye(t),A4(t,e,n)}function Ep(t){return t=Ye(t),N4(t)}function u1(t){return t=Ye(t),C4(t)}function Vl(t,e){return t=Ye(t),D4(t,e)}function O4(t=Gf(),e){t=Ye(t);const r=oo(t,l1).getImmediate({identifier:e}),i=WT("storage");return i&&V4(r,...i),r}function V4(t,e,n,r={}){M4(t,e,n,r)}function F4(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new gv(n,r,i,e,la)}function U4(){br(new nr(l1,F4,"PUBLIC").setMultipleInstances(!0)),dn(ob,ab,""),dn(ob,ab,"esm2017")}U4();const c1="@firebase/installations",yv="0.6.9";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d1=1e4,h1=`w:${yv}`,f1="FIS_v2",B4="https://firebaseinstallations.googleapis.com/v1",z4=60*60*1e3,q4="installations",$4="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H4={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},na=new aa(q4,$4,H4);function p1(t){return t instanceof Tr&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m1({projectId:t}){return`${B4}/projects/${t}/installations`}function g1(t){return{token:t.token,requestStatus:2,expiresIn:G4(t.expiresIn),creationTime:Date.now()}}async function y1(t,e){const r=(await e.json()).error;return na.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function _1({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function W4(t,{refreshToken:e}){const n=_1(t);return n.append("Authorization",K4(e)),n}async function v1(t){const e=await t();return e.status>=500&&e.status<600?t():e}function G4(t){return Number(t.replace("s","000"))}function K4(t){return`${f1} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Z4({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=m1(t),i=_1(t),o=e.getImmediate({optional:!0});if(o){const p=await o.getHeartbeatsHeader();p&&i.append("x-firebase-client",p)}const a={fid:n,authVersion:f1,appId:t.appId,sdkVersion:h1},c={method:"POST",headers:i,body:JSON.stringify(a)},h=await v1(()=>fetch(r,c));if(h.ok){const p=await h.json();return{fid:p.fid||n,registrationStatus:2,refreshToken:p.refreshToken,authToken:g1(p.authToken)}}else throw await y1("Create Installation",h)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x1(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q4(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y4=/^[cdef][\w-]{21}$/,ny="";function J4(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=X4(t);return Y4.test(n)?n:ny}catch{return ny}}function X4(t){return Q4(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tp(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w1=new Map;function b1(t,e){const n=Tp(t);E1(n,e),eV(n,e)}function E1(t,e){const n=w1.get(t);if(n)for(const r of n)r(e)}function eV(t,e){const n=tV();n&&n.postMessage({key:t,fid:e}),nV()}let Lo=null;function tV(){return!Lo&&"BroadcastChannel"in self&&(Lo=new BroadcastChannel("[Firebase] FID Change"),Lo.onmessage=t=>{E1(t.data.key,t.data.fid)}),Lo}function nV(){w1.size===0&&Lo&&(Lo.close(),Lo=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rV="firebase-installations-database",iV=1,ra="firebase-installations-store";let Tm=null;function _v(){return Tm||(Tm=Wf(rV,iV,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(ra)}}})),Tm}async function Sf(t,e){const n=Tp(t),i=(await _v()).transaction(ra,"readwrite"),o=i.objectStore(ra),a=await o.get(n);return await o.put(e,n),await i.done,(!a||a.fid!==e.fid)&&b1(t,e.fid),e}async function T1(t){const e=Tp(t),r=(await _v()).transaction(ra,"readwrite");await r.objectStore(ra).delete(e),await r.done}async function Ip(t,e){const n=Tp(t),i=(await _v()).transaction(ra,"readwrite"),o=i.objectStore(ra),a=await o.get(n),c=e(a);return c===void 0?await o.delete(n):await o.put(c,n),await i.done,c&&(!a||a.fid!==c.fid)&&b1(t,c.fid),c}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vv(t){let e;const n=await Ip(t.appConfig,r=>{const i=sV(r),o=oV(t,i);return e=o.registrationPromise,o.installationEntry});return n.fid===ny?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function sV(t){const e=t||{fid:J4(),registrationStatus:0};return I1(e)}function oV(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(na.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=aV(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:lV(t)}:{installationEntry:e}}async function aV(t,e){try{const n=await Z4(t,e);return Sf(t.appConfig,n)}catch(n){throw p1(n)&&n.customData.serverCode===409?await T1(t.appConfig):await Sf(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function lV(t){let e=await lb(t.appConfig);for(;e.registrationStatus===1;)await x1(100),e=await lb(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await vv(t);return r||n}return e}function lb(t){return Ip(t,e=>{if(!e)throw na.create("installation-not-found");return I1(e)})}function I1(t){return uV(t)?{fid:t.fid,registrationStatus:0}:t}function uV(t){return t.registrationStatus===1&&t.registrationTime+d1<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cV({appConfig:t,heartbeatServiceProvider:e},n){const r=dV(t,n),i=W4(t,n),o=e.getImmediate({optional:!0});if(o){const p=await o.getHeartbeatsHeader();p&&i.append("x-firebase-client",p)}const a={installation:{sdkVersion:h1,appId:t.appId}},c={method:"POST",headers:i,body:JSON.stringify(a)},h=await v1(()=>fetch(r,c));if(h.ok){const p=await h.json();return g1(p)}else throw await y1("Generate Auth Token",h)}function dV(t,{fid:e}){return`${m1(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xv(t,e=!1){let n;const r=await Ip(t.appConfig,o=>{if(!k1(o))throw na.create("not-registered");const a=o.authToken;if(!e&&pV(a))return o;if(a.requestStatus===1)return n=hV(t,e),o;{if(!navigator.onLine)throw na.create("app-offline");const c=gV(o);return n=fV(t,c),c}});return n?await n:r.authToken}async function hV(t,e){let n=await ub(t.appConfig);for(;n.authToken.requestStatus===1;)await x1(100),n=await ub(t.appConfig);const r=n.authToken;return r.requestStatus===0?xv(t,e):r}function ub(t){return Ip(t,e=>{if(!k1(e))throw na.create("not-registered");const n=e.authToken;return yV(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function fV(t,e){try{const n=await cV(t,e),r=Object.assign(Object.assign({},e),{authToken:n});return await Sf(t.appConfig,r),n}catch(n){if(p1(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await T1(t.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Sf(t.appConfig,r)}throw n}}function k1(t){return t!==void 0&&t.registrationStatus===2}function pV(t){return t.requestStatus===2&&!mV(t)}function mV(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+z4}function gV(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function yV(t){return t.requestStatus===1&&t.requestTime+d1<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _V(t){const e=t,{installationEntry:n,registrationPromise:r}=await vv(e);return r?r.catch(console.error):xv(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vV(t,e=!1){const n=t;return await xV(n),(await xv(n,e)).token}async function xV(t){const{registrationPromise:e}=await vv(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wV(t){if(!t||!t.options)throw Im("App Configuration");if(!t.name)throw Im("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Im(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Im(t){return na.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S1="installations",bV="installations-internal",EV=t=>{const e=t.getProvider("app").getImmediate(),n=wV(e),r=oo(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},TV=t=>{const e=t.getProvider("app").getImmediate(),n=oo(e,S1).getImmediate();return{getId:()=>_V(n),getToken:i=>vV(n,i)}};function IV(){br(new nr(S1,EV,"PUBLIC")),br(new nr(bV,TV,"PRIVATE"))}IV();dn(c1,yv);dn(c1,yv,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kV="/firebase-messaging-sw.js",SV="/firebase-cloud-messaging-push-scope",P1="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",PV="https://fcmregistrations.googleapis.com/v1",A1="google.c.a.c_id",AV="google.c.a.c_l",NV="google.c.a.ts",CV="google.c.a.e";var cb;(function(t){t[t.DATA_MESSAGE=1]="DATA_MESSAGE",t[t.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(cb||(cb={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var Fc;(function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"})(Fc||(Fc={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ai(t){const e=new Uint8Array(t);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function RV(t){const e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(n),i=new Uint8Array(r.length);for(let o=0;o<r.length;++o)i[o]=r.charCodeAt(o);return i}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const km="fcm_token_details_db",jV=5,db="fcm_token_object_Store";async function LV(t){if("databases"in indexedDB&&!(await indexedDB.databases()).map(o=>o.name).includes(km))return null;let e=null;return(await Wf(km,jV,{upgrade:async(r,i,o,a)=>{var c;if(i<2||!r.objectStoreNames.contains(db))return;const h=a.objectStore(db),p=await h.index("fcmSenderId").get(t);if(await h.clear(),!!p){if(i===2){const y=p;if(!y.auth||!y.p256dh||!y.endpoint)return;e={token:y.fcmToken,createTime:(c=y.createTime)!==null&&c!==void 0?c:Date.now(),subscriptionOptions:{auth:y.auth,p256dh:y.p256dh,endpoint:y.endpoint,swScope:y.swScope,vapidKey:typeof y.vapidKey=="string"?y.vapidKey:Ai(y.vapidKey)}}}else if(i===3){const y=p;e={token:y.fcmToken,createTime:y.createTime,subscriptionOptions:{auth:Ai(y.auth),p256dh:Ai(y.p256dh),endpoint:y.endpoint,swScope:y.swScope,vapidKey:Ai(y.vapidKey)}}}else if(i===4){const y=p;e={token:y.fcmToken,createTime:y.createTime,subscriptionOptions:{auth:Ai(y.auth),p256dh:Ai(y.p256dh),endpoint:y.endpoint,swScope:y.swScope,vapidKey:Ai(y.vapidKey)}}}}}})).close(),await dm(km),await dm("fcm_vapid_details_db"),await dm("undefined"),DV(e)?e:null}function DV(t){if(!t||!t.subscriptionOptions)return!1;const{subscriptionOptions:e}=t;return typeof t.createTime=="number"&&t.createTime>0&&typeof t.token=="string"&&t.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MV="firebase-messaging-database",OV=1,Uc="firebase-messaging-store";let Sm=null;function N1(){return Sm||(Sm=Wf(MV,OV,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Uc)}}})),Sm}async function VV(t){const e=C1(t),r=await(await N1()).transaction(Uc).objectStore(Uc).get(e);if(r)return r;{const i=await LV(t.appConfig.senderId);if(i)return await wv(t,i),i}}async function wv(t,e){const n=C1(t),i=(await N1()).transaction(Uc,"readwrite");return await i.objectStore(Uc).put(e,n),await i.done,e}function C1({appConfig:t}){return t.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FV={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},fn=new aa("messaging","Messaging",FV);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UV(t,e){const n=await Ev(t),r=R1(e),i={method:"POST",headers:n,body:JSON.stringify(r)};let o;try{o=await(await fetch(bv(t.appConfig),i)).json()}catch(a){throw fn.create("token-subscribe-failed",{errorInfo:a==null?void 0:a.toString()})}if(o.error){const a=o.error.message;throw fn.create("token-subscribe-failed",{errorInfo:a})}if(!o.token)throw fn.create("token-subscribe-no-token");return o.token}async function BV(t,e){const n=await Ev(t),r=R1(e.subscriptionOptions),i={method:"PATCH",headers:n,body:JSON.stringify(r)};let o;try{o=await(await fetch(`${bv(t.appConfig)}/${e.token}`,i)).json()}catch(a){throw fn.create("token-update-failed",{errorInfo:a==null?void 0:a.toString()})}if(o.error){const a=o.error.message;throw fn.create("token-update-failed",{errorInfo:a})}if(!o.token)throw fn.create("token-update-no-token");return o.token}async function zV(t,e){const r={method:"DELETE",headers:await Ev(t)};try{const o=await(await fetch(`${bv(t.appConfig)}/${e}`,r)).json();if(o.error){const a=o.error.message;throw fn.create("token-unsubscribe-failed",{errorInfo:a})}}catch(i){throw fn.create("token-unsubscribe-failed",{errorInfo:i==null?void 0:i.toString()})}}function bv({projectId:t}){return`${PV}/projects/${t}/registrations`}async function Ev({appConfig:t,installations:e}){const n=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function R1({p256dh:t,auth:e,endpoint:n,vapidKey:r}){const i={web:{endpoint:n,auth:e,p256dh:t}};return r!==P1&&(i.web.applicationPubKey=r),i}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qV=7*24*60*60*1e3;async function $V(t){const e=await WV(t.swRegistration,t.vapidKey),n={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:e.endpoint,auth:Ai(e.getKey("auth")),p256dh:Ai(e.getKey("p256dh"))},r=await VV(t.firebaseDependencies);if(r){if(GV(r.subscriptionOptions,n))return Date.now()>=r.createTime+qV?HV(t,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await zV(t.firebaseDependencies,r.token)}catch(i){console.warn(i)}return hb(t.firebaseDependencies,n)}else return hb(t.firebaseDependencies,n)}async function HV(t,e){try{const n=await BV(t.firebaseDependencies,e),r=Object.assign(Object.assign({},e),{token:n,createTime:Date.now()});return await wv(t.firebaseDependencies,r),n}catch(n){throw n}}async function hb(t,e){const r={token:await UV(t,e),createTime:Date.now(),subscriptionOptions:e};return await wv(t,r),r.token}async function WV(t,e){const n=await t.pushManager.getSubscription();return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:RV(e)})}function GV(t,e){const n=e.vapidKey===t.vapidKey,r=e.endpoint===t.endpoint,i=e.auth===t.auth,o=e.p256dh===t.p256dh;return n&&r&&i&&o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fb(t){const e={from:t.from,collapseKey:t.collapse_key,messageId:t.fcmMessageId};return KV(e,t),ZV(e,t),QV(e,t),e}function KV(t,e){if(!e.notification)return;t.notification={};const n=e.notification.title;n&&(t.notification.title=n);const r=e.notification.body;r&&(t.notification.body=r);const i=e.notification.image;i&&(t.notification.image=i);const o=e.notification.icon;o&&(t.notification.icon=o)}function ZV(t,e){e.data&&(t.data=e.data)}function QV(t,e){var n,r,i,o,a;if(!e.fcmOptions&&!(!((n=e.notification)===null||n===void 0)&&n.click_action))return;t.fcmOptions={};const c=(i=(r=e.fcmOptions)===null||r===void 0?void 0:r.link)!==null&&i!==void 0?i:(o=e.notification)===null||o===void 0?void 0:o.click_action;c&&(t.fcmOptions.link=c);const h=(a=e.fcmOptions)===null||a===void 0?void 0:a.analytics_label;h&&(t.fcmOptions.analyticsLabel=h)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YV(t){return typeof t=="object"&&!!t&&A1 in t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JV(t){if(!t||!t.options)throw Pm("App Configuration Object");if(!t.name)throw Pm("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:n}=t;for(const r of e)if(!n[r])throw Pm(r);return{appName:t.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}function Pm(t){return fn.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XV{constructor(e,n,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const i=JV(e);this.firebaseDependencies={app:e,appConfig:i,installations:n,analyticsProvider:r}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e5(t){try{t.swRegistration=await navigator.serviceWorker.register(kV,{scope:SV}),t.swRegistration.update().catch(()=>{})}catch(e){throw fn.create("failed-service-worker-registration",{browserErrorMessage:e==null?void 0:e.message})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t5(t,e){if(!e&&!t.swRegistration&&await e5(t),!(!e&&t.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw fn.create("invalid-sw-registration");t.swRegistration=e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function n5(t,e){e?t.vapidKey=e:t.vapidKey||(t.vapidKey=P1)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function j1(t,e){if(!navigator)throw fn.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw fn.create("permission-blocked");return await n5(t,e==null?void 0:e.vapidKey),await t5(t,e==null?void 0:e.serviceWorkerRegistration),$V(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function r5(t,e,n){const r=i5(e);(await t.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:n[A1],message_name:n[AV],message_time:n[NV],message_device_time:Math.floor(Date.now()/1e3)})}function i5(t){switch(t){case Fc.NOTIFICATION_CLICKED:return"notification_open";case Fc.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function s5(t,e){const n=e.data;if(!n.isFirebaseMessaging)return;t.onMessageHandler&&n.messageType===Fc.PUSH_RECEIVED&&(typeof t.onMessageHandler=="function"?t.onMessageHandler(fb(n)):t.onMessageHandler.next(fb(n)));const r=n.data;YV(r)&&r[CV]==="1"&&await r5(t,n.messageType,r)}const pb="@firebase/messaging",mb="0.12.12";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o5=t=>{const e=new XV(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),t.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",n=>s5(e,n)),e},a5=t=>{const e=t.getProvider("messaging").getImmediate();return{getToken:r=>j1(e,r)}};function l5(){br(new nr("messaging",o5,"PUBLIC")),br(new nr("messaging-internal",a5,"PRIVATE")),dn(pb,mb),dn(pb,mb,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function L1(){try{await QT()}catch{return!1}return typeof window<"u"&&e_()&&fC()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u5(t,e){if(!navigator)throw fn.create("only-available-in-window");return t.onMessageHandler=e,()=>{t.onMessageHandler=null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c5(t=Gf()){return L1().then(e=>{if(!e)throw fn.create("unsupported-browser")},e=>{throw fn.create("indexed-db-unsupported")}),oo(Ye(t),"messaging").getImmediate()}async function d5(t,e){return t=Ye(t),j1(t,e)}function gb(t,e){return t=Ye(t),u5(t,e)}l5();const h5={apiKey:"AIzaSyCWp0X6bLJBsyYKTjUaVsXBSuVD8KeeEqY",authDomain:"carnival-planner.firebaseapp.com",projectId:"carnival-planner",storageBucket:"carnival-planner.firebasestorage.app",messagingSenderId:"1036340118282",appId:"1:1036340118282:web:809dc12c298ff1b8f2f0f3",measurementId:"G-XC1K69PSVC"},jn=XT(h5),Us=Bj(jn),ze=zM(jn,{localCache:iO({tabManager:lO()})},"squad-db"),Fl=O4(jn);Promise.resolve(!0);console.log("Firestore initialized");let Fi=null;const Tv=async()=>{try{return await L1()?(Fi=c5(jn),console.log("Firebase Messaging initialized"),Fi):(console.log("Firebase Messaging not supported in this browser"),null)}catch(t){return console.log("Error initializing Firebase Messaging:",t),null}},f5=async t=>{try{if(await Notification.requestPermission()!=="granted")return console.log("Notification permission denied"),null;if(Fi||await Tv(),!Fi)return null;const n=await d5(Fi,{vapidKey:t});return console.log("FCM Token:",n),n}catch(e){return console.log("Error getting FCM token:",e),null}},p5=t=>{Fi?gb(Fi,t):Tv().then(()=>{Fi&&gb(Fi,t)})};Tv();const Jd="/assets/carnival-logo-CBA9n7vt.png",Am=[{name:"Sugar Mas (St. Kitts)",date:"2026-01-01"},{name:"St. Croix Carnival",date:"2026-01-03"},{name:"Carnaval Ponceno (Puerto Rico)",date:"2026-02-12"},{name:"Aruba Carnival",date:"2026-02-14"},{name:"Barranquilla Carnival (Colombia)",date:"2026-02-14"},{name:"Martinique Carnival",date:"2026-02-15"},{name:"Rio Carnival (Brazil)",date:"2026-02-15"},{name:"Carnaval De Saint-Martin",date:"2026-02-15"},{name:"Mas Domnik (Dominica)",date:"2026-02-16"},{name:"Carriacou & Petite Martinique",date:"2026-02-16"},{name:"Venezuela Carnival",date:"2026-02-16"},{name:"Trinidad Carnival",date:"2026-02-16"},{name:"Guyana Mashramani",date:"2026-02-23"},{name:"Carnaval De San Pedro (Belize)",date:"2026-02-23"},{name:"Cape Town Carnival (South Africa)",date:"2026-03-21"},{name:"Virgin Gorda Easter Festival",date:"2026-04-05"},{name:"Jamaica Carnival",date:"2026-04-12"},{name:"Tampa Bay Carnival (USA)",date:"2026-04-18"},{name:"St. Maarten Carnival",date:"2026-04-30"},{name:"St. Thomas Carnival (USVI)",date:"2026-05-02"},{name:"Cayman Carnival Batabano",date:"2026-05-09"},{name:"Braccanal (Cayman Islands)",date:"2026-05-13"},{name:"Berlin Carnival (Germany)",date:"2026-05-22"},{name:"Atlanta Caribbean Carnival",date:"2026-05-23"},{name:"Aalborg Karneval (Denmark)",date:"2026-05-23"},{name:"Orlando Carnival",date:"2026-05-24"},{name:"Luton International Carnival (UK)",date:"2026-05-24"},{name:"Guyana Independence",date:"2026-05-26"},{name:"Munich Carnival (Germany)",date:"2026-06-04"},{name:"Bahamas Carnival",date:"2026-06-06"},{name:"South Carolina Carnival",date:"2026-06-11"},{name:"Bermuda Carnival",date:"2026-06-15"},{name:"Hollywood Carnival (USA)",date:"2026-06-20"},{name:"Caymas Carnival (Cayman Islands)",date:"2026-06-20"},{name:"Philadelphia Carnival",date:"2026-06-20"},{name:"Vienna Carnival (Austria)",date:"2026-06-26"},{name:"Vincy Mas (St. Vincent)",date:"2026-07-06"},{name:"Saint Lucia Carnival",date:"2026-07-20"},{name:"Anguilla Summer Festival",date:"2026-07-24"},{name:"Zomercarnaval (Rotterdam)",date:"2026-07-25"},{name:"Toronto Caribbean Carnival (Caribana)",date:"2026-08-01"},{name:"Crop Over (Barbados)",date:"2026-08-03"},{name:"Antigua Carnival",date:"2026-08-03"},{name:"Nevis Culturama Festival",date:"2026-08-04"},{name:"Cariwest (Canada)",date:"2026-08-07"},{name:"Spice Mas (Grenada)",date:"2026-08-10"},{name:"Notting Hill Carnival (London)",date:"2026-08-31"},{name:"New York Carnival (Labor Day)",date:"2026-09-07"},{name:"Japan Caribbean Carnival",date:"2026-09-23"},{name:"Miami Carnival",date:"2026-10-11"},{name:"Tobago Carnival",date:"2026-11-01"}];function D1(t,e){const n=B.useRef(e);B.useEffect(function(){e!==n.current&&t.attributionControl!=null&&(n.current!=null&&t.attributionControl.removeAttribution(n.current),e!=null&&t.attributionControl.addAttribution(e)),n.current=e},[t,e])}const m5=1;function g5(t){return Object.freeze({__version:m5,map:t})}function y5(t,e){return Object.freeze({...t,...e})}const M1=B.createContext(null),O1=M1.Provider;function Iv(){const t=B.useContext(M1);if(t==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return t}function _5(t){function e(n,r){const{instance:i,context:o}=t(n).current;return B.useImperativeHandle(r,()=>i),n.children==null?null:Nh.createElement(O1,{value:o},n.children)}return B.forwardRef(e)}function v5(t){function e(n,r){const[i,o]=B.useState(!1),{instance:a}=t(n,o).current;B.useImperativeHandle(r,()=>a),B.useEffect(function(){i&&a.update()},[a,i,n.children]);const c=a._contentNode;return c?BT.createPortal(n.children,c):null}return B.forwardRef(e)}function x5(t){function e(n,r){const{instance:i}=t(n).current;return B.useImperativeHandle(r,()=>i),null}return B.forwardRef(e)}function V1(t,e){const n=B.useRef();B.useEffect(function(){return e!=null&&t.instance.on(e),n.current=e,function(){n.current!=null&&t.instance.off(n.current),n.current=null}},[t,e])}function kv(t,e){const n=t.pane??e.pane;return n?{...t,pane:n}:t}function w5(t,e){return function(r,i){const o=Iv(),a=t(kv(r,o),o);return D1(o.map,r.attribution),V1(a.current,r.eventHandlers),e(a.current,o,r,i),a}}var ry={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(t,e){(function(n,r){r(e)})(EP,function(n){var r="1.9.4";function i(s){var l,f,m,_;for(f=1,m=arguments.length;f<m;f++){_=arguments[f];for(l in _)s[l]=_[l]}return s}var o=Object.create||function(){function s(){}return function(l){return s.prototype=l,new s}}();function a(s,l){var f=Array.prototype.slice;if(s.bind)return s.bind.apply(s,f.call(arguments,1));var m=f.call(arguments,2);return function(){return s.apply(l,m.length?m.concat(f.call(arguments)):arguments)}}var c=0;function h(s){return"_leaflet_id"in s||(s._leaflet_id=++c),s._leaflet_id}function p(s,l,f){var m,_,E,V;return V=function(){m=!1,_&&(E.apply(f,_),_=!1)},E=function(){m?_=arguments:(s.apply(f,arguments),setTimeout(V,l),m=!0)},E}function y(s,l,f){var m=l[1],_=l[0],E=m-_;return s===m&&f?s:((s-_)%E+E)%E+_}function v(){return!1}function w(s,l){if(l===!1)return s;var f=Math.pow(10,l===void 0?6:l);return Math.round(s*f)/f}function S(s){return s.trim?s.trim():s.replace(/^\s+|\s+$/g,"")}function N(s){return S(s).split(/\s+/)}function A(s,l){Object.prototype.hasOwnProperty.call(s,"options")||(s.options=s.options?o(s.options):{});for(var f in l)s.options[f]=l[f];return s.options}function U(s,l,f){var m=[];for(var _ in s)m.push(encodeURIComponent(f?_.toUpperCase():_)+"="+encodeURIComponent(s[_]));return(!l||l.indexOf("?")===-1?"?":"&")+m.join("&")}var j=/\{ *([\w_ -]+) *\}/g;function k(s,l){return s.replace(j,function(f,m){var _=l[m];if(_===void 0)throw new Error("No value provided for variable "+f);return typeof _=="function"&&(_=_(l)),_})}var R=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"};function z(s,l){for(var f=0;f<s.length;f++)if(s[f]===l)return f;return-1}var K="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function H(s){return window["webkit"+s]||window["moz"+s]||window["ms"+s]}var T=0;function b(s){var l=+new Date,f=Math.max(0,16-(l-T));return T=l+f,window.setTimeout(s,f)}var C=window.requestAnimationFrame||H("RequestAnimationFrame")||b,P=window.cancelAnimationFrame||H("CancelAnimationFrame")||H("CancelRequestAnimationFrame")||function(s){window.clearTimeout(s)};function O(s,l,f){if(f&&C===b)s.call(l);else return C.call(window,a(s,l))}function F(s){s&&P.call(window,s)}var M={__proto__:null,extend:i,create:o,bind:a,get lastId(){return c},stamp:h,throttle:p,wrapNum:y,falseFn:v,formatNum:w,trim:S,splitWords:N,setOptions:A,getParamString:U,template:k,isArray:R,indexOf:z,emptyImageUrl:K,requestFn:C,cancelFn:P,requestAnimFrame:O,cancelAnimFrame:F};function be(){}be.extend=function(s){var l=function(){A(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},f=l.__super__=this.prototype,m=o(f);m.constructor=l,l.prototype=m;for(var _ in this)Object.prototype.hasOwnProperty.call(this,_)&&_!=="prototype"&&_!=="__super__"&&(l[_]=this[_]);return s.statics&&i(l,s.statics),s.includes&&(Re(s.includes),i.apply(null,[m].concat(s.includes))),i(m,s),delete m.statics,delete m.includes,m.options&&(m.options=f.options?o(f.options):{},i(m.options,s.options)),m._initHooks=[],m.callInitHooks=function(){if(!this._initHooksCalled){f.callInitHooks&&f.callInitHooks.call(this),this._initHooksCalled=!0;for(var E=0,V=m._initHooks.length;E<V;E++)m._initHooks[E].call(this)}},l},be.include=function(s){var l=this.prototype.options;return i(this.prototype,s),s.options&&(this.prototype.options=l,this.mergeOptions(s.options)),this},be.mergeOptions=function(s){return i(this.prototype.options,s),this},be.addInitHook=function(s){var l=Array.prototype.slice.call(arguments,1),f=typeof s=="function"?s:function(){this[s].apply(this,l)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(f),this};function Re(s){if(!(typeof L>"u"||!L||!L.Mixin)){s=R(s)?s:[s];for(var l=0;l<s.length;l++)s[l]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var De={on:function(s,l,f){if(typeof s=="object")for(var m in s)this._on(m,s[m],l);else{s=N(s);for(var _=0,E=s.length;_<E;_++)this._on(s[_],l,f)}return this},off:function(s,l,f){if(!arguments.length)delete this._events;else if(typeof s=="object")for(var m in s)this._off(m,s[m],l);else{s=N(s);for(var _=arguments.length===1,E=0,V=s.length;E<V;E++)_?this._off(s[E]):this._off(s[E],l,f)}return this},_on:function(s,l,f,m){if(typeof l!="function"){console.warn("wrong listener type: "+typeof l);return}if(this._listens(s,l,f)===!1){f===this&&(f=void 0);var _={fn:l,ctx:f};m&&(_.once=!0),this._events=this._events||{},this._events[s]=this._events[s]||[],this._events[s].push(_)}},_off:function(s,l,f){var m,_,E;if(this._events&&(m=this._events[s],!!m)){if(arguments.length===1){if(this._firingCount)for(_=0,E=m.length;_<E;_++)m[_].fn=v;delete this._events[s];return}if(typeof l!="function"){console.warn("wrong listener type: "+typeof l);return}var V=this._listens(s,l,f);if(V!==!1){var $=m[V];this._firingCount&&($.fn=v,this._events[s]=m=m.slice()),m.splice(V,1)}}},fire:function(s,l,f){if(!this.listens(s,f))return this;var m=i({},l,{type:s,target:this,sourceTarget:l&&l.sourceTarget||this});if(this._events){var _=this._events[s];if(_){this._firingCount=this._firingCount+1||1;for(var E=0,V=_.length;E<V;E++){var $=_[E],Z=$.fn;$.once&&this.off(s,Z,$.ctx),Z.call($.ctx||this,m)}this._firingCount--}}return f&&this._propagateEvent(m),this},listens:function(s,l,f,m){typeof s!="string"&&console.warn('"string" type argument expected');var _=l;typeof l!="function"&&(m=!!l,_=void 0,f=void 0);var E=this._events&&this._events[s];if(E&&E.length&&this._listens(s,_,f)!==!1)return!0;if(m){for(var V in this._eventParents)if(this._eventParents[V].listens(s,l,f,m))return!0}return!1},_listens:function(s,l,f){if(!this._events)return!1;var m=this._events[s]||[];if(!l)return!!m.length;f===this&&(f=void 0);for(var _=0,E=m.length;_<E;_++)if(m[_].fn===l&&m[_].ctx===f)return _;return!1},once:function(s,l,f){if(typeof s=="object")for(var m in s)this._on(m,s[m],l,!0);else{s=N(s);for(var _=0,E=s.length;_<E;_++)this._on(s[_],l,f,!0)}return this},addEventParent:function(s){return this._eventParents=this._eventParents||{},this._eventParents[h(s)]=s,this},removeEventParent:function(s){return this._eventParents&&delete this._eventParents[h(s)],this},_propagateEvent:function(s){for(var l in this._eventParents)this._eventParents[l].fire(s.type,i({layer:s.target,propagatedFrom:s.target},s),!0)}};De.addEventListener=De.on,De.removeEventListener=De.clearAllEventListeners=De.off,De.addOneTimeEventListener=De.once,De.fireEvent=De.fire,De.hasEventListeners=De.listens;var ut=be.extend(De);function G(s,l,f){this.x=f?Math.round(s):s,this.y=f?Math.round(l):l}var se=Math.trunc||function(s){return s>0?Math.floor(s):Math.ceil(s)};G.prototype={clone:function(){return new G(this.x,this.y)},add:function(s){return this.clone()._add(X(s))},_add:function(s){return this.x+=s.x,this.y+=s.y,this},subtract:function(s){return this.clone()._subtract(X(s))},_subtract:function(s){return this.x-=s.x,this.y-=s.y,this},divideBy:function(s){return this.clone()._divideBy(s)},_divideBy:function(s){return this.x/=s,this.y/=s,this},multiplyBy:function(s){return this.clone()._multiplyBy(s)},_multiplyBy:function(s){return this.x*=s,this.y*=s,this},scaleBy:function(s){return new G(this.x*s.x,this.y*s.y)},unscaleBy:function(s){return new G(this.x/s.x,this.y/s.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=se(this.x),this.y=se(this.y),this},distanceTo:function(s){s=X(s);var l=s.x-this.x,f=s.y-this.y;return Math.sqrt(l*l+f*f)},equals:function(s){return s=X(s),s.x===this.x&&s.y===this.y},contains:function(s){return s=X(s),Math.abs(s.x)<=Math.abs(this.x)&&Math.abs(s.y)<=Math.abs(this.y)},toString:function(){return"Point("+w(this.x)+", "+w(this.y)+")"}};function X(s,l,f){return s instanceof G?s:R(s)?new G(s[0],s[1]):s==null?s:typeof s=="object"&&"x"in s&&"y"in s?new G(s.x,s.y):new G(s,l,f)}function ue(s,l){if(s)for(var f=l?[s,l]:s,m=0,_=f.length;m<_;m++)this.extend(f[m])}ue.prototype={extend:function(s){var l,f;if(!s)return this;if(s instanceof G||typeof s[0]=="number"||"x"in s)l=f=X(s);else if(s=de(s),l=s.min,f=s.max,!l||!f)return this;return!this.min&&!this.max?(this.min=l.clone(),this.max=f.clone()):(this.min.x=Math.min(l.x,this.min.x),this.max.x=Math.max(f.x,this.max.x),this.min.y=Math.min(l.y,this.min.y),this.max.y=Math.max(f.y,this.max.y)),this},getCenter:function(s){return X((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,s)},getBottomLeft:function(){return X(this.min.x,this.max.y)},getTopRight:function(){return X(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(s){var l,f;return typeof s[0]=="number"||s instanceof G?s=X(s):s=de(s),s instanceof ue?(l=s.min,f=s.max):l=f=s,l.x>=this.min.x&&f.x<=this.max.x&&l.y>=this.min.y&&f.y<=this.max.y},intersects:function(s){s=de(s);var l=this.min,f=this.max,m=s.min,_=s.max,E=_.x>=l.x&&m.x<=f.x,V=_.y>=l.y&&m.y<=f.y;return E&&V},overlaps:function(s){s=de(s);var l=this.min,f=this.max,m=s.min,_=s.max,E=_.x>l.x&&m.x<f.x,V=_.y>l.y&&m.y<f.y;return E&&V},isValid:function(){return!!(this.min&&this.max)},pad:function(s){var l=this.min,f=this.max,m=Math.abs(l.x-f.x)*s,_=Math.abs(l.y-f.y)*s;return de(X(l.x-m,l.y-_),X(f.x+m,f.y+_))},equals:function(s){return s?(s=de(s),this.min.equals(s.getTopLeft())&&this.max.equals(s.getBottomRight())):!1}};function de(s,l){return!s||s instanceof ue?s:new ue(s,l)}function ve(s,l){if(s)for(var f=l?[s,l]:s,m=0,_=f.length;m<_;m++)this.extend(f[m])}ve.prototype={extend:function(s){var l=this._southWest,f=this._northEast,m,_;if(s instanceof xe)m=s,_=s;else if(s instanceof ve){if(m=s._southWest,_=s._northEast,!m||!_)return this}else return s?this.extend(ge(s)||Te(s)):this;return!l&&!f?(this._southWest=new xe(m.lat,m.lng),this._northEast=new xe(_.lat,_.lng)):(l.lat=Math.min(m.lat,l.lat),l.lng=Math.min(m.lng,l.lng),f.lat=Math.max(_.lat,f.lat),f.lng=Math.max(_.lng,f.lng)),this},pad:function(s){var l=this._southWest,f=this._northEast,m=Math.abs(l.lat-f.lat)*s,_=Math.abs(l.lng-f.lng)*s;return new ve(new xe(l.lat-m,l.lng-_),new xe(f.lat+m,f.lng+_))},getCenter:function(){return new xe((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new xe(this.getNorth(),this.getWest())},getSouthEast:function(){return new xe(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(s){typeof s[0]=="number"||s instanceof xe||"lat"in s?s=ge(s):s=Te(s);var l=this._southWest,f=this._northEast,m,_;return s instanceof ve?(m=s.getSouthWest(),_=s.getNorthEast()):m=_=s,m.lat>=l.lat&&_.lat<=f.lat&&m.lng>=l.lng&&_.lng<=f.lng},intersects:function(s){s=Te(s);var l=this._southWest,f=this._northEast,m=s.getSouthWest(),_=s.getNorthEast(),E=_.lat>=l.lat&&m.lat<=f.lat,V=_.lng>=l.lng&&m.lng<=f.lng;return E&&V},overlaps:function(s){s=Te(s);var l=this._southWest,f=this._northEast,m=s.getSouthWest(),_=s.getNorthEast(),E=_.lat>l.lat&&m.lat<f.lat,V=_.lng>l.lng&&m.lng<f.lng;return E&&V},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(s,l){return s?(s=Te(s),this._southWest.equals(s.getSouthWest(),l)&&this._northEast.equals(s.getNorthEast(),l)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Te(s,l){return s instanceof ve?s:new ve(s,l)}function xe(s,l,f){if(isNaN(s)||isNaN(l))throw new Error("Invalid LatLng object: ("+s+", "+l+")");this.lat=+s,this.lng=+l,f!==void 0&&(this.alt=+f)}xe.prototype={equals:function(s,l){if(!s)return!1;s=ge(s);var f=Math.max(Math.abs(this.lat-s.lat),Math.abs(this.lng-s.lng));return f<=(l===void 0?1e-9:l)},toString:function(s){return"LatLng("+w(this.lat,s)+", "+w(this.lng,s)+")"},distanceTo:function(s){return Jt.distance(this,ge(s))},wrap:function(){return Jt.wrapLatLng(this)},toBounds:function(s){var l=180*s/40075017,f=l/Math.cos(Math.PI/180*this.lat);return Te([this.lat-l,this.lng-f],[this.lat+l,this.lng+f])},clone:function(){return new xe(this.lat,this.lng,this.alt)}};function ge(s,l,f){return s instanceof xe?s:R(s)&&typeof s[0]!="object"?s.length===3?new xe(s[0],s[1],s[2]):s.length===2?new xe(s[0],s[1]):null:s==null?s:typeof s=="object"&&"lat"in s?new xe(s.lat,"lng"in s?s.lng:s.lon,s.alt):l===void 0?null:new xe(s,l,f)}var Je={latLngToPoint:function(s,l){var f=this.projection.project(s),m=this.scale(l);return this.transformation._transform(f,m)},pointToLatLng:function(s,l){var f=this.scale(l),m=this.transformation.untransform(s,f);return this.projection.unproject(m)},project:function(s){return this.projection.project(s)},unproject:function(s){return this.projection.unproject(s)},scale:function(s){return 256*Math.pow(2,s)},zoom:function(s){return Math.log(s/256)/Math.LN2},getProjectedBounds:function(s){if(this.infinite)return null;var l=this.projection.bounds,f=this.scale(s),m=this.transformation.transform(l.min,f),_=this.transformation.transform(l.max,f);return new ue(m,_)},infinite:!1,wrapLatLng:function(s){var l=this.wrapLng?y(s.lng,this.wrapLng,!0):s.lng,f=this.wrapLat?y(s.lat,this.wrapLat,!0):s.lat,m=s.alt;return new xe(f,l,m)},wrapLatLngBounds:function(s){var l=s.getCenter(),f=this.wrapLatLng(l),m=l.lat-f.lat,_=l.lng-f.lng;if(m===0&&_===0)return s;var E=s.getSouthWest(),V=s.getNorthEast(),$=new xe(E.lat-m,E.lng-_),Z=new xe(V.lat-m,V.lng-_);return new ve($,Z)}},Jt=i({},Je,{wrapLng:[-180,180],R:6371e3,distance:function(s,l){var f=Math.PI/180,m=s.lat*f,_=l.lat*f,E=Math.sin((l.lat-s.lat)*f/2),V=Math.sin((l.lng-s.lng)*f/2),$=E*E+Math.cos(m)*Math.cos(_)*V*V,Z=2*Math.atan2(Math.sqrt($),Math.sqrt(1-$));return this.R*Z}}),St=6378137,it={R:St,MAX_LATITUDE:85.0511287798,project:function(s){var l=Math.PI/180,f=this.MAX_LATITUDE,m=Math.max(Math.min(f,s.lat),-f),_=Math.sin(m*l);return new G(this.R*s.lng*l,this.R*Math.log((1+_)/(1-_))/2)},unproject:function(s){var l=180/Math.PI;return new xe((2*Math.atan(Math.exp(s.y/this.R))-Math.PI/2)*l,s.x*l/this.R)},bounds:function(){var s=St*Math.PI;return new ue([-s,-s],[s,s])}()};function Ue(s,l,f,m){if(R(s)){this._a=s[0],this._b=s[1],this._c=s[2],this._d=s[3];return}this._a=s,this._b=l,this._c=f,this._d=m}Ue.prototype={transform:function(s,l){return this._transform(s.clone(),l)},_transform:function(s,l){return l=l||1,s.x=l*(this._a*s.x+this._b),s.y=l*(this._c*s.y+this._d),s},untransform:function(s,l){return l=l||1,new G((s.x/l-this._b)/this._a,(s.y/l-this._d)/this._c)}};function yt(s,l,f,m){return new Ue(s,l,f,m)}var Ze=i({},Jt,{code:"EPSG:3857",projection:it,transformation:function(){var s=.5/(Math.PI*it.R);return yt(s,.5,-s,.5)}()}),mn=i({},Ze,{code:"EPSG:900913"});function or(s){return document.createElementNS("http://www.w3.org/2000/svg",s)}function rs(s,l){var f="",m,_,E,V,$,Z;for(m=0,E=s.length;m<E;m++){for($=s[m],_=0,V=$.length;_<V;_++)Z=$[_],f+=(_?"L":"M")+Z.x+" "+Z.y;f+=l?oe.svg?"z":"x":""}return f||"M0 0"}var yi=document.documentElement.style,is="ActiveXObject"in window,da=is&&!document.addEventListener,ss="msLaunchUri"in navigator&&!("documentMode"in document),Hr=yn("webkit"),Ir=yn("android"),_i=yn("android 2")||yn("android 3"),ho=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),fo=Ir&&yn("Google")&&ho<537&&!("AudioNode"in window),_t=!!window.opera,Pt=!ss&&yn("chrome"),Wr=yn("gecko")&&!Hr&&!_t&&!is,po=!Pt&&yn("safari"),Sn=yn("phantom"),ha="OTransition"in yi,kr=navigator.platform.indexOf("Win")===0,Sr=is&&"transition"in yi,Pr="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!_i,os="MozPerspective"in yi,fa=!window.L_DISABLE_3D&&(Sr||Pr||os)&&!ha&&!Sn,Gr=typeof orientation<"u"||yn("mobile"),as=Gr&&Hr,pa=Gr&&Pr,ls=!window.PointerEvent&&window.MSPointerEvent,Ar=!!(window.PointerEvent||ls),us="ontouchstart"in window||!!window.TouchEvent,mo=!window.L_NO_TOUCH&&(us||Ar),Nr=Gr&&_t,ma=Gr&&Wr,vi=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,ga=function(){var s=!1;try{var l=Object.defineProperty({},"passive",{get:function(){s=!0}});window.addEventListener("testPassiveEventSupport",v,l),window.removeEventListener("testPassiveEventSupport",v,l)}catch{}return s}(),gn=function(){return!!document.createElement("canvas").getContext}(),vt=!!(document.createElementNS&&or("svg").createSVGRect),lt=!!vt&&function(){var s=document.createElement("div");return s.innerHTML="<svg/>",(s.firstChild&&s.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Wt=!vt&&function(){try{var s=document.createElement("div");s.innerHTML='<v:shape adj="1"/>';var l=s.firstChild;return l.style.behavior="url(#default#VML)",l&&typeof l.adj=="object"}catch{return!1}}(),Kr=navigator.platform.indexOf("Mac")===0,Zr=navigator.platform.indexOf("Linux")===0;function yn(s){return navigator.userAgent.toLowerCase().indexOf(s)>=0}var oe={ie:is,ielt9:da,edge:ss,webkit:Hr,android:Ir,android23:_i,androidStock:fo,opera:_t,chrome:Pt,gecko:Wr,safari:po,phantom:Sn,opera12:ha,win:kr,ie3d:Sr,webkit3d:Pr,gecko3d:os,any3d:fa,mobile:Gr,mobileWebkit:as,mobileWebkit3d:pa,msPointer:ls,pointer:Ar,touch:mo,touchNative:us,mobileOpera:Nr,mobileGecko:ma,retina:vi,passiveEvents:ga,canvas:gn,svg:vt,vml:Wt,inlineSvg:lt,mac:Kr,linux:Zr},Cr=oe.msPointer?"MSPointerDown":"pointerdown",ya=oe.msPointer?"MSPointerMove":"pointermove",_a=oe.msPointer?"MSPointerUp":"pointerup",xi=oe.msPointer?"MSPointerCancel":"pointercancel",cs={touchstart:Cr,touchmove:ya,touchend:_a,touchcancel:xi},wi={touchstart:fs,touchmove:hs,touchend:hs,touchcancel:hs},qn={},$n=!1;function va(s,l,f){return l==="touchstart"&&wa(),wi[l]?(f=wi[l].bind(this,f),s.addEventListener(cs[l],f,!1),f):(console.warn("wrong event specified:",l),v)}function xa(s,l,f){if(!cs[l]){console.warn("wrong event specified:",l);return}s.removeEventListener(cs[l],f,!1)}function go(s){qn[s.pointerId]=s}function ds(s){qn[s.pointerId]&&(qn[s.pointerId]=s)}function yo(s){delete qn[s.pointerId]}function wa(){$n||(document.addEventListener(Cr,go,!0),document.addEventListener(ya,ds,!0),document.addEventListener(_a,yo,!0),document.addEventListener(xi,yo,!0),$n=!0)}function hs(s,l){if(l.pointerType!==(l.MSPOINTER_TYPE_MOUSE||"mouse")){l.touches=[];for(var f in qn)l.touches.push(qn[f]);l.changedTouches=[l],s(l)}}function fs(s,l){l.MSPOINTER_TYPE_TOUCH&&l.pointerType===l.MSPOINTER_TYPE_TOUCH&&xt(l),hs(s,l)}function ar(s){var l={},f,m;for(m in s)f=s[m],l[m]=f&&f.bind?f.bind(s):f;return s=l,l.type="dblclick",l.detail=2,l.isTrusted=!1,l._simulated=!0,l}var Se=200;function Qr(s,l){s.addEventListener("dblclick",l);var f=0,m;function _(E){if(E.detail!==1){m=E.detail;return}if(!(E.pointerType==="mouse"||E.sourceCapabilities&&!E.sourceCapabilities.firesTouchEvents)){var V=iu(E);if(!(V.some(function(Z){return Z instanceof HTMLLabelElement&&Z.attributes.for})&&!V.some(function(Z){return Z instanceof HTMLInputElement||Z instanceof HTMLSelectElement}))){var $=Date.now();$-f<=Se?(m++,m===2&&l(ar(E))):m=1,f=$}}}return s.addEventListener("click",_),{dblclick:l,simDblclick:_}}function lr(s,l){s.removeEventListener("dblclick",l.dblclick),s.removeEventListener("click",l.simDblclick)}var Yr=ur(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Jr=ur(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),ps=Jr==="webkitTransition"||Jr==="OTransition"?Jr+"End":"transitionend";function ms(s){return typeof s=="string"?document.getElementById(s):s}function Rr(s,l){var f=s.style[l]||s.currentStyle&&s.currentStyle[l];if((!f||f==="auto")&&document.defaultView){var m=document.defaultView.getComputedStyle(s,null);f=m?m[l]:null}return f==="auto"?null:f}function je(s,l,f){var m=document.createElement(s);return m.className=l||"",f&&f.appendChild(m),m}function Xe(s){var l=s.parentNode;l&&l.removeChild(s)}function Xr(s){for(;s.firstChild;)s.removeChild(s.firstChild)}function D(s){var l=s.parentNode;l&&l.lastChild!==s&&l.appendChild(s)}function Y(s){var l=s.parentNode;l&&l.firstChild!==s&&l.insertBefore(s,l.firstChild)}function ne(s,l){if(s.classList!==void 0)return s.classList.contains(l);var f=Ce(s);return f.length>0&&new RegExp("(^|\\s)"+l+"(\\s|$)").test(f)}function ie(s,l){if(s.classList!==void 0)for(var f=N(l),m=0,_=f.length;m<_;m++)s.classList.add(f[m]);else if(!ne(s,l)){var E=Ce(s);Qe(s,(E?E+" ":"")+l)}}function fe(s,l){s.classList!==void 0?s.classList.remove(l):Qe(s,S((" "+Ce(s)+" ").replace(" "+l+" "," ")))}function Qe(s,l){s.className.baseVal===void 0?s.className=l:s.className.baseVal=l}function Ce(s){return s.correspondingElement&&(s=s.correspondingElement),s.className.baseVal===void 0?s.className:s.className.baseVal}function $e(s,l){"opacity"in s.style?s.style.opacity=l:"filter"in s.style&&Bt(s,l)}function Bt(s,l){var f=!1,m="DXImageTransform.Microsoft.Alpha";try{f=s.filters.item(m)}catch{if(l===1)return}l=Math.round(l*100),f?(f.Enabled=l!==100,f.Opacity=l):s.style.filter+=" progid:"+m+"(opacity="+l+")"}function ur(s){for(var l=document.documentElement.style,f=0;f<s.length;f++)if(s[f]in l)return s[f];return!1}function cr(s,l,f){var m=l||new G(0,0);s.style[Yr]=(oe.ie3d?"translate("+m.x+"px,"+m.y+"px)":"translate3d("+m.x+"px,"+m.y+"px,0)")+(f?" scale("+f+")":"")}function Pe(s,l){s._leaflet_pos=l,oe.any3d?cr(s,l):(s.style.left=l.x+"px",s.style.top=l.y+"px")}function Pn(s){return s._leaflet_pos||new G(0,0)}var An,jr,Yl;if("onselectstart"in document)An=function(){Ie(window,"selectstart",xt)},jr=function(){st(window,"selectstart",xt)};else{var gs=ur(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);An=function(){if(gs){var s=document.documentElement.style;Yl=s[gs],s[gs]="none"}},jr=function(){gs&&(document.documentElement.style[gs]=Yl,Yl=void 0)}}function Jl(){Ie(window,"dragstart",xt)}function Xl(){st(window,"dragstart",xt)}var ba,eu;function bi(s){for(;s.tabIndex===-1;)s=s.parentNode;s.style&&(Hn(),ba=s,eu=s.style.outlineStyle,s.style.outlineStyle="none",Ie(window,"keydown",Hn))}function Hn(){ba&&(ba.style.outlineStyle=eu,ba=void 0,eu=void 0,st(window,"keydown",Hn))}function tu(s){do s=s.parentNode;while((!s.offsetWidth||!s.offsetHeight)&&s!==document.body);return s}function Ea(s){var l=s.getBoundingClientRect();return{x:l.width/s.offsetWidth||1,y:l.height/s.offsetHeight||1,boundingClientRect:l}}var od={__proto__:null,TRANSFORM:Yr,TRANSITION:Jr,TRANSITION_END:ps,get:ms,getStyle:Rr,create:je,remove:Xe,empty:Xr,toFront:D,toBack:Y,hasClass:ne,addClass:ie,removeClass:fe,setClass:Qe,getClass:Ce,setOpacity:$e,testProp:ur,setTransform:cr,setPosition:Pe,getPosition:Pn,get disableTextSelection(){return An},get enableTextSelection(){return jr},disableImageDrag:Jl,enableImageDrag:Xl,preventOutline:bi,restoreOutline:Hn,getSizedParentNode:tu,getScale:Ea};function Ie(s,l,f,m){if(l&&typeof l=="object")for(var _ in l)nu(s,_,l[_],f);else{l=N(l);for(var E=0,V=l.length;E<V;E++)nu(s,l[E],f,m)}return this}var dr="_leaflet_events";function st(s,l,f,m){if(arguments.length===1)ad(s),delete s[dr];else if(l&&typeof l=="object")for(var _ in l)ru(s,_,l[_],f);else if(l=N(l),arguments.length===2)ad(s,function($){return z(l,$)!==-1});else for(var E=0,V=l.length;E<V;E++)ru(s,l[E],f,m);return this}function ad(s,l){for(var f in s[dr]){var m=f.split(/\d/)[0];(!l||l(m))&&ru(s,m,null,null,f)}}var hr={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function nu(s,l,f,m){var _=l+h(f)+(m?"_"+h(m):"");if(s[dr]&&s[dr][_])return this;var E=function($){return f.call(m||s,$||window.event)},V=E;!oe.touchNative&&oe.pointer&&l.indexOf("touch")===0?E=va(s,l,E):oe.touch&&l==="dblclick"?E=Qr(s,E):"addEventListener"in s?l==="touchstart"||l==="touchmove"||l==="wheel"||l==="mousewheel"?s.addEventListener(hr[l]||l,E,oe.passiveEvents?{passive:!1}:!1):l==="mouseenter"||l==="mouseleave"?(E=function($){$=$||window.event,su(s,$)&&V($)},s.addEventListener(hr[l],E,!1)):s.addEventListener(l,V,!1):s.attachEvent("on"+l,E),s[dr]=s[dr]||{},s[dr][_]=E}function ru(s,l,f,m,_){_=_||l+h(f)+(m?"_"+h(m):"");var E=s[dr]&&s[dr][_];if(!E)return this;!oe.touchNative&&oe.pointer&&l.indexOf("touch")===0?xa(s,l,E):oe.touch&&l==="dblclick"?lr(s,E):"removeEventListener"in s?s.removeEventListener(hr[l]||l,E,!1):s.detachEvent("on"+l,E),s[dr][_]=null}function fr(s){return s.stopPropagation?s.stopPropagation():s.originalEvent?s.originalEvent._stopped=!0:s.cancelBubble=!0,this}function ys(s){return nu(s,"wheel",fr),this}function _s(s){return Ie(s,"mousedown touchstart dblclick contextmenu",fr),s._leaflet_disable_click=!0,this}function xt(s){return s.preventDefault?s.preventDefault():s.returnValue=!1,this}function Wn(s){return xt(s),fr(s),this}function iu(s){if(s.composedPath)return s.composedPath();for(var l=[],f=s.target;f;)l.push(f),f=f.parentNode;return l}function Ta(s,l){if(!l)return new G(s.clientX,s.clientY);var f=Ea(l),m=f.boundingClientRect;return new G((s.clientX-m.left)/f.x-l.clientLeft,(s.clientY-m.top)/f.y-l.clientTop)}var pt=oe.linux&&oe.chrome?window.devicePixelRatio:oe.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function ld(s){return oe.edge?s.wheelDeltaY/2:s.deltaY&&s.deltaMode===0?-s.deltaY/pt:s.deltaY&&s.deltaMode===1?-s.deltaY*20:s.deltaY&&s.deltaMode===2?-s.deltaY*60:s.deltaX||s.deltaZ?0:s.wheelDelta?(s.wheelDeltaY||s.wheelDelta)/2:s.detail&&Math.abs(s.detail)<32765?-s.detail*20:s.detail?s.detail/-32765*60:0}function su(s,l){var f=l.relatedTarget;if(!f)return!0;try{for(;f&&f!==s;)f=f.parentNode}catch{return!1}return f!==s}var ud={__proto__:null,on:Ie,off:st,stopPropagation:fr,disableScrollPropagation:ys,disableClickPropagation:_s,preventDefault:xt,stop:Wn,getPropagationPath:iu,getMousePosition:Ta,getWheelDelta:ld,isExternalTarget:su,addListener:Ie,removeListener:st},ou=ut.extend({run:function(s,l,f,m){this.stop(),this._el=s,this._inProgress=!0,this._duration=f||.25,this._easeOutPower=1/Math.max(m||.5,.2),this._startPos=Pn(s),this._offset=l.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=O(this._animate,this),this._step()},_step:function(s){var l=+new Date-this._startTime,f=this._duration*1e3;l<f?this._runFrame(this._easeOut(l/f),s):(this._runFrame(1),this._complete())},_runFrame:function(s,l){var f=this._startPos.add(this._offset.multiplyBy(s));l&&f._round(),Pe(this._el,f),this.fire("step")},_complete:function(){F(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(s){return 1-Math.pow(1-s,this._easeOutPower)}}),Ve=ut.extend({options:{crs:Ze,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(s,l){l=A(this,l),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(s),this._initLayout(),this._onResize=a(this._onResize,this),this._initEvents(),l.maxBounds&&this.setMaxBounds(l.maxBounds),l.zoom!==void 0&&(this._zoom=this._limitZoom(l.zoom)),l.center&&l.zoom!==void 0&&this.setView(ge(l.center),l.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Jr&&oe.any3d&&!oe.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Ie(this._proxy,ps,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(s,l,f){if(l=l===void 0?this._zoom:this._limitZoom(l),s=this._limitCenter(ge(s),l,this.options.maxBounds),f=f||{},this._stop(),this._loaded&&!f.reset&&f!==!0){f.animate!==void 0&&(f.zoom=i({animate:f.animate},f.zoom),f.pan=i({animate:f.animate,duration:f.duration},f.pan));var m=this._zoom!==l?this._tryAnimatedZoom&&this._tryAnimatedZoom(s,l,f.zoom):this._tryAnimatedPan(s,f.pan);if(m)return clearTimeout(this._sizeTimer),this}return this._resetView(s,l,f.pan&&f.pan.noMoveStart),this},setZoom:function(s,l){return this._loaded?this.setView(this.getCenter(),s,{zoom:l}):(this._zoom=s,this)},zoomIn:function(s,l){return s=s||(oe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+s,l)},zoomOut:function(s,l){return s=s||(oe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-s,l)},setZoomAround:function(s,l,f){var m=this.getZoomScale(l),_=this.getSize().divideBy(2),E=s instanceof G?s:this.latLngToContainerPoint(s),V=E.subtract(_).multiplyBy(1-1/m),$=this.containerPointToLatLng(_.add(V));return this.setView($,l,{zoom:f})},_getBoundsCenterZoom:function(s,l){l=l||{},s=s.getBounds?s.getBounds():Te(s);var f=X(l.paddingTopLeft||l.padding||[0,0]),m=X(l.paddingBottomRight||l.padding||[0,0]),_=this.getBoundsZoom(s,!1,f.add(m));if(_=typeof l.maxZoom=="number"?Math.min(l.maxZoom,_):_,_===1/0)return{center:s.getCenter(),zoom:_};var E=m.subtract(f).divideBy(2),V=this.project(s.getSouthWest(),_),$=this.project(s.getNorthEast(),_),Z=this.unproject(V.add($).divideBy(2).add(E),_);return{center:Z,zoom:_}},fitBounds:function(s,l){if(s=Te(s),!s.isValid())throw new Error("Bounds are not valid.");var f=this._getBoundsCenterZoom(s,l);return this.setView(f.center,f.zoom,l)},fitWorld:function(s){return this.fitBounds([[-90,-180],[90,180]],s)},panTo:function(s,l){return this.setView(s,this._zoom,{pan:l})},panBy:function(s,l){if(s=X(s).round(),l=l||{},!s.x&&!s.y)return this.fire("moveend");if(l.animate!==!0&&!this.getSize().contains(s))return this._resetView(this.unproject(this.project(this.getCenter()).add(s)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new ou,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),l.noMoveStart||this.fire("movestart"),l.animate!==!1){ie(this._mapPane,"leaflet-pan-anim");var f=this._getMapPanePos().subtract(s).round();this._panAnim.run(this._mapPane,f,l.duration||.25,l.easeLinearity)}else this._rawPanBy(s),this.fire("move").fire("moveend");return this},flyTo:function(s,l,f){if(f=f||{},f.animate===!1||!oe.any3d)return this.setView(s,l,f);this._stop();var m=this.project(this.getCenter()),_=this.project(s),E=this.getSize(),V=this._zoom;s=ge(s),l=l===void 0?V:l;var $=Math.max(E.x,E.y),Z=$*this.getZoomScale(V,l),ee=_.distanceTo(m)||1,he=1.42,ke=he*he;function Me(Vt){var Id=Vt?-1:1,vP=Vt?Z:$,xP=Z*Z-$*$+Id*ke*ke*ee*ee,wP=2*vP*ke*ee,Dp=xP/wP,i0=Math.sqrt(Dp*Dp+1)-Dp,bP=i0<1e-9?-18:Math.log(i0);return bP}function vn(Vt){return(Math.exp(Vt)-Math.exp(-Vt))/2}function Kt(Vt){return(Math.exp(Vt)+Math.exp(-Vt))/2}function mr(Vt){return vn(Vt)/Kt(Vt)}var Cn=Me(0);function Oa(Vt){return $*(Kt(Cn)/Kt(Cn+he*Vt))}function mP(Vt){return $*(Kt(Cn)*mr(Cn+he*Vt)-vn(Cn))/ke}function gP(Vt){return 1-Math.pow(1-Vt,1.5)}var yP=Date.now(),n0=(Me(1)-Cn)/he,_P=f.duration?1e3*f.duration:1e3*n0*.8;function r0(){var Vt=(Date.now()-yP)/_P,Id=gP(Vt)*n0;Vt<=1?(this._flyToFrame=O(r0,this),this._move(this.unproject(m.add(_.subtract(m).multiplyBy(mP(Id)/ee)),V),this.getScaleZoom($/Oa(Id),V),{flyTo:!0})):this._move(s,l)._moveEnd(!0)}return this._moveStart(!0,f.noMoveStart),r0.call(this),this},flyToBounds:function(s,l){var f=this._getBoundsCenterZoom(s,l);return this.flyTo(f.center,f.zoom,l)},setMaxBounds:function(s){return s=Te(s),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),s.isValid()?(this.options.maxBounds=s,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(s){var l=this.options.minZoom;return this.options.minZoom=s,this._loaded&&l!==s&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(s):this},setMaxZoom:function(s){var l=this.options.maxZoom;return this.options.maxZoom=s,this._loaded&&l!==s&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(s):this},panInsideBounds:function(s,l){this._enforcingBounds=!0;var f=this.getCenter(),m=this._limitCenter(f,this._zoom,Te(s));return f.equals(m)||this.panTo(m,l),this._enforcingBounds=!1,this},panInside:function(s,l){l=l||{};var f=X(l.paddingTopLeft||l.padding||[0,0]),m=X(l.paddingBottomRight||l.padding||[0,0]),_=this.project(this.getCenter()),E=this.project(s),V=this.getPixelBounds(),$=de([V.min.add(f),V.max.subtract(m)]),Z=$.getSize();if(!$.contains(E)){this._enforcingBounds=!0;var ee=E.subtract($.getCenter()),he=$.extend(E).getSize().subtract(Z);_.x+=ee.x<0?-he.x:he.x,_.y+=ee.y<0?-he.y:he.y,this.panTo(this.unproject(_),l),this._enforcingBounds=!1}return this},invalidateSize:function(s){if(!this._loaded)return this;s=i({animate:!1,pan:!0},s===!0?{animate:!0}:s);var l=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var f=this.getSize(),m=l.divideBy(2).round(),_=f.divideBy(2).round(),E=m.subtract(_);return!E.x&&!E.y?this:(s.animate&&s.pan?this.panBy(E):(s.pan&&this._rawPanBy(E),this.fire("move"),s.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(a(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:l,newSize:f}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(s){if(s=this._locateOptions=i({timeout:1e4,watch:!1},s),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var l=a(this._handleGeolocationResponse,this),f=a(this._handleGeolocationError,this);return s.watch?this._locationWatchId=navigator.geolocation.watchPosition(l,f,s):navigator.geolocation.getCurrentPosition(l,f,s),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(s){if(this._container._leaflet_id){var l=s.code,f=s.message||(l===1?"permission denied":l===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:l,message:"Geolocation error: "+f+"."})}},_handleGeolocationResponse:function(s){if(this._container._leaflet_id){var l=s.coords.latitude,f=s.coords.longitude,m=new xe(l,f),_=m.toBounds(s.coords.accuracy*2),E=this._locateOptions;if(E.setView){var V=this.getBoundsZoom(_);this.setView(m,E.maxZoom?Math.min(V,E.maxZoom):V)}var $={latlng:m,bounds:_,timestamp:s.timestamp};for(var Z in s.coords)typeof s.coords[Z]=="number"&&($[Z]=s.coords[Z]);this.fire("locationfound",$)}},addHandler:function(s,l){if(!l)return this;var f=this[s]=new l(this);return this._handlers.push(f),this.options[s]&&f.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Xe(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(F(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var s;for(s in this._layers)this._layers[s].remove();for(s in this._panes)Xe(this._panes[s]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(s,l){var f="leaflet-pane"+(s?" leaflet-"+s.replace("Pane","")+"-pane":""),m=je("div",f,l||this._mapPane);return s&&(this._panes[s]=m),m},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var s=this.getPixelBounds(),l=this.unproject(s.getBottomLeft()),f=this.unproject(s.getTopRight());return new ve(l,f)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(s,l,f){s=Te(s),f=X(f||[0,0]);var m=this.getZoom()||0,_=this.getMinZoom(),E=this.getMaxZoom(),V=s.getNorthWest(),$=s.getSouthEast(),Z=this.getSize().subtract(f),ee=de(this.project($,m),this.project(V,m)).getSize(),he=oe.any3d?this.options.zoomSnap:1,ke=Z.x/ee.x,Me=Z.y/ee.y,vn=l?Math.max(ke,Me):Math.min(ke,Me);return m=this.getScaleZoom(vn,m),he&&(m=Math.round(m/(he/100))*(he/100),m=l?Math.ceil(m/he)*he:Math.floor(m/he)*he),Math.max(_,Math.min(E,m))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new G(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(s,l){var f=this._getTopLeftPoint(s,l);return new ue(f,f.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(s){return this.options.crs.getProjectedBounds(s===void 0?this.getZoom():s)},getPane:function(s){return typeof s=="string"?this._panes[s]:s},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(s,l){var f=this.options.crs;return l=l===void 0?this._zoom:l,f.scale(s)/f.scale(l)},getScaleZoom:function(s,l){var f=this.options.crs;l=l===void 0?this._zoom:l;var m=f.zoom(s*f.scale(l));return isNaN(m)?1/0:m},project:function(s,l){return l=l===void 0?this._zoom:l,this.options.crs.latLngToPoint(ge(s),l)},unproject:function(s,l){return l=l===void 0?this._zoom:l,this.options.crs.pointToLatLng(X(s),l)},layerPointToLatLng:function(s){var l=X(s).add(this.getPixelOrigin());return this.unproject(l)},latLngToLayerPoint:function(s){var l=this.project(ge(s))._round();return l._subtract(this.getPixelOrigin())},wrapLatLng:function(s){return this.options.crs.wrapLatLng(ge(s))},wrapLatLngBounds:function(s){return this.options.crs.wrapLatLngBounds(Te(s))},distance:function(s,l){return this.options.crs.distance(ge(s),ge(l))},containerPointToLayerPoint:function(s){return X(s).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(s){return X(s).add(this._getMapPanePos())},containerPointToLatLng:function(s){var l=this.containerPointToLayerPoint(X(s));return this.layerPointToLatLng(l)},latLngToContainerPoint:function(s){return this.layerPointToContainerPoint(this.latLngToLayerPoint(ge(s)))},mouseEventToContainerPoint:function(s){return Ta(s,this._container)},mouseEventToLayerPoint:function(s){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(s))},mouseEventToLatLng:function(s){return this.layerPointToLatLng(this.mouseEventToLayerPoint(s))},_initContainer:function(s){var l=this._container=ms(s);if(l){if(l._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Ie(l,"scroll",this._onScroll,this),this._containerId=h(l)},_initLayout:function(){var s=this._container;this._fadeAnimated=this.options.fadeAnimation&&oe.any3d,ie(s,"leaflet-container"+(oe.touch?" leaflet-touch":"")+(oe.retina?" leaflet-retina":"")+(oe.ielt9?" leaflet-oldie":"")+(oe.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var l=Rr(s,"position");l!=="absolute"&&l!=="relative"&&l!=="fixed"&&l!=="sticky"&&(s.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var s=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Pe(this._mapPane,new G(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ie(s.markerPane,"leaflet-zoom-hide"),ie(s.shadowPane,"leaflet-zoom-hide"))},_resetView:function(s,l,f){Pe(this._mapPane,new G(0,0));var m=!this._loaded;this._loaded=!0,l=this._limitZoom(l),this.fire("viewprereset");var _=this._zoom!==l;this._moveStart(_,f)._move(s,l)._moveEnd(_),this.fire("viewreset"),m&&this.fire("load")},_moveStart:function(s,l){return s&&this.fire("zoomstart"),l||this.fire("movestart"),this},_move:function(s,l,f,m){l===void 0&&(l=this._zoom);var _=this._zoom!==l;return this._zoom=l,this._lastCenter=s,this._pixelOrigin=this._getNewPixelOrigin(s),m?f&&f.pinch&&this.fire("zoom",f):((_||f&&f.pinch)&&this.fire("zoom",f),this.fire("move",f)),this},_moveEnd:function(s){return s&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return F(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(s){Pe(this._mapPane,this._getMapPanePos().subtract(s))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(s){this._targets={},this._targets[h(this._container)]=this;var l=s?st:Ie;l(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&l(window,"resize",this._onResize,this),oe.any3d&&this.options.transform3DLimit&&(s?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){F(this._resizeRequest),this._resizeRequest=O(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var s=this._getMapPanePos();Math.max(Math.abs(s.x),Math.abs(s.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(s,l){for(var f=[],m,_=l==="mouseout"||l==="mouseover",E=s.target||s.srcElement,V=!1;E;){if(m=this._targets[h(E)],m&&(l==="click"||l==="preclick")&&this._draggableMoved(m)){V=!0;break}if(m&&m.listens(l,!0)&&(_&&!su(E,s)||(f.push(m),_))||E===this._container)break;E=E.parentNode}return!f.length&&!V&&!_&&this.listens(l,!0)&&(f=[this]),f},_isClickDisabled:function(s){for(;s&&s!==this._container;){if(s._leaflet_disable_click)return!0;s=s.parentNode}},_handleDOMEvent:function(s){var l=s.target||s.srcElement;if(!(!this._loaded||l._leaflet_disable_events||s.type==="click"&&this._isClickDisabled(l))){var f=s.type;f==="mousedown"&&bi(l),this._fireDOMEvent(s,f)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(s,l,f){if(s.type==="click"){var m=i({},s);m.type="preclick",this._fireDOMEvent(m,m.type,f)}var _=this._findEventTargets(s,l);if(f){for(var E=[],V=0;V<f.length;V++)f[V].listens(l,!0)&&E.push(f[V]);_=E.concat(_)}if(_.length){l==="contextmenu"&&xt(s);var $=_[0],Z={originalEvent:s};if(s.type!=="keypress"&&s.type!=="keydown"&&s.type!=="keyup"){var ee=$.getLatLng&&(!$._radius||$._radius<=10);Z.containerPoint=ee?this.latLngToContainerPoint($.getLatLng()):this.mouseEventToContainerPoint(s),Z.layerPoint=this.containerPointToLayerPoint(Z.containerPoint),Z.latlng=ee?$.getLatLng():this.layerPointToLatLng(Z.layerPoint)}for(V=0;V<_.length;V++)if(_[V].fire(l,Z,!0),Z.originalEvent._stopped||_[V].options.bubblingMouseEvents===!1&&z(this._mouseEvents,l)!==-1)return}},_draggableMoved:function(s){return s=s.dragging&&s.dragging.enabled()?s:this,s.dragging&&s.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var s=0,l=this._handlers.length;s<l;s++)this._handlers[s].disable()},whenReady:function(s,l){return this._loaded?s.call(l||this,{target:this}):this.on("load",s,l),this},_getMapPanePos:function(){return Pn(this._mapPane)||new G(0,0)},_moved:function(){var s=this._getMapPanePos();return s&&!s.equals([0,0])},_getTopLeftPoint:function(s,l){var f=s&&l!==void 0?this._getNewPixelOrigin(s,l):this.getPixelOrigin();return f.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(s,l){var f=this.getSize()._divideBy(2);return this.project(s,l)._subtract(f)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(s,l,f){var m=this._getNewPixelOrigin(f,l);return this.project(s,l)._subtract(m)},_latLngBoundsToNewLayerBounds:function(s,l,f){var m=this._getNewPixelOrigin(f,l);return de([this.project(s.getSouthWest(),l)._subtract(m),this.project(s.getNorthWest(),l)._subtract(m),this.project(s.getSouthEast(),l)._subtract(m),this.project(s.getNorthEast(),l)._subtract(m)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(s){return this.latLngToLayerPoint(s).subtract(this._getCenterLayerPoint())},_limitCenter:function(s,l,f){if(!f)return s;var m=this.project(s,l),_=this.getSize().divideBy(2),E=new ue(m.subtract(_),m.add(_)),V=this._getBoundsOffset(E,f,l);return Math.abs(V.x)<=1&&Math.abs(V.y)<=1?s:this.unproject(m.add(V),l)},_limitOffset:function(s,l){if(!l)return s;var f=this.getPixelBounds(),m=new ue(f.min.add(s),f.max.add(s));return s.add(this._getBoundsOffset(m,l))},_getBoundsOffset:function(s,l,f){var m=de(this.project(l.getNorthEast(),f),this.project(l.getSouthWest(),f)),_=m.min.subtract(s.min),E=m.max.subtract(s.max),V=this._rebound(_.x,-E.x),$=this._rebound(_.y,-E.y);return new G(V,$)},_rebound:function(s,l){return s+l>0?Math.round(s-l)/2:Math.max(0,Math.ceil(s))-Math.max(0,Math.floor(l))},_limitZoom:function(s){var l=this.getMinZoom(),f=this.getMaxZoom(),m=oe.any3d?this.options.zoomSnap:1;return m&&(s=Math.round(s/m)*m),Math.max(l,Math.min(f,s))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){fe(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(s,l){var f=this._getCenterOffset(s)._trunc();return(l&&l.animate)!==!0&&!this.getSize().contains(f)?!1:(this.panBy(f,l),!0)},_createAnimProxy:function(){var s=this._proxy=je("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(s),this.on("zoomanim",function(l){var f=Yr,m=this._proxy.style[f];cr(this._proxy,this.project(l.center,l.zoom),this.getZoomScale(l.zoom,1)),m===this._proxy.style[f]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Xe(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var s=this.getCenter(),l=this.getZoom();cr(this._proxy,this.project(s,l),this.getZoomScale(l,1))},_catchTransitionEnd:function(s){this._animatingZoom&&s.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(s,l,f){if(this._animatingZoom)return!0;if(f=f||{},!this._zoomAnimated||f.animate===!1||this._nothingToAnimate()||Math.abs(l-this._zoom)>this.options.zoomAnimationThreshold)return!1;var m=this.getZoomScale(l),_=this._getCenterOffset(s)._divideBy(1-1/m);return f.animate!==!0&&!this.getSize().contains(_)?!1:(O(function(){this._moveStart(!0,f.noMoveStart||!1)._animateZoom(s,l,!0)},this),!0)},_animateZoom:function(s,l,f,m){this._mapPane&&(f&&(this._animatingZoom=!0,this._animateToCenter=s,this._animateToZoom=l,ie(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:s,zoom:l,noUpdate:m}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(a(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&fe(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Ia(s,l){return new Ve(s,l)}var Nn=be.extend({options:{position:"topright"},initialize:function(s){A(this,s)},getPosition:function(){return this.options.position},setPosition:function(s){var l=this._map;return l&&l.removeControl(this),this.options.position=s,l&&l.addControl(this),this},getContainer:function(){return this._container},addTo:function(s){this.remove(),this._map=s;var l=this._container=this.onAdd(s),f=this.getPosition(),m=s._controlCorners[f];return ie(l,"leaflet-control"),f.indexOf("bottom")!==-1?m.insertBefore(l,m.firstChild):m.appendChild(l),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Xe(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(s){this._map&&s&&s.screenX>0&&s.screenY>0&&this._map.getContainer().focus()}}),_n=function(s){return new Nn(s)};Ve.include({addControl:function(s){return s.addTo(this),this},removeControl:function(s){return s.remove(),this},_initControlPos:function(){var s=this._controlCorners={},l="leaflet-",f=this._controlContainer=je("div",l+"control-container",this._container);function m(_,E){var V=l+_+" "+l+E;s[_+E]=je("div",V,f)}m("top","left"),m("top","right"),m("bottom","left"),m("bottom","right")},_clearControlPos:function(){for(var s in this._controlCorners)Xe(this._controlCorners[s]);Xe(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var au=Nn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(s,l,f,m){return f<m?-1:m<f?1:0}},initialize:function(s,l,f){A(this,f),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var m in s)this._addLayer(s[m],m);for(m in l)this._addLayer(l[m],m,!0)},onAdd:function(s){this._initLayout(),this._update(),this._map=s,s.on("zoomend",this._checkDisabledLayers,this);for(var l=0;l<this._layers.length;l++)this._layers[l].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(s){return Nn.prototype.addTo.call(this,s),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var s=0;s<this._layers.length;s++)this._layers[s].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(s,l){return this._addLayer(s,l),this._map?this._update():this},addOverlay:function(s,l){return this._addLayer(s,l,!0),this._map?this._update():this},removeLayer:function(s){s.off("add remove",this._onLayerChange,this);var l=this._getLayer(h(s));return l&&this._layers.splice(this._layers.indexOf(l),1),this._map?this._update():this},expand:function(){ie(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var s=this._map.getSize().y-(this._container.offsetTop+50);return s<this._section.clientHeight?(ie(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=s+"px"):fe(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return fe(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var s="leaflet-control-layers",l=this._container=je("div",s),f=this.options.collapsed;l.setAttribute("aria-haspopup",!0),_s(l),ys(l);var m=this._section=je("section",s+"-list");f&&(this._map.on("click",this.collapse,this),Ie(l,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var _=this._layersLink=je("a",s+"-toggle",l);_.href="#",_.title="Layers",_.setAttribute("role","button"),Ie(_,{keydown:function(E){E.keyCode===13&&this._expandSafely()},click:function(E){xt(E),this._expandSafely()}},this),f||this.expand(),this._baseLayersList=je("div",s+"-base",m),this._separator=je("div",s+"-separator",m),this._overlaysList=je("div",s+"-overlays",m),l.appendChild(m)},_getLayer:function(s){for(var l=0;l<this._layers.length;l++)if(this._layers[l]&&h(this._layers[l].layer)===s)return this._layers[l]},_addLayer:function(s,l,f){this._map&&s.on("add remove",this._onLayerChange,this),this._layers.push({layer:s,name:l,overlay:f}),this.options.sortLayers&&this._layers.sort(a(function(m,_){return this.options.sortFunction(m.layer,_.layer,m.name,_.name)},this)),this.options.autoZIndex&&s.setZIndex&&(this._lastZIndex++,s.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Xr(this._baseLayersList),Xr(this._overlaysList),this._layerControlInputs=[];var s,l,f,m,_=0;for(f=0;f<this._layers.length;f++)m=this._layers[f],this._addItem(m),l=l||m.overlay,s=s||!m.overlay,_+=m.overlay?0:1;return this.options.hideSingleBase&&(s=s&&_>1,this._baseLayersList.style.display=s?"":"none"),this._separator.style.display=l&&s?"":"none",this},_onLayerChange:function(s){this._handlingClick||this._update();var l=this._getLayer(h(s.target)),f=l.overlay?s.type==="add"?"overlayadd":"overlayremove":s.type==="add"?"baselayerchange":null;f&&this._map.fire(f,l)},_createRadioElement:function(s,l){var f='<input type="radio" class="leaflet-control-layers-selector" name="'+s+'"'+(l?' checked="checked"':"")+"/>",m=document.createElement("div");return m.innerHTML=f,m.firstChild},_addItem:function(s){var l=document.createElement("label"),f=this._map.hasLayer(s.layer),m;s.overlay?(m=document.createElement("input"),m.type="checkbox",m.className="leaflet-control-layers-selector",m.defaultChecked=f):m=this._createRadioElement("leaflet-base-layers_"+h(this),f),this._layerControlInputs.push(m),m.layerId=h(s.layer),Ie(m,"click",this._onInputClick,this);var _=document.createElement("span");_.innerHTML=" "+s.name;var E=document.createElement("span");l.appendChild(E),E.appendChild(m),E.appendChild(_);var V=s.overlay?this._overlaysList:this._baseLayersList;return V.appendChild(l),this._checkDisabledLayers(),l},_onInputClick:function(){if(!this._preventClick){var s=this._layerControlInputs,l,f,m=[],_=[];this._handlingClick=!0;for(var E=s.length-1;E>=0;E--)l=s[E],f=this._getLayer(l.layerId).layer,l.checked?m.push(f):l.checked||_.push(f);for(E=0;E<_.length;E++)this._map.hasLayer(_[E])&&this._map.removeLayer(_[E]);for(E=0;E<m.length;E++)this._map.hasLayer(m[E])||this._map.addLayer(m[E]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var s=this._layerControlInputs,l,f,m=this._map.getZoom(),_=s.length-1;_>=0;_--)l=s[_],f=this._getLayer(l.layerId).layer,l.disabled=f.options.minZoom!==void 0&&m<f.options.minZoom||f.options.maxZoom!==void 0&&m>f.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var s=this._section;this._preventClick=!0,Ie(s,"click",xt),this.expand();var l=this;setTimeout(function(){st(s,"click",xt),l._preventClick=!1})}}),Ap=function(s,l,f){return new au(s,l,f)},Ei=Nn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(s){var l="leaflet-control-zoom",f=je("div",l+" leaflet-bar"),m=this.options;return this._zoomInButton=this._createButton(m.zoomInText,m.zoomInTitle,l+"-in",f,this._zoomIn),this._zoomOutButton=this._createButton(m.zoomOutText,m.zoomOutTitle,l+"-out",f,this._zoomOut),this._updateDisabled(),s.on("zoomend zoomlevelschange",this._updateDisabled,this),f},onRemove:function(s){s.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(s){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(s.shiftKey?3:1))},_zoomOut:function(s){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(s.shiftKey?3:1))},_createButton:function(s,l,f,m,_){var E=je("a",f,m);return E.innerHTML=s,E.href="#",E.title=l,E.setAttribute("role","button"),E.setAttribute("aria-label",l),_s(E),Ie(E,"click",Wn),Ie(E,"click",_,this),Ie(E,"click",this._refocusOnMap,this),E},_updateDisabled:function(){var s=this._map,l="leaflet-disabled";fe(this._zoomInButton,l),fe(this._zoomOutButton,l),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||s._zoom===s.getMinZoom())&&(ie(this._zoomOutButton,l),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||s._zoom===s.getMaxZoom())&&(ie(this._zoomInButton,l),this._zoomInButton.setAttribute("aria-disabled","true"))}});Ve.mergeOptions({zoomControl:!0}),Ve.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Ei,this.addControl(this.zoomControl))});var cd=function(s){return new Ei(s)},ka=Nn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(s){var l="leaflet-control-scale",f=je("div",l),m=this.options;return this._addScales(m,l+"-line",f),s.on(m.updateWhenIdle?"moveend":"move",this._update,this),s.whenReady(this._update,this),f},onRemove:function(s){s.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(s,l,f){s.metric&&(this._mScale=je("div",l,f)),s.imperial&&(this._iScale=je("div",l,f))},_update:function(){var s=this._map,l=s.getSize().y/2,f=s.distance(s.containerPointToLatLng([0,l]),s.containerPointToLatLng([this.options.maxWidth,l]));this._updateScales(f)},_updateScales:function(s){this.options.metric&&s&&this._updateMetric(s),this.options.imperial&&s&&this._updateImperial(s)},_updateMetric:function(s){var l=this._getRoundNum(s),f=l<1e3?l+" m":l/1e3+" km";this._updateScale(this._mScale,f,l/s)},_updateImperial:function(s){var l=s*3.2808399,f,m,_;l>5280?(f=l/5280,m=this._getRoundNum(f),this._updateScale(this._iScale,m+" mi",m/f)):(_=this._getRoundNum(l),this._updateScale(this._iScale,_+" ft",_/l))},_updateScale:function(s,l,f){s.style.width=Math.round(this.options.maxWidth*f)+"px",s.innerHTML=l},_getRoundNum:function(s){var l=Math.pow(10,(Math.floor(s)+"").length-1),f=s/l;return f=f>=10?10:f>=5?5:f>=3?3:f>=2?2:1,l*f}}),Sa=function(s){return new ka(s)},dd='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',vs=Nn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(oe.inlineSvg?dd+" ":"")+"Leaflet</a>"},initialize:function(s){A(this,s),this._attributions={}},onAdd:function(s){s.attributionControl=this,this._container=je("div","leaflet-control-attribution"),_s(this._container);for(var l in s._layers)s._layers[l].getAttribution&&this.addAttribution(s._layers[l].getAttribution());return this._update(),s.on("layeradd",this._addAttribution,this),this._container},onRemove:function(s){s.off("layeradd",this._addAttribution,this)},_addAttribution:function(s){s.layer.getAttribution&&(this.addAttribution(s.layer.getAttribution()),s.layer.once("remove",function(){this.removeAttribution(s.layer.getAttribution())},this))},setPrefix:function(s){return this.options.prefix=s,this._update(),this},addAttribution:function(s){return s?(this._attributions[s]||(this._attributions[s]=0),this._attributions[s]++,this._update(),this):this},removeAttribution:function(s){return s?(this._attributions[s]&&(this._attributions[s]--,this._update()),this):this},_update:function(){if(this._map){var s=[];for(var l in this._attributions)this._attributions[l]&&s.push(l);var f=[];this.options.prefix&&f.push(this.options.prefix),s.length&&f.push(s.join(", ")),this._container.innerHTML=f.join(' <span aria-hidden="true">|</span> ')}}});Ve.mergeOptions({attributionControl:!0}),Ve.addInitHook(function(){this.options.attributionControl&&new vs().addTo(this)});var Np=function(s){return new vs(s)};Nn.Layers=au,Nn.Zoom=Ei,Nn.Scale=ka,Nn.Attribution=vs,_n.layers=Ap,_n.zoom=cd,_n.scale=Sa,_n.attribution=Np;var Gn=be.extend({initialize:function(s){this._map=s},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Gn.addTo=function(s,l){return s.addHandler(l,this),this};var _o={Events:De},lu=oe.touch?"touchstart mousedown":"mousedown",Lr=ut.extend({options:{clickTolerance:3},initialize:function(s,l,f,m){A(this,m),this._element=s,this._dragStartTarget=l||s,this._preventOutline=f},enable:function(){this._enabled||(Ie(this._dragStartTarget,lu,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Lr._dragging===this&&this.finishDrag(!0),st(this._dragStartTarget,lu,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(s){if(this._enabled&&(this._moved=!1,!ne(this._element,"leaflet-zoom-anim"))){if(s.touches&&s.touches.length!==1){Lr._dragging===this&&this.finishDrag();return}if(!(Lr._dragging||s.shiftKey||s.which!==1&&s.button!==1&&!s.touches)&&(Lr._dragging=this,this._preventOutline&&bi(this._element),Jl(),An(),!this._moving)){this.fire("down");var l=s.touches?s.touches[0]:s,f=tu(this._element);this._startPoint=new G(l.clientX,l.clientY),this._startPos=Pn(this._element),this._parentScale=Ea(f);var m=s.type==="mousedown";Ie(document,m?"mousemove":"touchmove",this._onMove,this),Ie(document,m?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(s){if(this._enabled){if(s.touches&&s.touches.length>1){this._moved=!0;return}var l=s.touches&&s.touches.length===1?s.touches[0]:s,f=new G(l.clientX,l.clientY)._subtract(this._startPoint);!f.x&&!f.y||Math.abs(f.x)+Math.abs(f.y)<this.options.clickTolerance||(f.x/=this._parentScale.x,f.y/=this._parentScale.y,xt(s),this._moved||(this.fire("dragstart"),this._moved=!0,ie(document.body,"leaflet-dragging"),this._lastTarget=s.target||s.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ie(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(f),this._moving=!0,this._lastEvent=s,this._updatePosition())}},_updatePosition:function(){var s={originalEvent:this._lastEvent};this.fire("predrag",s),Pe(this._element,this._newPos),this.fire("drag",s)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(s){fe(document.body,"leaflet-dragging"),this._lastTarget&&(fe(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),st(document,"mousemove touchmove",this._onMove,this),st(document,"mouseup touchend touchcancel",this._onUp,this),Xl(),jr();var l=this._moved&&this._moving;this._moving=!1,Lr._dragging=!1,l&&this.fire("dragend",{noInertia:s,distance:this._newPos.distanceTo(this._startPos)})}});function Pa(s,l,f){var m,_=[1,4,2,8],E,V,$,Z,ee,he,ke,Me;for(E=0,he=s.length;E<he;E++)s[E]._code=ei(s[E],l);for($=0;$<4;$++){for(ke=_[$],m=[],E=0,he=s.length,V=he-1;E<he;V=E++)Z=s[E],ee=s[V],Z._code&ke?ee._code&ke||(Me=Gt(ee,Z,ke,l,f),Me._code=ei(Me,l),m.push(Me)):(ee._code&ke&&(Me=Gt(ee,Z,ke,l,f),Me._code=ei(Me,l),m.push(Me)),m.push(Z));s=m}return s}function Aa(s,l){var f,m,_,E,V,$,Z,ee,he;if(!s||s.length===0)throw new Error("latlngs not passed");d(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var ke=ge([0,0]),Me=Te(s),vn=Me.getNorthWest().distanceTo(Me.getSouthWest())*Me.getNorthEast().distanceTo(Me.getNorthWest());vn<1700&&(ke=Na(s));var Kt=s.length,mr=[];for(f=0;f<Kt;f++){var Cn=ge(s[f]);mr.push(l.project(ge([Cn.lat-ke.lat,Cn.lng-ke.lng])))}for($=Z=ee=0,f=0,m=Kt-1;f<Kt;m=f++)_=mr[f],E=mr[m],V=_.y*E.x-E.y*_.x,Z+=(_.x+E.x)*V,ee+=(_.y+E.y)*V,$+=V*3;$===0?he=mr[0]:he=[Z/$,ee/$];var Oa=l.unproject(X(he));return ge([Oa.lat+ke.lat,Oa.lng+ke.lng])}function Na(s){for(var l=0,f=0,m=0,_=0;_<s.length;_++){var E=ge(s[_]);l+=E.lat,f+=E.lng,m++}return ge([l/m,f/m])}var Ca={__proto__:null,clipPolygon:Pa,polygonCenter:Aa,centroid:Na};function uu(s,l){if(!l||!s.length)return s.slice();var f=l*l;return s=fd(s,f),s=hd(s,f),s}function cu(s,l,f){return Math.sqrt(pr(s,l,f,!0))}function Ti(s,l,f){return pr(s,l,f)}function hd(s,l){var f=s.length,m=typeof Uint8Array<"u"?Uint8Array:Array,_=new m(f);_[0]=_[f-1]=1,Ra(s,_,l,0,f-1);var E,V=[];for(E=0;E<f;E++)_[E]&&V.push(s[E]);return V}function Ra(s,l,f,m,_){var E=0,V,$,Z;for($=m+1;$<=_-1;$++)Z=pr(s[$],s[m],s[_],!0),Z>E&&(V=$,E=Z);E>f&&(l[V]=1,Ra(s,l,f,m,V),Ra(s,l,f,V,_))}function fd(s,l){for(var f=[s[0]],m=1,_=0,E=s.length;m<E;m++)pd(s[m],s[_])>l&&(f.push(s[m]),_=m);return _<E-1&&f.push(s[E-1]),f}var du;function vo(s,l,f,m,_){var E=m?du:ei(s,f),V=ei(l,f),$,Z,ee;for(du=V;;){if(!(E|V))return[s,l];if(E&V)return!1;$=E||V,Z=Gt(s,l,$,f,_),ee=ei(Z,f),$===E?(s=Z,E=ee):(l=Z,V=ee)}}function Gt(s,l,f,m,_){var E=l.x-s.x,V=l.y-s.y,$=m.min,Z=m.max,ee,he;return f&8?(ee=s.x+E*(Z.y-s.y)/V,he=Z.y):f&4?(ee=s.x+E*($.y-s.y)/V,he=$.y):f&2?(ee=Z.x,he=s.y+V*(Z.x-s.x)/E):f&1&&(ee=$.x,he=s.y+V*($.x-s.x)/E),new G(ee,he,_)}function ei(s,l){var f=0;return s.x<l.min.x?f|=1:s.x>l.max.x&&(f|=2),s.y<l.min.y?f|=4:s.y>l.max.y&&(f|=8),f}function pd(s,l){var f=l.x-s.x,m=l.y-s.y;return f*f+m*m}function pr(s,l,f,m){var _=l.x,E=l.y,V=f.x-_,$=f.y-E,Z=V*V+$*$,ee;return Z>0&&(ee=((s.x-_)*V+(s.y-E)*$)/Z,ee>1?(_=f.x,E=f.y):ee>0&&(_+=V*ee,E+=$*ee)),V=s.x-_,$=s.y-E,m?V*V+$*$:new G(_,E)}function d(s){return!R(s[0])||typeof s[0][0]!="object"&&typeof s[0][0]<"u"}function g(s){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),d(s)}function x(s,l){var f,m,_,E,V,$,Z,ee;if(!s||s.length===0)throw new Error("latlngs not passed");d(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var he=ge([0,0]),ke=Te(s),Me=ke.getNorthWest().distanceTo(ke.getSouthWest())*ke.getNorthEast().distanceTo(ke.getNorthWest());Me<1700&&(he=Na(s));var vn=s.length,Kt=[];for(f=0;f<vn;f++){var mr=ge(s[f]);Kt.push(l.project(ge([mr.lat-he.lat,mr.lng-he.lng])))}for(f=0,m=0;f<vn-1;f++)m+=Kt[f].distanceTo(Kt[f+1])/2;if(m===0)ee=Kt[0];else for(f=0,E=0;f<vn-1;f++)if(V=Kt[f],$=Kt[f+1],_=V.distanceTo($),E+=_,E>m){Z=(E-m)/_,ee=[$.x-Z*($.x-V.x),$.y-Z*($.y-V.y)];break}var Cn=l.unproject(X(ee));return ge([Cn.lat+he.lat,Cn.lng+he.lng])}var I={__proto__:null,simplify:uu,pointToSegmentDistance:cu,closestPointOnSegment:Ti,clipSegment:vo,_getEdgeIntersection:Gt,_getBitCode:ei,_sqClosestPointOnSegment:pr,isFlat:d,_flat:g,polylineCenter:x},q={project:function(s){return new G(s.lng,s.lat)},unproject:function(s){return new xe(s.y,s.x)},bounds:new ue([-180,-90],[180,90])},Q={R:6378137,R_MINOR:6356752314245179e-9,bounds:new ue([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(s){var l=Math.PI/180,f=this.R,m=s.lat*l,_=this.R_MINOR/f,E=Math.sqrt(1-_*_),V=E*Math.sin(m),$=Math.tan(Math.PI/4-m/2)/Math.pow((1-V)/(1+V),E/2);return m=-f*Math.log(Math.max($,1e-10)),new G(s.lng*l*f,m)},unproject:function(s){for(var l=180/Math.PI,f=this.R,m=this.R_MINOR/f,_=Math.sqrt(1-m*m),E=Math.exp(-s.y/f),V=Math.PI/2-2*Math.atan(E),$=0,Z=.1,ee;$<15&&Math.abs(Z)>1e-7;$++)ee=_*Math.sin(V),ee=Math.pow((1-ee)/(1+ee),_/2),Z=Math.PI/2-2*Math.atan(E*ee)-V,V+=Z;return new xe(V*l,s.x*l/f)}},ae={__proto__:null,LonLat:q,Mercator:Q,SphericalMercator:it},tt=i({},Jt,{code:"EPSG:3395",projection:Q,transformation:function(){var s=.5/(Math.PI*Q.R);return yt(s,.5,-s,.5)}()}),Ot=i({},Jt,{code:"EPSG:4326",projection:q,transformation:yt(1/180,1,-1/180,.5)}),He=i({},Je,{projection:q,transformation:yt(1,0,-1,0),scale:function(s){return Math.pow(2,s)},zoom:function(s){return Math.log(s)/Math.LN2},distance:function(s,l){var f=l.lng-s.lng,m=l.lat-s.lat;return Math.sqrt(f*f+m*m)},infinite:!0});Je.Earth=Jt,Je.EPSG3395=tt,Je.EPSG3857=Ze,Je.EPSG900913=mn,Je.EPSG4326=Ot,Je.Simple=He;var ot=ut.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(s){return s.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(s){return s&&s.removeLayer(this),this},getPane:function(s){return this._map.getPane(s?this.options[s]||s:this.options.pane)},addInteractiveTarget:function(s){return this._map._targets[h(s)]=this,this},removeInteractiveTarget:function(s){return delete this._map._targets[h(s)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(s){var l=s.target;if(l.hasLayer(this)){if(this._map=l,this._zoomAnimated=l._zoomAnimated,this.getEvents){var f=this.getEvents();l.on(f,this),this.once("remove",function(){l.off(f,this)},this)}this.onAdd(l),this.fire("add"),l.fire("layeradd",{layer:this})}}});Ve.include({addLayer:function(s){if(!s._layerAdd)throw new Error("The provided object is not a Layer.");var l=h(s);return this._layers[l]?this:(this._layers[l]=s,s._mapToAdd=this,s.beforeAdd&&s.beforeAdd(this),this.whenReady(s._layerAdd,s),this)},removeLayer:function(s){var l=h(s);return this._layers[l]?(this._loaded&&s.onRemove(this),delete this._layers[l],this._loaded&&(this.fire("layerremove",{layer:s}),s.fire("remove")),s._map=s._mapToAdd=null,this):this},hasLayer:function(s){return h(s)in this._layers},eachLayer:function(s,l){for(var f in this._layers)s.call(l,this._layers[f]);return this},_addLayers:function(s){s=s?R(s)?s:[s]:[];for(var l=0,f=s.length;l<f;l++)this.addLayer(s[l])},_addZoomLimit:function(s){(!isNaN(s.options.maxZoom)||!isNaN(s.options.minZoom))&&(this._zoomBoundLayers[h(s)]=s,this._updateZoomLevels())},_removeZoomLimit:function(s){var l=h(s);this._zoomBoundLayers[l]&&(delete this._zoomBoundLayers[l],this._updateZoomLevels())},_updateZoomLevels:function(){var s=1/0,l=-1/0,f=this._getZoomSpan();for(var m in this._zoomBoundLayers){var _=this._zoomBoundLayers[m].options;s=_.minZoom===void 0?s:Math.min(s,_.minZoom),l=_.maxZoom===void 0?l:Math.max(l,_.maxZoom)}this._layersMaxZoom=l===-1/0?void 0:l,this._layersMinZoom=s===1/0?void 0:s,f!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var wt=ot.extend({initialize:function(s,l){A(this,l),this._layers={};var f,m;if(s)for(f=0,m=s.length;f<m;f++)this.addLayer(s[f])},addLayer:function(s){var l=this.getLayerId(s);return this._layers[l]=s,this._map&&this._map.addLayer(s),this},removeLayer:function(s){var l=s in this._layers?s:this.getLayerId(s);return this._map&&this._layers[l]&&this._map.removeLayer(this._layers[l]),delete this._layers[l],this},hasLayer:function(s){var l=typeof s=="number"?s:this.getLayerId(s);return l in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(s){var l=Array.prototype.slice.call(arguments,1),f,m;for(f in this._layers)m=this._layers[f],m[s]&&m[s].apply(m,l);return this},onAdd:function(s){this.eachLayer(s.addLayer,s)},onRemove:function(s){this.eachLayer(s.removeLayer,s)},eachLayer:function(s,l){for(var f in this._layers)s.call(l,this._layers[f]);return this},getLayer:function(s){return this._layers[s]},getLayers:function(){var s=[];return this.eachLayer(s.push,s),s},setZIndex:function(s){return this.invoke("setZIndex",s)},getLayerId:function(s){return h(s)}}),xs=function(s,l){return new wt(s,l)},jt=wt.extend({addLayer:function(s){return this.hasLayer(s)?this:(s.addEventParent(this),wt.prototype.addLayer.call(this,s),this.fire("layeradd",{layer:s}))},removeLayer:function(s){return this.hasLayer(s)?(s in this._layers&&(s=this._layers[s]),s.removeEventParent(this),wt.prototype.removeLayer.call(this,s),this.fire("layerremove",{layer:s})):this},setStyle:function(s){return this.invoke("setStyle",s)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var s=new ve;for(var l in this._layers){var f=this._layers[l];s.extend(f.getBounds?f.getBounds():f.getLatLng())}return s}}),ja=function(s,l){return new jt(s,l)},ti=be.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(s){A(this,s)},createIcon:function(s){return this._createIcon("icon",s)},createShadow:function(s){return this._createIcon("shadow",s)},_createIcon:function(s,l){var f=this._getIconUrl(s);if(!f){if(s==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var m=this._createImg(f,l&&l.tagName==="IMG"?l:null);return this._setIconStyles(m,s),(this.options.crossOrigin||this.options.crossOrigin==="")&&(m.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),m},_setIconStyles:function(s,l){var f=this.options,m=f[l+"Size"];typeof m=="number"&&(m=[m,m]);var _=X(m),E=X(l==="shadow"&&f.shadowAnchor||f.iconAnchor||_&&_.divideBy(2,!0));s.className="leaflet-marker-"+l+" "+(f.className||""),E&&(s.style.marginLeft=-E.x+"px",s.style.marginTop=-E.y+"px"),_&&(s.style.width=_.x+"px",s.style.height=_.y+"px")},_createImg:function(s,l){return l=l||document.createElement("img"),l.src=s,l},_getIconUrl:function(s){return oe.retina&&this.options[s+"RetinaUrl"]||this.options[s+"Url"]}});function Q1(s){return new ti(s)}var hu=ti.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(s){return typeof hu.imagePath!="string"&&(hu.imagePath=this._detectIconPath()),(this.options.imagePath||hu.imagePath)+ti.prototype._getIconUrl.call(this,s)},_stripUrl:function(s){var l=function(f,m,_){var E=m.exec(f);return E&&E[_]};return s=l(s,/^url\((['"])?(.+)\1\)$/,2),s&&l(s,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var s=je("div","leaflet-default-icon-path",document.body),l=Rr(s,"background-image")||Rr(s,"backgroundImage");if(document.body.removeChild(s),l=this._stripUrl(l),l)return l;var f=document.querySelector('link[href$="leaflet.css"]');return f?f.href.substring(0,f.href.length-11-1):""}}),Ov=Gn.extend({initialize:function(s){this._marker=s},addHooks:function(){var s=this._marker._icon;this._draggable||(this._draggable=new Lr(s,s,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ie(s,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&fe(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(s){var l=this._marker,f=l._map,m=this._marker.options.autoPanSpeed,_=this._marker.options.autoPanPadding,E=Pn(l._icon),V=f.getPixelBounds(),$=f.getPixelOrigin(),Z=de(V.min._subtract($).add(_),V.max._subtract($).subtract(_));if(!Z.contains(E)){var ee=X((Math.max(Z.max.x,E.x)-Z.max.x)/(V.max.x-Z.max.x)-(Math.min(Z.min.x,E.x)-Z.min.x)/(V.min.x-Z.min.x),(Math.max(Z.max.y,E.y)-Z.max.y)/(V.max.y-Z.max.y)-(Math.min(Z.min.y,E.y)-Z.min.y)/(V.min.y-Z.min.y)).multiplyBy(m);f.panBy(ee,{animate:!1}),this._draggable._newPos._add(ee),this._draggable._startPos._add(ee),Pe(l._icon,this._draggable._newPos),this._onDrag(s),this._panRequest=O(this._adjustPan.bind(this,s))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(s){this._marker.options.autoPan&&(F(this._panRequest),this._panRequest=O(this._adjustPan.bind(this,s)))},_onDrag:function(s){var l=this._marker,f=l._shadow,m=Pn(l._icon),_=l._map.layerPointToLatLng(m);f&&Pe(f,m),l._latlng=_,s.latlng=_,s.oldLatLng=this._oldLatLng,l.fire("move",s).fire("drag",s)},_onDragEnd:function(s){F(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",s)}}),md=ot.extend({options:{icon:new hu,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(s,l){A(this,l),this._latlng=ge(s)},onAdd:function(s){this._zoomAnimated=this._zoomAnimated&&s.options.markerZoomAnimation,this._zoomAnimated&&s.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(s){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&s.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(s){var l=this._latlng;return this._latlng=ge(s),this.update(),this.fire("move",{oldLatLng:l,latlng:this._latlng})},setZIndexOffset:function(s){return this.options.zIndexOffset=s,this.update()},getIcon:function(){return this.options.icon},setIcon:function(s){return this.options.icon=s,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var s=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(s)}return this},_initIcon:function(){var s=this.options,l="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),f=s.icon.createIcon(this._icon),m=!1;f!==this._icon&&(this._icon&&this._removeIcon(),m=!0,s.title&&(f.title=s.title),f.tagName==="IMG"&&(f.alt=s.alt||"")),ie(f,l),s.keyboard&&(f.tabIndex="0",f.setAttribute("role","button")),this._icon=f,s.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ie(f,"focus",this._panOnFocus,this);var _=s.icon.createShadow(this._shadow),E=!1;_!==this._shadow&&(this._removeShadow(),E=!0),_&&(ie(_,l),_.alt=""),this._shadow=_,s.opacity<1&&this._updateOpacity(),m&&this.getPane().appendChild(this._icon),this._initInteraction(),_&&E&&this.getPane(s.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&st(this._icon,"focus",this._panOnFocus,this),Xe(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Xe(this._shadow),this._shadow=null},_setPos:function(s){this._icon&&Pe(this._icon,s),this._shadow&&Pe(this._shadow,s),this._zIndex=s.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(s){this._icon&&(this._icon.style.zIndex=this._zIndex+s)},_animateZoom:function(s){var l=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center).round();this._setPos(l)},_initInteraction:function(){if(this.options.interactive&&(ie(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Ov)){var s=this.options.draggable;this.dragging&&(s=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Ov(this),s&&this.dragging.enable()}},setOpacity:function(s){return this.options.opacity=s,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var s=this.options.opacity;this._icon&&$e(this._icon,s),this._shadow&&$e(this._shadow,s)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var s=this._map;if(s){var l=this.options.icon.options,f=l.iconSize?X(l.iconSize):X(0,0),m=l.iconAnchor?X(l.iconAnchor):X(0,0);s.panInside(this._latlng,{paddingTopLeft:m,paddingBottomRight:f.subtract(m)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Y1(s,l){return new md(s,l)}var ws=ot.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(s){this._renderer=s.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(s){return A(this,s),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&s&&Object.prototype.hasOwnProperty.call(s,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),gd=ws.extend({options:{fill:!0,radius:10},initialize:function(s,l){A(this,l),this._latlng=ge(s),this._radius=this.options.radius},setLatLng:function(s){var l=this._latlng;return this._latlng=ge(s),this.redraw(),this.fire("move",{oldLatLng:l,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(s){return this.options.radius=this._radius=s,this.redraw()},getRadius:function(){return this._radius},setStyle:function(s){var l=s&&s.radius||this._radius;return ws.prototype.setStyle.call(this,s),this.setRadius(l),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var s=this._radius,l=this._radiusY||s,f=this._clickTolerance(),m=[s+f,l+f];this._pxBounds=new ue(this._point.subtract(m),this._point.add(m))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(s){return s.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function J1(s,l){return new gd(s,l)}var Cp=gd.extend({initialize:function(s,l,f){if(typeof l=="number"&&(l=i({},f,{radius:l})),A(this,l),this._latlng=ge(s),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(s){return this._mRadius=s,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var s=[this._radius,this._radiusY||this._radius];return new ve(this._map.layerPointToLatLng(this._point.subtract(s)),this._map.layerPointToLatLng(this._point.add(s)))},setStyle:ws.prototype.setStyle,_project:function(){var s=this._latlng.lng,l=this._latlng.lat,f=this._map,m=f.options.crs;if(m.distance===Jt.distance){var _=Math.PI/180,E=this._mRadius/Jt.R/_,V=f.project([l+E,s]),$=f.project([l-E,s]),Z=V.add($).divideBy(2),ee=f.unproject(Z).lat,he=Math.acos((Math.cos(E*_)-Math.sin(l*_)*Math.sin(ee*_))/(Math.cos(l*_)*Math.cos(ee*_)))/_;(isNaN(he)||he===0)&&(he=E/Math.cos(Math.PI/180*l)),this._point=Z.subtract(f.getPixelOrigin()),this._radius=isNaN(he)?0:Z.x-f.project([ee,s-he]).x,this._radiusY=Z.y-V.y}else{var ke=m.unproject(m.project(this._latlng).subtract([this._mRadius,0]));this._point=f.latLngToLayerPoint(this._latlng),this._radius=this._point.x-f.latLngToLayerPoint(ke).x}this._updateBounds()}});function X1(s,l,f){return new Cp(s,l,f)}var Ii=ws.extend({options:{smoothFactor:1,noClip:!1},initialize:function(s,l){A(this,l),this._setLatLngs(s)},getLatLngs:function(){return this._latlngs},setLatLngs:function(s){return this._setLatLngs(s),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(s){for(var l=1/0,f=null,m=pr,_,E,V=0,$=this._parts.length;V<$;V++)for(var Z=this._parts[V],ee=1,he=Z.length;ee<he;ee++){_=Z[ee-1],E=Z[ee];var ke=m(s,_,E,!0);ke<l&&(l=ke,f=m(s,_,E))}return f&&(f.distance=Math.sqrt(l)),f},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return x(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(s,l){return l=l||this._defaultShape(),s=ge(s),l.push(s),this._bounds.extend(s),this.redraw()},_setLatLngs:function(s){this._bounds=new ve,this._latlngs=this._convertLatLngs(s)},_defaultShape:function(){return d(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(s){for(var l=[],f=d(s),m=0,_=s.length;m<_;m++)f?(l[m]=ge(s[m]),this._bounds.extend(l[m])):l[m]=this._convertLatLngs(s[m]);return l},_project:function(){var s=new ue;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,s),this._bounds.isValid()&&s.isValid()&&(this._rawPxBounds=s,this._updateBounds())},_updateBounds:function(){var s=this._clickTolerance(),l=new G(s,s);this._rawPxBounds&&(this._pxBounds=new ue([this._rawPxBounds.min.subtract(l),this._rawPxBounds.max.add(l)]))},_projectLatlngs:function(s,l,f){var m=s[0]instanceof xe,_=s.length,E,V;if(m){for(V=[],E=0;E<_;E++)V[E]=this._map.latLngToLayerPoint(s[E]),f.extend(V[E]);l.push(V)}else for(E=0;E<_;E++)this._projectLatlngs(s[E],l,f)},_clipPoints:function(){var s=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}var l=this._parts,f,m,_,E,V,$,Z;for(f=0,_=0,E=this._rings.length;f<E;f++)for(Z=this._rings[f],m=0,V=Z.length;m<V-1;m++)$=vo(Z[m],Z[m+1],s,m,!0),$&&(l[_]=l[_]||[],l[_].push($[0]),($[1]!==Z[m+1]||m===V-2)&&(l[_].push($[1]),_++))}},_simplifyPoints:function(){for(var s=this._parts,l=this.options.smoothFactor,f=0,m=s.length;f<m;f++)s[f]=uu(s[f],l)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(s,l){var f,m,_,E,V,$,Z=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(f=0,E=this._parts.length;f<E;f++)for($=this._parts[f],m=0,V=$.length,_=V-1;m<V;_=m++)if(!(!l&&m===0)&&cu(s,$[_],$[m])<=Z)return!0;return!1}});function eP(s,l){return new Ii(s,l)}Ii._flat=g;var La=Ii.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Aa(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(s){var l=Ii.prototype._convertLatLngs.call(this,s),f=l.length;return f>=2&&l[0]instanceof xe&&l[0].equals(l[f-1])&&l.pop(),l},_setLatLngs:function(s){Ii.prototype._setLatLngs.call(this,s),d(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return d(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var s=this._renderer._bounds,l=this.options.weight,f=new G(l,l);if(s=new ue(s.min.subtract(f),s.max.add(f)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}for(var m=0,_=this._rings.length,E;m<_;m++)E=Pa(this._rings[m],s,!0),E.length&&this._parts.push(E)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(s){var l=!1,f,m,_,E,V,$,Z,ee;if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(E=0,Z=this._parts.length;E<Z;E++)for(f=this._parts[E],V=0,ee=f.length,$=ee-1;V<ee;$=V++)m=f[V],_=f[$],m.y>s.y!=_.y>s.y&&s.x<(_.x-m.x)*(s.y-m.y)/(_.y-m.y)+m.x&&(l=!l);return l||Ii.prototype._containsPoint.call(this,s,!0)}});function tP(s,l){return new La(s,l)}var ki=jt.extend({initialize:function(s,l){A(this,l),this._layers={},s&&this.addData(s)},addData:function(s){var l=R(s)?s:s.features,f,m,_;if(l){for(f=0,m=l.length;f<m;f++)_=l[f],(_.geometries||_.geometry||_.features||_.coordinates)&&this.addData(_);return this}var E=this.options;if(E.filter&&!E.filter(s))return this;var V=yd(s,E);return V?(V.feature=xd(s),V.defaultOptions=V.options,this.resetStyle(V),E.onEachFeature&&E.onEachFeature(s,V),this.addLayer(V)):this},resetStyle:function(s){return s===void 0?this.eachLayer(this.resetStyle,this):(s.options=i({},s.defaultOptions),this._setLayerStyle(s,this.options.style),this)},setStyle:function(s){return this.eachLayer(function(l){this._setLayerStyle(l,s)},this)},_setLayerStyle:function(s,l){s.setStyle&&(typeof l=="function"&&(l=l(s.feature)),s.setStyle(l))}});function yd(s,l){var f=s.type==="Feature"?s.geometry:s,m=f?f.coordinates:null,_=[],E=l&&l.pointToLayer,V=l&&l.coordsToLatLng||Rp,$,Z,ee,he;if(!m&&!f)return null;switch(f.type){case"Point":return $=V(m),Vv(E,s,$,l);case"MultiPoint":for(ee=0,he=m.length;ee<he;ee++)$=V(m[ee]),_.push(Vv(E,s,$,l));return new jt(_);case"LineString":case"MultiLineString":return Z=_d(m,f.type==="LineString"?0:1,V),new Ii(Z,l);case"Polygon":case"MultiPolygon":return Z=_d(m,f.type==="Polygon"?1:2,V),new La(Z,l);case"GeometryCollection":for(ee=0,he=f.geometries.length;ee<he;ee++){var ke=yd({geometry:f.geometries[ee],type:"Feature",properties:s.properties},l);ke&&_.push(ke)}return new jt(_);case"FeatureCollection":for(ee=0,he=f.features.length;ee<he;ee++){var Me=yd(f.features[ee],l);Me&&_.push(Me)}return new jt(_);default:throw new Error("Invalid GeoJSON object.")}}function Vv(s,l,f,m){return s?s(l,f):new md(f,m&&m.markersInheritOptions&&m)}function Rp(s){return new xe(s[1],s[0],s[2])}function _d(s,l,f){for(var m=[],_=0,E=s.length,V;_<E;_++)V=l?_d(s[_],l-1,f):(f||Rp)(s[_]),m.push(V);return m}function jp(s,l){return s=ge(s),s.alt!==void 0?[w(s.lng,l),w(s.lat,l),w(s.alt,l)]:[w(s.lng,l),w(s.lat,l)]}function vd(s,l,f,m){for(var _=[],E=0,V=s.length;E<V;E++)_.push(l?vd(s[E],d(s[E])?0:l-1,f,m):jp(s[E],m));return!l&&f&&_.length>0&&_.push(_[0].slice()),_}function Da(s,l){return s.feature?i({},s.feature,{geometry:l}):xd(l)}function xd(s){return s.type==="Feature"||s.type==="FeatureCollection"?s:{type:"Feature",properties:{},geometry:s}}var Lp={toGeoJSON:function(s){return Da(this,{type:"Point",coordinates:jp(this.getLatLng(),s)})}};md.include(Lp),Cp.include(Lp),gd.include(Lp),Ii.include({toGeoJSON:function(s){var l=!d(this._latlngs),f=vd(this._latlngs,l?1:0,!1,s);return Da(this,{type:(l?"Multi":"")+"LineString",coordinates:f})}}),La.include({toGeoJSON:function(s){var l=!d(this._latlngs),f=l&&!d(this._latlngs[0]),m=vd(this._latlngs,f?2:l?1:0,!0,s);return l||(m=[m]),Da(this,{type:(f?"Multi":"")+"Polygon",coordinates:m})}}),wt.include({toMultiPoint:function(s){var l=[];return this.eachLayer(function(f){l.push(f.toGeoJSON(s).geometry.coordinates)}),Da(this,{type:"MultiPoint",coordinates:l})},toGeoJSON:function(s){var l=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(l==="MultiPoint")return this.toMultiPoint(s);var f=l==="GeometryCollection",m=[];return this.eachLayer(function(_){if(_.toGeoJSON){var E=_.toGeoJSON(s);if(f)m.push(E.geometry);else{var V=xd(E);V.type==="FeatureCollection"?m.push.apply(m,V.features):m.push(V)}}}),f?Da(this,{geometries:m,type:"GeometryCollection"}):{type:"FeatureCollection",features:m}}});function Fv(s,l){return new ki(s,l)}var nP=Fv,wd=ot.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(s,l,f){this._url=s,this._bounds=Te(l),A(this,f)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ie(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Xe(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(s){return this.options.opacity=s,this._image&&this._updateOpacity(),this},setStyle:function(s){return s.opacity&&this.setOpacity(s.opacity),this},bringToFront:function(){return this._map&&D(this._image),this},bringToBack:function(){return this._map&&Y(this._image),this},setUrl:function(s){return this._url=s,this._image&&(this._image.src=s),this},setBounds:function(s){return this._bounds=Te(s),this._map&&this._reset(),this},getEvents:function(){var s={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var s=this._url.tagName==="IMG",l=this._image=s?this._url:je("img");if(ie(l,"leaflet-image-layer"),this._zoomAnimated&&ie(l,"leaflet-zoom-animated"),this.options.className&&ie(l,this.options.className),l.onselectstart=v,l.onmousemove=v,l.onload=a(this.fire,this,"load"),l.onerror=a(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(l.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),s){this._url=l.src;return}l.src=this._url,l.alt=this.options.alt},_animateZoom:function(s){var l=this._map.getZoomScale(s.zoom),f=this._map._latLngBoundsToNewLayerBounds(this._bounds,s.zoom,s.center).min;cr(this._image,f,l)},_reset:function(){var s=this._image,l=new ue(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),f=l.getSize();Pe(s,l.min),s.style.width=f.x+"px",s.style.height=f.y+"px"},_updateOpacity:function(){$e(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var s=this.options.errorOverlayUrl;s&&this._url!==s&&(this._url=s,this._image.src=s)},getCenter:function(){return this._bounds.getCenter()}}),rP=function(s,l,f){return new wd(s,l,f)},Uv=wd.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var s=this._url.tagName==="VIDEO",l=this._image=s?this._url:je("video");if(ie(l,"leaflet-image-layer"),this._zoomAnimated&&ie(l,"leaflet-zoom-animated"),this.options.className&&ie(l,this.options.className),l.onselectstart=v,l.onmousemove=v,l.onloadeddata=a(this.fire,this,"load"),s){for(var f=l.getElementsByTagName("source"),m=[],_=0;_<f.length;_++)m.push(f[_].src);this._url=f.length>0?m:[l.src];return}R(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(l.style,"objectFit")&&(l.style.objectFit="fill"),l.autoplay=!!this.options.autoplay,l.loop=!!this.options.loop,l.muted=!!this.options.muted,l.playsInline=!!this.options.playsInline;for(var E=0;E<this._url.length;E++){var V=je("source");V.src=this._url[E],l.appendChild(V)}}});function iP(s,l,f){return new Uv(s,l,f)}var Bv=wd.extend({_initImage:function(){var s=this._image=this._url;ie(s,"leaflet-image-layer"),this._zoomAnimated&&ie(s,"leaflet-zoom-animated"),this.options.className&&ie(s,this.options.className),s.onselectstart=v,s.onmousemove=v}});function sP(s,l,f){return new Bv(s,l,f)}var ni=ot.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(s,l){s&&(s instanceof xe||R(s))?(this._latlng=ge(s),A(this,l)):(A(this,s),this._source=l),this.options.content&&(this._content=this.options.content)},openOn:function(s){return s=arguments.length?s:this._source._map,s.hasLayer(this)||s.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(s){return this._map?this.close():(arguments.length?this._source=s:s=this._source,this._prepareOpen(),this.openOn(s._map)),this},onAdd:function(s){this._zoomAnimated=s._zoomAnimated,this._container||this._initLayout(),s._fadeAnimated&&$e(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),s._fadeAnimated&&$e(this._container,1),this.bringToFront(),this.options.interactive&&(ie(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(s){s._fadeAnimated?($e(this._container,0),this._removeTimeout=setTimeout(a(Xe,void 0,this._container),200)):Xe(this._container),this.options.interactive&&(fe(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(s){return this._latlng=ge(s),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(s){return this._content=s,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var s={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&D(this._container),this},bringToBack:function(){return this._map&&Y(this._container),this},_prepareOpen:function(s){var l=this._source;if(!l._map)return!1;if(l instanceof jt){l=null;var f=this._source._layers;for(var m in f)if(f[m]._map){l=f[m];break}if(!l)return!1;this._source=l}if(!s)if(l.getCenter)s=l.getCenter();else if(l.getLatLng)s=l.getLatLng();else if(l.getBounds)s=l.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(s),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var s=this._contentNode,l=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof l=="string")s.innerHTML=l;else{for(;s.hasChildNodes();)s.removeChild(s.firstChild);s.appendChild(l)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var s=this._map.latLngToLayerPoint(this._latlng),l=X(this.options.offset),f=this._getAnchor();this._zoomAnimated?Pe(this._container,s.add(f)):l=l.add(s).add(f);var m=this._containerBottom=-l.y,_=this._containerLeft=-Math.round(this._containerWidth/2)+l.x;this._container.style.bottom=m+"px",this._container.style.left=_+"px"}},_getAnchor:function(){return[0,0]}});Ve.include({_initOverlay:function(s,l,f,m){var _=l;return _ instanceof s||(_=new s(m).setContent(l)),f&&_.setLatLng(f),_}}),ot.include({_initOverlay:function(s,l,f,m){var _=f;return _ instanceof s?(A(_,m),_._source=this):(_=l&&!m?l:new s(m,this),_.setContent(f)),_}});var bd=ni.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(s){return s=arguments.length?s:this._source._map,!s.hasLayer(this)&&s._popup&&s._popup.options.autoClose&&s.removeLayer(s._popup),s._popup=this,ni.prototype.openOn.call(this,s)},onAdd:function(s){ni.prototype.onAdd.call(this,s),s.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof ws||this._source.on("preclick",fr))},onRemove:function(s){ni.prototype.onRemove.call(this,s),s.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof ws||this._source.off("preclick",fr))},getEvents:function(){var s=ni.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(s.preclick=this.close),this.options.keepInView&&(s.moveend=this._adjustPan),s},_initLayout:function(){var s="leaflet-popup",l=this._container=je("div",s+" "+(this.options.className||"")+" leaflet-zoom-animated"),f=this._wrapper=je("div",s+"-content-wrapper",l);if(this._contentNode=je("div",s+"-content",f),_s(l),ys(this._contentNode),Ie(l,"contextmenu",fr),this._tipContainer=je("div",s+"-tip-container",l),this._tip=je("div",s+"-tip",this._tipContainer),this.options.closeButton){var m=this._closeButton=je("a",s+"-close-button",l);m.setAttribute("role","button"),m.setAttribute("aria-label","Close popup"),m.href="#close",m.innerHTML='<span aria-hidden="true">&#215;</span>',Ie(m,"click",function(_){xt(_),this.close()},this)}},_updateLayout:function(){var s=this._contentNode,l=s.style;l.width="",l.whiteSpace="nowrap";var f=s.offsetWidth;f=Math.min(f,this.options.maxWidth),f=Math.max(f,this.options.minWidth),l.width=f+1+"px",l.whiteSpace="",l.height="";var m=s.offsetHeight,_=this.options.maxHeight,E="leaflet-popup-scrolled";_&&m>_?(l.height=_+"px",ie(s,E)):fe(s,E),this._containerWidth=this._container.offsetWidth},_animateZoom:function(s){var l=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center),f=this._getAnchor();Pe(this._container,l.add(f))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var s=this._map,l=parseInt(Rr(this._container,"marginBottom"),10)||0,f=this._container.offsetHeight+l,m=this._containerWidth,_=new G(this._containerLeft,-f-this._containerBottom);_._add(Pn(this._container));var E=s.layerPointToContainerPoint(_),V=X(this.options.autoPanPadding),$=X(this.options.autoPanPaddingTopLeft||V),Z=X(this.options.autoPanPaddingBottomRight||V),ee=s.getSize(),he=0,ke=0;E.x+m+Z.x>ee.x&&(he=E.x+m-ee.x+Z.x),E.x-he-$.x<0&&(he=E.x-$.x),E.y+f+Z.y>ee.y&&(ke=E.y+f-ee.y+Z.y),E.y-ke-$.y<0&&(ke=E.y-$.y),(he||ke)&&(this.options.keepInView&&(this._autopanning=!0),s.fire("autopanstart").panBy([he,ke]))}},_getAnchor:function(){return X(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),oP=function(s,l){return new bd(s,l)};Ve.mergeOptions({closePopupOnClick:!0}),Ve.include({openPopup:function(s,l,f){return this._initOverlay(bd,s,l,f).openOn(this),this},closePopup:function(s){return s=arguments.length?s:this._popup,s&&s.close(),this}}),ot.include({bindPopup:function(s,l){return this._popup=this._initOverlay(bd,this._popup,s,l),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(s){return this._popup&&(this instanceof jt||(this._popup._source=this),this._popup._prepareOpen(s||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(s){return this._popup&&this._popup.setContent(s),this},getPopup:function(){return this._popup},_openPopup:function(s){if(!(!this._popup||!this._map)){Wn(s);var l=s.layer||s.target;if(this._popup._source===l&&!(l instanceof ws)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(s.latlng);return}this._popup._source=l,this.openPopup(s.latlng)}},_movePopup:function(s){this._popup.setLatLng(s.latlng)},_onKeyPress:function(s){s.originalEvent.keyCode===13&&this._openPopup(s)}});var Ed=ni.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(s){ni.prototype.onAdd.call(this,s),this.setOpacity(this.options.opacity),s.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(s){ni.prototype.onRemove.call(this,s),s.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var s=ni.prototype.getEvents.call(this);return this.options.permanent||(s.preclick=this.close),s},_initLayout:function(){var s="leaflet-tooltip",l=s+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=je("div",l),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+h(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(s){var l,f,m=this._map,_=this._container,E=m.latLngToContainerPoint(m.getCenter()),V=m.layerPointToContainerPoint(s),$=this.options.direction,Z=_.offsetWidth,ee=_.offsetHeight,he=X(this.options.offset),ke=this._getAnchor();$==="top"?(l=Z/2,f=ee):$==="bottom"?(l=Z/2,f=0):$==="center"?(l=Z/2,f=ee/2):$==="right"?(l=0,f=ee/2):$==="left"?(l=Z,f=ee/2):V.x<E.x?($="right",l=0,f=ee/2):($="left",l=Z+(he.x+ke.x)*2,f=ee/2),s=s.subtract(X(l,f,!0)).add(he).add(ke),fe(_,"leaflet-tooltip-right"),fe(_,"leaflet-tooltip-left"),fe(_,"leaflet-tooltip-top"),fe(_,"leaflet-tooltip-bottom"),ie(_,"leaflet-tooltip-"+$),Pe(_,s)},_updatePosition:function(){var s=this._map.latLngToLayerPoint(this._latlng);this._setPosition(s)},setOpacity:function(s){this.options.opacity=s,this._container&&$e(this._container,s)},_animateZoom:function(s){var l=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center);this._setPosition(l)},_getAnchor:function(){return X(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),aP=function(s,l){return new Ed(s,l)};Ve.include({openTooltip:function(s,l,f){return this._initOverlay(Ed,s,l,f).openOn(this),this},closeTooltip:function(s){return s.close(),this}}),ot.include({bindTooltip:function(s,l){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Ed,this._tooltip,s,l),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(s){if(!(!s&&this._tooltipHandlersAdded)){var l=s?"off":"on",f={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?f.add=this._openTooltip:(f.mouseover=this._openTooltip,f.mouseout=this.closeTooltip,f.click=this._openTooltip,this._map?this._addFocusListeners():f.add=this._addFocusListeners),this._tooltip.options.sticky&&(f.mousemove=this._moveTooltip),this[l](f),this._tooltipHandlersAdded=!s}},openTooltip:function(s){return this._tooltip&&(this instanceof jt||(this._tooltip._source=this),this._tooltip._prepareOpen(s)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(s){return this._tooltip&&this._tooltip.setContent(s),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(s){var l=typeof s.getElement=="function"&&s.getElement();l&&(Ie(l,"focus",function(){this._tooltip._source=s,this.openTooltip()},this),Ie(l,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(s){var l=typeof s.getElement=="function"&&s.getElement();l&&l.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(s){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var l=this;this._map.once("moveend",function(){l._openOnceFlag=!1,l._openTooltip(s)});return}this._tooltip._source=s.layer||s.target,this.openTooltip(this._tooltip.options.sticky?s.latlng:void 0)}},_moveTooltip:function(s){var l=s.latlng,f,m;this._tooltip.options.sticky&&s.originalEvent&&(f=this._map.mouseEventToContainerPoint(s.originalEvent),m=this._map.containerPointToLayerPoint(f),l=this._map.layerPointToLatLng(m)),this._tooltip.setLatLng(l)}});var zv=ti.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(s){var l=s&&s.tagName==="DIV"?s:document.createElement("div"),f=this.options;if(f.html instanceof Element?(Xr(l),l.appendChild(f.html)):l.innerHTML=f.html!==!1?f.html:"",f.bgPos){var m=X(f.bgPos);l.style.backgroundPosition=-m.x+"px "+-m.y+"px"}return this._setIconStyles(l,"icon"),l},createShadow:function(){return null}});function lP(s){return new zv(s)}ti.Default=hu;var fu=ot.extend({options:{tileSize:256,opacity:1,updateWhenIdle:oe.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(s){A(this,s)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(s){s._addZoomLimit(this)},onRemove:function(s){this._removeAllTiles(),Xe(this._container),s._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(D(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Y(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(s){return this.options.opacity=s,this._updateOpacity(),this},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var s=this._clampZoom(this._map.getZoom());s!==this._tileZoom&&(this._tileZoom=s,this._updateLevels()),this._update()}return this},getEvents:function(){var s={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=p(this._onMoveEnd,this.options.updateInterval,this)),s.move=this._onMove),this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},createTile:function(){return document.createElement("div")},getTileSize:function(){var s=this.options.tileSize;return s instanceof G?s:new G(s,s)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(s){for(var l=this.getPane().children,f=-s(-1/0,1/0),m=0,_=l.length,E;m<_;m++)E=l[m].style.zIndex,l[m]!==this._container&&E&&(f=s(f,+E));isFinite(f)&&(this.options.zIndex=f+s(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!oe.ielt9){$e(this._container,this.options.opacity);var s=+new Date,l=!1,f=!1;for(var m in this._tiles){var _=this._tiles[m];if(!(!_.current||!_.loaded)){var E=Math.min(1,(s-_.loaded)/200);$e(_.el,E),E<1?l=!0:(_.active?f=!0:this._onOpaqueTile(_),_.active=!0)}}f&&!this._noPrune&&this._pruneTiles(),l&&(F(this._fadeFrame),this._fadeFrame=O(this._updateOpacity,this))}},_onOpaqueTile:v,_initContainer:function(){this._container||(this._container=je("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var s=this._tileZoom,l=this.options.maxZoom;if(s!==void 0){for(var f in this._levels)f=Number(f),this._levels[f].el.children.length||f===s?(this._levels[f].el.style.zIndex=l-Math.abs(s-f),this._onUpdateLevel(f)):(Xe(this._levels[f].el),this._removeTilesAtZoom(f),this._onRemoveLevel(f),delete this._levels[f]);var m=this._levels[s],_=this._map;return m||(m=this._levels[s]={},m.el=je("div","leaflet-tile-container leaflet-zoom-animated",this._container),m.el.style.zIndex=l,m.origin=_.project(_.unproject(_.getPixelOrigin()),s).round(),m.zoom=s,this._setZoomTransform(m,_.getCenter(),_.getZoom()),v(m.el.offsetWidth),this._onCreateLevel(m)),this._level=m,m}},_onUpdateLevel:v,_onRemoveLevel:v,_onCreateLevel:v,_pruneTiles:function(){if(this._map){var s,l,f=this._map.getZoom();if(f>this.options.maxZoom||f<this.options.minZoom){this._removeAllTiles();return}for(s in this._tiles)l=this._tiles[s],l.retain=l.current;for(s in this._tiles)if(l=this._tiles[s],l.current&&!l.active){var m=l.coords;this._retainParent(m.x,m.y,m.z,m.z-5)||this._retainChildren(m.x,m.y,m.z,m.z+2)}for(s in this._tiles)this._tiles[s].retain||this._removeTile(s)}},_removeTilesAtZoom:function(s){for(var l in this._tiles)this._tiles[l].coords.z===s&&this._removeTile(l)},_removeAllTiles:function(){for(var s in this._tiles)this._removeTile(s)},_invalidateAll:function(){for(var s in this._levels)Xe(this._levels[s].el),this._onRemoveLevel(Number(s)),delete this._levels[s];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(s,l,f,m){var _=Math.floor(s/2),E=Math.floor(l/2),V=f-1,$=new G(+_,+E);$.z=+V;var Z=this._tileCoordsToKey($),ee=this._tiles[Z];return ee&&ee.active?(ee.retain=!0,!0):(ee&&ee.loaded&&(ee.retain=!0),V>m?this._retainParent(_,E,V,m):!1)},_retainChildren:function(s,l,f,m){for(var _=2*s;_<2*s+2;_++)for(var E=2*l;E<2*l+2;E++){var V=new G(_,E);V.z=f+1;var $=this._tileCoordsToKey(V),Z=this._tiles[$];if(Z&&Z.active){Z.retain=!0;continue}else Z&&Z.loaded&&(Z.retain=!0);f+1<m&&this._retainChildren(_,E,f+1,m)}},_resetView:function(s){var l=s&&(s.pinch||s.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),l,l)},_animateZoom:function(s){this._setView(s.center,s.zoom,!0,s.noUpdate)},_clampZoom:function(s){var l=this.options;return l.minNativeZoom!==void 0&&s<l.minNativeZoom?l.minNativeZoom:l.maxNativeZoom!==void 0&&l.maxNativeZoom<s?l.maxNativeZoom:s},_setView:function(s,l,f,m){var _=Math.round(l);this.options.maxZoom!==void 0&&_>this.options.maxZoom||this.options.minZoom!==void 0&&_<this.options.minZoom?_=void 0:_=this._clampZoom(_);var E=this.options.updateWhenZooming&&_!==this._tileZoom;(!m||E)&&(this._tileZoom=_,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),_!==void 0&&this._update(s),f||this._pruneTiles(),this._noPrune=!!f),this._setZoomTransforms(s,l)},_setZoomTransforms:function(s,l){for(var f in this._levels)this._setZoomTransform(this._levels[f],s,l)},_setZoomTransform:function(s,l,f){var m=this._map.getZoomScale(f,s.zoom),_=s.origin.multiplyBy(m).subtract(this._map._getNewPixelOrigin(l,f)).round();oe.any3d?cr(s.el,_,m):Pe(s.el,_)},_resetGrid:function(){var s=this._map,l=s.options.crs,f=this._tileSize=this.getTileSize(),m=this._tileZoom,_=this._map.getPixelWorldBounds(this._tileZoom);_&&(this._globalTileRange=this._pxBoundsToTileRange(_)),this._wrapX=l.wrapLng&&!this.options.noWrap&&[Math.floor(s.project([0,l.wrapLng[0]],m).x/f.x),Math.ceil(s.project([0,l.wrapLng[1]],m).x/f.y)],this._wrapY=l.wrapLat&&!this.options.noWrap&&[Math.floor(s.project([l.wrapLat[0],0],m).y/f.x),Math.ceil(s.project([l.wrapLat[1],0],m).y/f.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(s){var l=this._map,f=l._animatingZoom?Math.max(l._animateToZoom,l.getZoom()):l.getZoom(),m=l.getZoomScale(f,this._tileZoom),_=l.project(s,this._tileZoom).floor(),E=l.getSize().divideBy(m*2);return new ue(_.subtract(E),_.add(E))},_update:function(s){var l=this._map;if(l){var f=this._clampZoom(l.getZoom());if(s===void 0&&(s=l.getCenter()),this._tileZoom!==void 0){var m=this._getTiledPixelBounds(s),_=this._pxBoundsToTileRange(m),E=_.getCenter(),V=[],$=this.options.keepBuffer,Z=new ue(_.getBottomLeft().subtract([$,-$]),_.getTopRight().add([$,-$]));if(!(isFinite(_.min.x)&&isFinite(_.min.y)&&isFinite(_.max.x)&&isFinite(_.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var ee in this._tiles){var he=this._tiles[ee].coords;(he.z!==this._tileZoom||!Z.contains(new G(he.x,he.y)))&&(this._tiles[ee].current=!1)}if(Math.abs(f-this._tileZoom)>1){this._setView(s,f);return}for(var ke=_.min.y;ke<=_.max.y;ke++)for(var Me=_.min.x;Me<=_.max.x;Me++){var vn=new G(Me,ke);if(vn.z=this._tileZoom,!!this._isValidTile(vn)){var Kt=this._tiles[this._tileCoordsToKey(vn)];Kt?Kt.current=!0:V.push(vn)}}if(V.sort(function(Cn,Oa){return Cn.distanceTo(E)-Oa.distanceTo(E)}),V.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var mr=document.createDocumentFragment();for(Me=0;Me<V.length;Me++)this._addTile(V[Me],mr);this._level.el.appendChild(mr)}}}},_isValidTile:function(s){var l=this._map.options.crs;if(!l.infinite){var f=this._globalTileRange;if(!l.wrapLng&&(s.x<f.min.x||s.x>f.max.x)||!l.wrapLat&&(s.y<f.min.y||s.y>f.max.y))return!1}if(!this.options.bounds)return!0;var m=this._tileCoordsToBounds(s);return Te(this.options.bounds).overlaps(m)},_keyToBounds:function(s){return this._tileCoordsToBounds(this._keyToTileCoords(s))},_tileCoordsToNwSe:function(s){var l=this._map,f=this.getTileSize(),m=s.scaleBy(f),_=m.add(f),E=l.unproject(m,s.z),V=l.unproject(_,s.z);return[E,V]},_tileCoordsToBounds:function(s){var l=this._tileCoordsToNwSe(s),f=new ve(l[0],l[1]);return this.options.noWrap||(f=this._map.wrapLatLngBounds(f)),f},_tileCoordsToKey:function(s){return s.x+":"+s.y+":"+s.z},_keyToTileCoords:function(s){var l=s.split(":"),f=new G(+l[0],+l[1]);return f.z=+l[2],f},_removeTile:function(s){var l=this._tiles[s];l&&(Xe(l.el),delete this._tiles[s],this.fire("tileunload",{tile:l.el,coords:this._keyToTileCoords(s)}))},_initTile:function(s){ie(s,"leaflet-tile");var l=this.getTileSize();s.style.width=l.x+"px",s.style.height=l.y+"px",s.onselectstart=v,s.onmousemove=v,oe.ielt9&&this.options.opacity<1&&$e(s,this.options.opacity)},_addTile:function(s,l){var f=this._getTilePos(s),m=this._tileCoordsToKey(s),_=this.createTile(this._wrapCoords(s),a(this._tileReady,this,s));this._initTile(_),this.createTile.length<2&&O(a(this._tileReady,this,s,null,_)),Pe(_,f),this._tiles[m]={el:_,coords:s,current:!0},l.appendChild(_),this.fire("tileloadstart",{tile:_,coords:s})},_tileReady:function(s,l,f){l&&this.fire("tileerror",{error:l,tile:f,coords:s});var m=this._tileCoordsToKey(s);f=this._tiles[m],f&&(f.loaded=+new Date,this._map._fadeAnimated?($e(f.el,0),F(this._fadeFrame),this._fadeFrame=O(this._updateOpacity,this)):(f.active=!0,this._pruneTiles()),l||(ie(f.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:f.el,coords:s})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),oe.ielt9||!this._map._fadeAnimated?O(this._pruneTiles,this):setTimeout(a(this._pruneTiles,this),250)))},_getTilePos:function(s){return s.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(s){var l=new G(this._wrapX?y(s.x,this._wrapX):s.x,this._wrapY?y(s.y,this._wrapY):s.y);return l.z=s.z,l},_pxBoundsToTileRange:function(s){var l=this.getTileSize();return new ue(s.min.unscaleBy(l).floor(),s.max.unscaleBy(l).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var s in this._tiles)if(!this._tiles[s].loaded)return!1;return!0}});function uP(s){return new fu(s)}var Ma=fu.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(s,l){this._url=s,l=A(this,l),l.detectRetina&&oe.retina&&l.maxZoom>0?(l.tileSize=Math.floor(l.tileSize/2),l.zoomReverse?(l.zoomOffset--,l.minZoom=Math.min(l.maxZoom,l.minZoom+1)):(l.zoomOffset++,l.maxZoom=Math.max(l.minZoom,l.maxZoom-1)),l.minZoom=Math.max(0,l.minZoom)):l.zoomReverse?l.minZoom=Math.min(l.maxZoom,l.minZoom):l.maxZoom=Math.max(l.minZoom,l.maxZoom),typeof l.subdomains=="string"&&(l.subdomains=l.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(s,l){return this._url===s&&l===void 0&&(l=!0),this._url=s,l||this.redraw(),this},createTile:function(s,l){var f=document.createElement("img");return Ie(f,"load",a(this._tileOnLoad,this,l,f)),Ie(f,"error",a(this._tileOnError,this,l,f)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(f.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(f.referrerPolicy=this.options.referrerPolicy),f.alt="",f.src=this.getTileUrl(s),f},getTileUrl:function(s){var l={r:oe.retina?"@2x":"",s:this._getSubdomain(s),x:s.x,y:s.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var f=this._globalTileRange.max.y-s.y;this.options.tms&&(l.y=f),l["-y"]=f}return k(this._url,i(l,this.options))},_tileOnLoad:function(s,l){oe.ielt9?setTimeout(a(s,this,null,l),0):s(null,l)},_tileOnError:function(s,l,f){var m=this.options.errorTileUrl;m&&l.getAttribute("src")!==m&&(l.src=m),s(f,l)},_onTileRemove:function(s){s.tile.onload=null},_getZoomForUrl:function(){var s=this._tileZoom,l=this.options.maxZoom,f=this.options.zoomReverse,m=this.options.zoomOffset;return f&&(s=l-s),s+m},_getSubdomain:function(s){var l=Math.abs(s.x+s.y)%this.options.subdomains.length;return this.options.subdomains[l]},_abortLoading:function(){var s,l;for(s in this._tiles)if(this._tiles[s].coords.z!==this._tileZoom&&(l=this._tiles[s].el,l.onload=v,l.onerror=v,!l.complete)){l.src=K;var f=this._tiles[s].coords;Xe(l),delete this._tiles[s],this.fire("tileabort",{tile:l,coords:f})}},_removeTile:function(s){var l=this._tiles[s];if(l)return l.el.setAttribute("src",K),fu.prototype._removeTile.call(this,s)},_tileReady:function(s,l,f){if(!(!this._map||f&&f.getAttribute("src")===K))return fu.prototype._tileReady.call(this,s,l,f)}});function qv(s,l){return new Ma(s,l)}var $v=Ma.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(s,l){this._url=s;var f=i({},this.defaultWmsParams);for(var m in l)m in this.options||(f[m]=l[m]);l=A(this,l);var _=l.detectRetina&&oe.retina?2:1,E=this.getTileSize();f.width=E.x*_,f.height=E.y*_,this.wmsParams=f},onAdd:function(s){this._crs=this.options.crs||s.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var l=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[l]=this._crs.code,Ma.prototype.onAdd.call(this,s)},getTileUrl:function(s){var l=this._tileCoordsToNwSe(s),f=this._crs,m=de(f.project(l[0]),f.project(l[1])),_=m.min,E=m.max,V=(this._wmsVersion>=1.3&&this._crs===Ot?[_.y,_.x,E.y,E.x]:[_.x,_.y,E.x,E.y]).join(","),$=Ma.prototype.getTileUrl.call(this,s);return $+U(this.wmsParams,$,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+V},setParams:function(s,l){return i(this.wmsParams,s),l||this.redraw(),this}});function cP(s,l){return new $v(s,l)}Ma.WMS=$v,qv.wms=cP;var Si=ot.extend({options:{padding:.1},initialize:function(s){A(this,s),h(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),ie(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var s={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(s.zoomanim=this._onAnimZoom),s},_onAnimZoom:function(s){this._updateTransform(s.center,s.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(s,l){var f=this._map.getZoomScale(l,this._zoom),m=this._map.getSize().multiplyBy(.5+this.options.padding),_=this._map.project(this._center,l),E=m.multiplyBy(-f).add(_).subtract(this._map._getNewPixelOrigin(s,l));oe.any3d?cr(this._container,E,f):Pe(this._container,E)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var s in this._layers)this._layers[s]._reset()},_onZoomEnd:function(){for(var s in this._layers)this._layers[s]._project()},_updatePaths:function(){for(var s in this._layers)this._layers[s]._update()},_update:function(){var s=this.options.padding,l=this._map.getSize(),f=this._map.containerPointToLayerPoint(l.multiplyBy(-s)).round();this._bounds=new ue(f,f.add(l.multiplyBy(1+s*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Hv=Si.extend({options:{tolerance:0},getEvents:function(){var s=Si.prototype.getEvents.call(this);return s.viewprereset=this._onViewPreReset,s},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Si.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var s=this._container=document.createElement("canvas");Ie(s,"mousemove",this._onMouseMove,this),Ie(s,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Ie(s,"mouseout",this._handleMouseOut,this),s._leaflet_disable_events=!0,this._ctx=s.getContext("2d")},_destroyContainer:function(){F(this._redrawRequest),delete this._ctx,Xe(this._container),st(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var s;this._redrawBounds=null;for(var l in this._layers)s=this._layers[l],s._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Si.prototype._update.call(this);var s=this._bounds,l=this._container,f=s.getSize(),m=oe.retina?2:1;Pe(l,s.min),l.width=m*f.x,l.height=m*f.y,l.style.width=f.x+"px",l.style.height=f.y+"px",oe.retina&&this._ctx.scale(2,2),this._ctx.translate(-s.min.x,-s.min.y),this.fire("update")}},_reset:function(){Si.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(s){this._updateDashArray(s),this._layers[h(s)]=s;var l=s._order={layer:s,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=l),this._drawLast=l,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(s){this._requestRedraw(s)},_removePath:function(s){var l=s._order,f=l.next,m=l.prev;f?f.prev=m:this._drawLast=m,m?m.next=f:this._drawFirst=f,delete s._order,delete this._layers[h(s)],this._requestRedraw(s)},_updatePath:function(s){this._extendRedrawBounds(s),s._project(),s._update(),this._requestRedraw(s)},_updateStyle:function(s){this._updateDashArray(s),this._requestRedraw(s)},_updateDashArray:function(s){if(typeof s.options.dashArray=="string"){var l=s.options.dashArray.split(/[, ]+/),f=[],m,_;for(_=0;_<l.length;_++){if(m=Number(l[_]),isNaN(m))return;f.push(m)}s.options._dashArray=f}else s.options._dashArray=s.options.dashArray},_requestRedraw:function(s){this._map&&(this._extendRedrawBounds(s),this._redrawRequest=this._redrawRequest||O(this._redraw,this))},_extendRedrawBounds:function(s){if(s._pxBounds){var l=(s.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new ue,this._redrawBounds.extend(s._pxBounds.min.subtract([l,l])),this._redrawBounds.extend(s._pxBounds.max.add([l,l]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var s=this._redrawBounds;if(s){var l=s.getSize();this._ctx.clearRect(s.min.x,s.min.y,l.x,l.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var s,l=this._redrawBounds;if(this._ctx.save(),l){var f=l.getSize();this._ctx.beginPath(),this._ctx.rect(l.min.x,l.min.y,f.x,f.y),this._ctx.clip()}this._drawing=!0;for(var m=this._drawFirst;m;m=m.next)s=m.layer,(!l||s._pxBounds&&s._pxBounds.intersects(l))&&s._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(s,l){if(this._drawing){var f,m,_,E,V=s._parts,$=V.length,Z=this._ctx;if($){for(Z.beginPath(),f=0;f<$;f++){for(m=0,_=V[f].length;m<_;m++)E=V[f][m],Z[m?"lineTo":"moveTo"](E.x,E.y);l&&Z.closePath()}this._fillStroke(Z,s)}}},_updateCircle:function(s){if(!(!this._drawing||s._empty())){var l=s._point,f=this._ctx,m=Math.max(Math.round(s._radius),1),_=(Math.max(Math.round(s._radiusY),1)||m)/m;_!==1&&(f.save(),f.scale(1,_)),f.beginPath(),f.arc(l.x,l.y/_,m,0,Math.PI*2,!1),_!==1&&f.restore(),this._fillStroke(f,s)}},_fillStroke:function(s,l){var f=l.options;f.fill&&(s.globalAlpha=f.fillOpacity,s.fillStyle=f.fillColor||f.color,s.fill(f.fillRule||"evenodd")),f.stroke&&f.weight!==0&&(s.setLineDash&&s.setLineDash(l.options&&l.options._dashArray||[]),s.globalAlpha=f.opacity,s.lineWidth=f.weight,s.strokeStyle=f.color,s.lineCap=f.lineCap,s.lineJoin=f.lineJoin,s.stroke())},_onClick:function(s){for(var l=this._map.mouseEventToLayerPoint(s),f,m,_=this._drawFirst;_;_=_.next)f=_.layer,f.options.interactive&&f._containsPoint(l)&&(!(s.type==="click"||s.type==="preclick")||!this._map._draggableMoved(f))&&(m=f);this._fireEvent(m?[m]:!1,s)},_onMouseMove:function(s){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var l=this._map.mouseEventToLayerPoint(s);this._handleMouseHover(s,l)}},_handleMouseOut:function(s){var l=this._hoveredLayer;l&&(fe(this._container,"leaflet-interactive"),this._fireEvent([l],s,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(s,l){if(!this._mouseHoverThrottled){for(var f,m,_=this._drawFirst;_;_=_.next)f=_.layer,f.options.interactive&&f._containsPoint(l)&&(m=f);m!==this._hoveredLayer&&(this._handleMouseOut(s),m&&(ie(this._container,"leaflet-interactive"),this._fireEvent([m],s,"mouseover"),this._hoveredLayer=m)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,s),this._mouseHoverThrottled=!0,setTimeout(a(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(s,l,f){this._map._fireDOMEvent(l,f||l.type,s)},_bringToFront:function(s){var l=s._order;if(l){var f=l.next,m=l.prev;if(f)f.prev=m;else return;m?m.next=f:f&&(this._drawFirst=f),l.prev=this._drawLast,this._drawLast.next=l,l.next=null,this._drawLast=l,this._requestRedraw(s)}},_bringToBack:function(s){var l=s._order;if(l){var f=l.next,m=l.prev;if(m)m.next=f;else return;f?f.prev=m:m&&(this._drawLast=m),l.prev=null,l.next=this._drawFirst,this._drawFirst.prev=l,this._drawFirst=l,this._requestRedraw(s)}}});function Wv(s){return oe.canvas?new Hv(s):null}var pu=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(s){return document.createElement("<lvml:"+s+' class="lvml">')}}catch{}return function(s){return document.createElement("<"+s+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),dP={_initContainer:function(){this._container=je("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Si.prototype._update.call(this),this.fire("update"))},_initPath:function(s){var l=s._container=pu("shape");ie(l,"leaflet-vml-shape "+(this.options.className||"")),l.coordsize="1 1",s._path=pu("path"),l.appendChild(s._path),this._updateStyle(s),this._layers[h(s)]=s},_addPath:function(s){var l=s._container;this._container.appendChild(l),s.options.interactive&&s.addInteractiveTarget(l)},_removePath:function(s){var l=s._container;Xe(l),s.removeInteractiveTarget(l),delete this._layers[h(s)]},_updateStyle:function(s){var l=s._stroke,f=s._fill,m=s.options,_=s._container;_.stroked=!!m.stroke,_.filled=!!m.fill,m.stroke?(l||(l=s._stroke=pu("stroke")),_.appendChild(l),l.weight=m.weight+"px",l.color=m.color,l.opacity=m.opacity,m.dashArray?l.dashStyle=R(m.dashArray)?m.dashArray.join(" "):m.dashArray.replace(/( *, *)/g," "):l.dashStyle="",l.endcap=m.lineCap.replace("butt","flat"),l.joinstyle=m.lineJoin):l&&(_.removeChild(l),s._stroke=null),m.fill?(f||(f=s._fill=pu("fill")),_.appendChild(f),f.color=m.fillColor||m.color,f.opacity=m.fillOpacity):f&&(_.removeChild(f),s._fill=null)},_updateCircle:function(s){var l=s._point.round(),f=Math.round(s._radius),m=Math.round(s._radiusY||f);this._setPath(s,s._empty()?"M0 0":"AL "+l.x+","+l.y+" "+f+","+m+" 0,"+65535*360)},_setPath:function(s,l){s._path.v=l},_bringToFront:function(s){D(s._container)},_bringToBack:function(s){Y(s._container)}},Td=oe.vml?pu:or,mu=Si.extend({_initContainer:function(){this._container=Td("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Td("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Xe(this._container),st(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Si.prototype._update.call(this);var s=this._bounds,l=s.getSize(),f=this._container;(!this._svgSize||!this._svgSize.equals(l))&&(this._svgSize=l,f.setAttribute("width",l.x),f.setAttribute("height",l.y)),Pe(f,s.min),f.setAttribute("viewBox",[s.min.x,s.min.y,l.x,l.y].join(" ")),this.fire("update")}},_initPath:function(s){var l=s._path=Td("path");s.options.className&&ie(l,s.options.className),s.options.interactive&&ie(l,"leaflet-interactive"),this._updateStyle(s),this._layers[h(s)]=s},_addPath:function(s){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(s._path),s.addInteractiveTarget(s._path)},_removePath:function(s){Xe(s._path),s.removeInteractiveTarget(s._path),delete this._layers[h(s)]},_updatePath:function(s){s._project(),s._update()},_updateStyle:function(s){var l=s._path,f=s.options;l&&(f.stroke?(l.setAttribute("stroke",f.color),l.setAttribute("stroke-opacity",f.opacity),l.setAttribute("stroke-width",f.weight),l.setAttribute("stroke-linecap",f.lineCap),l.setAttribute("stroke-linejoin",f.lineJoin),f.dashArray?l.setAttribute("stroke-dasharray",f.dashArray):l.removeAttribute("stroke-dasharray"),f.dashOffset?l.setAttribute("stroke-dashoffset",f.dashOffset):l.removeAttribute("stroke-dashoffset")):l.setAttribute("stroke","none"),f.fill?(l.setAttribute("fill",f.fillColor||f.color),l.setAttribute("fill-opacity",f.fillOpacity),l.setAttribute("fill-rule",f.fillRule||"evenodd")):l.setAttribute("fill","none"))},_updatePoly:function(s,l){this._setPath(s,rs(s._parts,l))},_updateCircle:function(s){var l=s._point,f=Math.max(Math.round(s._radius),1),m=Math.max(Math.round(s._radiusY),1)||f,_="a"+f+","+m+" 0 1,0 ",E=s._empty()?"M0 0":"M"+(l.x-f)+","+l.y+_+f*2+",0 "+_+-f*2+",0 ";this._setPath(s,E)},_setPath:function(s,l){s._path.setAttribute("d",l)},_bringToFront:function(s){D(s._path)},_bringToBack:function(s){Y(s._path)}});oe.vml&&mu.include(dP);function Gv(s){return oe.svg||oe.vml?new mu(s):null}Ve.include({getRenderer:function(s){var l=s.options.renderer||this._getPaneRenderer(s.options.pane)||this.options.renderer||this._renderer;return l||(l=this._renderer=this._createRenderer()),this.hasLayer(l)||this.addLayer(l),l},_getPaneRenderer:function(s){if(s==="overlayPane"||s===void 0)return!1;var l=this._paneRenderers[s];return l===void 0&&(l=this._createRenderer({pane:s}),this._paneRenderers[s]=l),l},_createRenderer:function(s){return this.options.preferCanvas&&Wv(s)||Gv(s)}});var Kv=La.extend({initialize:function(s,l){La.prototype.initialize.call(this,this._boundsToLatLngs(s),l)},setBounds:function(s){return this.setLatLngs(this._boundsToLatLngs(s))},_boundsToLatLngs:function(s){return s=Te(s),[s.getSouthWest(),s.getNorthWest(),s.getNorthEast(),s.getSouthEast()]}});function hP(s,l){return new Kv(s,l)}mu.create=Td,mu.pointsToPath=rs,ki.geometryToLayer=yd,ki.coordsToLatLng=Rp,ki.coordsToLatLngs=_d,ki.latLngToCoords=jp,ki.latLngsToCoords=vd,ki.getFeature=Da,ki.asFeature=xd,Ve.mergeOptions({boxZoom:!0});var Zv=Gn.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane,this._resetStateTimeout=0,s.on("unload",this._destroy,this)},addHooks:function(){Ie(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){st(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Xe(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(s){if(!s.shiftKey||s.which!==1&&s.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),An(),Jl(),this._startPoint=this._map.mouseEventToContainerPoint(s),Ie(document,{contextmenu:Wn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(s){this._moved||(this._moved=!0,this._box=je("div","leaflet-zoom-box",this._container),ie(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(s);var l=new ue(this._point,this._startPoint),f=l.getSize();Pe(this._box,l.min),this._box.style.width=f.x+"px",this._box.style.height=f.y+"px"},_finish:function(){this._moved&&(Xe(this._box),fe(this._container,"leaflet-crosshair")),jr(),Xl(),st(document,{contextmenu:Wn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(s){if(!(s.which!==1&&s.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(a(this._resetState,this),0);var l=new ve(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(l).fire("boxzoomend",{boxZoomBounds:l})}},_onKeyDown:function(s){s.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Ve.addInitHook("addHandler","boxZoom",Zv),Ve.mergeOptions({doubleClickZoom:!0});var Qv=Gn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(s){var l=this._map,f=l.getZoom(),m=l.options.zoomDelta,_=s.originalEvent.shiftKey?f-m:f+m;l.options.doubleClickZoom==="center"?l.setZoom(_):l.setZoomAround(s.containerPoint,_)}});Ve.addInitHook("addHandler","doubleClickZoom",Qv),Ve.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Yv=Gn.extend({addHooks:function(){if(!this._draggable){var s=this._map;this._draggable=new Lr(s._mapPane,s._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),s.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),s.on("zoomend",this._onZoomEnd,this),s.whenReady(this._onZoomEnd,this))}ie(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){fe(this._map._container,"leaflet-grab"),fe(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var s=this._map;if(s._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var l=Te(this._map.options.maxBounds);this._offsetLimit=de(this._map.latLngToContainerPoint(l.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(l.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;s.fire("movestart").fire("dragstart"),s.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(s){if(this._map.options.inertia){var l=this._lastTime=+new Date,f=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(f),this._times.push(l),this._prunePositions(l)}this._map.fire("move",s).fire("drag",s)},_prunePositions:function(s){for(;this._positions.length>1&&s-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var s=this._map.getSize().divideBy(2),l=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=l.subtract(s).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(s,l){return s-(s-l)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var s=this._draggable._newPos.subtract(this._draggable._startPos),l=this._offsetLimit;s.x<l.min.x&&(s.x=this._viscousLimit(s.x,l.min.x)),s.y<l.min.y&&(s.y=this._viscousLimit(s.y,l.min.y)),s.x>l.max.x&&(s.x=this._viscousLimit(s.x,l.max.x)),s.y>l.max.y&&(s.y=this._viscousLimit(s.y,l.max.y)),this._draggable._newPos=this._draggable._startPos.add(s)}},_onPreDragWrap:function(){var s=this._worldWidth,l=Math.round(s/2),f=this._initialWorldOffset,m=this._draggable._newPos.x,_=(m-l+f)%s+l-f,E=(m+l+f)%s-l-f,V=Math.abs(_+f)<Math.abs(E+f)?_:E;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=V},_onDragEnd:function(s){var l=this._map,f=l.options,m=!f.inertia||s.noInertia||this._times.length<2;if(l.fire("dragend",s),m)l.fire("moveend");else{this._prunePositions(+new Date);var _=this._lastPos.subtract(this._positions[0]),E=(this._lastTime-this._times[0])/1e3,V=f.easeLinearity,$=_.multiplyBy(V/E),Z=$.distanceTo([0,0]),ee=Math.min(f.inertiaMaxSpeed,Z),he=$.multiplyBy(ee/Z),ke=ee/(f.inertiaDeceleration*V),Me=he.multiplyBy(-ke/2).round();!Me.x&&!Me.y?l.fire("moveend"):(Me=l._limitOffset(Me,l.options.maxBounds),O(function(){l.panBy(Me,{duration:ke,easeLinearity:V,noMoveStart:!0,animate:!0})}))}}});Ve.addInitHook("addHandler","dragging",Yv),Ve.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Jv=Gn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(s){this._map=s,this._setPanDelta(s.options.keyboardPanDelta),this._setZoomDelta(s.options.zoomDelta)},addHooks:function(){var s=this._map._container;s.tabIndex<=0&&(s.tabIndex="0"),Ie(s,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),st(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var s=document.body,l=document.documentElement,f=s.scrollTop||l.scrollTop,m=s.scrollLeft||l.scrollLeft;this._map._container.focus(),window.scrollTo(m,f)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(s){var l=this._panKeys={},f=this.keyCodes,m,_;for(m=0,_=f.left.length;m<_;m++)l[f.left[m]]=[-1*s,0];for(m=0,_=f.right.length;m<_;m++)l[f.right[m]]=[s,0];for(m=0,_=f.down.length;m<_;m++)l[f.down[m]]=[0,s];for(m=0,_=f.up.length;m<_;m++)l[f.up[m]]=[0,-1*s]},_setZoomDelta:function(s){var l=this._zoomKeys={},f=this.keyCodes,m,_;for(m=0,_=f.zoomIn.length;m<_;m++)l[f.zoomIn[m]]=s;for(m=0,_=f.zoomOut.length;m<_;m++)l[f.zoomOut[m]]=-s},_addHooks:function(){Ie(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){st(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(s){if(!(s.altKey||s.ctrlKey||s.metaKey)){var l=s.keyCode,f=this._map,m;if(l in this._panKeys){if(!f._panAnim||!f._panAnim._inProgress)if(m=this._panKeys[l],s.shiftKey&&(m=X(m).multiplyBy(3)),f.options.maxBounds&&(m=f._limitOffset(X(m),f.options.maxBounds)),f.options.worldCopyJump){var _=f.wrapLatLng(f.unproject(f.project(f.getCenter()).add(m)));f.panTo(_)}else f.panBy(m)}else if(l in this._zoomKeys)f.setZoom(f.getZoom()+(s.shiftKey?3:1)*this._zoomKeys[l]);else if(l===27&&f._popup&&f._popup.options.closeOnEscapeKey)f.closePopup();else return;Wn(s)}}});Ve.addInitHook("addHandler","keyboard",Jv),Ve.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Xv=Gn.extend({addHooks:function(){Ie(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){st(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(s){var l=ld(s),f=this._map.options.wheelDebounceTime;this._delta+=l,this._lastMousePos=this._map.mouseEventToContainerPoint(s),this._startTime||(this._startTime=+new Date);var m=Math.max(f-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(a(this._performZoom,this),m),Wn(s)},_performZoom:function(){var s=this._map,l=s.getZoom(),f=this._map.options.zoomSnap||0;s._stop();var m=this._delta/(this._map.options.wheelPxPerZoomLevel*4),_=4*Math.log(2/(1+Math.exp(-Math.abs(m))))/Math.LN2,E=f?Math.ceil(_/f)*f:_,V=s._limitZoom(l+(this._delta>0?E:-E))-l;this._delta=0,this._startTime=null,V&&(s.options.scrollWheelZoom==="center"?s.setZoom(l+V):s.setZoomAround(this._lastMousePos,l+V))}});Ve.addInitHook("addHandler","scrollWheelZoom",Xv);var fP=600;Ve.mergeOptions({tapHold:oe.touchNative&&oe.safari&&oe.mobile,tapTolerance:15});var e0=Gn.extend({addHooks:function(){Ie(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){st(this._map._container,"touchstart",this._onDown,this)},_onDown:function(s){if(clearTimeout(this._holdTimeout),s.touches.length===1){var l=s.touches[0];this._startPos=this._newPos=new G(l.clientX,l.clientY),this._holdTimeout=setTimeout(a(function(){this._cancel(),this._isTapValid()&&(Ie(document,"touchend",xt),Ie(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",l))},this),fP),Ie(document,"touchend touchcancel contextmenu",this._cancel,this),Ie(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function s(){st(document,"touchend",xt),st(document,"touchend touchcancel",s)},_cancel:function(){clearTimeout(this._holdTimeout),st(document,"touchend touchcancel contextmenu",this._cancel,this),st(document,"touchmove",this._onMove,this)},_onMove:function(s){var l=s.touches[0];this._newPos=new G(l.clientX,l.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(s,l){var f=new MouseEvent(s,{bubbles:!0,cancelable:!0,view:window,screenX:l.screenX,screenY:l.screenY,clientX:l.clientX,clientY:l.clientY});f._simulated=!0,l.target.dispatchEvent(f)}});Ve.addInitHook("addHandler","tapHold",e0),Ve.mergeOptions({touchZoom:oe.touch,bounceAtZoomLimits:!0});var t0=Gn.extend({addHooks:function(){ie(this._map._container,"leaflet-touch-zoom"),Ie(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){fe(this._map._container,"leaflet-touch-zoom"),st(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(s){var l=this._map;if(!(!s.touches||s.touches.length!==2||l._animatingZoom||this._zooming)){var f=l.mouseEventToContainerPoint(s.touches[0]),m=l.mouseEventToContainerPoint(s.touches[1]);this._centerPoint=l.getSize()._divideBy(2),this._startLatLng=l.containerPointToLatLng(this._centerPoint),l.options.touchZoom!=="center"&&(this._pinchStartLatLng=l.containerPointToLatLng(f.add(m)._divideBy(2))),this._startDist=f.distanceTo(m),this._startZoom=l.getZoom(),this._moved=!1,this._zooming=!0,l._stop(),Ie(document,"touchmove",this._onTouchMove,this),Ie(document,"touchend touchcancel",this._onTouchEnd,this),xt(s)}},_onTouchMove:function(s){if(!(!s.touches||s.touches.length!==2||!this._zooming)){var l=this._map,f=l.mouseEventToContainerPoint(s.touches[0]),m=l.mouseEventToContainerPoint(s.touches[1]),_=f.distanceTo(m)/this._startDist;if(this._zoom=l.getScaleZoom(_,this._startZoom),!l.options.bounceAtZoomLimits&&(this._zoom<l.getMinZoom()&&_<1||this._zoom>l.getMaxZoom()&&_>1)&&(this._zoom=l._limitZoom(this._zoom)),l.options.touchZoom==="center"){if(this._center=this._startLatLng,_===1)return}else{var E=f._add(m)._divideBy(2)._subtract(this._centerPoint);if(_===1&&E.x===0&&E.y===0)return;this._center=l.unproject(l.project(this._pinchStartLatLng,this._zoom).subtract(E),this._zoom)}this._moved||(l._moveStart(!0,!1),this._moved=!0),F(this._animRequest);var V=a(l._move,l,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=O(V,this,!0),xt(s)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,F(this._animRequest),st(document,"touchmove",this._onTouchMove,this),st(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Ve.addInitHook("addHandler","touchZoom",t0),Ve.BoxZoom=Zv,Ve.DoubleClickZoom=Qv,Ve.Drag=Yv,Ve.Keyboard=Jv,Ve.ScrollWheelZoom=Xv,Ve.TapHold=e0,Ve.TouchZoom=t0,n.Bounds=ue,n.Browser=oe,n.CRS=Je,n.Canvas=Hv,n.Circle=Cp,n.CircleMarker=gd,n.Class=be,n.Control=Nn,n.DivIcon=zv,n.DivOverlay=ni,n.DomEvent=ud,n.DomUtil=od,n.Draggable=Lr,n.Evented=ut,n.FeatureGroup=jt,n.GeoJSON=ki,n.GridLayer=fu,n.Handler=Gn,n.Icon=ti,n.ImageOverlay=wd,n.LatLng=xe,n.LatLngBounds=ve,n.Layer=ot,n.LayerGroup=wt,n.LineUtil=I,n.Map=Ve,n.Marker=md,n.Mixin=_o,n.Path=ws,n.Point=G,n.PolyUtil=Ca,n.Polygon=La,n.Polyline=Ii,n.Popup=bd,n.PosAnimation=ou,n.Projection=ae,n.Rectangle=Kv,n.Renderer=Si,n.SVG=mu,n.SVGOverlay=Bv,n.TileLayer=Ma,n.Tooltip=Ed,n.Transformation=Ue,n.Util=M,n.VideoOverlay=Uv,n.bind=a,n.bounds=de,n.canvas=Wv,n.circle=X1,n.circleMarker=J1,n.control=_n,n.divIcon=lP,n.extend=i,n.featureGroup=ja,n.geoJSON=Fv,n.geoJson=nP,n.gridLayer=uP,n.icon=Q1,n.imageOverlay=rP,n.latLng=ge,n.latLngBounds=Te,n.layerGroup=xs,n.map=Ia,n.marker=Y1,n.point=X,n.polygon=tP,n.polyline=eP,n.popup=oP,n.rectangle=hP,n.setOptions=A,n.stamp=h,n.svg=Gv,n.svgOverlay=sP,n.tileLayer=qv,n.tooltip=aP,n.transformation=yt,n.version=r,n.videoOverlay=iP;var pP=window.L;n.noConflict=function(){return window.L=pP,this},window.L=n})})(ry,ry.exports);var sd=ry.exports;const Sv=Pb(sd);function Pv(t,e,n){return Object.freeze({instance:t,context:e,container:n})}function Av(t,e){return e==null?function(r,i){const o=B.useRef();return o.current||(o.current=t(r,i)),o}:function(r,i){const o=B.useRef();o.current||(o.current=t(r,i));const a=B.useRef(r),{instance:c}=o.current;return B.useEffect(function(){a.current!==r&&(e(c,r,a.current),a.current=r)},[c,r,i]),o}}function b5(t,e){B.useEffect(function(){return(e.layerContainer??e.map).addLayer(t.instance),function(){var o;(o=e.layerContainer)==null||o.removeLayer(t.instance),e.map.removeLayer(t.instance)}},[e,t])}function F1(t){return function(n){const r=Iv(),i=t(kv(n,r),r);return D1(r.map,n.attribution),V1(i.current,n.eventHandlers),b5(i.current,r),i}}function E5(t,e){const n=Av(t,e),r=F1(n);return _5(r)}function T5(t,e){const n=Av(t),r=w5(n,e);return v5(r)}function I5(t,e){const n=Av(t,e),r=F1(n);return x5(r)}function k5(t,e,n){const{opacity:r,zIndex:i}=e;r!=null&&r!==n.opacity&&t.setOpacity(r),i!=null&&i!==n.zIndex&&t.setZIndex(i)}function S5(){return Iv().map}function iy(){return iy=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},iy.apply(this,arguments)}function P5({bounds:t,boundsOptions:e,center:n,children:r,className:i,id:o,placeholder:a,style:c,whenReady:h,zoom:p,...y},v){const[w]=B.useState({className:i,id:o,style:c}),[S,N]=B.useState(null);B.useImperativeHandle(v,()=>(S==null?void 0:S.map)??null,[S]);const A=B.useCallback(j=>{if(j!==null&&S===null){const k=new sd.Map(j,y);n!=null&&p!=null?k.setView(n,p):t!=null&&k.fitBounds(t,e),h!=null&&k.whenReady(h),N(g5(k))}},[]);B.useEffect(()=>()=>{S==null||S.map.remove()},[S]);const U=S?Nh.createElement(O1,{value:S},r):a??null;return Nh.createElement("div",iy({},w,{ref:A}),U)}const A5=B.forwardRef(P5),yb=E5(function({position:e,...n},r){const i=new sd.Marker(e,n);return Pv(i,y5(r,{overlayContainer:i}))},function(e,n,r){n.position!==r.position&&e.setLatLng(n.position),n.icon!=null&&n.icon!==r.icon&&e.setIcon(n.icon),n.zIndexOffset!=null&&n.zIndexOffset!==r.zIndexOffset&&e.setZIndexOffset(n.zIndexOffset),n.opacity!=null&&n.opacity!==r.opacity&&e.setOpacity(n.opacity),e.dragging!=null&&n.draggable!==r.draggable&&(n.draggable===!0?e.dragging.enable():e.dragging.disable())}),_b=T5(function(e,n){const r=new sd.Popup(e,n.overlayContainer);return Pv(r,n)},function(e,n,{position:r},i){B.useEffect(function(){const{instance:a}=e;function c(p){p.popup===a&&(a.update(),i(!0))}function h(p){p.popup===a&&i(!1)}return n.map.on({popupopen:c,popupclose:h}),n.overlayContainer==null?(r!=null&&a.setLatLng(r),a.openOn(n.map)):n.overlayContainer.bindPopup(a),function(){var y;n.map.off({popupopen:c,popupclose:h}),(y=n.overlayContainer)==null||y.unbindPopup(),n.map.removeLayer(a)}},[e,n,i,r])}),N5=I5(function({url:e,...n},r){const i=new sd.TileLayer(e,kv(n,r));return Pv(i,r)},function(e,n,r){k5(e,n,r);const{url:i}=n;i!=null&&i!==r.url&&e.setUrl(i)});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var C5={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R5=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Ee=(t,e)=>{const n=B.forwardRef(({color:r="currentColor",size:i=24,strokeWidth:o=2,absoluteStrokeWidth:a,className:c="",children:h,...p},y)=>B.createElement("svg",{ref:y,...C5,width:i,height:i,stroke:r,strokeWidth:a?Number(o)*24/Number(i):o,className:["lucide",`lucide-${R5(t)}`,c].join(" "),...p},[...e.map(([v,w])=>B.createElement(v,w)),...Array.isArray(h)?h:[h]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j5=Ee("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nv=Ee("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sh=Ee("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vb=Ee("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U1=Ee("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L5=Ee("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D5=Ee("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M5=Ee("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O5=Ee("Cookie",[["path",{d:"M12 2a10 10 0 1 0 10 10 4 4 0 0 1-5-5 4 4 0 0 1-5-5",key:"laymnq"}],["path",{d:"M8.5 8.5v.01",key:"ue8clq"}],["path",{d:"M16 15.5v.01",key:"14dtrp"}],["path",{d:"M12 12v.01",key:"u5ubse"}],["path",{d:"M11 17v.01",key:"1hyl5a"}],["path",{d:"M7 14v.01",key:"uct60s"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cv=Ee("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xb=Ee("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kp=Ee("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rv=Ee("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V5=Ee("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jv=Ee("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F5=Ee("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U5=Ee("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B1=Ee("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ph=Ee("ImagePlus",[["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7",key:"31hg93"}],["line",{x1:"16",x2:"22",y1:"5",y2:"5",key:"ez7e4s"}],["line",{x1:"19",x2:"19",y1:"2",y2:"8",key:"1gkr8c"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ah=Ee("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B5=Ee("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qr=Ee("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wb=Ee("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lv=Ee("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bc=Ee("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z5=Ee("Map",[["polygon",{points:"3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21",key:"ok2ie8"}],["line",{x1:"9",x2:"9",y1:"3",y2:"18",key:"w34qz5"}],["line",{x1:"15",x2:"15",y1:"6",y2:"21",key:"volv9a"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q5=Ee("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z1=Ee("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $5=Ee("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pf=Ee("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H5=Ee("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W5=Ee("PartyPopper",[["path",{d:"M5.8 11.3 2 22l10.7-3.79",key:"gwxi1d"}],["path",{d:"M4 3h.01",key:"1vcuye"}],["path",{d:"M22 8h.01",key:"1mrtc2"}],["path",{d:"M15 2h.01",key:"1cjtqr"}],["path",{d:"M22 20h.01",key:"1mrys2"}],["path",{d:"m22 2-2.24.75a2.9 2.9 0 0 0-1.96 3.12v0c.1.86-.57 1.63-1.45 1.63h-.38c-.86 0-1.6.6-1.76 1.44L14 10",key:"bpx1uq"}],["path",{d:"m22 13-.82-.33c-.86-.34-1.82.2-1.98 1.11v0c-.11.7-.72 1.22-1.43 1.22H17",key:"1pd0s7"}],["path",{d:"m11 2 .33.82c.34.86-.2 1.82-1.11 1.98v0C9.52 4.9 9 5.52 9 6.23V7",key:"zq5xbz"}],["path",{d:"M11 13c1.93 1.93 2.83 4.17 2 5-.83.83-3.07-.07-5-2-1.93-1.93-2.83-4.17-2-5 .83-.83 3.07.07 5 2Z",key:"4kbmks"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G5=Ee("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q1=Ee("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K5=Ee("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z5=Ee("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q5=Ee("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $1=Ee("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y5=Ee("ShieldCheck",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H1=Ee("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J5=Ee("Shirt",[["path",{d:"M20.38 3.46 16 2a4 4 0 0 1-8 0L3.62 3.46a2 2 0 0 0-1.34 2.23l.58 3.47a1 1 0 0 0 .99.84H6v10c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2V10h2.15a1 1 0 0 0 .99-.84l.58-3.47a2 2 0 0 0-1.34-2.23z",key:"1wgbhj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X5=Ee("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dv=Ee("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W1=Ee("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G1=Ee("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ia=Ee("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eF=Ee("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K1=Ee("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ri=Ee("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tF=Ee("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z1=Ee("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ql=Ee("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mv=Ee("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);delete Sv.Icon.Default.prototype._getIconUrl;Sv.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-shadow.png"});const bb=t=>Sv.divIcon({className:"custom-marker",html:`<div style="background-color: ${t}; width: 24px; height: 24px; border-radius: 50% 50% 50% 0; transform: rotate(-45deg); border: 2px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.3);"></div>`,iconSize:[24,24],iconAnchor:[12,24],popupAnchor:[0,-24]}),Cu={accommodation:{label:"Accommodation",color:"#3B82F6",icon:B1},costume:{label:"Costume Pickup",color:"#F59E0B",icon:J5},fete:{label:"Fete Location",color:"#EC4899",icon:W5},meetup:{label:"Meetup Spot",color:"#10B981",icon:Ri},scraped:{label:"Live Events",color:"#8B5CF6",icon:Bc}};function nF({center:t}){const e=S5();return B.useEffect(()=>{t&&e.setView(t,13)},[t,e]),null}function rF(t,e,n,r){const o=(n-t)*Math.PI/180,a=(r-e)*Math.PI/180,c=Math.sin(o/2)*Math.sin(o/2)+Math.cos(t*Math.PI/180)*Math.cos(n*Math.PI/180)*Math.sin(a/2)*Math.sin(a/2);return 6371*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))}const Eb={trinidad:{center:[10.6918,-61.2225],zoom:11,country:"Trinidad & Tobago"},"stkitts-sugar-mas":{center:[17.3026,-62.7177],zoom:12,country:"St. Kitts"},aruba:{center:[12.5211,-69.9683],zoom:12,country:"Aruba"},"guyana-mashramani":{center:[6.8013,-58.1551],zoom:12,country:"Guyana"},"guyana-independence":{center:[6.8013,-58.1551],zoom:12,country:"Guyana"},jamaica:{center:[18.0179,-76.8099],zoom:11,country:"Jamaica"},stmaarten:{center:[18.0425,-63.0548],zoom:12,country:"St. Maarten"},bahamas:{center:[25.0343,-77.3963],zoom:12,country:"Bahamas"},bermuda:{center:[32.3078,-64.7505],zoom:13,country:"Bermuda"},vincymas:{center:[13.1587,-61.2248],zoom:12,country:"St. Vincent"},antigua:{center:[17.1274,-61.8468],zoom:12,country:"Antigua"},stlucia:{center:[14.0101,-60.987],zoom:11,country:"St. Lucia"},tobago:{center:[11.1889,-60.732],zoom:11,country:"Tobago"},nottinghill:{center:[51.5156,-.205],zoom:14,country:"London, UK"},miami:{center:[25.7617,-80.1918],zoom:11,country:"Miami, FL"}};function iF({locations:t=[],scrapedEvents:e=[],onLocationsChange:n,carnivalName:r,carnivalId:i}){const[o,a]=B.useState(!1),[c,h]=B.useState({name:"",type:"fete",lat:"",lng:""}),[p,y]=B.useState(""),[v,w]=B.useState([]),[S,N]=B.useState(!1),A=t.find(T=>T.type==="accommodation"),U=Eb[i]||Eb.trinidad,j=B.useMemo(()=>{if(A)return[A.lat,A.lng];if(t.length>0)return[t[0].lat,t[0].lng];const T=e.find(b=>b.lat&&b.lng);return T?[T.lat,T.lng]:U.center},[t,A,U,e]),k=async()=>{if(p.trim()){N(!0);try{const b=await(await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(p)}`)).json();w(b.slice(0,5))}catch(T){console.error("Search error:",T)}N(!1)}},R=T=>{h({...c,lat:parseFloat(T.lat),lng:parseFloat(T.lon),name:c.name||T.display_name.split(",")[0]}),w([]),y("")},z=()=>{if(!c.name||!c.lat||!c.lng)return;const T={id:Date.now().toString(),name:c.name,type:c.type,lat:parseFloat(c.lat),lng:parseFloat(c.lng)};n([...t,T]),h({name:"",type:"fete",lat:"",lng:""}),a(!1)},K=T=>{n(t.filter(b=>b.id!==T))},H=T=>{if(!A||T.type==="accommodation")return null;const b=rF(A.lat,A.lng,T.lat,T.lng);return b<1?`${Math.round(b*1e3)}m`:`${b.toFixed(1)}km`};return u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsxs("h3",{className:"text-lg font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[u.jsx(Bc,{className:"w-5 h-5 text-purple-500"}),"Fete Map - ",r]}),u.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 ml-7",children:[" ",U.country]})]}),u.jsxs("button",{onClick:()=>a(!o),className:"flex items-center gap-1 px-3 py-1.5 bg-purple-600 text-white text-sm rounded-lg hover:bg-purple-700 transition",children:[u.jsx(q1,{className:"w-4 h-4"}),"Add Pin"]})]}),o&&u.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 space-y-3",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[u.jsx("input",{type:"text",placeholder:"Location name",value:c.name,onChange:T=>h({...c,name:T.target.value}),className:"px-3 py-2 border rounded-lg dark:bg-gray-600 dark:border-gray-500 dark:text-white"}),u.jsx("select",{value:c.type,onChange:T=>h({...c,type:T.target.value}),className:"px-3 py-2 border rounded-lg dark:bg-gray-600 dark:border-gray-500 dark:text-white",children:Object.entries(Cu).map(([T,{label:b}])=>u.jsx("option",{value:T,children:b},T))})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("input",{type:"text",placeholder:"Search for a place...",value:p,onChange:T=>y(T.target.value),onKeyPress:T=>T.key==="Enter"&&k(),className:"flex-1 px-3 py-2 border rounded-lg dark:bg-gray-600 dark:border-gray-500 dark:text-white"}),u.jsx("button",{onClick:k,disabled:S,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:S?"...":"Search"})]}),v.length>0&&u.jsx("ul",{className:"bg-white dark:bg-gray-600 border dark:border-gray-500 rounded-lg max-h-40 overflow-y-auto",children:v.map((T,b)=>u.jsx("li",{onClick:()=>R(T),className:"px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-500 cursor-pointer text-sm truncate dark:text-white",children:T.display_name},b))}),u.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[u.jsx("input",{type:"number",step:"any",placeholder:"Latitude",value:c.lat,onChange:T=>h({...c,lat:T.target.value}),className:"px-3 py-2 border rounded-lg dark:bg-gray-600 dark:border-gray-500 dark:text-white"}),u.jsx("input",{type:"number",step:"any",placeholder:"Longitude",value:c.lng,onChange:T=>h({...c,lng:T.target.value}),className:"px-3 py-2 border rounded-lg dark:bg-gray-600 dark:border-gray-500 dark:text-white"})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:z,disabled:!c.name||!c.lat||!c.lng,className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Add Location"}),u.jsx("button",{onClick:()=>a(!1),className:"px-4 py-2 bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-white rounded-lg hover:bg-gray-400",children:"Cancel"})]})]}),u.jsx("div",{className:"h-[400px] rounded-xl overflow-hidden border-2 border-gray-200 dark:border-gray-600",children:u.jsxs(A5,{center:j,zoom:U.zoom,style:{height:"100%",width:"100%"},children:[u.jsx(N5,{attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),u.jsx(nF,{center:j}),t.map(T=>{var b,C;return u.jsx(yb,{position:[T.lat,T.lng],icon:bb(((b=Cu[T.type])==null?void 0:b.color)||"#6B7280"),children:u.jsxs(_b,{children:[u.jsx("div",{className:"font-medium",children:T.name}),u.jsx("div",{className:"text-xs text-gray-500",children:(C=Cu[T.type])==null?void 0:C.label}),H(T)&&u.jsxs("div",{className:"text-xs text-blue-600 flex items-center gap-1 mt-1",children:[u.jsx(H5,{className:"w-3 h-3"}),H(T)," from accommodation"]})]})},T.id)}),e.filter(T=>T.lat&&T.lng).map(T=>u.jsx(yb,{position:[T.lat,T.lng],icon:bb(Cu.scraped.color),children:u.jsxs(_b,{children:[u.jsx("div",{className:"font-medium",children:T.title}),u.jsx("div",{className:"text-xs text-purple-600 font-bold mb-1",children:"Live Event"}),T.venue&&u.jsx("div",{className:"text-xs text-gray-500 mb-2",children:T.venue}),u.jsx("a",{href:T.url,target:"_blank",rel:"noopener noreferrer",className:"block text-center px-2 py-1 bg-purple-100 text-purple-700 text-[10px] font-bold rounded uppercase hover:bg-purple-200 transition",children:"Find Tickets"})]})},T.id))]})}),t.length>0&&u.jsxs("div",{className:"space-y-2",children:[u.jsx("h4",{className:"text-sm font-semibold text-gray-600 dark:text-gray-300",children:"Saved Locations"}),u.jsx("div",{className:"grid gap-2",children:t.map(T=>{const b=Cu[T.type],C=(b==null?void 0:b.icon)||Bc,P=H(T);return u.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{backgroundColor:(b==null?void 0:b.color)||"#6B7280"},children:u.jsx(C,{className:"w-4 h-4 text-white"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium text-gray-800 dark:text-white",children:T.name}),u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[b==null?void 0:b.label,P&&`  ${P} from stay`]})]})]}),u.jsx("button",{onClick:()=>K(T.id),className:"p-2 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition",children:u.jsx(ia,{className:"w-4 h-4"})})]},T.id)})})]}),!A&&t.length===0&&u.jsxs("div",{className:"text-center py-6 text-gray-500 dark:text-gray-400",children:[u.jsx(B1,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),u.jsx("p",{children:"Start by adding your accommodation location"}),u.jsx("p",{className:"text-sm",children:"Then add fetes, costume pickup, and meetup spots"})]})]})}let Io=[{id:"1",text:"Who's ready for the road?! ",senderId:"2",senderName:"Soca Junkie",createdAt:new Date(Date.now()-864e5).toISOString(),isBot:!1},{id:"2",text:"My costume is ready! The Monarch section looks fire ",senderId:"3",senderName:"Fete King",createdAt:new Date(Date.now()-8e7).toISOString(),isBot:!1},{id:"3",text:"Just waiting on my flight confirmation.",senderId:"4",senderName:"Carnival Baby",createdAt:new Date(Date.now()-7e7).toISOString(),isBot:!1},{id:"4",text:"Welcome to Trinidad! I'm your Carnival Concierge. Ask me anything about fete locations, transport, or safety tips!",senderId:"bot",senderName:"Carnival Concierge",createdAt:new Date(Date.now()-6e4).toISOString(),isBot:!0}];const sF=(t,e,n)=>{if(e)return n(Io),()=>{};if(!t)return()=>{};const r=Mn(ze,"squads",t,"messages"),i=sv(r,VS("createdAt","asc"),eO(50));return Fs(i,a=>{const c=a.docs.map(h=>{var p;return{id:h.id,...h.data(),createdAt:(p=h.data().createdAt)!=null&&p.toDate?h.data().createdAt.toDate().toISOString():new Date().toISOString()}});n(c)})},oF=async(t,e,n,r,i,o)=>{let a=null;if(r)if(i)a=URL.createObjectURL(r);else try{const h=Vl(Fl,`squads/${t}/${Date.now()}_${r.name}`),p=await bp(h,r);a=await Ep(p.ref)}catch(h){console.error("Image upload failed:",h)}const c={text:n,imageUrl:a,expiresAt:new Date(Date.now()+24*60*60*1e3).toISOString(),senderId:e.uid||"demo-user",senderName:e.displayName||"Me",senderPhoto:e.photoURL||null,createdAt:i?new Date().toISOString():HS(),isBot:!1};if(i){const h={id:Date.now().toString(),...c};Io=[...Io,h],o([...Io]),setTimeout(()=>{const p=aF(n||(r?"Nice photo! ":"...")),y={id:(Date.now()+1).toString(),text:p,senderId:"bot",senderName:"Carnival Concierge",senderPhoto:null,createdAt:new Date().toISOString(),isBot:!0};Io=[...Io,y],o([...Io])},1500);return}t&&await vp(Mn(ze,"squads",t,"messages"),c)},aF=t=>{const e=t.toLowerCase();return e.includes("fete")||e.includes("party")?"Based on your schedule, I recommend 'Phuket' on Friday night. It's close to your Airbnb in Woodbrook and tickets are running low! ":e.includes("food")||e.includes("hungry")||e.includes("eat")?"You have to try 'Sauce Doubles' in Curepe! Or if you're near the Savannah, check out the corn soup vendor near the exit. ":e.includes("transport")||e.includes("taxi")||e.includes("uber")?"Rideshare apps like TT RideShare are reliable. For late nights, I recommend pre-booking a driver for your squad. Safety first! ":e.includes("costume")||e.includes("mas")?"Costume pickup for Tribe is at the Queen's Park Savannah. Don't forget your distribution slip and ID! ":"That sounds like a vibe! Remember to stay hydrated . Need help with transport or fete tickets?"};function lF({squadId:t,user:e,isDemoMode:n}){const[r,i]=B.useState([]),[o,a]=B.useState(""),[c,h]=B.useState(null),[p,y]=B.useState(null),v=B.useRef(null),w=B.useRef(null);B.useEffect(()=>{const U=sF(n?"demo-squad":t,n,j=>{i(j)});return()=>U()},[t,n]),B.useEffect(()=>{var A;(A=v.current)==null||A.scrollIntoView({behavior:"smooth"})},[r]),B.useEffect(()=>()=>{p&&URL.revokeObjectURL(p)},[p]);const S=A=>{if(A.target.files&&A.target.files[0]){const U=A.target.files[0];h(U),y(URL.createObjectURL(U))}},N=async A=>{if(A.preventDefault(),!o.trim()&&!c)return;const U=o,j=c;a(""),h(null),y(null);try{await oF(n?"demo-squad":t,e,U,j,n,i)}catch(k){console.error("Failed to send:",k),a(U)}};return u.jsxs("div",{className:"flex flex-col h-[600px] bg-white dark:bg-gray-800 rounded-2xl shadow-xl overflow-hidden border border-gray-100 dark:border-gray-700",children:[u.jsxs("div",{className:"p-4 bg-gradient-to-r from-purple-600 to-indigo-600 text-white flex justify-between items-center shadow-md z-10",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"p-2 bg-white/20 rounded-full backdrop-blur-sm",children:u.jsx(vb,{className:"w-5 h-5 text-white"})}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-bold text-lg",children:"Squad Chat"}),u.jsxs("p",{className:"text-xs text-purple-100 opacity-90 flex items-center gap-1",children:[u.jsx("span",{className:"w-2 h-2 bg-emerald-400 rounded-full animate-pulse"}),"Carnival Concierge Active"]})]})]}),n&&u.jsx("span",{className:"px-2 py-1 text-[10px] font-black tracking-widest bg-yellow-400 text-yellow-900 rounded uppercase",children:"Demo"})]}),u.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50 dark:bg-gray-900/50",children:[r.map(A=>{const U=A.senderId===((e==null?void 0:e.uid)||"demo-user"),j=A.isBot;let k=!1,R=null;return A.expiresAt&&(R=new Date(A.expiresAt),new Date>R&&(k=!0)),u.jsx("div",{className:`flex w-full ${U?"justify-end":"justify-start"}`,children:u.jsxs("div",{className:`flex max-w-[80%] gap-2 ${U?"flex-row-reverse":"flex-row"}`,children:[u.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center shadow-sm 
                    ${j?"bg-gradient-to-br from-pink-500 to-orange-400":"bg-gray-300 dark:bg-gray-700"}`,children:j?u.jsx(vb,{className:"w-4 h-4 text-white"}):u.jsx(K1,{className:"w-4 h-4 text-white"})}),u.jsxs("div",{className:`flex flex-col ${U?"items-end":"items-start"}`,children:[u.jsx("span",{className:"text-[10px] text-gray-400 mb-1 ml-1",children:A.senderName}),u.jsxs("div",{className:`px-4 py-3 rounded-2xl shadow-sm text-sm leading-relaxed relative
                        ${U?"bg-blue-600 text-white rounded-tr-none":j?"bg-white dark:bg-gray-800 border-l-4 border-pink-500 text-gray-800 dark:text-gray-100 rounded-tl-none":"bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-100 rounded-tl-none"}
                    `,children:[A.imageUrl&&u.jsx("div",{className:"mb-2",children:k?u.jsxs("div",{className:"w-48 h-32 bg-gray-200 dark:bg-gray-700 rounded-lg flex flex-col items-center justify-center text-gray-500",children:[u.jsx(Ah,{className:"w-8 h-8 mb-1 opacity-50"}),u.jsx("span",{className:"text-xs italic",children:"Image expired"})]}):u.jsxs("div",{className:"relative group",children:[u.jsx("img",{src:A.imageUrl,alt:"Shared",className:"w-48 h-48 object-cover rounded-lg cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>window.open(A.imageUrl,"_blank")}),u.jsx("span",{className:"absolute top-2 right-2 bg-black/50 text-white text-[10px] px-1.5 py-0.5 rounded backdrop-blur-sm",children:" 24h"})]})}),A.text]}),u.jsx("span",{className:"text-[10px] text-gray-400 mt-1 opacity-50",children:new Date(A.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})},A.id)}),u.jsx("div",{ref:v})]}),u.jsxs("form",{onSubmit:N,className:"p-4 bg-white dark:bg-gray-800 border-t border-gray-100 dark:border-gray-700",children:[p&&u.jsxs("div",{className:"mb-3 relative inline-block",children:[u.jsx("img",{src:p,alt:"Preview",className:"h-20 w-20 object-cover rounded-lg border border-purple-200"}),u.jsx("button",{type:"button",onClick:()=>{h(null),y(null)},className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 shadow-md hover:bg-red-600",children:u.jsx(Ql,{className:"w-3 h-3"})})]}),u.jsxs("div",{className:"flex gap-2 items-center",children:[u.jsx("input",{type:"file",ref:w,onChange:S,accept:"image/*",className:"hidden"}),u.jsx("button",{type:"button",onClick:()=>{var A;return(A=w.current)==null?void 0:A.click()},className:"p-3 text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded-xl transition-colors",title:"Upload Image (Expires in 24h)",children:u.jsx(U1,{className:"w-5 h-5"})}),u.jsx("input",{type:"text",value:o,onChange:A=>a(A.target.value),placeholder:c?"Add a caption...":"Ask Concierge or chat with squad...",className:"flex-1 px-4 py-3 bg-gray-100 dark:bg-gray-900 border-0 rounded-xl focus:ring-2 focus:ring-purple-500 dark:text-white placeholder-gray-400 transition-all"}),u.jsx("button",{type:"submit",disabled:!o.trim()&&!c,className:"p-3 bg-purple-600 text-white rounded-xl hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors shadow-lg shadow-purple-500/30",children:u.jsx($1,{className:"w-5 h-5"})})]})]})]})}const sy={ticket:{label:"Ticket",icon:Dv,color:"#F59E0B"},photo:{label:"Photo",icon:Ph,color:"#3B82F6"}};function uF({files:t=[],onFilesChange:e,carnivalName:n,carnivalId:r,userId:i}){const[o,a]=B.useState(!1),[c,h]=B.useState(""),[p,y]=B.useState(null),[v,w]=B.useState("ticket"),[S,N]=B.useState(""),A=B.useRef(null),U=async K=>{const H=K.target.files[0];if(!H)return;const T=10*1024*1024;if(H.size>T){alert("File too large. Maximum size is 10MB.");return}if(!["image/jpeg","image/png","image/gif","image/webp","application/pdf"].includes(H.type)){alert("Invalid file type. Please upload an image (JPG, PNG, GIF, WebP) or PDF.");return}a(!0),h("Uploading...");try{const C=Date.now(),P=H.name.split(".").pop(),O=`users/${i}/carnivals/${r}/${C}.${P}`,F=Vl(Fl,O);await bp(F,H);const M=await Ep(F),be={id:C.toString(),name:S||H.name.split(".")[0],type:v,url:M,storagePath:O,originalName:H.name,uploadedAt:new Date().toISOString(),fileType:H.type};e([...t,be]),N(""),h(""),A.current&&(A.current.value="")}catch(C){console.error("Upload error:",C),alert("Failed to upload file. Please try again.")}a(!1)},j=async K=>{if(confirm("Are you sure you want to delete this file?"))try{const H=Vl(Fl,K.storagePath);await u1(H),e(t.filter(T=>T.id!==K.id))}catch(H){console.error("Delete error:",H),e(t.filter(T=>T.id!==K.id))}},k=K=>{const H=document.createElement("a");H.href=K.url,H.download=K.originalName||K.name,H.target="_blank",document.body.appendChild(H),H.click(),document.body.removeChild(H)},R=t.filter(K=>K.type==="ticket"),z=t.filter(K=>K.type==="photo");return u.jsxs("div",{className:"space-y-6",children:[u.jsx("div",{className:"flex items-center justify-between",children:u.jsxs("div",{children:[u.jsxs("h3",{className:"text-xl font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[u.jsx(Ph,{className:"w-5 h-5 text-purple-500"}),"Media Vault"]}),u.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Store your tickets, photos, and important documents for ",n]})]})}),u.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 rounded-xl p-4 border border-purple-100 dark:border-purple-800",children:[u.jsx("h4",{className:"font-semibold text-gray-800 dark:text-white mb-3",children:"Upload New File"}),u.jsxs("div",{className:"grid gap-3",children:[u.jsxs("div",{className:"flex gap-3",children:[u.jsx("input",{type:"text",placeholder:"File label (e.g., 'Tribe Costume Receipt')",value:S,onChange:K=>N(K.target.value),className:"flex-1 px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white"}),u.jsx("select",{value:v,onChange:K=>w(K.target.value),className:"px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white",children:Object.entries(sy).map(([K,{label:H}])=>u.jsx("option",{value:K,children:H},K))})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("input",{ref:A,type:"file",accept:"image/*,.pdf",onChange:U,className:"hidden",id:"file-upload"}),u.jsx("label",{htmlFor:"file-upload",className:`flex-1 flex items-center justify-center gap-2 px-4 py-3 border-2 border-dashed rounded-lg cursor-pointer transition ${o?"border-gray-300 bg-gray-50 dark:bg-gray-800 cursor-not-allowed":"border-purple-300 hover:border-purple-500 hover:bg-purple-50 dark:hover:bg-purple-900/20"}`,children:o?u.jsxs(u.Fragment,{children:[u.jsx(qr,{className:"w-5 h-5 animate-spin text-purple-500"}),u.jsx("span",{className:"text-purple-600 dark:text-purple-400",children:c})]}):u.jsxs(u.Fragment,{children:[u.jsx(eF,{className:"w-5 h-5 text-purple-500"}),u.jsx("span",{className:"text-purple-600 dark:text-purple-400 font-medium",children:"Click to upload image or PDF (max 10MB)"})]})})]})]})]}),R.length>0&&u.jsxs("div",{children:[u.jsxs("h4",{className:"font-semibold text-gray-800 dark:text-white mb-3 flex items-center gap-2",children:[u.jsx(Dv,{className:"w-4 h-4 text-yellow-500"}),"Tickets (",R.length,")"]}),u.jsx("div",{className:"grid gap-3",children:R.map(K=>u.jsx(cF,{file:K,onView:y,onDownload:k,onDelete:j},K.id))})]}),z.length>0&&u.jsxs("div",{children:[u.jsxs("h4",{className:"font-semibold text-gray-800 dark:text-white mb-3 flex items-center gap-2",children:[u.jsx(Ph,{className:"w-4 h-4 text-blue-500"}),"Photos (",z.length,")"]}),u.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:z.map(K=>u.jsx(dF,{file:K,onView:y,onDownload:k,onDelete:j},K.id))})]}),t.length===0&&u.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[u.jsx(Ph,{className:"w-16 h-16 mx-auto mb-3 opacity-30"}),u.jsx("p",{className:"font-medium",children:"No files uploaded yet"}),u.jsx("p",{className:"text-sm",children:"Upload your tickets, costume receipts, and travel photos"})]}),p&&u.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4",onClick:()=>y(null),children:u.jsxs("div",{className:"relative max-w-4xl max-h-[90vh] w-full",onClick:K=>K.stopPropagation(),children:[u.jsx("button",{onClick:()=>y(null),className:"absolute -top-12 right-0 text-white hover:text-gray-300",children:u.jsx(Ql,{className:"w-8 h-8"})}),p.fileType==="application/pdf"?u.jsx("iframe",{src:p.url,className:"w-full h-[80vh] rounded-lg"}):u.jsx("img",{src:p.url,alt:p.name,className:"max-w-full max-h-[80vh] mx-auto rounded-lg"}),u.jsx("p",{className:"text-white text-center mt-4 font-medium",children:p.name})]})})]})}function cF({file:t,onView:e,onDownload:n,onDelete:r}){const i=sy[t.type]||sy.ticket,o=i.icon;return u.jsxs("div",{className:"flex items-center justify-between p-3 bg-white dark:bg-gray-700 rounded-lg border border-gray-100 dark:border-gray-600 shadow-sm",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:{backgroundColor:`${i.color}20`},children:u.jsx(o,{className:"w-5 h-5",style:{color:i.color}})}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-800 dark:text-white",children:t.name}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:new Date(t.uploadedAt).toLocaleDateString()})]})]}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("button",{onClick:()=>e(t),className:"p-2 text-gray-500 hover:text-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition",children:u.jsx(jv,{className:"w-4 h-4"})}),u.jsx("button",{onClick:()=>n(t),className:"p-2 text-gray-500 hover:text-green-500 hover:bg-green-50 dark:hover:bg-green-900/20 rounded-lg transition",children:u.jsx(kp,{className:"w-4 h-4"})}),u.jsx("button",{onClick:()=>r(t),className:"p-2 text-gray-500 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition",children:u.jsx(ia,{className:"w-4 h-4"})})]})]})}function dF({file:t,onView:e,onDownload:n,onDelete:r}){return u.jsxs("div",{className:"relative group rounded-lg overflow-hidden border border-gray-200 dark:border-gray-600",children:[u.jsx("img",{src:t.url,alt:t.name,className:"w-full h-32 object-cover cursor-pointer",onClick:()=>e(t)}),u.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2",children:[u.jsx("button",{onClick:()=>e(t),className:"p-2 bg-white/20 hover:bg-white/30 rounded-full text-white transition",children:u.jsx(jv,{className:"w-4 h-4"})}),u.jsx("button",{onClick:()=>n(t),className:"p-2 bg-white/20 hover:bg-white/30 rounded-full text-white transition",children:u.jsx(kp,{className:"w-4 h-4"})}),u.jsx("button",{onClick:()=>r(t),className:"p-2 bg-red-500/50 hover:bg-red-500/70 rounded-full text-white transition",children:u.jsx(ia,{className:"w-4 h-4"})})]}),u.jsx("p",{className:"absolute bottom-0 left-0 right-0 bg-black/60 text-white text-xs p-2 truncate",children:t.name})]})}const Xd={trinidad:"https://open.spotify.com/embed/playlist/2H61cIhlAeFVmreSMqvui3",jamaica:"https://open.spotify.com/embed/playlist/37i9dQZF1DX82pCGH5USnM",miami:"https://open.spotify.com/embed/playlist/37i9dQZF1DXS1X4r7p38D5",stlucia:"https://open.spotify.com/embed/playlist/37i9dQZF1DX62XscWx9t6h",barbados:"https://open.spotify.com/embed/playlist/37i9dQZF1DX23V8kYg8jC2",stkitts:"https://open.spotify.com/embed/playlist/37i9dQZF1E4v6hGc9x5z4y",stcroix:"https://open.spotify.com/embed/playlist/37i9dQZF1E4v6hGc9x5z4y",stthomas:"https://open.spotify.com/embed/playlist/37i9dQZF1E4v6hGc9x5z4y",default:"https://open.spotify.com/embed/playlist/28bCuQ5IhyPbmvJx30ZMea"};function hF({activeCarnivalId:t,isPremium:e}){const[n,r]=B.useState(!1),[i,o]=B.useState(!1),a=()=>{if(!t)return{key:"default",url:Xd.default};const p=Object.keys(Xd).find(v=>t.toLowerCase().includes(v)),y=Xd[p]||Xd.default;return{key:p||"default (fallback)",url:y}},{key:c,url:h}=a();return n?u.jsxs("div",{className:`fixed z-40 transition-all duration-300 shadow-2xl overflow-hidden bg-black/90 backdrop-blur-md border border-white/20 rounded-t-2xl sm:rounded-2xl
      ${i?"bottom-24 right-4 w-64 h-16 rounded-full":"bottom-0 sm:bottom-24 right-0 sm:right-4 w-full sm:w-80 h-[400px]"}`,children:[u.jsxs("div",{className:`flex items-center justify-between p-3 bg-gradient-to-r from-pink-600 to-purple-700 text-white
        ${i?"h-full":""}`,children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Pf,{className:"w-5 h-5 animate-pulse"}),u.jsx("div",{className:"flex flex-col",children:u.jsx("span",{className:"font-bold text-sm",children:i?"Carnival Vibes":"Soca Vibes Player"})})]}),u.jsxs("div",{className:"flex items-center gap-1",children:[i?u.jsx("button",{onClick:()=>o(!1),className:"p-1 hover:bg-white/20 rounded",children:u.jsx(q5,{className:"w-4 h-4"})}):u.jsx("button",{onClick:()=>o(!0),className:"p-1 hover:bg-white/20 rounded",children:u.jsx($5,{className:"w-4 h-4"})}),u.jsx("button",{onClick:()=>r(!1),className:"p-1 hover:bg-white/20 rounded",children:u.jsx(Ql,{className:"w-4 h-4"})})]})]}),!i&&u.jsxs("div",{className:"h-[calc(100%-48px)] bg-black relative",children:[!e&&u.jsx("div",{className:"absolute top-0 left-0 right-0 z-10 bg-yellow-500/90 text-black text-xs font-bold px-2 py-1 text-center",children:"Upgrade directly in Spotify for ad-free listening"}),u.jsx("iframe",{style:{borderRadius:"12px"},src:h,width:"100%",height:"100%",frameBorder:"0",allowFullScreen:"",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy"})]})]}):u.jsx("button",{onClick:()=>r(!0),className:"fixed bottom-24 right-4 z-40 bg-gradient-to-r from-pink-500 to-purple-600 text-white p-3 rounded-full shadow-lg hover:scale-110 transition-transform animate-bounce-slow","aria-label":"Open Vibes Player",children:u.jsx(Pf,{className:"w-6 h-6"})})}const Tb=[{id:"default-fete-map-banner",title:"Unlock Interactive Fete Map",imageUrl:"/images/promo/premium_fete_map_promo_banner.png",placement:"banner",mediaType:"image",linkUrl:null,isDefault:!0},{id:"default-media-vault-banner",title:"Store Your Tickets & Photos",imageUrl:"/images/promo/premium_media_vault_promo_banner.png",placement:"banner",mediaType:"image",linkUrl:null,isDefault:!0},{id:"default-offline-banner",title:"Plan Offline, Anywhere",imageUrl:"/images/promo/premium_offline_mode_promo_banner.png",placement:"banner",mediaType:"image",linkUrl:null,isDefault:!0},{id:"default-premium-banner",title:"Go Premium - Ad Free Experience",imageUrl:"/images/promo/premium_subscription_promo_banner.png",placement:"banner",mediaType:"image",linkUrl:null,isDefault:!0},{id:"default-fete-map-inline",title:"Unlock Interactive Fete Map",imageUrl:"/images/promo/premium_fete_map_promo_banner.png",placement:"inline",mediaType:"image",linkUrl:null,isDefault:!0},{id:"default-media-vault-inline",title:"Store Your Tickets & Photos",imageUrl:"/images/promo/premium_media_vault_promo_banner.png",placement:"inline",mediaType:"image",linkUrl:null,isDefault:!0},{id:"default-offline-inline",title:"Plan Offline, Anywhere",imageUrl:"/images/promo/premium_offline_mode_promo_banner.png",placement:"inline",mediaType:"image",linkUrl:null,isDefault:!0},{id:"default-premium-inline",title:"Go Premium - Ad Free Experience",imageUrl:"/images/promo/premium_subscription_promo_banner.png",placement:"inline",mediaType:"image",linkUrl:null,isDefault:!0}];function eh({placement:t="banner",className:e="",onUpgradeClick:n}){const[r,i]=B.useState([]),[o,a]=B.useState(0),[c,h]=B.useState(!1),[p,y]=B.useState(!0),[v,w]=B.useState(null);if(B.useEffect(()=>{y(!0),w(null);const k=Mn(ze,"promoAds"),R=sv(k,XM("active","==",!0)),z=Fs(R,K=>{const H=[];K.forEach(b=>{H.push({id:b.id,...b.data()})});const T=H.filter(b=>b.placement===t);if(T.length>0)i(T);else{const b=Tb.filter(C=>C.placement===t);i(b)}a(0),y(!1)},K=>{console.error(`PromoAd [${t}] error:`,K);const H=Tb.filter(T=>T.placement===t);i(H),w(null),y(!1)});return()=>z()},[t]),B.useEffect(()=>{if(r.length<=1)return;const k=setInterval(()=>{a(R=>(R+1)%r.length)},8e3);return()=>clearInterval(k)},[r.length]),p||c||r.length===0)return null;const S=Math.min(o,r.length-1),N=r[S];if(!N||!N.imageUrl)return null;const A=N.mediaType==="video",U=N.isDefault,j=()=>{U&&n?n():N.linkUrl&&window.open(N.linkUrl,"_blank","noopener,noreferrer")};return u.jsx("div",{className:`p-4 relative ${e}`,children:u.jsxs("div",{onClick:j,className:`relative overflow-hidden rounded-lg shadow-md ${N.linkUrl||U?"cursor-pointer hover:shadow-lg transition-shadow":""}`,children:[A?u.jsx("video",{src:N.imageUrl,className:"w-full h-auto object-cover",style:{maxHeight:t==="banner"?"120px":"250px"},autoPlay:!0,muted:!0,loop:!0,playsInline:!0,onError:k=>console.error("Video load error:",k)}):u.jsx("img",{src:N.imageUrl,alt:N.title||"Promotion",className:"w-full h-auto object-cover",style:{maxHeight:t==="banner"?"120px":"250px"},onError:k=>{console.error("Image load error:",N.imageUrl),k.target.style.display="none"}}),N.title&&u.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/70 to-transparent p-3",children:[u.jsx("p",{className:"text-white text-sm font-bold truncate",children:N.title}),U&&u.jsx("p",{className:"text-yellow-300 text-xs font-medium",children:"Tap to upgrade to Premium"})]}),u.jsx("div",{className:"absolute top-1 left-1 bg-black/50 text-white text-[10px] px-1.5 py-0.5 rounded",children:U?"PREMIUM":"AD"}),u.jsx("button",{onClick:k=>{k.stopPropagation(),h(!0)},className:"absolute top-1 right-1 p-1 bg-black/50 hover:bg-black/70 text-white rounded-full transition",children:u.jsx(Ql,{className:"w-3 h-3"})}),r.length>1&&u.jsx("div",{className:"absolute bottom-2 right-2 flex gap-1",children:r.map((k,R)=>u.jsx("div",{className:`w-1.5 h-1.5 rounded-full transition ${R===o?"bg-white":"bg-white/50"}`},R))})]})})}const Ib=[{id:"banner",label:"Top Banner"},{id:"sidebar",label:"Sidebar"},{id:"inline",label:"Inline (Between Sections)"}];function fF(){const[t,e]=B.useState([]),[n,r]=B.useState(!1),[i,o]=B.useState(""),[a,c]=B.useState(!1),[h,p]=B.useState({title:"",linkUrl:"",placement:"banner"}),y=B.useRef(null);B.useEffect(()=>{const N=Mn(ze,"promoAds"),A=Fs(N,U=>{const j=[];U.forEach(k=>{j.push({id:k.id,...k.data()})}),j.sort((k,R)=>(R.createdAt||0)-(k.createdAt||0)),e(j)});return()=>A()},[]);const v=async N=>{const A=N.target.files[0];if(!A)return;const U=A.type.startsWith("video/"),j=U?10*1024*1024:5*1024*1024;if(A.size>j){alert(`File too large. Maximum size is ${U?"10MB for videos":"5MB for images"}.`);return}const k=["image/jpeg","image/png","image/gif","image/webp"],R=["video/mp4","video/webm"];if(![...k,...R].includes(A.type)){alert("Invalid file type. Please upload JPG, PNG, GIF, WebP, MP4, or WebM.");return}r(!0),o("Preparing upload...");const K=setTimeout(()=>{r(!1),o(""),alert("Upload timed out after 60 seconds. Please check your connection and try again."),y.current&&(y.current.value="")},6e4);try{const H=Date.now(),T=A.name.split(".").pop(),b=`promoAds/${H}.${T}`,C=Vl(Fl,b);o("Uploading to storage..."),console.log("Uploading file to Storage...",b),await bp(C,A),o("Getting download URL...");const P=await Ep(C);console.log("File uploaded, URL:",P);const O=A.type.startsWith("video/"),F={title:h.title||"",linkUrl:h.linkUrl||"",placement:h.placement,imageUrl:P,mediaType:O?"video":"image",storagePath:b,active:!0,createdAt:H};o("Saving ad data..."),console.log("Saving ad metadata to Firestore...",F);const M=await vp(Mn(ze,"promoAds"),F);console.log("Ad saved to Firestore successfully, ID:",M.id),clearTimeout(K),alert("Ad uploaded successfully!"),p({title:"",linkUrl:"",placement:"banner"}),c(!1),y.current&&(y.current.value="")}catch(H){clearTimeout(K),console.error("Upload error:",H),console.error("Error code:",H.code),console.error("Error message:",H.message),console.error("Full error:",JSON.stringify(H,null,2)),H.code==="storage/unauthorized"?alert("Upload failed: You do not have permission to upload ads. Make sure you are logged in with the admin account (djkrss1@gmail.com)."):H.code==="storage/canceled"?alert("Upload was cancelled."):H.code==="permission-denied"?alert("Firestore permission denied: You do not have permission to save ad metadata. Make sure you are logged in with the admin account (djkrss1@gmail.com)."):alert(`Failed to upload ad: ${H.code||"Unknown error"} - ${H.message||"Please try again."}`)}r(!1),o("")},w=async N=>{try{await If(Et(ze,"promoAds",N.id),{active:!N.active})}catch(A){console.error("Toggle error:",A)}},S=async N=>{if(confirm("Delete this ad?"))try{if(N.storagePath){const A=Vl(Fl,N.storagePath);await u1(A).catch(()=>{})}await qS(Et(ze,"promoAds",N.id))}catch(A){console.error("Delete error:",A)}};return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsxs("h3",{className:"text-xl font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[u.jsx(Ah,{className:"w-5 h-5 text-orange-500"}),"Ad Manager"]}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Upload promotional ads and flyers for free users"})]}),u.jsxs("button",{onClick:()=>c(!a),className:"flex items-center gap-1 px-3 py-1.5 bg-orange-600 text-white text-sm rounded-lg hover:bg-orange-700 transition",children:[u.jsx(q1,{className:"w-4 h-4"}),"New Ad"]})]}),a&&u.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/20 rounded-xl p-4 border border-orange-200 dark:border-orange-800 space-y-3",children:[u.jsxs("div",{className:"grid gap-3",children:[u.jsx("input",{type:"text",placeholder:"Ad title (optional)",value:h.title,onChange:N=>p({...h,title:N.target.value}),className:"px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white"}),u.jsx("input",{type:"url",placeholder:"Link URL (optional) - where to go when clicked",value:h.linkUrl,onChange:N=>p({...h,linkUrl:N.target.value}),className:"px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white"}),u.jsx("select",{value:h.placement,onChange:N=>p({...h,placement:N.target.value}),className:"px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white",children:Ib.map(N=>u.jsx("option",{value:N.id,children:N.label},N.id))})]}),u.jsx("input",{ref:y,type:"file",accept:"image/*,video/mp4,video/webm",onChange:v,className:"hidden",id:"ad-upload"}),u.jsx("label",{htmlFor:"ad-upload",className:`flex flex-col items-center justify-center gap-2 px-4 py-4 border-2 border-dashed rounded-lg cursor-pointer transition ${n?"border-gray-300 bg-gray-50 cursor-not-allowed":"border-orange-300 hover:border-orange-500 hover:bg-orange-50 dark:hover:bg-orange-900/30"}`,children:n?u.jsxs(u.Fragment,{children:[u.jsx(qr,{className:"w-5 h-5 animate-spin text-orange-500"}),u.jsx("span",{className:"text-orange-600",children:i||"Uploading..."})]}):u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Ah,{className:"w-5 h-5 text-orange-500"}),u.jsx(tF,{className:"w-5 h-5 text-orange-500"})]}),u.jsx("span",{className:"text-orange-600 font-medium",children:"Click to upload image or video"}),u.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Images: max 5MB (1200x300 recommended) | Videos: max 10MB (MP4, WebM)"})]})})]}),t.length>0?u.jsx("div",{className:"space-y-3",children:t.map(N=>{var A;return u.jsxs("div",{className:`flex items-center gap-4 p-3 rounded-lg border transition ${N.active?"bg-white dark:bg-gray-700 border-gray-200 dark:border-gray-600":"bg-gray-100 dark:bg-gray-800 border-gray-200 dark:border-gray-700 opacity-60"}`,children:[N.mediaType==="video"?u.jsx("video",{src:N.imageUrl,className:"w-20 h-14 object-cover rounded",muted:!0}):u.jsx("img",{src:N.imageUrl,alt:N.title||"Ad",className:"w-20 h-14 object-cover rounded"}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:"font-medium text-gray-800 dark:text-white truncate",children:N.title||"Untitled Ad"}),u.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[((A=Ib.find(U=>U.id===N.placement))==null?void 0:A.label)||N.placement,N.linkUrl&&"  Has link"]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>w(N),className:`p-2 rounded-lg transition ${N.active?"text-green-600 hover:bg-green-50":"text-gray-400 hover:bg-gray-100"}`,title:N.active?"Active - Click to disable":"Inactive - Click to enable",children:N.active?u.jsx(G1,{className:"w-5 h-5"}):u.jsx(W1,{className:"w-5 h-5"})}),N.linkUrl&&u.jsx("a",{href:N.linkUrl,target:"_blank",rel:"noopener noreferrer",className:"p-2 text-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition",children:u.jsx(Rv,{className:"w-4 h-4"})}),u.jsx("button",{onClick:()=>S(N),className:"p-2 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition",children:u.jsx(ia,{className:"w-4 h-4"})})]})]},N.id)})}):u.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[u.jsx(Ah,{className:"w-16 h-16 mx-auto mb-3 opacity-30"}),u.jsx("p",{className:"font-medium",children:"No ads uploaded yet"}),u.jsx("p",{className:"text-sm",children:"Upload flyers and promotions to show to free users"})]})]})}const Ru="carnival-planner-v1",pF=["djkrss1@gmail.com"],mF=si(jn);function gF(){const[t,e]=B.useState([]),[n,r]=B.useState(!0),[i,o]=B.useState(null),[a,c]=B.useState(""),[h,p]=B.useState(null),[y,v]=B.useState({total:0,premium:0,free:0}),[w,S]=B.useState(!1),[N,A]=B.useState(!1),[U,j]=B.useState(null),[k,R]=B.useState(!1),z=async()=>{R(!0),j("Migrating users from Firebase Auth...");try{const O=await oi(mF,"migrateAuthUsers")({});j(O.data.message),await H()}catch(P){console.error("Auth migration error:",P),j(`Auth migration failed: ${P.message}`)}R(!1)},K=async()=>{var P,O,F,M,be,Re,De,ut,G,se,X,ue,de,ve,Te,xe;A(!0),j("Starting migration...");try{const ge=new Map;let Je=[];try{const St=await Au(Mn(ze,"user-activity"));console.log("[Migration] Found",St.size,"user-activity records"),Je.push(`${St.size} activity records`);for(const it of St.docs){const Ue=it.data(),yt=Ue.uid;if(yt)if(!ge.has(yt))ge.set(yt,{createdAt:Ue.loginAt,lastLoginAt:Ue.loginAt,email:Ue.email||null,displayName:Ue.displayName||null});else{const Ze=ge.get(yt);((O=(P=Ue.loginAt)==null?void 0:P.toMillis)==null?void 0:O.call(P))<((M=(F=Ze.createdAt)==null?void 0:F.toMillis)==null?void 0:M.call(F))&&(Ze.createdAt=Ue.loginAt),((Re=(be=Ue.loginAt)==null?void 0:be.toMillis)==null?void 0:Re.call(be))>((ut=(De=Ze.lastLoginAt)==null?void 0:De.toMillis)==null?void 0:ut.call(De))&&(Ze.lastLoginAt=Ue.loginAt),!Ze.email&&Ue.email&&(Ze.email=Ue.email),!Ze.displayName&&Ue.displayName&&(Ze.displayName=Ue.displayName)}}}catch(St){console.log("[Migration] Could not fetch user-activity:",St.message)}try{const St=await Au(Mn(ze,"artifacts",Ru,"users"));console.log("[Migration] Found",St.size,"artifact users"),Je.push(`${St.size} artifact users`);for(const it of St.docs){const Ue=it.id,yt=it.data();ge.has(Ue)||ge.set(Ue,{createdAt:yt.createdAt||Ke.now(),lastLoginAt:yt.lastLoginAt||Ke.now(),email:null,displayName:null})}}catch(St){console.log("[Migration] Could not fetch artifacts:",St.message)}j(`Found ${ge.size} unique users (${Je.join(", ")})...`);let Jt=0;for(const[St,it]of ge)try{const Ue=Et(ze,"users",St),yt=await ol(Ue);if(!yt.exists())await qi(Ue,it),Jt++;else{const Ze=yt.data(),mn={};it.createdAt&&(!Ze.createdAt||((se=(G=it.createdAt).toMillis)==null?void 0:se.call(G))<((ue=(X=Ze.createdAt)==null?void 0:X.toMillis)==null?void 0:ue.call(X)))&&(mn.createdAt=it.createdAt),it.lastLoginAt&&(!Ze.lastLoginAt||((ve=(de=it.lastLoginAt).toMillis)==null?void 0:ve.call(de))>((xe=(Te=Ze.lastLoginAt)==null?void 0:Te.toMillis)==null?void 0:xe.call(Te)))&&(mn.lastLoginAt=it.lastLoginAt),!Ze.email&&it.email&&(mn.email=it.email),!Ze.displayName&&it.displayName&&(mn.displayName=it.displayName),Object.keys(mn).length>0&&(await qi(Ue,mn,{merge:!0}),Jt++)}}catch(Ue){console.error(`Failed to migrate user ${St}:`,Ue)}j(`Migration complete! Migrated ${Jt} users.`),await H()}catch(ge){console.error("Migration error:",ge),j(`Migration failed: ${ge.message}`)}A(!1)},H=async()=>{var P,O,F,M,be;r(!0),o(null);try{console.log("[AdminAnalytics] Fetching users...");const Re=new Map;try{console.log("[AdminAnalytics] Attempting to fetch users collection...");const G=await Au(Mn(ze,"users"));console.log("[AdminAnalytics] SUCCESS: Found",G.size,"user documents in users collection"),G.docs.forEach(se=>console.log("[AdminAnalytics] User doc:",se.id,se.data()));for(const se of G.docs){const X=se.id,ue=se.data();Re.set(X,{id:X,createdAt:ue.createdAt,lastLoginAt:ue.lastLoginAt,profile:{email:ue.email||null,displayName:ue.displayName||null},source:"users"})}}catch(G){console.log("[AdminAnalytics] Could not fetch users collection:",G.message)}try{console.log("[AdminAnalytics] Attempting to fetch user-activity collection...");const G=await Au(Mn(ze,"user-activity"));console.log("[AdminAnalytics] SUCCESS: Found",G.size,"activity records");for(const se of G.docs){const X=se.data(),ue=X.uid;if(ue&&!Re.has(ue))Re.set(ue,{id:ue,createdAt:X.loginAt||null,lastLoginAt:X.loginAt||null,profile:{email:X.email||null,displayName:X.displayName||null},source:"user-activity"});else if(ue&&Re.has(ue)){const de=Re.get(ue);X.loginAt&&(!de.lastLoginAt||((O=(P=X.loginAt).toMillis)==null?void 0:O.call(P))>((M=(F=de.lastLoginAt).toMillis)==null?void 0:M.call(F)))&&(de.lastLoginAt=X.loginAt),!de.profile.email&&X.email&&(de.profile.email=X.email)}}}catch(G){console.log("[AdminAnalytics] Could not fetch user-activity collection:",G.message)}try{console.log("[AdminAnalytics] Attempting to fetch artifacts collection...");const G=await Au(Mn(ze,"artifacts",Ru,"users"));console.log("[AdminAnalytics] SUCCESS: Found",G.size,"users in artifacts collection");for(const se of G.docs){const X=se.id;if(!Re.has(X)){const ue=se.data();Re.set(X,{id:X,createdAt:ue.createdAt||null,lastLoginAt:ue.lastLoginAt||null,profile:{email:null,displayName:null},source:"artifacts"})}}}catch(G){console.log("[AdminAnalytics] Could not fetch artifacts collection:",G.message)}const De=[];for(const[G,se]of Re){try{const ue=Et(ze,"users",G,"profile","info"),de=await ol(ue);if(de.exists()){const ve=de.data();se.profile={...se.profile,...ve,email:ve.email||se.profile.email,displayName:ve.displayName||se.profile.displayName}}}catch{}se.isPremium=!1,se.carnivalCount=0;try{const ue=Et(ze,"users",G,"apps",Ru),de=await ol(ue);if(de.exists()){const ve=de.data();se.isPremium=!!ve.premiumActive,ve.selectedCarnivals&&(se.carnivalCount=Object.keys(ve.selectedCarnivals).length)}}catch{try{const de=Et(ze,"artifacts",Ru,"users",G),ve=await ol(de);if(ve.exists()){const Te=ve.data();se.isPremium=!!Te.premiumActive,Te.selectedCarnivals&&(se.carnivalCount=Object.keys(Te.selectedCarnivals).length)}}catch{}}const X=((be=se.profile)==null?void 0:be.email)||"";X&&pF.includes(X.toLowerCase())&&(se.isPremium=!0,se.premiumOverride=!0),De.push(se)}console.log("[AdminAnalytics] Total unique users found:",De.length),De.sort((G,se)=>{var de,ve,Te,xe;const X=((ve=(de=G.createdAt)==null?void 0:de.toDate)==null?void 0:ve.call(de))||new Date(0);return(((xe=(Te=se.createdAt)==null?void 0:Te.toDate)==null?void 0:xe.call(Te))||new Date(0))-X}),e(De);const ut=De.filter(G=>G.isPremium).length;v({total:De.length,premium:ut,free:De.length-ut})}catch(Re){console.error("Error fetching users:",Re),o(Re.message||"Failed to fetch users")}r(!1)};B.useEffect(()=>{H()},[]);const T=async()=>{S(!0),await H(),S(!1)},b=async(P,O,F)=>{if(F){alert("This user has premium via email override. Cannot toggle manually.");return}try{const M=Et(ze,"users",P,"apps",Ru);await qi(M,{premiumActive:!O,premiumUpdatedAt:Ke.now(),premiumUpdatedBy:"admin-manual"},{merge:!0}),e(be=>be.map(Re=>Re.id===P?{...Re,isPremium:!O}:Re)),v(be=>({...be,premium:O?be.premium-1:be.premium+1,free:O?be.free+1:be.free-1})),alert(`Premium ${O?"disabled":"enabled"} for user.`)}catch(M){console.error("Error toggling premium:",M),alert("Failed to update premium status: "+M.message)}},C=t.filter(P=>{var be,Re;const O=((be=P.profile)==null?void 0:be.email)||P.id,F=((Re=P.profile)==null?void 0:Re.displayName)||"",M=a.toLowerCase();return O.toLowerCase().includes(M)||F.toLowerCase().includes(M)});return n?u.jsxs("div",{className:"flex items-center justify-center py-12",children:[u.jsx(qr,{className:"w-8 h-8 animate-spin text-blue-500"}),u.jsx("span",{className:"ml-2 text-gray-500 dark:text-gray-400",children:"Loading user data..."})]}):i?u.jsxs("div",{className:"text-center py-12",children:[u.jsx("p",{className:"text-red-500 mb-4",children:i}),u.jsx("button",{onClick:T,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Try Again"})]}):u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsxs("h3",{className:"text-xl font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[u.jsx(Ri,{className:"w-5 h-5 text-blue-500"}),"User Analytics"]}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"View and manage registered users"})]}),u.jsxs("div",{className:"flex gap-2 flex-wrap",children:[u.jsxs("button",{onClick:z,disabled:k,className:"flex items-center gap-1 px-3 py-1.5 bg-purple-600 text-white text-sm rounded-lg hover:bg-purple-700 transition disabled:opacity-50",children:[k?u.jsx(qr,{className:"w-4 h-4 animate-spin"}):u.jsx(kp,{className:"w-4 h-4"}),"Migrate Auth Users"]}),u.jsxs("button",{onClick:K,disabled:N,className:"flex items-center gap-1 px-3 py-1.5 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700 transition disabled:opacity-50",children:[N?u.jsx(qr,{className:"w-4 h-4 animate-spin"}):u.jsx(Ri,{className:"w-4 h-4"}),"Migrate Data"]}),u.jsxs("button",{onClick:T,disabled:w,className:"flex items-center gap-1 px-3 py-1.5 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 transition disabled:opacity-50",children:[u.jsx(K5,{className:`w-4 h-4 ${w?"animate-spin":""}`}),"Refresh"]})]})]}),U&&u.jsx("div",{className:`p-3 rounded-lg text-sm ${U.includes("failed")?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400"}`,children:U}),u.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[u.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl p-4 text-white",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[u.jsx(Ri,{className:"w-5 h-5 opacity-80"}),u.jsx("span",{className:"text-sm font-medium opacity-80",children:"Total Users"})]}),u.jsx("p",{className:"text-3xl font-bold",children:y.total})]}),u.jsxs("div",{className:"bg-gradient-to-br from-yellow-500 to-orange-500 rounded-xl p-4 text-white",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[u.jsx(xb,{className:"w-5 h-5 opacity-80"}),u.jsx("span",{className:"text-sm font-medium opacity-80",children:"Premium"})]}),u.jsx("p",{className:"text-3xl font-bold",children:y.premium})]}),u.jsxs("div",{className:"bg-gradient-to-br from-gray-500 to-gray-600 rounded-xl p-4 text-white",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[u.jsx(Ri,{className:"w-5 h-5 opacity-80"}),u.jsx("span",{className:"text-sm font-medium opacity-80",children:"Free"})]}),u.jsx("p",{className:"text-3xl font-bold",children:y.free})]})]}),u.jsxs("div",{className:"relative",children:[u.jsx(Q5,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),u.jsx("input",{type:"text",placeholder:"Search by email or name...",value:a,onChange:P=>c(P.target.value),className:"w-full pl-10 pr-4 py-3 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white"})]}),u.jsx("div",{className:"space-y-2",children:C.length===0?u.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:a?"No users match your search":"No users found"}):C.map(P=>{var O,F,M,be;return u.jsxs("div",{className:"bg-white dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600 overflow-hidden",children:[u.jsxs("div",{className:"flex items-center gap-3 p-3 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-600",onClick:()=>p(h===P.id?null:P.id),children:[(O=P.profile)!=null&&O.avatarUrl?u.jsx("img",{src:P.profile.avatarUrl,alt:"",className:"w-10 h-10 rounded-full object-cover"}):u.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-200 dark:bg-gray-500 flex items-center justify-center",children:u.jsx(Ri,{className:"w-5 h-5 text-gray-400 dark:text-gray-300"})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("p",{className:"font-medium text-gray-800 dark:text-white truncate",children:((F=P.profile)==null?void 0:F.displayName)||"No name"}),P.isPremium&&u.jsxs("span",{className:`px-1.5 py-0.5 text-xs rounded-full flex items-center gap-1 ${P.premiumOverride?"bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-400":"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400"}`,children:[u.jsx(xb,{className:"w-3 h-3"}),P.premiumOverride?"Admin":"Premium"]})]}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate",children:((M=P.profile)==null?void 0:M.email)||P.id})]}),u.jsxs("div",{className:"flex items-center gap-3",children:[P.carnivalCount>0&&u.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400 flex items-center gap-1",children:[u.jsx(Bc,{className:"w-4 h-4"}),P.carnivalCount," carnival",P.carnivalCount!==1?"s":""]}),h===P.id?u.jsx(M5,{className:"w-5 h-5 text-gray-400"}):u.jsx(D5,{className:"w-5 h-5 text-gray-400"})]})]}),h===P.id&&u.jsxs("div",{className:"px-4 pb-4 pt-2 border-t border-gray-100 dark:border-gray-600 bg-gray-50 dark:bg-gray-800",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"User ID"}),u.jsx("p",{className:"text-sm font-mono text-gray-700 dark:text-gray-300 truncate",children:P.id})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Bio"}),u.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:((be=P.profile)==null?void 0:be.bio)||"No bio"})]})]}),u.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-gray-200 dark:border-gray-600",children:[u.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Premium Status"}),u.jsx("button",{onClick:Re=>{Re.stopPropagation(),b(P.id,P.isPremium,P.premiumOverride)},className:`flex items-center gap-2 px-3 py-1.5 rounded-lg transition ${P.isPremium?"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"}`,children:P.isPremium?u.jsxs(u.Fragment,{children:[u.jsx(G1,{className:"w-5 h-5"}),u.jsx("span",{children:"Premium Active"})]}):u.jsxs(u.Fragment,{children:[u.jsx(W1,{className:"w-5 h-5"}),u.jsx("span",{children:"Free User"})]})})]})]})]},P.id)})}),u.jsxs("p",{className:"text-xs text-gray-400 dark:text-gray-500 text-center",children:["Showing ",C.length," of ",t.length," users"]})]})}function yF({onGetStarted:t,logo:e,onTryDemo:n}){const[r,i]=B.useState(0),[o,a]=B.useState({x:0,y:0});return B.useEffect(()=>{const c=()=>i(window.scrollY),h=p=>a({x:p.clientX,y:p.clientY});return window.addEventListener("scroll",c),window.addEventListener("mousemove",h),()=>{window.removeEventListener("scroll",c),window.removeEventListener("mousemove",h)}},[]),u.jsxs("div",{className:"min-h-screen bg-black text-white overflow-x-hidden selection:bg-pink-500 selection:text-white font-sans",children:[u.jsxs("div",{className:"fixed inset-0 pointer-events-none z-0",children:[u.jsx("div",{className:"absolute w-[800px] h-[800px] bg-indigo-600/20 rounded-full blur-[120px] mix-blend-screen transition-transform duration-100 ease-out",style:{top:-200,left:-200,transform:`translate(${o.x*.02}px, ${o.y*.02}px)`}}),u.jsx("div",{className:"absolute w-[600px] h-[600px] bg-pink-600/20 rounded-full blur-[100px] mix-blend-screen transition-transform duration-100 ease-out",style:{bottom:-100,right:-100,transform:`translate(${o.x*-.03}px, ${o.y*-.03}px)`}})]}),u.jsx("nav",{className:"fixed top-0 w-full z-50 px-6 py-4 backdrop-blur-md border-b border-white/5 bg-black/50",children:u.jsxs("div",{className:"max-w-7xl mx-auto flex justify-between items-center",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-pink-500 to-indigo-600 flex items-center justify-center font-bold text-sm",children:"CP"}),u.jsx("span",{className:"font-bold tracking-tight text-white/90",children:"Carnival Planner"})]}),u.jsx("button",{onClick:t,className:"px-4 py-2 bg-white/10 hover:bg-white/20 border border-white/10 rounded-full text-sm font-semibold transition-all",children:"Log In"})]})}),u.jsxs("section",{className:"relative z-10 pt-40 pb-20 px-6 max-w-7xl mx-auto flex flex-col items-center text-center",children:[u.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/5 border border-white/10 backdrop-blur-sm mb-8 animate-fadeIn",children:[u.jsxs("span",{className:"relative flex h-2 w-2",children:[u.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"}),u.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-green-500"})]}),u.jsx("span",{className:"text-xs font-medium text-gray-400 tracking-wide uppercase",children:"V2.0 Now Live"})]}),u.jsxs("h1",{className:"text-6xl md:text-8xl font-black tracking-tighter mb-8 bg-clip-text text-transparent bg-gradient-to-b from-white via-white to-gray-500 leading-tight",children:["The Operating System",u.jsx("br",{}),u.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-pink-500 via-purple-500 to-indigo-500",children:"For Carnival."})]}),u.jsx("p",{className:"text-xl text-gray-400 max-w-2xl mb-12 leading-relaxed",children:"The all-in-one workspace for your next carnival. Budget, schedule, squad sync, and ticketing  seamlessly integrated."}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[u.jsxs("button",{onClick:t,className:"group relative px-8 py-4 bg-white text-black rounded-full font-bold text-lg shadow-[0_0_40px_-10px_rgba(255,255,255,0.3)] hover:shadow-[0_0_60px_-10px_rgba(255,255,255,0.5)] transition-all transform hover:scale-105",children:["Start Planning For Free",u.jsx(Sh,{className:"inline-block ml-2 w-5 h-5 group-hover:translate-x-1 transition-transform"})]}),u.jsx("button",{onClick:n,className:"px-8 py-4 bg-white/10 hover:bg-white/20 border border-white/10 text-white rounded-full font-bold text-lg backdrop-blur-sm transition-all transform hover:scale-105",children:"Try Live Demo"})]}),u.jsxs("div",{className:"mt-20 relative w-full max-w-5xl aspect-[16/9] bg-gray-900/50 rounded-xl border border-white/10 backdrop-blur-sm overflow-hidden shadow-2xl group",children:[u.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-white/5 to-transparent pointer-events-none"}),u.jsxs("div",{className:"absolute top-4 left-4 right-4 h-4 flex gap-2",children:[u.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500/50"}),u.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-500/50"}),u.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500/50"})]}),u.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:u.jsxs("div",{className:"text-center space-y-4",children:[u.jsx("div",{className:"inline-block p-4 rounded-2xl bg-gradient-to-br from-purple-600 to-pink-600 shadow-xl mb-4 group-hover:scale-110 transition-transform duration-500",children:u.jsx(Mv,{className:"w-12 h-12 text-white"})}),u.jsx("div",{className:"text-2xl font-bold text-white/50",children:"Mission Control"})]})})]})]}),u.jsx("div",{className:"w-full bg-white/5 border-y border-white/5 py-4 overflow-hidden relative z-10 backdrop-blur-sm",children:u.jsxs("div",{className:"flex animate-marquee whitespace-nowrap gap-12 text-sm font-medium text-gray-400 uppercase tracking-widest",children:[u.jsx("span",{children:"  350+ Live Squads"}),u.jsx("span",{children:"  Trinidad 2026 Ready"}),u.jsx("span",{children:"  Expense Tracking"}),u.jsx("span",{children:"  Soca Included"}),u.jsx("span",{children:"  Passport Sync Active"}),u.jsx("span",{children:"  Global Carnival Database"}),u.jsx("span",{children:"  350+ Live Squads"}),u.jsx("span",{children:"  Trinidad 2026 Ready"}),u.jsx("span",{children:"  Expense Tracking"}),u.jsx("span",{children:"  Soca Included"}),u.jsx("span",{children:"  Passport Sync Active"}),u.jsx("span",{children:"  Global Carnival Database"})]})}),u.jsxs("section",{className:"relative z-10 py-32 px-6 max-w-7xl mx-auto",children:[u.jsx("div",{className:"mb-16",children:u.jsxs("h2",{className:"text-4xl md:text-5xl font-black mb-6",children:["Everything you need.",u.jsx("br",{}),"Nothing you don't."]})}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 auto-rows-[300px]",children:[u.jsxs("div",{className:"md:col-span-2 relative group overflow-hidden rounded-3xl bg-gray-900 border border-white/10 hover:border-white/20 transition-all p-8 flex flex-col justify-between",children:[u.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-20 group-hover:opacity-40 transition-opacity",children:u.jsx(Ri,{className:"w-48 h-48 text-indigo-500 transform rotate-12 translate-x-12 -translate-y-12"})}),u.jsxs("div",{children:[u.jsx("div",{className:"w-12 h-12 rounded-xl bg-indigo-500/20 flex items-center justify-center mb-4 text-indigo-400",children:u.jsx(Ri,{})}),u.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Squad Sync"}),u.jsx("p",{className:"text-gray-400 max-w-sm",children:"Real-time collaboration. See when your friends add events, update budgets, or get road ready."})]}),u.jsxs("div",{className:"flex -space-x-4 mt-8",children:[[1,2,3,4].map(c=>u.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-800 border-4 border-gray-900 flex items-center justify-center text-xs font-bold text-gray-500 transform transition-transform group-hover:translate-x-2",style:{transitionDelay:`${c*50}ms`},children:"User"},c)),u.jsx("div",{className:"w-12 h-12 rounded-full bg-indigo-600 border-4 border-gray-900 flex items-center justify-center text-xs font-bold text-white z-10",children:"+3"})]})]}),u.jsxs("div",{className:"md:row-span-2 relative group overflow-hidden rounded-3xl bg-gray-900 border border-white/10 hover:border-white/20 transition-all p-8 flex flex-col",children:[u.jsx("div",{className:"w-12 h-12 rounded-xl bg-green-500/20 flex items-center justify-center mb-4 text-green-400",children:u.jsx(Z1,{})}),u.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Smart Budget"}),u.jsx("p",{className:"text-gray-400 mb-8",children:"Track every costume payment, fete ticket, and flight."}),u.jsxs("div",{className:"mt-auto space-y-4",children:[u.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 group-hover:bg-gray-750 transition-colors",children:[u.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[u.jsx("span",{children:"Costume Deposit"}),u.jsx("span",{className:"font-mono text-green-400",children:"-$300"})]}),u.jsx("div",{className:"w-full bg-gray-700 h-1.5 rounded-full overflow-hidden",children:u.jsx("div",{className:"bg-green-500 w-3/4 h-full rounded-full"})})]}),u.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 group-hover:bg-gray-750 transition-colors",children:[u.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[u.jsx("span",{children:"Flight (MIA -> POS)"}),u.jsx("span",{className:"font-mono text-green-400",children:"-$850"})]}),u.jsx("div",{className:"w-full bg-gray-700 h-1.5 rounded-full overflow-hidden",children:u.jsx("div",{className:"bg-green-500 w-full h-full rounded-full"})})]})]})]}),u.jsxs("div",{className:"relative group overflow-hidden rounded-3xl bg-gray-900 border border-white/10 hover:border-white/20 transition-all p-8",children:[u.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-transparent to-black/80 z-10"}),u.jsx("div",{className:"absolute inset-0 opacity-30 grayscale group-hover:grayscale-0 transition-all duration-700",style:{backgroundImage:"radial-gradient(circle at 2px 2px, rgba(255,255,255,0.15) 1px, transparent 0)",backgroundSize:"24px 24px"}}),u.jsxs("div",{className:"relative z-20 h-full flex flex-col justify-end",children:[u.jsx("div",{className:"w-12 h-12 rounded-xl bg-purple-500/20 flex items-center justify-center mb-4 text-purple-400",children:u.jsx(z5,{})}),u.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Live Map"}),u.jsx("p",{className:"text-gray-400",children:"Discover events near your AirBnb."})]})]}),u.jsxs("div",{className:"col-span-1 md:col-span-2 relative group overflow-hidden rounded-3xl bg-gradient-to-br from-teal-900 to-gray-900 border border-white/10 hover:border-teal-500/30 transition-all p-8 flex items-center justify-between",children:[u.jsxs("div",{className:"max-w-xs",children:[u.jsx("div",{className:"w-12 h-12 rounded-xl bg-teal-500/20 flex items-center justify-center mb-4 text-teal-400",children:u.jsx(Cv,{})}),u.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Soca Passport"}),u.jsx("p",{className:"text-gray-400",children:"Your digital carnival identity. Syncs seamlessly with the Soca Passport app."})]}),u.jsxs("div",{className:"hidden sm:block relative w-64 h-40 bg-white/10 backdrop-blur-md rounded-xl border border-white/20 shadow-2xl transform rotate-3 group-hover:rotate-0 transition-transform duration-500",children:[u.jsx("div",{className:"absolute top-4 left-4 w-8 h-8 rounded-full bg-teal-500"}),u.jsx("div",{className:"absolute top-4 right-4 text-[10px] font-mono opacity-50",children:"9438-2910"}),u.jsx("div",{className:"absolute bottom-4 left-4 text-xs font-bold",children:"FEBUARY 2026"})]})]})]})]}),u.jsxs("section",{className:"relative z-10 py-32 text-center px-6",children:[u.jsx("h2",{className:"text-5xl md:text-7xl font-black mb-8",children:"Ready to jump?"}),u.jsx("button",{onClick:t,className:"px-10 py-5 bg-white text-black rounded-full font-bold text-xl hover:scale-105 transition-transform shadow-2xl",children:"Get Started Now"}),u.jsxs("div",{className:"mt-16 text-sm text-gray-500 flex flex-col md:flex-row items-center justify-center gap-8",children:[u.jsxs("span",{className:"flex items-center gap-2",children:[u.jsx(U5,{className:"w-4 h-4"})," Global Support"]}),u.jsxs("span",{className:"flex items-center gap-2",children:[u.jsx(H1,{className:"w-4 h-4"})," Secure Data"]}),u.jsxs("span",{className:"flex items-center gap-2",children:[u.jsx(Pf,{className:"w-4 h-4"})," Vibes Included"]})]})]}),u.jsx("div",{className:"w-full border-t border-white/10 p-8 text-center text-gray-600 text-sm",children:" 2026 Carnival Planner. Built for the culture."})]})}const Ds="Carnival Planner",Dn="support@carnival-planner.com",Sp="December 12, 2025";function _F({onBack:t,logo:e}){return u.jsxs(Pp,{title:"Privacy Policy",icon:H1,onBack:t,logo:e,children:[u.jsxs("p",{className:"text-gray-400 mb-6",children:["Last Updated: ",Sp]}),u.jsx(Oe,{title:"1. Introduction",children:u.jsxs("p",{children:[Ds,' ("we," "our," or "us") is committed to protecting your privacy. This Privacy Policy explains how we collect, use, disclose, and safeguard your information when you use our mobile application and website (collectively, the "Service").']})}),u.jsxs(Oe,{title:"2. Information We Collect",children:[u.jsx("h4",{className:"font-semibold text-white mb-2",children:"2.1 Personal Information"}),u.jsx("p",{className:"mb-4",children:"When you sign in with Google, we collect:"}),u.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[u.jsx("li",{children:"Email address"}),u.jsx("li",{children:"Display name"}),u.jsx("li",{children:"Profile picture URL"}),u.jsx("li",{children:"Google account unique identifier"})]}),u.jsx("h4",{className:"font-semibold text-white mb-2",children:"2.2 User-Generated Content"}),u.jsx("p",{className:"mb-4",children:"Information you voluntarily provide includes:"}),u.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[u.jsx("li",{children:"Carnival planning data (budgets, schedules, packing lists)"}),u.jsx("li",{children:"Costume and band information"}),u.jsx("li",{children:"Squad member names and coordination data"}),u.jsx("li",{children:"Uploaded media files (tickets, photos, documents)"}),u.jsx("li",{children:"Map pins and location notes"})]}),u.jsx("h4",{className:"font-semibold text-white mb-2",children:"2.3 Payment Information"}),u.jsx("p",{children:"For premium subscriptions, payment processing is handled securely by Stripe. We do not store your credit card numbers. We receive only transaction confirmation, subscription status, and billing email from Stripe."})]}),u.jsx(Oe,{title:"3. How We Use Your Information",children:u.jsxs("ul",{className:"list-disc list-inside space-y-2",children:[u.jsx("li",{children:"To provide and maintain the Service"}),u.jsx("li",{children:"To authenticate your identity via Google Sign-In"}),u.jsx("li",{children:"To process premium subscription payments via Stripe"}),u.jsx("li",{children:"To sync your carnival planning data across devices"}),u.jsx("li",{children:"To send push notifications for squad alerts (if enabled)"}),u.jsx("li",{children:"To improve and optimize our Service"}),u.jsx("li",{children:"To respond to your inquiries and support requests"})]})}),u.jsxs(Oe,{title:"4. Data Storage and Security",children:[u.jsx("p",{className:"mb-4",children:"Your data is stored using Firebase services provided by Google:"}),u.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[u.jsxs("li",{children:[u.jsx("strong",{children:"Firebase Authentication:"})," Manages secure sign-in"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Cloud Firestore:"})," Stores your planning data"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Firebase Storage:"})," Stores uploaded media files"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Firebase Cloud Messaging:"})," Delivers push notifications"]})]}),u.jsx("p",{children:"We implement industry-standard security measures including encryption in transit (TLS) and at rest. Firebase services are SOC 2 and ISO 27001 certified."})]}),u.jsxs(Oe,{title:"5. Third-Party Services",children:[u.jsx("p",{className:"mb-4",children:"We use the following third-party services:"}),u.jsxs("ul",{className:"list-disc list-inside space-y-2",children:[u.jsxs("li",{children:[u.jsx("strong",{children:"Google (Firebase):"})," Authentication, database, storage, and hosting. ",u.jsx("a",{href:"https://firebase.google.com/support/privacy",className:"text-pink-400 hover:underline",target:"_blank",rel:"noopener noreferrer",children:"Firebase Privacy Policy"})]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Stripe:"})," Payment processing. ",u.jsx("a",{href:"https://stripe.com/privacy",className:"text-pink-400 hover:underline",target:"_blank",rel:"noopener noreferrer",children:"Stripe Privacy Policy"})]}),u.jsxs("li",{children:[u.jsx("strong",{children:"OpenStreetMap:"})," Map tiles for the Fete Map feature. ",u.jsx("a",{href:"https://wiki.osmfoundation.org/wiki/Privacy_Policy",className:"text-pink-400 hover:underline",target:"_blank",rel:"noopener noreferrer",children:"OSM Privacy Policy"})]})]})]}),u.jsxs(Oe,{title:"6. Your Rights (GDPR/CCPA)",children:[u.jsx("p",{className:"mb-4",children:"Depending on your location, you may have the following rights:"}),u.jsxs("ul",{className:"list-disc list-inside space-y-2",children:[u.jsxs("li",{children:[u.jsx("strong",{children:"Access:"})," Request a copy of your personal data"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Rectification:"})," Correct inaccurate personal data"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Erasure:"})," Request deletion of your personal data"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Portability:"})," Receive your data in a portable format"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Opt-out:"})," Opt out of certain data processing"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Non-discrimination:"})," We will not discriminate against you for exercising your rights"]})]}),u.jsxs("p",{className:"mt-4",children:["To exercise these rights, contact us at ",u.jsx("a",{href:`mailto:${Dn}`,className:"text-pink-400 hover:underline",children:Dn}),"."]})]}),u.jsx(Oe,{title:"7. Data Retention",children:u.jsx("p",{children:"We retain your personal data for as long as your account is active. If you delete your account, we will delete your data within 30 days, except where we are legally required to retain it."})}),u.jsx(Oe,{title:"8. Children's Privacy",children:u.jsx("p",{children:"Our Service is not intended for children under 13. We do not knowingly collect personal information from children under 13. If you believe we have collected such information, please contact us immediately."})}),u.jsx(Oe,{title:"9. Changes to This Policy",children:u.jsx("p",{children:'We may update this Privacy Policy from time to time. We will notify you of any changes by posting the new Privacy Policy on this page and updating the "Last Updated" date.'})}),u.jsxs(Oe,{title:"10. Contact Us",children:[u.jsx("p",{children:"If you have questions about this Privacy Policy, please contact us at:"}),u.jsx("p",{className:"mt-2",children:u.jsx("a",{href:`mailto:${Dn}`,className:"text-pink-400 hover:underline",children:Dn})})]})]})}function vF({onBack:t,logo:e}){return u.jsxs(Pp,{title:"Terms of Service",icon:F5,onBack:t,logo:e,children:[u.jsxs("p",{className:"text-gray-400 mb-6",children:["Last Updated: ",Sp]}),u.jsx(Oe,{title:"1. Acceptance of Terms",children:u.jsxs("p",{children:["By accessing or using ",Ds,' ("the Service"), you agree to be bound by these Terms of Service. If you do not agree to these terms, please do not use the Service.']})}),u.jsx(Oe,{title:"2. Description of Service",children:u.jsxs("p",{children:[Ds," is a Progressive Web App that helps users plan and organize Caribbean carnival events. The Service includes free features (budget planning, scheduling, squad coordination) and premium subscription features (interactive maps, media vault, offline mode)."]})}),u.jsxs(Oe,{title:"3. User Accounts",children:[u.jsx("h4",{className:"font-semibold text-white mb-2",children:"3.1 Registration"}),u.jsx("p",{className:"mb-4",children:"You must sign in with a valid Google account to use the Service. You are responsible for maintaining the security of your account."}),u.jsx("h4",{className:"font-semibold text-white mb-2",children:"3.2 Account Responsibilities"}),u.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[u.jsx("li",{children:"You must provide accurate information"}),u.jsx("li",{children:"You are responsible for all activities under your account"}),u.jsx("li",{children:"You must notify us immediately of any unauthorized use"})]})]}),u.jsxs(Oe,{title:"4. Premium Subscriptions",children:[u.jsx("h4",{className:"font-semibold text-white mb-2",children:"4.1 Subscription Plans"}),u.jsx("p",{className:"mb-4",children:"We offer monthly ($4.99/month) and yearly ($39.99/year) subscription plans. Prices are subject to change with reasonable notice."}),u.jsx("h4",{className:"font-semibold text-white mb-2",children:"4.2 Billing"}),u.jsx("p",{className:"mb-4",children:"Subscriptions are billed in advance on a recurring basis. Payment is processed through Stripe. Your subscription will automatically renew unless you cancel before the renewal date."}),u.jsx("h4",{className:"font-semibold text-white mb-2",children:"4.3 Cancellation"}),u.jsx("p",{children:"You may cancel your subscription at any time. You will continue to have access to premium features until the end of your current billing period. See our Refund Policy for details."})]}),u.jsxs(Oe,{title:"5. User Content",children:[u.jsx("h4",{className:"font-semibold text-white mb-2",children:"5.1 Your Content"}),u.jsx("p",{className:"mb-4",children:"You retain ownership of all content you upload to the Service (schedules, media, notes). By uploading content, you grant us a limited license to store, display, and process it to provide the Service."}),u.jsx("h4",{className:"font-semibold text-white mb-2",children:"5.2 Content Restrictions"}),u.jsx("p",{className:"mb-2",children:"You agree not to upload content that:"}),u.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[u.jsx("li",{children:"Is illegal, harmful, or offensive"}),u.jsx("li",{children:"Infringes on intellectual property rights"}),u.jsx("li",{children:"Contains malware or malicious code"}),u.jsx("li",{children:"Violates others' privacy"})]})]}),u.jsxs(Oe,{title:"6. Acceptable Use",children:[u.jsx("p",{className:"mb-2",children:"You agree not to:"}),u.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[u.jsx("li",{children:"Use the Service for any unlawful purpose"}),u.jsx("li",{children:"Attempt to gain unauthorized access to our systems"}),u.jsx("li",{children:"Interfere with or disrupt the Service"}),u.jsx("li",{children:"Reverse engineer or decompile the Service"}),u.jsx("li",{children:"Use automated systems to access the Service without permission"})]})]}),u.jsx(Oe,{title:"7. Intellectual Property",children:u.jsxs("p",{children:["The Service, including its design, features, and content (excluding user content), is owned by ",Ds," and protected by intellectual property laws. You may not copy, modify, or distribute our intellectual property without permission."]})}),u.jsx(Oe,{title:"8. Disclaimer of Warranties",children:u.jsx("p",{children:'THE SERVICE IS PROVIDED "AS IS" WITHOUT WARRANTIES OF ANY KIND, EXPRESS OR IMPLIED. WE DO NOT GUARANTEE THAT THE SERVICE WILL BE UNINTERRUPTED, ERROR-FREE, OR SECURE. YOUR USE OF THE SERVICE IS AT YOUR OWN RISK.'})}),u.jsx(Oe,{title:"9. Limitation of Liability",children:u.jsxs("p",{children:["TO THE MAXIMUM EXTENT PERMITTED BY LAW, ",Ds.toUpperCase()," SHALL NOT BE LIABLE FOR ANY INDIRECT, INCIDENTAL, SPECIAL, CONSEQUENTIAL, OR PUNITIVE DAMAGES ARISING FROM YOUR USE OF THE SERVICE, EVEN IF WE HAVE BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES."]})}),u.jsx(Oe,{title:"10. Termination",children:u.jsx("p",{children:"We may terminate or suspend your account at any time for violation of these Terms. You may delete your account at any time. Upon termination, your right to use the Service will immediately cease."})}),u.jsx(Oe,{title:"11. Governing Law",children:u.jsxs("p",{children:["These Terms shall be governed by the laws of the jurisdiction in which ",Ds," operates, without regard to conflict of law principles."]})}),u.jsx(Oe,{title:"12. Changes to Terms",children:u.jsx("p",{children:"We may modify these Terms at any time. We will notify you of significant changes via email or in-app notification. Continued use of the Service after changes constitutes acceptance of the new Terms."})}),u.jsx(Oe,{title:"13. Contact",children:u.jsxs("p",{children:["For questions about these Terms, contact us at ",u.jsx("a",{href:`mailto:${Dn}`,className:"text-pink-400 hover:underline",children:Dn}),"."]})})]})}function xF({onBack:t,logo:e}){return u.jsxs(Pp,{title:"Cookie Policy",icon:O5,onBack:t,logo:e,children:[u.jsxs("p",{className:"text-gray-400 mb-6",children:["Last Updated: ",Sp]}),u.jsx(Oe,{title:"1. What Are Cookies",children:u.jsx("p",{children:"Cookies are small text files stored on your device when you visit a website. They help websites remember your preferences and improve your experience."})}),u.jsxs(Oe,{title:"2. How We Use Cookies",children:[u.jsxs("p",{className:"mb-4",children:[Ds," uses cookies and similar technologies for the following purposes:"]}),u.jsx("h4",{className:"font-semibold text-white mb-2",children:"2.1 Essential Cookies (Required)"}),u.jsx("p",{className:"mb-4",children:"These cookies are necessary for the Service to function and cannot be disabled:"}),u.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[u.jsxs("li",{children:[u.jsx("strong",{children:"Firebase Authentication:"})," Maintains your signed-in session securely"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Session Management:"})," Remembers your authentication state"]})]}),u.jsx("h4",{className:"font-semibold text-white mb-2",children:"2.2 Functional Cookies"}),u.jsx("p",{className:"mb-4",children:"These cookies enhance your experience:"}),u.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[u.jsxs("li",{children:[u.jsx("strong",{children:"Preferences:"})," Remembers your dark mode setting"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Local Storage:"})," Caches carnival data for offline access (Premium feature)"]})]}),u.jsx("h4",{className:"font-semibold text-white mb-2",children:"2.3 Third-Party Cookies"}),u.jsx("p",{className:"mb-2",children:"Our third-party services may set their own cookies:"}),u.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[u.jsxs("li",{children:[u.jsx("strong",{children:"Firebase/Google:"})," Authentication and analytics"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Stripe:"})," Payment processing security"]})]})]}),u.jsx(Oe,{title:"3. Cookie Details",children:u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full text-left text-sm mb-4",children:[u.jsx("thead",{children:u.jsxs("tr",{className:"border-b border-gray-700",children:[u.jsx("th",{className:"py-2 pr-4",children:"Cookie Name"}),u.jsx("th",{className:"py-2 pr-4",children:"Purpose"}),u.jsx("th",{className:"py-2 pr-4",children:"Duration"}),u.jsx("th",{className:"py-2",children:"Type"})]})}),u.jsxs("tbody",{className:"text-gray-400",children:[u.jsxs("tr",{className:"border-b border-gray-800",children:[u.jsx("td",{className:"py-2 pr-4",children:"firebase-auth"}),u.jsx("td",{className:"py-2 pr-4",children:"User authentication"}),u.jsx("td",{className:"py-2 pr-4",children:"Session"}),u.jsx("td",{className:"py-2",children:"Essential"})]}),u.jsxs("tr",{className:"border-b border-gray-800",children:[u.jsx("td",{className:"py-2 pr-4",children:"__stripe_mid"}),u.jsx("td",{className:"py-2 pr-4",children:"Fraud prevention"}),u.jsx("td",{className:"py-2 pr-4",children:"1 year"}),u.jsx("td",{className:"py-2",children:"Essential"})]}),u.jsxs("tr",{className:"border-b border-gray-800",children:[u.jsx("td",{className:"py-2 pr-4",children:"darkMode"}),u.jsx("td",{className:"py-2 pr-4",children:"Theme preference"}),u.jsx("td",{className:"py-2 pr-4",children:"Persistent"}),u.jsx("td",{className:"py-2",children:"Functional"})]})]})]})})}),u.jsxs(Oe,{title:"4. Local Storage",children:[u.jsx("p",{className:"mb-4",children:"In addition to cookies, we use browser local storage for:"}),u.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[u.jsx("li",{children:"Caching carnival data for offline access (Premium)"}),u.jsx("li",{children:"Storing FCM tokens for push notifications"}),u.jsx("li",{children:"Temporary UI state"})]})]}),u.jsxs(Oe,{title:"5. Managing Cookies",children:[u.jsx("p",{className:"mb-4",children:"You can manage cookies through your browser settings:"}),u.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[u.jsxs("li",{children:[u.jsx("strong",{children:"Chrome:"})," Settings  Privacy and security  Cookies"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Firefox:"})," Settings  Privacy & Security  Cookies"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Safari:"})," Preferences  Privacy  Cookies"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Edge:"})," Settings  Cookies and site permissions"]})]}),u.jsx("p",{className:"mt-4 text-yellow-400",children:"Note: Disabling essential cookies may prevent you from using the Service."})]}),u.jsx(Oe,{title:"6. Updates to This Policy",children:u.jsx("p",{children:"We may update this Cookie Policy to reflect changes in our practices or for legal reasons. Check this page periodically for updates."})}),u.jsx(Oe,{title:"7. Contact",children:u.jsxs("p",{children:["For questions about our use of cookies, contact us at ",u.jsx("a",{href:`mailto:${Dn}`,className:"text-pink-400 hover:underline",children:Dn}),"."]})})]})}function wF({onBack:t,logo:e}){return u.jsxs(Pp,{title:"Refund Policy",icon:Cv,onBack:t,logo:e,children:[u.jsxs("p",{className:"text-gray-400 mb-6",children:["Last Updated: ",Sp]}),u.jsx(Oe,{title:"1. Premium Subscription",children:u.jsxs("p",{children:[Ds," offers premium subscriptions at $4.99/month or $39.99/year. This policy explains our refund terms for these subscriptions."]})}),u.jsxs(Oe,{title:"2. Subscription Cancellation",children:[u.jsx("h4",{className:"font-semibold text-white mb-2",children:"2.1 How to Cancel"}),u.jsx("p",{className:"mb-4",children:"You can cancel your subscription at any time by:"}),u.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[u.jsxs("li",{children:["Contacting us at ",u.jsx("a",{href:`mailto:${Dn}`,className:"text-pink-400 hover:underline",children:Dn})]}),u.jsx("li",{children:"Managing your subscription through Stripe's customer portal (link provided in your confirmation email)"})]}),u.jsx("h4",{className:"font-semibold text-white mb-2",children:"2.2 Effect of Cancellation"}),u.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[u.jsx("li",{children:"Your premium access continues until the end of your current billing period"}),u.jsx("li",{children:"You will not be charged again after cancellation"}),u.jsx("li",{children:"No partial refunds are provided for unused time in the current billing period"})]})]}),u.jsxs(Oe,{title:"3. Refund Eligibility",children:[u.jsx("h4",{className:"font-semibold text-white mb-2",children:"3.1 Eligible for Refund"}),u.jsx("p",{className:"mb-2",children:"We offer refunds in the following situations:"}),u.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[u.jsxs("li",{children:[u.jsx("strong",{children:"Technical Issues:"})," If the Service was unavailable or significantly impaired for an extended period"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Accidental Purchase:"})," If you accidentally subscribed and request a refund within 48 hours, without using premium features"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Duplicate Charges:"})," If you were charged multiple times for the same subscription period"]})]}),u.jsx("h4",{className:"font-semibold text-white mb-2",children:"3.2 Not Eligible for Refund"}),u.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[u.jsx("li",{children:"Change of mind after using premium features"}),u.jsx("li",{children:"Requests made after 30 days from the charge date"}),u.jsx("li",{children:"Failure to cancel before renewal (you must cancel before renewal to avoid charges)"}),u.jsx("li",{children:"Issues caused by your device, browser, or internet connection"})]})]}),u.jsxs(Oe,{title:"4. How to Request a Refund",children:[u.jsx("p",{className:"mb-4",children:"To request a refund:"}),u.jsxs("ol",{className:"list-decimal list-inside space-y-2",children:[u.jsxs("li",{children:["Email us at ",u.jsx("a",{href:`mailto:${Dn}`,className:"text-pink-400 hover:underline",children:Dn})]}),u.jsx("li",{children:"Include your account email and the date of the charge"}),u.jsx("li",{children:"Explain the reason for your refund request"})]}),u.jsx("p",{className:"mt-4",children:"We will review your request and respond within 5 business days."})]}),u.jsxs(Oe,{title:"5. Refund Processing",children:[u.jsx("p",{className:"mb-4",children:"If your refund is approved:"}),u.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[u.jsx("li",{children:"Refunds are processed through Stripe to your original payment method"}),u.jsx("li",{children:"Allow 5-10 business days for the refund to appear on your statement"}),u.jsx("li",{children:"Your premium access will be revoked upon refund"})]})]}),u.jsx(Oe,{title:"6. Free Trial",children:u.jsx("p",{children:"We do not currently offer free trials. All core features are free to use. Premium features require a paid subscription."})}),u.jsx(Oe,{title:"7. Price Changes",children:u.jsx("p",{children:"If we increase subscription prices, existing subscribers will be notified at least 30 days in advance. You may cancel before the new price takes effect to avoid being charged at the higher rate."})}),u.jsx(Oe,{title:"8. Contact",children:u.jsxs("p",{children:["For refund requests or questions about this policy, contact us at ",u.jsx("a",{href:`mailto:${Dn}`,className:"text-pink-400 hover:underline",children:Dn}),"."]})})]})}function Pp({title:t,icon:e,onBack:n,logo:r,children:i}){return u.jsxs("div",{className:"min-h-screen bg-slate-950 text-white",children:[u.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[u.jsx("div",{className:"absolute w-[600px] h-[600px] bg-gradient-to-r from-pink-500/20 to-purple-500/20 rounded-full blur-3xl -top-48 -right-48"}),u.jsx("div",{className:"absolute w-[400px] h-[400px] bg-gradient-to-r from-blue-500/15 to-cyan-500/15 rounded-full blur-3xl bottom-0 left-0"})]}),u.jsxs("div",{className:"relative max-w-4xl mx-auto px-6 py-12",children:[u.jsxs("button",{onClick:n,className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors mb-8",children:[u.jsx(Nv,{className:"w-5 h-5"}),"Back"]}),u.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[r&&u.jsx("img",{src:r,alt:"Logo",className:"w-12 h-12 rounded-xl"}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-pink-500/30 to-purple-500/30 rounded-xl flex items-center justify-center",children:u.jsx(e,{className:"w-6 h-6 text-pink-400"})}),u.jsx("h1",{className:"text-3xl md:text-4xl font-bold",children:t})]})]}),u.jsx("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 rounded-2xl p-6 md:p-8",children:i}),u.jsx("footer",{className:"mt-12 text-center text-gray-500 text-sm",children:u.jsx("p",{children:"Carnival Planner - Plan your Mas. Track your Fetes. Coordinate your Squad."})})]})]})}function Oe({title:t,children:e}){return u.jsxs("div",{className:"mb-8",children:[u.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:t}),u.jsx("div",{className:"text-gray-300 leading-relaxed",children:e})]})}function bF(){const[t,e]=B.useState(null),[n,r]=B.useState(!1),[i,o]=B.useState(!1),[a,c]=B.useState(!1);B.useEffect(()=>{if(window.matchMedia("(display-mode: standalone)").matches){o(!0);return}const y=localStorage.getItem("pwa-install-dismissed");y&&(Date.now()-parseInt(y))/864e5<7&&c(!0);const v=S=>{S.preventDefault(),e(S),a||r(!0)},w=()=>{o(!0),r(!1),e(null)};return window.addEventListener("beforeinstallprompt",v),window.addEventListener("appinstalled",w),()=>{window.removeEventListener("beforeinstallprompt",v),window.removeEventListener("appinstalled",w)}},[a]);const h=async()=>{if(!t)return;t.prompt();const{outcome:y}=await t.userChoice;y==="accepted"&&o(!0),e(null),r(!1)},p=()=>{r(!1),c(!0),localStorage.setItem("pwa-install-dismissed",Date.now().toString())};return!n||i?null:u.jsx("div",{className:"fixed bottom-20 left-4 right-4 z-40 animate-slideUp md:left-auto md:right-4 md:max-w-sm safe-bottom",children:u.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 rounded-2xl shadow-2xl p-4 text-white",children:[u.jsx("button",{onClick:p,className:"absolute top-2 right-2 p-1 hover:bg-white/20 rounded-full transition-colors",children:u.jsx(Ql,{className:"w-5 h-5"})}),u.jsxs("div",{className:"flex items-start gap-4",children:[u.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center flex-shrink-0",children:u.jsx(X5,{className:"w-6 h-6"})}),u.jsxs("div",{className:"flex-1 pr-6",children:[u.jsx("h3",{className:"font-bold text-lg mb-1",children:"Add to Home Screen"}),u.jsx("p",{className:"text-white/80 text-sm mb-3",children:"Install Carnival Planner for quick access and offline use!"}),u.jsxs("button",{onClick:h,className:"flex items-center gap-2 px-4 py-2 bg-white text-purple-600 font-bold rounded-lg hover:bg-gray-100 transition-colors",children:[u.jsx(kp,{className:"w-4 h-4"}),"Install App"]})]})]})]})})}function EF({onBack:t,logo:e,user:n}){const[r,i]=B.useState(""),[o,a]=B.useState(""),[c,h]=B.useState((n==null?void 0:n.email)||""),[p,y]=B.useState(!1),[v,w]=B.useState(!1),[S,N]=B.useState(""),A=async U=>{if(U.preventDefault(),!o.trim()||!c.trim()){N("Please fill in all required fields");return}y(!0),N("");try{await vp(Mn(ze,"support-requests"),{email:c.trim(),subject:r.trim()||"General Inquiry",message:o.trim(),userId:(n==null?void 0:n.uid)||null,userName:(n==null?void 0:n.displayName)||null,status:"new",createdAt:Ke.now()}),w(!0),i(""),a("")}catch(j){console.error("Error submitting support request:",j),N("Failed to send message. Please try again.")}finally{y(!1)}};return v?u.jsx("div",{className:"min-h-screen bg-slate-950 text-white flex items-center justify-center p-6",children:u.jsxs("div",{className:"text-center max-w-md",children:[u.jsx("div",{className:"w-20 h-20 bg-green-500/20 rounded-full flex items-center justify-center mx-auto mb-6",children:u.jsx(L5,{className:"w-10 h-10 text-green-400"})}),u.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Message Sent!"}),u.jsx("p",{className:"text-gray-400 mb-8",children:"Thank you for reaching out. We'll get back to you as soon as possible."}),u.jsx("button",{onClick:t,className:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-500 rounded-xl font-bold hover:opacity-90 transition-opacity",children:"Back to App"})]})}):u.jsxs("div",{className:"min-h-screen bg-slate-950 text-white",children:[u.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[u.jsx("div",{className:"absolute w-[600px] h-[600px] bg-gradient-to-r from-pink-500/20 to-purple-500/20 rounded-full blur-3xl -top-48 -right-48"}),u.jsx("div",{className:"absolute w-[400px] h-[400px] bg-gradient-to-r from-blue-500/15 to-cyan-500/15 rounded-full blur-3xl bottom-0 left-0"})]}),u.jsxs("div",{className:"relative max-w-2xl mx-auto px-6 py-12",children:[u.jsxs("button",{onClick:t,className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors mb-8",children:[u.jsx(Nv,{className:"w-5 h-5"}),"Back"]}),u.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e&&u.jsx("img",{src:e,alt:"Logo",className:"w-12 h-12 rounded-xl"}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-pink-500/30 to-purple-500/30 rounded-xl flex items-center justify-center",children:u.jsx(z1,{className:"w-6 h-6 text-pink-400"})}),u.jsx("h1",{className:"text-3xl md:text-4xl font-bold",children:"Contact Support"})]})]}),u.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 rounded-2xl p-6 md:p-8",children:[u.jsx("p",{className:"text-gray-400 mb-6",children:"Have a question, feedback, or need help? Send us a message and we'll get back to you as soon as possible."}),u.jsxs("form",{onSubmit:A,className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email Address *"}),u.jsxs("div",{className:"relative",children:[u.jsx(Lv,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),u.jsx("input",{type:"email",value:c,onChange:U=>h(U.target.value),placeholder:"your@email.com",required:!0,className:"w-full pl-10 pr-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:border-pink-500 transition-colors"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Subject"}),u.jsxs("select",{value:r,onChange:U=>i(U.target.value),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white focus:outline-none focus:border-pink-500 transition-colors",children:[u.jsx("option",{value:"",className:"bg-gray-900",children:"Select a topic..."}),u.jsx("option",{value:"General Question",className:"bg-gray-900",children:"General Question"}),u.jsx("option",{value:"Premium Subscription",className:"bg-gray-900",children:"Premium Subscription"}),u.jsx("option",{value:"Technical Issue",className:"bg-gray-900",children:"Technical Issue"}),u.jsx("option",{value:"Feature Request",className:"bg-gray-900",children:"Feature Request"}),u.jsx("option",{value:"Refund Request",className:"bg-gray-900",children:"Refund Request"}),u.jsx("option",{value:"Account Issue",className:"bg-gray-900",children:"Account Issue"}),u.jsx("option",{value:"Other",className:"bg-gray-900",children:"Other"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Message *"}),u.jsx("textarea",{value:o,onChange:U=>a(U.target.value),placeholder:"How can we help you?",required:!0,rows:6,className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:border-pink-500 transition-colors resize-none"})]}),S&&u.jsx("p",{className:"text-red-400 text-sm",children:S}),u.jsx("button",{type:"submit",disabled:p,className:"w-full flex items-center justify-center gap-2 px-6 py-4 bg-gradient-to-r from-pink-500 to-purple-500 rounded-xl font-bold text-lg hover:opacity-90 transition-opacity disabled:opacity-50",children:p?u.jsxs(u.Fragment,{children:[u.jsx(qr,{className:"w-5 h-5 animate-spin"}),"Sending..."]}):u.jsxs(u.Fragment,{children:[u.jsx($1,{className:"w-5 h-5"}),"Send Message"]})})]})]}),u.jsxs("p",{className:"text-gray-500 text-sm text-center mt-8",children:["You can also email us directly at"," ",u.jsx("a",{href:"mailto:support@carnival-planner.com",className:"text-pink-400 hover:underline",children:"support@carnival-planner.com"})]})]})]})}function TF(){const[t,e]=B.useState([]),[n,r]=B.useState(!0);B.useEffect(()=>{const o=sv(Mn(ze,"support-requests"),VS("createdAt","desc")),a=Fs(o,c=>{const h=c.docs.map(p=>({id:p.id,...p.data()}));e(h),r(!1)});return()=>a()},[]);const i=async o=>{confirm("Delete this support request?")&&await qS(Et(ze,"support-requests",o))};return n?u.jsx("div",{className:"text-center py-8 text-gray-500",children:u.jsx(qr,{className:"w-6 h-6 animate-spin mx-auto"})}):u.jsxs("div",{className:"mt-6 border-t border-gray-200 dark:border-gray-700 pt-6",children:[u.jsxs("h3",{className:"font-bold text-lg mb-4 text-gray-800 dark:text-white flex items-center gap-2",children:[u.jsx(z1,{className:"w-5 h-5"}),"Support Requests (",t.length,")"]}),t.length===0?u.jsx("p",{className:"text-gray-500 text-center py-4",children:"No support requests yet"}):u.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:t.map(o=>{var a,c;return u.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"flex justify-between items-start mb-2",children:[u.jsxs("div",{children:[u.jsx("span",{className:"font-medium text-gray-800 dark:text-white",children:o.email}),u.jsx("span",{className:"mx-2 text-gray-400",children:"|"}),u.jsx("span",{className:"text-sm text-gray-500",children:o.subject||"General"})]}),u.jsx("button",{onClick:()=>i(o.id),className:"p-1 text-gray-400 hover:text-red-500 transition-colors",children:u.jsx(ia,{className:"w-4 h-4"})})]}),u.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm whitespace-pre-wrap",children:o.message}),u.jsx("p",{className:"text-xs text-gray-400 mt-2",children:((c=(a=o.createdAt)==null?void 0:a.toDate)==null?void 0:c.call(a).toLocaleString())||"Unknown date"})]},o.id)})})]})}function IF({user:t,onClose:e}){const[n,r]=B.useState(!1),[i,o]=B.useState(""),[a,c]=B.useState(!1),[h,p]=B.useState(""),[y,v]=B.useState({displayName:"",bio:"",avatarUrl:""}),[w,S]=B.useState(!1),[N,A]=B.useState(!1),[U,j]=B.useState(!1),[k,R]=B.useState(""),z=B.useRef(null);B.useEffect(()=>{if(!t)return;(async()=>{try{const C=Et(ze,"users",t.uid,"profile","info"),P=await ol(C);if(P.exists()){const O=P.data();v({displayName:O.displayName||t.displayName||"",bio:O.bio||"",avatarUrl:O.avatarUrl||t.photoURL||""})}else v({displayName:t.displayName||"",bio:"",avatarUrl:t.photoURL||""})}catch(C){console.log("Could not load profile:",C)}})()},[t]);const K=async()=>{if(t){A(!0),p("");try{const b=Et(ze,"users",t.uid,"profile","info");await qi(b,{displayName:y.displayName,bio:y.bio,avatarUrl:y.avatarUrl,updatedAt:Ke.now()},{merge:!0}),S(!1),R("Profile saved!"),setTimeout(()=>R(""),3e3)}catch(b){console.error("Error saving profile:",b),p("Could not save profile. Please try again.")}finally{A(!1)}}},H=async b=>{const C=b.target.files[0];if(!C||!t)return;if(C.size>2*1024*1024){p("Image too large. Max 2MB.");return}if(!["image/jpeg","image/png","image/gif","image/webp"].includes(C.type)){p("Please upload a JPG, PNG, GIF, or WebP image.");return}j(!0),p("");try{const O=Date.now(),F=C.name.split(".").pop(),M=`avatars/${t.uid}/${O}.${F}`,be=Vl(Fl,M);await bp(be,C);const Re=await Ep(be);v(ut=>({...ut,avatarUrl:Re}));const De=Et(ze,"users",t.uid,"profile","info");await qi(De,{avatarUrl:Re,updatedAt:Ke.now()},{merge:!0}),R("Avatar updated!"),setTimeout(()=>R(""),3e3)}catch(O){console.error("Avatar upload error:",O),p("Could not upload avatar. Please try again.")}finally{j(!1),z.current&&(z.current.value="")}},T=async()=>{if(i!=="DELETE"){p("Please type DELETE to confirm");return}c(!0),p("");try{const b=si(jn);await oi(b,"deleteUserAccount")(),await kI(Us),window.location.reload()}catch(b){console.error("Error deleting account:",b),p(b.message||"Failed to delete account. Please try again."),c(!1)}};return u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 border border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsx("h3",{className:"text-lg font-bold text-gray-800 dark:text-white",children:"Account Settings"}),e&&u.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:u.jsx(Ql,{className:"w-5 h-5"})})]}),k&&u.jsx("div",{className:"mb-4 p-3 bg-green-100 dark:bg-green-900/30 border border-green-200 dark:border-green-800 rounded-lg text-green-700 dark:text-green-400 text-sm",children:k}),h&&u.jsx("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg text-red-700 dark:text-red-400 text-sm",children:h}),u.jsxs("div",{className:"space-y-6",children:[u.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-xl p-5",children:u.jsxs("div",{className:"flex items-start gap-4",children:[u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"w-20 h-20 rounded-full overflow-hidden bg-gray-200 dark:bg-gray-600 flex items-center justify-center",children:y.avatarUrl?u.jsx("img",{src:y.avatarUrl,alt:"Avatar",className:"w-full h-full object-cover"}):u.jsx(K1,{className:"w-10 h-10 text-gray-400"})}),u.jsx("input",{ref:z,type:"file",accept:"image/*",onChange:H,className:"hidden",id:"avatar-upload"}),u.jsx("label",{htmlFor:"avatar-upload",className:"absolute -bottom-1 -right-1 p-1.5 bg-blue-600 rounded-full text-white cursor-pointer hover:bg-blue-700 transition",children:U?u.jsx(qr,{className:"w-4 h-4 animate-spin"}):u.jsx(U1,{className:"w-4 h-4"})})]}),u.jsx("div",{className:"flex-1",children:w?u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Display Name"}),u.jsx("input",{type:"text",value:y.displayName,onChange:b=>v(C=>({...C,displayName:b.target.value})),placeholder:"Your name",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",maxLength:50})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Bio"}),u.jsx("textarea",{value:y.bio,onChange:b=>v(C=>({...C,bio:b.target.value})),placeholder:"Tell us about yourself...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm resize-none",rows:3,maxLength:200}),u.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[y.bio.length,"/200"]})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsxs("button",{onClick:K,disabled:N,className:"flex items-center gap-1.5 px-3 py-1.5 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[N?u.jsx(qr,{className:"w-4 h-4 animate-spin"}):u.jsx(Z5,{className:"w-4 h-4"}),"Save"]}),u.jsx("button",{onClick:()=>S(!1),className:"px-3 py-1.5 bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300 text-sm rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500",children:"Cancel"})]})]}):u.jsxs("div",{children:[u.jsx("h4",{className:"font-bold text-gray-800 dark:text-white mb-1",children:y.displayName||"No name set"}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:t==null?void 0:t.email}),y.bio&&u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-3",children:y.bio}),u.jsxs("button",{onClick:()=>S(!0),className:"flex items-center gap-1.5 px-3 py-1.5 bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 text-sm rounded-lg hover:bg-blue-200 dark:hover:bg-blue-900/50 transition",children:[u.jsx(G5,{className:"w-4 h-4"}),"Edit Profile"]})]})})]})}),u.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-6",children:[u.jsxs("h4",{className:"text-red-600 dark:text-red-400 font-bold mb-2 flex items-center gap-2",children:[u.jsx(j5,{className:"w-5 h-5"}),"Danger Zone"]}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:"Permanently delete your account and all associated data. This action cannot be undone."}),n?u.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-4",children:[u.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mb-3",children:"This will permanently delete:"}),u.jsxs("ul",{className:"text-sm text-red-500 dark:text-red-400 list-disc list-inside mb-4 space-y-1",children:[u.jsx("li",{children:"All your carnival plans and data"}),u.jsx("li",{children:"Uploaded photos and documents"}),u.jsx("li",{children:"Squad memberships"}),u.jsx("li",{children:"Your account and login"})]}),u.jsxs("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Type ",u.jsx("span",{className:"font-mono bg-gray-200 dark:bg-gray-700 px-1 rounded",children:"DELETE"})," to confirm:"]}),u.jsx("input",{type:"text",value:i,onChange:b=>o(b.target.value),placeholder:"Type DELETE",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white mb-3"}),u.jsxs("div",{className:"flex gap-3",children:[u.jsx("button",{onClick:()=>{r(!1),o(""),p("")},disabled:a,className:"flex-1 px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors disabled:opacity-50",children:"Cancel"}),u.jsx("button",{onClick:T,disabled:a||i!=="DELETE",className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50",children:a?u.jsxs(u.Fragment,{children:[u.jsx(qr,{className:"w-4 h-4 animate-spin"}),"Deleting..."]}):u.jsxs(u.Fragment,{children:[u.jsx(ia,{className:"w-4 h-4"}),"Delete Forever"]})})]})]}):u.jsxs("button",{onClick:()=>r(!0),className:"flex items-center gap-2 px-4 py-2 bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 rounded-lg hover:bg-red-200 dark:hover:bg-red-900/50 transition-colors",children:[u.jsx(ia,{className:"w-4 h-4"}),"Delete My Account"]})]})]})]})}function kF({user:t,activeCarnivalId:e}){const n=`http://localhost:5001/socapassport?uid=${(t==null?void 0:t.uid)||""}&carnival=${e||""}`;return u.jsxs("div",{className:"flex flex-col min-h-[500px] bg-white dark:bg-gray-800 rounded-2xl overflow-hidden border border-gray-100 dark:border-gray-700 shadow-xl transition-all duration-300",children:[u.jsxs("div",{className:"p-8 bg-gradient-to-br from-teal-600 via-teal-500 to-emerald-500 text-white relative overflow-hidden",children:[u.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full -mr-20 -mt-20 blur-3xl"}),u.jsx("div",{className:"absolute bottom-0 left-0 w-32 h-32 bg-emerald-400/20 rounded-full -ml-10 -mb-10 blur-2xl"}),u.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row md:items-center justify-between gap-6",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("div",{className:"p-3 bg-white/20 backdrop-blur-md rounded-2xl shadow-inner group transition-transform hover:scale-105",children:u.jsx(Cv,{className:"w-8 h-8"})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-2xl font-black tracking-tight",children:"SOCA PASSPORT"}),u.jsx("p",{className:"text-teal-50 font-medium opacity-90",children:"Your Digital Carnival Identity"})]})]}),u.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-white/20 backdrop-blur-sm rounded-full text-[10px] font-bold uppercase tracking-widest border border-white/30",children:[u.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-300 animate-pulse"}),"Bridge Active"]})]})]}),u.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-8 text-center space-y-8",children:[u.jsxs("div",{className:"relative group cursor-pointer",onClick:()=>window.open(n,"_blank"),children:[u.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-teal-500 to-emerald-500 rounded-3xl blur opacity-25 group-hover:opacity-100 transition duration-1000 group-hover:duration-200"}),u.jsxs("div",{className:"relative p-10 bg-white dark:bg-gray-900 rounded-3xl border border-gray-100 dark:border-gray-800 shadow-sm flex flex-col items-center gap-4 transition-transform hover:scale-[1.02]",children:[u.jsx("div",{className:"w-20 h-20 bg-teal-50 dark:bg-teal-900/30 rounded-full flex items-center justify-center mb-2",children:u.jsx(Mv,{className:"w-10 h-10 text-teal-500"})}),u.jsx("h4",{className:"text-xl font-bold text-gray-800 dark:text-white",children:"Ready to Sync?"}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 max-w-xs leading-relaxed",children:"Open your Soca Passport to view your digital credentials, collection, and vibes."}),u.jsxs("button",{onClick:r=>{r.stopPropagation(),window.open(n,"_blank")},className:"mt-4 group flex items-center gap-3 px-8 py-4 bg-teal-600 hover:bg-teal-700 text-white rounded-2xl font-bold shadow-lg shadow-teal-600/20 transition-all hover:-translate-y-1 active:scale-95",children:["LAUNCH PASSPORT",u.jsx(Rv,{className:"w-5 h-5 group-hover:translate-x-1 group-hover:-translate-y-1 transition-transform"})]})]})]}),u.jsxs("div",{className:"max-w-md p-4 bg-gray-50 dark:bg-gray-700/50 rounded-2xl border border-gray-200 dark:border-gray-600 flex gap-4 text-left",children:[u.jsx("div",{className:"flex-shrink-0 mt-0.5",children:u.jsx(B5,{className:"w-5 h-5 text-gray-400"})}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs font-bold text-gray-700 dark:text-gray-300 mb-1",children:"Secure Bridge "}),u.jsx("p",{className:"text-[11px] leading-relaxed text-gray-500 dark:text-gray-400",children:`For your security, Soca Passport opens in a protected environment. We've automatically passed your credentials to ensure a seamless "hand-in-hand" experience.`})]})]})]}),u.jsxs("div",{className:"px-8 py-6 bg-gray-50 dark:bg-gray-900/80 border-t border-gray-100 dark:border-gray-800 flex flex-col sm:flex-row items-center justify-between gap-4 grayscale opacity-70 hover:grayscale-0 hover:opacity-100 transition-all",children:[u.jsxs("div",{className:"flex items-center gap-6",children:[u.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-black tracking-widest uppercase text-gray-400",children:[u.jsx(Y5,{className:"w-3.5 h-3.5"}),"Encryption Active"]}),u.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-black tracking-widest uppercase text-gray-400",children:[u.jsx(Pf,{className:"w-3.5 h-3.5 text-teal-500"}),"Sound Sync: ON"]})]}),u.jsx("p",{className:"text-[10px] font-bold text-gray-300 dark:text-gray-600 italic",children:"SOCA AUTHENTICATION SERVICE v2.4"})]})]})}function kb({user:t,activeCarnivalId:e,carnivalData:n,scrapedEvents:r=[],squadMembers:i=[],budgetTotal:o=0,budgetSpent:a=0,isPremium:c,onAction:h}){var S;const p=B.useMemo(()=>{if(e)return n.find(j=>j.name.toLowerCase().includes(e.replace(/-/g," ")))||n[0];const N=new Date,A=[...n].sort((U,j)=>new Date(U.date)-new Date(j.date));return A.find(U=>new Date(U.date)>=N)||A[0]},[e,n]),[y,v]=B.useState({days:0,hours:0});B.useEffect(()=>{if(!p)return;const N=()=>{const k=new Date(p.date+"T00:00:00")-new Date;if(k>0){const R=Math.floor(k/864e5),z=Math.floor(k/(1e3*60*60)%24);v({days:R,hours:z})}else v({days:0,hours:0})};N();const A=setInterval(N,6e4);return()=>clearInterval(A)},[p]);const w=B.useMemo(()=>r.length>0?r.slice(0,5):[{id:"t1",title:"Soca Brainwash",venue:"Queens Park Oval"},{id:"t2",title:"Soaka Arts & Music",venue:"O2 Park"},{id:"t3",title:"Phuket All Inclusive",venue:"Anchorage"}],[r]);return u.jsxs("div",{className:"space-y-6 mb-8 animate-fadeIn",children:[u.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 shadow-2xl text-white",children:[u.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full blur-3xl -mr-16 -mt-16"}),u.jsx("div",{className:"absolute bottom-0 left-0 w-48 h-48 bg-pink-500/20 rounded-full blur-3xl -ml-10 -mb-10 animate-pulse"}),u.jsxs("div",{className:"relative z-10 p-6 sm:p-8",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.jsx("span",{className:"px-2 py-1 rounded-full bg-white/20 backdrop-blur-sm text-[10px] font-bold uppercase tracking-widest border border-white/10",children:e?"CURRENT MISSION":"UP NEXT"}),c&&u.jsxs("span",{className:"flex items-center px-2 py-1 rounded-full bg-yellow-400/20 text-yellow-300 text-[10px] font-bold uppercase tracking-widest",children:[u.jsx(Mv,{className:"w-3 h-3 mr-1"})," Premium"]})]}),u.jsx("h2",{className:"text-3xl sm:text-4xl font-black tracking-tight leading-none mb-1",children:((S=p==null?void 0:p.name)==null?void 0:S.split("(")[0].trim())||"Carnival"}),u.jsx("p",{className:"text-white/80 text-sm font-medium",children:"Get ready for the road."})]}),u.jsxs("div",{className:"flex items-center gap-3 bg-white/10 backdrop-blur-md rounded-2xl p-4 border border-white/10",children:[u.jsxs("div",{className:"text-center",children:[u.jsx("span",{className:"block text-2xl sm:text-3xl font-black",children:y.days}),u.jsx("span",{className:"text-[10px] uppercase opacity-70",children:"Days"})]}),u.jsx("div",{className:"h-8 w-px bg-white/20"}),u.jsxs("div",{className:"text-center",children:[u.jsx("span",{className:"block text-2xl sm:text-3xl font-black",children:y.hours}),u.jsx("span",{className:"text-[10px] uppercase opacity-70",children:"Hrs"})]})]})]}),u.jsxs("div",{className:"mt-8 flex items-center gap-3 bg-black/20 rounded-xl p-2.5 backdrop-blur-sm overflow-hidden",children:[u.jsxs("div",{className:"flex-shrink-0 flex items-center gap-1.5 px-2 py-0.5 bg-red-500 rounded text-[10px] font-bold uppercase animate-pulse",children:[u.jsx("div",{className:"w-1.5 h-1.5 bg-white rounded-full"}),"Live"]}),u.jsx("div",{className:"flex-1 overflow-hidden whitespace-nowrap",children:u.jsx("div",{className:"inline-block animate-marquee text-xs font-medium",children:w.map((N,A)=>u.jsxs("span",{className:"mr-8",children:[" ",u.jsx("span",{className:"font-bold text-pink-200",children:N.title}),N.venue&&u.jsxs("span",{className:"opacity-75",children:[" @ ",N.venue]}),N.price&&u.jsxs("span",{className:"text-green-300 ml-1",children:["($",N.price,")"]})]},N.id||A))})})]})]})]}),u.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[u.jsxs("div",{onClick:()=>h("Budget"),className:"bg-white dark:bg-gray-800 p-4 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 cursor-pointer hover:shadow-md transition-all group",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/30 rounded-lg text-blue-600 dark:text-blue-400",children:u.jsx(Z1,{className:"w-5 h-5"})}),u.jsx(Sh,{className:"w-4 h-4 text-gray-300 group-hover:text-blue-500 transition-colors"})]}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium",children:"Budget Spent"}),u.jsxs("p",{className:"text-lg font-bold text-gray-800 dark:text-white mt-0.5",children:["$",a.toLocaleString(),u.jsxs("span",{className:"text-xs text-gray-400 font-normal ml-1",children:["/ $",o.toLocaleString()]})]}),o>0&&u.jsx("div",{className:"w-full h-1.5 bg-gray-100 dark:bg-gray-700 rounded-full mt-2",children:u.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:`${Math.min(a/o*100,100)}%`}})})]}),u.jsxs("div",{onClick:()=>h("Squad"),className:"bg-white dark:bg-gray-800 p-4 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 cursor-pointer hover:shadow-md transition-all group",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/30 rounded-lg text-green-600 dark:text-green-400",children:u.jsx(Ri,{className:"w-5 h-5"})}),u.jsx(Sh,{className:"w-4 h-4 text-gray-300 group-hover:text-green-500 transition-colors"})]}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium",children:"Squad Online"}),u.jsxs("p",{className:"text-lg font-bold text-gray-800 dark:text-white mt-0.5",children:[i.length+1,u.jsx("span",{className:"text-xs text-gray-400 font-normal ml-1",children:"members"})]}),u.jsx("div",{className:"flex -space-x-2 mt-2",children:[...Array(Math.min(i.length+1,4))].map((N,A)=>u.jsx("div",{className:"w-6 h-6 rounded-full bg-gray-200 dark:bg-gray-600 border-2 border-white dark:border-gray-800"},A))})]}),u.jsxs("div",{onClick:()=>h("Map"),className:"bg-white dark:bg-gray-800 p-4 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 cursor-pointer hover:shadow-md transition-all group",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-900/30 rounded-lg text-purple-600 dark:text-purple-400",children:u.jsx(Bc,{className:"w-5 h-5"})}),u.jsx(Sh,{className:"w-4 h-4 text-gray-300 group-hover:text-purple-500 transition-colors"})]}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium",children:"Live Events"}),u.jsx("p",{className:"text-lg font-bold text-gray-800 dark:text-white mt-0.5",children:r.length||"30+"}),u.jsx("p",{className:"text-[10px] text-purple-500 font-bold mt-1",children:" View Map"})]}),u.jsxs("div",{onClick:()=>h("Passport"),className:"bg-gradient-to-br from-teal-500 to-emerald-600 p-4 rounded-2xl shadow-sm shadow-teal-500/20 cursor-pointer hover:shadow-md hover:scale-[1.02] transition-all group",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("div",{className:"p-2 bg-white/20 rounded-lg text-white",children:u.jsx(Dv,{className:"w-5 h-5"})}),u.jsx(Rv,{className:"w-4 h-4 text-white/70 group-hover:text-white transition-colors"})]}),u.jsx("p",{className:"text-xs text-teal-100 font-medium",children:"Identity"}),u.jsx("p",{className:"text-lg font-bold text-white mt-0.5",children:"Passport"}),u.jsx("p",{className:"text-[10px] text-white/80 font-bold mt-1",children:"Launch App"})]})]})]})}function SF({onBack:t,onSuccess:e}){const[n,r]=B.useState("login"),[i,o]=B.useState(""),[a,c]=B.useState(""),[h,p]=B.useState(""),[y,v]=B.useState(!1),[w,S]=B.useState(!1),[N,A]=B.useState(""),[U,j]=B.useState(""),k=T=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(T),R=T=>{switch(T){case"auth/email-already-in-use":return"This email is already registered. Try logging in instead.";case"auth/invalid-email":return"Please enter a valid email address.";case"auth/weak-password":return"Password should be at least 6 characters.";case"auth/user-not-found":return"No account found with this email.";case"auth/wrong-password":return"Incorrect password. Please try again.";case"auth/invalid-credential":return"Invalid email or password. Please check and try again.";case"auth/too-many-requests":return"Too many attempts. Please try again later.";default:return"Something went wrong. Please try again."}},z=async T=>{if(T.preventDefault(),A(""),j(""),!k(i)){A("Please enter a valid email address.");return}if(a.length<6){A("Password must be at least 6 characters.");return}if(a!==h){A("Passwords do not match.");return}S(!0);try{const b=await kR(Us,i,a);await II(b.user),j("Account created! Please check your email to verify your account."),e&&e(b.user)}catch(b){console.error("Sign up error:",b),A(R(b.code))}finally{S(!1)}},K=async T=>{if(T.preventDefault(),A(""),j(""),!k(i)){A("Please enter a valid email address.");return}if(!a){A("Please enter your password.");return}S(!0);try{const b=await SR(Us,i,a);e&&e(b.user)}catch(b){console.error("Login error:",b),A(R(b.code))}finally{S(!1)}},H=async()=>{if(A(""),j(""),!k(i)){A("Please enter your email address first.");return}S(!0);try{await IR(Us,i),j("Password reset email sent! Check your inbox.")}catch(T){console.error("Password reset error:",T),A(R(T.code))}finally{S(!1)}};return u.jsxs("div",{className:"w-full max-w-md mx-auto",children:[u.jsxs("button",{onClick:t,className:"flex items-center gap-2 text-gray-400 hover:text-white mb-6 transition-colors",children:[u.jsx(Nv,{className:"w-4 h-4"}),"Back"]}),u.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 rounded-2xl p-6",children:[u.jsx("h2",{className:"text-2xl font-bold text-white mb-6 text-center",children:n==="login"?"Welcome Back":"Create Account"}),N&&u.jsx("div",{className:"mb-4 p-3 bg-red-500/20 border border-red-500/30 rounded-lg text-red-300 text-sm",children:N}),U&&u.jsx("div",{className:"mb-4 p-3 bg-green-500/20 border border-green-500/30 rounded-lg text-green-300 text-sm",children:U}),u.jsxs("form",{onSubmit:n==="login"?K:z,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Email"}),u.jsxs("div",{className:"relative",children:[u.jsx(Lv,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),u.jsx("input",{type:"email",value:i,onChange:T=>o(T.target.value),placeholder:"your@email.com",className:"w-full pl-10 pr-4 py-3 bg-gray-900/80 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:border-pink-500 focus:ring-2 focus:ring-pink-500/20 transition-colors",disabled:w})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Password"}),u.jsxs("div",{className:"relative",children:[u.jsx(wb,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),u.jsx("input",{type:y?"text":"password",value:a,onChange:T=>c(T.target.value),placeholder:"Enter your password",className:"w-full pl-10 pr-12 py-3 bg-gray-900/80 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:border-pink-500 focus:ring-2 focus:ring-pink-500/20 transition-colors",disabled:w}),u.jsx("button",{type:"button",onClick:()=>v(!y),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-300",children:y?u.jsx(V5,{className:"w-5 h-5"}):u.jsx(jv,{className:"w-5 h-5"})})]})]}),n==="signup"&&u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Confirm Password"}),u.jsxs("div",{className:"relative",children:[u.jsx(wb,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),u.jsx("input",{type:y?"text":"password",value:h,onChange:T=>p(T.target.value),placeholder:"Confirm your password",className:"w-full pl-10 pr-4 py-3 bg-gray-900/80 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:border-pink-500 focus:ring-2 focus:ring-pink-500/20 transition-colors",disabled:w})]})]}),n==="login"&&u.jsx("div",{className:"text-right",children:u.jsx("button",{type:"button",onClick:H,className:"text-sm text-pink-400 hover:text-pink-300 transition-colors",disabled:w,children:"Forgot password?"})}),u.jsx("button",{type:"submit",disabled:w,className:"w-full py-3 bg-gradient-to-r from-pink-500 to-orange-500 rounded-xl font-bold text-white hover:opacity-90 transition-opacity disabled:opacity-50 flex items-center justify-center gap-2",children:w?u.jsxs(u.Fragment,{children:[u.jsx(qr,{className:"w-5 h-5 animate-spin"}),n==="login"?"Signing in...":"Creating account..."]}):n==="login"?"Sign In":"Create Account"})]}),u.jsx("div",{className:"mt-6 text-center",children:u.jsxs("p",{className:"text-gray-400 text-sm",children:[n==="login"?"Don't have an account?":"Already have an account?",u.jsx("button",{onClick:()=>{r(n==="login"?"signup":"login"),A(""),j("")},className:"ml-2 text-pink-400 hover:text-pink-300 font-semibold transition-colors",children:n==="login"?"Sign Up":"Sign In"})]})})]})]})}function PF({user:t,onResend:e}){const[n,r]=B.useState(!1),[i,o]=B.useState(!1);if(!t||t.emailVerified||!t.email)return null;const a=async()=>{r(!0);try{await II(t),o(!0),setTimeout(()=>o(!1),5e3)}catch(c){console.error("Error sending verification:",c)}finally{r(!1)}};return u.jsxs("div",{className:"bg-yellow-500/20 border border-yellow-500/30 text-yellow-200 px-4 py-3 flex items-center justify-between gap-4 flex-wrap",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Lv,{className:"w-5 h-5"}),u.jsx("span",{className:"text-sm",children:"Please verify your email address to access all features."})]}),u.jsx("button",{onClick:a,disabled:n||i,className:"text-sm font-semibold bg-yellow-500/30 hover:bg-yellow-500/40 px-3 py-1 rounded-lg transition-colors disabled:opacity-50",children:i?"Email Sent!":n?"Sending...":"Resend Email"})]})}const AF=()=>Math.random().toString(36).substring(2,8).toUpperCase(),NF=async(t,e,n)=>{if(!t)throw new Error("User not authenticated");const r=AF(),i={name:e,leaderId:t.uid,leaderName:t.displayName||t.email,members:[t.uid],memberDetails:{[t.uid]:{name:t.displayName||t.email,role:"leader",photoURL:t.photoURL||null,joinedAt:new Date().toISOString()}},carnivalId:n,inviteCode:r,createdAt:HS(),sharedItinerary:[]};console.log("Attempting to create squad doc...",i);const o=await vp(Mn(ze,"squads"),i);console.log("Squad doc created with ID:",o.id);const a=Et(ze,"users",t.uid);return console.log("Updating user profile for squad:",t.uid),await qi(a,{currentSquadId:o.id},{merge:!0}),console.log("User profile updated."),{id:o.id,...i}},CF=async(t,e)=>{if(!t||!e)return;const n=Et(ze,"squads",e),r=Et(ze,"users",t.uid);await If(n,{members:uO(t.uid)}),await If(r,{currentSquadId:null})},th="carnival-planner-v1",RF="price_1SanHUJR9xpdRiXijLesRPVt",jF="price_1SanMhJR9xpdRiXinv2F9knM",Sb={trinidad:[{title:"Soca Brainwash",note:"The main event. Bring drinks."},{title:"AM Bush",note:"J'ouvert style. Wear old clothes."},{title:"Phuket",note:"All inclusive."},{title:"Soaka Street Festival",note:"Iron park."}],stlucia:[{title:"Remedy",note:"Beachside."},{title:"Mess",note:"Paint and Powder."},{title:"Indulgence",note:"Breakfast fete."}],default:[{title:"Catamaran Cruise",note:"Boat ride."},{title:"J'ouvert",note:"Paint and powder."},{title:"Monday Mas",note:"On the road."}]};function LF(){var Jr,ps,ms,Rr,je,Xe,Xr;const[t,e]=B.useState(null),[n,r]=B.useState(!1),[i,o]=B.useState({}),[a,c]=B.useState(null),[h,p]=B.useState("Budget"),[y,v]=B.useState(!1),[w,S]=B.useState(!0),[N,A]=B.useState(!1),[U,j]=B.useState(!0),[k,R]=B.useState(!1),[z,K]=B.useState(""),[H,T]=B.useState(""),[b,C]=B.useState(""),[P,O]=B.useState(""),[F,M]=B.useState(""),[be,Re]=B.useState(""),[De,ut]=B.useState(""),[G,se]=B.useState({band:"",section:"",total:"",paid:""}),[X,ue]=B.useState(""),[de,ve]=B.useState(""),[Te,xe]=B.useState([]),[ge,Je]=B.useState(null),[Jt,St]=B.useState(!1),[it,Ue]=B.useState(!1),[yt,Ze]=B.useState(""),[mn,or]=B.useState(""),rs=async()=>{const{DEMO_USER:D,DEMO_CARNIVALS:Y,DEMO_SQUAD:ne}=await YN(async()=>{const{DEMO_USER:ie,DEMO_CARNIVALS:fe,DEMO_SQUAD:Qe}=await import("./demoData-59eL2sCn.js");return{DEMO_USER:ie,DEMO_CARNIVALS:fe,DEMO_SQUAD:Qe}},[]);r(!0),e(D),o(Y),c("trinidad"),xe(ne),v(!0),S(!1),Wt(Y.trinidad)},yi=()=>{r(!1),e(null),o({}),c(null),xe([]),v(!1),S(!0),Wt(null)};B.useEffect(()=>{new URLSearchParams(window.location.search).get("demo")==="true"&&rs()},[]);const is=async()=>{if(n){alert("This feature is simulated in Demo Mode.");return}if(t){St(!0),Ze("");try{const D=await NF(t,`${t.displayName||"User"}'s Squad`,a);Je(D),ue(D.inviteCode),Ir("Only Premium users can lead a squad!")}catch(D){console.error("Error creating squad:",D),Ze(`Failed: ${D.message}`)}finally{St(!1)}}},da=async()=>{if(n){alert("Joining squads is simulated in Demo Mode.");return}if(!t||!de)return;const D=de.trim().toUpperCase();Ue(!0),Ze(""),console.log("HandleJoinSquad: Attempting to join with code:",D);try{const Y=await yo(t,D);if(console.log("HandleJoinSquad: Join success. Squad result:",Y),!Y)throw new Error("Join successful but no squad data returned");or(`Joined ${Y.name||"Squad"}!`),ve("")}catch(Y){console.error("Error joining squad:",Y),Ze(Y.message||"Invalid code")}finally{Ue(!1)}},ss=async()=>{if(n){confirm("Exit Demo Mode?")&&yi();return}!t||!ge||confirm("Are you sure you want to leave this squad?")&&(await CF(t,ge.id),Je(null),xe([]))},[Hr,Ir]=B.useState(null),[_i,ho]=B.useState(!0),[fo,_t]=B.useState(!1),[Pt,Wr]=B.useState(navigator.onLine);B.useEffect(()=>{const D=()=>Wr(!0),Y=()=>Wr(!1);return window.addEventListener("online",D),window.addEventListener("offline",Y),()=>{window.removeEventListener("online",D),window.removeEventListener("offline",Y)}},[]);const[po,Sn]=B.useState(null),[ha,kr]=B.useState(!1),[Sr,Pr]=B.useState([]),[os,fa]=B.useState(!1),[Gr,as]=B.useState(null),pa=[{id:"stkitts-sugar-mas",name:"St. Kitts (Sugar Mas)",monthIndex:0},{id:"stcroix",name:"St. Croix Carnival",monthIndex:0},{id:"trinidad",name:"Trinidad Carnival",monthIndex:1},{id:"dominica",name:"Dominica (Mas Domnik)",monthIndex:1},{id:"jamaica",name:"Jamaica Carnival",monthIndex:3},{id:"tampa",name:"Tampa Bay Carnival",monthIndex:3},{id:"stmaarten",name:"St. Maarten Carnival",monthIndex:3},{id:"cayman-batabano",name:"Cayman Batabano",monthIndex:4},{id:"stthomas",name:"St. Thomas Carnival",monthIndex:4},{id:"atlanta",name:"Atlanta Caribbean Carnival",monthIndex:4},{id:"guyana",name:"Guyana Independence",monthIndex:4},{id:"bahamas",name:"Bahamas Carnival",monthIndex:5},{id:"bermuda",name:"Bermuda Carnival",monthIndex:5},{id:"hollywood",name:"Hollywood Carnival",monthIndex:5},{id:"caymas",name:"Caymas Carnival",monthIndex:5},{id:"vincymas",name:"St. Vincent (Vincy Mas)",monthIndex:6},{id:"stlucia",name:"St. Lucia Carnival",monthIndex:6},{id:"toronto",name:"Toronto (Caribana)",monthIndex:7},{id:"barbados",name:"Barbados Crop Over",monthIndex:7},{id:"nevis",name:"Nevis Culturama",monthIndex:7},{id:"antigua",name:"Antigua Carnival",monthIndex:7},{id:"grenada",name:"Grenada Spicemas",monthIndex:7},{id:"ny-labor-day",name:"New York Carnival",monthIndex:8},{id:"japan",name:"Japan Caribbean",monthIndex:8},{id:"miami",name:"Miami Carnival",monthIndex:9},{id:"tobago",name:"Tobago Carnival",monthIndex:10}],ls=["bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500","bg-gradient-to-r from-green-400 to-blue-500","bg-gradient-to-r from-yellow-400 via-red-500 to-pink-500","bg-gradient-to-r from-teal-400 to-cyan-500","bg-gradient-to-r from-red-500 via-orange-500 to-yellow-500","bg-gradient-to-r from-purple-600 to-indigo-600"],Ar=["January","February","March","April","May","June","July","August","September","October","November","December"];B.useEffect(()=>{U?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[U]),B.useEffect(()=>{if(!t||n)return;(async()=>{try{const Y=Et(ze,"users",t.uid,"preferences","theme"),ne=await ol(Y);if(ne.exists()){const ie=ne.data();typeof ie.darkMode=="boolean"&&j(ie.darkMode)}}catch(Y){console.log("Could not load theme preference:",Y)}})()},[t,n]);const us=async D=>{if(!(!t||n))try{const Y=Et(ze,"users",t.uid,"preferences","theme");await qi(Y,{darkMode:D,updatedAt:Ke.now()},{merge:!0})}catch(Y){console.log("Could not save theme preference:",Y)}},mo=()=>{const D=!U;j(D),us(D)};B.useEffect(()=>{if(n)return;const D=NR(Us,async Y=>{if(e(Y),Y){console.log("[Analytics] Creating/updating user doc for:",Y.uid,Y.email);try{const ne=Et(ze,"users",Y.uid);await qi(ne,{lastLoginAt:Ke.now(),email:Y.email||null,displayName:Y.displayName||null},{merge:!0}),console.log("[Analytics] User document updated successfully")}catch(ne){console.error("[Analytics] Failed to update user doc:",ne.code,ne.message)}}});return()=>D()},[n]),B.useEffect(()=>{if(!t){n||(Je(null),xe([]));return}if(n)return;const D=Fs(Et(ze,"users",t.uid),Y=>{const ne=Y.data();ne!=null&&ne.currentSquadId?Fs(Et(ze,"squads",ne.currentSquadId),ie=>{if(ie.exists()){const fe=ie.data();Je({id:ie.id,...fe}),Wt(fe);const Qe=Object.values(fe.memberDetails||{});xe(Qe),ue(fe.inviteCode)}else Je(null),Wt(null),xe([])}):(Je(null),xe([]))});return()=>D()},[t,n]),B.useEffect(()=>{if(!t){n||v(!1);return}if(n){v(!0);return}const D=["djkrss1@gmail.com","maikacooke@gmail.com"];D.includes(t.email)&&v(!0);const Y=Et(ze,"users",t.uid,"apps",th),ne=Fs(Y,ie=>{if(D.includes(t.email)){v(!0);return}if(ie.exists()){const fe=ie.data();v(!!fe.premiumActive)}else v(!1)});return()=>ne()},[t,n]),B.useEffect(()=>{if(!t){n||(o({}),c(null));return}if(n)return;const D=Mn(ze,"users",t.uid,"apps",th,"carnivals"),Y=Fs(D,ne=>{const ie={};ne.forEach(fe=>{ie[fe.id]=fe.data()}),o(ie),!a&&ne.docs.length>0&&c(ne.docs[0].id)});return()=>Y()},[t,n]),B.useEffect(()=>{n||rj(Us).catch(D=>console.error(D))},[n]),B.useEffect(()=>{if(!t||n)return;(async()=>{try{const ne=await f5("BLbW7EjHjQ9_YjKrRbJwgBgRqnkSmZsXMnEWTQZpqYwSRbVgYLmXW5RvXA2_aS3vH9XJpCxHu4VmXnZL2wQxMvI");if(ne){const ie=si(jn);await oi(ie,"saveFcmToken")({fcmToken:ne}),console.log("FCM token saved")}}catch(Y){console.log("Error setting up notifications:",Y)}})(),p5(Y=>{var ne,ie;console.log("Foreground message:",Y),Ir({title:((ne=Y.notification)==null?void 0:ne.title)||"Squad Alert",body:((ie=Y.notification)==null?void 0:ie.body)||"Someone in your squad is Road Ready!"}),setTimeout(()=>Ir(null),5e3)})},[t,n]);const Nr=async()=>{const D=new Ci;try{await QR(Us,D)}catch(Y){console.error("Sign in error:",Y)}},ma=async()=>{if(n){yi();return}await kI(Us),S(!0),A(!1),p("Budget"),j(!0)},vi=async D=>{if(n){alert("Subscriptions are disabled in Demo Mode.");return}if(!t){alert("You must be signed in to subscribe.");return}const Y=D==="yearly"?"yearly":"monthly",ne=Y==="yearly"?jF:RF;R(!0);try{const ie=si(jn),fe=oi(ie,"createCheckoutSession");console.log(`Starting checkout... Interval: ${Y}, PriceID: ${ne}`);const Qe=await fe({priceId:ne,success_url:window.location.origin,cancel_url:window.location.origin}),{data:Ce}=Qe||{};Ce&&(Ce.url||Ce.checkoutUrl)?window.location.href=Ce.url||Ce.checkoutUrl:(console.error("No checkout URL returned:",Ce),alert("Unable to start checkout. Please try again."))}catch(ie){console.error("Error starting checkout:",ie),alert("There was a problem starting your checkout: "+ie.message)}finally{R(!1)}},ga=async(D,Y)=>{if(t){if(c(D),n){i[D]?D==="trinidad"&&i.trinidad?Wt(i.trinidad):Wt(null):(o(ne=>({...ne,[D]:{name:Y,budget:[],schedule:[],packing:[],squad:[],costume:null,createdAt:new Date().toISOString()}})),Wt(null));return}if(!i[D])try{const ne=Et(ze,"users",t.uid,"apps",th,"carnivals",D);await qi(ne,{name:Y,budget:[],schedule:[],packing:[],squad:[],costume:null,createdAt:Ke.now()},{merge:!0})}catch(ne){console.error(ne)}}},gn=(Jr=i[a])==null?void 0:Jr.sharedPlanId,vt=!!gn,[lt,Wt]=B.useState(null),[Kr,Zr]=B.useState(!1),yn=async()=>{if(!n){if(!gn||!t){Wt(null);return}Zr(!0);try{const D=si(jn),ne=await oi(D,"getSharedCarnivalData")({planId:gn,uid:t.uid});Wt(ne.data)}catch(D){console.log("Could not load shared carnival data:",D.message),Wt(null)}finally{Zr(!1)}}};B.useEffect(()=>{gn&&!n?yn():n||Wt(null)},[gn,t,n]);const oe=async(D,Y,ne="set")=>{var fe;if(!t||!a)return;if(n){const Qe=Ce=>{let $e=Y;return ne==="add"&&Array.isArray(Ce[D])?$e=[...Ce[D]||[],...Y]:ne==="remove"&&Array.isArray(Ce[D])?$e=(Ce[D]||[]).filter(Bt=>Bt.id!==Y.id):ne==="update"&&Array.isArray(Ce[D])&&Y.id!==void 0&&($e=(Ce[D]||[]).map(Bt=>Bt.id===Y.id?{...Bt,...Y}:Bt)),ne==="set"&&($e=Y),{...Ce,[D]:$e}};vt?(Wt(Ce=>Qe(Ce)),o(Ce=>({...Ce,[a]:Qe(Ce[a])}))):o(Ce=>({...Ce,[a]:Qe(Ce[a])}));return}if(gn&&["budget","schedule","packing","costume","squad"].includes(D))try{const Qe=si(jn),$e=await oi(Qe,"updateSharedCarnivalData")({planId:gn,field:D,data:Y,action:ne,uid:t.uid,userEmail:t.email});(fe=$e.data)!=null&&fe.data&&Wt($e.data.data);return}catch(Qe){console.error("Error updating shared data:",Qe)}const ie=Et(ze,"users",t.uid,"apps",th,"carnivals",a);await If(ie,{[D]:Y})};B.useEffect(()=>{if(!t||!a||!y){Pr([]);return}(async()=>{var Y;fa(!0);try{const ne=si(jn),fe=await oi(ne,"getScrapedEvents")({carnivalId:a});(Y=fe.data)!=null&&Y.success?(Pr(fe.data.events||[]),as(fe.data.lastScrapedAt)):(Pr([]),as(null))}catch(ne){console.log("Error fetching scraped events:",ne),Pr([])}finally{fa(!1)}})()},[t,a,y]);const Cr=async()=>{var D,Y;if(A(!0),y&&_i&&Se){_t(!0);try{const ne=si(jn),fe=await oi(ne,"sendRoadReadyAlert")({carnivalId:a,carnivalName:Se.name,userName:(t==null?void 0:t.displayName)||((D=t==null?void 0:t.email)==null?void 0:D.split("@")[0])||"Squad Member"});((Y=fe.data)==null?void 0:Y.notified)>0&&(Ir({title:"Squad Notified!",body:`${fe.data.notified} squad member(s) alerted that you're Road Ready!`}),setTimeout(()=>Ir(null),5e3))}catch(ne){console.log("Error sending Road Ready alert:",ne)}finally{_t(!1)}}},ya=()=>{var Y;if(!z.trim()||!H)return;const D={id:Date.now().toString(),name:z.trim(),cost:parseFloat(H)};if(vt)oe("budget",[D],"add");else{const ne=((Y=i[a])==null?void 0:Y.budget)||[];oe("budget",[...ne,D])}K(""),T("")},_a=D=>{var Y;if(vt)oe("budget",{id:D},"remove");else{const ne=((Y=i[a])==null?void 0:Y.budget)||[];oe("budget",ne.filter(ie=>ie.id!==D))}},xi=()=>{var Y;if(!b.trim()||!P)return;const D={id:Date.now().toString(),title:b.trim(),datetime:P,note:F.trim()};if(vt)oe("schedule",[D],"add");else{const ne=((Y=i[a])==null?void 0:Y.schedule)||[];oe("schedule",[...ne,D])}C(""),O(""),M("")},cs=D=>{var Y;if(vt)oe("schedule",{id:D},"remove");else{const ne=((Y=i[a])==null?void 0:Y.schedule)||[];oe("schedule",ne.filter(ie=>ie.id!==D))}},wi=D=>{var fe;const Y=new Date;Y.setDate(Y.getDate()+1),Y.setHours(12,0,0,0);const ne=Y.toISOString().slice(0,16),ie={id:Date.now().toString(),title:D.title,datetime:ne,note:D.note||"Added from curated list"};if(vt)oe("schedule",[ie],"add");else{const Qe=((fe=i[a])==null?void 0:fe.schedule)||[];oe("schedule",[...Qe,ie])}},qn=()=>{var Y;if(!be.trim())return;const D={id:Date.now().toString(),item:be.trim(),checked:!1};if(vt)oe("packing",[D],"add");else{const ne=((Y=i[a])==null?void 0:Y.packing)||[];oe("packing",[...ne,D])}Re("")},$n=D=>{var ie;const Y=vt?(lt==null?void 0:lt.packing)||[]:((ie=i[a])==null?void 0:ie.packing)||[],ne=Y.find(fe=>fe.id===D);ne&&(vt?oe("packing",{id:D,checked:!ne.checked},"update"):oe("packing",Y.map(fe=>fe.id===D?{...fe,checked:!fe.checked}:fe)))},va=D=>{var Y;if(vt)oe("packing",{id:D},"remove");else{const ne=((Y=i[a])==null?void 0:Y.packing)||[];oe("packing",ne.filter(ie=>ie.id!==D))}},xa=()=>{var Y;if(!De.trim())return;const D={id:Date.now().toString(),name:De.trim()};if(vt)oe("squad",[D],"add");else{const ne=((Y=i[a])==null?void 0:Y.squad)||[];oe("squad",[...ne,D])}ut("")},go=D=>{var Y;if(vt)oe("squad",{id:D},"remove");else{const ne=((Y=i[a])==null?void 0:Y.squad)||[];oe("squad",ne.filter(ie=>ie.id!==D))}};B.useEffect(()=>{const D=a?i[a]:null;D!=null&&D.shareCode?ue(D.shareCode):ue("")},[a,i]);const ds=async()=>{var Y;const D=a?i[a]:null;if(!(D!=null&&D.sharedPlanId)||!t){xe([]);return}try{const ne=si(jn),fe=await oi(ne,"getSharedPlanData")({planId:D.sharedPlanId,uid:t.uid});(Y=fe.data)!=null&&Y.members&&xe(fe.data.members)}catch(ne){console.log("Could not fetch squad members:",ne.message),xe([])}};B.useEffect(()=>{a&&t&&ds()},[a,i,t]);const yo=async()=>{if(!de.trim()||de.length!==6){Ze("Please enter a valid 6-character code");return}Ue(!0),Ze("");try{const D=si(jn),ne=await oi(D,"joinSquadByCode")({shareCode:de.toUpperCase(),uid:t.uid,email:t.email});or(`Joined ${ne.data.carnivalName} squad!`),ve(""),ne.data.planId&&oe("sharedPlanId",ne.data.planId),setTimeout(()=>{ds()},500),setTimeout(()=>or(""),3e3)}catch(D){console.error("Error joining squad:",D),Ze(D.message||"Failed to join squad")}finally{Ue(!1)}},wa=()=>{X&&(navigator.clipboard.writeText(X),or("Code copied to clipboard!"),setTimeout(()=>or(""),2e3))},hs=()=>{oe("costume",{...G,total:parseFloat(G.total)||0,paid:parseFloat(G.paid)||0,updatedAt:Date.now()}),alert("Costume details saved!")},fs=()=>{if(!Se)return;const D=[];D.push(`CARNIVAL PLANNER: ${Se.name}`),D.push(`==========================================
`),D.push("-- SQUAD --"),(Se.squad||[]).forEach(Qe=>D.push(`- ${Qe.name}`)),D.push(`
`),D.push("-- COSTUME --"),Se.costume?(D.push(`Band: ${Se.costume.band}`),D.push(`Section: ${Se.costume.section}`),D.push(`Balance Due: $${((Se.costume.total||0)-(Se.costume.paid||0)).toFixed(2)}`)):D.push("No costume details."),D.push(`
`),D.push("-- SCHEDULE --"),(Se.schedule||[]).slice().sort((Qe,Ce)=>new Date(Qe.datetime)-new Date(Ce.datetime)).forEach(Qe=>D.push(`${new Date(Qe.datetime).toLocaleString()} | ${Qe.title}`));const ne=new Blob([D.join(`
`)],{type:"text/plain"}),ie=URL.createObjectURL(ne),fe=document.createElement("a");fe.href=ie,fe.download=`${Se.name.replace(/\s+/g,"_")}_Plan.txt`,fe.click()},ar=a?i[a]:null,Se=ar?{...ar,...vt&&lt?{budget:lt.budget||ar.budget||[],schedule:lt.schedule||ar.schedule||[],packing:lt.packing||ar.packing||[],costume:lt.costume||ar.costume,squad:lt.squad||ar.squad||[]}:{}}:null,Qr=((ps=Se==null?void 0:Se.budget)==null?void 0:ps.reduce((D,Y)=>D+(Y.cost||0),0))||0,lr=Se!=null&&Se.costume?Se.costume.total-Se.costume.paid:0,Yr=Se?Sb[a]||Sb.default:[];if(po){const D={onBack:()=>Sn(null),logo:Jd};switch(po){case"privacy":return u.jsx(_F,{...D});case"terms":return u.jsx(vF,{...D});case"cookies":return u.jsx(xF,{...D});case"refund":return u.jsx(wF,{...D});case"contact":return u.jsx(EF,{...D,user:t});default:Sn(null)}}if(w&&!t)return u.jsx(yF,{onGetStarted:()=>S(!1),logo:Jd,onLegalPage:Sn,onTryDemo:rs});if(t&&N&&Se){const D=(Se.schedule||[]).slice().sort((Y,ne)=>new Date(Y.datetime)-new Date(ne.datetime)).find(Y=>new Date(Y.datetime)>new Date);return u.jsxs("div",{className:"min-h-screen bg-gray-900 text-white p-6 flex flex-col",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8",children:[u.jsx("h1",{className:"text-2xl font-bold italic",children:"ROAD MODE"}),u.jsx("button",{onClick:()=>A(!1),className:"text-sm bg-gray-800 px-3 py-1 rounded",children:"Exit"})]}),u.jsxs("div",{className:"flex-1 flex flex-col gap-6",children:[u.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-blue-600 p-6 rounded-2xl shadow-lg",children:[u.jsx("h2",{className:"text-sm font-bold opacity-75 uppercase tracking-wider mb-1",children:"Up Next"}),D?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"text-3xl font-black mb-1",children:D.title}),u.jsx("div",{className:"text-xl opacity-90",children:new Date(D.datetime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),u.jsx("div",{className:"mt-2 text-sm bg-white/20 inline-block px-2 py-1 rounded",children:D.note||"No notes"})]}):u.jsx("div",{className:"text-xl italic opacity-75",children:"No more fetes scheduled! Sleep time?"})]}),u.jsxs("div",{className:"bg-gray-800 p-6 rounded-2xl border border-gray-700",children:[u.jsx("h2",{className:"text-sm font-bold opacity-75 uppercase tracking-wider mb-2",children:"Costume Pickup"}),Se.costume?u.jsxs("div",{children:[u.jsx("div",{className:"text-xl font-bold text-yellow-400",children:Se.costume.band}),u.jsxs("div",{className:"text-gray-400",children:["Section: ",Se.costume.section]}),lr>0&&u.jsxs("div",{className:"text-red-400 font-bold mt-1",children:["Balance Due: $",lr]})]}):u.jsx("div",{className:"text-gray-500 italic",children:"No costume details saved."})]})]})]})}return u.jsxs("div",{className:"min-h-screen flex flex-col bg-gray-50 dark:bg-gray-900 transition-colors duration-200",children:[Hr&&u.jsx("div",{className:"fixed top-4 right-4 z-50 animate-slideIn",children:u.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 text-white p-4 rounded-xl shadow-2xl max-w-sm",children:u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx("span",{className:"text-2xl",children:""}),u.jsxs("div",{children:[u.jsx("p",{className:"font-bold",children:Hr.title}),u.jsx("p",{className:"text-sm opacity-90",children:Hr.body})]}),u.jsx("button",{onClick:()=>Ir(null),className:"ml-2 text-white/70 hover:text-white",children:""})]})})}),u.jsx(bF,{}),u.jsxs("header",{className:"bg-white dark:bg-gray-800 shadow-sm py-4 px-4 flex justify-between items-center sticky top-0 z-20 transition-colors",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("img",{src:Jd,alt:"Logo",className:"w-8 h-8"}),u.jsx("h1",{className:"text-lg font-bold text-gray-800 dark:text-white hidden sm:block",children:"Carnival Planner"})]}),t&&u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("button",{onClick:mo,className:"p-2 rounded-full bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-yellow-300",children:U?"":""}),n&&u.jsx("button",{onClick:yi,className:"px-3 py-1 text-xs font-bold rounded-full bg-red-100 text-red-700 hover:bg-red-200 border border-red-200 transition-colors",children:"EXIT DEMO"}),Se&&u.jsx("button",{onClick:Cr,disabled:fo,className:"px-3 py-1 text-xs font-bold rounded-full transition bg-purple-100 text-purple-700 hover:bg-purple-200 dark:bg-purple-900 dark:text-purple-200 disabled:opacity-50",children:fo?"...":"GO ROAD READY"}),y?u.jsx("span",{className:"px-2 py-1 text-xs bg-yellow-100 text-yellow-800 rounded-full font-bold",children:"Premium"}):u.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500",children:"Free Plan"}),u.jsxs("div",{className:`flex items-center gap-1.5 px-2 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider ${Pt?"bg-green-100 text-green-700 dark:bg-green-900/40 dark:text-green-300":"bg-orange-100 text-orange-700 dark:bg-orange-900/40 dark:text-orange-300"}`,children:[u.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${Pt?"bg-green-500":"bg-orange-500 animate-pulse"}`}),Pt?"Online":"Offline Mode"]}),u.jsx("button",{onClick:ma,className:"text-sm font-medium text-gray-500 hover:text-red-500 dark:text-gray-400",children:"Sign Out"})]})]}),t&&u.jsx(PF,{user:t}),u.jsx("main",{className:"flex-1 p-4 max-w-4xl mx-auto w-full",children:t?u.jsxs("div",{children:[u.jsx("div",{className:"mb-8",children:u.jsx("div",{className:"flex gap-4 overflow-x-auto pb-4 snap-x",children:pa.map((D,Y)=>{const ne=a===D.id,ie=ls[Y%ls.length],Qe={"stkitts-sugar-mas":"Sugar Mas",stcroix:"St. Croix Carnival",trinidad:"Trinidad Carnival",dominica:"Mas Domnik",jamaica:"Jamaica Carnival",tampa:"Tampa Bay Carnival",stmaarten:"St. Maarten Carnival","cayman-batabano":"Cayman Carnival Batabano",stthomas:"St. Thomas Carnival",atlanta:"Atlanta Caribbean Carnival",guyana:"Guyana Independence",bahamas:"Bahamas Carnival",bermuda:"Bermuda Carnival",hollywood:"Hollywood Carnival",caymas:"Caymas Carnival",vincymas:"Vincy Mas",stlucia:"Saint Lucia Carnival",toronto:"Toronto Caribbean Carnival",barbados:"Crop Over",nevis:"Nevis Culturama",antigua:"Antigua Carnival",grenada:"Spice Mas","ny-labor-day":"New York Carnival",japan:"Japan Caribbean Carnival",miami:"Miami Carnival",tobago:"Tobago Carnival"}[D.id]||D.name,Ce=Am.find(Bt=>Bt.name.toLowerCase().includes(Qe.toLowerCase())||Qe.toLowerCase().includes(Bt.name.split("(")[0].trim().toLowerCase()));let $e=null;if(Ce){const Bt=new Date,ur=new Date(Bt.getFullYear(),Bt.getMonth(),Bt.getDate()),[cr,Pe,Pn]=Ce.date.split("-").map(Number),An=new Date(cr,Pe-1,Pn);An>=ur&&($e=Math.round((An-ur)/(1e3*60*60*24)))}return u.jsx("div",{onClick:()=>ga(D.id,`${D.name} - ${Ar[D.monthIndex]}`),className:`snap-center min-w-[200px] cursor-pointer rounded-2xl p-5 shadow-lg relative overflow-hidden transition-all duration-300 ${ne?"ring-4 ring-offset-2 ring-blue-400 scale-105":"hover:scale-105 opacity-90"} ${ie}`,children:u.jsxs("div",{className:"relative z-10 text-white",children:[u.jsx("h4",{className:"font-bold text-lg leading-tight mb-1",children:D.name}),u.jsx("p",{className:"text-xs font-medium uppercase tracking-wider opacity-90",children:Ar[D.monthIndex]}),Ce&&u.jsx("p",{className:"text-xs font-medium opacity-80 mt-1",children:new Date(Ce.date+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),$e!==null&&u.jsxs("div",{className:"mt-2 bg-white/20 backdrop-blur-sm rounded-lg px-2 py-1 inline-block",children:[u.jsx("span",{className:"text-lg font-black",children:$e}),u.jsx("span",{className:"text-xs ml-1 opacity-90",children:"days"})]})]})},D.id)})})}),Se?u.jsxs(u.Fragment,{children:[u.jsx(kb,{user:t,activeCarnivalId:a,carnivalData:Am,scrapedEvents:Sr,squadMembers:Te,budgetTotal:2e4,budgetSpent:Qr,isPremium:y,onAction:p}),u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-100 dark:border-gray-700 overflow-hidden transition-colors",children:[!y&&u.jsxs("div",{className:"bg-gradient-to-r from-yellow-400 via-orange-500 to-pink-500 p-4 flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("span",{className:"text-2xl",children:""}),u.jsxs("div",{children:[u.jsx("p",{className:"text-white font-bold text-sm",children:"Unlock Premium Features"}),u.jsx("p",{className:"text-white/80 text-xs",children:"Go ad-free and get a Premium badge!"})]})]}),u.jsx("button",{onClick:()=>p("Info"),className:"px-4 py-2 bg-white text-orange-600 font-bold text-sm rounded-full hover:bg-gray-100 transition",children:"Upgrade"})]}),!y&&u.jsx("div",{className:"border-b border-gray-100 dark:border-gray-700",children:u.jsx(eh,{placement:"banner",onUpgradeClick:()=>p("Info")})}),u.jsx("div",{className:"flex border-b border-gray-100 dark:border-gray-700 overflow-x-auto scrollbar-hide",children:["Budget","Costume","Schedule","Squad","Passport","Packing","Map","Media","Info"].filter(D=>y||!["Map","Media","Passport"].includes(D)).map(D=>u.jsxs("button",{onClick:()=>{console.log("Switching to tab:",D,"isPremium:",y),p(D)},className:`flex-shrink-0 px-3 sm:px-4 py-3 sm:py-4 text-xs sm:text-sm font-medium transition-colors relative whitespace-nowrap ${h===D?"text-blue-600 dark:text-blue-400 bg-blue-50/50 dark:bg-blue-900/20":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"}`,children:[D,["Map","Media","Passport"].includes(D)&&u.jsx("span",{className:"ml-1 text-xs text-yellow-500",children:""}),h===D&&u.jsx("div",{className:"absolute bottom-0 left-0 w-full h-0.5 bg-blue-600 dark:bg-blue-400"})]},D))}),vt&&u.jsxs("div",{className:"bg-gradient-to-r from-green-500 to-teal-500 px-4 py-2 flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"text-white text-lg",children:""}),u.jsxs("div",{children:[u.jsx("p",{className:"text-white font-medium text-sm",children:"Squad Mode Active"}),u.jsxs("p",{className:"text-white/80 text-xs",children:["Changes sync with ",Te.length," squad member(s)"]})]})]}),u.jsx("button",{onClick:yn,disabled:Kr,className:"px-3 py-1 bg-white/20 text-white text-xs font-medium rounded-full hover:bg-white/30 transition disabled:opacity-50",children:Kr?"Syncing...":"Refresh"})]}),u.jsxs("div",{className:"p-6",children:[h==="Budget"&&u.jsxs("div",{className:"animate-fadeIn",children:[u.jsxs("div",{className:"flex justify-between items-end mb-6",children:[u.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-white",children:"Budget"}),u.jsxs("div",{className:"text-right",children:[u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total Estimate"}),u.jsxs("p",{className:"text-2xl font-black text-green-600 dark:text-green-400",children:["$",Qr.toFixed(2)]})]})]}),u.jsx("div",{className:"space-y-3 mb-6",children:(Se.budget||[]).map(D=>{var Y;return u.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 dark:bg-gray-700 rounded-lg group hover:bg-gray-100 dark:hover:bg-gray-600",children:[u.jsxs("div",{children:[u.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-200",children:D.name}),D.addedBy&&vt&&u.jsxs("span",{className:"ml-2 text-xs text-gray-400 dark:text-gray-500",children:["by ",((Y=D.addedBy.email)==null?void 0:Y.split("@")[0])||"squad member"]})]}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsxs("span",{className:"font-bold text-gray-900 dark:text-white",children:["$",D.cost.toFixed(2)]}),u.jsx("button",{onClick:()=>_a(D.id),className:"text-gray-400 hover:text-red-500",children:""})]})]},D.id)})}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[u.jsxs("div",{className:"flex gap-2 flex-1",children:[u.jsx("input",{type:"text",placeholder:"Item",value:z,onChange:D=>K(D.target.value),className:"flex-[2] p-3 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm"}),u.jsx("input",{type:"number",placeholder:"0.00",value:H,onChange:D=>T(D.target.value),className:"flex-1 p-3 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm"})]}),u.jsx("button",{onClick:ya,className:"w-full sm:w-auto px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium",children:"Add"})]}),!y&&u.jsx("div",{className:"mt-6 pt-4 border-t border-gray-100 dark:border-gray-700",children:u.jsx(eh,{placement:"inline",onUpgradeClick:()=>p("Info")})})]}),h==="Costume"&&u.jsxs("div",{className:"animate-fadeIn",children:[u.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-white mb-4",children:"Mas Costume"}),u.jsxs("div",{className:"bg-pink-50 dark:bg-pink-900/20 p-6 rounded-xl border border-pink-100 dark:border-pink-900 mb-4",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-pink-800 dark:text-pink-300 uppercase mb-1",children:"Band Name"}),u.jsx("input",{type:"text",className:"w-full p-2 border border-pink-200 dark:border-pink-800 rounded dark:bg-gray-700 dark:text-white",value:G.band||((ms=Se.costume)==null?void 0:ms.band)||"",onChange:D=>se({...G,band:D.target.value}),placeholder:"e.g. Tribe, Bliss..."})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-pink-800 dark:text-pink-300 uppercase mb-1",children:"Section"}),u.jsx("input",{type:"text",className:"w-full p-2 border border-pink-200 dark:border-pink-800 rounded dark:bg-gray-700 dark:text-white",value:G.section||((Rr=Se.costume)==null?void 0:Rr.section)||"",onChange:D=>se({...G,section:D.target.value}),placeholder:"e.g. The Monarch"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-pink-800 dark:text-pink-300 uppercase mb-1",children:"Total Cost"}),u.jsx("input",{type:"number",className:"w-full p-2 border border-pink-200 dark:border-pink-800 rounded dark:bg-gray-700 dark:text-white",value:G.total||((je=Se.costume)==null?void 0:je.total)||"",onChange:D=>se({...G,total:D.target.value}),placeholder:"0.00"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-pink-800 dark:text-pink-300 uppercase mb-1",children:"Amount Paid"}),u.jsx("input",{type:"number",className:"w-full p-2 border border-pink-200 dark:border-pink-800 rounded dark:bg-gray-700 dark:text-white",value:G.paid||((Xe=Se.costume)==null?void 0:Xe.paid)||"",onChange:D=>se({...G,paid:D.target.value}),placeholder:"0.00"})]})]}),u.jsx("button",{onClick:hs,className:"mt-4 w-full py-2 bg-pink-600 text-white font-bold rounded hover:bg-pink-700",children:"Save Details"})]})]}),h==="Schedule"&&u.jsxs("div",{className:"animate-fadeIn",children:[u.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-white mb-4",children:"Itinerary"}),Yr.length>0&&u.jsxs("div",{className:"mb-6",children:[u.jsx("p",{className:"text-xs font-bold text-gray-400 uppercase mb-2",children:"Popular Events (Click to Add)"}),u.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:Yr.map((D,Y)=>u.jsxs("button",{onClick:()=>wi(D),className:"min-w-[140px] p-3 text-left rounded-lg border transition bg-blue-50 dark:bg-blue-900/30 border-blue-100 dark:border-blue-800 hover:bg-blue-100 dark:hover:bg-blue-800",children:[u.jsx("div",{className:"font-bold text-blue-900 dark:text-blue-300 text-sm",children:D.title}),u.jsx("div",{className:"text-xs text-blue-700 dark:text-blue-400 opacity-75 truncate",children:D.note})]},Y))})]}),y?u.jsxs("div",{className:"mb-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsxs("p",{className:"text-xs font-bold text-emerald-600 dark:text-emerald-400 uppercase flex items-center gap-1",children:[u.jsx("span",{className:"inline-block w-2 h-2 bg-emerald-500 rounded-full animate-pulse"}),"Live Events from Fete Sites"]}),Gr&&u.jsxs("span",{className:"text-xs text-gray-400",children:["Updated: ",new Date(Gr).toLocaleDateString()]})]}),os?u.jsxs("div",{className:"text-center py-4 text-gray-500 dark:text-gray-400",children:[u.jsx("div",{className:"animate-spin inline-block w-5 h-5 border-2 border-emerald-500 border-t-transparent rounded-full mb-2"}),u.jsx("p",{className:"text-sm",children:"Loading live events..."})]}):Sr.length>0?u.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:Sr.slice(0,10).map((D,Y)=>u.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gradient-to-r from-emerald-50 to-teal-50 dark:from-emerald-900/20 dark:to-teal-900/20 border border-emerald-200 dark:border-emerald-800 rounded-lg hover:shadow-md transition",children:[D.image&&u.jsx("img",{src:D.image,alt:"",className:"w-12 h-12 rounded object-cover flex-shrink-0"}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("h5",{className:"font-bold text-emerald-900 dark:text-emerald-300 text-sm truncate",children:D.title}),D.date&&u.jsxs("p",{className:"text-xs text-emerald-700 dark:text-emerald-400",children:[new Date(D.date+"T00:00:00").toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"}),D.time&&` at ${D.time}`]}),D.venue&&u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:D.venue}),u.jsxs("p",{className:"text-xs text-gray-400",children:["via ",D.source]})]}),u.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[D.url&&u.jsx("a",{href:D.url,target:"_blank",rel:"noopener noreferrer",className:"px-2 py-1 text-xs bg-emerald-600 text-white rounded hover:bg-emerald-700",children:"Tickets"}),u.jsx("button",{onClick:()=>wi({title:D.title,note:D.venue||`via ${D.source}`}),className:"px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700",children:"+ Add"})]})]},D.id||Y))}):u.jsxs("div",{className:"text-center py-4 bg-emerald-50 dark:bg-emerald-900/20 rounded-lg border border-emerald-200 dark:border-emerald-800",children:[u.jsx("p",{className:"text-sm text-emerald-700 dark:text-emerald-400",children:"No live events found for this carnival yet."}),u.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Events are updated daily from fetelist.com & frontlineticketing.com"})]})]}):u.jsx("div",{className:"mb-6 p-4 bg-gradient-to-r from-amber-50 to-orange-50 dark:from-amber-900/20 dark:to-orange-900/20 border border-amber-200 dark:border-amber-800 rounded-xl",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("span",{className:"text-2xl",children:""}),u.jsxs("div",{className:"flex-1",children:[u.jsx("p",{className:"font-bold text-amber-900 dark:text-amber-300",children:"Unlock Live Event Listings"}),u.jsx("p",{className:"text-xs text-amber-700 dark:text-amber-400",children:"Premium members get daily-updated fete listings from fetelist.com & frontlineticketing.com"})]}),u.jsx("button",{onClick:()=>p("Info"),className:"px-3 py-2 bg-gradient-to-r from-amber-500 to-orange-500 text-white text-sm font-bold rounded-lg hover:opacity-90 flex-shrink-0",children:"Upgrade"})]})}),u.jsx("div",{className:"space-y-4 mb-6",children:(Se.schedule||[]).map(D=>{var Y;return u.jsxs("div",{className:"flex gap-4 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg border-l-4 border-blue-400 relative group",children:[u.jsxs("div",{className:"text-center min-w-[60px]",children:[u.jsx("span",{className:"block text-xs font-bold text-gray-500 dark:text-gray-400 uppercase",children:new Date(D.datetime).toLocaleDateString(void 0,{month:"short"})}),u.jsx("span",{className:"block text-xl font-black text-gray-800 dark:text-white",children:new Date(D.datetime).getDate()}),u.jsx("span",{className:"block text-xs text-gray-500 dark:text-gray-400",children:new Date(D.datetime).toLocaleTimeString(void 0,{hour:"numeric",minute:"2-digit"})})]}),u.jsxs("div",{className:"flex-1",children:[u.jsx("h4",{className:"font-bold text-gray-800 dark:text-white",children:D.title}),D.note&&u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-1",children:D.note}),D.addedBy&&vt&&u.jsxs("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:["Added by ",((Y=D.addedBy.email)==null?void 0:Y.split("@")[0])||"squad member"]})]}),u.jsx("button",{onClick:()=>cs(D.id),className:"absolute top-2 right-2 text-gray-400 hover:text-red-500 opacity-0 group-hover:opacity-100",children:""})]},D.id)})}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 bg-gray-50 dark:bg-gray-700 p-4 rounded-xl",children:[u.jsx("input",{type:"text",placeholder:"Event Name",value:b,onChange:D=>C(D.target.value),className:"p-2 border rounded dark:bg-gray-800 dark:border-gray-600 dark:text-white"}),u.jsx("input",{type:"datetime-local",value:P,onChange:D=>O(D.target.value),className:"p-2 border rounded dark:bg-gray-800 dark:border-gray-600 dark:text-white"}),u.jsx("input",{type:"text",placeholder:"Notes",value:F,onChange:D=>M(D.target.value),className:"p-2 border rounded md:col-span-2 dark:bg-gray-800 dark:border-gray-600 dark:text-white"}),u.jsx("button",{onClick:xi,className:"md:col-span-2 py-2 bg-blue-600 text-white rounded font-medium hover:bg-blue-700",children:"Add Event"})]})]}),h==="Squad"&&u.jsxs("div",{className:"animate-fadeIn",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-white",children:"Your Squad"}),u.jsxs("span",{className:"text-sm bg-purple-100 text-purple-800 px-2 py-1 rounded-full",children:[((Xr=Se.squad)==null?void 0:Xr.length)||0," members"]})]}),u.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 border border-purple-200 dark:border-purple-800 rounded-xl p-4 mb-4",children:[u.jsxs("h4",{className:"font-bold text-purple-800 dark:text-purple-300 mb-3 flex items-center gap-2",children:[u.jsx("span",{children:""})," Squad Sharing"]}),yt&&u.jsx("div",{className:"mb-3 p-2 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 rounded text-sm",children:yt}),mn&&u.jsx("div",{className:"mb-3 p-2 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 rounded text-sm",children:mn}),u.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-3",children:[u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Share your carnival plan with friends:"}),X?u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"text-2xl font-mono font-bold text-purple-600 dark:text-purple-400 tracking-wider",children:X}),u.jsx("button",{onClick:wa,className:"text-sm bg-purple-100 dark:bg-purple-900/50 text-purple-700 dark:text-purple-300 px-3 py-1 rounded hover:bg-purple-200",children:"Copy"})]}):u.jsx("button",{onClick:is,disabled:Jt,className:"w-full py-2 bg-purple-600 text-white rounded font-medium hover:bg-purple-700 disabled:opacity-50",children:Jt?"Creating...":"Start a Squad"})]}),u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-3",children:[u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Join a friend's squad:"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("input",{type:"text",placeholder:"Enter 6-digit code",value:de,onChange:D=>ve(D.target.value.toUpperCase().slice(0,6)),className:"flex-1 p-2 border rounded font-mono text-center tracking-wider uppercase dark:bg-gray-700 dark:border-gray-600 dark:text-white",maxLength:6}),u.jsx("button",{onClick:da,disabled:it||de.length!==6,className:"bg-pink-600 text-white px-4 rounded hover:bg-pink-700 disabled:opacity-50",children:it?"...":"Join"})]})]})]}),ge&&u.jsx("div",{className:"mt-4 text-center",children:u.jsx("button",{onClick:ss,className:"text-sm text-red-500 hover:text-red-700 underline",children:"Leave Squad"})})]}),y&&u.jsx("div",{className:"mt-4 pt-4 border-t border-purple-200 dark:border-purple-700",children:u.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[u.jsx("input",{type:"checkbox",checked:_i,onChange:D=>ho(D.target.checked),className:"w-5 h-5 text-purple-600 rounded"}),u.jsxs("div",{children:[u.jsx("span",{className:"font-medium text-purple-800 dark:text-purple-300",children:"Notify squad when I go Road Ready"}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Send push notification to squad members"})]}),u.jsx("span",{className:"ml-auto text-xs bg-yellow-100 text-yellow-800 px-2 py-0.5 rounded-full",children:"Premium"})]})}),Te.length>0&&u.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-green-200 dark:border-green-800 rounded-xl p-4 mb-4",children:[u.jsx("div",{className:"flex items-center justify-between mb-3",children:u.jsxs("h4",{className:"font-medium text-green-700 dark:text-green-400 flex items-center gap-2",children:[u.jsx("span",{children:""})," Connected Squad Members"]})}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-3",children:'These users joined using your share code and can see this carnival plan. Click "Refresh" to check for new members.'}),u.jsx("div",{className:"flex flex-wrap gap-2",children:Te.map((D,Y)=>{var ne;return u.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 rounded-full border ${D.role==="owner"?"bg-yellow-50 dark:bg-yellow-900/30 border-yellow-200 dark:border-yellow-800":"bg-green-50 dark:bg-green-900/30 border-green-200 dark:border-green-800"}`,children:[u.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-white text-sm font-bold",children:(D.email||D.uid||"?").charAt(0).toUpperCase()}),u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:`font-medium text-sm ${D.role==="owner"?"text-yellow-800 dark:text-yellow-300":"text-green-800 dark:text-green-300"}`,children:D.email||`User ${(ne=D.uid)==null?void 0:ne.slice(0,6)}...`}),u.jsx("span",{className:`text-xs ${D.role==="owner"?"text-yellow-600 dark:text-yellow-400":"text-green-600 dark:text-green-400"}`,children:D.role==="owner"?" Owner":" Member"})]})]},D.uid||Y)})})]}),u.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl p-4 mb-4",children:[u.jsx("h4",{className:"font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Quick Add (Offline List)"}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-4",children:[u.jsx("input",{type:"text",placeholder:"Add friend's name",value:De,onChange:D=>ut(D.target.value),className:"flex-1 p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm"}),u.jsx("button",{onClick:xa,className:"w-full sm:w-auto bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700 font-medium",children:"Add"})]}),u.jsxs("div",{className:"flex flex-wrap gap-2",children:[(Se.squad||[]).map(D=>u.jsxs("div",{className:"flex items-center gap-2 bg-purple-50 dark:bg-purple-900/30 px-3 py-1 rounded-full border border-purple-100 dark:border-purple-800",children:[u.jsx("span",{className:"text-purple-900 dark:text-purple-200 font-medium",children:D.name}),u.jsx("button",{onClick:()=>go(D.id),className:"text-purple-400 hover:text-red-500 text-xs font-bold",children:""})]},D.id)),(Se.squad||[]).length===0&&u.jsx("p",{className:"text-gray-400 italic text-sm",children:"No squad members added yet. Riding solo?"})]})]}),u.jsx("div",{className:"mt-8 mb-8",children:u.jsx(lF,{squadId:ge==null?void 0:ge.id,user:t,isDemoMode:n})}),!y&&u.jsx("div",{className:"mt-4",children:u.jsx(eh,{placement:"inline",onUpgradeClick:()=>p("Info")})})]}),h==="Packing"&&u.jsxs("div",{className:"animate-fadeIn",children:[u.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-white mb-4",children:"Packing List"}),u.jsx("div",{className:"space-y-2 mb-6",children:(Se.packing||[]).map(D=>u.jsxs("div",{className:"flex items-center justify-between p-3 bg-white dark:bg-gray-700 border border-gray-100 dark:border-gray-600 shadow-sm rounded-lg",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("input",{type:"checkbox",checked:D.checked,onChange:()=>$n(D.id),className:"w-5 h-5 text-blue-600 rounded"}),u.jsx("span",{className:`text-gray-700 dark:text-gray-200 ${D.checked?"line-through opacity-50":""}`,children:D.item})]}),u.jsx("button",{onClick:()=>va(D.id),className:"text-gray-400 hover:text-red-500",children:""})]},D.id))}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[u.jsx("input",{type:"text",placeholder:"Item",value:be,onChange:D=>Re(D.target.value),className:"flex-1 p-3 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm"}),u.jsx("button",{onClick:qn,className:"w-full sm:w-auto px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium",children:"Add"})]}),!y&&u.jsx("div",{className:"mt-6 pt-4 border-t border-gray-100 dark:border-gray-700",children:u.jsx(eh,{placement:"inline",onUpgradeClick:()=>p("Info")})})]}),h==="Map"&&y&&u.jsx("div",{className:"animate-fadeIn",children:u.jsx(iF,{locations:Se.mapLocations||[],scrapedEvents:Sr,onLocationsChange:D=>oe("mapLocations",D),carnivalName:Se.name,carnivalId:a})}),h==="Passport"&&y&&u.jsx("div",{className:"animate-fadeIn",children:u.jsx(kF,{user:t,activeCarnivalId:a})}),h==="Media"&&y&&u.jsx("div",{className:"animate-fadeIn",children:u.jsx(uF,{files:Se.mediaFiles||[],onFilesChange:D=>oe("mediaFiles",D),carnivalName:Se.name,carnivalId:a,userId:t.uid})}),h==="Info"&&u.jsxs("div",{className:"animate-fadeIn text-center",children:[u.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-gray-800 text-white rounded-2xl p-8 mb-6 shadow-xl",children:[u.jsx("img",{src:Jd,alt:"Logo",className:"w-20 h-20 mx-auto mb-4"}),u.jsx("h2",{className:"text-2xl font-bold mb-2",children:y?"Premium Supporter":"Support the App"}),u.jsx("p",{className:"text-gray-400 mb-6",children:y?"Thank you for supporting Carnival Planner!":"All features are free! Premium removes ads and shows your support."}),u.jsxs("button",{onClick:fs,className:"flex items-center justify-center gap-2 mx-auto px-6 py-3 rounded-full font-bold transition-colors bg-white text-gray-900 hover:bg-gray-100",children:[u.jsx("span",{children:""})," Export Itinerary"]})]}),!y&&u.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/10 border border-yellow-200 dark:border-yellow-800 rounded-xl p-6",children:[u.jsx("h3",{className:"font-bold text-yellow-800 dark:text-yellow-400 mb-2",children:"Become a Premium Supporter"}),u.jsx("p",{className:"text-yellow-700 dark:text-yellow-500 text-sm mb-4",children:"Get an ad-free experience and a Premium badge to show your support!"}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[u.jsx("button",{onClick:()=>vi("monthly"),disabled:k,className:"px-4 py-2 bg-blue-600 text-white font-bold rounded shadow hover:bg-blue-700 disabled:opacity-50",children:k?"Loading...":"Monthly - $4.99"}),u.jsx("button",{onClick:()=>vi("yearly"),disabled:k,className:"px-4 py-2 bg-yellow-400 text-yellow-900 font-bold rounded shadow hover:bg-yellow-500 disabled:opacity-50",children:k?"Loading...":"Yearly - $39.99"})]})]}),u.jsx("div",{className:"mt-6",children:u.jsx(IF,{user:t})}),(t==null?void 0:t.email)==="djkrss1@gmail.com"&&u.jsxs("div",{className:"mt-6 text-left space-y-8",children:[u.jsx(fF,{}),u.jsx(TF,{}),u.jsx(gF,{})]})]})]})]})]}):u.jsx(kb,{user:t,activeCarnivalId:null,carnivalData:Am,scrapedEvents:Sr,squadMembers:[],budgetTotal:0,budgetSpent:0,isPremium:y,onAction:p})]}):u.jsx("div",{className:"flex flex-col items-center justify-center min-h-[60vh] text-center px-4",children:ha?u.jsx(SF,{onBack:()=>kr(!1),onSuccess:()=>kr(!1)}):u.jsxs(u.Fragment,{children:[u.jsx("h2",{className:"text-3xl font-bold mb-6 text-gray-800 dark:text-white",children:"Welcome Back"}),u.jsxs("div",{className:"space-y-3 w-full max-w-sm",children:[u.jsxs("button",{onClick:Nr,className:"w-full flex items-center justify-center px-6 py-3 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-lg shadow-sm hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-800 dark:text-white transition-colors",children:[u.jsx("img",{src:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg",className:"w-5 h-5 mr-3",alt:"G"}),"Continue with Google"]}),u.jsxs("div",{className:"flex items-center gap-3 text-gray-400 dark:text-gray-500",children:[u.jsx("div",{className:"flex-1 h-px bg-gray-300 dark:bg-gray-600"}),u.jsx("span",{className:"text-sm",children:"or"}),u.jsx("div",{className:"flex-1 h-px bg-gray-300 dark:bg-gray-600"})]}),u.jsx("button",{onClick:()=>kr(!0),className:"w-full flex items-center justify-center px-6 py-3 bg-gradient-to-r from-pink-500 to-orange-500 rounded-lg shadow-sm hover:opacity-90 text-white font-semibold transition-opacity",children:"Continue with Email"})]}),u.jsx("button",{onClick:()=>S(!0),className:"mt-6 text-sm text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300",children:"Back to home"})]})})}),u.jsx("footer",{className:"bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 py-6 px-4 mt-auto",children:u.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[u.jsxs("div",{className:"flex flex-wrap justify-center gap-3 text-sm text-gray-500 dark:text-gray-400",children:[u.jsx("button",{onClick:()=>Sn("privacy"),className:"hover:text-gray-900 dark:hover:text-white transition-colors",children:"Privacy"}),u.jsx("span",{children:"|"}),u.jsx("button",{onClick:()=>Sn("terms"),className:"hover:text-gray-900 dark:hover:text-white transition-colors",children:"Terms"}),u.jsx("span",{children:"|"}),u.jsx("button",{onClick:()=>Sn("cookies"),className:"hover:text-gray-900 dark:hover:text-white transition-colors",children:"Cookies"}),u.jsx("span",{children:"|"}),u.jsx("button",{onClick:()=>Sn("refund"),className:"hover:text-gray-900 dark:hover:text-white transition-colors",children:"Refunds"}),u.jsx("span",{children:"|"}),u.jsx("button",{onClick:()=>Sn("contact"),className:"hover:text-gray-900 dark:hover:text-white transition-colors",children:"Contact"})]}),u.jsxs("p",{className:"text-gray-400 dark:text-gray-500 text-xs mt-3",children:[" ",new Date().getFullYear()," Carnival Planner"]})]})}),t&&u.jsx(hF,{activeCarnivalId:a,isPremium:y})]})}Nm.createRoot(document.getElementById("root")).render(u.jsx(Nh.StrictMode,{children:u.jsx(LF,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(t=>{console.log("SW registered:",t.scope)}).catch(t=>{console.log("SW registration failed:",t)})});
