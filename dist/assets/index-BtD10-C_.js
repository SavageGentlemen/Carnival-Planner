(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var t1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ob(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ab={exports:{}},Tf={},lb={exports:{}},Ue={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fc=Symbol.for("react.element"),n1=Symbol.for("react.portal"),r1=Symbol.for("react.fragment"),i1=Symbol.for("react.strict_mode"),s1=Symbol.for("react.profiler"),o1=Symbol.for("react.provider"),a1=Symbol.for("react.context"),l1=Symbol.for("react.forward_ref"),u1=Symbol.for("react.suspense"),c1=Symbol.for("react.memo"),h1=Symbol.for("react.lazy"),$v=Symbol.iterator;function d1(t){return t===null||typeof t!="object"?null:(t=$v&&t[$v]||t["@@iterator"],typeof t=="function"?t:null)}var ub={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},cb=Object.assign,hb={};function Ll(t,e,n){this.props=t,this.context=e,this.refs=hb,this.updater=n||ub}Ll.prototype.isReactComponent={};Ll.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ll.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function db(){}db.prototype=Ll.prototype;function Yg(t,e,n){this.props=t,this.context=e,this.refs=hb,this.updater=n||ub}var Jg=Yg.prototype=new db;Jg.constructor=Yg;cb(Jg,Ll.prototype);Jg.isPureReactComponent=!0;var Hv=Array.isArray,fb=Object.prototype.hasOwnProperty,Xg={current:null},pb={key:!0,ref:!0,__self:!0,__source:!0};function mb(t,e,n){var r,i={},o=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(o=""+e.key),e)fb.call(e,r)&&!pb.hasOwnProperty(r)&&(i[r]=e[r]);var u=arguments.length-2;if(u===1)i.children=n;else if(1<u){for(var d=Array(u),p=0;p<u;p++)d[p]=arguments[p+2];i.children=d}if(t&&t.defaultProps)for(r in u=t.defaultProps,u)i[r]===void 0&&(i[r]=u[r]);return{$$typeof:Fc,type:t,key:o,ref:a,props:i,_owner:Xg.current}}function f1(t,e){return{$$typeof:Fc,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function e_(t){return typeof t=="object"&&t!==null&&t.$$typeof===Fc}function p1(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Wv=/\/+/g;function Sp(t,e){return typeof t=="object"&&t!==null&&t.key!=null?p1(""+t.key):e.toString(36)}function Xh(t,e,n,r,i){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(o){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Fc:case n1:a=!0}}if(a)return a=t,i=i(a),t=r===""?"."+Sp(a,0):r,Hv(i)?(n="",t!=null&&(n=t.replace(Wv,"$&/")+"/"),Xh(i,e,n,"",function(p){return p})):i!=null&&(e_(i)&&(i=f1(i,n+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(Wv,"$&/")+"/")+t)),e.push(i)),1;if(a=0,r=r===""?".":r+":",Hv(t))for(var u=0;u<t.length;u++){o=t[u];var d=r+Sp(o,u);a+=Xh(o,e,n,d,i)}else if(d=d1(t),typeof d=="function")for(t=d.call(t),u=0;!(o=t.next()).done;)o=o.value,d=r+Sp(o,u++),a+=Xh(o,e,n,d,i);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Th(t,e,n){if(t==null)return t;var r=[],i=0;return Xh(t,r,"","",function(o){return e.call(n,o,i++)}),r}function m1(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Sn={current:null},ed={transition:null},g1={ReactCurrentDispatcher:Sn,ReactCurrentBatchConfig:ed,ReactCurrentOwner:Xg};function gb(){throw Error("act(...) is not supported in production builds of React.")}Ue.Children={map:Th,forEach:function(t,e,n){Th(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Th(t,function(){e++}),e},toArray:function(t){return Th(t,function(e){return e})||[]},only:function(t){if(!e_(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ue.Component=Ll;Ue.Fragment=r1;Ue.Profiler=s1;Ue.PureComponent=Yg;Ue.StrictMode=i1;Ue.Suspense=u1;Ue.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=g1;Ue.act=gb;Ue.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=cb({},t.props),i=t.key,o=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,a=Xg.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(d in e)fb.call(e,d)&&!pb.hasOwnProperty(d)&&(r[d]=e[d]===void 0&&u!==void 0?u[d]:e[d])}var d=arguments.length-2;if(d===1)r.children=n;else if(1<d){u=Array(d);for(var p=0;p<d;p++)u[p]=arguments[p+2];r.children=u}return{$$typeof:Fc,type:t.type,key:i,ref:o,props:r,_owner:a}};Ue.createContext=function(t){return t={$$typeof:a1,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:o1,_context:t},t.Consumer=t};Ue.createElement=mb;Ue.createFactory=function(t){var e=mb.bind(null,t);return e.type=t,e};Ue.createRef=function(){return{current:null}};Ue.forwardRef=function(t){return{$$typeof:l1,render:t}};Ue.isValidElement=e_;Ue.lazy=function(t){return{$$typeof:h1,_payload:{_status:-1,_result:t},_init:m1}};Ue.memo=function(t,e){return{$$typeof:c1,type:t,compare:e===void 0?null:e}};Ue.startTransition=function(t){var e=ed.transition;ed.transition={};try{t()}finally{ed.transition=e}};Ue.unstable_act=gb;Ue.useCallback=function(t,e){return Sn.current.useCallback(t,e)};Ue.useContext=function(t){return Sn.current.useContext(t)};Ue.useDebugValue=function(){};Ue.useDeferredValue=function(t){return Sn.current.useDeferredValue(t)};Ue.useEffect=function(t,e){return Sn.current.useEffect(t,e)};Ue.useId=function(){return Sn.current.useId()};Ue.useImperativeHandle=function(t,e,n){return Sn.current.useImperativeHandle(t,e,n)};Ue.useInsertionEffect=function(t,e){return Sn.current.useInsertionEffect(t,e)};Ue.useLayoutEffect=function(t,e){return Sn.current.useLayoutEffect(t,e)};Ue.useMemo=function(t,e){return Sn.current.useMemo(t,e)};Ue.useReducer=function(t,e,n){return Sn.current.useReducer(t,e,n)};Ue.useRef=function(t){return Sn.current.useRef(t)};Ue.useState=function(t){return Sn.current.useState(t)};Ue.useSyncExternalStore=function(t,e,n){return Sn.current.useSyncExternalStore(t,e,n)};Ue.useTransition=function(){return Sn.current.useTransition()};Ue.version="18.3.1";lb.exports=Ue;var W=lb.exports;const kd=ob(W);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _1=W,y1=Symbol.for("react.element"),v1=Symbol.for("react.fragment"),w1=Object.prototype.hasOwnProperty,x1=_1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,b1={key:!0,ref:!0,__self:!0,__source:!0};function _b(t,e,n){var r,i={},o=null,a=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)w1.call(e,r)&&!b1.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:y1,type:t,key:o,ref:a,props:i,_owner:x1.current}}Tf.Fragment=v1;Tf.jsx=_b;Tf.jsxs=_b;ab.exports=Tf;var h=ab.exports,wm={},yb={exports:{}},nr={},vb={exports:{}},wb={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(K,ie){var J=K.length;K.push(ie);e:for(;0<J;){var ae=J-1>>>1,ce=K[ae];if(0<i(ce,ie))K[ae]=ie,K[J]=ce,J=ae;else break e}}function n(K){return K.length===0?null:K[0]}function r(K){if(K.length===0)return null;var ie=K[0],J=K.pop();if(J!==ie){K[0]=J;e:for(var ae=0,ce=K.length,_e=ce>>>1;ae<_e;){var ke=2*(ae+1)-1,Se=K[ke],me=ke+1,at=K[me];if(0>i(Se,J))me<ce&&0>i(at,Se)?(K[ae]=at,K[me]=J,ae=me):(K[ae]=Se,K[ke]=J,ae=ke);else if(me<ce&&0>i(at,J))K[ae]=at,K[me]=J,ae=me;else break e}}return ie}function i(K,ie){var J=K.sortIndex-ie.sortIndex;return J!==0?J:K.id-ie.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,u=a.now();t.unstable_now=function(){return a.now()-u}}var d=[],p=[],_=1,w=null,x=3,k=!1,P=!1,j=!1,B=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(K){for(var ie=n(p);ie!==null;){if(ie.callback===null)r(p);else if(ie.startTime<=K)r(p),ie.sortIndex=ie.expirationTime,e(d,ie);else break;ie=n(p)}}function z(K){if(j=!1,N(K),!P)if(n(d)!==null)P=!0,Pe(G);else{var ie=n(p);ie!==null&&tt(z,ie.startTime-K)}}function G(K,ie){P=!1,j&&(j=!1,R(T),T=-1),k=!0;var J=x;try{for(N(ie),w=n(d);w!==null&&(!(w.expirationTime>ie)||K&&!M());){var ae=w.callback;if(typeof ae=="function"){w.callback=null,x=w.priorityLevel;var ce=ae(w.expirationTime<=ie);ie=t.unstable_now(),typeof ce=="function"?w.callback=ce:w===n(d)&&r(d),N(ie)}else r(d);w=n(d)}if(w!==null)var _e=!0;else{var ke=n(p);ke!==null&&tt(z,ke.startTime-ie),_e=!1}return _e}finally{w=null,x=J,k=!1}}var F=!1,I=null,T=-1,C=5,A=-1;function M(){return!(t.unstable_now()-A<C)}function U(){if(I!==null){var K=t.unstable_now();A=K;var ie=!0;try{ie=I(!0,K)}finally{ie?D():(F=!1,I=null)}}else F=!1}var D;if(typeof S=="function")D=function(){S(U)};else if(typeof MessageChannel<"u"){var we=new MessageChannel,De=we.port2;we.port1.onmessage=U,D=function(){De.postMessage(null)}}else D=function(){B(U,0)};function Pe(K){I=K,F||(F=!0,D())}function tt(K,ie){T=B(function(){K(t.unstable_now())},ie)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(K){K.callback=null},t.unstable_continueExecution=function(){P||k||(P=!0,Pe(G))},t.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<K?Math.floor(1e3/K):5},t.unstable_getCurrentPriorityLevel=function(){return x},t.unstable_getFirstCallbackNode=function(){return n(d)},t.unstable_next=function(K){switch(x){case 1:case 2:case 3:var ie=3;break;default:ie=x}var J=x;x=ie;try{return K()}finally{x=J}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(K,ie){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var J=x;x=K;try{return ie()}finally{x=J}},t.unstable_scheduleCallback=function(K,ie,J){var ae=t.unstable_now();switch(typeof J=="object"&&J!==null?(J=J.delay,J=typeof J=="number"&&0<J?ae+J:ae):J=ae,K){case 1:var ce=-1;break;case 2:ce=250;break;case 5:ce=1073741823;break;case 4:ce=1e4;break;default:ce=5e3}return ce=J+ce,K={id:_++,callback:ie,priorityLevel:K,startTime:J,expirationTime:ce,sortIndex:-1},J>ae?(K.sortIndex=J,e(p,K),n(d)===null&&K===n(p)&&(j?(R(T),T=-1):j=!0,tt(z,J-ae))):(K.sortIndex=ce,e(d,K),P||k||(P=!0,Pe(G))),K},t.unstable_shouldYield=M,t.unstable_wrapCallback=function(K){var ie=x;return function(){var J=x;x=ie;try{return K.apply(this,arguments)}finally{x=J}}}})(wb);vb.exports=wb;var T1=vb.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var E1=W,Xn=T1;function ne(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var xb=new Set,Xu={};function sa(t,e){pl(t,e),pl(t+"Capture",e)}function pl(t,e){for(Xu[t]=e,t=0;t<e.length;t++)xb.add(e[t])}var Fi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),xm=Object.prototype.hasOwnProperty,I1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Gv={},Kv={};function k1(t){return xm.call(Kv,t)?!0:xm.call(Gv,t)?!1:I1.test(t)?Kv[t]=!0:(Gv[t]=!0,!1)}function S1(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function P1(t,e,n,r){if(e===null||typeof e>"u"||S1(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Pn(t,e,n,r,i,o,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=a}var sn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){sn[t]=new Pn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];sn[e]=new Pn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){sn[t]=new Pn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){sn[t]=new Pn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){sn[t]=new Pn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){sn[t]=new Pn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){sn[t]=new Pn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){sn[t]=new Pn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){sn[t]=new Pn(t,5,!1,t.toLowerCase(),null,!1,!1)});var t_=/[\-:]([a-z])/g;function n_(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(t_,n_);sn[e]=new Pn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(t_,n_);sn[e]=new Pn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(t_,n_);sn[e]=new Pn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){sn[t]=new Pn(t,1,!1,t.toLowerCase(),null,!1,!1)});sn.xlinkHref=new Pn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){sn[t]=new Pn(t,1,!1,t.toLowerCase(),null,!0,!0)});function r_(t,e,n,r){var i=sn.hasOwnProperty(e)?sn[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(P1(e,n,i,r)&&(n=null),r||i===null?k1(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Gi=E1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Eh=Symbol.for("react.element"),$a=Symbol.for("react.portal"),Ha=Symbol.for("react.fragment"),i_=Symbol.for("react.strict_mode"),bm=Symbol.for("react.profiler"),bb=Symbol.for("react.provider"),Tb=Symbol.for("react.context"),s_=Symbol.for("react.forward_ref"),Tm=Symbol.for("react.suspense"),Em=Symbol.for("react.suspense_list"),o_=Symbol.for("react.memo"),Ts=Symbol.for("react.lazy"),Eb=Symbol.for("react.offscreen"),Zv=Symbol.iterator;function uu(t){return t===null||typeof t!="object"?null:(t=Zv&&t[Zv]||t["@@iterator"],typeof t=="function"?t:null)}var kt=Object.assign,Pp;function Iu(t){if(Pp===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Pp=e&&e[1]||""}return`
`+Pp+t}var Ap=!1;function Cp(t,e){if(!t||Ap)return"";Ap=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(p){var r=p}Reflect.construct(t,[],e)}else{try{e.call()}catch(p){r=p}t.call(e.prototype)}else{try{throw Error()}catch(p){r=p}t()}}catch(p){if(p&&r&&typeof p.stack=="string"){for(var i=p.stack.split(`
`),o=r.stack.split(`
`),a=i.length-1,u=o.length-1;1<=a&&0<=u&&i[a]!==o[u];)u--;for(;1<=a&&0<=u;a--,u--)if(i[a]!==o[u]){if(a!==1||u!==1)do if(a--,u--,0>u||i[a]!==o[u]){var d=`
`+i[a].replace(" at new "," at ");return t.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",t.displayName)),d}while(1<=a&&0<=u);break}}}finally{Ap=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Iu(t):""}function A1(t){switch(t.tag){case 5:return Iu(t.type);case 16:return Iu("Lazy");case 13:return Iu("Suspense");case 19:return Iu("SuspenseList");case 0:case 2:case 15:return t=Cp(t.type,!1),t;case 11:return t=Cp(t.type.render,!1),t;case 1:return t=Cp(t.type,!0),t;default:return""}}function Im(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ha:return"Fragment";case $a:return"Portal";case bm:return"Profiler";case i_:return"StrictMode";case Tm:return"Suspense";case Em:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Tb:return(t.displayName||"Context")+".Consumer";case bb:return(t._context.displayName||"Context")+".Provider";case s_:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case o_:return e=t.displayName||null,e!==null?e:Im(t.type)||"Memo";case Ts:e=t._payload,t=t._init;try{return Im(t(e))}catch{}}return null}function C1(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Im(e);case 8:return e===i_?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Zs(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Ib(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function N1(t){var e=Ib(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){r=""+a,o.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ih(t){t._valueTracker||(t._valueTracker=N1(t))}function kb(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Ib(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Sd(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function km(t,e){var n=e.checked;return kt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Qv(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Zs(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Sb(t,e){e=e.checked,e!=null&&r_(t,"checked",e,!1)}function Sm(t,e){Sb(t,e);var n=Zs(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Pm(t,e.type,n):e.hasOwnProperty("defaultValue")&&Pm(t,e.type,Zs(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Yv(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Pm(t,e,n){(e!=="number"||Sd(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ku=Array.isArray;function rl(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Zs(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Am(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ne(91));return kt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Jv(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ne(92));if(ku(n)){if(1<n.length)throw Error(ne(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Zs(n)}}function Pb(t,e){var n=Zs(e.value),r=Zs(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Xv(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Ab(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Cm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Ab(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var kh,Cb=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(kh=kh||document.createElement("div"),kh.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=kh.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ec(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Mu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},R1=["Webkit","ms","Moz","O"];Object.keys(Mu).forEach(function(t){R1.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Mu[e]=Mu[t]})});function Nb(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Mu.hasOwnProperty(t)&&Mu[t]?(""+e).trim():e+"px"}function Rb(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=Nb(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var L1=kt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Nm(t,e){if(e){if(L1[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ne(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ne(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ne(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ne(62))}}function Rm(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Lm=null;function a_(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Dm=null,il=null,sl=null;function e0(t){if(t=zc(t)){if(typeof Dm!="function")throw Error(ne(280));var e=t.stateNode;e&&(e=Pf(e),Dm(t.stateNode,t.type,e))}}function Lb(t){il?sl?sl.push(t):sl=[t]:il=t}function Db(){if(il){var t=il,e=sl;if(sl=il=null,e0(t),e)for(t=0;t<e.length;t++)e0(e[t])}}function jb(t,e){return t(e)}function Mb(){}var Np=!1;function Ob(t,e,n){if(Np)return t(e,n);Np=!0;try{return jb(t,e,n)}finally{Np=!1,(il!==null||sl!==null)&&(Mb(),Db())}}function tc(t,e){var n=t.stateNode;if(n===null)return null;var r=Pf(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ne(231,e,typeof n));return n}var jm=!1;if(Fi)try{var cu={};Object.defineProperty(cu,"passive",{get:function(){jm=!0}}),window.addEventListener("test",cu,cu),window.removeEventListener("test",cu,cu)}catch{jm=!1}function D1(t,e,n,r,i,o,a,u,d){var p=Array.prototype.slice.call(arguments,3);try{e.apply(n,p)}catch(_){this.onError(_)}}var Ou=!1,Pd=null,Ad=!1,Mm=null,j1={onError:function(t){Ou=!0,Pd=t}};function M1(t,e,n,r,i,o,a,u,d){Ou=!1,Pd=null,D1.apply(j1,arguments)}function O1(t,e,n,r,i,o,a,u,d){if(M1.apply(this,arguments),Ou){if(Ou){var p=Pd;Ou=!1,Pd=null}else throw Error(ne(198));Ad||(Ad=!0,Mm=p)}}function oa(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Vb(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function t0(t){if(oa(t)!==t)throw Error(ne(188))}function V1(t){var e=t.alternate;if(!e){if(e=oa(t),e===null)throw Error(ne(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return t0(i),t;if(o===r)return t0(i),e;o=o.sibling}throw Error(ne(188))}if(n.return!==r.return)n=i,r=o;else{for(var a=!1,u=i.child;u;){if(u===n){a=!0,n=i,r=o;break}if(u===r){a=!0,r=i,n=o;break}u=u.sibling}if(!a){for(u=o.child;u;){if(u===n){a=!0,n=o,r=i;break}if(u===r){a=!0,r=o,n=i;break}u=u.sibling}if(!a)throw Error(ne(189))}}if(n.alternate!==r)throw Error(ne(190))}if(n.tag!==3)throw Error(ne(188));return n.stateNode.current===n?t:e}function Fb(t){return t=V1(t),t!==null?Ub(t):null}function Ub(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Ub(t);if(e!==null)return e;t=t.sibling}return null}var Bb=Xn.unstable_scheduleCallback,n0=Xn.unstable_cancelCallback,F1=Xn.unstable_shouldYield,U1=Xn.unstable_requestPaint,jt=Xn.unstable_now,B1=Xn.unstable_getCurrentPriorityLevel,l_=Xn.unstable_ImmediatePriority,zb=Xn.unstable_UserBlockingPriority,Cd=Xn.unstable_NormalPriority,z1=Xn.unstable_LowPriority,qb=Xn.unstable_IdlePriority,Ef=null,ei=null;function q1(t){if(ei&&typeof ei.onCommitFiberRoot=="function")try{ei.onCommitFiberRoot(Ef,t,void 0,(t.current.flags&128)===128)}catch{}}var Mr=Math.clz32?Math.clz32:W1,$1=Math.log,H1=Math.LN2;function W1(t){return t>>>=0,t===0?32:31-($1(t)/H1|0)|0}var Sh=64,Ph=4194304;function Su(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Nd(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,o=t.pingedLanes,a=n&268435455;if(a!==0){var u=a&~i;u!==0?r=Su(u):(o&=a,o!==0&&(r=Su(o)))}else a=n&~i,a!==0?r=Su(a):o!==0&&(r=Su(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,o=e&-e,i>=o||i===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Mr(e),i=1<<n,r|=t[n],e&=~i;return r}function G1(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function K1(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,o=t.pendingLanes;0<o;){var a=31-Mr(o),u=1<<a,d=i[a];d===-1?(!(u&n)||u&r)&&(i[a]=G1(u,e)):d<=e&&(t.expiredLanes|=u),o&=~u}}function Om(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function $b(){var t=Sh;return Sh<<=1,!(Sh&4194240)&&(Sh=64),t}function Rp(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Uc(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Mr(e),t[e]=n}function Z1(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Mr(n),o=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~o}}function u_(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Mr(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var et=0;function Hb(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Wb,c_,Gb,Kb,Zb,Vm=!1,Ah=[],Os=null,Vs=null,Fs=null,nc=new Map,rc=new Map,Is=[],Q1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function r0(t,e){switch(t){case"focusin":case"focusout":Os=null;break;case"dragenter":case"dragleave":Vs=null;break;case"mouseover":case"mouseout":Fs=null;break;case"pointerover":case"pointerout":nc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":rc.delete(e.pointerId)}}function hu(t,e,n,r,i,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},e!==null&&(e=zc(e),e!==null&&c_(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function Y1(t,e,n,r,i){switch(e){case"focusin":return Os=hu(Os,t,e,n,r,i),!0;case"dragenter":return Vs=hu(Vs,t,e,n,r,i),!0;case"mouseover":return Fs=hu(Fs,t,e,n,r,i),!0;case"pointerover":var o=i.pointerId;return nc.set(o,hu(nc.get(o)||null,t,e,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,rc.set(o,hu(rc.get(o)||null,t,e,n,r,i)),!0}return!1}function Qb(t){var e=No(t.target);if(e!==null){var n=oa(e);if(n!==null){if(e=n.tag,e===13){if(e=Vb(n),e!==null){t.blockedOn=e,Zb(t.priority,function(){Gb(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function td(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Fm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Lm=r,n.target.dispatchEvent(r),Lm=null}else return e=zc(n),e!==null&&c_(e),t.blockedOn=n,!1;e.shift()}return!0}function i0(t,e,n){td(t)&&n.delete(e)}function J1(){Vm=!1,Os!==null&&td(Os)&&(Os=null),Vs!==null&&td(Vs)&&(Vs=null),Fs!==null&&td(Fs)&&(Fs=null),nc.forEach(i0),rc.forEach(i0)}function du(t,e){t.blockedOn===e&&(t.blockedOn=null,Vm||(Vm=!0,Xn.unstable_scheduleCallback(Xn.unstable_NormalPriority,J1)))}function ic(t){function e(i){return du(i,t)}if(0<Ah.length){du(Ah[0],t);for(var n=1;n<Ah.length;n++){var r=Ah[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Os!==null&&du(Os,t),Vs!==null&&du(Vs,t),Fs!==null&&du(Fs,t),nc.forEach(e),rc.forEach(e),n=0;n<Is.length;n++)r=Is[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Is.length&&(n=Is[0],n.blockedOn===null);)Qb(n),n.blockedOn===null&&Is.shift()}var ol=Gi.ReactCurrentBatchConfig,Rd=!0;function X1(t,e,n,r){var i=et,o=ol.transition;ol.transition=null;try{et=1,h_(t,e,n,r)}finally{et=i,ol.transition=o}}function eA(t,e,n,r){var i=et,o=ol.transition;ol.transition=null;try{et=4,h_(t,e,n,r)}finally{et=i,ol.transition=o}}function h_(t,e,n,r){if(Rd){var i=Fm(t,e,n,r);if(i===null)zp(t,e,r,Ld,n),r0(t,r);else if(Y1(i,t,e,n,r))r.stopPropagation();else if(r0(t,r),e&4&&-1<Q1.indexOf(t)){for(;i!==null;){var o=zc(i);if(o!==null&&Wb(o),o=Fm(t,e,n,r),o===null&&zp(t,e,r,Ld,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else zp(t,e,r,null,n)}}var Ld=null;function Fm(t,e,n,r){if(Ld=null,t=a_(r),t=No(t),t!==null)if(e=oa(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Vb(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ld=t,null}function Yb(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(B1()){case l_:return 1;case zb:return 4;case Cd:case z1:return 16;case qb:return 536870912;default:return 16}default:return 16}}var Ls=null,d_=null,nd=null;function Jb(){if(nd)return nd;var t,e=d_,n=e.length,r,i="value"in Ls?Ls.value:Ls.textContent,o=i.length;for(t=0;t<n&&e[t]===i[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===i[o-r];r++);return nd=i.slice(t,1<r?1-r:void 0)}function rd(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ch(){return!0}function s0(){return!1}function rr(t){function e(n,r,i,o,a){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=a,this.currentTarget=null;for(var u in t)t.hasOwnProperty(u)&&(n=t[u],this[u]=n?n(o):o[u]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Ch:s0,this.isPropagationStopped=s0,this}return kt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ch)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ch)},persist:function(){},isPersistent:Ch}),e}var Dl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},f_=rr(Dl),Bc=kt({},Dl,{view:0,detail:0}),tA=rr(Bc),Lp,Dp,fu,If=kt({},Bc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:p_,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==fu&&(fu&&t.type==="mousemove"?(Lp=t.screenX-fu.screenX,Dp=t.screenY-fu.screenY):Dp=Lp=0,fu=t),Lp)},movementY:function(t){return"movementY"in t?t.movementY:Dp}}),o0=rr(If),nA=kt({},If,{dataTransfer:0}),rA=rr(nA),iA=kt({},Bc,{relatedTarget:0}),jp=rr(iA),sA=kt({},Dl,{animationName:0,elapsedTime:0,pseudoElement:0}),oA=rr(sA),aA=kt({},Dl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),lA=rr(aA),uA=kt({},Dl,{data:0}),a0=rr(uA),cA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},dA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fA(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=dA[t])?!!e[t]:!1}function p_(){return fA}var pA=kt({},Bc,{key:function(t){if(t.key){var e=cA[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=rd(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?hA[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:p_,charCode:function(t){return t.type==="keypress"?rd(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?rd(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),mA=rr(pA),gA=kt({},If,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),l0=rr(gA),_A=kt({},Bc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:p_}),yA=rr(_A),vA=kt({},Dl,{propertyName:0,elapsedTime:0,pseudoElement:0}),wA=rr(vA),xA=kt({},If,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),bA=rr(xA),TA=[9,13,27,32],m_=Fi&&"CompositionEvent"in window,Vu=null;Fi&&"documentMode"in document&&(Vu=document.documentMode);var EA=Fi&&"TextEvent"in window&&!Vu,Xb=Fi&&(!m_||Vu&&8<Vu&&11>=Vu),u0=" ",c0=!1;function eT(t,e){switch(t){case"keyup":return TA.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function tT(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Wa=!1;function IA(t,e){switch(t){case"compositionend":return tT(e);case"keypress":return e.which!==32?null:(c0=!0,u0);case"textInput":return t=e.data,t===u0&&c0?null:t;default:return null}}function kA(t,e){if(Wa)return t==="compositionend"||!m_&&eT(t,e)?(t=Jb(),nd=d_=Ls=null,Wa=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Xb&&e.locale!=="ko"?null:e.data;default:return null}}var SA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function h0(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!SA[t.type]:e==="textarea"}function nT(t,e,n,r){Lb(r),e=Dd(e,"onChange"),0<e.length&&(n=new f_("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Fu=null,sc=null;function PA(t){fT(t,0)}function kf(t){var e=Za(t);if(kb(e))return t}function AA(t,e){if(t==="change")return e}var rT=!1;if(Fi){var Mp;if(Fi){var Op="oninput"in document;if(!Op){var d0=document.createElement("div");d0.setAttribute("oninput","return;"),Op=typeof d0.oninput=="function"}Mp=Op}else Mp=!1;rT=Mp&&(!document.documentMode||9<document.documentMode)}function f0(){Fu&&(Fu.detachEvent("onpropertychange",iT),sc=Fu=null)}function iT(t){if(t.propertyName==="value"&&kf(sc)){var e=[];nT(e,sc,t,a_(t)),Ob(PA,e)}}function CA(t,e,n){t==="focusin"?(f0(),Fu=e,sc=n,Fu.attachEvent("onpropertychange",iT)):t==="focusout"&&f0()}function NA(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return kf(sc)}function RA(t,e){if(t==="click")return kf(e)}function LA(t,e){if(t==="input"||t==="change")return kf(e)}function DA(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ur=typeof Object.is=="function"?Object.is:DA;function oc(t,e){if(Ur(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!xm.call(e,i)||!Ur(t[i],e[i]))return!1}return!0}function p0(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function m0(t,e){var n=p0(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=p0(n)}}function sT(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?sT(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function oT(){for(var t=window,e=Sd();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Sd(t.document)}return e}function g_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function jA(t){var e=oT(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&sT(n.ownerDocument.documentElement,n)){if(r!==null&&g_(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!t.extend&&o>r&&(i=r,r=o,o=i),i=m0(n,o);var a=m0(n,r);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var MA=Fi&&"documentMode"in document&&11>=document.documentMode,Ga=null,Um=null,Uu=null,Bm=!1;function g0(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Bm||Ga==null||Ga!==Sd(r)||(r=Ga,"selectionStart"in r&&g_(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Uu&&oc(Uu,r)||(Uu=r,r=Dd(Um,"onSelect"),0<r.length&&(e=new f_("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Ga)))}function Nh(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ka={animationend:Nh("Animation","AnimationEnd"),animationiteration:Nh("Animation","AnimationIteration"),animationstart:Nh("Animation","AnimationStart"),transitionend:Nh("Transition","TransitionEnd")},Vp={},aT={};Fi&&(aT=document.createElement("div").style,"AnimationEvent"in window||(delete Ka.animationend.animation,delete Ka.animationiteration.animation,delete Ka.animationstart.animation),"TransitionEvent"in window||delete Ka.transitionend.transition);function Sf(t){if(Vp[t])return Vp[t];if(!Ka[t])return t;var e=Ka[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in aT)return Vp[t]=e[n];return t}var lT=Sf("animationend"),uT=Sf("animationiteration"),cT=Sf("animationstart"),hT=Sf("transitionend"),dT=new Map,_0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function eo(t,e){dT.set(t,e),sa(e,[t])}for(var Fp=0;Fp<_0.length;Fp++){var Up=_0[Fp],OA=Up.toLowerCase(),VA=Up[0].toUpperCase()+Up.slice(1);eo(OA,"on"+VA)}eo(lT,"onAnimationEnd");eo(uT,"onAnimationIteration");eo(cT,"onAnimationStart");eo("dblclick","onDoubleClick");eo("focusin","onFocus");eo("focusout","onBlur");eo(hT,"onTransitionEnd");pl("onMouseEnter",["mouseout","mouseover"]);pl("onMouseLeave",["mouseout","mouseover"]);pl("onPointerEnter",["pointerout","pointerover"]);pl("onPointerLeave",["pointerout","pointerover"]);sa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));sa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));sa("onBeforeInput",["compositionend","keypress","textInput","paste"]);sa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));sa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));sa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),FA=new Set("cancel close invalid load scroll toggle".split(" ").concat(Pu));function y0(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,O1(r,e,void 0,t),t.currentTarget=null}function fT(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var a=r.length-1;0<=a;a--){var u=r[a],d=u.instance,p=u.currentTarget;if(u=u.listener,d!==o&&i.isPropagationStopped())break e;y0(i,u,p),o=d}else for(a=0;a<r.length;a++){if(u=r[a],d=u.instance,p=u.currentTarget,u=u.listener,d!==o&&i.isPropagationStopped())break e;y0(i,u,p),o=d}}}if(Ad)throw t=Mm,Ad=!1,Mm=null,t}function ht(t,e){var n=e[Wm];n===void 0&&(n=e[Wm]=new Set);var r=t+"__bubble";n.has(r)||(pT(e,t,2,!1),n.add(r))}function Bp(t,e,n){var r=0;e&&(r|=4),pT(n,t,r,e)}var Rh="_reactListening"+Math.random().toString(36).slice(2);function ac(t){if(!t[Rh]){t[Rh]=!0,xb.forEach(function(n){n!=="selectionchange"&&(FA.has(n)||Bp(n,!1,t),Bp(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Rh]||(e[Rh]=!0,Bp("selectionchange",!1,e))}}function pT(t,e,n,r){switch(Yb(e)){case 1:var i=X1;break;case 4:i=eA;break;default:i=h_}n=i.bind(null,e,n,t),i=void 0,!jm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function zp(t,e,n,r,i){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var u=r.stateNode.containerInfo;if(u===i||u.nodeType===8&&u.parentNode===i)break;if(a===4)for(a=r.return;a!==null;){var d=a.tag;if((d===3||d===4)&&(d=a.stateNode.containerInfo,d===i||d.nodeType===8&&d.parentNode===i))return;a=a.return}for(;u!==null;){if(a=No(u),a===null)return;if(d=a.tag,d===5||d===6){r=o=a;continue e}u=u.parentNode}}r=r.return}Ob(function(){var p=o,_=a_(n),w=[];e:{var x=dT.get(t);if(x!==void 0){var k=f_,P=t;switch(t){case"keypress":if(rd(n)===0)break e;case"keydown":case"keyup":k=mA;break;case"focusin":P="focus",k=jp;break;case"focusout":P="blur",k=jp;break;case"beforeblur":case"afterblur":k=jp;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":k=o0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":k=rA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":k=yA;break;case lT:case uT:case cT:k=oA;break;case hT:k=wA;break;case"scroll":k=tA;break;case"wheel":k=bA;break;case"copy":case"cut":case"paste":k=lA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":k=l0}var j=(e&4)!==0,B=!j&&t==="scroll",R=j?x!==null?x+"Capture":null:x;j=[];for(var S=p,N;S!==null;){N=S;var z=N.stateNode;if(N.tag===5&&z!==null&&(N=z,R!==null&&(z=tc(S,R),z!=null&&j.push(lc(S,z,N)))),B)break;S=S.return}0<j.length&&(x=new k(x,P,null,n,_),w.push({event:x,listeners:j}))}}if(!(e&7)){e:{if(x=t==="mouseover"||t==="pointerover",k=t==="mouseout"||t==="pointerout",x&&n!==Lm&&(P=n.relatedTarget||n.fromElement)&&(No(P)||P[Ui]))break e;if((k||x)&&(x=_.window===_?_:(x=_.ownerDocument)?x.defaultView||x.parentWindow:window,k?(P=n.relatedTarget||n.toElement,k=p,P=P?No(P):null,P!==null&&(B=oa(P),P!==B||P.tag!==5&&P.tag!==6)&&(P=null)):(k=null,P=p),k!==P)){if(j=o0,z="onMouseLeave",R="onMouseEnter",S="mouse",(t==="pointerout"||t==="pointerover")&&(j=l0,z="onPointerLeave",R="onPointerEnter",S="pointer"),B=k==null?x:Za(k),N=P==null?x:Za(P),x=new j(z,S+"leave",k,n,_),x.target=B,x.relatedTarget=N,z=null,No(_)===p&&(j=new j(R,S+"enter",P,n,_),j.target=N,j.relatedTarget=B,z=j),B=z,k&&P)t:{for(j=k,R=P,S=0,N=j;N;N=Da(N))S++;for(N=0,z=R;z;z=Da(z))N++;for(;0<S-N;)j=Da(j),S--;for(;0<N-S;)R=Da(R),N--;for(;S--;){if(j===R||R!==null&&j===R.alternate)break t;j=Da(j),R=Da(R)}j=null}else j=null;k!==null&&v0(w,x,k,j,!1),P!==null&&B!==null&&v0(w,B,P,j,!0)}}e:{if(x=p?Za(p):window,k=x.nodeName&&x.nodeName.toLowerCase(),k==="select"||k==="input"&&x.type==="file")var G=AA;else if(h0(x))if(rT)G=LA;else{G=NA;var F=CA}else(k=x.nodeName)&&k.toLowerCase()==="input"&&(x.type==="checkbox"||x.type==="radio")&&(G=RA);if(G&&(G=G(t,p))){nT(w,G,n,_);break e}F&&F(t,x,p),t==="focusout"&&(F=x._wrapperState)&&F.controlled&&x.type==="number"&&Pm(x,"number",x.value)}switch(F=p?Za(p):window,t){case"focusin":(h0(F)||F.contentEditable==="true")&&(Ga=F,Um=p,Uu=null);break;case"focusout":Uu=Um=Ga=null;break;case"mousedown":Bm=!0;break;case"contextmenu":case"mouseup":case"dragend":Bm=!1,g0(w,n,_);break;case"selectionchange":if(MA)break;case"keydown":case"keyup":g0(w,n,_)}var I;if(m_)e:{switch(t){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else Wa?eT(t,n)&&(T="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(T="onCompositionStart");T&&(Xb&&n.locale!=="ko"&&(Wa||T!=="onCompositionStart"?T==="onCompositionEnd"&&Wa&&(I=Jb()):(Ls=_,d_="value"in Ls?Ls.value:Ls.textContent,Wa=!0)),F=Dd(p,T),0<F.length&&(T=new a0(T,t,null,n,_),w.push({event:T,listeners:F}),I?T.data=I:(I=tT(n),I!==null&&(T.data=I)))),(I=EA?IA(t,n):kA(t,n))&&(p=Dd(p,"onBeforeInput"),0<p.length&&(_=new a0("onBeforeInput","beforeinput",null,n,_),w.push({event:_,listeners:p}),_.data=I))}fT(w,e)})}function lc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Dd(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=tc(t,n),o!=null&&r.unshift(lc(t,o,i)),o=tc(t,e),o!=null&&r.push(lc(t,o,i))),t=t.return}return r}function Da(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function v0(t,e,n,r,i){for(var o=e._reactName,a=[];n!==null&&n!==r;){var u=n,d=u.alternate,p=u.stateNode;if(d!==null&&d===r)break;u.tag===5&&p!==null&&(u=p,i?(d=tc(n,o),d!=null&&a.unshift(lc(n,d,u))):i||(d=tc(n,o),d!=null&&a.push(lc(n,d,u)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var UA=/\r\n?/g,BA=/\u0000|\uFFFD/g;function w0(t){return(typeof t=="string"?t:""+t).replace(UA,`
`).replace(BA,"")}function Lh(t,e,n){if(e=w0(e),w0(t)!==e&&n)throw Error(ne(425))}function jd(){}var zm=null,qm=null;function $m(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Hm=typeof setTimeout=="function"?setTimeout:void 0,zA=typeof clearTimeout=="function"?clearTimeout:void 0,x0=typeof Promise=="function"?Promise:void 0,qA=typeof queueMicrotask=="function"?queueMicrotask:typeof x0<"u"?function(t){return x0.resolve(null).then(t).catch($A)}:Hm;function $A(t){setTimeout(function(){throw t})}function qp(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),ic(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);ic(e)}function Us(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function b0(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var jl=Math.random().toString(36).slice(2),Qr="__reactFiber$"+jl,uc="__reactProps$"+jl,Ui="__reactContainer$"+jl,Wm="__reactEvents$"+jl,HA="__reactListeners$"+jl,WA="__reactHandles$"+jl;function No(t){var e=t[Qr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Ui]||n[Qr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=b0(t);t!==null;){if(n=t[Qr])return n;t=b0(t)}return e}t=n,n=t.parentNode}return null}function zc(t){return t=t[Qr]||t[Ui],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Za(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ne(33))}function Pf(t){return t[uc]||null}var Gm=[],Qa=-1;function to(t){return{current:t}}function dt(t){0>Qa||(t.current=Gm[Qa],Gm[Qa]=null,Qa--)}function lt(t,e){Qa++,Gm[Qa]=t.current,t.current=e}var Qs={},gn=to(Qs),Fn=to(!1),Bo=Qs;function ml(t,e){var n=t.type.contextTypes;if(!n)return Qs;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in n)i[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Un(t){return t=t.childContextTypes,t!=null}function Md(){dt(Fn),dt(gn)}function T0(t,e,n){if(gn.current!==Qs)throw Error(ne(168));lt(gn,e),lt(Fn,n)}function mT(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ne(108,C1(t)||"Unknown",i));return kt({},n,r)}function Od(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Qs,Bo=gn.current,lt(gn,t),lt(Fn,Fn.current),!0}function E0(t,e,n){var r=t.stateNode;if(!r)throw Error(ne(169));n?(t=mT(t,e,Bo),r.__reactInternalMemoizedMergedChildContext=t,dt(Fn),dt(gn),lt(gn,t)):dt(Fn),lt(Fn,n)}var Si=null,Af=!1,$p=!1;function gT(t){Si===null?Si=[t]:Si.push(t)}function GA(t){Af=!0,gT(t)}function no(){if(!$p&&Si!==null){$p=!0;var t=0,e=et;try{var n=Si;for(et=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Si=null,Af=!1}catch(i){throw Si!==null&&(Si=Si.slice(t+1)),Bb(l_,no),i}finally{et=e,$p=!1}}return null}var Ya=[],Ja=0,Vd=null,Fd=0,hr=[],dr=0,zo=null,Ai=1,Ci="";function bo(t,e){Ya[Ja++]=Fd,Ya[Ja++]=Vd,Vd=t,Fd=e}function _T(t,e,n){hr[dr++]=Ai,hr[dr++]=Ci,hr[dr++]=zo,zo=t;var r=Ai;t=Ci;var i=32-Mr(r)-1;r&=~(1<<i),n+=1;var o=32-Mr(e)+i;if(30<o){var a=i-i%5;o=(r&(1<<a)-1).toString(32),r>>=a,i-=a,Ai=1<<32-Mr(e)+i|n<<i|r,Ci=o+t}else Ai=1<<o|n<<i|r,Ci=t}function __(t){t.return!==null&&(bo(t,1),_T(t,1,0))}function y_(t){for(;t===Vd;)Vd=Ya[--Ja],Ya[Ja]=null,Fd=Ya[--Ja],Ya[Ja]=null;for(;t===zo;)zo=hr[--dr],hr[dr]=null,Ci=hr[--dr],hr[dr]=null,Ai=hr[--dr],hr[dr]=null}var Qn=null,Gn=null,_t=!1,Lr=null;function yT(t,e){var n=fr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function I0(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Qn=t,Gn=Us(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Qn=t,Gn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=zo!==null?{id:Ai,overflow:Ci}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=fr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Qn=t,Gn=null,!0):!1;default:return!1}}function Km(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Zm(t){if(_t){var e=Gn;if(e){var n=e;if(!I0(t,e)){if(Km(t))throw Error(ne(418));e=Us(n.nextSibling);var r=Qn;e&&I0(t,e)?yT(r,n):(t.flags=t.flags&-4097|2,_t=!1,Qn=t)}}else{if(Km(t))throw Error(ne(418));t.flags=t.flags&-4097|2,_t=!1,Qn=t}}}function k0(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Qn=t}function Dh(t){if(t!==Qn)return!1;if(!_t)return k0(t),_t=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!$m(t.type,t.memoizedProps)),e&&(e=Gn)){if(Km(t))throw vT(),Error(ne(418));for(;e;)yT(t,e),e=Us(e.nextSibling)}if(k0(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ne(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Gn=Us(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Gn=null}}else Gn=Qn?Us(t.stateNode.nextSibling):null;return!0}function vT(){for(var t=Gn;t;)t=Us(t.nextSibling)}function gl(){Gn=Qn=null,_t=!1}function v_(t){Lr===null?Lr=[t]:Lr.push(t)}var KA=Gi.ReactCurrentBatchConfig;function pu(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ne(309));var r=n.stateNode}if(!r)throw Error(ne(147,t));var i=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(a){var u=i.refs;a===null?delete u[o]:u[o]=a},e._stringRef=o,e)}if(typeof t!="string")throw Error(ne(284));if(!n._owner)throw Error(ne(290,t))}return t}function jh(t,e){throw t=Object.prototype.toString.call(e),Error(ne(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function S0(t){var e=t._init;return e(t._payload)}function wT(t){function e(R,S){if(t){var N=R.deletions;N===null?(R.deletions=[S],R.flags|=16):N.push(S)}}function n(R,S){if(!t)return null;for(;S!==null;)e(R,S),S=S.sibling;return null}function r(R,S){for(R=new Map;S!==null;)S.key!==null?R.set(S.key,S):R.set(S.index,S),S=S.sibling;return R}function i(R,S){return R=$s(R,S),R.index=0,R.sibling=null,R}function o(R,S,N){return R.index=N,t?(N=R.alternate,N!==null?(N=N.index,N<S?(R.flags|=2,S):N):(R.flags|=2,S)):(R.flags|=1048576,S)}function a(R){return t&&R.alternate===null&&(R.flags|=2),R}function u(R,S,N,z){return S===null||S.tag!==6?(S=Yp(N,R.mode,z),S.return=R,S):(S=i(S,N),S.return=R,S)}function d(R,S,N,z){var G=N.type;return G===Ha?_(R,S,N.props.children,z,N.key):S!==null&&(S.elementType===G||typeof G=="object"&&G!==null&&G.$$typeof===Ts&&S0(G)===S.type)?(z=i(S,N.props),z.ref=pu(R,S,N),z.return=R,z):(z=cd(N.type,N.key,N.props,null,R.mode,z),z.ref=pu(R,S,N),z.return=R,z)}function p(R,S,N,z){return S===null||S.tag!==4||S.stateNode.containerInfo!==N.containerInfo||S.stateNode.implementation!==N.implementation?(S=Jp(N,R.mode,z),S.return=R,S):(S=i(S,N.children||[]),S.return=R,S)}function _(R,S,N,z,G){return S===null||S.tag!==7?(S=Oo(N,R.mode,z,G),S.return=R,S):(S=i(S,N),S.return=R,S)}function w(R,S,N){if(typeof S=="string"&&S!==""||typeof S=="number")return S=Yp(""+S,R.mode,N),S.return=R,S;if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Eh:return N=cd(S.type,S.key,S.props,null,R.mode,N),N.ref=pu(R,null,S),N.return=R,N;case $a:return S=Jp(S,R.mode,N),S.return=R,S;case Ts:var z=S._init;return w(R,z(S._payload),N)}if(ku(S)||uu(S))return S=Oo(S,R.mode,N,null),S.return=R,S;jh(R,S)}return null}function x(R,S,N,z){var G=S!==null?S.key:null;if(typeof N=="string"&&N!==""||typeof N=="number")return G!==null?null:u(R,S,""+N,z);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case Eh:return N.key===G?d(R,S,N,z):null;case $a:return N.key===G?p(R,S,N,z):null;case Ts:return G=N._init,x(R,S,G(N._payload),z)}if(ku(N)||uu(N))return G!==null?null:_(R,S,N,z,null);jh(R,N)}return null}function k(R,S,N,z,G){if(typeof z=="string"&&z!==""||typeof z=="number")return R=R.get(N)||null,u(S,R,""+z,G);if(typeof z=="object"&&z!==null){switch(z.$$typeof){case Eh:return R=R.get(z.key===null?N:z.key)||null,d(S,R,z,G);case $a:return R=R.get(z.key===null?N:z.key)||null,p(S,R,z,G);case Ts:var F=z._init;return k(R,S,N,F(z._payload),G)}if(ku(z)||uu(z))return R=R.get(N)||null,_(S,R,z,G,null);jh(S,z)}return null}function P(R,S,N,z){for(var G=null,F=null,I=S,T=S=0,C=null;I!==null&&T<N.length;T++){I.index>T?(C=I,I=null):C=I.sibling;var A=x(R,I,N[T],z);if(A===null){I===null&&(I=C);break}t&&I&&A.alternate===null&&e(R,I),S=o(A,S,T),F===null?G=A:F.sibling=A,F=A,I=C}if(T===N.length)return n(R,I),_t&&bo(R,T),G;if(I===null){for(;T<N.length;T++)I=w(R,N[T],z),I!==null&&(S=o(I,S,T),F===null?G=I:F.sibling=I,F=I);return _t&&bo(R,T),G}for(I=r(R,I);T<N.length;T++)C=k(I,R,T,N[T],z),C!==null&&(t&&C.alternate!==null&&I.delete(C.key===null?T:C.key),S=o(C,S,T),F===null?G=C:F.sibling=C,F=C);return t&&I.forEach(function(M){return e(R,M)}),_t&&bo(R,T),G}function j(R,S,N,z){var G=uu(N);if(typeof G!="function")throw Error(ne(150));if(N=G.call(N),N==null)throw Error(ne(151));for(var F=G=null,I=S,T=S=0,C=null,A=N.next();I!==null&&!A.done;T++,A=N.next()){I.index>T?(C=I,I=null):C=I.sibling;var M=x(R,I,A.value,z);if(M===null){I===null&&(I=C);break}t&&I&&M.alternate===null&&e(R,I),S=o(M,S,T),F===null?G=M:F.sibling=M,F=M,I=C}if(A.done)return n(R,I),_t&&bo(R,T),G;if(I===null){for(;!A.done;T++,A=N.next())A=w(R,A.value,z),A!==null&&(S=o(A,S,T),F===null?G=A:F.sibling=A,F=A);return _t&&bo(R,T),G}for(I=r(R,I);!A.done;T++,A=N.next())A=k(I,R,T,A.value,z),A!==null&&(t&&A.alternate!==null&&I.delete(A.key===null?T:A.key),S=o(A,S,T),F===null?G=A:F.sibling=A,F=A);return t&&I.forEach(function(U){return e(R,U)}),_t&&bo(R,T),G}function B(R,S,N,z){if(typeof N=="object"&&N!==null&&N.type===Ha&&N.key===null&&(N=N.props.children),typeof N=="object"&&N!==null){switch(N.$$typeof){case Eh:e:{for(var G=N.key,F=S;F!==null;){if(F.key===G){if(G=N.type,G===Ha){if(F.tag===7){n(R,F.sibling),S=i(F,N.props.children),S.return=R,R=S;break e}}else if(F.elementType===G||typeof G=="object"&&G!==null&&G.$$typeof===Ts&&S0(G)===F.type){n(R,F.sibling),S=i(F,N.props),S.ref=pu(R,F,N),S.return=R,R=S;break e}n(R,F);break}else e(R,F);F=F.sibling}N.type===Ha?(S=Oo(N.props.children,R.mode,z,N.key),S.return=R,R=S):(z=cd(N.type,N.key,N.props,null,R.mode,z),z.ref=pu(R,S,N),z.return=R,R=z)}return a(R);case $a:e:{for(F=N.key;S!==null;){if(S.key===F)if(S.tag===4&&S.stateNode.containerInfo===N.containerInfo&&S.stateNode.implementation===N.implementation){n(R,S.sibling),S=i(S,N.children||[]),S.return=R,R=S;break e}else{n(R,S);break}else e(R,S);S=S.sibling}S=Jp(N,R.mode,z),S.return=R,R=S}return a(R);case Ts:return F=N._init,B(R,S,F(N._payload),z)}if(ku(N))return P(R,S,N,z);if(uu(N))return j(R,S,N,z);jh(R,N)}return typeof N=="string"&&N!==""||typeof N=="number"?(N=""+N,S!==null&&S.tag===6?(n(R,S.sibling),S=i(S,N),S.return=R,R=S):(n(R,S),S=Yp(N,R.mode,z),S.return=R,R=S),a(R)):n(R,S)}return B}var _l=wT(!0),xT=wT(!1),Ud=to(null),Bd=null,Xa=null,w_=null;function x_(){w_=Xa=Bd=null}function b_(t){var e=Ud.current;dt(Ud),t._currentValue=e}function Qm(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function al(t,e){Bd=t,w_=Xa=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Mn=!0),t.firstContext=null)}function mr(t){var e=t._currentValue;if(w_!==t)if(t={context:t,memoizedValue:e,next:null},Xa===null){if(Bd===null)throw Error(ne(308));Xa=t,Bd.dependencies={lanes:0,firstContext:t}}else Xa=Xa.next=t;return e}var Ro=null;function T_(t){Ro===null?Ro=[t]:Ro.push(t)}function bT(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,T_(e)):(n.next=i.next,i.next=n),e.interleaved=n,Bi(t,r)}function Bi(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Es=!1;function E_(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function TT(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Mi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Bs(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ge&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Bi(t,n)}return i=r.interleaved,i===null?(e.next=e,T_(r)):(e.next=i.next,i.next=e),r.interleaved=e,Bi(t,n)}function id(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,u_(t,n)}}function P0(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?i=o=a:o=o.next=a,n=n.next}while(n!==null);o===null?i=o=e:o=o.next=e}else i=o=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function zd(t,e,n,r){var i=t.updateQueue;Es=!1;var o=i.firstBaseUpdate,a=i.lastBaseUpdate,u=i.shared.pending;if(u!==null){i.shared.pending=null;var d=u,p=d.next;d.next=null,a===null?o=p:a.next=p,a=d;var _=t.alternate;_!==null&&(_=_.updateQueue,u=_.lastBaseUpdate,u!==a&&(u===null?_.firstBaseUpdate=p:u.next=p,_.lastBaseUpdate=d))}if(o!==null){var w=i.baseState;a=0,_=p=d=null,u=o;do{var x=u.lane,k=u.eventTime;if((r&x)===x){_!==null&&(_=_.next={eventTime:k,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var P=t,j=u;switch(x=e,k=n,j.tag){case 1:if(P=j.payload,typeof P=="function"){w=P.call(k,w,x);break e}w=P;break e;case 3:P.flags=P.flags&-65537|128;case 0:if(P=j.payload,x=typeof P=="function"?P.call(k,w,x):P,x==null)break e;w=kt({},w,x);break e;case 2:Es=!0}}u.callback!==null&&u.lane!==0&&(t.flags|=64,x=i.effects,x===null?i.effects=[u]:x.push(u))}else k={eventTime:k,lane:x,tag:u.tag,payload:u.payload,callback:u.callback,next:null},_===null?(p=_=k,d=w):_=_.next=k,a|=x;if(u=u.next,u===null){if(u=i.shared.pending,u===null)break;x=u,u=x.next,x.next=null,i.lastBaseUpdate=x,i.shared.pending=null}}while(!0);if(_===null&&(d=w),i.baseState=d,i.firstBaseUpdate=p,i.lastBaseUpdate=_,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else o===null&&(i.shared.lanes=0);$o|=a,t.lanes=a,t.memoizedState=w}}function A0(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ne(191,i));i.call(r)}}}var qc={},ti=to(qc),cc=to(qc),hc=to(qc);function Lo(t){if(t===qc)throw Error(ne(174));return t}function I_(t,e){switch(lt(hc,e),lt(cc,t),lt(ti,qc),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Cm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Cm(e,t)}dt(ti),lt(ti,e)}function yl(){dt(ti),dt(cc),dt(hc)}function ET(t){Lo(hc.current);var e=Lo(ti.current),n=Cm(e,t.type);e!==n&&(lt(cc,t),lt(ti,n))}function k_(t){cc.current===t&&(dt(ti),dt(cc))}var Tt=to(0);function qd(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Hp=[];function S_(){for(var t=0;t<Hp.length;t++)Hp[t]._workInProgressVersionPrimary=null;Hp.length=0}var sd=Gi.ReactCurrentDispatcher,Wp=Gi.ReactCurrentBatchConfig,qo=0,It=null,$t=null,Yt=null,$d=!1,Bu=!1,dc=0,ZA=0;function on(){throw Error(ne(321))}function P_(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ur(t[n],e[n]))return!1;return!0}function A_(t,e,n,r,i,o){if(qo=o,It=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,sd.current=t===null||t.memoizedState===null?XA:eC,t=n(r,i),Bu){o=0;do{if(Bu=!1,dc=0,25<=o)throw Error(ne(301));o+=1,Yt=$t=null,e.updateQueue=null,sd.current=tC,t=n(r,i)}while(Bu)}if(sd.current=Hd,e=$t!==null&&$t.next!==null,qo=0,Yt=$t=It=null,$d=!1,e)throw Error(ne(300));return t}function C_(){var t=dc!==0;return dc=0,t}function Zr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yt===null?It.memoizedState=Yt=t:Yt=Yt.next=t,Yt}function gr(){if($t===null){var t=It.alternate;t=t!==null?t.memoizedState:null}else t=$t.next;var e=Yt===null?It.memoizedState:Yt.next;if(e!==null)Yt=e,$t=t;else{if(t===null)throw Error(ne(310));$t=t,t={memoizedState:$t.memoizedState,baseState:$t.baseState,baseQueue:$t.baseQueue,queue:$t.queue,next:null},Yt===null?It.memoizedState=Yt=t:Yt=Yt.next=t}return Yt}function fc(t,e){return typeof e=="function"?e(t):e}function Gp(t){var e=gr(),n=e.queue;if(n===null)throw Error(ne(311));n.lastRenderedReducer=t;var r=$t,i=r.baseQueue,o=n.pending;if(o!==null){if(i!==null){var a=i.next;i.next=o.next,o.next=a}r.baseQueue=i=o,n.pending=null}if(i!==null){o=i.next,r=r.baseState;var u=a=null,d=null,p=o;do{var _=p.lane;if((qo&_)===_)d!==null&&(d=d.next={lane:0,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null}),r=p.hasEagerState?p.eagerState:t(r,p.action);else{var w={lane:_,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null};d===null?(u=d=w,a=r):d=d.next=w,It.lanes|=_,$o|=_}p=p.next}while(p!==null&&p!==o);d===null?a=r:d.next=u,Ur(r,e.memoizedState)||(Mn=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=d,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do o=i.lane,It.lanes|=o,$o|=o,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Kp(t){var e=gr(),n=e.queue;if(n===null)throw Error(ne(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,o=e.memoizedState;if(i!==null){n.pending=null;var a=i=i.next;do o=t(o,a.action),a=a.next;while(a!==i);Ur(o,e.memoizedState)||(Mn=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function IT(){}function kT(t,e){var n=It,r=gr(),i=e(),o=!Ur(r.memoizedState,i);if(o&&(r.memoizedState=i,Mn=!0),r=r.queue,N_(AT.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||Yt!==null&&Yt.memoizedState.tag&1){if(n.flags|=2048,pc(9,PT.bind(null,n,r,i,e),void 0,null),Xt===null)throw Error(ne(349));qo&30||ST(n,e,i)}return i}function ST(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=It.updateQueue,e===null?(e={lastEffect:null,stores:null},It.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function PT(t,e,n,r){e.value=n,e.getSnapshot=r,CT(e)&&NT(t)}function AT(t,e,n){return n(function(){CT(e)&&NT(t)})}function CT(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ur(t,n)}catch{return!0}}function NT(t){var e=Bi(t,1);e!==null&&Or(e,t,1,-1)}function C0(t){var e=Zr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:fc,lastRenderedState:t},e.queue=t,t=t.dispatch=JA.bind(null,It,t),[e.memoizedState,t]}function pc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=It.updateQueue,e===null?(e={lastEffect:null,stores:null},It.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function RT(){return gr().memoizedState}function od(t,e,n,r){var i=Zr();It.flags|=t,i.memoizedState=pc(1|e,n,void 0,r===void 0?null:r)}function Cf(t,e,n,r){var i=gr();r=r===void 0?null:r;var o=void 0;if($t!==null){var a=$t.memoizedState;if(o=a.destroy,r!==null&&P_(r,a.deps)){i.memoizedState=pc(e,n,o,r);return}}It.flags|=t,i.memoizedState=pc(1|e,n,o,r)}function N0(t,e){return od(8390656,8,t,e)}function N_(t,e){return Cf(2048,8,t,e)}function LT(t,e){return Cf(4,2,t,e)}function DT(t,e){return Cf(4,4,t,e)}function jT(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function MT(t,e,n){return n=n!=null?n.concat([t]):null,Cf(4,4,jT.bind(null,e,t),n)}function R_(){}function OT(t,e){var n=gr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&P_(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function VT(t,e){var n=gr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&P_(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function FT(t,e,n){return qo&21?(Ur(n,e)||(n=$b(),It.lanes|=n,$o|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Mn=!0),t.memoizedState=n)}function QA(t,e){var n=et;et=n!==0&&4>n?n:4,t(!0);var r=Wp.transition;Wp.transition={};try{t(!1),e()}finally{et=n,Wp.transition=r}}function UT(){return gr().memoizedState}function YA(t,e,n){var r=qs(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},BT(t))zT(e,n);else if(n=bT(t,e,n,r),n!==null){var i=En();Or(n,t,r,i),qT(n,e,r)}}function JA(t,e,n){var r=qs(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(BT(t))zT(e,i);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var a=e.lastRenderedState,u=o(a,n);if(i.hasEagerState=!0,i.eagerState=u,Ur(u,a)){var d=e.interleaved;d===null?(i.next=i,T_(e)):(i.next=d.next,d.next=i),e.interleaved=i;return}}catch{}finally{}n=bT(t,e,i,r),n!==null&&(i=En(),Or(n,t,r,i),qT(n,e,r))}}function BT(t){var e=t.alternate;return t===It||e!==null&&e===It}function zT(t,e){Bu=$d=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function qT(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,u_(t,n)}}var Hd={readContext:mr,useCallback:on,useContext:on,useEffect:on,useImperativeHandle:on,useInsertionEffect:on,useLayoutEffect:on,useMemo:on,useReducer:on,useRef:on,useState:on,useDebugValue:on,useDeferredValue:on,useTransition:on,useMutableSource:on,useSyncExternalStore:on,useId:on,unstable_isNewReconciler:!1},XA={readContext:mr,useCallback:function(t,e){return Zr().memoizedState=[t,e===void 0?null:e],t},useContext:mr,useEffect:N0,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,od(4194308,4,jT.bind(null,e,t),n)},useLayoutEffect:function(t,e){return od(4194308,4,t,e)},useInsertionEffect:function(t,e){return od(4,2,t,e)},useMemo:function(t,e){var n=Zr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Zr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=YA.bind(null,It,t),[r.memoizedState,t]},useRef:function(t){var e=Zr();return t={current:t},e.memoizedState=t},useState:C0,useDebugValue:R_,useDeferredValue:function(t){return Zr().memoizedState=t},useTransition:function(){var t=C0(!1),e=t[0];return t=QA.bind(null,t[1]),Zr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=It,i=Zr();if(_t){if(n===void 0)throw Error(ne(407));n=n()}else{if(n=e(),Xt===null)throw Error(ne(349));qo&30||ST(r,e,n)}i.memoizedState=n;var o={value:n,getSnapshot:e};return i.queue=o,N0(AT.bind(null,r,o,t),[t]),r.flags|=2048,pc(9,PT.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=Zr(),e=Xt.identifierPrefix;if(_t){var n=Ci,r=Ai;n=(r&~(1<<32-Mr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=dc++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=ZA++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},eC={readContext:mr,useCallback:OT,useContext:mr,useEffect:N_,useImperativeHandle:MT,useInsertionEffect:LT,useLayoutEffect:DT,useMemo:VT,useReducer:Gp,useRef:RT,useState:function(){return Gp(fc)},useDebugValue:R_,useDeferredValue:function(t){var e=gr();return FT(e,$t.memoizedState,t)},useTransition:function(){var t=Gp(fc)[0],e=gr().memoizedState;return[t,e]},useMutableSource:IT,useSyncExternalStore:kT,useId:UT,unstable_isNewReconciler:!1},tC={readContext:mr,useCallback:OT,useContext:mr,useEffect:N_,useImperativeHandle:MT,useInsertionEffect:LT,useLayoutEffect:DT,useMemo:VT,useReducer:Kp,useRef:RT,useState:function(){return Kp(fc)},useDebugValue:R_,useDeferredValue:function(t){var e=gr();return $t===null?e.memoizedState=t:FT(e,$t.memoizedState,t)},useTransition:function(){var t=Kp(fc)[0],e=gr().memoizedState;return[t,e]},useMutableSource:IT,useSyncExternalStore:kT,useId:UT,unstable_isNewReconciler:!1};function Nr(t,e){if(t&&t.defaultProps){e=kt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Ym(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:kt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Nf={isMounted:function(t){return(t=t._reactInternals)?oa(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=En(),i=qs(t),o=Mi(r,i);o.payload=e,n!=null&&(o.callback=n),e=Bs(t,o,i),e!==null&&(Or(e,t,i,r),id(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=En(),i=qs(t),o=Mi(r,i);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=Bs(t,o,i),e!==null&&(Or(e,t,i,r),id(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=En(),r=qs(t),i=Mi(n,r);i.tag=2,e!=null&&(i.callback=e),e=Bs(t,i,r),e!==null&&(Or(e,t,r,n),id(e,t,r))}};function R0(t,e,n,r,i,o,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,a):e.prototype&&e.prototype.isPureReactComponent?!oc(n,r)||!oc(i,o):!0}function $T(t,e,n){var r=!1,i=Qs,o=e.contextType;return typeof o=="object"&&o!==null?o=mr(o):(i=Un(e)?Bo:gn.current,r=e.contextTypes,o=(r=r!=null)?ml(t,i):Qs),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Nf,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function L0(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Nf.enqueueReplaceState(e,e.state,null)}function Jm(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},E_(t);var o=e.contextType;typeof o=="object"&&o!==null?i.context=mr(o):(o=Un(e)?Bo:gn.current,i.context=ml(t,o)),i.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(Ym(t,e,o,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Nf.enqueueReplaceState(i,i.state,null),zd(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function vl(t,e){try{var n="",r=e;do n+=A1(r),r=r.return;while(r);var i=n}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:i,digest:null}}function Zp(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Xm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var nC=typeof WeakMap=="function"?WeakMap:Map;function HT(t,e,n){n=Mi(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Gd||(Gd=!0,ug=r),Xm(t,e)},n}function WT(t,e,n){n=Mi(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Xm(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){Xm(t,e),typeof r!="function"&&(zs===null?zs=new Set([this]):zs.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function D0(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new nC;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=gC.bind(null,t,e,n),e.then(t,t))}function j0(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function M0(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Mi(-1,1),e.tag=2,Bs(n,e,1))),n.lanes|=1),t)}var rC=Gi.ReactCurrentOwner,Mn=!1;function bn(t,e,n,r){e.child=t===null?xT(e,null,n,r):_l(e,t.child,n,r)}function O0(t,e,n,r,i){n=n.render;var o=e.ref;return al(e,i),r=A_(t,e,n,r,o,i),n=C_(),t!==null&&!Mn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,zi(t,e,i)):(_t&&n&&__(e),e.flags|=1,bn(t,e,r,i),e.child)}function V0(t,e,n,r,i){if(t===null){var o=n.type;return typeof o=="function"&&!U_(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,GT(t,e,o,r,i)):(t=cd(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&i)){var a=o.memoizedProps;if(n=n.compare,n=n!==null?n:oc,n(a,r)&&t.ref===e.ref)return zi(t,e,i)}return e.flags|=1,t=$s(o,r),t.ref=e.ref,t.return=e,e.child=t}function GT(t,e,n,r,i){if(t!==null){var o=t.memoizedProps;if(oc(o,r)&&t.ref===e.ref)if(Mn=!1,e.pendingProps=r=o,(t.lanes&i)!==0)t.flags&131072&&(Mn=!0);else return e.lanes=t.lanes,zi(t,e,i)}return eg(t,e,n,r,i)}function KT(t,e,n){var r=e.pendingProps,i=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},lt(tl,Wn),Wn|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,lt(tl,Wn),Wn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,lt(tl,Wn),Wn|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,lt(tl,Wn),Wn|=r;return bn(t,e,i,n),e.child}function ZT(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function eg(t,e,n,r,i){var o=Un(n)?Bo:gn.current;return o=ml(e,o),al(e,i),n=A_(t,e,n,r,o,i),r=C_(),t!==null&&!Mn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,zi(t,e,i)):(_t&&r&&__(e),e.flags|=1,bn(t,e,n,i),e.child)}function F0(t,e,n,r,i){if(Un(n)){var o=!0;Od(e)}else o=!1;if(al(e,i),e.stateNode===null)ad(t,e),$T(e,n,r),Jm(e,n,r,i),r=!0;else if(t===null){var a=e.stateNode,u=e.memoizedProps;a.props=u;var d=a.context,p=n.contextType;typeof p=="object"&&p!==null?p=mr(p):(p=Un(n)?Bo:gn.current,p=ml(e,p));var _=n.getDerivedStateFromProps,w=typeof _=="function"||typeof a.getSnapshotBeforeUpdate=="function";w||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(u!==r||d!==p)&&L0(e,a,r,p),Es=!1;var x=e.memoizedState;a.state=x,zd(e,r,a,i),d=e.memoizedState,u!==r||x!==d||Fn.current||Es?(typeof _=="function"&&(Ym(e,n,_,r),d=e.memoizedState),(u=Es||R0(e,n,u,r,x,d,p))?(w||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=d),a.props=r,a.state=d,a.context=p,r=u):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,TT(t,e),u=e.memoizedProps,p=e.type===e.elementType?u:Nr(e.type,u),a.props=p,w=e.pendingProps,x=a.context,d=n.contextType,typeof d=="object"&&d!==null?d=mr(d):(d=Un(n)?Bo:gn.current,d=ml(e,d));var k=n.getDerivedStateFromProps;(_=typeof k=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(u!==w||x!==d)&&L0(e,a,r,d),Es=!1,x=e.memoizedState,a.state=x,zd(e,r,a,i);var P=e.memoizedState;u!==w||x!==P||Fn.current||Es?(typeof k=="function"&&(Ym(e,n,k,r),P=e.memoizedState),(p=Es||R0(e,n,p,r,x,P,d)||!1)?(_||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,P,d),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,P,d)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||u===t.memoizedProps&&x===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&x===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=P),a.props=r,a.state=P,a.context=d,r=p):(typeof a.componentDidUpdate!="function"||u===t.memoizedProps&&x===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&x===t.memoizedState||(e.flags|=1024),r=!1)}return tg(t,e,n,r,o,i)}function tg(t,e,n,r,i,o){ZT(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return i&&E0(e,n,!1),zi(t,e,o);r=e.stateNode,rC.current=e;var u=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=_l(e,t.child,null,o),e.child=_l(e,null,u,o)):bn(t,e,u,o),e.memoizedState=r.state,i&&E0(e,n,!0),e.child}function QT(t){var e=t.stateNode;e.pendingContext?T0(t,e.pendingContext,e.pendingContext!==e.context):e.context&&T0(t,e.context,!1),I_(t,e.containerInfo)}function U0(t,e,n,r,i){return gl(),v_(i),e.flags|=256,bn(t,e,n,r),e.child}var ng={dehydrated:null,treeContext:null,retryLane:0};function rg(t){return{baseLanes:t,cachePool:null,transitions:null}}function YT(t,e,n){var r=e.pendingProps,i=Tt.current,o=!1,a=(e.flags&128)!==0,u;if((u=a)||(u=t!==null&&t.memoizedState===null?!1:(i&2)!==0),u?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),lt(Tt,i&1),t===null)return Zm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,o?(r=e.mode,o=e.child,a={mode:"hidden",children:a},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=a):o=Df(a,r,0,null),t=Oo(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=rg(n),e.memoizedState=ng,t):L_(e,a));if(i=t.memoizedState,i!==null&&(u=i.dehydrated,u!==null))return iC(t,e,a,r,u,i,n);if(o){o=r.fallback,a=e.mode,i=t.child,u=i.sibling;var d={mode:"hidden",children:r.children};return!(a&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=d,e.deletions=null):(r=$s(i,d),r.subtreeFlags=i.subtreeFlags&14680064),u!==null?o=$s(u,o):(o=Oo(o,a,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,a=t.child.memoizedState,a=a===null?rg(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},o.memoizedState=a,o.childLanes=t.childLanes&~n,e.memoizedState=ng,r}return o=t.child,t=o.sibling,r=$s(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function L_(t,e){return e=Df({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Mh(t,e,n,r){return r!==null&&v_(r),_l(e,t.child,null,n),t=L_(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function iC(t,e,n,r,i,o,a){if(n)return e.flags&256?(e.flags&=-257,r=Zp(Error(ne(422))),Mh(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,i=e.mode,r=Df({mode:"visible",children:r.children},i,0,null),o=Oo(o,i,a,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&_l(e,t.child,null,a),e.child.memoizedState=rg(a),e.memoizedState=ng,o);if(!(e.mode&1))return Mh(t,e,a,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var u=r.dgst;return r=u,o=Error(ne(419)),r=Zp(o,r,void 0),Mh(t,e,a,r)}if(u=(a&t.childLanes)!==0,Mn||u){if(r=Xt,r!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|a)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,Bi(t,i),Or(r,t,i,-1))}return F_(),r=Zp(Error(ne(421))),Mh(t,e,a,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=_C.bind(null,t),i._reactRetry=e,null):(t=o.treeContext,Gn=Us(i.nextSibling),Qn=e,_t=!0,Lr=null,t!==null&&(hr[dr++]=Ai,hr[dr++]=Ci,hr[dr++]=zo,Ai=t.id,Ci=t.overflow,zo=e),e=L_(e,r.children),e.flags|=4096,e)}function B0(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Qm(t.return,e,n)}function Qp(t,e,n,r,i){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function JT(t,e,n){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(bn(t,e,r.children,n),r=Tt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&B0(t,n,e);else if(t.tag===19)B0(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(lt(Tt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&qd(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Qp(e,!1,i,n,o);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&qd(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Qp(e,!0,n,null,o);break;case"together":Qp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ad(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function zi(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),$o|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ne(153));if(e.child!==null){for(t=e.child,n=$s(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=$s(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function sC(t,e,n){switch(e.tag){case 3:QT(e),gl();break;case 5:ET(e);break;case 1:Un(e.type)&&Od(e);break;case 4:I_(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;lt(Ud,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(lt(Tt,Tt.current&1),e.flags|=128,null):n&e.child.childLanes?YT(t,e,n):(lt(Tt,Tt.current&1),t=zi(t,e,n),t!==null?t.sibling:null);lt(Tt,Tt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return JT(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),lt(Tt,Tt.current),r)break;return null;case 22:case 23:return e.lanes=0,KT(t,e,n)}return zi(t,e,n)}var XT,ig,eE,tE;XT=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};ig=function(){};eE=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Lo(ti.current);var o=null;switch(n){case"input":i=km(t,i),r=km(t,r),o=[];break;case"select":i=kt({},i,{value:void 0}),r=kt({},r,{value:void 0}),o=[];break;case"textarea":i=Am(t,i),r=Am(t,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=jd)}Nm(n,r);var a;n=null;for(p in i)if(!r.hasOwnProperty(p)&&i.hasOwnProperty(p)&&i[p]!=null)if(p==="style"){var u=i[p];for(a in u)u.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else p!=="dangerouslySetInnerHTML"&&p!=="children"&&p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&p!=="autoFocus"&&(Xu.hasOwnProperty(p)?o||(o=[]):(o=o||[]).push(p,null));for(p in r){var d=r[p];if(u=i!=null?i[p]:void 0,r.hasOwnProperty(p)&&d!==u&&(d!=null||u!=null))if(p==="style")if(u){for(a in u)!u.hasOwnProperty(a)||d&&d.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in d)d.hasOwnProperty(a)&&u[a]!==d[a]&&(n||(n={}),n[a]=d[a])}else n||(o||(o=[]),o.push(p,n)),n=d;else p==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,u=u?u.__html:void 0,d!=null&&u!==d&&(o=o||[]).push(p,d)):p==="children"?typeof d!="string"&&typeof d!="number"||(o=o||[]).push(p,""+d):p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&(Xu.hasOwnProperty(p)?(d!=null&&p==="onScroll"&&ht("scroll",t),o||u===d||(o=[])):(o=o||[]).push(p,d))}n&&(o=o||[]).push("style",n);var p=o;(e.updateQueue=p)&&(e.flags|=4)}};tE=function(t,e,n,r){n!==r&&(e.flags|=4)};function mu(t,e){if(!_t)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function an(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function oC(t,e,n){var r=e.pendingProps;switch(y_(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return an(e),null;case 1:return Un(e.type)&&Md(),an(e),null;case 3:return r=e.stateNode,yl(),dt(Fn),dt(gn),S_(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Dh(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Lr!==null&&(dg(Lr),Lr=null))),ig(t,e),an(e),null;case 5:k_(e);var i=Lo(hc.current);if(n=e.type,t!==null&&e.stateNode!=null)eE(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ne(166));return an(e),null}if(t=Lo(ti.current),Dh(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[Qr]=e,r[uc]=o,t=(e.mode&1)!==0,n){case"dialog":ht("cancel",r),ht("close",r);break;case"iframe":case"object":case"embed":ht("load",r);break;case"video":case"audio":for(i=0;i<Pu.length;i++)ht(Pu[i],r);break;case"source":ht("error",r);break;case"img":case"image":case"link":ht("error",r),ht("load",r);break;case"details":ht("toggle",r);break;case"input":Qv(r,o),ht("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},ht("invalid",r);break;case"textarea":Jv(r,o),ht("invalid",r)}Nm(n,o),i=null;for(var a in o)if(o.hasOwnProperty(a)){var u=o[a];a==="children"?typeof u=="string"?r.textContent!==u&&(o.suppressHydrationWarning!==!0&&Lh(r.textContent,u,t),i=["children",u]):typeof u=="number"&&r.textContent!==""+u&&(o.suppressHydrationWarning!==!0&&Lh(r.textContent,u,t),i=["children",""+u]):Xu.hasOwnProperty(a)&&u!=null&&a==="onScroll"&&ht("scroll",r)}switch(n){case"input":Ih(r),Yv(r,o,!0);break;case"textarea":Ih(r),Xv(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=jd)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Ab(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[Qr]=e,t[uc]=r,XT(t,e,!1,!1),e.stateNode=t;e:{switch(a=Rm(n,r),n){case"dialog":ht("cancel",t),ht("close",t),i=r;break;case"iframe":case"object":case"embed":ht("load",t),i=r;break;case"video":case"audio":for(i=0;i<Pu.length;i++)ht(Pu[i],t);i=r;break;case"source":ht("error",t),i=r;break;case"img":case"image":case"link":ht("error",t),ht("load",t),i=r;break;case"details":ht("toggle",t),i=r;break;case"input":Qv(t,r),i=km(t,r),ht("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=kt({},r,{value:void 0}),ht("invalid",t);break;case"textarea":Jv(t,r),i=Am(t,r),ht("invalid",t);break;default:i=r}Nm(n,i),u=i;for(o in u)if(u.hasOwnProperty(o)){var d=u[o];o==="style"?Rb(t,d):o==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,d!=null&&Cb(t,d)):o==="children"?typeof d=="string"?(n!=="textarea"||d!=="")&&ec(t,d):typeof d=="number"&&ec(t,""+d):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Xu.hasOwnProperty(o)?d!=null&&o==="onScroll"&&ht("scroll",t):d!=null&&r_(t,o,d,a))}switch(n){case"input":Ih(t),Yv(t,r,!1);break;case"textarea":Ih(t),Xv(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Zs(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?rl(t,!!r.multiple,o,!1):r.defaultValue!=null&&rl(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=jd)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return an(e),null;case 6:if(t&&e.stateNode!=null)tE(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ne(166));if(n=Lo(hc.current),Lo(ti.current),Dh(e)){if(r=e.stateNode,n=e.memoizedProps,r[Qr]=e,(o=r.nodeValue!==n)&&(t=Qn,t!==null))switch(t.tag){case 3:Lh(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Lh(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Qr]=e,e.stateNode=r}return an(e),null;case 13:if(dt(Tt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(_t&&Gn!==null&&e.mode&1&&!(e.flags&128))vT(),gl(),e.flags|=98560,o=!1;else if(o=Dh(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(ne(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(ne(317));o[Qr]=e}else gl(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;an(e),o=!1}else Lr!==null&&(dg(Lr),Lr=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Tt.current&1?Ht===0&&(Ht=3):F_())),e.updateQueue!==null&&(e.flags|=4),an(e),null);case 4:return yl(),ig(t,e),t===null&&ac(e.stateNode.containerInfo),an(e),null;case 10:return b_(e.type._context),an(e),null;case 17:return Un(e.type)&&Md(),an(e),null;case 19:if(dt(Tt),o=e.memoizedState,o===null)return an(e),null;if(r=(e.flags&128)!==0,a=o.rendering,a===null)if(r)mu(o,!1);else{if(Ht!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=qd(t),a!==null){for(e.flags|=128,mu(o,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,a=o.alternate,a===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=a.childLanes,o.lanes=a.lanes,o.child=a.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=a.memoizedProps,o.memoizedState=a.memoizedState,o.updateQueue=a.updateQueue,o.type=a.type,t=a.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return lt(Tt,Tt.current&1|2),e.child}t=t.sibling}o.tail!==null&&jt()>wl&&(e.flags|=128,r=!0,mu(o,!1),e.lanes=4194304)}else{if(!r)if(t=qd(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),mu(o,!0),o.tail===null&&o.tailMode==="hidden"&&!a.alternate&&!_t)return an(e),null}else 2*jt()-o.renderingStartTime>wl&&n!==1073741824&&(e.flags|=128,r=!0,mu(o,!1),e.lanes=4194304);o.isBackwards?(a.sibling=e.child,e.child=a):(n=o.last,n!==null?n.sibling=a:e.child=a,o.last=a)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=jt(),e.sibling=null,n=Tt.current,lt(Tt,r?n&1|2:n&1),e):(an(e),null);case 22:case 23:return V_(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Wn&1073741824&&(an(e),e.subtreeFlags&6&&(e.flags|=8192)):an(e),null;case 24:return null;case 25:return null}throw Error(ne(156,e.tag))}function aC(t,e){switch(y_(e),e.tag){case 1:return Un(e.type)&&Md(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return yl(),dt(Fn),dt(gn),S_(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return k_(e),null;case 13:if(dt(Tt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ne(340));gl()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return dt(Tt),null;case 4:return yl(),null;case 10:return b_(e.type._context),null;case 22:case 23:return V_(),null;case 24:return null;default:return null}}var Oh=!1,cn=!1,lC=typeof WeakSet=="function"?WeakSet:Set,he=null;function el(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Pt(t,e,r)}else n.current=null}function sg(t,e,n){try{n()}catch(r){Pt(t,e,r)}}var z0=!1;function uC(t,e){if(zm=Rd,t=oT(),g_(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var a=0,u=-1,d=-1,p=0,_=0,w=t,x=null;t:for(;;){for(var k;w!==n||i!==0&&w.nodeType!==3||(u=a+i),w!==o||r!==0&&w.nodeType!==3||(d=a+r),w.nodeType===3&&(a+=w.nodeValue.length),(k=w.firstChild)!==null;)x=w,w=k;for(;;){if(w===t)break t;if(x===n&&++p===i&&(u=a),x===o&&++_===r&&(d=a),(k=w.nextSibling)!==null)break;w=x,x=w.parentNode}w=k}n=u===-1||d===-1?null:{start:u,end:d}}else n=null}n=n||{start:0,end:0}}else n=null;for(qm={focusedElem:t,selectionRange:n},Rd=!1,he=e;he!==null;)if(e=he,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,he=t;else for(;he!==null;){e=he;try{var P=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(P!==null){var j=P.memoizedProps,B=P.memoizedState,R=e.stateNode,S=R.getSnapshotBeforeUpdate(e.elementType===e.type?j:Nr(e.type,j),B);R.__reactInternalSnapshotBeforeUpdate=S}break;case 3:var N=e.stateNode.containerInfo;N.nodeType===1?N.textContent="":N.nodeType===9&&N.documentElement&&N.removeChild(N.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ne(163))}}catch(z){Pt(e,e.return,z)}if(t=e.sibling,t!==null){t.return=e.return,he=t;break}he=e.return}return P=z0,z0=!1,P}function zu(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var o=i.destroy;i.destroy=void 0,o!==void 0&&sg(e,n,o)}i=i.next}while(i!==r)}}function Rf(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function og(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function nE(t){var e=t.alternate;e!==null&&(t.alternate=null,nE(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Qr],delete e[uc],delete e[Wm],delete e[HA],delete e[WA])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function rE(t){return t.tag===5||t.tag===3||t.tag===4}function q0(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||rE(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function ag(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=jd));else if(r!==4&&(t=t.child,t!==null))for(ag(t,e,n),t=t.sibling;t!==null;)ag(t,e,n),t=t.sibling}function lg(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(lg(t,e,n),t=t.sibling;t!==null;)lg(t,e,n),t=t.sibling}var tn=null,Rr=!1;function ys(t,e,n){for(n=n.child;n!==null;)iE(t,e,n),n=n.sibling}function iE(t,e,n){if(ei&&typeof ei.onCommitFiberUnmount=="function")try{ei.onCommitFiberUnmount(Ef,n)}catch{}switch(n.tag){case 5:cn||el(n,e);case 6:var r=tn,i=Rr;tn=null,ys(t,e,n),tn=r,Rr=i,tn!==null&&(Rr?(t=tn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):tn.removeChild(n.stateNode));break;case 18:tn!==null&&(Rr?(t=tn,n=n.stateNode,t.nodeType===8?qp(t.parentNode,n):t.nodeType===1&&qp(t,n),ic(t)):qp(tn,n.stateNode));break;case 4:r=tn,i=Rr,tn=n.stateNode.containerInfo,Rr=!0,ys(t,e,n),tn=r,Rr=i;break;case 0:case 11:case 14:case 15:if(!cn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,a=o.destroy;o=o.tag,a!==void 0&&(o&2||o&4)&&sg(n,e,a),i=i.next}while(i!==r)}ys(t,e,n);break;case 1:if(!cn&&(el(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(u){Pt(n,e,u)}ys(t,e,n);break;case 21:ys(t,e,n);break;case 22:n.mode&1?(cn=(r=cn)||n.memoizedState!==null,ys(t,e,n),cn=r):ys(t,e,n);break;default:ys(t,e,n)}}function $0(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new lC),e.forEach(function(r){var i=yC.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Pr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var o=t,a=e,u=a;e:for(;u!==null;){switch(u.tag){case 5:tn=u.stateNode,Rr=!1;break e;case 3:tn=u.stateNode.containerInfo,Rr=!0;break e;case 4:tn=u.stateNode.containerInfo,Rr=!0;break e}u=u.return}if(tn===null)throw Error(ne(160));iE(o,a,i),tn=null,Rr=!1;var d=i.alternate;d!==null&&(d.return=null),i.return=null}catch(p){Pt(i,e,p)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)sE(e,t),e=e.sibling}function sE(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Pr(e,t),Kr(t),r&4){try{zu(3,t,t.return),Rf(3,t)}catch(j){Pt(t,t.return,j)}try{zu(5,t,t.return)}catch(j){Pt(t,t.return,j)}}break;case 1:Pr(e,t),Kr(t),r&512&&n!==null&&el(n,n.return);break;case 5:if(Pr(e,t),Kr(t),r&512&&n!==null&&el(n,n.return),t.flags&32){var i=t.stateNode;try{ec(i,"")}catch(j){Pt(t,t.return,j)}}if(r&4&&(i=t.stateNode,i!=null)){var o=t.memoizedProps,a=n!==null?n.memoizedProps:o,u=t.type,d=t.updateQueue;if(t.updateQueue=null,d!==null)try{u==="input"&&o.type==="radio"&&o.name!=null&&Sb(i,o),Rm(u,a);var p=Rm(u,o);for(a=0;a<d.length;a+=2){var _=d[a],w=d[a+1];_==="style"?Rb(i,w):_==="dangerouslySetInnerHTML"?Cb(i,w):_==="children"?ec(i,w):r_(i,_,w,p)}switch(u){case"input":Sm(i,o);break;case"textarea":Pb(i,o);break;case"select":var x=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var k=o.value;k!=null?rl(i,!!o.multiple,k,!1):x!==!!o.multiple&&(o.defaultValue!=null?rl(i,!!o.multiple,o.defaultValue,!0):rl(i,!!o.multiple,o.multiple?[]:"",!1))}i[uc]=o}catch(j){Pt(t,t.return,j)}}break;case 6:if(Pr(e,t),Kr(t),r&4){if(t.stateNode===null)throw Error(ne(162));i=t.stateNode,o=t.memoizedProps;try{i.nodeValue=o}catch(j){Pt(t,t.return,j)}}break;case 3:if(Pr(e,t),Kr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{ic(e.containerInfo)}catch(j){Pt(t,t.return,j)}break;case 4:Pr(e,t),Kr(t);break;case 13:Pr(e,t),Kr(t),i=t.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(M_=jt())),r&4&&$0(t);break;case 22:if(_=n!==null&&n.memoizedState!==null,t.mode&1?(cn=(p=cn)||_,Pr(e,t),cn=p):Pr(e,t),Kr(t),r&8192){if(p=t.memoizedState!==null,(t.stateNode.isHidden=p)&&!_&&t.mode&1)for(he=t,_=t.child;_!==null;){for(w=he=_;he!==null;){switch(x=he,k=x.child,x.tag){case 0:case 11:case 14:case 15:zu(4,x,x.return);break;case 1:el(x,x.return);var P=x.stateNode;if(typeof P.componentWillUnmount=="function"){r=x,n=x.return;try{e=r,P.props=e.memoizedProps,P.state=e.memoizedState,P.componentWillUnmount()}catch(j){Pt(r,n,j)}}break;case 5:el(x,x.return);break;case 22:if(x.memoizedState!==null){W0(w);continue}}k!==null?(k.return=x,he=k):W0(w)}_=_.sibling}e:for(_=null,w=t;;){if(w.tag===5){if(_===null){_=w;try{i=w.stateNode,p?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(u=w.stateNode,d=w.memoizedProps.style,a=d!=null&&d.hasOwnProperty("display")?d.display:null,u.style.display=Nb("display",a))}catch(j){Pt(t,t.return,j)}}}else if(w.tag===6){if(_===null)try{w.stateNode.nodeValue=p?"":w.memoizedProps}catch(j){Pt(t,t.return,j)}}else if((w.tag!==22&&w.tag!==23||w.memoizedState===null||w===t)&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===t)break e;for(;w.sibling===null;){if(w.return===null||w.return===t)break e;_===w&&(_=null),w=w.return}_===w&&(_=null),w.sibling.return=w.return,w=w.sibling}}break;case 19:Pr(e,t),Kr(t),r&4&&$0(t);break;case 21:break;default:Pr(e,t),Kr(t)}}function Kr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(rE(n)){var r=n;break e}n=n.return}throw Error(ne(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(ec(i,""),r.flags&=-33);var o=q0(t);lg(t,o,i);break;case 3:case 4:var a=r.stateNode.containerInfo,u=q0(t);ag(t,u,a);break;default:throw Error(ne(161))}}catch(d){Pt(t,t.return,d)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function cC(t,e,n){he=t,oE(t)}function oE(t,e,n){for(var r=(t.mode&1)!==0;he!==null;){var i=he,o=i.child;if(i.tag===22&&r){var a=i.memoizedState!==null||Oh;if(!a){var u=i.alternate,d=u!==null&&u.memoizedState!==null||cn;u=Oh;var p=cn;if(Oh=a,(cn=d)&&!p)for(he=i;he!==null;)a=he,d=a.child,a.tag===22&&a.memoizedState!==null?G0(i):d!==null?(d.return=a,he=d):G0(i);for(;o!==null;)he=o,oE(o),o=o.sibling;he=i,Oh=u,cn=p}H0(t)}else i.subtreeFlags&8772&&o!==null?(o.return=i,he=o):H0(t)}}function H0(t){for(;he!==null;){var e=he;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:cn||Rf(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!cn)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Nr(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&A0(e,o,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}A0(e,a,n)}break;case 5:var u=e.stateNode;if(n===null&&e.flags&4){n=u;var d=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":d.autoFocus&&n.focus();break;case"img":d.src&&(n.src=d.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var p=e.alternate;if(p!==null){var _=p.memoizedState;if(_!==null){var w=_.dehydrated;w!==null&&ic(w)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ne(163))}cn||e.flags&512&&og(e)}catch(x){Pt(e,e.return,x)}}if(e===t){he=null;break}if(n=e.sibling,n!==null){n.return=e.return,he=n;break}he=e.return}}function W0(t){for(;he!==null;){var e=he;if(e===t){he=null;break}var n=e.sibling;if(n!==null){n.return=e.return,he=n;break}he=e.return}}function G0(t){for(;he!==null;){var e=he;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Rf(4,e)}catch(d){Pt(e,n,d)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(d){Pt(e,i,d)}}var o=e.return;try{og(e)}catch(d){Pt(e,o,d)}break;case 5:var a=e.return;try{og(e)}catch(d){Pt(e,a,d)}}}catch(d){Pt(e,e.return,d)}if(e===t){he=null;break}var u=e.sibling;if(u!==null){u.return=e.return,he=u;break}he=e.return}}var hC=Math.ceil,Wd=Gi.ReactCurrentDispatcher,D_=Gi.ReactCurrentOwner,pr=Gi.ReactCurrentBatchConfig,Ge=0,Xt=null,zt=null,rn=0,Wn=0,tl=to(0),Ht=0,mc=null,$o=0,Lf=0,j_=0,qu=null,Dn=null,M_=0,wl=1/0,Ii=null,Gd=!1,ug=null,zs=null,Vh=!1,Ds=null,Kd=0,$u=0,cg=null,ld=-1,ud=0;function En(){return Ge&6?jt():ld!==-1?ld:ld=jt()}function qs(t){return t.mode&1?Ge&2&&rn!==0?rn&-rn:KA.transition!==null?(ud===0&&(ud=$b()),ud):(t=et,t!==0||(t=window.event,t=t===void 0?16:Yb(t.type)),t):1}function Or(t,e,n,r){if(50<$u)throw $u=0,cg=null,Error(ne(185));Uc(t,n,r),(!(Ge&2)||t!==Xt)&&(t===Xt&&(!(Ge&2)&&(Lf|=n),Ht===4&&ks(t,rn)),Bn(t,r),n===1&&Ge===0&&!(e.mode&1)&&(wl=jt()+500,Af&&no()))}function Bn(t,e){var n=t.callbackNode;K1(t,e);var r=Nd(t,t===Xt?rn:0);if(r===0)n!==null&&n0(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&n0(n),e===1)t.tag===0?GA(K0.bind(null,t)):gT(K0.bind(null,t)),qA(function(){!(Ge&6)&&no()}),n=null;else{switch(Hb(r)){case 1:n=l_;break;case 4:n=zb;break;case 16:n=Cd;break;case 536870912:n=qb;break;default:n=Cd}n=pE(n,aE.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function aE(t,e){if(ld=-1,ud=0,Ge&6)throw Error(ne(327));var n=t.callbackNode;if(ll()&&t.callbackNode!==n)return null;var r=Nd(t,t===Xt?rn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Zd(t,r);else{e=r;var i=Ge;Ge|=2;var o=uE();(Xt!==t||rn!==e)&&(Ii=null,wl=jt()+500,Mo(t,e));do try{pC();break}catch(u){lE(t,u)}while(!0);x_(),Wd.current=o,Ge=i,zt!==null?e=0:(Xt=null,rn=0,e=Ht)}if(e!==0){if(e===2&&(i=Om(t),i!==0&&(r=i,e=hg(t,i))),e===1)throw n=mc,Mo(t,0),ks(t,r),Bn(t,jt()),n;if(e===6)ks(t,r);else{if(i=t.current.alternate,!(r&30)&&!dC(i)&&(e=Zd(t,r),e===2&&(o=Om(t),o!==0&&(r=o,e=hg(t,o))),e===1))throw n=mc,Mo(t,0),ks(t,r),Bn(t,jt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(ne(345));case 2:To(t,Dn,Ii);break;case 3:if(ks(t,r),(r&130023424)===r&&(e=M_+500-jt(),10<e)){if(Nd(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){En(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Hm(To.bind(null,t,Dn,Ii),e);break}To(t,Dn,Ii);break;case 4:if(ks(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var a=31-Mr(r);o=1<<a,a=e[a],a>i&&(i=a),r&=~o}if(r=i,r=jt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*hC(r/1960))-r,10<r){t.timeoutHandle=Hm(To.bind(null,t,Dn,Ii),r);break}To(t,Dn,Ii);break;case 5:To(t,Dn,Ii);break;default:throw Error(ne(329))}}}return Bn(t,jt()),t.callbackNode===n?aE.bind(null,t):null}function hg(t,e){var n=qu;return t.current.memoizedState.isDehydrated&&(Mo(t,e).flags|=256),t=Zd(t,e),t!==2&&(e=Dn,Dn=n,e!==null&&dg(e)),t}function dg(t){Dn===null?Dn=t:Dn.push.apply(Dn,t)}function dC(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!Ur(o(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ks(t,e){for(e&=~j_,e&=~Lf,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Mr(e),r=1<<n;t[n]=-1,e&=~r}}function K0(t){if(Ge&6)throw Error(ne(327));ll();var e=Nd(t,0);if(!(e&1))return Bn(t,jt()),null;var n=Zd(t,e);if(t.tag!==0&&n===2){var r=Om(t);r!==0&&(e=r,n=hg(t,r))}if(n===1)throw n=mc,Mo(t,0),ks(t,e),Bn(t,jt()),n;if(n===6)throw Error(ne(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,To(t,Dn,Ii),Bn(t,jt()),null}function O_(t,e){var n=Ge;Ge|=1;try{return t(e)}finally{Ge=n,Ge===0&&(wl=jt()+500,Af&&no())}}function Ho(t){Ds!==null&&Ds.tag===0&&!(Ge&6)&&ll();var e=Ge;Ge|=1;var n=pr.transition,r=et;try{if(pr.transition=null,et=1,t)return t()}finally{et=r,pr.transition=n,Ge=e,!(Ge&6)&&no()}}function V_(){Wn=tl.current,dt(tl)}function Mo(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,zA(n)),zt!==null)for(n=zt.return;n!==null;){var r=n;switch(y_(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Md();break;case 3:yl(),dt(Fn),dt(gn),S_();break;case 5:k_(r);break;case 4:yl();break;case 13:dt(Tt);break;case 19:dt(Tt);break;case 10:b_(r.type._context);break;case 22:case 23:V_()}n=n.return}if(Xt=t,zt=t=$s(t.current,null),rn=Wn=e,Ht=0,mc=null,j_=Lf=$o=0,Dn=qu=null,Ro!==null){for(e=0;e<Ro.length;e++)if(n=Ro[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,o=n.pending;if(o!==null){var a=o.next;o.next=i,r.next=a}n.pending=r}Ro=null}return t}function lE(t,e){do{var n=zt;try{if(x_(),sd.current=Hd,$d){for(var r=It.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}$d=!1}if(qo=0,Yt=$t=It=null,Bu=!1,dc=0,D_.current=null,n===null||n.return===null){Ht=1,mc=e,zt=null;break}e:{var o=t,a=n.return,u=n,d=e;if(e=rn,u.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){var p=d,_=u,w=_.tag;if(!(_.mode&1)&&(w===0||w===11||w===15)){var x=_.alternate;x?(_.updateQueue=x.updateQueue,_.memoizedState=x.memoizedState,_.lanes=x.lanes):(_.updateQueue=null,_.memoizedState=null)}var k=j0(a);if(k!==null){k.flags&=-257,M0(k,a,u,o,e),k.mode&1&&D0(o,p,e),e=k,d=p;var P=e.updateQueue;if(P===null){var j=new Set;j.add(d),e.updateQueue=j}else P.add(d);break e}else{if(!(e&1)){D0(o,p,e),F_();break e}d=Error(ne(426))}}else if(_t&&u.mode&1){var B=j0(a);if(B!==null){!(B.flags&65536)&&(B.flags|=256),M0(B,a,u,o,e),v_(vl(d,u));break e}}o=d=vl(d,u),Ht!==4&&(Ht=2),qu===null?qu=[o]:qu.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var R=HT(o,d,e);P0(o,R);break e;case 1:u=d;var S=o.type,N=o.stateNode;if(!(o.flags&128)&&(typeof S.getDerivedStateFromError=="function"||N!==null&&typeof N.componentDidCatch=="function"&&(zs===null||!zs.has(N)))){o.flags|=65536,e&=-e,o.lanes|=e;var z=WT(o,u,e);P0(o,z);break e}}o=o.return}while(o!==null)}hE(n)}catch(G){e=G,zt===n&&n!==null&&(zt=n=n.return);continue}break}while(!0)}function uE(){var t=Wd.current;return Wd.current=Hd,t===null?Hd:t}function F_(){(Ht===0||Ht===3||Ht===2)&&(Ht=4),Xt===null||!($o&268435455)&&!(Lf&268435455)||ks(Xt,rn)}function Zd(t,e){var n=Ge;Ge|=2;var r=uE();(Xt!==t||rn!==e)&&(Ii=null,Mo(t,e));do try{fC();break}catch(i){lE(t,i)}while(!0);if(x_(),Ge=n,Wd.current=r,zt!==null)throw Error(ne(261));return Xt=null,rn=0,Ht}function fC(){for(;zt!==null;)cE(zt)}function pC(){for(;zt!==null&&!F1();)cE(zt)}function cE(t){var e=fE(t.alternate,t,Wn);t.memoizedProps=t.pendingProps,e===null?hE(t):zt=e,D_.current=null}function hE(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=aC(n,e),n!==null){n.flags&=32767,zt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ht=6,zt=null;return}}else if(n=oC(n,e,Wn),n!==null){zt=n;return}if(e=e.sibling,e!==null){zt=e;return}zt=e=t}while(e!==null);Ht===0&&(Ht=5)}function To(t,e,n){var r=et,i=pr.transition;try{pr.transition=null,et=1,mC(t,e,n,r)}finally{pr.transition=i,et=r}return null}function mC(t,e,n,r){do ll();while(Ds!==null);if(Ge&6)throw Error(ne(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ne(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(Z1(t,o),t===Xt&&(zt=Xt=null,rn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Vh||(Vh=!0,pE(Cd,function(){return ll(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=pr.transition,pr.transition=null;var a=et;et=1;var u=Ge;Ge|=4,D_.current=null,uC(t,n),sE(n,t),jA(qm),Rd=!!zm,qm=zm=null,t.current=n,cC(n),U1(),Ge=u,et=a,pr.transition=o}else t.current=n;if(Vh&&(Vh=!1,Ds=t,Kd=i),o=t.pendingLanes,o===0&&(zs=null),q1(n.stateNode),Bn(t,jt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Gd)throw Gd=!1,t=ug,ug=null,t;return Kd&1&&t.tag!==0&&ll(),o=t.pendingLanes,o&1?t===cg?$u++:($u=0,cg=t):$u=0,no(),null}function ll(){if(Ds!==null){var t=Hb(Kd),e=pr.transition,n=et;try{if(pr.transition=null,et=16>t?16:t,Ds===null)var r=!1;else{if(t=Ds,Ds=null,Kd=0,Ge&6)throw Error(ne(331));var i=Ge;for(Ge|=4,he=t.current;he!==null;){var o=he,a=o.child;if(he.flags&16){var u=o.deletions;if(u!==null){for(var d=0;d<u.length;d++){var p=u[d];for(he=p;he!==null;){var _=he;switch(_.tag){case 0:case 11:case 15:zu(8,_,o)}var w=_.child;if(w!==null)w.return=_,he=w;else for(;he!==null;){_=he;var x=_.sibling,k=_.return;if(nE(_),_===p){he=null;break}if(x!==null){x.return=k,he=x;break}he=k}}}var P=o.alternate;if(P!==null){var j=P.child;if(j!==null){P.child=null;do{var B=j.sibling;j.sibling=null,j=B}while(j!==null)}}he=o}}if(o.subtreeFlags&2064&&a!==null)a.return=o,he=a;else e:for(;he!==null;){if(o=he,o.flags&2048)switch(o.tag){case 0:case 11:case 15:zu(9,o,o.return)}var R=o.sibling;if(R!==null){R.return=o.return,he=R;break e}he=o.return}}var S=t.current;for(he=S;he!==null;){a=he;var N=a.child;if(a.subtreeFlags&2064&&N!==null)N.return=a,he=N;else e:for(a=S;he!==null;){if(u=he,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:Rf(9,u)}}catch(G){Pt(u,u.return,G)}if(u===a){he=null;break e}var z=u.sibling;if(z!==null){z.return=u.return,he=z;break e}he=u.return}}if(Ge=i,no(),ei&&typeof ei.onPostCommitFiberRoot=="function")try{ei.onPostCommitFiberRoot(Ef,t)}catch{}r=!0}return r}finally{et=n,pr.transition=e}}return!1}function Z0(t,e,n){e=vl(n,e),e=HT(t,e,1),t=Bs(t,e,1),e=En(),t!==null&&(Uc(t,1,e),Bn(t,e))}function Pt(t,e,n){if(t.tag===3)Z0(t,t,n);else for(;e!==null;){if(e.tag===3){Z0(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(zs===null||!zs.has(r))){t=vl(n,t),t=WT(e,t,1),e=Bs(e,t,1),t=En(),e!==null&&(Uc(e,1,t),Bn(e,t));break}}e=e.return}}function gC(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=En(),t.pingedLanes|=t.suspendedLanes&n,Xt===t&&(rn&n)===n&&(Ht===4||Ht===3&&(rn&130023424)===rn&&500>jt()-M_?Mo(t,0):j_|=n),Bn(t,e)}function dE(t,e){e===0&&(t.mode&1?(e=Ph,Ph<<=1,!(Ph&130023424)&&(Ph=4194304)):e=1);var n=En();t=Bi(t,e),t!==null&&(Uc(t,e,n),Bn(t,n))}function _C(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),dE(t,n)}function yC(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ne(314))}r!==null&&r.delete(e),dE(t,n)}var fE;fE=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Fn.current)Mn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Mn=!1,sC(t,e,n);Mn=!!(t.flags&131072)}else Mn=!1,_t&&e.flags&1048576&&_T(e,Fd,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;ad(t,e),t=e.pendingProps;var i=ml(e,gn.current);al(e,n),i=A_(null,e,r,t,i,n);var o=C_();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Un(r)?(o=!0,Od(e)):o=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,E_(e),i.updater=Nf,e.stateNode=i,i._reactInternals=e,Jm(e,r,t,n),e=tg(null,e,r,!0,o,n)):(e.tag=0,_t&&o&&__(e),bn(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(ad(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=wC(r),t=Nr(r,t),i){case 0:e=eg(null,e,r,t,n);break e;case 1:e=F0(null,e,r,t,n);break e;case 11:e=O0(null,e,r,t,n);break e;case 14:e=V0(null,e,r,Nr(r.type,t),n);break e}throw Error(ne(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Nr(r,i),eg(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Nr(r,i),F0(t,e,r,i,n);case 3:e:{if(QT(e),t===null)throw Error(ne(387));r=e.pendingProps,o=e.memoizedState,i=o.element,TT(t,e),zd(e,r,null,n);var a=e.memoizedState;if(r=a.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){i=vl(Error(ne(423)),e),e=U0(t,e,r,n,i);break e}else if(r!==i){i=vl(Error(ne(424)),e),e=U0(t,e,r,n,i);break e}else for(Gn=Us(e.stateNode.containerInfo.firstChild),Qn=e,_t=!0,Lr=null,n=xT(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(gl(),r===i){e=zi(t,e,n);break e}bn(t,e,r,n)}e=e.child}return e;case 5:return ET(e),t===null&&Zm(e),r=e.type,i=e.pendingProps,o=t!==null?t.memoizedProps:null,a=i.children,$m(r,i)?a=null:o!==null&&$m(r,o)&&(e.flags|=32),ZT(t,e),bn(t,e,a,n),e.child;case 6:return t===null&&Zm(e),null;case 13:return YT(t,e,n);case 4:return I_(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=_l(e,null,r,n):bn(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Nr(r,i),O0(t,e,r,i,n);case 7:return bn(t,e,e.pendingProps,n),e.child;case 8:return bn(t,e,e.pendingProps.children,n),e.child;case 12:return bn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,o=e.memoizedProps,a=i.value,lt(Ud,r._currentValue),r._currentValue=a,o!==null)if(Ur(o.value,a)){if(o.children===i.children&&!Fn.current){e=zi(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var u=o.dependencies;if(u!==null){a=o.child;for(var d=u.firstContext;d!==null;){if(d.context===r){if(o.tag===1){d=Mi(-1,n&-n),d.tag=2;var p=o.updateQueue;if(p!==null){p=p.shared;var _=p.pending;_===null?d.next=d:(d.next=_.next,_.next=d),p.pending=d}}o.lanes|=n,d=o.alternate,d!==null&&(d.lanes|=n),Qm(o.return,n,e),u.lanes|=n;break}d=d.next}}else if(o.tag===10)a=o.type===e.type?null:o.child;else if(o.tag===18){if(a=o.return,a===null)throw Error(ne(341));a.lanes|=n,u=a.alternate,u!==null&&(u.lanes|=n),Qm(a,n,e),a=o.sibling}else a=o.child;if(a!==null)a.return=o;else for(a=o;a!==null;){if(a===e){a=null;break}if(o=a.sibling,o!==null){o.return=a.return,a=o;break}a=a.return}o=a}bn(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,al(e,n),i=mr(i),r=r(i),e.flags|=1,bn(t,e,r,n),e.child;case 14:return r=e.type,i=Nr(r,e.pendingProps),i=Nr(r.type,i),V0(t,e,r,i,n);case 15:return GT(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Nr(r,i),ad(t,e),e.tag=1,Un(r)?(t=!0,Od(e)):t=!1,al(e,n),$T(e,r,i),Jm(e,r,i,n),tg(null,e,r,!0,t,n);case 19:return JT(t,e,n);case 22:return KT(t,e,n)}throw Error(ne(156,e.tag))};function pE(t,e){return Bb(t,e)}function vC(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fr(t,e,n,r){return new vC(t,e,n,r)}function U_(t){return t=t.prototype,!(!t||!t.isReactComponent)}function wC(t){if(typeof t=="function")return U_(t)?1:0;if(t!=null){if(t=t.$$typeof,t===s_)return 11;if(t===o_)return 14}return 2}function $s(t,e){var n=t.alternate;return n===null?(n=fr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function cd(t,e,n,r,i,o){var a=2;if(r=t,typeof t=="function")U_(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Ha:return Oo(n.children,i,o,e);case i_:a=8,i|=8;break;case bm:return t=fr(12,n,e,i|2),t.elementType=bm,t.lanes=o,t;case Tm:return t=fr(13,n,e,i),t.elementType=Tm,t.lanes=o,t;case Em:return t=fr(19,n,e,i),t.elementType=Em,t.lanes=o,t;case Eb:return Df(n,i,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case bb:a=10;break e;case Tb:a=9;break e;case s_:a=11;break e;case o_:a=14;break e;case Ts:a=16,r=null;break e}throw Error(ne(130,t==null?t:typeof t,""))}return e=fr(a,n,e,i),e.elementType=t,e.type=r,e.lanes=o,e}function Oo(t,e,n,r){return t=fr(7,t,r,e),t.lanes=n,t}function Df(t,e,n,r){return t=fr(22,t,r,e),t.elementType=Eb,t.lanes=n,t.stateNode={isHidden:!1},t}function Yp(t,e,n){return t=fr(6,t,null,e),t.lanes=n,t}function Jp(t,e,n){return e=fr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function xC(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Rp(0),this.expirationTimes=Rp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Rp(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function B_(t,e,n,r,i,o,a,u,d){return t=new xC(t,e,n,u,d),e===1?(e=1,o===!0&&(e|=8)):e=0,o=fr(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},E_(o),t}function bC(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:$a,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function mE(t){if(!t)return Qs;t=t._reactInternals;e:{if(oa(t)!==t||t.tag!==1)throw Error(ne(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Un(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ne(171))}if(t.tag===1){var n=t.type;if(Un(n))return mT(t,n,e)}return e}function gE(t,e,n,r,i,o,a,u,d){return t=B_(n,r,!0,t,i,o,a,u,d),t.context=mE(null),n=t.current,r=En(),i=qs(n),o=Mi(r,i),o.callback=e??null,Bs(n,o,i),t.current.lanes=i,Uc(t,i,r),Bn(t,r),t}function jf(t,e,n,r){var i=e.current,o=En(),a=qs(i);return n=mE(n),e.context===null?e.context=n:e.pendingContext=n,e=Mi(o,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Bs(i,e,a),t!==null&&(Or(t,i,a,o),id(t,i,a)),a}function Qd(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Q0(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function z_(t,e){Q0(t,e),(t=t.alternate)&&Q0(t,e)}function TC(){return null}var _E=typeof reportError=="function"?reportError:function(t){console.error(t)};function q_(t){this._internalRoot=t}Mf.prototype.render=q_.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ne(409));jf(t,e,null,null)};Mf.prototype.unmount=q_.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ho(function(){jf(null,t,null,null)}),e[Ui]=null}};function Mf(t){this._internalRoot=t}Mf.prototype.unstable_scheduleHydration=function(t){if(t){var e=Kb();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Is.length&&e!==0&&e<Is[n].priority;n++);Is.splice(n,0,t),n===0&&Qb(t)}};function $_(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Of(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Y0(){}function EC(t,e,n,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var p=Qd(a);o.call(p)}}var a=gE(e,r,t,0,null,!1,!1,"",Y0);return t._reactRootContainer=a,t[Ui]=a.current,ac(t.nodeType===8?t.parentNode:t),Ho(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var u=r;r=function(){var p=Qd(d);u.call(p)}}var d=B_(t,0,!1,null,null,!1,!1,"",Y0);return t._reactRootContainer=d,t[Ui]=d.current,ac(t.nodeType===8?t.parentNode:t),Ho(function(){jf(e,d,n,r)}),d}function Vf(t,e,n,r,i){var o=n._reactRootContainer;if(o){var a=o;if(typeof i=="function"){var u=i;i=function(){var d=Qd(a);u.call(d)}}jf(e,a,t,i)}else a=EC(n,e,t,i,r);return Qd(a)}Wb=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Su(e.pendingLanes);n!==0&&(u_(e,n|1),Bn(e,jt()),!(Ge&6)&&(wl=jt()+500,no()))}break;case 13:Ho(function(){var r=Bi(t,1);if(r!==null){var i=En();Or(r,t,1,i)}}),z_(t,1)}};c_=function(t){if(t.tag===13){var e=Bi(t,134217728);if(e!==null){var n=En();Or(e,t,134217728,n)}z_(t,134217728)}};Gb=function(t){if(t.tag===13){var e=qs(t),n=Bi(t,e);if(n!==null){var r=En();Or(n,t,e,r)}z_(t,e)}};Kb=function(){return et};Zb=function(t,e){var n=et;try{return et=t,e()}finally{et=n}};Dm=function(t,e,n){switch(e){case"input":if(Sm(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Pf(r);if(!i)throw Error(ne(90));kb(r),Sm(r,i)}}}break;case"textarea":Pb(t,n);break;case"select":e=n.value,e!=null&&rl(t,!!n.multiple,e,!1)}};jb=O_;Mb=Ho;var IC={usingClientEntryPoint:!1,Events:[zc,Za,Pf,Lb,Db,O_]},gu={findFiberByHostInstance:No,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},kC={bundleType:gu.bundleType,version:gu.version,rendererPackageName:gu.rendererPackageName,rendererConfig:gu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Gi.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Fb(t),t===null?null:t.stateNode},findFiberByHostInstance:gu.findFiberByHostInstance||TC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Fh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Fh.isDisabled&&Fh.supportsFiber)try{Ef=Fh.inject(kC),ei=Fh}catch{}}nr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=IC;nr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!$_(e))throw Error(ne(200));return bC(t,e,null,n)};nr.createRoot=function(t,e){if(!$_(t))throw Error(ne(299));var n=!1,r="",i=_E;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=B_(t,1,!1,null,null,n,!1,r,i),t[Ui]=e.current,ac(t.nodeType===8?t.parentNode:t),new q_(e)};nr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ne(188)):(t=Object.keys(t).join(","),Error(ne(268,t)));return t=Fb(e),t=t===null?null:t.stateNode,t};nr.flushSync=function(t){return Ho(t)};nr.hydrate=function(t,e,n){if(!Of(e))throw Error(ne(200));return Vf(null,t,e,!0,n)};nr.hydrateRoot=function(t,e,n){if(!$_(t))throw Error(ne(405));var r=n!=null&&n.hydratedSources||null,i=!1,o="",a=_E;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=gE(e,null,t,1,n??null,i,!1,o,a),t[Ui]=e.current,ac(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Mf(e)};nr.render=function(t,e,n){if(!Of(e))throw Error(ne(200));return Vf(null,t,e,!1,n)};nr.unmountComponentAtNode=function(t){if(!Of(t))throw Error(ne(40));return t._reactRootContainer?(Ho(function(){Vf(null,null,t,!1,function(){t._reactRootContainer=null,t[Ui]=null})}),!0):!1};nr.unstable_batchedUpdates=O_;nr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Of(n))throw Error(ne(200));if(t==null||t._reactInternals===void 0)throw Error(ne(38));return Vf(t,e,n,!1,r)};nr.version="18.3.1-next-f1338f8080-20240426";function yE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(yE)}catch(t){console.error(t)}}yE(),yb.exports=nr;var vE=yb.exports,J0=vE;wm.createRoot=J0.createRoot,wm.hydrateRoot=J0.hydrateRoot;var X0={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wE=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},SC=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const o=t[n++];e[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=t[n++],a=t[n++],u=t[n++],d=((i&7)<<18|(o&63)<<12|(a&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(d>>10)),e[r++]=String.fromCharCode(56320+(d&1023))}else{const o=t[n++],a=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|a&63)}}return e.join("")},xE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const o=t[i],a=i+1<t.length,u=a?t[i+1]:0,d=i+2<t.length,p=d?t[i+2]:0,_=o>>2,w=(o&3)<<4|u>>4;let x=(u&15)<<2|p>>6,k=p&63;d||(k=64,a||(x=64)),r.push(n[_],n[w],n[x],n[k])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(wE(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):SC(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const o=n[t.charAt(i++)],u=i<t.length?n[t.charAt(i)]:0;++i;const p=i<t.length?n[t.charAt(i)]:64;++i;const w=i<t.length?n[t.charAt(i)]:64;if(++i,o==null||u==null||p==null||w==null)throw new PC;const x=o<<2|u>>4;if(r.push(x),p!==64){const k=u<<4&240|p>>2;if(r.push(k),w!==64){const P=p<<6&192|w;r.push(P)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class PC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const AC=function(t){const e=wE(t);return xE.encodeByteArray(e,!0)},Yd=function(t){return AC(t).replace(/\./g,"")},bE=function(t){try{return xE.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NC=()=>CC().__FIREBASE_DEFAULTS__,RC=()=>{if(typeof process>"u"||typeof X0>"u")return;const t=X0.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},LC=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&bE(t[1]);return e&&JSON.parse(e)},Ff=()=>{try{return NC()||RC()||LC()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},TE=t=>{var e,n;return(n=(e=Ff())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},EE=t=>{const e=TE(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},IE=()=>{var t;return(t=Ff())===null||t===void 0?void 0:t.config},kE=t=>{var e;return(e=Ff())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jC(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Yd(JSON.stringify(n)),Yd(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function MC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Wt())}function OC(){var t;const e=(t=Ff())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function VC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function FC(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function UC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function BC(){const t=Wt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function SE(){return!OC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function H_(){try{return typeof indexedDB=="object"}catch{return!1}}function PE(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var o;e(((o=i.error)===null||o===void 0?void 0:o.message)||"")}}catch(n){e(n)}})}function zC(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qC="FirebaseError";class vr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=qC,Object.setPrototypeOf(this,vr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,aa.prototype.create)}}class aa{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,o=this.errors[e],a=o?$C(o,r):"Error",u=`${this.serviceName}: ${a} (${i}).`;return new vr(i,u,r)}}function $C(t,e){return t.replace(HC,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const HC=/\{\$([^}]+)}/g;function WC(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function gc(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const o=t[i],a=e[i];if(ew(o)&&ew(a)){if(!gc(o,a))return!1}else if(o!==a)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function ew(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $c(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Au(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,o]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(o)}}),e}function Cu(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function GC(t,e){const n=new KC(t,e);return n.subscribe.bind(n)}class KC{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");ZC(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=Xp),i.error===void 0&&(i.error=Xp),i.complete===void 0&&(i.complete=Xp);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ZC(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Xp(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ze(t){return t&&t._delegate?t._delegate:t}class er{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QC{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new DC;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(JC(e))try{this.getOrInitializeService({instanceIdentifier:Eo})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(e=Eo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Eo){return this.instances.has(e)}getOptions(e=Eo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[o,a]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(o);r===u&&a.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),o=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;o.add(e),this.onInitCallbacks.set(i,o);const a=this.instances.get(i);return a&&e(a,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:YC(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Eo){return this.component?this.component.multipleInstances?e:Eo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function YC(t){return t===Eo?void 0:t}function JC(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new QC(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ze;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ze||(ze={}));const eN={debug:ze.DEBUG,verbose:ze.VERBOSE,info:ze.INFO,warn:ze.WARN,error:ze.ERROR,silent:ze.SILENT},tN=ze.INFO,nN={[ze.DEBUG]:"log",[ze.VERBOSE]:"log",[ze.INFO]:"info",[ze.WARN]:"warn",[ze.ERROR]:"error"},rN=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=nN[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class W_{constructor(e){this.name=e,this._logLevel=tN,this._logHandler=rN,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ze))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?eN[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ze.DEBUG,...e),this._logHandler(this,ze.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ze.VERBOSE,...e),this._logHandler(this,ze.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ze.INFO,...e),this._logHandler(this,ze.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ze.WARN,...e),this._logHandler(this,ze.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ze.ERROR,...e),this._logHandler(this,ze.ERROR,...e)}}const iN=(t,e)=>e.some(n=>t instanceof n);let tw,nw;function sN(){return tw||(tw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function oN(){return nw||(nw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const AE=new WeakMap,fg=new WeakMap,CE=new WeakMap,em=new WeakMap,G_=new WeakMap;function aN(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",o),t.removeEventListener("error",a)},o=()=>{n(Oi(t.result)),i()},a=()=>{r(t.error),i()};t.addEventListener("success",o),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&AE.set(n,t)}).catch(()=>{}),G_.set(e,t),e}function lN(t){if(fg.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",a),t.removeEventListener("abort",a)},o=()=>{n(),i()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",o),t.addEventListener("error",a),t.addEventListener("abort",a)});fg.set(t,e)}let pg={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return fg.get(t);if(e==="objectStoreNames")return t.objectStoreNames||CE.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Oi(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function uN(t){pg=t(pg)}function cN(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(tm(this),e,...n);return CE.set(r,e.sort?e.sort():[e]),Oi(r)}:oN().includes(t)?function(...e){return t.apply(tm(this),e),Oi(AE.get(this))}:function(...e){return Oi(t.apply(tm(this),e))}}function hN(t){return typeof t=="function"?cN(t):(t instanceof IDBTransaction&&lN(t),iN(t,sN())?new Proxy(t,pg):t)}function Oi(t){if(t instanceof IDBRequest)return aN(t);if(em.has(t))return em.get(t);const e=hN(t);return e!==t&&(em.set(t,e),G_.set(e,t)),e}const tm=t=>G_.get(t);function Uf(t,e,{blocked:n,upgrade:r,blocking:i,terminated:o}={}){const a=indexedDB.open(t,e),u=Oi(a);return r&&a.addEventListener("upgradeneeded",d=>{r(Oi(a.result),d.oldVersion,d.newVersion,Oi(a.transaction),d)}),n&&a.addEventListener("blocked",d=>n(d.oldVersion,d.newVersion,d)),u.then(d=>{o&&d.addEventListener("close",()=>o()),i&&d.addEventListener("versionchange",p=>i(p.oldVersion,p.newVersion,p))}).catch(()=>{}),u}function nm(t,{blocked:e}={}){const n=indexedDB.deleteDatabase(t);return e&&n.addEventListener("blocked",r=>e(r.oldVersion,r)),Oi(n).then(()=>{})}const dN=["get","getKey","getAll","getAllKeys","count"],fN=["put","add","delete","clear"],rm=new Map;function rw(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(rm.get(e))return rm.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=fN.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||dN.includes(n)))return;const o=async function(a,...u){const d=this.transaction(a,i?"readwrite":"readonly");let p=d.store;return r&&(p=p.index(u.shift())),(await Promise.all([p[n](...u),i&&d.done]))[0]};return rm.set(e,o),o}uN(t=>({...t,get:(e,n,r)=>rw(e,n)||t.get(e,n,r),has:(e,n)=>!!rw(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(mN(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function mN(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const mg="@firebase/app",iw="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qi=new W_("@firebase/app"),gN="@firebase/app-compat",_N="@firebase/analytics-compat",yN="@firebase/analytics",vN="@firebase/app-check-compat",wN="@firebase/app-check",xN="@firebase/auth",bN="@firebase/auth-compat",TN="@firebase/database",EN="@firebase/data-connect",IN="@firebase/database-compat",kN="@firebase/functions",SN="@firebase/functions-compat",PN="@firebase/installations",AN="@firebase/installations-compat",CN="@firebase/messaging",NN="@firebase/messaging-compat",RN="@firebase/performance",LN="@firebase/performance-compat",DN="@firebase/remote-config",jN="@firebase/remote-config-compat",MN="@firebase/storage",ON="@firebase/storage-compat",VN="@firebase/firestore",FN="@firebase/vertexai-preview",UN="@firebase/firestore-compat",BN="firebase",zN="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gg="[DEFAULT]",qN={[mg]:"fire-core",[gN]:"fire-core-compat",[yN]:"fire-analytics",[_N]:"fire-analytics-compat",[wN]:"fire-app-check",[vN]:"fire-app-check-compat",[xN]:"fire-auth",[bN]:"fire-auth-compat",[TN]:"fire-rtdb",[EN]:"fire-data-connect",[IN]:"fire-rtdb-compat",[kN]:"fire-fn",[SN]:"fire-fn-compat",[PN]:"fire-iid",[AN]:"fire-iid-compat",[CN]:"fire-fcm",[NN]:"fire-fcm-compat",[RN]:"fire-perf",[LN]:"fire-perf-compat",[DN]:"fire-rc",[jN]:"fire-rc-compat",[MN]:"fire-gcs",[ON]:"fire-gcs-compat",[VN]:"fire-fst",[UN]:"fire-fst-compat",[FN]:"fire-vertex","fire-js":"fire-js",[BN]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jd=new Map,$N=new Map,_g=new Map;function sw(t,e){try{t.container.addComponent(e)}catch(n){qi.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function _r(t){const e=t.name;if(_g.has(e))return qi.debug(`There were multiple attempts to register component ${e}.`),!1;_g.set(e,t);for(const n of Jd.values())sw(n,t);for(const n of $N.values())sw(n,t);return!0}function ro(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function jr(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Hs=new aa("app","Firebase",HN);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WN{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new er("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Hs.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const la=zN;function NE(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:gg,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Hs.create("bad-app-name",{appName:String(i)});if(n||(n=IE()),!n)throw Hs.create("no-options");const o=Jd.get(i);if(o){if(gc(n,o.options)&&gc(r,o.config))return o;throw Hs.create("duplicate-app",{appName:i})}const a=new XC(i);for(const d of _g.values())a.addComponent(d);const u=new WN(n,r,a);return Jd.set(i,u),u}function Bf(t=gg){const e=Jd.get(t);if(!e&&t===gg&&IE())return NE();if(!e)throw Hs.create("no-app",{appName:t});return e}function fn(t,e,n){var r;let i=(r=qN[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const o=i.match(/\s|\//),a=e.match(/\s|\//);if(o||a){const u=[`Unable to register library "${i}" with version "${e}":`];o&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&a&&u.push("and"),a&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),qi.warn(u.join(" "));return}_r(new er(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GN="firebase-heartbeat-database",KN=1,_c="firebase-heartbeat-store";let im=null;function RE(){return im||(im=Uf(GN,KN,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(_c)}catch(n){console.warn(n)}}}}).catch(t=>{throw Hs.create("idb-open",{originalErrorMessage:t.message})})),im}async function ZN(t){try{const n=(await RE()).transaction(_c),r=await n.objectStore(_c).get(LE(t));return await n.done,r}catch(e){if(e instanceof vr)qi.warn(e.message);else{const n=Hs.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});qi.warn(n.message)}}}async function ow(t,e){try{const r=(await RE()).transaction(_c,"readwrite");await r.objectStore(_c).put(e,LE(t)),await r.done}catch(n){if(n instanceof vr)qi.warn(n.message);else{const r=Hs.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});qi.warn(r.message)}}}function LE(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QN=1024,YN=30*24*60*60*1e3;class JN{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new e2(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=aw();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(a=>a.date===o)?void 0:(this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const u=new Date(a.date).valueOf();return Date.now()-u<=YN}),this._storage.overwrite(this._heartbeatsCache))}catch(r){qi.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=aw(),{heartbeatsToSend:r,unsentEntries:i}=XN(this._heartbeatsCache.heartbeats),o=Yd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(n){return qi.warn(n),""}}}function aw(){return new Date().toISOString().substring(0,10)}function XN(t,e=QN){const n=[];let r=t.slice();for(const i of t){const o=n.find(a=>a.agent===i.agent);if(o){if(o.dates.push(i.date),lw(n)>e){o.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),lw(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class e2{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return H_()?PE().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await ZN(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return ow(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return ow(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function lw(t){return Yd(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t2(t){_r(new er("platform-logger",e=>new pN(e),"PRIVATE")),_r(new er("heartbeat",e=>new JN(e),"PRIVATE")),fn(mg,iw,t),fn(mg,iw,"esm2017"),fn("fire-js","")}t2("");function K_(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function DE(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const n2=DE,jE=new aa("auth","Firebase",DE());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xd=new W_("@firebase/auth");function r2(t,...e){Xd.logLevel<=ze.WARN&&Xd.warn(`Auth (${la}): ${t}`,...e)}function hd(t,...e){Xd.logLevel<=ze.ERROR&&Xd.error(`Auth (${la}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yr(t,...e){throw Q_(t,...e)}function Vr(t,...e){return Q_(t,...e)}function Z_(t,e,n){const r=Object.assign(Object.assign({},n2()),{[e]:n});return new aa("auth","Firebase",r).create(e,{appName:t.name})}function Vi(t){return Z_(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function i2(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&yr(t,"argument-error"),Z_(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Q_(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return jE.create(t,...e)}function Ie(t,e,...n){if(!t)throw Q_(e,...n)}function Ni(t){const e="INTERNAL ASSERTION FAILED: "+t;throw hd(e),new Error(e)}function $i(t,e){t||Ni(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yg(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function s2(){return uw()==="http:"||uw()==="https:"}function uw(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o2(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(s2()||FC()||"connection"in navigator)?navigator.onLine:!0}function a2(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hc{constructor(e,n){this.shortDelay=e,this.longDelay=n,$i(n>e,"Short delay should be less than long delay!"),this.isMobile=MC()||UC()}get(){return o2()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y_(t,e){$i(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ME{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ni("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ni("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ni("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l2={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u2=new Hc(3e4,6e4);function Ki(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Zi(t,e,n,r,i={}){return OE(t,i,async()=>{let o={},a={};r&&(e==="GET"?a=r:o={body:JSON.stringify(r)});const u=$c(Object.assign({key:t.config.apiKey},a)).slice(1),d=await t._getAdditionalHeaders();d["Content-Type"]="application/json",t.languageCode&&(d["X-Firebase-Locale"]=t.languageCode);const p=Object.assign({method:e,headers:d},o);return VC()||(p.referrerPolicy="no-referrer"),ME.fetch()(VE(t,t.config.apiHost,n,u),p)})}async function OE(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},l2),e);try{const i=new h2(t),o=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const a=await o.json();if("needConfirmation"in a)throw Uh(t,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{const u=o.ok?a.errorMessage:a.error.message,[d,p]=u.split(" : ");if(d==="FEDERATED_USER_ID_ALREADY_LINKED")throw Uh(t,"credential-already-in-use",a);if(d==="EMAIL_EXISTS")throw Uh(t,"email-already-in-use",a);if(d==="USER_DISABLED")throw Uh(t,"user-disabled",a);const _=r[d]||d.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw Z_(t,_,p);yr(t,_)}}catch(i){if(i instanceof vr)throw i;yr(t,"network-request-failed",{message:String(i)})}}async function Wc(t,e,n,r,i={}){const o=await Zi(t,e,n,r,i);return"mfaPendingCredential"in o&&yr(t,"multi-factor-auth-required",{_serverResponse:o}),o}function VE(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?Y_(t.config,i):`${t.config.apiScheme}://${i}`}function c2(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class h2{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Vr(this.auth,"network-request-failed")),u2.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Uh(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Vr(t,e,r);return i.customData._tokenResponse=n,i}function cw(t){return t!==void 0&&t.enterprise!==void 0}class d2{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return c2(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function f2(t,e){return Zi(t,"GET","/v2/recaptchaConfig",Ki(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function p2(t,e){return Zi(t,"POST","/v1/accounts:delete",e)}async function FE(t,e){return Zi(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hu(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function m2(t,e=!1){const n=Ze(t),r=await n.getIdToken(e),i=J_(r);Ie(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const o=typeof i.firebase=="object"?i.firebase:void 0,a=o==null?void 0:o.sign_in_provider;return{claims:i,token:r,authTime:Hu(sm(i.auth_time)),issuedAtTime:Hu(sm(i.iat)),expirationTime:Hu(sm(i.exp)),signInProvider:a||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function sm(t){return Number(t)*1e3}function J_(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return hd("JWT malformed, contained fewer than 3 sections"),null;try{const i=bE(n);return i?JSON.parse(i):(hd("Failed to decode base64 JWT payload"),null)}catch(i){return hd("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function hw(t){const e=J_(t);return Ie(e,"internal-error"),Ie(typeof e.exp<"u","internal-error"),Ie(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yc(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof vr&&g2(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function g2({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _2{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vg{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Hu(this.lastLoginAt),this.creationTime=Hu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ef(t){var e;const n=t.auth,r=await t.getIdToken(),i=await yc(t,FE(n,{idToken:r}));Ie(i==null?void 0:i.users.length,n,"internal-error");const o=i.users[0];t._notifyReloadListener(o);const a=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?UE(o.providerUserInfo):[],u=v2(t.providerData,a),d=t.isAnonymous,p=!(t.email&&o.passwordHash)&&!(u!=null&&u.length),_=d?p:!1,w={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new vg(o.createdAt,o.lastLoginAt),isAnonymous:_};Object.assign(t,w)}async function y2(t){const e=Ze(t);await ef(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function v2(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function UE(t){return t.map(e=>{var{providerId:n}=e,r=K_(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function w2(t,e){const n=await OE(t,{},async()=>{const r=$c({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=t.config,a=VE(t,i,"/v1/token",`key=${o}`),u=await t._getAdditionalHeaders();return u["Content-Type"]="application/x-www-form-urlencoded",ME.fetch()(a,{method:"POST",headers:u,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function x2(t,e){return Zi(t,"POST","/v2/accounts:revokeToken",Ki(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ul{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ie(e.idToken,"internal-error"),Ie(typeof e.idToken<"u","internal-error"),Ie(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):hw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Ie(e.length!==0,"internal-error");const n=hw(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Ie(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:o}=await w2(e,n);this.updateTokensAndExpiration(r,i,Number(o))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:o}=n,a=new ul;return r&&(Ie(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(Ie(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),o&&(Ie(typeof o=="number","internal-error",{appName:e}),a.expirationTime=o),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ul,this.toJSON())}_performRefresh(){return Ni("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vs(t,e){Ie(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Ri{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,o=K_(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new _2(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new vg(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const n=await yc(this,this.stsTokenManager.getToken(this.auth,e));return Ie(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return m2(this,e)}reload(){return y2(this)}_assign(e){this!==e&&(Ie(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Ri(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){Ie(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await ef(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(jr(this.auth.app))return Promise.reject(Vi(this.auth));const e=await this.getIdToken();return await yc(this,p2(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,o,a,u,d,p,_;const w=(r=n.displayName)!==null&&r!==void 0?r:void 0,x=(i=n.email)!==null&&i!==void 0?i:void 0,k=(o=n.phoneNumber)!==null&&o!==void 0?o:void 0,P=(a=n.photoURL)!==null&&a!==void 0?a:void 0,j=(u=n.tenantId)!==null&&u!==void 0?u:void 0,B=(d=n._redirectEventId)!==null&&d!==void 0?d:void 0,R=(p=n.createdAt)!==null&&p!==void 0?p:void 0,S=(_=n.lastLoginAt)!==null&&_!==void 0?_:void 0,{uid:N,emailVerified:z,isAnonymous:G,providerData:F,stsTokenManager:I}=n;Ie(N&&I,e,"internal-error");const T=ul.fromJSON(this.name,I);Ie(typeof N=="string",e,"internal-error"),vs(w,e.name),vs(x,e.name),Ie(typeof z=="boolean",e,"internal-error"),Ie(typeof G=="boolean",e,"internal-error"),vs(k,e.name),vs(P,e.name),vs(j,e.name),vs(B,e.name),vs(R,e.name),vs(S,e.name);const C=new Ri({uid:N,auth:e,email:x,emailVerified:z,displayName:w,isAnonymous:G,photoURL:P,phoneNumber:k,tenantId:j,stsTokenManager:T,createdAt:R,lastLoginAt:S});return F&&Array.isArray(F)&&(C.providerData=F.map(A=>Object.assign({},A))),B&&(C._redirectEventId=B),C}static async _fromIdTokenResponse(e,n,r=!1){const i=new ul;i.updateFromServerResponse(n);const o=new Ri({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await ef(o),o}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];Ie(i.localId!==void 0,"internal-error");const o=i.providerUserInfo!==void 0?UE(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(o!=null&&o.length),u=new ul;u.updateFromIdToken(r);const d=new Ri({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:a}),p={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new vg(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(o!=null&&o.length)};return Object.assign(d,p),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dw=new Map;function Li(t){$i(t instanceof Function,"Expected a class definition");let e=dw.get(t);return e?($i(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,dw.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BE{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}BE.type="NONE";const fw=BE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dd(t,e,n){return`firebase:${t}:${e}:${n}`}class cl{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:o}=this.auth;this.fullUserKey=dd(this.userKey,i.apiKey,o),this.fullPersistenceKey=dd("persistence",i.apiKey,o),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Ri._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new cl(Li(fw),e,r);const i=(await Promise.all(n.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let o=i[0]||Li(fw);const a=dd(r,e.config.apiKey,e.name);let u=null;for(const p of n)try{const _=await p._get(a);if(_){const w=Ri._fromJSON(e,_);p!==o&&(u=w),o=p;break}}catch{}const d=i.filter(p=>p._shouldAllowMigration);return!o._shouldAllowMigration||!d.length?new cl(o,e,r):(o=d[0],u&&await o._set(a,u.toJSON()),await Promise.all(n.map(async p=>{if(p!==o)try{await p._remove(a)}catch{}})),new cl(o,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pw(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(HE(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(zE(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(GE(e))return"Blackberry";if(KE(e))return"Webos";if(qE(e))return"Safari";if((e.includes("chrome/")||$E(e))&&!e.includes("edge/"))return"Chrome";if(WE(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function zE(t=Wt()){return/firefox\//i.test(t)}function qE(t=Wt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function $E(t=Wt()){return/crios\//i.test(t)}function HE(t=Wt()){return/iemobile/i.test(t)}function WE(t=Wt()){return/android/i.test(t)}function GE(t=Wt()){return/blackberry/i.test(t)}function KE(t=Wt()){return/webos/i.test(t)}function X_(t=Wt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function b2(t=Wt()){var e;return X_(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function T2(){return BC()&&document.documentMode===10}function ZE(t=Wt()){return X_(t)||WE(t)||KE(t)||GE(t)||/windows phone/i.test(t)||HE(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QE(t,e=[]){let n;switch(t){case"Browser":n=pw(Wt());break;case"Worker":n=`${pw(Wt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${la}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E2{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=o=>new Promise((a,u)=>{try{const d=e(o);a(d)}catch(d){u(d)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function I2(t,e={}){return Zi(t,"GET","/v2/passwordPolicy",Ki(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k2=6;class S2{constructor(e){var n,r,i,o;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=a.minPasswordLength)!==null&&n!==void 0?n:k2,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,o,a,u;const d={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,d),this.validatePasswordCharacterOptions(e,d),d.isValid&&(d.isValid=(n=d.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),d.isValid&&(d.isValid=(r=d.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),d.isValid&&(d.isValid=(i=d.containsLowercaseLetter)!==null&&i!==void 0?i:!0),d.isValid&&(d.isValid=(o=d.containsUppercaseLetter)!==null&&o!==void 0?o:!0),d.isValid&&(d.isValid=(a=d.containsNumericCharacter)!==null&&a!==void 0?a:!0),d.isValid&&(d.isValid=(u=d.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),d}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P2{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new mw(this),this.idTokenSubscription=new mw(this),this.beforeStateQueue=new E2(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=jE,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Li(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await cl.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await FE(this,{idToken:e}),r=await Ri._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(jr(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(u,u))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,u=i==null?void 0:i._redirectEventId,d=await this.tryRedirectSignIn(e);(!a||a===u)&&(d!=null&&d.user)&&(i=d.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Ie(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await ef(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=a2()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(jr(this.app))return Promise.reject(Vi(this));const n=e?Ze(e):null;return n&&Ie(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Ie(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return jr(this.app)?Promise.reject(Vi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return jr(this.app)?Promise.reject(Vi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Li(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await I2(this),n=new S2(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new aa("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await x2(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Li(e)||this._popupRedirectResolver;Ie(n,this,"argument-error"),this.redirectPersistenceManager=await cl.create(this,[Li(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const o=typeof n=="function"?n:n.next.bind(n);let a=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ie(u,this,"internal-error"),u.then(()=>{a||o(this.currentUser)}),typeof n=="function"){const d=e.addObserver(n,r,i);return()=>{a=!0,d()}}else{const d=e.addObserver(n);return()=>{a=!0,d()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ie(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=QE(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&r2(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function si(t){return Ze(t)}class mw{constructor(e){this.auth=e,this.observer=null,this.addObserver=GC(n=>this.observer=n)}get next(){return Ie(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function A2(t){zf=t}function YE(t){return zf.loadJS(t)}function C2(){return zf.recaptchaEnterpriseScript}function N2(){return zf.gapiScript}function R2(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const L2="recaptcha-enterprise",D2="NO_RECAPTCHA";class j2{constructor(e){this.type=L2,this.auth=si(e)}async verify(e="verify",n=!1){async function r(o){if(!n){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(a,u)=>{f2(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(d=>{if(d.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{const p=new d2(d);return o.tenantId==null?o._agentRecaptchaConfig=p:o._tenantRecaptchaConfigs[o.tenantId]=p,a(p.siteKey)}}).catch(d=>{u(d)})})}function i(o,a,u){const d=window.grecaptcha;cw(d)?d.enterprise.ready(()=>{d.enterprise.execute(o,{action:e}).then(p=>{a(p)}).catch(()=>{a(D2)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((o,a)=>{r(this.auth).then(u=>{if(!n&&cw(window.grecaptcha))i(u,o,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let d=C2();d.length!==0&&(d+=u),YE(d).then(()=>{i(u,o,a)}).catch(p=>{a(p)})}}).catch(u=>{a(u)})})}}async function gw(t,e,n,r=!1){const i=new j2(t);let o;try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const a=Object.assign({},e);return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function tf(t,e,n,r){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await gw(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await gw(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M2(t,e){const n=ro(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),o=n.getOptions();if(gc(o,e??{}))return i;yr(i,"already-initialized")}return n.initialize({options:e})}function O2(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Li);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function V2(t,e,n){const r=si(t);Ie(r._canInitEmulator,r,"emulator-config-failed"),Ie(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,o=JE(e),{host:a,port:u}=F2(e),d=u===null?"":`:${u}`;r.config.emulator={url:`${o}//${a}${d}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:u,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})}),U2()}function JE(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function F2(t){const e=JE(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const o=i[1];return{host:o,port:_w(r.substr(o.length+1))}}else{const[o,a]=r.split(":");return{host:o,port:_w(a)}}}function _w(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function U2(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ey{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Ni("not implemented")}_getIdTokenResponse(e){return Ni("not implemented")}_linkToIdToken(e,n){return Ni("not implemented")}_getReauthenticationResolver(e){return Ni("not implemented")}}async function B2(t,e){return Zi(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function z2(t,e){return Wc(t,"POST","/v1/accounts:signInWithPassword",Ki(t,e))}async function XE(t,e){return Zi(t,"POST","/v1/accounts:sendOobCode",Ki(t,e))}async function q2(t,e){return XE(t,e)}async function $2(t,e){return XE(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function H2(t,e){return Wc(t,"POST","/v1/accounts:signInWithEmailLink",Ki(t,e))}async function W2(t,e){return Wc(t,"POST","/v1/accounts:signInWithEmailLink",Ki(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vc extends ey{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new vc(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new vc(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return tf(e,n,"signInWithPassword",z2);case"emailLink":return H2(e,{email:this._email,oobCode:this._password});default:yr(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return tf(e,r,"signUpPassword",B2);case"emailLink":return W2(e,{idToken:n,email:this._email,oobCode:this._password});default:yr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hl(t,e){return Wc(t,"POST","/v1/accounts:signInWithIdp",Ki(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G2="http://localhost";class Wo extends ey{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Wo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):yr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,o=K_(n,["providerId","signInMethod"]);if(!r||!i)return null;const a=new Wo(r,i);return a.idToken=o.idToken||void 0,a.accessToken=o.accessToken||void 0,a.secret=o.secret,a.nonce=o.nonce,a.pendingToken=o.pendingToken||null,a}_getIdTokenResponse(e){const n=this.buildRequest();return hl(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,hl(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,hl(e,n)}buildRequest(){const e={requestUri:G2,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=$c(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K2(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Z2(t){const e=Au(Cu(t)).link,n=e?Au(Cu(e)).deep_link_id:null,r=Au(Cu(t)).deep_link_id;return(r?Au(Cu(r)).link:null)||r||n||e||t}class ty{constructor(e){var n,r,i,o,a,u;const d=Au(Cu(e)),p=(n=d.apiKey)!==null&&n!==void 0?n:null,_=(r=d.oobCode)!==null&&r!==void 0?r:null,w=K2((i=d.mode)!==null&&i!==void 0?i:null);Ie(p&&_&&w,"argument-error"),this.apiKey=p,this.operation=w,this.code=_,this.continueUrl=(o=d.continueUrl)!==null&&o!==void 0?o:null,this.languageCode=(a=d.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(u=d.tenantId)!==null&&u!==void 0?u:null}static parseLink(e){const n=Z2(e);try{return new ty(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ml{constructor(){this.providerId=Ml.PROVIDER_ID}static credential(e,n){return vc._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=ty.parseLink(n);return Ie(r,"argument-error"),vc._fromEmailAndCode(e,r.code,r.tenantId)}}Ml.PROVIDER_ID="password";Ml.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ml.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ny{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gc extends ny{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss extends Gc{constructor(){super("facebook.com")}static credential(e){return Wo._fromParams({providerId:Ss.PROVIDER_ID,signInMethod:Ss.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ss.credentialFromTaggedObject(e)}static credentialFromError(e){return Ss.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ss.credential(e.oauthAccessToken)}catch{return null}}}Ss.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ss.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pi extends Gc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Wo._fromParams({providerId:Pi.PROVIDER_ID,signInMethod:Pi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Pi.credentialFromTaggedObject(e)}static credentialFromError(e){return Pi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Pi.credential(n,r)}catch{return null}}}Pi.GOOGLE_SIGN_IN_METHOD="google.com";Pi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ps extends Gc{constructor(){super("github.com")}static credential(e){return Wo._fromParams({providerId:Ps.PROVIDER_ID,signInMethod:Ps.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ps.credentialFromTaggedObject(e)}static credentialFromError(e){return Ps.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ps.credential(e.oauthAccessToken)}catch{return null}}}Ps.GITHUB_SIGN_IN_METHOD="github.com";Ps.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As extends Gc{constructor(){super("twitter.com")}static credential(e,n){return Wo._fromParams({providerId:As.PROVIDER_ID,signInMethod:As.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return As.credentialFromTaggedObject(e)}static credentialFromError(e){return As.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return As.credential(n,r)}catch{return null}}}As.TWITTER_SIGN_IN_METHOD="twitter.com";As.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Q2(t,e){return Wc(t,"POST","/v1/accounts:signUp",Ki(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const o=await Ri._fromIdTokenResponse(e,r,i),a=yw(r);return new Go({user:o,providerId:a,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=yw(r);return new Go({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function yw(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf extends vr{constructor(e,n,r,i){var o;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,nf.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new nf(e,n,r,i)}}function eI(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?nf._fromErrorAndOperation(t,o,e,r):o})}async function Y2(t,e,n=!1){const r=await yc(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Go._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function J2(t,e,n=!1){const{auth:r}=t;if(jr(r.app))return Promise.reject(Vi(r));const i="reauthenticate";try{const o=await yc(t,eI(r,i,e,t),n);Ie(o.idToken,r,"internal-error");const a=J_(o.idToken);Ie(a,r,"internal-error");const{sub:u}=a;return Ie(t.uid===u,r,"user-mismatch"),Go._forOperation(t,i,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&yr(r,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tI(t,e,n=!1){if(jr(t.app))return Promise.reject(Vi(t));const r="signIn",i=await eI(t,r,e),o=await Go._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(o.user),o}async function X2(t,e){return tI(si(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nI(t){const e=si(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function eR(t,e,n){const r=si(t);await tf(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",$2)}async function tR(t,e,n){if(jr(t.app))return Promise.reject(Vi(t));const r=si(t),a=await tf(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Q2).catch(d=>{throw d.code==="auth/password-does-not-meet-requirements"&&nI(t),d}),u=await Go._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(u.user),u}function nR(t,e,n){return jr(t.app)?Promise.reject(Vi(t)):X2(Ze(t),Ml.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&nI(t),r})}async function rI(t,e){const n=Ze(t),i={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()},{email:o}=await q2(n.auth,i);o!==t.email&&await t.reload()}function rR(t,e,n,r){return Ze(t).onIdTokenChanged(e,n,r)}function iR(t,e,n){return Ze(t).beforeAuthStateChanged(e,n)}function sR(t,e,n,r){return Ze(t).onAuthStateChanged(e,n,r)}function iI(t){return Ze(t).signOut()}const rf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sI{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(rf,"1"),this.storage.removeItem(rf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oR=1e3,aR=10;class oI extends sI{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ZE(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((a,u,d)=>{this.notifyListeners(a,d)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(r);!n&&this.localCache[r]===a||this.notifyListeners(r,a)},o=this.storage.getItem(r);T2()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,aR):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},oR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}oI.type="LOCAL";const lR=oI;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aI extends sI{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}aI.type="SESSION";const lI=aI;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uR(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new qf(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:o}=n.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const u=Array.from(a).map(async p=>p(n.origin,o)),d=await uR(u);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:d})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}qf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ry(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cR{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,a;return new Promise((u,d)=>{const p=ry("",20);i.port1.start();const _=setTimeout(()=>{d(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(w){const x=w;if(x.data.eventId===p)switch(x.data.status){case"ack":clearTimeout(_),o=setTimeout(()=>{d(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),u(x.data.response);break;default:clearTimeout(_),clearTimeout(o),d(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:p,data:n},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ni(){return window}function hR(t){ni().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uI(){return typeof ni().WorkerGlobalScope<"u"&&typeof ni().importScripts=="function"}async function dR(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function fR(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function pR(){return uI()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cI="firebaseLocalStorageDb",mR=1,sf="firebaseLocalStorage",hI="fbase_key";class Kc{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function $f(t,e){return t.transaction([sf],e?"readwrite":"readonly").objectStore(sf)}function gR(){const t=indexedDB.deleteDatabase(cI);return new Kc(t).toPromise()}function wg(){const t=indexedDB.open(cI,mR);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(sf,{keyPath:hI})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(sf)?e(r):(r.close(),await gR(),e(await wg()))})})}async function vw(t,e,n){const r=$f(t,!0).put({[hI]:e,value:n});return new Kc(r).toPromise()}async function _R(t,e){const n=$f(t,!1).get(e),r=await new Kc(n).toPromise();return r===void 0?null:r.value}function ww(t,e){const n=$f(t,!0).delete(e);return new Kc(n).toPromise()}const yR=800,vR=3;class dI{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await wg(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>vR)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return uI()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=qf._getInstance(pR()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await dR(),!this.activeServiceWorker)return;this.sender=new cR(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||fR()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await wg();return await vw(e,rf,"1"),await ww(e,rf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>vw(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>_R(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>ww(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const o=$f(i,!1).getAll();return new Kc(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:o}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(o)&&(this.notifyListeners(i,o),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),yR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}dI.type="LOCAL";const wR=dI;new Hc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fI(t,e){return e?Li(e):(Ie(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iy extends ey{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return hl(e,this._buildIdpRequest())}_linkToIdToken(e,n){return hl(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return hl(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function xR(t){return tI(t.auth,new iy(t),t.bypassAuthState)}function bR(t){const{auth:e,user:n}=t;return Ie(n,e,"internal-error"),J2(n,new iy(t),t.bypassAuthState)}async function TR(t){const{auth:e,user:n}=t;return Ie(n,e,"internal-error"),Y2(n,new iy(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pI{constructor(e,n,r,i,o=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:o,error:a,type:u}=e;if(a){this.reject(a);return}const d={auth:this.auth,requestUri:n,sessionId:r,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(d))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return xR;case"linkViaPopup":case"linkViaRedirect":return TR;case"reauthViaPopup":case"reauthViaRedirect":return bR;default:yr(this.auth,"internal-error")}}resolve(e){$i(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){$i(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ER=new Hc(2e3,1e4);async function IR(t,e,n){if(jr(t.app))return Promise.reject(Vr(t,"operation-not-supported-in-this-environment"));const r=si(t);i2(t,e,ny);const i=fI(r,n);return new Do(r,"signInViaPopup",e,i).executeNotNull()}class Do extends pI{constructor(e,n,r,i,o){super(e,n,i,o),this.provider=r,this.authWindow=null,this.pollId=null,Do.currentPopupAction&&Do.currentPopupAction.cancel(),Do.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ie(e,this.auth,"internal-error"),e}async onExecution(){$i(this.filter.length===1,"Popup operations only handle one event");const e=ry();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Vr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Vr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Do.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Vr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,ER.get())};e()}}Do.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kR="pendingRedirect",fd=new Map;class SR extends pI{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=fd.get(this.auth._key());if(!e){try{const r=await PR(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}fd.set(this.auth._key(),e)}return this.bypassAuthState||fd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function PR(t,e){const n=NR(e),r=CR(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function AR(t,e){fd.set(t._key(),e)}function CR(t){return Li(t._redirectPersistence)}function NR(t){return dd(kR,t.config.apiKey,t.name)}async function RR(t,e){return await si(t)._initializationPromise,mI(t,e,!1)}async function mI(t,e,n=!1){if(jr(t.app))return Promise.reject(Vi(t));const r=si(t),i=fI(r,e),a=await new SR(r,i,n).execute();return a&&!n&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LR=10*60*1e3;class DR{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!jR(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!gI(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Vr(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=LR&&this.cachedEventUids.clear(),this.cachedEventUids.has(xw(e))}saveEventToCache(e){this.cachedEventUids.add(xw(e)),this.lastProcessedEventTime=Date.now()}}function xw(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function gI({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function jR(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return gI(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MR(t,e={}){return Zi(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OR=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,VR=/^https?/;async function FR(t){if(t.config.emulator)return;const{authorizedDomains:e}=await MR(t);for(const n of e)try{if(UR(n))return}catch{}yr(t,"unauthorized-domain")}function UR(t){const e=yg(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&a.hostname===r}if(!VR.test(n))return!1;if(OR.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BR=new Hc(3e4,6e4);function bw(){const t=ni().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function zR(t){return new Promise((e,n)=>{var r,i,o;function a(){bw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{bw(),n(Vr(t,"network-request-failed"))},timeout:BR.get()})}if(!((i=(r=ni().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((o=ni().gapi)===null||o===void 0)&&o.load)a();else{const u=R2("iframefcb");return ni()[u]=()=>{gapi.load?a():n(Vr(t,"network-request-failed"))},YE(`${N2()}?onload=${u}`).catch(d=>n(d))}}).catch(e=>{throw pd=null,e})}let pd=null;function qR(t){return pd=pd||zR(t),pd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $R=new Hc(5e3,15e3),HR="__/auth/iframe",WR="emulator/auth/iframe",GR={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},KR=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function ZR(t){const e=t.config;Ie(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Y_(e,WR):`https://${t.config.authDomain}/${HR}`,r={apiKey:e.apiKey,appName:t.name,v:la},i=KR.get(t.config.apiHost);i&&(r.eid=i);const o=t._getFrameworks();return o.length&&(r.fw=o.join(",")),`${n}?${$c(r).slice(1)}`}async function QR(t){const e=await qR(t),n=ni().gapi;return Ie(n,t,"internal-error"),e.open({where:document.body,url:ZR(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:GR,dontclear:!0},r=>new Promise(async(i,o)=>{await r.restyle({setHideOnLeave:!1});const a=Vr(t,"network-request-failed"),u=ni().setTimeout(()=>{o(a)},$R.get());function d(){ni().clearTimeout(u),i(r)}r.ping(d).then(d,()=>{o(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YR={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},JR=500,XR=600,eL="_blank",tL="http://localhost";class Tw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function nL(t,e,n,r=JR,i=XR){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let u="";const d=Object.assign(Object.assign({},YR),{width:r.toString(),height:i.toString(),top:o,left:a}),p=Wt().toLowerCase();n&&(u=$E(p)?eL:n),zE(p)&&(e=e||tL,d.scrollbars="yes");const _=Object.entries(d).reduce((x,[k,P])=>`${x}${k}=${P},`,"");if(b2(p)&&u!=="_self")return rL(e||"",u),new Tw(null);const w=window.open(e||"",u,_);Ie(w,t,"popup-blocked");try{w.focus()}catch{}return new Tw(w)}function rL(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iL="__/auth/handler",sL="emulator/auth/handler",oL=encodeURIComponent("fac");async function Ew(t,e,n,r,i,o){Ie(t.config.authDomain,t,"auth-domain-config-required"),Ie(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:la,eventId:i};if(e instanceof ny){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",WC(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,w]of Object.entries({}))a[_]=w}if(e instanceof Gc){const _=e.getScopes().filter(w=>w!=="");_.length>0&&(a.scopes=_.join(","))}t.tenantId&&(a.tid=t.tenantId);const u=a;for(const _ of Object.keys(u))u[_]===void 0&&delete u[_];const d=await t._getAppCheckToken(),p=d?`#${oL}=${encodeURIComponent(d)}`:"";return`${aL(t)}?${$c(u).slice(1)}${p}`}function aL({config:t}){return t.emulator?Y_(t,sL):`https://${t.authDomain}/${iL}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const om="webStorageSupport";class lL{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=lI,this._completeRedirectFn=mI,this._overrideRedirectResult=AR}async _openPopup(e,n,r,i){var o;$i((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");const a=await Ew(e,n,r,yg(),i);return nL(e,a,ry())}async _openRedirect(e,n,r,i){await this._originValidation(e);const o=await Ew(e,n,r,yg(),i);return hR(o),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:o}=this.eventManagers[n];return i?Promise.resolve(i):($i(o,"If manager is not set, promise should be"),o)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await QR(e),r=new DR(e);return n.register("authEvent",i=>(Ie(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(om,{type:om},i=>{var o;const a=(o=i==null?void 0:i[0])===null||o===void 0?void 0:o[om];a!==void 0&&n(!!a),yr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=FR(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return ZE()||qE()||X_()}}const uL=lL;var Iw="@firebase/auth",kw="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cL{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Ie(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hL(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function dL(t){_r(new er("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:a,authDomain:u}=r.options;Ie(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const d={apiKey:a,authDomain:u,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:QE(t)},p=new P2(r,i,o,d);return O2(p,n),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),_r(new er("auth-internal",e=>{const n=si(e.getProvider("auth").getImmediate());return(r=>new cL(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),fn(Iw,kw,hL(t)),fn(Iw,kw,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fL=5*60,pL=kE("authIdTokenMaxAge")||fL;let Sw=null;const mL=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>pL)return;const i=n==null?void 0:n.token;Sw!==i&&(Sw=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function gL(t=Bf()){const e=ro(t,"auth");if(e.isInitialized())return e.getImmediate();const n=M2(t,{popupRedirectResolver:uL,persistence:[wR,lR,lI]}),r=kE("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(r,location.origin);if(location.origin===o.origin){const a=mL(o.toString());iR(n,a,()=>a(n.currentUser)),rR(n,u=>a(u))}}const i=TE("auth");return i&&V2(n,`http://${i}`),n}function _L(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}A2({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const o=Vr("internal-error");o.customData=i,n(o)},r.type="text/javascript",r.charset="UTF-8",_L().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});dL("Browser");var Pw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Vo,_I;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,T){function C(){}C.prototype=T.prototype,I.D=T.prototype,I.prototype=new C,I.prototype.constructor=I,I.C=function(A,M,U){for(var D=Array(arguments.length-2),we=2;we<arguments.length;we++)D[we-2]=arguments[we];return T.prototype[M].apply(A,D)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,T,C){C||(C=0);var A=Array(16);if(typeof T=="string")for(var M=0;16>M;++M)A[M]=T.charCodeAt(C++)|T.charCodeAt(C++)<<8|T.charCodeAt(C++)<<16|T.charCodeAt(C++)<<24;else for(M=0;16>M;++M)A[M]=T[C++]|T[C++]<<8|T[C++]<<16|T[C++]<<24;T=I.g[0],C=I.g[1],M=I.g[2];var U=I.g[3],D=T+(U^C&(M^U))+A[0]+3614090360&4294967295;T=C+(D<<7&4294967295|D>>>25),D=U+(M^T&(C^M))+A[1]+3905402710&4294967295,U=T+(D<<12&4294967295|D>>>20),D=M+(C^U&(T^C))+A[2]+606105819&4294967295,M=U+(D<<17&4294967295|D>>>15),D=C+(T^M&(U^T))+A[3]+3250441966&4294967295,C=M+(D<<22&4294967295|D>>>10),D=T+(U^C&(M^U))+A[4]+4118548399&4294967295,T=C+(D<<7&4294967295|D>>>25),D=U+(M^T&(C^M))+A[5]+1200080426&4294967295,U=T+(D<<12&4294967295|D>>>20),D=M+(C^U&(T^C))+A[6]+2821735955&4294967295,M=U+(D<<17&4294967295|D>>>15),D=C+(T^M&(U^T))+A[7]+4249261313&4294967295,C=M+(D<<22&4294967295|D>>>10),D=T+(U^C&(M^U))+A[8]+1770035416&4294967295,T=C+(D<<7&4294967295|D>>>25),D=U+(M^T&(C^M))+A[9]+2336552879&4294967295,U=T+(D<<12&4294967295|D>>>20),D=M+(C^U&(T^C))+A[10]+4294925233&4294967295,M=U+(D<<17&4294967295|D>>>15),D=C+(T^M&(U^T))+A[11]+2304563134&4294967295,C=M+(D<<22&4294967295|D>>>10),D=T+(U^C&(M^U))+A[12]+1804603682&4294967295,T=C+(D<<7&4294967295|D>>>25),D=U+(M^T&(C^M))+A[13]+4254626195&4294967295,U=T+(D<<12&4294967295|D>>>20),D=M+(C^U&(T^C))+A[14]+2792965006&4294967295,M=U+(D<<17&4294967295|D>>>15),D=C+(T^M&(U^T))+A[15]+1236535329&4294967295,C=M+(D<<22&4294967295|D>>>10),D=T+(M^U&(C^M))+A[1]+4129170786&4294967295,T=C+(D<<5&4294967295|D>>>27),D=U+(C^M&(T^C))+A[6]+3225465664&4294967295,U=T+(D<<9&4294967295|D>>>23),D=M+(T^C&(U^T))+A[11]+643717713&4294967295,M=U+(D<<14&4294967295|D>>>18),D=C+(U^T&(M^U))+A[0]+3921069994&4294967295,C=M+(D<<20&4294967295|D>>>12),D=T+(M^U&(C^M))+A[5]+3593408605&4294967295,T=C+(D<<5&4294967295|D>>>27),D=U+(C^M&(T^C))+A[10]+38016083&4294967295,U=T+(D<<9&4294967295|D>>>23),D=M+(T^C&(U^T))+A[15]+3634488961&4294967295,M=U+(D<<14&4294967295|D>>>18),D=C+(U^T&(M^U))+A[4]+3889429448&4294967295,C=M+(D<<20&4294967295|D>>>12),D=T+(M^U&(C^M))+A[9]+568446438&4294967295,T=C+(D<<5&4294967295|D>>>27),D=U+(C^M&(T^C))+A[14]+3275163606&4294967295,U=T+(D<<9&4294967295|D>>>23),D=M+(T^C&(U^T))+A[3]+4107603335&4294967295,M=U+(D<<14&4294967295|D>>>18),D=C+(U^T&(M^U))+A[8]+1163531501&4294967295,C=M+(D<<20&4294967295|D>>>12),D=T+(M^U&(C^M))+A[13]+2850285829&4294967295,T=C+(D<<5&4294967295|D>>>27),D=U+(C^M&(T^C))+A[2]+4243563512&4294967295,U=T+(D<<9&4294967295|D>>>23),D=M+(T^C&(U^T))+A[7]+1735328473&4294967295,M=U+(D<<14&4294967295|D>>>18),D=C+(U^T&(M^U))+A[12]+2368359562&4294967295,C=M+(D<<20&4294967295|D>>>12),D=T+(C^M^U)+A[5]+4294588738&4294967295,T=C+(D<<4&4294967295|D>>>28),D=U+(T^C^M)+A[8]+2272392833&4294967295,U=T+(D<<11&4294967295|D>>>21),D=M+(U^T^C)+A[11]+1839030562&4294967295,M=U+(D<<16&4294967295|D>>>16),D=C+(M^U^T)+A[14]+4259657740&4294967295,C=M+(D<<23&4294967295|D>>>9),D=T+(C^M^U)+A[1]+2763975236&4294967295,T=C+(D<<4&4294967295|D>>>28),D=U+(T^C^M)+A[4]+1272893353&4294967295,U=T+(D<<11&4294967295|D>>>21),D=M+(U^T^C)+A[7]+4139469664&4294967295,M=U+(D<<16&4294967295|D>>>16),D=C+(M^U^T)+A[10]+3200236656&4294967295,C=M+(D<<23&4294967295|D>>>9),D=T+(C^M^U)+A[13]+681279174&4294967295,T=C+(D<<4&4294967295|D>>>28),D=U+(T^C^M)+A[0]+3936430074&4294967295,U=T+(D<<11&4294967295|D>>>21),D=M+(U^T^C)+A[3]+3572445317&4294967295,M=U+(D<<16&4294967295|D>>>16),D=C+(M^U^T)+A[6]+76029189&4294967295,C=M+(D<<23&4294967295|D>>>9),D=T+(C^M^U)+A[9]+3654602809&4294967295,T=C+(D<<4&4294967295|D>>>28),D=U+(T^C^M)+A[12]+3873151461&4294967295,U=T+(D<<11&4294967295|D>>>21),D=M+(U^T^C)+A[15]+530742520&4294967295,M=U+(D<<16&4294967295|D>>>16),D=C+(M^U^T)+A[2]+3299628645&4294967295,C=M+(D<<23&4294967295|D>>>9),D=T+(M^(C|~U))+A[0]+4096336452&4294967295,T=C+(D<<6&4294967295|D>>>26),D=U+(C^(T|~M))+A[7]+1126891415&4294967295,U=T+(D<<10&4294967295|D>>>22),D=M+(T^(U|~C))+A[14]+2878612391&4294967295,M=U+(D<<15&4294967295|D>>>17),D=C+(U^(M|~T))+A[5]+4237533241&4294967295,C=M+(D<<21&4294967295|D>>>11),D=T+(M^(C|~U))+A[12]+1700485571&4294967295,T=C+(D<<6&4294967295|D>>>26),D=U+(C^(T|~M))+A[3]+2399980690&4294967295,U=T+(D<<10&4294967295|D>>>22),D=M+(T^(U|~C))+A[10]+4293915773&4294967295,M=U+(D<<15&4294967295|D>>>17),D=C+(U^(M|~T))+A[1]+2240044497&4294967295,C=M+(D<<21&4294967295|D>>>11),D=T+(M^(C|~U))+A[8]+1873313359&4294967295,T=C+(D<<6&4294967295|D>>>26),D=U+(C^(T|~M))+A[15]+4264355552&4294967295,U=T+(D<<10&4294967295|D>>>22),D=M+(T^(U|~C))+A[6]+2734768916&4294967295,M=U+(D<<15&4294967295|D>>>17),D=C+(U^(M|~T))+A[13]+1309151649&4294967295,C=M+(D<<21&4294967295|D>>>11),D=T+(M^(C|~U))+A[4]+4149444226&4294967295,T=C+(D<<6&4294967295|D>>>26),D=U+(C^(T|~M))+A[11]+3174756917&4294967295,U=T+(D<<10&4294967295|D>>>22),D=M+(T^(U|~C))+A[2]+718787259&4294967295,M=U+(D<<15&4294967295|D>>>17),D=C+(U^(M|~T))+A[9]+3951481745&4294967295,I.g[0]=I.g[0]+T&4294967295,I.g[1]=I.g[1]+(M+(D<<21&4294967295|D>>>11))&4294967295,I.g[2]=I.g[2]+M&4294967295,I.g[3]=I.g[3]+U&4294967295}r.prototype.u=function(I,T){T===void 0&&(T=I.length);for(var C=T-this.blockSize,A=this.B,M=this.h,U=0;U<T;){if(M==0)for(;U<=C;)i(this,I,U),U+=this.blockSize;if(typeof I=="string"){for(;U<T;)if(A[M++]=I.charCodeAt(U++),M==this.blockSize){i(this,A),M=0;break}}else for(;U<T;)if(A[M++]=I[U++],M==this.blockSize){i(this,A),M=0;break}}this.h=M,this.o+=T},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var T=1;T<I.length-8;++T)I[T]=0;var C=8*this.o;for(T=I.length-8;T<I.length;++T)I[T]=C&255,C/=256;for(this.u(I),I=Array(16),T=C=0;4>T;++T)for(var A=0;32>A;A+=8)I[C++]=this.g[T]>>>A&255;return I};function o(I,T){var C=u;return Object.prototype.hasOwnProperty.call(C,I)?C[I]:C[I]=T(I)}function a(I,T){this.h=T;for(var C=[],A=!0,M=I.length-1;0<=M;M--){var U=I[M]|0;A&&U==T||(C[M]=U,A=!1)}this.g=C}var u={};function d(I){return-128<=I&&128>I?o(I,function(T){return new a([T|0],0>T?-1:0)}):new a([I|0],0>I?-1:0)}function p(I){if(isNaN(I)||!isFinite(I))return w;if(0>I)return B(p(-I));for(var T=[],C=1,A=0;I>=C;A++)T[A]=I/C|0,C*=4294967296;return new a(T,0)}function _(I,T){if(I.length==0)throw Error("number format error: empty string");if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(I.charAt(0)=="-")return B(_(I.substring(1),T));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var C=p(Math.pow(T,8)),A=w,M=0;M<I.length;M+=8){var U=Math.min(8,I.length-M),D=parseInt(I.substring(M,M+U),T);8>U?(U=p(Math.pow(T,U)),A=A.j(U).add(p(D))):(A=A.j(C),A=A.add(p(D)))}return A}var w=d(0),x=d(1),k=d(16777216);t=a.prototype,t.m=function(){if(j(this))return-B(this).m();for(var I=0,T=1,C=0;C<this.g.length;C++){var A=this.i(C);I+=(0<=A?A:4294967296+A)*T,T*=4294967296}return I},t.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(P(this))return"0";if(j(this))return"-"+B(this).toString(I);for(var T=p(Math.pow(I,6)),C=this,A="";;){var M=z(C,T).g;C=R(C,M.j(T));var U=((0<C.g.length?C.g[0]:C.h)>>>0).toString(I);if(C=M,P(C))return U+A;for(;6>U.length;)U="0"+U;A=U+A}},t.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function P(I){if(I.h!=0)return!1;for(var T=0;T<I.g.length;T++)if(I.g[T]!=0)return!1;return!0}function j(I){return I.h==-1}t.l=function(I){return I=R(this,I),j(I)?-1:P(I)?0:1};function B(I){for(var T=I.g.length,C=[],A=0;A<T;A++)C[A]=~I.g[A];return new a(C,~I.h).add(x)}t.abs=function(){return j(this)?B(this):this},t.add=function(I){for(var T=Math.max(this.g.length,I.g.length),C=[],A=0,M=0;M<=T;M++){var U=A+(this.i(M)&65535)+(I.i(M)&65535),D=(U>>>16)+(this.i(M)>>>16)+(I.i(M)>>>16);A=D>>>16,U&=65535,D&=65535,C[M]=D<<16|U}return new a(C,C[C.length-1]&-2147483648?-1:0)};function R(I,T){return I.add(B(T))}t.j=function(I){if(P(this)||P(I))return w;if(j(this))return j(I)?B(this).j(B(I)):B(B(this).j(I));if(j(I))return B(this.j(B(I)));if(0>this.l(k)&&0>I.l(k))return p(this.m()*I.m());for(var T=this.g.length+I.g.length,C=[],A=0;A<2*T;A++)C[A]=0;for(A=0;A<this.g.length;A++)for(var M=0;M<I.g.length;M++){var U=this.i(A)>>>16,D=this.i(A)&65535,we=I.i(M)>>>16,De=I.i(M)&65535;C[2*A+2*M]+=D*De,S(C,2*A+2*M),C[2*A+2*M+1]+=U*De,S(C,2*A+2*M+1),C[2*A+2*M+1]+=D*we,S(C,2*A+2*M+1),C[2*A+2*M+2]+=U*we,S(C,2*A+2*M+2)}for(A=0;A<T;A++)C[A]=C[2*A+1]<<16|C[2*A];for(A=T;A<2*T;A++)C[A]=0;return new a(C,0)};function S(I,T){for(;(I[T]&65535)!=I[T];)I[T+1]+=I[T]>>>16,I[T]&=65535,T++}function N(I,T){this.g=I,this.h=T}function z(I,T){if(P(T))throw Error("division by zero");if(P(I))return new N(w,w);if(j(I))return T=z(B(I),T),new N(B(T.g),B(T.h));if(j(T))return T=z(I,B(T)),new N(B(T.g),T.h);if(30<I.g.length){if(j(I)||j(T))throw Error("slowDivide_ only works with positive integers.");for(var C=x,A=T;0>=A.l(I);)C=G(C),A=G(A);var M=F(C,1),U=F(A,1);for(A=F(A,2),C=F(C,2);!P(A);){var D=U.add(A);0>=D.l(I)&&(M=M.add(C),U=D),A=F(A,1),C=F(C,1)}return T=R(I,M.j(T)),new N(M,T)}for(M=w;0<=I.l(T);){for(C=Math.max(1,Math.floor(I.m()/T.m())),A=Math.ceil(Math.log(C)/Math.LN2),A=48>=A?1:Math.pow(2,A-48),U=p(C),D=U.j(T);j(D)||0<D.l(I);)C-=A,U=p(C),D=U.j(T);P(U)&&(U=x),M=M.add(U),I=R(I,D)}return new N(M,I)}t.A=function(I){return z(this,I).h},t.and=function(I){for(var T=Math.max(this.g.length,I.g.length),C=[],A=0;A<T;A++)C[A]=this.i(A)&I.i(A);return new a(C,this.h&I.h)},t.or=function(I){for(var T=Math.max(this.g.length,I.g.length),C=[],A=0;A<T;A++)C[A]=this.i(A)|I.i(A);return new a(C,this.h|I.h)},t.xor=function(I){for(var T=Math.max(this.g.length,I.g.length),C=[],A=0;A<T;A++)C[A]=this.i(A)^I.i(A);return new a(C,this.h^I.h)};function G(I){for(var T=I.g.length+1,C=[],A=0;A<T;A++)C[A]=I.i(A)<<1|I.i(A-1)>>>31;return new a(C,I.h)}function F(I,T){var C=T>>5;T%=32;for(var A=I.g.length-C,M=[],U=0;U<A;U++)M[U]=0<T?I.i(U+C)>>>T|I.i(U+C+1)<<32-T:I.i(U+C);return new a(M,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,_I=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=p,a.fromString=_,Vo=a}).apply(typeof Pw<"u"?Pw:typeof self<"u"?self:typeof window<"u"?window:{});var Bh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var yI,Nu,vI,md,xg,wI,xI,bI;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,g,v){return c==Array.prototype||c==Object.prototype||(c[g]=v.value),c};function n(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof Bh=="object"&&Bh];for(var g=0;g<c.length;++g){var v=c[g];if(v&&v.Math==Math)return v}throw Error("Cannot find global object")}var r=n(this);function i(c,g){if(g)e:{var v=r;c=c.split(".");for(var E=0;E<c.length-1;E++){var q=c[E];if(!(q in v))break e;v=v[q]}c=c[c.length-1],E=v[c],g=g(E),g!=E&&g!=null&&e(v,c,{configurable:!0,writable:!0,value:g})}}function o(c,g){c instanceof String&&(c+="");var v=0,E=!1,q={next:function(){if(!E&&v<c.length){var Q=v++;return{value:g(Q,c[Q]),done:!1}}return E=!0,{done:!0,value:void 0}}};return q[Symbol.iterator]=function(){return q},q}i("Array.prototype.values",function(c){return c||function(){return o(this,function(g,v){return v})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},u=this||self;function d(c){var g=typeof c;return g=g!="object"?g:c?Array.isArray(c)?"array":g:"null",g=="array"||g=="object"&&typeof c.length=="number"}function p(c){var g=typeof c;return g=="object"&&c!=null||g=="function"}function _(c,g,v){return c.call.apply(c.bind,arguments)}function w(c,g,v){if(!c)throw Error();if(2<arguments.length){var E=Array.prototype.slice.call(arguments,2);return function(){var q=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(q,E),c.apply(g,q)}}return function(){return c.apply(g,arguments)}}function x(c,g,v){return x=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?_:w,x.apply(null,arguments)}function k(c,g){var v=Array.prototype.slice.call(arguments,1);return function(){var E=v.slice();return E.push.apply(E,arguments),c.apply(this,E)}}function P(c,g){function v(){}v.prototype=g.prototype,c.aa=g.prototype,c.prototype=new v,c.prototype.constructor=c,c.Qb=function(E,q,Q){for(var se=Array(arguments.length-2),Je=2;Je<arguments.length;Je++)se[Je-2]=arguments[Je];return g.prototype[q].apply(E,se)}}function j(c){const g=c.length;if(0<g){const v=Array(g);for(let E=0;E<g;E++)v[E]=c[E];return v}return[]}function B(c,g){for(let v=1;v<arguments.length;v++){const E=arguments[v];if(d(E)){const q=c.length||0,Q=E.length||0;c.length=q+Q;for(let se=0;se<Q;se++)c[q+se]=E[se]}else c.push(E)}}class R{constructor(g,v){this.i=g,this.j=v,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function S(c){return/^[\s\xa0]*$/.test(c)}function N(){var c=u.navigator;return c&&(c=c.userAgent)?c:""}function z(c){return z[" "](c),c}z[" "]=function(){};var G=N().indexOf("Gecko")!=-1&&!(N().toLowerCase().indexOf("webkit")!=-1&&N().indexOf("Edge")==-1)&&!(N().indexOf("Trident")!=-1||N().indexOf("MSIE")!=-1)&&N().indexOf("Edge")==-1;function F(c,g,v){for(const E in c)g.call(v,c[E],E,c)}function I(c,g){for(const v in c)g.call(void 0,c[v],v,c)}function T(c){const g={};for(const v in c)g[v]=c[v];return g}const C="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function A(c,g){let v,E;for(let q=1;q<arguments.length;q++){E=arguments[q];for(v in E)c[v]=E[v];for(let Q=0;Q<C.length;Q++)v=C[Q],Object.prototype.hasOwnProperty.call(E,v)&&(c[v]=E[v])}}function M(c){var g=1;c=c.split(":");const v=[];for(;0<g&&c.length;)v.push(c.shift()),g--;return c.length&&v.push(c.join(":")),v}function U(c){u.setTimeout(()=>{throw c},0)}function D(){var c=ie;let g=null;return c.g&&(g=c.g,c.g=c.g.next,c.g||(c.h=null),g.next=null),g}class we{constructor(){this.h=this.g=null}add(g,v){const E=De.get();E.set(g,v),this.h?this.h.next=E:this.g=E,this.h=E}}var De=new R(()=>new Pe,c=>c.reset());class Pe{constructor(){this.next=this.g=this.h=null}set(g,v){this.h=g,this.g=v,this.next=null}reset(){this.next=this.g=this.h=null}}let tt,K=!1,ie=new we,J=()=>{const c=u.Promise.resolve(void 0);tt=()=>{c.then(ae)}};var ae=()=>{for(var c;c=D();){try{c.h.call(c.g)}catch(v){U(v)}var g=De;g.j(c),100>g.h&&(g.h++,c.next=g.g,g.g=c)}K=!1};function ce(){this.s=this.s,this.C=this.C}ce.prototype.s=!1,ce.prototype.ma=function(){this.s||(this.s=!0,this.N())},ce.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function _e(c,g){this.type=c,this.g=this.target=g,this.defaultPrevented=!1}_e.prototype.h=function(){this.defaultPrevented=!0};var ke=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var c=!1,g=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const v=()=>{};u.addEventListener("test",v,g),u.removeEventListener("test",v,g)}catch{}return c}();function Se(c,g){if(_e.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var v=this.type=c.type,E=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=g,g=c.relatedTarget){if(G){e:{try{z(g.nodeName);var q=!0;break e}catch{}q=!1}q||(g=null)}}else v=="mouseover"?g=c.fromElement:v=="mouseout"&&(g=c.toElement);this.relatedTarget=g,E?(this.clientX=E.clientX!==void 0?E.clientX:E.pageX,this.clientY=E.clientY!==void 0?E.clientY:E.pageY,this.screenX=E.screenX||0,this.screenY=E.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:me[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&Se.aa.h.call(this)}}P(Se,_e);var me={2:"touch",3:"pen",4:"mouse"};Se.prototype.h=function(){Se.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var at="closure_listenable_"+(1e6*Math.random()|0),en=0;function ct(c,g,v,E,q){this.listener=c,this.proxy=null,this.src=g,this.type=v,this.capture=!!E,this.ha=q,this.key=++en,this.da=this.fa=!1}function nt(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function Me(c){this.src=c,this.g={},this.h=0}Me.prototype.add=function(c,g,v,E,q){var Q=c.toString();c=this.g[Q],c||(c=this.g[Q]=[],this.h++);var se=Ye(c,g,E,q);return-1<se?(g=c[se],v||(g.fa=!1)):(g=new ct(g,this.src,Q,!!E,q),g.fa=v,c.push(g)),g};function ft(c,g){var v=g.type;if(v in c.g){var E=c.g[v],q=Array.prototype.indexOf.call(E,g,void 0),Q;(Q=0<=q)&&Array.prototype.splice.call(E,q,1),Q&&(nt(g),c.g[v].length==0&&(delete c.g[v],c.h--))}}function Ye(c,g,v,E){for(var q=0;q<c.length;++q){var Q=c[q];if(!Q.da&&Q.listener==g&&Q.capture==!!v&&Q.ha==E)return q}return-1}var _n="closure_lm_"+(1e6*Math.random()|0),Yi={};function Ji(c,g,v,E,q){if(Array.isArray(g)){for(var Q=0;Q<g.length;Q++)Ji(c,g[Q],v,E,q);return null}return v=ho(v),c&&c[at]?c.K(g,v,p(E)?!!E.capture:!1,q):Xi(c,g,v,!1,E,q)}function Xi(c,g,v,E,q,Q){if(!g)throw Error("Invalid event type");var se=p(q)?!!q.capture:!!q,Je=wr(c);if(Je||(c[_n]=Je=new Me(c)),v=Je.add(g,v,E,se,Q),v.proxy)return v;if(E=oi(),v.proxy=E,E.src=c,E.listener=v,c.addEventListener)ke||(q=se),q===void 0&&(q=!1),c.addEventListener(g.toString(),E,q);else if(c.attachEvent)c.attachEvent(Br(g.toString()),E);else if(c.addListener&&c.removeListener)c.addListener(E);else throw Error("addEventListener and attachEvent are unavailable.");return v}function oi(){function c(v){return g.call(c.src,c.listener,v)}const g=uo;return c}function zn(c,g,v,E,q){if(Array.isArray(g))for(var Q=0;Q<g.length;Q++)zn(c,g[Q],v,E,q);else E=p(E)?!!E.capture:!!E,v=ho(v),c&&c[at]?(c=c.i,g=String(g).toString(),g in c.g&&(Q=c.g[g],v=Ye(Q,v,E,q),-1<v&&(nt(Q[v]),Array.prototype.splice.call(Q,v,1),Q.length==0&&(delete c.g[g],c.h--)))):c&&(c=wr(c))&&(g=c.g[g.toString()],c=-1,g&&(c=Ye(g,v,E,q)),(v=-1<c?g[c]:null)&&es(v))}function es(c){if(typeof c!="number"&&c&&!c.da){var g=c.src;if(g&&g[at])ft(g.i,c);else{var v=c.type,E=c.proxy;g.removeEventListener?g.removeEventListener(v,E,c.capture):g.detachEvent?g.detachEvent(Br(v),E):g.addListener&&g.removeListener&&g.removeListener(E),(v=wr(g))?(ft(v,c),v.h==0&&(v.src=null,g[_n]=null)):nt(c)}}}function Br(c){return c in Yi?Yi[c]:Yi[c]="on"+c}function uo(c,g){if(c.da)c=!0;else{g=new Se(g,this);var v=c.listener,E=c.ha||c.src;c.fa&&es(c),c=v.call(E,g)}return c}function wr(c){return c=c[_n],c instanceof Me?c:null}var co="__closure_events_fn_"+(1e9*Math.random()>>>0);function ho(c){return typeof c=="function"?c:(c[co]||(c[co]=function(g){return c.handleEvent(g)}),c[co])}function yt(){ce.call(this),this.i=new Me(this),this.M=this,this.F=null}P(yt,ce),yt.prototype[at]=!0,yt.prototype.removeEventListener=function(c,g,v,E){zn(this,c,g,v,E)};function Rt(c,g){var v,E=c.F;if(E)for(v=[];E;E=E.F)v.push(E);if(c=c.M,E=g.type||g,typeof g=="string")g=new _e(g,c);else if(g instanceof _e)g.target=g.target||c;else{var q=g;g=new _e(E,c),A(g,q)}if(q=!0,v)for(var Q=v.length-1;0<=Q;Q--){var se=g.g=v[Q];q=ai(se,E,!0,g)&&q}if(se=g.g=c,q=ai(se,E,!0,g)&&q,q=ai(se,E,!1,g)&&q,v)for(Q=0;Q<v.length;Q++)se=g.g=v[Q],q=ai(se,E,!1,g)&&q}yt.prototype.N=function(){if(yt.aa.N.call(this),this.i){var c=this.i,g;for(g in c.g){for(var v=c.g[g],E=0;E<v.length;E++)nt(v[E]);delete c.g[g],c.h--}}this.F=null},yt.prototype.K=function(c,g,v,E){return this.i.add(String(c),g,!1,v,E)},yt.prototype.L=function(c,g,v,E){return this.i.add(String(c),g,!0,v,E)};function ai(c,g,v,E){if(g=c.i.g[String(g)],!g)return!0;g=g.concat();for(var q=!0,Q=0;Q<g.length;++Q){var se=g[Q];if(se&&!se.da&&se.capture==v){var Je=se.listener,Ft=se.ha||se.src;se.fa&&ft(c.i,se),q=Je.call(Ft,E)!==!1&&q}}return q&&!E.defaultPrevented}function fo(c,g,v){if(typeof c=="function")v&&(c=x(c,v));else if(c&&typeof c.handleEvent=="function")c=x(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:u.setTimeout(c,g||0)}function ts(c){c.g=fo(()=>{c.g=null,c.i&&(c.i=!1,ts(c))},c.l);const g=c.h;c.h=null,c.m.apply(null,g)}class ha extends ce{constructor(g,v){super(),this.m=g,this.l=v,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:ts(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function li(c){ce.call(this),this.h=c,this.g={}}P(li,ce);var po=[];function ns(c){F(c.g,function(g,v){this.g.hasOwnProperty(v)&&es(g)},c),c.g={}}li.prototype.N=function(){li.aa.N.call(this),ns(this)},li.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ui=u.JSON.stringify,zl=u.JSON.parse,yn=class{stringify(c){return u.JSON.stringify(c,void 0)}parse(c){return u.JSON.parse(c,void 0)}};function Lt(){}Lt.prototype.h=null;function An(c){return c.h||(c.h=c.i())}function xr(){}var br={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ci(){_e.call(this,"d")}P(ci,_e);function rs(){_e.call(this,"c")}P(rs,_e);var Be={},da=null;function is(){return da=da||new yt}Be.La="serverreachability";function fa(c){_e.call(this,Be.La,c)}P(fa,_e);function hi(c){const g=is();Rt(g,new fa(g))}Be.STAT_EVENT="statevent";function ss(c,g){_e.call(this,Be.STAT_EVENT,c),this.stat=g}P(ss,_e);function Vt(c){const g=is();Rt(g,new ss(g,c))}Be.Ma="timingevent";function pa(c,g){_e.call(this,Be.Ma,c),this.size=g}P(pa,_e);function di(c,g){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){c()},g)}function fi(){this.g=!0}fi.prototype.xa=function(){this.g=!1};function Cn(c,g,v,E,q,Q){c.info(function(){if(c.g)if(Q)for(var se="",Je=Q.split("&"),Ft=0;Ft<Je.length;Ft++){var He=Je[Ft].split("=");if(1<He.length){var it=He[0];He=He[1];var bt=it.split("_");se=2<=bt.length&&bt[1]=="type"?se+(it+"="+He+"&"):se+(it+"=redacted&")}}else se=null;else se=Q;return"XMLHTTP REQ ("+E+") [attempt "+q+"]: "+g+`
`+v+`
`+se})}function pe(c,g,v,E,q,Q,se){c.info(function(){return"XMLHTTP RESP ("+E+") [ attempt "+q+"]: "+g+`
`+v+`
`+Q+" "+se})}function Tr(c,g,v,E){c.info(function(){return"XMLHTTP TEXT ("+g+"): "+ma(c,v)+(E?" "+E:"")})}function pi(c,g){c.info(function(){return"TIMEOUT: "+g})}fi.prototype.info=function(){};function ma(c,g){if(!c.g)return g;if(!g)return null;try{var v=JSON.parse(g);if(v){for(c=0;c<v.length;c++)if(Array.isArray(v[c])){var E=v[c];if(!(2>E.length)){var q=E[1];if(Array.isArray(q)&&!(1>q.length)){var Q=q[0];if(Q!="noop"&&Q!="stop"&&Q!="close")for(var se=1;se<q.length;se++)q[se]=""}}}}return ui(v)}catch{return g}}var mi={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},os={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},as;function qt(){}P(qt,Lt),qt.prototype.g=function(){return new XMLHttpRequest},qt.prototype.i=function(){return{}},as=new qt;function ye(c,g,v,E){this.j=c,this.i=g,this.l=v,this.R=E||1,this.U=new li(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ga}function ga(){this.i=null,this.g="",this.h=!1}var mo={},ls={};function us(c,g,v){c.L=1,c.v=sr(St(g)),c.m=v,c.P=!0,cs(c,null)}function cs(c,g){c.F=Date.now(),_i(c),c.A=St(c.v);var v=c.A,E=c.R;Array.isArray(E)||(E=[String(E)]),rh(v.i,"t",E),c.C=0,v=c.j.J,c.h=new ga,c.g=ch(c.j,v?g:null,!c.m),0<c.O&&(c.M=new ha(x(c.Y,c,c.g),c.O)),g=c.U,v=c.g,E=c.ca;var q="readystatechange";Array.isArray(q)||(q&&(po[0]=q.toString()),q=po);for(var Q=0;Q<q.length;Q++){var se=Ji(v,q[Q],E||g.handleEvent,!1,g.h||g);if(!se)break;g.g[se.key]=se}g=c.H?T(c.H):{},c.m?(c.u||(c.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,g)):(c.u="GET",c.g.ea(c.A,c.u,null,g)),hi(),Cn(c.i,c.u,c.A,c.l,c.R,c.m)}ye.prototype.ca=function(c){c=c.target;const g=this.M;g&&vn(c)==3?g.j():this.Y(c)},ye.prototype.Y=function(c){try{if(c==this.g)e:{const bt=vn(this.g);var g=this.g.Ba();const gs=this.g.Z();if(!(3>bt)&&(bt!=3||this.g&&(this.h.h||this.g.oa()||eu(this.g)))){this.J||bt!=4||g==7||(g==8||0>=gs?hi(3):hi(2)),hs(this);var v=this.g.Z();this.X=v;t:if(go(this)){var E=eu(this.g);c="";var q=E.length,Q=vn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){X(this),O(this);var se="";break t}this.h.i=new u.TextDecoder}for(g=0;g<q;g++)this.h.h=!0,c+=this.h.i.decode(E[g],{stream:!(Q&&g==q-1)});E.length=0,this.h.g+=c,this.C=0,se=this.h.g}else se=this.g.oa();if(this.o=v==200,pe(this.i,this.u,this.A,this.l,this.R,bt,v),this.o){if(this.T&&!this.K){t:{if(this.g){var Je,Ft=this.g;if((Je=Ft.g?Ft.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!S(Je)){var He=Je;break t}}He=null}if(v=He)Tr(this.i,this.l,v,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,re(this,v);else{this.o=!1,this.s=3,Vt(12),X(this),O(this);break e}}if(this.P){v=!0;let Dt;for(;!this.J&&this.C<se.length;)if(Dt=gi(this,se),Dt==ls){bt==4&&(this.s=4,Vt(14),v=!1),Tr(this.i,this.l,null,"[Incomplete Response]");break}else if(Dt==mo){this.s=4,Vt(15),Tr(this.i,this.l,se,"[Invalid Chunk]"),v=!1;break}else Tr(this.i,this.l,Dt,null),re(this,Dt);if(go(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),bt!=4||se.length!=0||this.h.h||(this.s=1,Vt(16),v=!1),this.o=this.o&&v,!v)Tr(this.i,this.l,se,"[Invalid Chunked Response]"),X(this),O(this);else if(0<se.length&&!this.W){this.W=!0;var it=this.j;it.g==this&&it.ba&&!it.M&&(it.j.info("Great, no buffering proxy detected. Bytes received: "+se.length),Ia(it),it.M=!0,Vt(11))}}else Tr(this.i,this.l,se,null),re(this,se);bt==4&&X(this),this.o&&!this.J&&(bt==4?nu(this.j,this):(this.o=!1,_i(this)))}else wp(this.g),v==400&&0<se.indexOf("Unknown SID")?(this.s=3,Vt(12)):(this.s=0,Vt(13)),X(this),O(this)}}}catch{}finally{}};function go(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function gi(c,g){var v=c.C,E=g.indexOf(`
`,v);return E==-1?ls:(v=Number(g.substring(v,E)),isNaN(v)?mo:(E+=1,E+v>g.length?ls:(g=g.slice(E,E+v),c.C=E+v,g)))}ye.prototype.cancel=function(){this.J=!0,X(this)};function _i(c){c.S=Date.now()+c.I,_o(c,c.I)}function _o(c,g){if(c.B!=null)throw Error("WatchDog timer not null");c.B=di(x(c.ba,c),g)}function hs(c){c.B&&(u.clearTimeout(c.B),c.B=null)}ye.prototype.ba=function(){this.B=null;const c=Date.now();0<=c-this.S?(pi(this.i,this.A),this.L!=2&&(hi(),Vt(17)),X(this),this.s=2,O(this)):_o(this,this.S-c)};function O(c){c.j.G==0||c.J||nu(c.j,c)}function X(c){hs(c);var g=c.M;g&&typeof g.ma=="function"&&g.ma(),c.M=null,ns(c.U),c.g&&(g=c.g,c.g=null,g.abort(),g.ma())}function re(c,g){try{var v=c.j;if(v.G!=0&&(v.g==c||Re(v.h,c))){if(!c.K&&Re(v.h,c)&&v.G==3){try{var E=v.Da.g.parse(g)}catch{E=null}if(Array.isArray(E)&&E.length==3){var q=E;if(q[0]==0){e:if(!v.u){if(v.g)if(v.g.F+3e3<c.F)Sa(v),Ta(v);else break e;Ea(v),Vt(18)}}else v.za=q[1],0<v.za-v.T&&37500>q[2]&&v.F&&v.v==0&&!v.C&&(v.C=di(x(v.Za,v),6e3));if(1>=wt(v.h)&&v.ca){try{v.ca()}catch{}v.ca=void 0}}else xi(v,11)}else if((c.K||v.g==c)&&Sa(v),!S(g))for(q=v.Da.g.parse(g),g=0;g<q.length;g++){let He=q[g];if(v.T=He[0],He=He[1],v.G==2)if(He[0]=="c"){v.K=He[1],v.ia=He[2];const it=He[3];it!=null&&(v.la=it,v.j.info("VER="+v.la));const bt=He[4];bt!=null&&(v.Aa=bt,v.j.info("SVER="+v.Aa));const gs=He[5];gs!=null&&typeof gs=="number"&&0<gs&&(E=1.5*gs,v.L=E,v.j.info("backChannelRequestTimeoutMs_="+E)),E=v;const Dt=c.g;if(Dt){const Aa=Dt.g?Dt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Aa){var Q=E.h;Q.g||Aa.indexOf("spdy")==-1&&Aa.indexOf("quic")==-1&&Aa.indexOf("h2")==-1||(Q.j=Q.l,Q.g=new Set,Q.h&&($e(Q,Q.h),Q.h=null))}if(E.D){const Wr=Dt.g?Dt.g.getResponseHeader("X-HTTP-Session-Id"):null;Wr&&(E.ya=Wr,Ce(E.I,E.D,Wr))}}v.G=3,v.l&&v.l.ua(),v.ba&&(v.R=Date.now()-c.F,v.j.info("Handshake RTT: "+v.R+"ms")),E=v;var se=c;if(E.qa=Pa(E,E.J?E.ia:null,E.W),se.K){zr(E.h,se);var Je=se,Ft=E.L;Ft&&(Je.I=Ft),Je.B&&(hs(Je),_i(Je)),E.g=se}else Sr(E);0<v.i.length&&ms(v)}else He[0]!="stop"&&He[0]!="close"||xi(v,7);else v.G==3&&(He[0]=="stop"||He[0]=="close"?He[0]=="stop"?xi(v,7):ba(v):He[0]!="noop"&&v.l&&v.l.ta(He),v.v=0)}}hi(4)}catch{}}var xe=class{constructor(c,g){this.g=c,this.map=g}};function Le(c){this.l=c||10,u.PerformanceNavigationTiming?(c=u.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function vt(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function wt(c){return c.h?1:c.g?c.g.size:0}function Re(c,g){return c.h?c.h==g:c.g?c.g.has(g):!1}function $e(c,g){c.g?c.g.add(g):c.h=g}function zr(c,g){c.h&&c.h==g?c.h=null:c.g&&c.g.has(g)&&c.g.delete(g)}Le.prototype.cancel=function(){if(this.i=Er(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function Er(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let g=c.i;for(const v of c.g.values())g=g.concat(v.D);return g}return j(c.i)}function qr(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(d(c)){for(var g=[],v=c.length,E=0;E<v;E++)g.push(c[E]);return g}g=[],v=0;for(E in c)g[v++]=c[E];return g}function yo(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(d(c)||typeof c=="string"){var g=[];c=c.length;for(var v=0;v<c;v++)g.push(v);return g}g=[],v=0;for(const E in c)g[v++]=E;return g}}}function Ae(c,g){if(c.forEach&&typeof c.forEach=="function")c.forEach(g,void 0);else if(d(c)||typeof c=="string")Array.prototype.forEach.call(c,g,void 0);else for(var v=yo(c),E=qr(c),q=E.length,Q=0;Q<q;Q++)g.call(void 0,E[Q],v&&v[Q],c)}var pt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ql(c,g){if(c){c=c.split("&");for(var v=0;v<c.length;v++){var E=c[v].indexOf("="),q=null;if(0<=E){var Q=c[v].substring(0,E);q=c[v].substring(E+1)}else Q=c[v];g(Q,q?decodeURIComponent(q.replace(/\+/g," ")):"")}}}function ir(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof ir){this.h=c.h,_a(this,c.j),this.o=c.o,this.g=c.g,yi(this,c.s),this.l=c.l;var g=c.i,v=new vi;v.i=g.i,g.g&&(v.g=new Map(g.g),v.h=g.h),$r(this,v),this.m=c.m}else c&&(g=String(c).match(pt))?(this.h=!1,_a(this,g[1]||"",!0),this.o=Ir(g[2]||""),this.g=Ir(g[3]||"",!0),yi(this,g[4]),this.l=Ir(g[5]||"",!0),$r(this,g[6]||"",!0),this.m=Ir(g[7]||"")):(this.h=!1,this.i=new vi(null,this.h))}ir.prototype.toString=function(){var c=[],g=this.j;g&&c.push(kr(g,ds,!0),":");var v=this.g;return(v||g=="file")&&(c.push("//"),(g=this.o)&&c.push(kr(g,ds,!0),"@"),c.push(encodeURIComponent(String(v)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),v=this.s,v!=null&&c.push(":",String(v))),(v=this.l)&&(this.g&&v.charAt(0)!="/"&&c.push("/"),c.push(kr(v,v.charAt(0)=="/"?Wl:Hl,!0))),(v=this.i.toString())&&c.push("?",v),(v=this.m)&&c.push("#",kr(v,Gl)),c.join("")};function St(c){return new ir(c)}function _a(c,g,v){c.j=v?Ir(g,!0):g,c.j&&(c.j=c.j.replace(/:$/,""))}function yi(c,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);c.s=g}else c.s=null}function $r(c,g,v){g instanceof vi?(c.i=g,or(c.i,c.h)):(v||(g=kr(g,ya)),c.i=new vi(g,c.h))}function Ce(c,g,v){c.i.set(g,v)}function sr(c){return Ce(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function Ir(c,g){return c?g?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function kr(c,g,v){return typeof c=="string"?(c=encodeURI(c).replace(g,$l),v&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function $l(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var ds=/[#\/\?@]/g,Hl=/[#\?:]/g,Wl=/[#\?]/g,ya=/[#\?@]/g,Gl=/#/g;function vi(c,g){this.h=this.g=null,this.i=c||null,this.j=!!g}function qn(c){c.g||(c.g=new Map,c.h=0,c.i&&ql(c.i,function(g,v){c.add(decodeURIComponent(g.replace(/\+/g," ")),v)}))}t=vi.prototype,t.add=function(c,g){qn(this),this.i=null,c=Te(this,c);var v=this.g.get(c);return v||this.g.set(c,v=[]),v.push(g),this.h+=1,this};function Kl(c,g){qn(c),g=Te(c,g),c.g.has(g)&&(c.i=null,c.h-=c.g.get(g).length,c.g.delete(g))}function va(c,g){return qn(c),g=Te(c,g),c.g.has(g)}t.forEach=function(c,g){qn(this),this.g.forEach(function(v,E){v.forEach(function(q){c.call(g,q,E,this)},this)},this)},t.na=function(){qn(this);const c=Array.from(this.g.values()),g=Array.from(this.g.keys()),v=[];for(let E=0;E<g.length;E++){const q=c[E];for(let Q=0;Q<q.length;Q++)v.push(g[E])}return v},t.V=function(c){qn(this);let g=[];if(typeof c=="string")va(this,c)&&(g=g.concat(this.g.get(Te(this,c))));else{c=Array.from(this.g.values());for(let v=0;v<c.length;v++)g=g.concat(c[v])}return g},t.set=function(c,g){return qn(this),this.i=null,c=Te(this,c),va(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[g]),this.h+=1,this},t.get=function(c,g){return c?(c=this.V(c),0<c.length?String(c[0]):g):g};function rh(c,g,v){Kl(c,g),0<v.length&&(c.i=null,c.g.set(Te(c,g),j(v)),c.h+=v.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],g=Array.from(this.g.keys());for(var v=0;v<g.length;v++){var E=g[v];const Q=encodeURIComponent(String(E)),se=this.V(E);for(E=0;E<se.length;E++){var q=Q;se[E]!==""&&(q+="="+encodeURIComponent(String(se[E]))),c.push(q)}}return this.i=c.join("&")};function Te(c,g){return g=String(g),c.j&&(g=g.toLowerCase()),g}function or(c,g){g&&!c.j&&(qn(c),c.i=null,c.g.forEach(function(v,E){var q=E.toLowerCase();E!=q&&(Kl(this,E),rh(this,q,v))},c)),c.j=g}function rt(c,g){const v=new fi;if(u.Image){const E=new Image;E.onload=k(ar,v,"TestLoadImage: loaded",!0,g,E),E.onerror=k(ar,v,"TestLoadImage: error",!1,g,E),E.onabort=k(ar,v,"TestLoadImage: abort",!1,g,E),E.ontimeout=k(ar,v,"TestLoadImage: timeout",!1,g,E),u.setTimeout(function(){E.ontimeout&&E.ontimeout()},1e4),E.src=c}else g(!1)}function ih(c,g){const v=new fi,E=new AbortController,q=setTimeout(()=>{E.abort(),ar(v,"TestPingServer: timeout",!1,g)},1e4);fetch(c,{signal:E.signal}).then(Q=>{clearTimeout(q),Q.ok?ar(v,"TestPingServer: ok",!0,g):ar(v,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(q),ar(v,"TestPingServer: error",!1,g)})}function ar(c,g,v,E,q){try{q&&(q.onload=null,q.onerror=null,q.onabort=null,q.ontimeout=null),E(v)}catch{}}function Zl(){this.g=new yn}function Ql(c,g,v){const E=v||"";try{Ae(c,function(q,Q){let se=q;p(q)&&(se=ui(q)),g.push(E+Q+"="+encodeURIComponent(se))})}catch(q){throw g.push(E+"type="+encodeURIComponent("_badmap")),q}}function lr(c){this.l=c.Ub||null,this.j=c.eb||!1}P(lr,Lt),lr.prototype.g=function(){return new fs(this.l,this.j)},lr.prototype.i=function(c){return function(){return c}}({});function fs(c,g){yt.call(this),this.D=c,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}P(fs,yt),t=fs.prototype,t.open=function(c,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=g,this.readyState=1,$n(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(g.body=c),(this.D||u).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,xt(this)),this.readyState=0},t.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,$n(this)),this.g&&(this.readyState=3,$n(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ps(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function ps(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}t.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var g=c.value?c.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!c.done}))&&(this.response=this.responseText+=g)}c.done?xt(this):$n(this),this.readyState==3&&ps(this)}},t.Ra=function(c){this.g&&(this.response=this.responseText=c,xt(this))},t.Qa=function(c){this.g&&(this.response=c,xt(this))},t.ga=function(){this.g&&xt(this)};function xt(c){c.readyState=4,c.l=null,c.j=null,c.v=null,$n(c)}t.setRequestHeader=function(c,g){this.u.append(c,g)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],g=this.h.entries();for(var v=g.next();!v.done;)v=v.value,c.push(v[0]+": "+v[1]),v=g.next();return c.join(`\r
`)};function $n(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(fs.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function Yl(c){let g="";return F(c,function(v,E){g+=E,g+=":",g+=v,g+=`\r
`}),g}function wa(c,g,v){e:{for(E in v){var E=!1;break e}E=!0}E||(v=Yl(v),typeof c=="string"?v!=null&&encodeURIComponent(String(v)):Ce(c,g,v))}function mt(c){yt.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}P(mt,yt);var sh=/^https?$/i,Jl=["POST","PUT"];t=mt.prototype,t.Ha=function(c){this.J=c},t.ea=function(c,g,v,E){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);g=g?g.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():as.g(),this.v=this.o?An(this.o):An(as),this.g.onreadystatechange=x(this.Ea,this);try{this.B=!0,this.g.open(g,String(c),!0),this.B=!1}catch(Q){oh(this,Q);return}if(c=v||"",v=new Map(this.headers),E)if(Object.getPrototypeOf(E)===Object.prototype)for(var q in E)v.set(q,E[q]);else if(typeof E.keys=="function"&&typeof E.get=="function")for(const Q of E.keys())v.set(Q,E.get(Q));else throw Error("Unknown input type for opt_headers: "+String(E));E=Array.from(v.keys()).find(Q=>Q.toLowerCase()=="content-type"),q=u.FormData&&c instanceof u.FormData,!(0<=Array.prototype.indexOf.call(Jl,g,void 0))||E||q||v.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Q,se]of v)this.g.setRequestHeader(Q,se);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Nn(this),this.u=!0,this.g.send(c),this.u=!1}catch(Q){oh(this,Q)}};function oh(c,g){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=g,c.m=5,Xl(c),xa(c)}function Xl(c){c.A||(c.A=!0,Rt(c,"complete"),Rt(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,Rt(this,"complete"),Rt(this,"abort"),xa(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),xa(this,!0)),mt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Fe(this):this.bb())},t.bb=function(){Fe(this)};function Fe(c){if(c.h&&typeof a<"u"&&(!c.v[1]||vn(c)!=4||c.Z()!=2)){if(c.u&&vn(c)==4)fo(c.Ea,0,c);else if(Rt(c,"readystatechange"),vn(c)==4){c.h=!1;try{const se=c.Z();e:switch(se){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var v;if(!(v=g)){var E;if(E=se===0){var q=String(c.D).match(pt)[1]||null;!q&&u.self&&u.self.location&&(q=u.self.location.protocol.slice(0,-1)),E=!sh.test(q?q.toLowerCase():"")}v=E}if(v)Rt(c,"complete"),Rt(c,"success");else{c.m=6;try{var Q=2<vn(c)?c.g.statusText:""}catch{Q=""}c.l=Q+" ["+c.Z()+"]",Xl(c)}}finally{xa(c)}}}}function xa(c,g){if(c.g){Nn(c);const v=c.g,E=c.v[0]?()=>{}:null;c.g=null,c.v=null,g||Rt(c,"ready");try{v.onreadystatechange=E}catch{}}}function Nn(c){c.I&&(u.clearTimeout(c.I),c.I=null)}t.isActive=function(){return!!this.g};function vn(c){return c.g?c.g.readyState:0}t.Z=function(){try{return 2<vn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(c){if(this.g){var g=this.g.responseText;return c&&g.indexOf(c)==0&&(g=g.substring(c.length)),zl(g)}};function eu(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function wp(c){const g={};c=(c.g&&2<=vn(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let E=0;E<c.length;E++){if(S(c[E]))continue;var v=M(c[E]);const q=v[0];if(v=v[1],typeof v!="string")continue;v=v.trim();const Q=g[q]||[];g[q]=Q,Q.push(v)}I(g,function(E){return E.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function wi(c,g,v){return v&&v.internalChannelParams&&v.internalChannelParams[c]||g}function ah(c){this.Aa=0,this.i=[],this.j=new fi,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=wi("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=wi("baseRetryDelayMs",5e3,c),this.cb=wi("retryDelaySeedMs",1e4,c),this.Wa=wi("forwardChannelMaxRetries",2,c),this.wa=wi("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new Le(c&&c.concurrentRequestLimit),this.Da=new Zl,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=ah.prototype,t.la=8,t.G=1,t.connect=function(c,g,v,E){Vt(0),this.W=c,this.H=g||{},v&&E!==void 0&&(this.H.OSID=v,this.H.OAID=E),this.F=this.X,this.I=Pa(this,null,this.W),ms(this)};function ba(c){if(lh(c),c.G==3){var g=c.U++,v=St(c.I);if(Ce(v,"SID",c.K),Ce(v,"RID",g),Ce(v,"TYPE","terminate"),vo(c,v),g=new ye(c,c.j,g),g.L=2,g.v=sr(St(v)),v=!1,u.navigator&&u.navigator.sendBeacon)try{v=u.navigator.sendBeacon(g.v.toString(),"")}catch{}!v&&u.Image&&(new Image().src=g.v,v=!0),v||(g.g=ch(g.j,null),g.g.ea(g.v)),g.F=Date.now(),_i(g)}uh(c)}function Ta(c){c.g&&(Ia(c),c.g.cancel(),c.g=null)}function lh(c){Ta(c),c.u&&(u.clearTimeout(c.u),c.u=null),Sa(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&u.clearTimeout(c.s),c.s=null)}function ms(c){if(!vt(c.h)&&!c.s){c.s=!0;var g=c.Ga;tt||J(),K||(tt(),K=!0),ie.add(g,c),c.B=0}}function xp(c,g){return wt(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=g.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=di(x(c.Ga,c,g),ru(c,c.B)),c.B++,!0)}t.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;const q=new ye(this,this.j,c);let Q=this.o;if(this.S&&(Q?(Q=T(Q),A(Q,this.S)):Q=this.S),this.m!==null||this.O||(q.H=Q,Q=null),this.P)e:{for(var g=0,v=0;v<this.i.length;v++){t:{var E=this.i[v];if("__data__"in E.map&&(E=E.map.__data__,typeof E=="string")){E=E.length;break t}E=void 0}if(E===void 0)break;if(g+=E,4096<g){g=v;break e}if(g===4096||v===this.i.length-1){g=v+1;break e}}g=1e3}else g=1e3;g=tu(this,q,g),v=St(this.I),Ce(v,"RID",c),Ce(v,"CVER",22),this.D&&Ce(v,"X-HTTP-Session-Id",this.D),vo(this,v),Q&&(this.O?g="headers="+encodeURIComponent(String(Yl(Q)))+"&"+g:this.m&&wa(v,this.m,Q)),$e(this.h,q),this.Ua&&Ce(v,"TYPE","init"),this.P?(Ce(v,"$req",g),Ce(v,"SID","null"),q.T=!0,us(q,v,null)):us(q,v,g),this.G=2}}else this.G==3&&(c?Hn(this,c):this.i.length==0||vt(this.h)||Hn(this))};function Hn(c,g){var v;g?v=g.l:v=c.U++;const E=St(c.I);Ce(E,"SID",c.K),Ce(E,"RID",v),Ce(E,"AID",c.T),vo(c,E),c.m&&c.o&&wa(E,c.m,c.o),v=new ye(c,c.j,v,c.B+1),c.m===null&&(v.H=c.o),g&&(c.i=g.D.concat(c.i)),g=tu(c,v,1e3),v.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),$e(c.h,v),us(v,E,g)}function vo(c,g){c.H&&F(c.H,function(v,E){Ce(g,E,v)}),c.l&&Ae({},function(v,E){Ce(g,E,v)})}function tu(c,g,v){v=Math.min(c.i.length,v);var E=c.l?x(c.l.Na,c.l,c):null;e:{var q=c.i;let Q=-1;for(;;){const se=["count="+v];Q==-1?0<v?(Q=q[0].g,se.push("ofs="+Q)):Q=0:se.push("ofs="+Q);let Je=!0;for(let Ft=0;Ft<v;Ft++){let He=q[Ft].g;const it=q[Ft].map;if(He-=Q,0>He)Q=Math.max(0,q[Ft].g-100),Je=!1;else try{Ql(it,se,"req"+He+"_")}catch{E&&E(it)}}if(Je){E=se.join("&");break e}}}return c=c.i.splice(0,v),g.D=c,E}function Sr(c){if(!c.g&&!c.u){c.Y=1;var g=c.Fa;tt||J(),K||(tt(),K=!0),ie.add(g,c),c.v=0}}function Ea(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=di(x(c.Fa,c),ru(c,c.v)),c.v++,!0)}t.Fa=function(){if(this.u=null,ka(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=di(x(this.ab,this),c)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Vt(10),Ta(this),ka(this))};function Ia(c){c.A!=null&&(u.clearTimeout(c.A),c.A=null)}function ka(c){c.g=new ye(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var g=St(c.qa);Ce(g,"RID","rpc"),Ce(g,"SID",c.K),Ce(g,"AID",c.T),Ce(g,"CI",c.F?"0":"1"),!c.F&&c.ja&&Ce(g,"TO",c.ja),Ce(g,"TYPE","xmlhttp"),vo(c,g),c.m&&c.o&&wa(g,c.m,c.o),c.L&&(c.g.I=c.L);var v=c.g;c=c.ia,v.L=1,v.v=sr(St(g)),v.m=null,v.P=!0,cs(v,c)}t.Za=function(){this.C!=null&&(this.C=null,Ta(this),Ea(this),Vt(19))};function Sa(c){c.C!=null&&(u.clearTimeout(c.C),c.C=null)}function nu(c,g){var v=null;if(c.g==g){Sa(c),Ia(c),c.g=null;var E=2}else if(Re(c.h,g))v=g.D,zr(c.h,g),E=1;else return;if(c.G!=0){if(g.o)if(E==1){v=g.m?g.m.length:0,g=Date.now()-g.F;var q=c.B;E=is(),Rt(E,new pa(E,v)),ms(c)}else Sr(c);else if(q=g.s,q==3||q==0&&0<g.X||!(E==1&&xp(c,g)||E==2&&Ea(c)))switch(v&&0<v.length&&(g=c.h,g.i=g.i.concat(v)),q){case 1:xi(c,5);break;case 4:xi(c,10);break;case 3:xi(c,6);break;default:xi(c,2)}}}function ru(c,g){let v=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(v*=2),v*g}function xi(c,g){if(c.j.info("Error code "+g),g==2){var v=x(c.fb,c),E=c.Xa;const q=!E;E=new ir(E||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||_a(E,"https"),sr(E),q?rt(E.toString(),v):ih(E.toString(),v)}else Vt(2);c.G=0,c.l&&c.l.sa(g),uh(c),lh(c)}t.fb=function(c){c?(this.j.info("Successfully pinged google.com"),Vt(2)):(this.j.info("Failed to ping google.com"),Vt(1))};function uh(c){if(c.G=0,c.ka=[],c.l){const g=Er(c.h);(g.length!=0||c.i.length!=0)&&(B(c.ka,g),B(c.ka,c.i),c.h.i.length=0,j(c.i),c.i.length=0),c.l.ra()}}function Pa(c,g,v){var E=v instanceof ir?St(v):new ir(v);if(E.g!="")g&&(E.g=g+"."+E.g),yi(E,E.s);else{var q=u.location;E=q.protocol,g=g?g+"."+q.hostname:q.hostname,q=+q.port;var Q=new ir(null);E&&_a(Q,E),g&&(Q.g=g),q&&yi(Q,q),v&&(Q.l=v),E=Q}return v=c.D,g=c.ya,v&&g&&Ce(E,v,g),Ce(E,"VER",c.la),vo(c,E),E}function ch(c,g,v){if(g&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=c.Ca&&!c.pa?new mt(new lr({eb:v})):new mt(c.pa),g.Ha(c.J),g}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function iu(){}t=iu.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function wo(){}wo.prototype.g=function(c,g){return new Kt(c,g)};function Kt(c,g){yt.call(this),this.g=new ah(g),this.l=c,this.h=g&&g.messageUrlParams||null,c=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(c?c["X-WebChannel-Content-Type"]=g.messageContentType:c={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(c?c["X-WebChannel-Client-Profile"]=g.va:c={"X-WebChannel-Client-Profile":g.va}),this.g.S=c,(c=g&&g.Sb)&&!S(c)&&(this.g.m=c),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!S(g)&&(this.g.D=g,c=this.h,c!==null&&g in c&&(c=this.h,g in c&&delete c[g])),this.j=new ur(this)}P(Kt,yt),Kt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Kt.prototype.close=function(){ba(this.g)},Kt.prototype.o=function(c){var g=this.g;if(typeof c=="string"){var v={};v.__data__=c,c=v}else this.u&&(v={},v.__data__=ui(c),c=v);g.i.push(new xe(g.Ya++,c)),g.G==3&&ms(g)},Kt.prototype.N=function(){this.g.l=null,delete this.j,ba(this.g),delete this.g,Kt.aa.N.call(this)};function Hr(c){ci.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var g=c.__sm__;if(g){e:{for(const v in g){c=v;break e}c=void 0}(this.i=c)&&(c=this.i,g=g!==null&&c in g?g[c]:void 0),this.data=g}else this.data=c}P(Hr,ci);function hh(){rs.call(this),this.status=1}P(hh,rs);function ur(c){this.g=c}P(ur,iu),ur.prototype.ua=function(){Rt(this.g,"a")},ur.prototype.ta=function(c){Rt(this.g,new Hr(c))},ur.prototype.sa=function(c){Rt(this.g,new hh)},ur.prototype.ra=function(){Rt(this.g,"b")},wo.prototype.createWebChannel=wo.prototype.g,Kt.prototype.send=Kt.prototype.o,Kt.prototype.open=Kt.prototype.m,Kt.prototype.close=Kt.prototype.close,bI=function(){return new wo},xI=function(){return is()},wI=Be,xg={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},mi.NO_ERROR=0,mi.TIMEOUT=8,mi.HTTP_ERROR=6,md=mi,os.COMPLETE="complete",vI=os,xr.EventType=br,br.OPEN="a",br.CLOSE="b",br.ERROR="c",br.MESSAGE="d",yt.prototype.listen=yt.prototype.K,Nu=xr,mt.prototype.listenOnce=mt.prototype.L,mt.prototype.getLastError=mt.prototype.Ka,mt.prototype.getLastErrorCode=mt.prototype.Ba,mt.prototype.getStatus=mt.prototype.Z,mt.prototype.getResponseJson=mt.prototype.Oa,mt.prototype.getResponseText=mt.prototype.oa,mt.prototype.send=mt.prototype.ea,mt.prototype.setWithCredentials=mt.prototype.Ha,yI=mt}).apply(typeof Bh<"u"?Bh:typeof self<"u"?self:typeof window<"u"?window:{});const Aw="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let un=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};un.UNAUTHENTICATED=new un(null),un.GOOGLE_CREDENTIALS=new un("google-credentials-uid"),un.FIRST_PARTY=new un("first-party-uid"),un.MOCK_USER=new un("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ol="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ko=new W_("@firebase/firestore");function Fa(){return Ko.logLevel}function te(t,...e){if(Ko.logLevel<=ze.DEBUG){const n=e.map(sy);Ko.debug(`Firestore (${Ol}): ${t}`,...n)}}function Mt(t,...e){if(Ko.logLevel<=ze.ERROR){const n=e.map(sy);Ko.error(`Firestore (${Ol}): ${t}`,...n)}}function wc(t,...e){if(Ko.logLevel<=ze.WARN){const n=e.map(sy);Ko.warn(`Firestore (${Ol}): ${t}`,...n)}}function sy(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function de(t="Unexpected state"){const e=`FIRESTORE (${Ol}) INTERNAL ASSERTION FAILED: `+t;throw Mt(e),new Error(e)}function ge(t,e){t||de()}function fe(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class oe extends vr{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yL{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class vL{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(un.UNAUTHENTICATED))}shutdown(){}}class wL{constructor(e){this.t=e,this.currentUser=un.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){ge(this.o===void 0);let r=this.i;const i=d=>this.i!==r?(r=this.i,n(d)):Promise.resolve();let o=new ri;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new ri,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const d=o;e.enqueueRetryable(async()=>{await d.promise,await i(this.currentUser)})},u=d=>{te("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(d=>u(d)),setTimeout(()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?u(d):(te("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new ri)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(te("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ge(typeof r.accessToken=="string"),new yL(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ge(e===null||typeof e=="string"),new un(e)}}class xL{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=un.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class bL{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new xL(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(un.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class TL{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class EL{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){ge(this.o===void 0);const r=o=>{o.error!=null&&te("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const a=o.token!==this.R;return this.R=o.token,te("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};const i=o=>{te("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){const o=this.A.getImmediate({optional:!0});o?i(o):te("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(ge(typeof n.token=="string"),this.R=n.token,new TL(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IL(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TI{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=IL(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<n&&(r+=e.charAt(i[o]%e.length))}return r}}function Ne(t,e){return t<e?-1:t>e?1:0}function xl(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function EI(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ke{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new oe(Y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new oe(Y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new oe(Y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new oe(Y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ke.fromMillis(Date.now())}static fromDate(e){return Ke.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Ke(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ne(this.nanoseconds,e.nanoseconds):Ne(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ve{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ve(e)}static min(){return new ve(new Ke(0,0))}static max(){return new ve(new Ke(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xc{constructor(e,n,r){n===void 0?n=0:n>e.length&&de(),r===void 0?r=e.length-n:r>e.length-n&&de(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return xc.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof xc?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const o=e.get(i),a=n.get(i);if(o<a)return-1;if(o>a)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Qe extends xc{construct(e,n,r){return new Qe(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new oe(Y.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new Qe(n)}static emptyPath(){return new Qe([])}}const kL=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Et extends xc{construct(e,n,r){return new Et(e,n,r)}static isValidIdentifier(e){return kL.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Et.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Et(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const o=()=>{if(r.length===0)throw new oe(Y.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let a=!1;for(;i<e.length;){const u=e[i];if(u==="\\"){if(i+1===e.length)throw new oe(Y.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[i+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new oe(Y.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=d,i+=2}else u==="`"?(a=!a,i++):u!=="."||a?(r+=u,i++):(o(),i++)}if(o(),a)throw new oe(Y.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Et(n)}static emptyPath(){return new Et([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class le{constructor(e){this.path=e}static fromPath(e){return new le(Qe.fromString(e))}static fromName(e){return new le(Qe.fromString(e).popFirst(5))}static empty(){return new le(Qe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Qe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Qe.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new le(new Qe(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class of{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function bg(t){return t.fields.find(e=>e.kind===2)}function Io(t){return t.fields.filter(e=>e.kind!==2)}of.UNKNOWN_ID=-1;class gd{constructor(e,n){this.fieldPath=e,this.kind=n}}class bc{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new bc(0,tr.min())}}function II(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=ve.fromTimestamp(r===1e9?new Ke(n+1,0):new Ke(n,r));return new tr(i,le.empty(),e)}function kI(t){return new tr(t.readTime,t.key,-1)}class tr{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new tr(ve.min(),le.empty(),-1)}static max(){return new tr(ve.max(),le.empty(),-1)}}function oy(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=le.comparator(t.documentKey,e.documentKey),n!==0?n:Ne(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class PI{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function io(t){if(t.code!==Y.FAILED_PRECONDITION||t.message!==SI)throw t;te("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&de(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new H((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(n,o).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof H?n:H.resolve(n)}catch(n){return H.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):H.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):H.reject(n)}static resolve(e){return new H((n,r)=>{n(e)})}static reject(e){return new H((n,r)=>{r(e)})}static waitFor(e){return new H((n,r)=>{let i=0,o=0,a=!1;e.forEach(u=>{++i,u.next(()=>{++o,a&&o===i&&n()},d=>r(d))}),a=!0,o===i&&n()})}static or(e){let n=H.resolve(!1);for(const r of e)n=n.next(i=>i?H.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,o)=>{r.push(n.call(this,i,o))}),this.waitFor(r)}static mapArray(e,n){return new H((r,i)=>{const o=e.length,a=new Array(o);let u=0;for(let d=0;d<o;d++){const p=d;n(e[p]).next(_=>{a[p]=_,++u,u===o&&r(a)},_=>i(_))}})}static doWhile(e,n){return new H((r,i)=>{const o=()=>{e()===!0?n().next(()=>{o()},i):r()};o()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hf{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new ri,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new Wu(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=ay(r.target.error);this.V.reject(new Wu(e,i))}}static open(e,n,r,i){try{return new Hf(n,e.transaction(i,r))}catch(o){throw new Wu(n,o)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(te("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new PL(n)}}class Ws{constructor(e,n,r){this.name=e,this.version=n,this.p=r,Ws.S(Wt())===12.2&&Mt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return te("SimpleDb","Removing database:",e),ko(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!H_())return!1;if(Ws.v())return!0;const e=Wt(),n=Ws.S(e),r=0<n&&n<10,i=AI(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(te("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=o=>{const a=o.target.result;n(a)},i.onblocked=()=>{r(new Wu(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=o=>{const a=o.target.error;a.name==="VersionError"?r(new oe(Y.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):a.name==="InvalidStateError"?r(new oe(Y.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a)):r(new Wu(e,a))},i.onupgradeneeded=o=>{te("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);const a=o.target.result;this.p.O(a,i.transaction,o.oldVersion,this.version).next(()=>{te("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=n=>this.N(n)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const o=n==="readonly";let a=0;for(;;){++a;try{this.db=await this.M(e);const u=Hf.open(this.db,e,o?"readonly":"readwrite",r),d=i(u).next(p=>(u.g(),p)).catch(p=>(u.abort(p),H.reject(p))).toPromise();return d.catch(()=>{}),await u.m,d}catch(u){const d=u,p=d.name!=="FirebaseError"&&a<3;if(te("SimpleDb","Transaction failed with error:",d.message,"Retrying:",p),this.close(),!p)return Promise.reject(d)}}}close(){this.db&&this.db.close(),this.db=void 0}}function AI(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class SL{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return ko(this.B.delete())}}class Wu extends oe{constructor(e,n){super(Y.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function so(t){return t.name==="IndexedDbTransactionError"}class PL{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(te("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(te("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),ko(r)}add(e){return te("SimpleDb","ADD",this.store.name,e,e),ko(this.store.add(e))}get(e){return ko(this.store.get(e)).next(n=>(n===void 0&&(n=null),te("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return te("SimpleDb","DELETE",this.store.name,e),ko(this.store.delete(e))}count(){return te("SimpleDb","COUNT",this.store.name),ko(this.store.count())}U(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const o=i.getAll(r.range);return new H((a,u)=>{o.onerror=d=>{u(d.target.error)},o.onsuccess=d=>{a(d.target.result)}})}{const o=this.cursor(r),a=[];return this.W(o,(u,d)=>{a.push(d)}).next(()=>a)}}G(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new H((i,o)=>{r.onerror=a=>{o(a.target.error)},r.onsuccess=a=>{i(a.target.result)}})}j(e,n){te("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.H=!1;const i=this.cursor(r);return this.W(i,(o,a,u)=>u.delete())}J(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.W(i,n)}Y(e){const n=this.cursor({});return new H((r,i)=>{n.onerror=o=>{const a=ay(o.target.error);i(a)},n.onsuccess=o=>{const a=o.target.result;a?e(a.primaryKey,a.value).next(u=>{u?a.continue():r()}):r()}})}W(e,n){const r=[];return new H((i,o)=>{e.onerror=a=>{o(a.target.error)},e.onsuccess=a=>{const u=a.target.result;if(!u)return void i();const d=new SL(u),p=n(u.primaryKey,u.value,d);if(p instanceof H){const _=p.catch(w=>(d.done(),H.reject(w)));r.push(_)}d.isDone?i():d.K===null?u.continue():u.continue(d.K)}}).next(()=>H.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function ko(t){return new H((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=ay(r.target.error);n(i)}})}let Cw=!1;function ay(t){const e=Ws.S(Wt());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new oe("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Cw||(Cw=!0,setTimeout(()=>{throw r},0)),r}}return t}class AL{constructor(e,n){this.asyncQueue=e,this.Z=n,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){te("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{te("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(n){so(n)?te("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):await io(n)}await this.X(6e4)})}}class CL{constructor(e,n){this.localStore=e,this.persistence=n}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.te(n,e))}te(e,n){const r=new Set;let i=n,o=!0;return H.doWhile(()=>o===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(a=>{if(a!==null&&!r.has(a))return te("IndexBackfiller",`Processing collection: ${a}`),this.ne(e,a,i).next(u=>{i-=u,r.add(a)});o=!1})).next(()=>n-i)}ne(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(o=>{const a=o.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next(()=>this.re(i,o)).next(u=>(te("IndexBackfiller",`Updating offset: ${u}`),this.localStore.indexManager.updateCollectionGroup(e,n,u))).next(()=>a.size)}))}re(e,n){let r=e;return n.changes.forEach((i,o)=>{const a=kI(o);oy(a,r)>0&&(r=a)}),new tr(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}On.oe=-1;function Wf(t){return t==null}function Tc(t){return t===0&&1/t==-1/0}function CI(t){return typeof t=="number"&&Number.isInteger(t)&&!Tc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function In(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=Nw(e)),e=NL(t.get(n),e);return Nw(e)}function NL(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function Nw(t){return t+""}function Yr(t){const e=t.length;if(ge(e>=2),e===2)return ge(t.charAt(0)===""&&t.charAt(1)===""),Qe.emptyPath();const n=e-2,r=[];let i="";for(let o=0;o<e;){const a=t.indexOf("",o);switch((a<0||a>n)&&de(),t.charAt(a+1)){case"":const u=t.substring(o,a);let d;i.length===0?d=u:(i+=u,d=i,i=""),r.push(d);break;case"":i+=t.substring(o,a),i+="\0";break;case"":i+=t.substring(o,a+1);break;default:de()}o=a+2}return new Qe(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rw=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _d(t,e){return[t,In(e)]}function NI(t,e,n){return[t,In(e),n]}const RL={},LL=["prefixPath","collectionGroup","readTime","documentId"],DL=["prefixPath","collectionGroup","documentId"],jL=["collectionGroup","readTime","prefixPath","documentId"],ML=["canonicalId","targetId"],OL=["targetId","path"],VL=["path","targetId"],FL=["collectionId","parent"],UL=["indexId","uid"],BL=["uid","sequenceNumber"],zL=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],qL=["indexId","uid","orderedDocumentKey"],$L=["userId","collectionPath","documentId"],HL=["userId","collectionPath","largestBatchId"],WL=["userId","collectionGroup","largestBatchId"],RI=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],GL=[...RI,"documentOverlays"],LI=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],DI=LI,ly=[...DI,"indexConfiguration","indexState","indexEntries"],KL=ly,ZL=[...ly,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tg extends PI{constructor(e,n){super(),this._e=e,this.currentSequenceNumber=n}}function Gt(t,e){const n=fe(t);return Ws.F(n._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lw(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ua(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function jI(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ut{constructor(e,n){this.comparator=e,this.root=n||nn.EMPTY}insert(e,n){return new ut(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,nn.BLACK,null,null))}remove(e){return new ut(this.comparator,this.root.remove(e,this.comparator).copy(null,null,nn.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new zh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new zh(this.root,e,this.comparator,!1)}getReverseIterator(){return new zh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new zh(this.root,e,this.comparator,!0)}}class zh{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=n?r(e.key,n):1,n&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class nn{constructor(e,n,r,i,o){this.key=e,this.value=n,this.color=r??nn.RED,this.left=i??nn.EMPTY,this.right=o??nn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,o){return new nn(e??this.key,n??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,n,r),null):o===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return nn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return nn.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,nn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,nn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw de();const e=this.left.check();if(e!==this.right.check())throw de();return e+(this.isRed()?0:1)}}nn.EMPTY=null,nn.RED=!0,nn.BLACK=!1;nn.EMPTY=new class{constructor(){this.size=0}get key(){throw de()}get value(){throw de()}get color(){throw de()}get left(){throw de()}get right(){throw de()}copy(e,n,r,i,o){return this}insert(e,n,r){return new nn(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ot{constructor(e){this.comparator=e,this.data=new ut(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Dw(this.data.getIterator())}getIteratorFrom(e){return new Dw(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof ot)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new ot(this.comparator);return n.data=e,n}}class Dw{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function ja(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{constructor(e){this.fields=e,e.sort(Et.comparator)}static empty(){return new Vn([])}unionWith(e){let n=new ot(Et.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Vn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return xl(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MI extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ot{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new MI("Invalid base64 string: "+o):o}}(e);return new Ot(n)}static fromUint8Array(e){const n=function(i){let o="";for(let a=0;a<i.length;++a)o+=String.fromCharCode(i[a]);return o}(e);return new Ot(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ne(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ot.EMPTY_BYTE_STRING=new Ot("");const QL=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Hi(t){if(ge(!!t),typeof t=="string"){let e=0;const n=QL.exec(t);if(ge(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:gt(t.seconds),nanos:gt(t.nanos)}}function gt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ys(t){return typeof t=="string"?Ot.fromBase64String(t):Ot.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uy(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function cy(t){const e=t.mapValue.fields.__previous_value__;return uy(e)?cy(e):e}function Ec(t){const e=Hi(t.mapValue.fields.__local_write_time__.timestampValue);return new Ke(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YL{constructor(e,n,r,i,o,a,u,d,p){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=d,this.useFetchStreams=p}}class Zo{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Zo("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Zo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const js={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},yd={nullValue:"NULL_VALUE"};function Qo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?uy(t)?4:OI(t)?9007199254740991:Gf(t)?10:11:de()}function ii(t,e){if(t===e)return!0;const n=Qo(t);if(n!==Qo(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ec(t).isEqual(Ec(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const a=Hi(i.timestampValue),u=Hi(o.timestampValue);return a.seconds===u.seconds&&a.nanos===u.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,o){return Ys(i.bytesValue).isEqual(Ys(o.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,o){return gt(i.geoPointValue.latitude)===gt(o.geoPointValue.latitude)&&gt(i.geoPointValue.longitude)===gt(o.geoPointValue.longitude)}(t,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return gt(i.integerValue)===gt(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const a=gt(i.doubleValue),u=gt(o.doubleValue);return a===u?Tc(a)===Tc(u):isNaN(a)&&isNaN(u)}return!1}(t,e);case 9:return xl(t.arrayValue.values||[],e.arrayValue.values||[],ii);case 10:case 11:return function(i,o){const a=i.mapValue.fields||{},u=o.mapValue.fields||{};if(Lw(a)!==Lw(u))return!1;for(const d in a)if(a.hasOwnProperty(d)&&(u[d]===void 0||!ii(a[d],u[d])))return!1;return!0}(t,e);default:return de()}}function Ic(t,e){return(t.values||[]).find(n=>ii(n,e))!==void 0}function Js(t,e){if(t===e)return 0;const n=Qo(t),r=Qo(e);if(n!==r)return Ne(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ne(t.booleanValue,e.booleanValue);case 2:return function(o,a){const u=gt(o.integerValue||o.doubleValue),d=gt(a.integerValue||a.doubleValue);return u<d?-1:u>d?1:u===d?0:isNaN(u)?isNaN(d)?0:-1:1}(t,e);case 3:return jw(t.timestampValue,e.timestampValue);case 4:return jw(Ec(t),Ec(e));case 5:return Ne(t.stringValue,e.stringValue);case 6:return function(o,a){const u=Ys(o),d=Ys(a);return u.compareTo(d)}(t.bytesValue,e.bytesValue);case 7:return function(o,a){const u=o.split("/"),d=a.split("/");for(let p=0;p<u.length&&p<d.length;p++){const _=Ne(u[p],d[p]);if(_!==0)return _}return Ne(u.length,d.length)}(t.referenceValue,e.referenceValue);case 8:return function(o,a){const u=Ne(gt(o.latitude),gt(a.latitude));return u!==0?u:Ne(gt(o.longitude),gt(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Mw(t.arrayValue,e.arrayValue);case 10:return function(o,a){var u,d,p,_;const w=o.fields||{},x=a.fields||{},k=(u=w.value)===null||u===void 0?void 0:u.arrayValue,P=(d=x.value)===null||d===void 0?void 0:d.arrayValue,j=Ne(((p=k==null?void 0:k.values)===null||p===void 0?void 0:p.length)||0,((_=P==null?void 0:P.values)===null||_===void 0?void 0:_.length)||0);return j!==0?j:Mw(k,P)}(t.mapValue,e.mapValue);case 11:return function(o,a){if(o===js.mapValue&&a===js.mapValue)return 0;if(o===js.mapValue)return 1;if(a===js.mapValue)return-1;const u=o.fields||{},d=Object.keys(u),p=a.fields||{},_=Object.keys(p);d.sort(),_.sort();for(let w=0;w<d.length&&w<_.length;++w){const x=Ne(d[w],_[w]);if(x!==0)return x;const k=Js(u[d[w]],p[_[w]]);if(k!==0)return k}return Ne(d.length,_.length)}(t.mapValue,e.mapValue);default:throw de()}}function jw(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ne(t,e);const n=Hi(t),r=Hi(e),i=Ne(n.seconds,r.seconds);return i!==0?i:Ne(n.nanos,r.nanos)}function Mw(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const o=Js(n[i],r[i]);if(o)return o}return Ne(n.length,r.length)}function bl(t){return Eg(t)}function Eg(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Hi(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Ys(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return le.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const o of n.values||[])i?i=!1:r+=",",r+=Eg(o);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",o=!0;for(const a of r)o?o=!1:i+=",",i+=`${a}:${Eg(n.fields[a])}`;return i+"}"}(t.mapValue):de()}function kc(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Ig(t){return!!t&&"integerValue"in t}function Sc(t){return!!t&&"arrayValue"in t}function Ow(t){return!!t&&"nullValue"in t}function Vw(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function vd(t){return!!t&&"mapValue"in t}function Gf(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Gu(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return ua(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Gu(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Gu(t.arrayValue.values[n]);return e}return Object.assign({},t)}function OI(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const VI={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function JL(t){return"nullValue"in t?yd:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?kc(Zo.empty(),le.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?Gf(t)?VI:{mapValue:{}}:de()}function XL(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?kc(Zo.empty(),le.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?VI:"mapValue"in t?Gf(t)?{mapValue:{}}:js:de()}function Fw(t,e){const n=Js(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function Uw(t,e){const n=Js(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hn{constructor(e){this.value=e}static empty(){return new hn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!vd(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Gu(n)}setAll(e){let n=Et.emptyPath(),r={},i=[];e.forEach((a,u)=>{if(!n.isImmediateParentOf(u)){const d=this.getFieldsMap(n);this.applyChanges(d,r,i),r={},i=[],n=u.popLast()}a?r[u.lastSegment()]=Gu(a):i.push(u.lastSegment())});const o=this.getFieldsMap(n);this.applyChanges(o,r,i)}delete(e){const n=this.field(e.popLast());vd(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return ii(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];vd(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){ua(n,(i,o)=>e[i]=o);for(const i of r)delete e[i]}clone(){return new hn(Gu(this.value))}}function FI(t){const e=[];return ua(t.fields,(n,r)=>{const i=new Et([n]);if(vd(r)){const o=FI(r.mapValue).fields;if(o.length===0)e.push(i);else for(const a of o)e.push(i.child(a))}else e.push(i)}),new Vn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class At{constructor(e,n,r,i,o,a,u){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=o,this.data=a,this.documentState=u}static newInvalidDocument(e){return new At(e,0,ve.min(),ve.min(),ve.min(),hn.empty(),0)}static newFoundDocument(e,n,r,i){return new At(e,1,n,ve.min(),r,i,0)}static newNoDocument(e,n){return new At(e,2,n,ve.min(),ve.min(),hn.empty(),0)}static newUnknownDocument(e,n){return new At(e,3,n,ve.min(),ve.min(),hn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ve.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=hn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=hn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ve.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof At&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new At(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tl{constructor(e,n){this.position=e,this.inclusive=n}}function Bw(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const o=e[i],a=t.position[i];if(o.field.isKeyField()?r=le.comparator(le.fromName(a.referenceValue),n.key):r=Js(a,n.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function zw(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ii(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pc{constructor(e,n="asc"){this.field=e,this.dir=n}}function eD(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UI{}class qe extends UI{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new tD(e,n,r):n==="array-contains"?new iD(e,r):n==="in"?new WI(e,r):n==="not-in"?new sD(e,r):n==="array-contains-any"?new oD(e,r):new qe(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new nD(e,r):new rD(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Js(n,this.value)):n!==null&&Qo(this.value)===Qo(n)&&this.matchesComparison(Js(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return de()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Xe extends UI{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Xe(e,n)}matches(e){return El(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function El(t){return t.op==="and"}function kg(t){return t.op==="or"}function hy(t){return BI(t)&&El(t)}function BI(t){for(const e of t.filters)if(e instanceof Xe)return!1;return!0}function Sg(t){if(t instanceof qe)return t.field.canonicalString()+t.op.toString()+bl(t.value);if(hy(t))return t.filters.map(e=>Sg(e)).join(",");{const e=t.filters.map(n=>Sg(n)).join(",");return`${t.op}(${e})`}}function zI(t,e){return t instanceof qe?function(r,i){return i instanceof qe&&r.op===i.op&&r.field.isEqual(i.field)&&ii(r.value,i.value)}(t,e):t instanceof Xe?function(r,i){return i instanceof Xe&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,a,u)=>o&&zI(a,i.filters[u]),!0):!1}(t,e):void de()}function qI(t,e){const n=t.filters.concat(e);return Xe.create(n,t.op)}function $I(t){return t instanceof qe?function(n){return`${n.field.canonicalString()} ${n.op} ${bl(n.value)}`}(t):t instanceof Xe?function(n){return n.op.toString()+" {"+n.getFilters().map($I).join(" ,")+"}"}(t):"Filter"}class tD extends qe{constructor(e,n,r){super(e,n,r),this.key=le.fromName(r.referenceValue)}matches(e){const n=le.comparator(e.key,this.key);return this.matchesComparison(n)}}class nD extends qe{constructor(e,n){super(e,"in",n),this.keys=HI("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class rD extends qe{constructor(e,n){super(e,"not-in",n),this.keys=HI("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function HI(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>le.fromName(r.referenceValue))}class iD extends qe{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Sc(n)&&Ic(n.arrayValue,this.value)}}class WI extends qe{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Ic(this.value.arrayValue,n)}}class sD extends qe{constructor(e,n){super(e,"not-in",n)}matches(e){if(Ic(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Ic(this.value.arrayValue,n)}}class oD extends qe{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Sc(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Ic(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aD{constructor(e,n=null,r=[],i=[],o=null,a=null,u=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=a,this.endAt=u,this.ue=null}}function Pg(t,e=null,n=[],r=[],i=null,o=null,a=null){return new aD(t,e,n,r,i,o,a)}function Yo(t){const e=fe(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Sg(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),Wf(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>bl(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>bl(r)).join(",")),e.ue=n}return e.ue}function Zc(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!eD(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!zI(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!zw(t.startAt,e.startAt)&&zw(t.endAt,e.endAt)}function af(t){return le.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function lf(t,e){return t.filters.filter(n=>n instanceof qe&&n.field.isEqual(e))}function qw(t,e,n){let r=yd,i=!0;for(const o of lf(t,e)){let a=yd,u=!0;switch(o.op){case"<":case"<=":a=JL(o.value);break;case"==":case"in":case">=":a=o.value;break;case">":a=o.value,u=!1;break;case"!=":case"not-in":a=yd}Fw({value:r,inclusive:i},{value:a,inclusive:u})<0&&(r=a,i=u)}if(n!==null){for(let o=0;o<t.orderBy.length;++o)if(t.orderBy[o].field.isEqual(e)){const a=n.position[o];Fw({value:r,inclusive:i},{value:a,inclusive:n.inclusive})<0&&(r=a,i=n.inclusive);break}}return{value:r,inclusive:i}}function $w(t,e,n){let r=js,i=!0;for(const o of lf(t,e)){let a=js,u=!0;switch(o.op){case">=":case">":a=XL(o.value),u=!1;break;case"==":case"in":case"<=":a=o.value;break;case"<":a=o.value,u=!1;break;case"!=":case"not-in":a=js}Uw({value:r,inclusive:i},{value:a,inclusive:u})>0&&(r=a,i=u)}if(n!==null){for(let o=0;o<t.orderBy.length;++o)if(t.orderBy[o].field.isEqual(e)){const a=n.position[o];Uw({value:r,inclusive:i},{value:a,inclusive:n.inclusive})>0&&(r=a,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vl{constructor(e,n=null,r=[],i=[],o=null,a="F",u=null,d=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=a,this.startAt=u,this.endAt=d,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function GI(t,e,n,r,i,o,a,u){return new Vl(t,e,n,r,i,o,a,u)}function Qc(t){return new Vl(t)}function Hw(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function KI(t){return t.collectionGroup!==null}function Ku(t){const e=fe(t);if(e.ce===null){e.ce=[];const n=new Set;for(const o of e.explicitOrderBy)e.ce.push(o),n.add(o.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let u=new ot(Et.comparator);return a.filters.forEach(d=>{d.getFlattenedFilters().forEach(p=>{p.isInequality()&&(u=u.add(p.field))})}),u})(e).forEach(o=>{n.has(o.canonicalString())||o.isKeyField()||e.ce.push(new Pc(o,r))}),n.has(Et.keyField().canonicalString())||e.ce.push(new Pc(Et.keyField(),r))}return e.ce}function Yn(t){const e=fe(t);return e.le||(e.le=lD(e,Ku(t))),e.le}function lD(t,e){if(t.limitType==="F")return Pg(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const o=i.dir==="desc"?"asc":"desc";return new Pc(i.field,o)});const n=t.endAt?new Tl(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Tl(t.startAt.position,t.startAt.inclusive):null;return Pg(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Ag(t,e){const n=t.filters.concat([e]);return new Vl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Cg(t,e,n){return new Vl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Kf(t,e){return Zc(Yn(t),Yn(e))&&t.limitType===e.limitType}function ZI(t){return`${Yo(Yn(t))}|lt:${t.limitType}`}function Ua(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>$I(i)).join(", ")}]`),Wf(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>bl(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>bl(i)).join(",")),`Target(${r})`}(Yn(t))}; limitType=${t.limitType})`}function Yc(t,e){return e.isFoundDocument()&&function(r,i){const o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):le.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(t,e)&&function(r,i){for(const o of Ku(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const o of r.filters)if(!o.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(a,u,d){const p=Bw(a,u,d);return a.inclusive?p<=0:p<0}(r.startAt,Ku(r),i)||r.endAt&&!function(a,u,d){const p=Bw(a,u,d);return a.inclusive?p>=0:p>0}(r.endAt,Ku(r),i))}(t,e)}function QI(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function YI(t){return(e,n)=>{let r=!1;for(const i of Ku(t)){const o=uD(i,e,n);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function uD(t,e,n){const r=t.field.isKeyField()?le.comparator(e.key,n.key):function(o,a,u){const d=a.data.field(o),p=u.data.field(o);return d!==null&&p!==null?Js(d,p):de()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return de()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oo{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ua(this.inner,(n,r)=>{for(const[i,o]of r)e(i,o)})}isEmpty(){return jI(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cD=new ut(le.comparator);function Kn(){return cD}const JI=new ut(le.comparator);function Ru(...t){let e=JI;for(const n of t)e=e.insert(n.key,n);return e}function XI(t){let e=JI;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Jr(){return Zu()}function ek(){return Zu()}function Zu(){return new oo(t=>t.toString(),(t,e)=>t.isEqual(e))}const hD=new ut(le.comparator),dD=new ot(le.comparator);function je(...t){let e=dD;for(const n of t)e=e.add(n);return e}const fD=new ot(Ne);function dy(){return fD}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fy(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Tc(e)?"-0":e}}function tk(t){return{integerValue:""+t}}function pD(t,e){return CI(e)?tk(e):fy(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zf{constructor(){this._=void 0}}function mD(t,e,n){return t instanceof Ac?function(i,o){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&uy(o)&&(o=cy(o)),o&&(a.fields.__previous_value__=o),{mapValue:a}}(n,e):t instanceof Il?rk(t,e):t instanceof kl?ik(t,e):function(i,o){const a=nk(i,o),u=Ww(a)+Ww(i.Pe);return Ig(a)&&Ig(i.Pe)?tk(u):fy(i.serializer,u)}(t,e)}function gD(t,e,n){return t instanceof Il?rk(t,e):t instanceof kl?ik(t,e):n}function nk(t,e){return t instanceof Cc?function(r){return Ig(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}class Ac extends Zf{}class Il extends Zf{constructor(e){super(),this.elements=e}}function rk(t,e){const n=sk(e);for(const r of t.elements)n.some(i=>ii(i,r))||n.push(r);return{arrayValue:{values:n}}}class kl extends Zf{constructor(e){super(),this.elements=e}}function ik(t,e){let n=sk(e);for(const r of t.elements)n=n.filter(i=>!ii(i,r));return{arrayValue:{values:n}}}class Cc extends Zf{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function Ww(t){return gt(t.integerValue||t.doubleValue)}function sk(t){return Sc(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _D{constructor(e,n){this.field=e,this.transform=n}}function yD(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Il&&i instanceof Il||r instanceof kl&&i instanceof kl?xl(r.elements,i.elements,ii):r instanceof Cc&&i instanceof Cc?ii(r.Pe,i.Pe):r instanceof Ac&&i instanceof Ac}(t.transform,e.transform)}class vD{constructor(e,n){this.version=e,this.transformResults=n}}class dn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new dn}static exists(e){return new dn(void 0,e)}static updateTime(e){return new dn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function wd(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Qf{}function ok(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Yf(t.key,dn.none()):new Fl(t.key,t.data,dn.none());{const n=t.data,r=hn.empty();let i=new ot(Et.comparator);for(let o of e.fields)if(!i.has(o)){let a=n.field(o);a===null&&o.length>1&&(o=o.popLast(),a=n.field(o)),a===null?r.delete(o):r.set(o,a),i=i.add(o)}return new Qi(t.key,r,new Vn(i.toArray()),dn.none())}}function wD(t,e,n){t instanceof Fl?function(i,o,a){const u=i.value.clone(),d=Kw(i.fieldTransforms,o,a.transformResults);u.setAll(d),o.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(t,e,n):t instanceof Qi?function(i,o,a){if(!wd(i.precondition,o))return void o.convertToUnknownDocument(a.version);const u=Kw(i.fieldTransforms,o,a.transformResults),d=o.data;d.setAll(ak(i)),d.setAll(u),o.convertToFoundDocument(a.version,d).setHasCommittedMutations()}(t,e,n):function(i,o,a){o.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function Qu(t,e,n,r){return t instanceof Fl?function(o,a,u,d){if(!wd(o.precondition,a))return u;const p=o.value.clone(),_=Zw(o.fieldTransforms,d,a);return p.setAll(_),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),null}(t,e,n,r):t instanceof Qi?function(o,a,u,d){if(!wd(o.precondition,a))return u;const p=Zw(o.fieldTransforms,d,a),_=a.data;return _.setAll(ak(o)),_.setAll(p),a.convertToFoundDocument(a.version,_).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(w=>w.field))}(t,e,n,r):function(o,a,u){return wd(o.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):u}(t,e,n)}function xD(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),o=nk(r.transform,i||null);o!=null&&(n===null&&(n=hn.empty()),n.set(r.field,o))}return n||null}function Gw(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&xl(r,i,(o,a)=>yD(o,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Fl extends Qf{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Qi extends Qf{constructor(e,n,r,i,o=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function ak(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Kw(t,e,n){const r=new Map;ge(t.length===n.length);for(let i=0;i<n.length;i++){const o=t[i],a=o.transform,u=e.data.field(o.field);r.set(o.field,gD(a,u,n[i]))}return r}function Zw(t,e,n){const r=new Map;for(const i of t){const o=i.transform,a=n.data.field(i.field);r.set(i.field,mD(o,a,e))}return r}class Yf extends Qf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class lk extends Qf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class py{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&wD(o,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Qu(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Qu(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=ek();return this.mutations.forEach(i=>{const o=e.get(i.key),a=o.overlayedDocument;let u=this.applyToLocalView(a,o.mutatedFields);u=n.has(i.key)?null:u;const d=ok(a,u);d!==null&&r.set(i.key,d),a.isValidDocument()||a.convertToNoDocument(ve.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),je())}isEqual(e){return this.batchId===e.batchId&&xl(this.mutations,e.mutations,(n,r)=>Gw(n,r))&&xl(this.baseMutations,e.baseMutations,(n,r)=>Gw(n,r))}}class my{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){ge(e.mutations.length===r.length);let i=function(){return hD}();const o=e.mutations;for(let a=0;a<o.length;a++)i=i.insert(o[a].key,r[a].version);return new my(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gy{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bD{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Bt,We;function TD(t){switch(t){default:return de();case Y.CANCELLED:case Y.UNKNOWN:case Y.DEADLINE_EXCEEDED:case Y.RESOURCE_EXHAUSTED:case Y.INTERNAL:case Y.UNAVAILABLE:case Y.UNAUTHENTICATED:return!1;case Y.INVALID_ARGUMENT:case Y.NOT_FOUND:case Y.ALREADY_EXISTS:case Y.PERMISSION_DENIED:case Y.FAILED_PRECONDITION:case Y.ABORTED:case Y.OUT_OF_RANGE:case Y.UNIMPLEMENTED:case Y.DATA_LOSS:return!0}}function uk(t){if(t===void 0)return Mt("GRPC error has no .code"),Y.UNKNOWN;switch(t){case Bt.OK:return Y.OK;case Bt.CANCELLED:return Y.CANCELLED;case Bt.UNKNOWN:return Y.UNKNOWN;case Bt.DEADLINE_EXCEEDED:return Y.DEADLINE_EXCEEDED;case Bt.RESOURCE_EXHAUSTED:return Y.RESOURCE_EXHAUSTED;case Bt.INTERNAL:return Y.INTERNAL;case Bt.UNAVAILABLE:return Y.UNAVAILABLE;case Bt.UNAUTHENTICATED:return Y.UNAUTHENTICATED;case Bt.INVALID_ARGUMENT:return Y.INVALID_ARGUMENT;case Bt.NOT_FOUND:return Y.NOT_FOUND;case Bt.ALREADY_EXISTS:return Y.ALREADY_EXISTS;case Bt.PERMISSION_DENIED:return Y.PERMISSION_DENIED;case Bt.FAILED_PRECONDITION:return Y.FAILED_PRECONDITION;case Bt.ABORTED:return Y.ABORTED;case Bt.OUT_OF_RANGE:return Y.OUT_OF_RANGE;case Bt.UNIMPLEMENTED:return Y.UNIMPLEMENTED;case Bt.DATA_LOSS:return Y.DATA_LOSS;default:return de()}}(We=Bt||(Bt={}))[We.OK=0]="OK",We[We.CANCELLED=1]="CANCELLED",We[We.UNKNOWN=2]="UNKNOWN",We[We.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",We[We.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",We[We.NOT_FOUND=5]="NOT_FOUND",We[We.ALREADY_EXISTS=6]="ALREADY_EXISTS",We[We.PERMISSION_DENIED=7]="PERMISSION_DENIED",We[We.UNAUTHENTICATED=16]="UNAUTHENTICATED",We[We.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",We[We.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",We[We.ABORTED=10]="ABORTED",We[We.OUT_OF_RANGE=11]="OUT_OF_RANGE",We[We.UNIMPLEMENTED=12]="UNIMPLEMENTED",We[We.INTERNAL=13]="INTERNAL",We[We.UNAVAILABLE=14]="UNAVAILABLE",We[We.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ED(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ID=new Vo([4294967295,4294967295],0);function Qw(t){const e=ED().encode(t),n=new _I;return n.update(e),new Uint8Array(n.digest())}function Yw(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Vo([n,r],0),new Vo([i,o],0)]}class _y{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Lu(`Invalid padding: ${n}`);if(r<0)throw new Lu(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Lu(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Lu(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Vo.fromNumber(this.Ie)}Ee(e,n,r){let i=e.add(n.multiply(Vo.fromNumber(r)));return i.compare(ID)===1&&(i=new Vo([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=Qw(e),[r,i]=Yw(n);for(let o=0;o<this.hashCount;o++){const a=this.Ee(r,i,o);if(!this.de(a))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),a=new _y(o,i,n);return r.forEach(u=>a.insert(u)),a}insert(e){if(this.Ie===0)return;const n=Qw(e),[r,i]=Yw(n);for(let o=0;o<this.hashCount;o++){const a=this.Ee(r,i,o);this.Ae(a)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Lu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jc{constructor(e,n,r,i,o){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,Xc.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Jc(ve.min(),i,new ut(Ne),Kn(),je())}}class Xc{constructor(e,n,r,i,o){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Xc(r,n,je(),je(),je())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xd{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}}class ck{constructor(e,n){this.targetId=e,this.me=n}}class hk{constructor(e,n,r=Ot.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class Jw{constructor(){this.fe=0,this.ge=ex(),this.pe=Ot.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=je(),n=je(),r=je();return this.ge.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:de()}}),new Xc(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=ex()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ge(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class kD{constructor(e){this.Le=e,this.Be=new Map,this.ke=Kn(),this.qe=Xw(),this.Qe=new ut(Ne)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:de()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.ze(i)&&n(i)})}He(e){const n=e.targetId,r=e.me.count,i=this.Je(n);if(i){const o=i.target;if(af(o))if(r===0){const a=new le(o.path);this.Ue(n,a,At.newNoDocument(a,ve.min()))}else ge(r===1);else{const a=this.Ye(n);if(a!==r){const u=this.Ze(e),d=u?this.Xe(u,e,a):1;if(d!==0){this.je(n);const p=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,p)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=n;let a,u;try{a=Ys(r).toUint8Array()}catch(d){if(d instanceof MI)return wc("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{u=new _y(a,i,o)}catch(d){return wc(d instanceof Lu?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return u.Ie===0?null:u}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(o=>{const a=this.Le.tt(),u=`projects/${a.projectId}/databases/${a.database}/documents/${o.path.canonicalString()}`;e.mightContain(u)||(this.Ue(n,o,null),i++)}),i}rt(e){const n=new Map;this.Be.forEach((o,a)=>{const u=this.Je(a);if(u){if(o.current&&af(u.target)){const d=new le(u.target.path);this.ke.get(d)!==null||this.it(a,d)||this.Ue(a,d,At.newNoDocument(d,e))}o.be&&(n.set(a,o.ve()),o.Ce())}});let r=je();this.qe.forEach((o,a)=>{let u=!0;a.forEachWhile(d=>{const p=this.Je(d);return!p||p.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(o))}),this.ke.forEach((o,a)=>a.setReadTime(e));const i=new Jc(e,n,this.Qe,this.ke,r);return this.ke=Kn(),this.qe=Xw(),this.Qe=new ut(Ne),i}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,n)?i.Fe(n,1):i.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new Jw,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new ot(Ne),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||te("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Jw),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Xw(){return new ut(le.comparator)}function ex(){return new ut(le.comparator)}const SD={asc:"ASCENDING",desc:"DESCENDING"},PD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},AD={and:"AND",or:"OR"};class CD{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Ng(t,e){return t.useProto3Json||Wf(e)?e:{value:e}}function Sl(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function dk(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function ND(t,e){return Sl(t,e.toTimestamp())}function kn(t){return ge(!!t),ve.fromTimestamp(function(n){const r=Hi(n);return new Ke(r.seconds,r.nanos)}(t))}function yy(t,e){return Rg(t,e).canonicalString()}function Rg(t,e){const n=function(i){return new Qe(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function fk(t){const e=Qe.fromString(t);return ge(bk(e)),e}function uf(t,e){return yy(t.databaseId,e.path)}function Fo(t,e){const n=fk(e);if(n.get(1)!==t.databaseId.projectId)throw new oe(Y.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new oe(Y.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new le(gk(n))}function pk(t,e){return yy(t.databaseId,e)}function mk(t){const e=fk(t);return e.length===4?Qe.emptyPath():gk(e)}function Lg(t){return new Qe(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function gk(t){return ge(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function tx(t,e,n){return{name:uf(t,e),fields:n.value.mapValue.fields}}function RD(t,e,n){const r=Fo(t,e.name),i=kn(e.updateTime),o=e.createTime?kn(e.createTime):ve.min(),a=new hn({mapValue:{fields:e.fields}}),u=At.newFoundDocument(r,i,o,a);return n&&u.setHasCommittedMutations(),n?u.setHasCommittedMutations():u}function LD(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:de()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(p,_){return p.useProto3Json?(ge(_===void 0||typeof _=="string"),Ot.fromBase64String(_||"")):(ge(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array),Ot.fromUint8Array(_||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,u=a&&function(p){const _=p.code===void 0?Y.UNKNOWN:uk(p.code);return new oe(_,p.message||"")}(a);n=new hk(r,i,o,u||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Fo(t,r.document.name),o=kn(r.document.updateTime),a=r.document.createTime?kn(r.document.createTime):ve.min(),u=new hn({mapValue:{fields:r.document.fields}}),d=At.newFoundDocument(i,o,a,u),p=r.targetIds||[],_=r.removedTargetIds||[];n=new xd(p,_,d.key,d)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Fo(t,r.document),o=r.readTime?kn(r.readTime):ve.min(),a=At.newNoDocument(i,o),u=r.removedTargetIds||[];n=new xd([],u,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Fo(t,r.document),o=r.removedTargetIds||[];n=new xd([],o,i,null)}else{if(!("filter"in e))return de();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:o}=r,a=new bD(i,o),u=r.targetId;n=new ck(u,a)}}return n}function cf(t,e){let n;if(e instanceof Fl)n={update:tx(t,e.key,e.value)};else if(e instanceof Yf)n={delete:uf(t,e.key)};else if(e instanceof Qi)n={update:tx(t,e.key,e.data),updateMask:FD(e.fieldMask)};else{if(!(e instanceof lk))return de();n={verify:uf(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(o,a){const u=a.transform;if(u instanceof Ac)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof Il)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof kl)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Cc)return{fieldPath:a.field.canonicalString(),increment:u.Pe};throw de()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:ND(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:de()}(t,e.precondition)),n}function Dg(t,e){const n=e.currentDocument?function(o){return o.updateTime!==void 0?dn.updateTime(kn(o.updateTime)):o.exists!==void 0?dn.exists(o.exists):dn.none()}(e.currentDocument):dn.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(a,u){let d=null;if("setToServerValue"in u)ge(u.setToServerValue==="REQUEST_TIME"),d=new Ac;else if("appendMissingElements"in u){const _=u.appendMissingElements.values||[];d=new Il(_)}else if("removeAllFromArray"in u){const _=u.removeAllFromArray.values||[];d=new kl(_)}else"increment"in u?d=new Cc(a,u.increment):de();const p=Et.fromServerFormat(u.fieldPath);return new _D(p,d)}(t,i)):[];if(e.update){e.update.name;const i=Fo(t,e.update.name),o=new hn({mapValue:{fields:e.update.fields}});if(e.updateMask){const a=function(d){const p=d.fieldPaths||[];return new Vn(p.map(_=>Et.fromServerFormat(_)))}(e.updateMask);return new Qi(i,o,a,n,r)}return new Fl(i,o,n,r)}if(e.delete){const i=Fo(t,e.delete);return new Yf(i,n)}if(e.verify){const i=Fo(t,e.verify);return new lk(i,n)}return de()}function DD(t,e){return t&&t.length>0?(ge(e!==void 0),t.map(n=>function(i,o){let a=i.updateTime?kn(i.updateTime):kn(o);return a.isEqual(ve.min())&&(a=kn(o)),new vD(a,i.transformResults||[])}(n,e))):[]}function _k(t,e){return{documents:[pk(t,e.path)]}}function yk(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=pk(t,i);const o=function(p){if(p.length!==0)return xk(Xe.create(p,"and"))}(e.filters);o&&(n.structuredQuery.where=o);const a=function(p){if(p.length!==0)return p.map(_=>function(x){return{field:Ba(x.field),direction:MD(x.dir)}}(_))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);const u=Ng(t,e.limit);return u!==null&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=function(p){return{before:p.inclusive,values:p.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(p){return{before:!p.inclusive,values:p.position}}(e.endAt)),{_t:n,parent:i}}function vk(t){let e=mk(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){ge(r===1);const _=n.from[0];_.allDescendants?i=_.collectionId:e=e.child(_.collectionId)}let o=[];n.where&&(o=function(w){const x=wk(w);return x instanceof Xe&&hy(x)?x.getFilters():[x]}(n.where));let a=[];n.orderBy&&(a=function(w){return w.map(x=>function(P){return new Pc(za(P.field),function(B){switch(B){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(P.direction))}(x))}(n.orderBy));let u=null;n.limit&&(u=function(w){let x;return x=typeof w=="object"?w.value:w,Wf(x)?null:x}(n.limit));let d=null;n.startAt&&(d=function(w){const x=!!w.before,k=w.values||[];return new Tl(k,x)}(n.startAt));let p=null;return n.endAt&&(p=function(w){const x=!w.before,k=w.values||[];return new Tl(k,x)}(n.endAt)),GI(e,i,a,o,u,"F",d,p)}function jD(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return de()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function wk(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=za(n.unaryFilter.field);return qe.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=za(n.unaryFilter.field);return qe.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=za(n.unaryFilter.field);return qe.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=za(n.unaryFilter.field);return qe.create(a,"!=",{nullValue:"NULL_VALUE"});default:return de()}}(t):t.fieldFilter!==void 0?function(n){return qe.create(za(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return de()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Xe.create(n.compositeFilter.filters.map(r=>wk(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return de()}}(n.compositeFilter.op))}(t):de()}function MD(t){return SD[t]}function OD(t){return PD[t]}function VD(t){return AD[t]}function Ba(t){return{fieldPath:t.canonicalString()}}function za(t){return Et.fromServerFormat(t.fieldPath)}function xk(t){return t instanceof qe?function(n){if(n.op==="=="){if(Vw(n.value))return{unaryFilter:{field:Ba(n.field),op:"IS_NAN"}};if(Ow(n.value))return{unaryFilter:{field:Ba(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Vw(n.value))return{unaryFilter:{field:Ba(n.field),op:"IS_NOT_NAN"}};if(Ow(n.value))return{unaryFilter:{field:Ba(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ba(n.field),op:OD(n.op),value:n.value}}}(t):t instanceof Xe?function(n){const r=n.getFilters().map(i=>xk(i));return r.length===1?r[0]:{compositeFilter:{op:VD(n.op),filters:r}}}(t):de()}function FD(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function bk(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Di{constructor(e,n,r,i,o=ve.min(),a=ve.min(),u=Ot.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=u,this.expectedCount=d}withSequenceNumber(e){return new Di(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Di(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Di(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Di(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tk{constructor(e){this.ct=e}}function UD(t,e){let n;if(e.document)n=RD(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=le.fromSegments(e.noDocument.path),i=Xo(e.noDocument.readTime);n=At.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return de();{const r=le.fromSegments(e.unknownDocument.path),i=Xo(e.unknownDocument.version);n=At.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const o=new Ke(i[0],i[1]);return ve.fromTimestamp(o)}(e.readTime)),n}function nx(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:hf(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(o,a){return{name:uf(o,a.key),fields:a.data.value.mapValue.fields,updateTime:Sl(o,a.version.toTimestamp()),createTime:Sl(o,a.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Jo(e.version)};else{if(!e.isUnknownDocument())return de();r.unknownDocument={path:n.path.toArray(),version:Jo(e.version)}}return r}function hf(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Jo(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Xo(t){const e=new Ke(t.seconds,t.nanoseconds);return ve.fromTimestamp(e)}function So(t,e){const n=(e.baseMutations||[]).map(o=>Dg(t.ct,o));for(let o=0;o<e.mutations.length-1;++o){const a=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){const u=e.mutations[o+1];a.updateTransforms=u.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}const r=e.mutations.map(o=>Dg(t.ct,o)),i=Ke.fromMillis(e.localWriteTimeMs);return new py(e.batchId,i,n,r)}function Du(t){const e=Xo(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Xo(t.lastLimboFreeSnapshotVersion):ve.min();let r;return r=function(o){return o.documents!==void 0}(t.query)?function(o){return ge(o.documents.length===1),Yn(Qc(mk(o.documents[0])))}(t.query):function(o){return Yn(vk(o))}(t.query),new Di(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Ot.fromBase64String(t.resumeToken))}function Ek(t,e){const n=Jo(e.snapshotVersion),r=Jo(e.lastLimboFreeSnapshotVersion);let i;i=af(e.target)?_k(t.ct,e.target):yk(t.ct,e.target)._t;const o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Yo(e.target),readTime:n,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Ik(t){const e=vk({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Cg(e,e.limit,"L"):e}function am(t,e){return new gy(e.largestBatchId,Dg(t.ct,e.overlayMutation))}function rx(t,e){const n=e.path.lastSegment();return[t,In(e.path.popLast()),n]}function ix(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:Jo(r.readTime),documentKey:In(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BD{getBundleMetadata(e,n){return sx(e).get(n).next(r=>{if(r)return function(o){return{id:o.bundleId,createTime:Xo(o.createTime),version:o.version}}(r)})}saveBundleMetadata(e,n){return sx(e).put(function(i){return{bundleId:i.id,createTime:Jo(kn(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return ox(e).get(n).next(r=>{if(r)return function(o){return{name:o.name,query:Ik(o.bundledQuery),readTime:Xo(o.readTime)}}(r)})}saveNamedQuery(e,n){return ox(e).put(function(i){return{name:i.name,readTime:Jo(kn(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function sx(t){return Gt(t,"bundles")}function ox(t){return Gt(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jf{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){const r=n.uid||"";return new Jf(e,r)}getOverlay(e,n){return _u(e).get(rx(this.userId,n)).next(r=>r?am(this.serializer,r):null)}getOverlays(e,n){const r=Jr();return H.forEach(n,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((o,a)=>{const u=new gy(n,a);i.push(this.ht(e,u))}),H.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(a=>i.add(In(a.getCollectionPath())));const o=[];return i.forEach(a=>{const u=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,r+1],!1,!0);o.push(_u(e).j("collectionPathOverlayIndex",u))}),H.waitFor(o)}getOverlaysForCollection(e,n,r){const i=Jr(),o=In(n),a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,Number.POSITIVE_INFINITY],!0);return _u(e).U("collectionPathOverlayIndex",a).next(u=>{for(const d of u){const p=am(this.serializer,d);i.set(p.getKey(),p)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const o=Jr();let a;const u=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return _u(e).J({index:"collectionGroupOverlayIndex",range:u},(d,p,_)=>{const w=am(this.serializer,p);o.size()<i||w.largestBatchId===a?(o.set(w.getKey(),w),a=w.largestBatchId):_.done()}).next(()=>o)}ht(e,n){return _u(e).put(function(i,o,a){const[u,d,p]=rx(o,a.mutation.key);return{userId:o,collectionPath:d,documentId:p,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:cf(i.ct,a.mutation)}}(this.serializer,this.userId,n))}}function _u(t){return Gt(t,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zD{Pt(e){return Gt(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?Ot.fromUint8Array(r):Ot.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.Pt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po{constructor(){}It(e,n){this.Tt(e,n),n.Et()}Tt(e,n){if("nullValue"in e)this.dt(n,5);else if("booleanValue"in e)this.dt(n,10),n.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(n,15),n.At(gt(e.integerValue));else if("doubleValue"in e){const r=gt(e.doubleValue);isNaN(r)?this.dt(n,13):(this.dt(n,15),Tc(r)?n.At(0):n.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(n,20),typeof r=="string"&&(r=Hi(r)),n.Rt(`${r.seconds||""}`),n.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,n),this.ft(n);else if("bytesValue"in e)this.dt(n,30),n.gt(Ys(e.bytesValue)),this.ft(n);else if("referenceValue"in e)this.yt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(n,45),n.At(r.latitude||0),n.At(r.longitude||0)}else"mapValue"in e?OI(e)?this.dt(n,Number.MAX_SAFE_INTEGER):Gf(e)?this.wt(e.mapValue,n):(this.St(e.mapValue,n),this.ft(n)):"arrayValue"in e?(this.bt(e.arrayValue,n),this.ft(n)):de()}Vt(e,n){this.dt(n,25),this.Dt(e,n)}Dt(e,n){n.Rt(e)}St(e,n){const r=e.fields||{};this.dt(n,55);for(const i of Object.keys(r))this.Vt(i,n),this.Tt(r[i],n)}wt(e,n){var r,i;const o=e.fields||{};this.dt(n,53);const a="value",u=((i=(r=o[a].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(n,15),n.At(gt(u)),this.Vt(a,n),this.Tt(o[a],n)}bt(e,n){const r=e.values||[];this.dt(n,50);for(const i of r)this.Tt(i,n)}yt(e,n){this.dt(n,37),le.fromName(e).path.forEach(r=>{this.dt(n,60),this.Dt(r,n)})}dt(e,n){e.At(n)}ft(e){e.At(2)}}Po.vt=new Po;function qD(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function ax(t){const e=64-function(r){let i=0;for(let o=0;o<8;++o){const a=qD(255&r[o]);if(i+=a,a!==8)break}return i}(t);return Math.ceil(e/8)}class $D{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ft(r.value),r=n.next();this.Mt()}xt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ot(r.value),r=n.next();this.Nt()}Lt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=n.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const i=n.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){const n=this.qt(e),r=ax(n);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}Kt(e){const n=this.qt(e),r=ax(n);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const n=function(o){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,o,!1),new Uint8Array(a.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Ft(e){const n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(n)}Ot(e){const n=255&e;n===0?(this.Gt(0),this.Gt(255)):n===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class HD{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class WD{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class yu{constructor(){this.jt=new $D,this.Ht=new HD(this.jt),this.Jt=new WD(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Zt(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Ao(this.indexId,this.documentKey,this.arrayValue,r)}}function ws(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=lx(t.arrayValue,e.arrayValue),n!==0?n:(n=lx(t.directionalValue,e.directionalValue),n!==0?n:le.comparator(t.documentKey,e.documentKey)))}function lx(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ux{constructor(e){this.Xt=new ot((n,r)=>Et.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const n of e.filters){const r=n;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(ge(e.collectionGroup===this.collectionId),this.nn)return!1;const n=bg(e);if(n!==void 0&&!this.sn(n))return!1;const r=Io(e);let i=new Set,o=0,a=0;for(;o<r.length&&this.sn(r[o]);++o)i=i.add(r[o].fieldPath.canonicalString());if(o===r.length)return!0;if(this.Xt.size>0){const u=this.Xt.getIterator().getNext();if(!i.has(u.field.canonicalString())){const d=r[o];if(!this.on(u,d)||!this._n(this.en[a++],d))return!1}++o}for(;o<r.length;++o){const u=r[o];if(a>=this.en.length||!this._n(this.en[a++],u))return!1}return!0}an(){if(this.nn)return null;let e=new ot(Et.comparator);const n=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new gd(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new gd(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new gd(r.field,r.dir==="asc"?0:1)));return new of(of.UNKNOWN_ID,this.collectionId,n,bc.empty())}sn(e){for(const n of this.tn)if(this.on(n,e))return!0;return!1}on(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}_n(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kk(t){var e,n;if(ge(t instanceof qe||t instanceof Xe),t instanceof qe){if(t instanceof WI){const i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(o=>qe.create(t.field,"==",o)))||[];return Xe.create(i,"or")}return t}const r=t.filters.map(i=>kk(i));return Xe.create(r,t.op)}function GD(t){if(t.getFilters().length===0)return[];const e=Og(kk(t));return ge(Sk(e)),jg(e)||Mg(e)?[e]:e.getFilters()}function jg(t){return t instanceof qe}function Mg(t){return t instanceof Xe&&hy(t)}function Sk(t){return jg(t)||Mg(t)||function(n){if(n instanceof Xe&&kg(n)){for(const r of n.getFilters())if(!jg(r)&&!Mg(r))return!1;return!0}return!1}(t)}function Og(t){if(ge(t instanceof qe||t instanceof Xe),t instanceof qe)return t;if(t.filters.length===1)return Og(t.filters[0]);const e=t.filters.map(r=>Og(r));let n=Xe.create(e,t.op);return n=df(n),Sk(n)?n:(ge(n instanceof Xe),ge(El(n)),ge(n.filters.length>1),n.filters.reduce((r,i)=>vy(r,i)))}function vy(t,e){let n;return ge(t instanceof qe||t instanceof Xe),ge(e instanceof qe||e instanceof Xe),n=t instanceof qe?e instanceof qe?function(i,o){return Xe.create([i,o],"and")}(t,e):cx(t,e):e instanceof qe?cx(e,t):function(i,o){if(ge(i.filters.length>0&&o.filters.length>0),El(i)&&El(o))return qI(i,o.getFilters());const a=kg(i)?i:o,u=kg(i)?o:i,d=a.filters.map(p=>vy(p,u));return Xe.create(d,"or")}(t,e),df(n)}function cx(t,e){if(El(e))return qI(e,t.getFilters());{const n=e.filters.map(r=>vy(t,r));return Xe.create(n,"or")}}function df(t){if(ge(t instanceof qe||t instanceof Xe),t instanceof qe)return t;const e=t.getFilters();if(e.length===1)return df(e[0]);if(BI(t))return t;const n=e.map(i=>df(i)),r=[];return n.forEach(i=>{i instanceof qe?r.push(i):i instanceof Xe&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Xe.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KD{constructor(){this.un=new wy}addToCollectionParentIndex(e,n){return this.un.add(n),H.resolve()}getCollectionParents(e,n){return H.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return H.resolve()}deleteFieldIndex(e,n){return H.resolve()}deleteAllFieldIndexes(e){return H.resolve()}createTargetIndexes(e,n){return H.resolve()}getDocumentsMatchingTarget(e,n){return H.resolve(null)}getIndexType(e,n){return H.resolve(0)}getFieldIndexes(e,n){return H.resolve([])}getNextCollectionGroupToUpdate(e){return H.resolve(null)}getMinOffset(e,n){return H.resolve(tr.min())}getMinOffsetFromCollectionGroup(e,n){return H.resolve(tr.min())}updateCollectionGroup(e,n,r){return H.resolve()}updateIndexEntries(e,n){return H.resolve()}}class wy{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new ot(Qe.comparator),o=!i.has(r);return this.index[n]=i.add(r),o}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new ot(Qe.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qh=new Uint8Array(0);class ZD{constructor(e,n){this.databaseId=n,this.cn=new wy,this.ln=new oo(r=>Yo(r),(r,i)=>Zc(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.cn.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.cn.add(n)});const o={collectionId:r,parent:In(i)};return hx(e).put(o)}return H.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[EI(n),""],!1,!0);return hx(e).U(i).next(o=>{for(const a of o){if(a.collectionId!==n)break;r.push(Yr(a.parent))}return r})}addFieldIndex(e,n){const r=vu(e),i=function(u){return{indexId:u.indexId,collectionGroup:u.collectionGroup,fields:u.fields.map(d=>[d.fieldPath.canonicalString(),d.kind])}}(n);delete i.indexId;const o=r.add(i);if(n.indexState){const a=Oa(e);return o.next(u=>{a.put(ix(u,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return o.next()}deleteFieldIndex(e,n){const r=vu(e),i=Oa(e),o=Ma(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>o.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=vu(e),r=Ma(e),i=Oa(e);return n.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,n){return H.forEach(this.hn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const o=new ux(r).an();if(o!=null)return this.addFieldIndex(e,o)}}))}getDocumentsMatchingTarget(e,n){const r=Ma(e);let i=!0;const o=new Map;return H.forEach(this.hn(n),a=>this.Pn(e,a).next(u=>{i&&(i=!!u),o.set(a,u)})).next(()=>{if(i){let a=je();const u=[];return H.forEach(o,(d,p)=>{te("IndexedDbIndexManager",`Using index ${function(N){return`id=${N.indexId}|cg=${N.collectionGroup}|f=${N.fields.map(z=>`${z.fieldPath}:${z.kind}`).join(",")}`}(d)} to execute ${Yo(n)}`);const _=function(N,z){const G=bg(z);if(G===void 0)return null;for(const F of lf(N,G.fieldPath))switch(F.op){case"array-contains-any":return F.value.arrayValue.values||[];case"array-contains":return[F.value]}return null}(p,d),w=function(N,z){const G=new Map;for(const F of Io(z))for(const I of lf(N,F.fieldPath))switch(I.op){case"==":case"in":G.set(F.fieldPath.canonicalString(),I.value);break;case"not-in":case"!=":return G.set(F.fieldPath.canonicalString(),I.value),Array.from(G.values())}return null}(p,d),x=function(N,z){const G=[];let F=!0;for(const I of Io(z)){const T=I.kind===0?qw(N,I.fieldPath,N.startAt):$w(N,I.fieldPath,N.startAt);G.push(T.value),F&&(F=T.inclusive)}return new Tl(G,F)}(p,d),k=function(N,z){const G=[];let F=!0;for(const I of Io(z)){const T=I.kind===0?$w(N,I.fieldPath,N.endAt):qw(N,I.fieldPath,N.endAt);G.push(T.value),F&&(F=T.inclusive)}return new Tl(G,F)}(p,d),P=this.In(d,p,x),j=this.In(d,p,k),B=this.Tn(d,p,w),R=this.En(d.indexId,_,P,x.inclusive,j,k.inclusive,B);return H.forEach(R,S=>r.G(S,n.limit).next(N=>{N.forEach(z=>{const G=le.fromSegments(z.documentKey);a.has(G)||(a=a.add(G),u.push(G))})}))}).next(()=>u)}return H.resolve(null)})}hn(e){let n=this.ln.get(e);return n||(e.filters.length===0?n=[e]:n=GD(Xe.create(e.filters,"and")).map(r=>Pg(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,n),n)}En(e,n,r,i,o,a,u){const d=(n!=null?n.length:1)*Math.max(r.length,o.length),p=d/(n!=null?n.length:1),_=[];for(let w=0;w<d;++w){const x=n?this.dn(n[w/p]):qh,k=this.An(e,x,r[w%p],i),P=this.Rn(e,x,o[w%p],a),j=u.map(B=>this.An(e,x,B,!0));_.push(...this.createRange(k,P,j))}return _}An(e,n,r,i){const o=new Ao(e,le.empty(),n,r);return i?o:o.Zt()}Rn(e,n,r,i){const o=new Ao(e,le.empty(),n,r);return i?o.Zt():o}Pn(e,n){const r=new ux(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(o=>{let a=null;for(const u of o)r.rn(u)&&(!a||u.fields.length>a.fields.length)&&(a=u);return a})}getIndexType(e,n){let r=2;const i=this.hn(n);return H.forEach(i,o=>this.Pn(e,o).next(a=>{a?r!==0&&a.fields.length<function(d){let p=new ot(Et.comparator),_=!1;for(const w of d.filters)for(const x of w.getFlattenedFilters())x.field.isKeyField()||(x.op==="array-contains"||x.op==="array-contains-any"?_=!0:p=p.add(x.field));for(const w of d.orderBy)w.field.isKeyField()||(p=p.add(w.field));return p.size+(_?1:0)}(o)&&(r=1):r=0})).next(()=>function(a){return a.limit!==null}(n)&&i.length>1&&r===2?1:r)}Vn(e,n){const r=new yu;for(const i of Io(e)){const o=n.data.field(i.fieldPath);if(o==null)return null;const a=r.Yt(i.kind);Po.vt.It(o,a)}return r.zt()}dn(e){const n=new yu;return Po.vt.It(e,n.Yt(0)),n.zt()}mn(e,n){const r=new yu;return Po.vt.It(kc(this.databaseId,n),r.Yt(function(o){const a=Io(o);return a.length===0?0:a[a.length-1].kind}(e))),r.zt()}Tn(e,n,r){if(r===null)return[];let i=[];i.push(new yu);let o=0;for(const a of Io(e)){const u=r[o++];for(const d of i)if(this.fn(n,a.fieldPath)&&Sc(u))i=this.gn(i,a,u);else{const p=d.Yt(a.kind);Po.vt.It(u,p)}}return this.pn(i)}In(e,n,r){return this.Tn(e,n,r.position)}pn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].zt();return n}gn(e,n,r){const i=[...e],o=[];for(const a of r.arrayValue.values||[])for(const u of i){const d=new yu;d.seed(u.zt()),Po.vt.It(a,d.Yt(n.kind)),o.push(d)}return o}fn(e,n){return!!e.filters.find(r=>r instanceof qe&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=vu(e),i=Oa(e);return(n?r.U("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.U()).next(o=>{const a=[];return H.forEach(o,u=>i.get([u.indexId,this.uid]).next(d=>{a.push(function(_,w){const x=w?new bc(w.sequenceNumber,new tr(Xo(w.readTime),new le(Yr(w.documentKey)),w.largestBatchId)):bc.empty(),k=_.fields.map(([P,j])=>new gd(Et.fromServerFormat(P),j));return new of(_.indexId,_.collectionGroup,k,x)}(u,d))})).next(()=>a)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const o=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return o!==0?o:Ne(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=vu(e),o=Oa(e);return this.yn(e).next(a=>i.U("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(u=>H.forEach(u,d=>o.put(ix(d.indexId,this.uid,a,r)))))}updateIndexEntries(e,n){const r=new Map;return H.forEach(n,(i,o)=>{const a=r.get(i.collectionGroup);return(a?H.resolve(a):this.getFieldIndexes(e,i.collectionGroup)).next(u=>(r.set(i.collectionGroup,u),H.forEach(u,d=>this.wn(e,i,d).next(p=>{const _=this.Sn(o,d);return p.isEqual(_)?H.resolve():this.bn(e,o,d,p,_)}))))})}Dn(e,n,r,i){return Ma(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(r,n.key),documentKey:n.key.path.toArray()})}vn(e,n,r,i){return Ma(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(r,n.key),n.key.path.toArray()])}wn(e,n,r){const i=Ma(e);let o=new ot(ws);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,n)])},(a,u)=>{o=o.add(new Ao(r.indexId,n,u.arrayValue,u.directionalValue))}).next(()=>o)}Sn(e,n){let r=new ot(ws);const i=this.Vn(n,e);if(i==null)return r;const o=bg(n);if(o!=null){const a=e.data.field(o.fieldPath);if(Sc(a))for(const u of a.arrayValue.values||[])r=r.add(new Ao(n.indexId,e.key,this.dn(u),i))}else r=r.add(new Ao(n.indexId,e.key,qh,i));return r}bn(e,n,r,i,o){te("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const a=[];return function(d,p,_,w,x){const k=d.getIterator(),P=p.getIterator();let j=ja(k),B=ja(P);for(;j||B;){let R=!1,S=!1;if(j&&B){const N=_(j,B);N<0?S=!0:N>0&&(R=!0)}else j!=null?S=!0:R=!0;R?(w(B),B=ja(P)):S?(x(j),j=ja(k)):(j=ja(k),B=ja(P))}}(i,o,ws,u=>{a.push(this.Dn(e,n,r,u))},u=>{a.push(this.vn(e,n,r,u))}),H.waitFor(a)}yn(e){let n=1;return Oa(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,o)=>{o.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((a,u)=>ws(a,u)).filter((a,u,d)=>!u||ws(a,d[u-1])!==0);const i=[];i.push(e);for(const a of r){const u=ws(a,e),d=ws(a,n);if(u===0)i[0]=e.Zt();else if(u>0&&d<0)i.push(a),i.push(a.Zt());else if(d>0)break}i.push(n);const o=[];for(let a=0;a<i.length;a+=2){if(this.Cn(i[a],i[a+1]))return[];const u=[i[a].indexId,this.uid,i[a].arrayValue,i[a].directionalValue,qh,[]],d=[i[a+1].indexId,this.uid,i[a+1].arrayValue,i[a+1].directionalValue,qh,[]];o.push(IDBKeyRange.bound(u,d))}return o}Cn(e,n){return ws(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(dx)}getMinOffset(e,n){return H.mapArray(this.hn(n),r=>this.Pn(e,r).next(i=>i||de())).next(dx)}}function hx(t){return Gt(t,"collectionParents")}function Ma(t){return Gt(t,"indexEntries")}function vu(t){return Gt(t,"indexConfiguration")}function Oa(t){return Gt(t,"indexState")}function dx(t){ge(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;oy(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new tr(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fx={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Ln{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Ln(e,Ln.DEFAULT_COLLECTION_PERCENTILE,Ln.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pk(t,e,n){const r=t.store("mutations"),i=t.store("documentMutations"),o=[],a=IDBKeyRange.only(n.batchId);let u=0;const d=r.J({range:a},(_,w,x)=>(u++,x.delete()));o.push(d.next(()=>{ge(u===1)}));const p=[];for(const _ of n.mutations){const w=NI(e,_.key.path,n.batchId);o.push(i.delete(w)),p.push(_.key)}return H.waitFor(o).next(()=>p)}function ff(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw de();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ln.DEFAULT_COLLECTION_PERCENTILE=10,Ln.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ln.DEFAULT=new Ln(41943040,Ln.DEFAULT_COLLECTION_PERCENTILE,Ln.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ln.DISABLED=new Ln(-1,0,0);class Xf{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Fn={}}static lt(e,n,r,i){ge(e.uid!=="");const o=e.isAuthenticated()?e.uid:"";return new Xf(o,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return xs(e).J({index:"userMutationsIndex",range:r},(i,o,a)=>{n=!1,a.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const o=qa(e),a=xs(e);return a.add({}).next(u=>{ge(typeof u=="number");const d=new py(u,n,r,i),p=function(k,P,j){const B=j.baseMutations.map(S=>cf(k.ct,S)),R=j.mutations.map(S=>cf(k.ct,S));return{userId:P,batchId:j.batchId,localWriteTimeMs:j.localWriteTime.toMillis(),baseMutations:B,mutations:R}}(this.serializer,this.userId,d),_=[];let w=new ot((x,k)=>Ne(x.canonicalString(),k.canonicalString()));for(const x of i){const k=NI(this.userId,x.key.path,u);w=w.add(x.key.path.popLast()),_.push(a.put(p)),_.push(o.put(k,RL))}return w.forEach(x=>{_.push(this.indexManager.addToCollectionParentIndex(e,x))}),e.addOnCommittedListener(()=>{this.Fn[u]=d.keys()}),H.waitFor(_).next(()=>d)})}lookupMutationBatch(e,n){return xs(e).get(n).next(r=>r?(ge(r.userId===this.userId),So(this.serializer,r)):null)}Mn(e,n){return this.Fn[n]?H.resolve(this.Fn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Fn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let o=null;return xs(e).J({index:"userMutationsIndex",range:i},(a,u,d)=>{u.userId===this.userId&&(ge(u.batchId>=r),o=So(this.serializer,u)),d.done()}).next(()=>o)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return xs(e).J({index:"userMutationsIndex",range:n,reverse:!0},(i,o,a)=>{r=o.batchId,a.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return xs(e).U("userMutationsIndex",n).next(r=>r.map(i=>So(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=_d(this.userId,n.path),i=IDBKeyRange.lowerBound(r),o=[];return qa(e).J({range:i},(a,u,d)=>{const[p,_,w]=a,x=Yr(_);if(p===this.userId&&n.path.isEqual(x))return xs(e).get(w).next(k=>{if(!k)throw de();ge(k.userId===this.userId),o.push(So(this.serializer,k))});d.done()}).next(()=>o)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new ot(Ne);const i=[];return n.forEach(o=>{const a=_d(this.userId,o.path),u=IDBKeyRange.lowerBound(a),d=qa(e).J({range:u},(p,_,w)=>{const[x,k,P]=p,j=Yr(k);x===this.userId&&o.path.isEqual(j)?r=r.add(P):w.done()});i.push(d)}),H.waitFor(i).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,o=_d(this.userId,r),a=IDBKeyRange.lowerBound(o);let u=new ot(Ne);return qa(e).J({range:a},(d,p,_)=>{const[w,x,k]=d,P=Yr(x);w===this.userId&&r.isPrefixOf(P)?P.length===i&&(u=u.add(k)):_.done()}).next(()=>this.xn(e,u))}xn(e,n){const r=[],i=[];return n.forEach(o=>{i.push(xs(e).get(o).next(a=>{if(a===null)throw de();ge(a.userId===this.userId),r.push(So(this.serializer,a))}))}),H.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return Pk(e._e,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.On(n.batchId)}),H.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return H.resolve();const r=IDBKeyRange.lowerBound(function(a){return[a]}(this.userId)),i=[];return qa(e).J({range:r},(o,a,u)=>{if(o[0]===this.userId){const d=Yr(o[1]);i.push(d)}else u.done()}).next(()=>{ge(i.length===0)})})}containsKey(e,n){return Ak(e,this.userId,n)}Nn(e){return Ck(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function Ak(t,e,n){const r=_d(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r);let a=!1;return qa(t).J({range:o,H:!0},(u,d,p)=>{const[_,w,x]=u;_===e&&w===i&&(a=!0),p.done()}).next(()=>a)}function xs(t){return Gt(t,"mutations")}function qa(t){return Gt(t,"documentMutations")}function Ck(t){return Gt(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ea{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new ea(0)}static kn(){return new ea(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QD{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.qn(e).next(n=>{const r=new ea(n.highestTargetId);return n.highestTargetId=r.next(),this.Qn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(n=>ve.fromTimestamp(new Ke(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.qn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.Qn(e,i)))}addTargetData(e,n){return this.Kn(e,n).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(n,r),this.Qn(e,r))))}updateTargetData(e,n){return this.Kn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Va(e).delete(n.targetId)).next(()=>this.qn(e)).next(r=>(ge(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,n,r){let i=0;const o=[];return Va(e).J((a,u)=>{const d=Du(u);d.sequenceNumber<=n&&r.get(d.targetId)===null&&(i++,o.push(this.removeTargetData(e,d)))}).next(()=>H.waitFor(o)).next(()=>i)}forEachTarget(e,n){return Va(e).J((r,i)=>{const o=Du(i);n(o)})}qn(e){return px(e).get("targetGlobalKey").next(n=>(ge(n!==null),n))}Qn(e,n){return px(e).put("targetGlobalKey",n)}Kn(e,n){return Va(e).put(Ek(this.serializer,n))}$n(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=Yo(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let o=null;return Va(e).J({range:i,index:"queryTargetsIndex"},(a,u,d)=>{const p=Du(u);Zc(n,p.target)&&(o=p,d.done())}).next(()=>o)}addMatchingKeys(e,n,r){const i=[],o=Cs(e);return n.forEach(a=>{const u=In(a.path);i.push(o.put({targetId:r,path:u})),i.push(this.referenceDelegate.addReference(e,r,a))}),H.waitFor(i)}removeMatchingKeys(e,n,r){const i=Cs(e);return H.forEach(n,o=>{const a=In(o.path);return H.waitFor([i.delete([r,a]),this.referenceDelegate.removeReference(e,r,o)])})}removeMatchingKeysForTargetId(e,n){const r=Cs(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Cs(e);let o=je();return i.J({range:r,H:!0},(a,u,d)=>{const p=Yr(a[1]),_=new le(p);o=o.add(_)}).next(()=>o)}containsKey(e,n){const r=In(n.path),i=IDBKeyRange.bound([r],[EI(r)],!1,!0);let o=0;return Cs(e).J({index:"documentTargetsIndex",H:!0,range:i},([a,u],d,p)=>{a!==0&&(o++,p.done())}).next(()=>o>0)}ot(e,n){return Va(e).get(n).next(r=>r?Du(r):null)}}function Va(t){return Gt(t,"targets")}function px(t){return Gt(t,"targetGlobal")}function Cs(t){return Gt(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mx([t,e],[n,r]){const i=Ne(t,n);return i===0?Ne(e,r):i}class YD{constructor(e){this.Un=e,this.buffer=new ot(mx),this.Wn=0}Gn(){return++this.Wn}zn(e){const n=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();mx(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class JD{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){te("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){so(n)?te("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await io(n)}await this.Hn(3e5)})}}class XD{constructor(e,n){this.Jn=e,this.params=n}calculateTargetCount(e,n){return this.Jn.Yn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return H.resolve(On.oe);const r=new YD(n);return this.Jn.forEachTarget(e,i=>r.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>r.zn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(te("LruGarbageCollector","Garbage collection skipped; disabled"),H.resolve(fx)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(te("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),fx):this.Xn(e,n))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,n){let r,i,o,a,u,d,p;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(w=>(w>this.params.maximumSequenceNumbersToCollect?(te("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${w}`),i=this.params.maximumSequenceNumbersToCollect):i=w,a=Date.now(),this.nthSequenceNumber(e,i))).next(w=>(r=w,u=Date.now(),this.removeTargets(e,r,n))).next(w=>(o=w,d=Date.now(),this.removeOrphanedDocuments(e,r))).next(w=>(p=Date.now(),Fa()<=ze.DEBUG&&te("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-_}ms
	Determined least recently used ${i} in `+(u-a)+`ms
	Removed ${o} targets in `+(d-u)+`ms
	Removed ${w} documents in `+(p-d)+`ms
Total Duration: ${p-_}ms`),H.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:w})))}}function ej(t,e){return new XD(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tj{constructor(e,n){this.db=e,this.garbageCollector=ej(this,n)}Yn(e){const n=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}er(e){let n=0;return this.Zn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Zn(e,n){return this.tr(e,(r,i)=>n(i))}addReference(e,n,r){return $h(e,r)}removeReference(e,n,r){return $h(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return $h(e,n)}nr(e,n){return function(i,o){let a=!1;return Ck(i).Y(u=>Ak(i,u,o).next(d=>(d&&(a=!0),H.resolve(!d)))).next(()=>a)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let o=0;return this.tr(e,(a,u)=>{if(u<=n){const d=this.nr(e,a).next(p=>{if(!p)return o++,r.getEntry(e,a).next(()=>(r.removeEntry(a,ve.min()),Cs(e).delete(function(w){return[0,In(w.path)]}(a))))});i.push(d)}}).next(()=>H.waitFor(i)).next(()=>r.apply(e)).next(()=>o)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return $h(e,n)}tr(e,n){const r=Cs(e);let i,o=On.oe;return r.J({index:"documentTargetsIndex"},([a,u],{path:d,sequenceNumber:p})=>{a===0?(o!==On.oe&&n(new le(Yr(i)),o),o=p,i=d):o=On.oe}).next(()=>{o!==On.oe&&n(new le(Yr(i)),o)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function $h(t,e){return Cs(t).put(function(r,i){return{targetId:0,path:In(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nk{constructor(){this.changes=new oo(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,At.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?H.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nj{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return xo(e).put(r)}removeEntry(e,n,r){return xo(e).delete(function(o,a){const u=o.path.toArray();return[u.slice(0,u.length-2),u[u.length-2],hf(a),u[u.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.rr(e,r)))}getEntry(e,n){let r=At.newInvalidDocument(n);return xo(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(wu(n))},(i,o)=>{r=this.ir(n,o)}).next(()=>r)}sr(e,n){let r={size:0,document:At.newInvalidDocument(n)};return xo(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(wu(n))},(i,o)=>{r={document:this.ir(n,o),size:ff(o)}}).next(()=>r)}getEntries(e,n){let r=Kn();return this._r(e,n,(i,o)=>{const a=this.ir(i,o);r=r.insert(i,a)}).next(()=>r)}ar(e,n){let r=Kn(),i=new ut(le.comparator);return this._r(e,n,(o,a)=>{const u=this.ir(o,a);r=r.insert(o,u),i=i.insert(o,ff(a))}).next(()=>({documents:r,ur:i}))}_r(e,n,r){if(n.isEmpty())return H.resolve();let i=new ot(yx);n.forEach(d=>i=i.add(d));const o=IDBKeyRange.bound(wu(i.first()),wu(i.last())),a=i.getIterator();let u=a.getNext();return xo(e).J({index:"documentKeyIndex",range:o},(d,p,_)=>{const w=le.fromSegments([...p.prefixPath,p.collectionGroup,p.documentId]);for(;u&&yx(u,w)<0;)r(u,null),u=a.getNext();u&&u.isEqual(w)&&(r(u,p),u=a.hasNext()?a.getNext():null),u?_.$(wu(u)):_.done()}).next(()=>{for(;u;)r(u,null),u=a.hasNext()?a.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,o){const a=n.path,u=[a.popLast().toArray(),a.lastSegment(),hf(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],d=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return xo(e).U(IDBKeyRange.bound(u,d,!0)).next(p=>{o==null||o.incrementDocumentReadCount(p.length);let _=Kn();for(const w of p){const x=this.ir(le.fromSegments(w.prefixPath.concat(w.collectionGroup,w.documentId)),w);x.isFoundDocument()&&(Yc(n,x)||i.has(x.key))&&(_=_.insert(x.key,x))}return _})}getAllFromCollectionGroup(e,n,r,i){let o=Kn();const a=_x(n,r),u=_x(n,tr.max());return xo(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(a,u,!0)},(d,p,_)=>{const w=this.ir(le.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);o=o.insert(w.key,w),o.size===i&&_.done()}).next(()=>o)}newChangeBuffer(e){return new rj(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return gx(e).get("remoteDocumentGlobalKey").next(n=>(ge(!!n),n))}rr(e,n){return gx(e).put("remoteDocumentGlobalKey",n)}ir(e,n){if(n){const r=UD(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(ve.min())))return r}return At.newInvalidDocument(e)}}function Rk(t){return new nj(t)}class rj extends Nk{constructor(e,n){super(),this.cr=e,this.trackRemovals=n,this.lr=new oo(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new ot((o,a)=>Ne(o.canonicalString(),a.canonicalString()));return this.changes.forEach((o,a)=>{const u=this.lr.get(o);if(n.push(this.cr.removeEntry(e,o,u.readTime)),a.isValidDocument()){const d=nx(this.cr.serializer,a);i=i.add(o.path.popLast());const p=ff(d);r+=p-u.size,n.push(this.cr.addEntry(e,o,d))}else if(r-=u.size,this.trackRemovals){const d=nx(this.cr.serializer,a.convertToNoDocument(ve.min()));n.push(this.cr.addEntry(e,o,d))}}),i.forEach(o=>{n.push(this.cr.indexManager.addToCollectionParentIndex(e,o))}),n.push(this.cr.updateMetadata(e,r)),H.waitFor(n)}getFromCache(e,n){return this.cr.sr(e,n).next(r=>(this.lr.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.cr.ar(e,n).next(({documents:r,ur:i})=>(i.forEach((o,a)=>{this.lr.set(o,{size:a,readTime:r.get(o).readTime})}),r))}}function gx(t){return Gt(t,"remoteDocumentGlobal")}function xo(t){return Gt(t,"remoteDocumentsV14")}function wu(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function _x(t,e){const n=e.documentKey.path.toArray();return[t,hf(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function yx(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let o=0;o<n.length-2&&o<r.length-2;++o)if(i=Ne(n[o],r[o]),i)return i;return i=Ne(n.length,r.length),i||(i=Ne(n[n.length-2],r[r.length-2]),i||Ne(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ij{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lk{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Qu(r.mutation,i,Vn.empty(),Ke.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,je()).next(()=>r))}getLocalViewOfDocuments(e,n,r=je()){const i=Jr();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(o=>{let a=Ru();return o.forEach((u,d)=>{a=a.insert(u,d.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const r=Jr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,je()))}populateOverlays(e,n,r){const i=[];return r.forEach(o=>{n.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((a,u)=>{n.set(a,u)})})}computeViews(e,n,r,i){let o=Kn();const a=Zu(),u=function(){return Zu()}();return n.forEach((d,p)=>{const _=r.get(p.key);i.has(p.key)&&(_===void 0||_.mutation instanceof Qi)?o=o.insert(p.key,p):_!==void 0?(a.set(p.key,_.mutation.getFieldMask()),Qu(_.mutation,p,_.mutation.getFieldMask(),Ke.now())):a.set(p.key,Vn.empty())}),this.recalculateAndSaveOverlays(e,o).next(d=>(d.forEach((p,_)=>a.set(p,_)),n.forEach((p,_)=>{var w;return u.set(p,new ij(_,(w=a.get(p))!==null&&w!==void 0?w:null))}),u))}recalculateAndSaveOverlays(e,n){const r=Zu();let i=new ut((a,u)=>a-u),o=je();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const u of a)u.keys().forEach(d=>{const p=n.get(d);if(p===null)return;let _=r.get(d)||Vn.empty();_=u.applyToLocalView(p,_),r.set(d,_);const w=(i.get(u.batchId)||je()).add(d);i=i.insert(u.batchId,w)})}).next(()=>{const a=[],u=i.getReverseIterator();for(;u.hasNext();){const d=u.getNext(),p=d.key,_=d.value,w=ek();_.forEach(x=>{if(!o.has(x)){const k=ok(n.get(x),r.get(x));k!==null&&w.set(x,k),o=o.add(x)}}),a.push(this.documentOverlayCache.saveOverlays(e,p,w))}return H.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(a){return le.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):KI(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(o=>{const a=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-o.size):H.resolve(Jr());let u=-1,d=o;return a.next(p=>H.forEach(p,(_,w)=>(u<w.largestBatchId&&(u=w.largestBatchId),o.get(_)?H.resolve():this.remoteDocumentCache.getEntry(e,_).next(x=>{d=d.insert(_,x)}))).next(()=>this.populateOverlays(e,p,o)).next(()=>this.computeViews(e,d,p,je())).next(_=>({batchId:u,changes:XI(_)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new le(n)).next(r=>{let i=Ru();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const o=n.collectionGroup;let a=Ru();return this.indexManager.getCollectionParents(e,o).next(u=>H.forEach(u,d=>{const p=function(w,x){return new Vl(x,null,w.explicitOrderBy.slice(),w.filters.slice(),w.limit,w.limitType,w.startAt,w.endAt)}(n,d.child(o));return this.getDocumentsMatchingCollectionQuery(e,p,r,i).next(_=>{_.forEach((w,x)=>{a=a.insert(w,x)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,o,i))).next(a=>{o.forEach((d,p)=>{const _=p.getKey();a.get(_)===null&&(a=a.insert(_,At.newInvalidDocument(_)))});let u=Ru();return a.forEach((d,p)=>{const _=o.get(d);_!==void 0&&Qu(_.mutation,p,Vn.empty(),Ke.now()),Yc(n,p)&&(u=u.insert(d,p))}),u})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sj{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return H.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:kn(i.createTime)}}(n)),H.resolve()}getNamedQuery(e,n){return H.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(i){return{name:i.name,query:Ik(i.bundledQuery),readTime:kn(i.readTime)}}(n)),H.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oj{constructor(){this.overlays=new ut(le.comparator),this.Ir=new Map}getOverlay(e,n){return H.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Jr();return H.forEach(n,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,o)=>{this.ht(e,n,o)}),H.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.Ir.delete(r)),H.resolve()}getOverlaysForCollection(e,n,r){const i=Jr(),o=n.length+1,a=new le(n.child("")),u=this.overlays.getIteratorFrom(a);for(;u.hasNext();){const d=u.getNext().value,p=d.getKey();if(!n.isPrefixOf(p.path))break;p.path.length===o&&d.largestBatchId>r&&i.set(d.getKey(),d)}return H.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let o=new ut((p,_)=>p-_);const a=this.overlays.getIterator();for(;a.hasNext();){const p=a.getNext().value;if(p.getKey().getCollectionGroup()===n&&p.largestBatchId>r){let _=o.get(p.largestBatchId);_===null&&(_=Jr(),o=o.insert(p.largestBatchId,_)),_.set(p.getKey(),p)}}const u=Jr(),d=o.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach((p,_)=>u.set(p,_)),!(u.size()>=i)););return H.resolve(u)}ht(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const a=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new gy(n,r));let o=this.Ir.get(n);o===void 0&&(o=je(),this.Ir.set(n,o)),this.Ir.set(n,o.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aj{constructor(){this.sessionToken=Ot.EMPTY_BYTE_STRING}getSessionToken(e){return H.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,H.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xy{constructor(){this.Tr=new ot(Qt.Er),this.dr=new ot(Qt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new Qt(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new Qt(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new le(new Qe([])),r=new Qt(n,e),i=new Qt(n,e+1),o=[];return this.dr.forEachInRange([r,i],a=>{this.Vr(a),o.push(a.key)}),o}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new le(new Qe([])),r=new Qt(n,e),i=new Qt(n,e+1);let o=je();return this.dr.forEachInRange([r,i],a=>{o=o.add(a.key)}),o}containsKey(e){const n=new Qt(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Qt{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return le.comparator(e.key,n.key)||Ne(e.wr,n.wr)}static Ar(e,n){return Ne(e.wr,n.wr)||le.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lj{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new ot(Qt.Er)}checkEmpty(e){return H.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const o=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new py(o,n,r,i);this.mutationQueue.push(a);for(const u of i)this.br=this.br.add(new Qt(u.key,o)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return H.resolve(a)}lookupMutationBatch(e,n){return H.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.vr(r),o=i<0?0:i;return H.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return H.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return H.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Qt(n,0),i=new Qt(n,Number.POSITIVE_INFINITY),o=[];return this.br.forEachInRange([r,i],a=>{const u=this.Dr(a.wr);o.push(u)}),H.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new ot(Ne);return n.forEach(i=>{const o=new Qt(i,0),a=new Qt(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([o,a],u=>{r=r.add(u.wr)})}),H.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let o=r;le.isDocumentKey(o)||(o=o.child(""));const a=new Qt(new le(o),0);let u=new ot(Ne);return this.br.forEachWhile(d=>{const p=d.key.path;return!!r.isPrefixOf(p)&&(p.length===i&&(u=u.add(d.wr)),!0)},a),H.resolve(this.Cr(u))}Cr(e){const n=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){ge(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return H.forEach(n.mutations,i=>{const o=new Qt(i.key,n.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new Qt(n,0),i=this.br.firstAfterOrEqual(r);return H.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,H.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uj{constructor(e){this.Mr=e,this.docs=function(){return new ut(le.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),o=i?i.size:0,a=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return H.resolve(r?r.document.mutableCopy():At.newInvalidDocument(n))}getEntries(e,n){let r=Kn();return n.forEach(i=>{const o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():At.newInvalidDocument(i))}),H.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let o=Kn();const a=n.path,u=new le(a.child("")),d=this.docs.getIteratorFrom(u);for(;d.hasNext();){const{key:p,value:{document:_}}=d.getNext();if(!a.isPrefixOf(p.path))break;p.path.length>a.length+1||oy(kI(_),r)<=0||(i.has(_.key)||Yc(n,_))&&(o=o.insert(_.key,_.mutableCopy()))}return H.resolve(o)}getAllFromCollectionGroup(e,n,r,i){de()}Or(e,n){return H.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new cj(this)}getSize(e){return H.resolve(this.size)}}class cj extends Nk{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),H.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hj{constructor(e){this.persistence=e,this.Nr=new oo(n=>Yo(n),Zc),this.lastRemoteSnapshotVersion=ve.min(),this.highestTargetId=0,this.Lr=0,this.Br=new xy,this.targetCount=0,this.kr=ea.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,i)=>n(i)),H.resolve()}getLastRemoteSnapshotVersion(e){return H.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return H.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),H.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),H.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new ea(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,H.resolve()}updateTargetData(e,n){return this.Kn(n),H.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,H.resolve()}removeTargets(e,n,r){let i=0;const o=[];return this.Nr.forEach((a,u)=>{u.sequenceNumber<=n&&r.get(u.targetId)===null&&(this.Nr.delete(a),o.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),H.waitFor(o).next(()=>i)}getTargetCount(e){return H.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return H.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),H.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const i=this.persistence.referenceDelegate,o=[];return i&&n.forEach(a=>{o.push(i.markPotentiallyOrphaned(e,a))}),H.waitFor(o)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),H.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return H.resolve(r)}containsKey(e,n){return H.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dk{constructor(e,n){this.qr={},this.overlays={},this.Qr=new On(0),this.Kr=!1,this.Kr=!0,this.$r=new aj,this.referenceDelegate=e(this),this.Ur=new hj(this),this.indexManager=new KD,this.remoteDocumentCache=function(i){return new uj(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new Tk(n),this.Gr=new sj(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new oj,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new lj(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){te("MemoryPersistence","Starting transaction:",e);const i=new dj(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(o=>this.referenceDelegate.jr(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Hr(e,n){return H.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class dj extends PI{constructor(e){super(),this.currentSequenceNumber=e}}class ep{constructor(e){this.persistence=e,this.Jr=new xy,this.Yr=null}static Zr(e){return new ep(e)}get Xr(){if(this.Yr)return this.Yr;throw de()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),H.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),H.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),H.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(o=>this.Xr.add(o.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return H.forEach(this.Xr,r=>{const i=le.fromPath(r);return this.ei(e,i).next(o=>{o||n.removeEntry(i,ve.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return H.or([()=>H.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fj{constructor(e){this.serializer=e}O(e,n,r,i){const o=new Hf("createOrUpgrade",n);r<1&&i>=1&&(function(d){d.createObjectStore("owner")}(e),function(d){d.createObjectStore("mutationQueues",{keyPath:"userId"}),d.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Rw,{unique:!0}),d.createObjectStore("documentMutations")}(e),vx(e),function(d){d.createObjectStore("remoteDocuments")}(e));let a=H.resolve();return r<3&&i>=3&&(r!==0&&(function(d){d.deleteObjectStore("targetDocuments"),d.deleteObjectStore("targets"),d.deleteObjectStore("targetGlobal")}(e),vx(e)),a=a.next(()=>function(d){const p=d.store("targetGlobal"),_={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ve.min().toTimestamp(),targetCount:0};return p.put("targetGlobalKey",_)}(o))),r<4&&i>=4&&(r!==0&&(a=a.next(()=>function(d,p){return p.store("mutations").U().next(_=>{d.deleteObjectStore("mutations"),d.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Rw,{unique:!0});const w=p.store("mutations"),x=_.map(k=>w.put(k));return H.waitFor(x)})}(e,o))),a=a.next(()=>{(function(d){d.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(a=a.next(()=>this.ni(o))),r<6&&i>=6&&(a=a.next(()=>(function(d){d.createObjectStore("remoteDocumentGlobal")}(e),this.ri(o)))),r<7&&i>=7&&(a=a.next(()=>this.ii(o))),r<8&&i>=8&&(a=a.next(()=>this.si(e,o))),r<9&&i>=9&&(a=a.next(()=>{(function(d){d.objectStoreNames.contains("remoteDocumentChanges")&&d.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(a=a.next(()=>this.oi(o))),r<11&&i>=11&&(a=a.next(()=>{(function(d){d.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(d){d.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(a=a.next(()=>{(function(d){const p=d.createObjectStore("documentOverlays",{keyPath:$L});p.createIndex("collectionPathOverlayIndex",HL,{unique:!1}),p.createIndex("collectionGroupOverlayIndex",WL,{unique:!1})})(e)})),r<13&&i>=13&&(a=a.next(()=>function(d){const p=d.createObjectStore("remoteDocumentsV14",{keyPath:LL});p.createIndex("documentKeyIndex",DL),p.createIndex("collectionGroupIndex",jL)}(e)).next(()=>this._i(e,o)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(a=a.next(()=>this.ai(e,o))),r<15&&i>=15&&(a=a.next(()=>function(d){d.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),d.createObjectStore("indexState",{keyPath:UL}).createIndex("sequenceNumberIndex",BL,{unique:!1}),d.createObjectStore("indexEntries",{keyPath:zL}).createIndex("documentKeyIndex",qL,{unique:!1})}(e))),r<16&&i>=16&&(a=a.next(()=>{n.objectStore("indexState").clear()}).next(()=>{n.objectStore("indexEntries").clear()})),r<17&&i>=17&&(a=a.next(()=>{(function(d){d.createObjectStore("globals",{keyPath:"name"})})(e)})),a}ri(e){let n=0;return e.store("remoteDocuments").J((r,i)=>{n+=ff(i)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.U().next(i=>H.forEach(i,o=>{const a=IDBKeyRange.bound([o.userId,-1],[o.userId,o.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",a).next(u=>H.forEach(u,d=>{ge(d.userId===o.userId);const p=So(this.serializer,d);return Pk(e,o.userId,p).next(()=>{})}))}))}ii(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const o=[];return r.J((a,u)=>{const d=new Qe(a),p=function(w){return[0,In(w)]}(d);o.push(n.get(p).next(_=>_?H.resolve():(w=>n.put({targetId:0,path:In(w),sequenceNumber:i.highestListenSequenceNumber}))(d)))}).next(()=>H.waitFor(o))})}si(e,n){e.createObjectStore("collectionParents",{keyPath:FL});const r=n.store("collectionParents"),i=new wy,o=a=>{if(i.add(a)){const u=a.lastSegment(),d=a.popLast();return r.put({collectionId:u,parent:In(d)})}};return n.store("remoteDocuments").J({H:!0},(a,u)=>{const d=new Qe(a);return o(d.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([a,u,d],p)=>{const _=Yr(u);return o(_.popLast())}))}oi(e){const n=e.store("targets");return n.J((r,i)=>{const o=Du(i),a=Ek(this.serializer,o);return n.put(a)})}_i(e,n){const r=n.store("remoteDocuments"),i=[];return r.J((o,a)=>{const u=n.store("remoteDocumentsV14"),d=function(w){return w.document?new le(Qe.fromString(w.document.name).popFirst(5)):w.noDocument?le.fromSegments(w.noDocument.path):w.unknownDocument?le.fromSegments(w.unknownDocument.path):de()}(a).path.toArray(),p={prefixPath:d.slice(0,d.length-2),collectionGroup:d[d.length-2],documentId:d[d.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};i.push(u.put(p))}).next(()=>H.waitFor(i))}ai(e,n){const r=n.store("mutations"),i=Rk(this.serializer),o=new Dk(ep.Zr,this.serializer.ct);return r.U().next(a=>{const u=new Map;return a.forEach(d=>{var p;let _=(p=u.get(d.userId))!==null&&p!==void 0?p:je();So(this.serializer,d).keys().forEach(w=>_=_.add(w)),u.set(d.userId,_)}),H.forEach(u,(d,p)=>{const _=new un(p),w=Jf.lt(this.serializer,_),x=o.getIndexManager(_),k=Xf.lt(_,this.serializer,x,o.referenceDelegate);return new Lk(i,k,w,x).recalculateAndSaveOverlaysForDocumentKeys(new Tg(n,On.oe),d).next()})})}}function vx(t){t.createObjectStore("targetDocuments",{keyPath:OL}).createIndex("documentTargetsIndex",VL,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",ML,{unique:!0}),t.createObjectStore("targetGlobal")}const lm="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class by{constructor(e,n,r,i,o,a,u,d,p,_,w=17){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.ui=o,this.window=a,this.document=u,this.ci=p,this.li=_,this.hi=w,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=x=>Promise.resolve(),!by.D())throw new oe(Y.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new tj(this,i),this.Ai=n+"main",this.serializer=new Tk(d),this.Ri=new Ws(this.Ai,this.hi,new fj(this.serializer)),this.$r=new zD,this.Ur=new QD(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Rk(this.serializer),this.Gr=new BD,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,_===!1&&Mt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new oe(Y.FAILED_PRECONDITION,lm);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new On(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Hh(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(n=>{n||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(n=>this.isPrimary&&!n?this.bi(e).next(()=>!1):!!n&&this.Di(e).next(()=>!0))).catch(e=>{if(so(e))return te("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return te("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return xu(e).get("owner").next(n=>H.resolve(this.vi(n)))}Ci(e){return Hh(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Gt(n,"clientMetadata");return r.U().next(i=>{const o=this.xi(i,18e5),a=i.filter(u=>o.indexOf(u)===-1);return H.forEach(a,u=>r.delete(u.clientId)).next(()=>a)})}).catch(()=>[]);if(this.Vi)for(const n of e)this.Vi.removeItem(this.Oi(n.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?H.resolve(!0):xu(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)){if(this.vi(n)&&this.networkEnabled)return!0;if(!this.vi(n)){if(!n.allowTabSynchronization)throw new oe(Y.FAILED_PRECONDITION,lm);return!1}}return!(!this.networkEnabled||!this.inForeground)||Hh(e).U().next(r=>this.xi(r,5e3).find(i=>{if(this.clientId!==i.clientId){const o=!this.networkEnabled&&i.networkEnabled,a=!this.inForeground&&i.inForeground,u=this.networkEnabled===i.networkEnabled;if(o||a&&u)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&te("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new Tg(e,On.oe);return this.bi(n).next(()=>this.Ci(n))}),this.Ri.close(),this.qi()}xi(e,n){return e.filter(r=>this.Mi(r.updateTimeMs,n)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>Hh(e).U().next(n=>this.xi(n,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,n){return Xf.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new ZD(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Jf.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,n,r){te("IndexedDbPersistence","Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",o=function(d){return d===17?ZL:d===16?KL:d===15?ly:d===14?DI:d===13?LI:d===12?GL:d===11?RI:void de()}(this.hi);let a;return this.Ri.runTransaction(e,i,o,u=>(a=new Tg(u,this.Qr?this.Qr.next():On.oe),n==="readwrite-primary"?this.wi(a).next(d=>!!d||this.Si(a)).next(d=>{if(!d)throw Mt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new oe(Y.FAILED_PRECONDITION,SI);return r(a)}).next(d=>this.Di(a).next(()=>d)):this.Ki(a).next(()=>r(a)))).then(u=>(a.raiseOnCommittedEvent(),u))}Ki(e){return xu(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)&&!this.vi(n)&&!(this.li||this.allowTabSynchronization&&n.allowTabSynchronization))throw new oe(Y.FAILED_PRECONDITION,lm)})}Di(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return xu(e).put("owner",n)}static D(){return Ws.D()}bi(e){const n=xu(e);return n.get("owner").next(r=>this.vi(r)?(te("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):H.resolve())}Mi(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(Mt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const n=/(?:Version|Mobile)\/1[456]/;SE()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var n;try{const r=((n=this.Vi)===null||n===void 0?void 0:n.getItem(this.Oi(e)))!==null;return te("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Mt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){Mt("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function xu(t){return Gt(t,"owner")}function Hh(t){return Gt(t,"clientMetadata")}function jk(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ty{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=i}static Wi(e,n){let r=je(),i=je();for(const o of n.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new Ty(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pj{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mk{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return SE()?8:AI(Wt())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,i){const o={result:null};return this.Yi(e,n).next(a=>{o.result=a}).next(()=>{if(!o.result)return this.Zi(e,n,i,r).next(a=>{o.result=a})}).next(()=>{if(o.result)return;const a=new pj;return this.Xi(e,n,a).next(u=>{if(o.result=u,this.zi)return this.es(e,n,a,u.size)})}).next(()=>o.result)}es(e,n,r,i){return r.documentReadCount<this.ji?(Fa()<=ze.DEBUG&&te("QueryEngine","SDK will not create cache indexes for query:",Ua(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),H.resolve()):(Fa()<=ze.DEBUG&&te("QueryEngine","Query:",Ua(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(Fa()<=ze.DEBUG&&te("QueryEngine","The SDK decides to create cache indexes for query:",Ua(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Yn(n))):H.resolve())}Yi(e,n){if(Hw(n))return H.resolve(null);let r=Yn(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Cg(n,null,"F"),r=Yn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{const a=je(...o);return this.Ji.getDocuments(e,a).next(u=>this.indexManager.getMinOffset(e,r).next(d=>{const p=this.ts(n,u);return this.ns(n,p,a,d.readTime)?this.Yi(e,Cg(n,null,"F")):this.rs(e,p,n,d)}))})))}Zi(e,n,r,i){return Hw(n)||i.isEqual(ve.min())?H.resolve(null):this.Ji.getDocuments(e,r).next(o=>{const a=this.ts(n,o);return this.ns(n,a,r,i)?H.resolve(null):(Fa()<=ze.DEBUG&&te("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ua(n)),this.rs(e,a,n,II(i,-1)).next(u=>u))})}ts(e,n){let r=new ot(YI(e));return n.forEach((i,o)=>{Yc(e,o)&&(r=r.add(o))}),r}ns(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const o=e.limitType==="F"?n.last():n.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Xi(e,n,r){return Fa()<=ze.DEBUG&&te("QueryEngine","Using full collection scan to execute query:",Ua(n)),this.Ji.getDocumentsMatchingQuery(e,n,tr.min(),r)}rs(e,n,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(o=>(n.forEach(a=>{o=o.insert(a.key,a)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mj{constructor(e,n,r,i){this.persistence=e,this.ss=n,this.serializer=i,this.os=new ut(Ne),this._s=new oo(o=>Yo(o),Zc),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Lk(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function Ok(t,e,n,r){return new mj(t,e,n,r)}async function Vk(t,e){const n=fe(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(o=>{const a=[],u=[];let d=je();for(const p of i){a.push(p.batchId);for(const _ of p.mutations)d=d.add(_.key)}for(const p of o){u.push(p.batchId);for(const _ of p.mutations)d=d.add(_.key)}return n.localDocuments.getDocuments(r,d).next(p=>({hs:p,removedBatchIds:a,addedBatchIds:u}))})})}function gj(t,e){const n=fe(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),o=n.cs.newChangeBuffer({trackRemovals:!0});return function(u,d,p,_){const w=p.batch,x=w.keys();let k=H.resolve();return x.forEach(P=>{k=k.next(()=>_.getEntry(d,P)).next(j=>{const B=p.docVersions.get(P);ge(B!==null),j.version.compareTo(B)<0&&(w.applyToRemoteDocument(j,p),j.isValidDocument()&&(j.setReadTime(p.commitVersion),_.addEntry(j)))})}),k.next(()=>u.mutationQueue.removeMutationBatch(d,w))}(n,r,e,o).next(()=>o.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let d=je();for(let p=0;p<u.mutationResults.length;++p)u.mutationResults[p].transformResults.length>0&&(d=d.add(u.batch.mutations[p].key));return d}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function Fk(t){const e=fe(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function _j(t,e){const n=fe(t),r=e.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const a=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const u=[];e.targetChanges.forEach((_,w)=>{const x=i.get(w);if(!x)return;u.push(n.Ur.removeMatchingKeys(o,_.removedDocuments,w).next(()=>n.Ur.addMatchingKeys(o,_.addedDocuments,w)));let k=x.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(w)!==null?k=k.withResumeToken(Ot.EMPTY_BYTE_STRING,ve.min()).withLastLimboFreeSnapshotVersion(ve.min()):_.resumeToken.approximateByteSize()>0&&(k=k.withResumeToken(_.resumeToken,r)),i=i.insert(w,k),function(j,B,R){return j.resumeToken.approximateByteSize()===0||B.snapshotVersion.toMicroseconds()-j.snapshotVersion.toMicroseconds()>=3e8?!0:R.addedDocuments.size+R.modifiedDocuments.size+R.removedDocuments.size>0}(x,k,_)&&u.push(n.Ur.updateTargetData(o,k))});let d=Kn(),p=je();if(e.documentUpdates.forEach(_=>{e.resolvedLimboDocuments.has(_)&&u.push(n.persistence.referenceDelegate.updateLimboDocument(o,_))}),u.push(yj(o,a,e.documentUpdates).next(_=>{d=_.Ps,p=_.Is})),!r.isEqual(ve.min())){const _=n.Ur.getLastRemoteSnapshotVersion(o).next(w=>n.Ur.setTargetsMetadata(o,o.currentSequenceNumber,r));u.push(_)}return H.waitFor(u).next(()=>a.apply(o)).next(()=>n.localDocuments.getLocalViewOfDocuments(o,d,p)).next(()=>d)}).then(o=>(n.os=i,o))}function yj(t,e,n){let r=je(),i=je();return n.forEach(o=>r=r.add(o)),e.getEntries(t,r).next(o=>{let a=Kn();return n.forEach((u,d)=>{const p=o.get(u);d.isFoundDocument()!==p.isFoundDocument()&&(i=i.add(u)),d.isNoDocument()&&d.version.isEqual(ve.min())?(e.removeEntry(u,d.readTime),a=a.insert(u,d)):!p.isValidDocument()||d.version.compareTo(p.version)>0||d.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(d),a=a.insert(u,d)):te("LocalStore","Ignoring outdated watch update for ",u,". Current version:",p.version," Watch version:",d.version)}),{Ps:a,Is:i}})}function vj(t,e){const n=fe(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function pf(t,e){const n=fe(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Ur.getTargetData(r,e).next(o=>o?(i=o,H.resolve(i)):n.Ur.allocateTargetId(r).next(a=>(i=new Di(e,a,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Pl(t,e,n){const r=fe(t),i=r.os.get(e),o=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",o,a=>r.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!so(a))throw a;te("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function Vg(t,e,n){const r=fe(t);let i=ve.min(),o=je();return r.persistence.runTransaction("Execute query","readwrite",a=>function(d,p,_){const w=fe(d),x=w._s.get(_);return x!==void 0?H.resolve(w.os.get(x)):w.Ur.getTargetData(p,_)}(r,a,Yn(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(a,u.targetId).next(d=>{o=d})}).next(()=>r.ss.getDocumentsMatchingQuery(a,e,n?i:ve.min(),n?o:je())).next(u=>(zk(r,QI(e),u),{documents:u,Ts:o})))}function Uk(t,e){const n=fe(t),r=fe(n.Ur),i=n.os.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",o=>r.ot(o,e).next(a=>a?a.target:null))}function Bk(t,e){const n=fe(t),r=n.us.get(e)||ve.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.cs.getAllFromCollectionGroup(i,e,II(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(zk(n,e,i),i))}function zk(t,e,n){let r=t.us.get(e)||ve.min();n.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),t.us.set(e,r)}function wx(t,e){return`firestore_clients_${t}_${e}`}function xx(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function um(t,e){return`firestore_targets_${t}_${e}`}class mf{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Rs(e,n,r){const i=JSON.parse(r);let o,a=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return a&&i.error&&(a=typeof i.error.message=="string"&&typeof i.error.code=="string",a&&(o=new oe(i.error.code,i.error.message))),a?new mf(e,n,i.state,o):(Mt("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Yu{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Rs(e,n){const r=JSON.parse(n);let i,o=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return o&&r.error&&(o=typeof r.error.message=="string"&&typeof r.error.code=="string",o&&(i=new oe(r.error.code,r.error.message))),o?new Yu(e,r.state,i):(Mt("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class gf{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Rs(e,n){const r=JSON.parse(n);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,o=dy();for(let a=0;i&&a<r.activeTargetIds.length;++a)i=CI(r.activeTargetIds[a]),o=o.add(r.activeTargetIds[a]);return i?new gf(e,o):(Mt("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class Ey{constructor(e,n){this.clientId=e,this.onlineState=n}static Rs(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new Ey(n.clientId,n.onlineState):(Mt("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Fg{constructor(){this.activeTargetIds=dy()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class cm{constructor(e,n,r,i,o){this.window=e,this.ui=n,this.persistenceKey=r,this.ps=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new ut(Ne),this.started=!1,this.bs=[];const a=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.Ds=wx(this.persistenceKey,this.ps),this.vs=function(d){return`firestore_sequence_number_${d}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new Fg),this.Cs=new RegExp(`^firestore_clients_${a}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${a}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${a}_(\\d+)$`),this.xs=function(d){return`firestore_online_state_${d}`}(this.persistenceKey),this.Os=function(d){return`firestore_bundle_loaded_v2_${d}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const r of e){if(r===this.ps)continue;const i=this.getItem(wx(this.persistenceKey,r));if(i){const o=gf.Rs(r,i);o&&(this.Ss=this.Ss.insert(o.clientId,o))}}this.Ns();const n=this.storage.getItem(this.xs);if(n){const r=this.Ls(n);r&&this.Bs(r)}for(const r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let n=!1;return this.Ss.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,n,r){this.qs(e,n,r),this.Qs(e)}addLocalQueryTarget(e,n=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(um(this.persistenceKey,e));if(i){const o=Yu.Rs(e,i);o&&(r=o.state)}}return n&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(um(this.persistenceKey,e))}updateQueryState(e,n,r){this.$s(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Qs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return te("SharedClientState","READ",e,n),n}setItem(e,n){te("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){te("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const n=e;if(n.storageArea===this.storage){if(te("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Ds)return void Mt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.Cs.test(n.key)){if(n.newValue==null){const r=this.Gs(n.key);return this.zs(r,null)}{const r=this.js(n.key,n.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(n.key)){if(n.newValue!==null){const r=this.Hs(n.key,n.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(n.key)){if(n.newValue!==null){const r=this.Ys(n.key,n.newValue);if(r)return this.Zs(r)}}else if(n.key===this.xs){if(n.newValue!==null){const r=this.Ls(n.newValue);if(r)return this.Bs(r)}}else if(n.key===this.vs){const r=function(o){let a=On.oe;if(o!=null)try{const u=JSON.parse(o);ge(typeof u=="number"),a=u}catch(u){Mt("SharedClientState","Failed to read sequence number from WebStorage",u)}return a}(n.newValue);r!==On.oe&&this.sequenceNumberHandler(r)}else if(n.key===this.Os){const r=this.Xs(n.newValue);await Promise.all(r.map(i=>this.syncEngine.eo(i)))}}}else this.bs.push(n)})}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,n,r){const i=new mf(this.currentUser,e,n,r),o=xx(this.persistenceKey,this.currentUser,e);this.setItem(o,i.Vs())}Qs(e){const n=xx(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Us(e){const n={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(n))}$s(e,n,r){const i=um(this.persistenceKey,e),o=new Yu(e,n,r);this.setItem(i,o.Vs())}Ws(e){const n=JSON.stringify(Array.from(e));this.setItem(this.Os,n)}Gs(e){const n=this.Cs.exec(e);return n?n[1]:null}js(e,n){const r=this.Gs(e);return gf.Rs(r,n)}Hs(e,n){const r=this.Fs.exec(e),i=Number(r[1]),o=r[2]!==void 0?r[2]:null;return mf.Rs(new un(o),i,n)}Ys(e,n){const r=this.Ms.exec(e),i=Number(r[1]);return Yu.Rs(i,n)}Ls(e){return Ey.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);te("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,n){const r=n?this.Ss.insert(e,n):this.Ss.remove(e),i=this.ks(this.Ss),o=this.ks(r),a=[],u=[];return o.forEach(d=>{i.has(d)||a.push(d)}),i.forEach(d=>{o.has(d)||u.push(d)}),this.syncEngine.io(a,u).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let n=dy();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}}class qk{constructor(){this.so=new Fg,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Fg,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wj{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bx{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){te("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){te("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wh=null;function hm(){return Wh===null?Wh=function(){return 268435456+Math.round(2147483648*Math.random())}():Wh++,"0x"+Wh.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xj={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bj{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ln="WebChannelConnection";class Tj extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${i}/databases/${o}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${o}`}get Fo(){return!1}Mo(n,r,i,o,a){const u=hm(),d=this.xo(n,r.toUriEncodedString());te("RestConnection",`Sending RPC '${n}' ${u}:`,d,i);const p={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(p,o,a),this.No(n,d,p,i).then(_=>(te("RestConnection",`Received RPC '${n}' ${u}: `,_),_),_=>{throw wc("RestConnection",`RPC '${n}' ${u} failed with error: `,_,"url: ",d,"request:",i),_})}Lo(n,r,i,o,a,u){return this.Mo(n,r,i,o,a)}Oo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ol}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((o,a)=>n[a]=o),i&&i.headers.forEach((o,a)=>n[a]=o)}xo(n,r){const i=xj[n];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,i){const o=hm();return new Promise((a,u)=>{const d=new yI;d.setWithCredentials(!0),d.listenOnce(vI.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case md.NO_ERROR:const _=d.getResponseJson();te(ln,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(_)),a(_);break;case md.TIMEOUT:te(ln,`RPC '${e}' ${o} timed out`),u(new oe(Y.DEADLINE_EXCEEDED,"Request time out"));break;case md.HTTP_ERROR:const w=d.getStatus();if(te(ln,`RPC '${e}' ${o} failed with status:`,w,"response text:",d.getResponseText()),w>0){let x=d.getResponseJson();Array.isArray(x)&&(x=x[0]);const k=x==null?void 0:x.error;if(k&&k.status&&k.message){const P=function(B){const R=B.toLowerCase().replace(/_/g,"-");return Object.values(Y).indexOf(R)>=0?R:Y.UNKNOWN}(k.status);u(new oe(P,k.message))}else u(new oe(Y.UNKNOWN,"Server responded with status "+d.getStatus()))}else u(new oe(Y.UNAVAILABLE,"Connection failed."));break;default:de()}}finally{te(ln,`RPC '${e}' ${o} completed.`)}});const p=JSON.stringify(i);te(ln,`RPC '${e}' ${o} sending request:`,i),d.send(n,"POST",p,r,15)})}Bo(e,n,r){const i=hm(),o=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=bI(),u=xI(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(d.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(d.useFetchStreams=!0),this.Oo(d.initMessageHeaders,n,r),d.encodeInitMessageHeaders=!0;const _=o.join("");te(ln,`Creating RPC '${e}' stream ${i}: ${_}`,d);const w=a.createWebChannel(_,d);let x=!1,k=!1;const P=new bj({Io:B=>{k?te(ln,`Not sending because RPC '${e}' stream ${i} is closed:`,B):(x||(te(ln,`Opening RPC '${e}' stream ${i} transport.`),w.open(),x=!0),te(ln,`RPC '${e}' stream ${i} sending:`,B),w.send(B))},To:()=>w.close()}),j=(B,R,S)=>{B.listen(R,N=>{try{S(N)}catch(z){setTimeout(()=>{throw z},0)}})};return j(w,Nu.EventType.OPEN,()=>{k||(te(ln,`RPC '${e}' stream ${i} transport opened.`),P.yo())}),j(w,Nu.EventType.CLOSE,()=>{k||(k=!0,te(ln,`RPC '${e}' stream ${i} transport closed`),P.So())}),j(w,Nu.EventType.ERROR,B=>{k||(k=!0,wc(ln,`RPC '${e}' stream ${i} transport errored:`,B),P.So(new oe(Y.UNAVAILABLE,"The operation could not be completed")))}),j(w,Nu.EventType.MESSAGE,B=>{var R;if(!k){const S=B.data[0];ge(!!S);const N=S,z=N.error||((R=N[0])===null||R===void 0?void 0:R.error);if(z){te(ln,`RPC '${e}' stream ${i} received error:`,z);const G=z.status;let F=function(C){const A=Bt[C];if(A!==void 0)return uk(A)}(G),I=z.message;F===void 0&&(F=Y.INTERNAL,I="Unknown error status: "+G+" with message "+z.message),k=!0,P.So(new oe(F,I)),w.close()}else te(ln,`RPC '${e}' stream ${i} received:`,S),P.bo(S)}}),j(u,wI.STAT_EVENT,B=>{B.stat===xg.PROXY?te(ln,`RPC '${e}' stream ${i} detected buffering proxy`):B.stat===xg.NOPROXY&&te(ln,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{P.wo()},0),P}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $k(){return typeof window<"u"?window:null}function bd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tp(t){return new CD(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hk{constructor(e,n,r=1e3,i=1.5,o=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=i,this.Qo=o,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,n-r);i>0&&te("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wk{constructor(e,n,r,i,o,a,u,d){this.ui=e,this.Ho=r,this.Jo=i,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=d,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Hk(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===Y.RESOURCE_EXHAUSTED?(Mt(n.toString()),Mt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===Y.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===n&&this.P_(r,i)},r=>{e(()=>{const i=new oe(Y.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return te("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(te("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Ej extends Wk{constructor(e,n,r,i,o,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,a),this.serializer=o}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=LD(this.serializer,e),r=function(o){if(!("targetChange"in o))return ve.min();const a=o.targetChange;return a.targetIds&&a.targetIds.length?ve.min():a.readTime?kn(a.readTime):ve.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=Lg(this.serializer),n.addTarget=function(o,a){let u;const d=a.target;if(u=af(d)?{documents:_k(o,d)}:{query:yk(o,d)._t},u.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){u.resumeToken=dk(o,a.resumeToken);const p=Ng(o,a.expectedCount);p!==null&&(u.expectedCount=p)}else if(a.snapshotVersion.compareTo(ve.min())>0){u.readTime=Sl(o,a.snapshotVersion.toTimestamp());const p=Ng(o,a.expectedCount);p!==null&&(u.expectedCount=p)}return u}(this.serializer,e);const r=jD(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=Lg(this.serializer),n.removeTarget=e,this.a_(n)}}class Ij extends Wk{constructor(e,n,r,i,o,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,a),this.serializer=o}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return ge(!!e.streamToken),this.lastStreamToken=e.streamToken,ge(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){ge(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=DD(e.writeResults,e.commitTime),r=kn(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=Lg(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>cf(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kj extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new oe(Y.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Mo(e,Rg(n,r),i,o,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new oe(Y.UNKNOWN,o.toString())})}Lo(e,n,r,i,o){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,u])=>this.connection.Lo(e,Rg(n,r),i,a,u,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===Y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new oe(Y.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class Sj{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Mt(n),this.D_=!1):te("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pj{constructor(e,n,r,i,o){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=o,this.k_._o(a=>{r.enqueueAndForget(async()=>{ca(this)&&(te("RemoteStore","Restarting streams for network reachability change."),await async function(d){const p=fe(d);p.L_.add(4),await eh(p),p.q_.set("Unknown"),p.L_.delete(4),await np(p)}(this))})}),this.q_=new Sj(r,i)}}async function np(t){if(ca(t))for(const e of t.B_)await e(!0)}async function eh(t){for(const e of t.B_)await e(!1)}function rp(t,e){const n=fe(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),Sy(n)?ky(n):Bl(n).r_()&&Iy(n,e))}function Al(t,e){const n=fe(t),r=Bl(n);n.N_.delete(e),r.r_()&&Gk(n,e),n.N_.size===0&&(r.r_()?r.o_():ca(n)&&n.q_.set("Unknown"))}function Iy(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ve.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Bl(t).A_(e)}function Gk(t,e){t.Q_.xe(e),Bl(t).R_(e)}function ky(t){t.Q_=new kD({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Bl(t).start(),t.q_.v_()}function Sy(t){return ca(t)&&!Bl(t).n_()&&t.N_.size>0}function ca(t){return fe(t).L_.size===0}function Kk(t){t.Q_=void 0}async function Aj(t){t.q_.set("Online")}async function Cj(t){t.N_.forEach((e,n)=>{Iy(t,e)})}async function Nj(t,e){Kk(t),Sy(t)?(t.q_.M_(e),ky(t)):t.q_.set("Unknown")}async function Rj(t,e,n){if(t.q_.set("Online"),e instanceof hk&&e.state===2&&e.cause)try{await async function(i,o){const a=o.cause;for(const u of o.targetIds)i.N_.has(u)&&(await i.remoteSyncer.rejectListen(u,a),i.N_.delete(u),i.Q_.removeTarget(u))}(t,e)}catch(r){te("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await _f(t,r)}else if(e instanceof xd?t.Q_.Ke(e):e instanceof ck?t.Q_.He(e):t.Q_.We(e),!n.isEqual(ve.min()))try{const r=await Fk(t.localStore);n.compareTo(r)>=0&&await function(o,a){const u=o.Q_.rt(a);return u.targetChanges.forEach((d,p)=>{if(d.resumeToken.approximateByteSize()>0){const _=o.N_.get(p);_&&o.N_.set(p,_.withResumeToken(d.resumeToken,a))}}),u.targetMismatches.forEach((d,p)=>{const _=o.N_.get(d);if(!_)return;o.N_.set(d,_.withResumeToken(Ot.EMPTY_BYTE_STRING,_.snapshotVersion)),Gk(o,d);const w=new Di(_.target,d,p,_.sequenceNumber);Iy(o,w)}),o.remoteSyncer.applyRemoteEvent(u)}(t,n)}catch(r){te("RemoteStore","Failed to raise snapshot:",r),await _f(t,r)}}async function _f(t,e,n){if(!so(e))throw e;t.L_.add(1),await eh(t),t.q_.set("Offline"),n||(n=()=>Fk(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{te("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await np(t)})}function Zk(t,e){return e().catch(n=>_f(t,n,e))}async function Ul(t){const e=fe(t),n=Xs(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;Lj(e);)try{const i=await vj(e.localStore,r);if(i===null){e.O_.length===0&&n.o_();break}r=i.batchId,Dj(e,i)}catch(i){await _f(e,i)}Qk(e)&&Yk(e)}function Lj(t){return ca(t)&&t.O_.length<10}function Dj(t,e){t.O_.push(e);const n=Xs(t);n.r_()&&n.V_&&n.m_(e.mutations)}function Qk(t){return ca(t)&&!Xs(t).n_()&&t.O_.length>0}function Yk(t){Xs(t).start()}async function jj(t){Xs(t).p_()}async function Mj(t){const e=Xs(t);for(const n of t.O_)e.m_(n.mutations)}async function Oj(t,e,n){const r=t.O_.shift(),i=my.from(r,e,n);await Zk(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Ul(t)}async function Vj(t,e){e&&Xs(t).V_&&await async function(r,i){if(function(a){return TD(a)&&a!==Y.ABORTED}(i.code)){const o=r.O_.shift();Xs(r).s_(),await Zk(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),await Ul(r)}}(t,e),Qk(t)&&Yk(t)}async function Tx(t,e){const n=fe(t);n.asyncQueue.verifyOperationInProgress(),te("RemoteStore","RemoteStore received new credentials");const r=ca(n);n.L_.add(3),await eh(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await np(n)}async function Ug(t,e){const n=fe(t);e?(n.L_.delete(2),await np(n)):e||(n.L_.add(2),await eh(n),n.q_.set("Unknown"))}function Bl(t){return t.K_||(t.K_=function(n,r,i){const o=fe(n);return o.w_(),new Ej(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Eo:Aj.bind(null,t),Ro:Cj.bind(null,t),mo:Nj.bind(null,t),d_:Rj.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Sy(t)?ky(t):t.q_.set("Unknown")):(await t.K_.stop(),Kk(t))})),t.K_}function Xs(t){return t.U_||(t.U_=function(n,r,i){const o=fe(n);return o.w_(),new Ij(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:jj.bind(null,t),mo:Vj.bind(null,t),f_:Mj.bind(null,t),g_:Oj.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Ul(t)):(await t.U_.stop(),t.O_.length>0&&(te("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Py{constructor(e,n,r,i,o){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new ri,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,o){const a=Date.now()+r,u=new Py(e,n,a,i,o);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new oe(Y.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ay(t,e){if(Mt("AsyncQueue",`${e}: ${t}`),so(t))return new oe(Y.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dl{constructor(e){this.comparator=e?(n,r)=>e(n,r)||le.comparator(n.key,r.key):(n,r)=>le.comparator(n.key,r.key),this.keyedMap=Ru(),this.sortedSet=new ut(this.comparator)}static emptySet(e){return new dl(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof dl)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new dl;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ex{constructor(){this.W_=new ut(le.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):de():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Cl{constructor(e,n,r,i,o,a,u,d,p){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=a,this.syncStateChanged=u,this.excludesMetadataChanges=d,this.hasCachedResults=p}static fromInitialDocuments(e,n,r,i,o){const a=[];return n.forEach(u=>{a.push({type:0,doc:u})}),new Cl(e,n,dl.emptySet(n),a,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Kf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fj{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class Uj{constructor(){this.queries=Ix(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const i=fe(n),o=i.queries;i.queries=Ix(),o.forEach((a,u)=>{for(const d of u.j_)d.onError(r)})})(this,new oe(Y.ABORTED,"Firestore shutting down"))}}function Ix(){return new oo(t=>ZI(t),Kf)}async function Cy(t,e){const n=fe(t);let r=3;const i=e.query;let o=n.queries.get(i);o?!o.H_()&&e.J_()&&(r=2):(o=new Fj,r=e.J_()?0:1);try{switch(r){case 0:o.z_=await n.onListen(i,!0);break;case 1:o.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(a){const u=Ay(a,`Initialization of query '${Ua(e.query)}' failed`);return void e.onError(u)}n.queries.set(i,o),o.j_.push(e),e.Z_(n.onlineState),o.z_&&e.X_(o.z_)&&Ry(n)}async function Ny(t,e){const n=fe(t),r=e.query;let i=3;const o=n.queries.get(r);if(o){const a=o.j_.indexOf(e);a>=0&&(o.j_.splice(a,1),o.j_.length===0?i=e.J_()?0:1:!o.H_()&&e.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Bj(t,e){const n=fe(t);let r=!1;for(const i of e){const o=i.query,a=n.queries.get(o);if(a){for(const u of a.j_)u.X_(i)&&(r=!0);a.z_=i}}r&&Ry(n)}function zj(t,e,n){const r=fe(t),i=r.queries.get(e);if(i)for(const o of i.j_)o.onError(n);r.queries.delete(e)}function Ry(t){t.Y_.forEach(e=>{e.next()})}var Bg,kx;(kx=Bg||(Bg={})).ea="default",kx.Cache="cache";class Ly{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Cl(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=Cl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Bg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jk{constructor(e){this.key=e}}class Xk{constructor(e){this.key=e}}class qj{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=je(),this.mutatedKeys=je(),this.Aa=YI(e),this.Ra=new dl(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new Ex,i=n?n.Ra:this.Ra;let o=n?n.mutatedKeys:this.mutatedKeys,a=i,u=!1;const d=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,p=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((_,w)=>{const x=i.get(_),k=Yc(this.query,w)?w:null,P=!!x&&this.mutatedKeys.has(x.key),j=!!k&&(k.hasLocalMutations||this.mutatedKeys.has(k.key)&&k.hasCommittedMutations);let B=!1;x&&k?x.data.isEqual(k.data)?P!==j&&(r.track({type:3,doc:k}),B=!0):this.ga(x,k)||(r.track({type:2,doc:k}),B=!0,(d&&this.Aa(k,d)>0||p&&this.Aa(k,p)<0)&&(u=!0)):!x&&k?(r.track({type:0,doc:k}),B=!0):x&&!k&&(r.track({type:1,doc:x}),B=!0,(d||p)&&(u=!0)),B&&(k?(a=a.add(k),o=j?o.add(_):o.delete(_)):(a=a.delete(_),o=o.delete(_)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const _=this.query.limitType==="F"?a.last():a.first();a=a.delete(_.key),o=o.delete(_.key),r.track({type:1,doc:_})}return{Ra:a,fa:r,ns:u,mutatedKeys:o}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const o=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((_,w)=>function(k,P){const j=B=>{switch(B){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return de()}};return j(k)-j(P)}(_.type,w.type)||this.Aa(_.doc,w.doc)),this.pa(r),i=i!=null&&i;const u=n&&!i?this.ya():[],d=this.da.size===0&&this.current&&!i?1:0,p=d!==this.Ea;return this.Ea=d,a.length!==0||p?{snapshot:new Cl(this.query,e.Ra,o,a,e.mutatedKeys,d===0,p,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:u}:{wa:u}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Ex,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=je(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new Xk(r))}),this.da.forEach(r=>{e.has(r)||n.push(new Jk(r))}),n}ba(e){this.Ta=e.Ts,this.da=je();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return Cl.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class $j{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class Hj{constructor(e){this.key=e,this.va=!1}}class Wj{constructor(e,n,r,i,o,a){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new oo(u=>ZI(u),Kf),this.Ma=new Map,this.xa=new Set,this.Oa=new ut(le.comparator),this.Na=new Map,this.La=new xy,this.Ba={},this.ka=new Map,this.qa=ea.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function Gj(t,e,n=!0){const r=ip(t);let i;const o=r.Fa.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.Da()):i=await eS(r,e,n,!0),i}async function Kj(t,e){const n=ip(t);await eS(n,e,!0,!1)}async function eS(t,e,n,r){const i=await pf(t.localStore,Yn(e)),o=i.targetId,a=t.sharedClientState.addLocalQueryTarget(o,n);let u;return r&&(u=await Dy(t,e,o,a==="current",i.resumeToken)),t.isPrimaryClient&&n&&rp(t.remoteStore,i),u}async function Dy(t,e,n,r,i){t.Ka=(w,x,k)=>async function(j,B,R,S){let N=B.view.ma(R);N.ns&&(N=await Vg(j.localStore,B.query,!1).then(({documents:I})=>B.view.ma(I,N)));const z=S&&S.targetChanges.get(B.targetId),G=S&&S.targetMismatches.get(B.targetId)!=null,F=B.view.applyChanges(N,j.isPrimaryClient,z,G);return zg(j,B.targetId,F.wa),F.snapshot}(t,w,x,k);const o=await Vg(t.localStore,e,!0),a=new qj(e,o.Ts),u=a.ma(o.documents),d=Xc.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),p=a.applyChanges(u,t.isPrimaryClient,d);zg(t,n,p.wa);const _=new $j(e,n,a);return t.Fa.set(e,_),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),p.snapshot}async function Zj(t,e,n){const r=fe(t),i=r.Fa.get(e),o=r.Ma.get(i.targetId);if(o.length>1)return r.Ma.set(i.targetId,o.filter(a=>!Kf(a,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Pl(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Al(r.remoteStore,i.targetId),Nl(r,i.targetId)}).catch(io)):(Nl(r,i.targetId),await Pl(r.localStore,i.targetId,!0))}async function Qj(t,e){const n=fe(t),r=n.Fa.get(e),i=n.Ma.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Al(n.remoteStore,r.targetId))}async function Yj(t,e,n){const r=Vy(t);try{const i=await function(a,u){const d=fe(a),p=Ke.now(),_=u.reduce((k,P)=>k.add(P.key),je());let w,x;return d.persistence.runTransaction("Locally write mutations","readwrite",k=>{let P=Kn(),j=je();return d.cs.getEntries(k,_).next(B=>{P=B,P.forEach((R,S)=>{S.isValidDocument()||(j=j.add(R))})}).next(()=>d.localDocuments.getOverlayedDocuments(k,P)).next(B=>{w=B;const R=[];for(const S of u){const N=xD(S,w.get(S.key).overlayedDocument);N!=null&&R.push(new Qi(S.key,N,FI(N.value.mapValue),dn.exists(!0)))}return d.mutationQueue.addMutationBatch(k,p,R,u)}).next(B=>{x=B;const R=B.applyToLocalDocumentSet(w,j);return d.documentOverlayCache.saveOverlays(k,B.batchId,R)})}).then(()=>({batchId:x.batchId,changes:XI(w)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,u,d){let p=a.Ba[a.currentUser.toKey()];p||(p=new ut(Ne)),p=p.insert(u,d),a.Ba[a.currentUser.toKey()]=p}(r,i.batchId,n),await ao(r,i.changes),await Ul(r.remoteStore)}catch(i){const o=Ay(i,"Failed to persist write");n.reject(o)}}async function tS(t,e){const n=fe(t);try{const r=await _j(n.localStore,e);e.targetChanges.forEach((i,o)=>{const a=n.Na.get(o);a&&(ge(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?ge(a.va):i.removedDocuments.size>0&&(ge(a.va),a.va=!1))}),await ao(n,r,e)}catch(r){await io(r)}}function Sx(t,e,n){const r=fe(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Fa.forEach((o,a)=>{const u=a.view.Z_(e);u.snapshot&&i.push(u.snapshot)}),function(a,u){const d=fe(a);d.onlineState=u;let p=!1;d.queries.forEach((_,w)=>{for(const x of w.j_)x.Z_(u)&&(p=!0)}),p&&Ry(d)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function Jj(t,e,n){const r=fe(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Na.get(e),o=i&&i.key;if(o){let a=new ut(le.comparator);a=a.insert(o,At.newNoDocument(o,ve.min()));const u=je().add(o),d=new Jc(ve.min(),new Map,new ut(Ne),a,u);await tS(r,d),r.Oa=r.Oa.remove(o),r.Na.delete(e),Oy(r)}else await Pl(r.localStore,e,!1).then(()=>Nl(r,e,n)).catch(io)}async function Xj(t,e){const n=fe(t),r=e.batch.batchId;try{const i=await gj(n.localStore,e);My(n,r,null),jy(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await ao(n,i)}catch(i){await io(i)}}async function eM(t,e,n){const r=fe(t);try{const i=await function(a,u){const d=fe(a);return d.persistence.runTransaction("Reject batch","readwrite-primary",p=>{let _;return d.mutationQueue.lookupMutationBatch(p,u).next(w=>(ge(w!==null),_=w.keys(),d.mutationQueue.removeMutationBatch(p,w))).next(()=>d.mutationQueue.performConsistencyCheck(p)).next(()=>d.documentOverlayCache.removeOverlaysForBatchId(p,_,u)).next(()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,_)).next(()=>d.localDocuments.getDocuments(p,_))})}(r.localStore,e);My(r,e,n),jy(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await ao(r,i)}catch(i){await io(i)}}function jy(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function My(t,e,n){const r=fe(t);let i=r.Ba[r.currentUser.toKey()];if(i){const o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function Nl(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||nS(t,r)})}function nS(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(Al(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),Oy(t))}function zg(t,e,n){for(const r of n)r instanceof Jk?(t.La.addReference(r.key,e),tM(t,r)):r instanceof Xk?(te("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||nS(t,r.key)):de()}function tM(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(te("SyncEngine","New document in limbo: "+n),t.xa.add(r),Oy(t))}function Oy(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new le(Qe.fromString(e)),r=t.qa.next();t.Na.set(r,new Hj(n)),t.Oa=t.Oa.insert(n,r),rp(t.remoteStore,new Di(Yn(Qc(n.path)),r,"TargetPurposeLimboResolution",On.oe))}}async function ao(t,e,n){const r=fe(t),i=[],o=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((u,d)=>{a.push(r.Ka(d,e,n).then(p=>{var _;if((p||n)&&r.isPrimaryClient){const w=p?!p.fromCache:(_=n==null?void 0:n.targetChanges.get(d.targetId))===null||_===void 0?void 0:_.current;r.sharedClientState.updateQueryState(d.targetId,w?"current":"not-current")}if(p){i.push(p);const w=Ty.Wi(d.targetId,p);o.push(w)}}))}),await Promise.all(a),r.Ca.d_(i),await async function(d,p){const _=fe(d);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",w=>H.forEach(p,x=>H.forEach(x.$i,k=>_.persistence.referenceDelegate.addReference(w,x.targetId,k)).next(()=>H.forEach(x.Ui,k=>_.persistence.referenceDelegate.removeReference(w,x.targetId,k)))))}catch(w){if(!so(w))throw w;te("LocalStore","Failed to update sequence numbers: "+w)}for(const w of p){const x=w.targetId;if(!w.fromCache){const k=_.os.get(x),P=k.snapshotVersion,j=k.withLastLimboFreeSnapshotVersion(P);_.os=_.os.insert(x,j)}}}(r.localStore,o))}async function nM(t,e){const n=fe(t);if(!n.currentUser.isEqual(e)){te("SyncEngine","User change. New user:",e.toKey());const r=await Vk(n.localStore,e);n.currentUser=e,function(o,a){o.ka.forEach(u=>{u.forEach(d=>{d.reject(new oe(Y.CANCELLED,a))})}),o.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ao(n,r.hs)}}function rM(t,e){const n=fe(t),r=n.Na.get(e);if(r&&r.va)return je().add(r.key);{let i=je();const o=n.Ma.get(e);if(!o)return i;for(const a of o){const u=n.Fa.get(a);i=i.unionWith(u.view.Va)}return i}}async function iM(t,e){const n=fe(t),r=await Vg(n.localStore,e.query,!0),i=e.view.ba(r);return n.isPrimaryClient&&zg(n,e.targetId,i.wa),i}async function sM(t,e){const n=fe(t);return Bk(n.localStore,e).then(r=>ao(n,r))}async function oM(t,e,n,r){const i=fe(t),o=await function(u,d){const p=fe(u),_=fe(p.mutationQueue);return p.persistence.runTransaction("Lookup mutation documents","readonly",w=>_.Mn(w,d).next(x=>x?p.localDocuments.getDocuments(w,x):H.resolve(null)))}(i.localStore,e);o!==null?(n==="pending"?await Ul(i.remoteStore):n==="acknowledged"||n==="rejected"?(My(i,e,r||null),jy(i,e),function(u,d){fe(fe(u).mutationQueue).On(d)}(i.localStore,e)):de(),await ao(i,o)):te("SyncEngine","Cannot apply mutation batch with id: "+e)}async function aM(t,e){const n=fe(t);if(ip(n),Vy(n),e===!0&&n.Qa!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),i=await Px(n,r.toArray());n.Qa=!0,await Ug(n.remoteStore,!0);for(const o of i)rp(n.remoteStore,o)}else if(e===!1&&n.Qa!==!1){const r=[];let i=Promise.resolve();n.Ma.forEach((o,a)=>{n.sharedClientState.isLocalQueryTarget(a)?r.push(a):i=i.then(()=>(Nl(n,a),Pl(n.localStore,a,!0))),Al(n.remoteStore,a)}),await i,await Px(n,r),function(a){const u=fe(a);u.Na.forEach((d,p)=>{Al(u.remoteStore,p)}),u.La.pr(),u.Na=new Map,u.Oa=new ut(le.comparator)}(n),n.Qa=!1,await Ug(n.remoteStore,!1)}}async function Px(t,e,n){const r=fe(t),i=[],o=[];for(const a of e){let u;const d=r.Ma.get(a);if(d&&d.length!==0){u=await pf(r.localStore,Yn(d[0]));for(const p of d){const _=r.Fa.get(p),w=await iM(r,_);w.snapshot&&o.push(w.snapshot)}}else{const p=await Uk(r.localStore,a);u=await pf(r.localStore,p),await Dy(r,rS(p),a,!1,u.resumeToken)}i.push(u)}return r.Ca.d_(o),i}function rS(t){return GI(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function lM(t){return function(n){return fe(fe(n).persistence).Qi()}(fe(t).localStore)}async function uM(t,e,n,r){const i=fe(t);if(i.Qa)return void te("SyncEngine","Ignoring unexpected query state notification.");const o=i.Ma.get(e);if(o&&o.length>0)switch(n){case"current":case"not-current":{const a=await Bk(i.localStore,QI(o[0])),u=Jc.createSynthesizedRemoteEventForCurrentChange(e,n==="current",Ot.EMPTY_BYTE_STRING);await ao(i,a,u);break}case"rejected":await Pl(i.localStore,e,!0),Nl(i,e,r);break;default:de()}}async function cM(t,e,n){const r=ip(t);if(r.Qa){for(const i of e){if(r.Ma.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){te("SyncEngine","Adding an already active target "+i);continue}const o=await Uk(r.localStore,i),a=await pf(r.localStore,o);await Dy(r,rS(o),a.targetId,!1,a.resumeToken),rp(r.remoteStore,a)}for(const i of n)r.Ma.has(i)&&await Pl(r.localStore,i,!1).then(()=>{Al(r.remoteStore,i),Nl(r,i)}).catch(io)}}function ip(t){const e=fe(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=tS.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=rM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Jj.bind(null,e),e.Ca.d_=Bj.bind(null,e.eventManager),e.Ca.$a=zj.bind(null,e.eventManager),e}function Vy(t){const e=fe(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Xj.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=eM.bind(null,e),e}class Nc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=tp(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return Ok(this.persistence,new Mk,e.initialUser,this.serializer)}Ga(e){return new Dk(ep.Zr,this.serializer)}Wa(e){return new qk}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Nc.provider={build:()=>new Nc};class iS extends Nc{constructor(e,n,r){super(),this.Ja=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await Vy(this.Ja.syncEngine),await Ul(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return Ok(this.persistence,new Mk,e.initialUser,this.serializer)}ja(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new JD(r,e.asyncQueue,n)}Ha(e,n){const r=new CL(n,this.persistence);return new AL(e.asyncQueue,r)}Ga(e){const n=jk(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Ln.withCacheSize(this.cacheSizeBytes):Ln.DEFAULT;return new by(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,$k(),bd(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new qk}}class hM extends iS{constructor(e,n){super(e,n,!1),this.Ja=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.Ja.syncEngine;this.sharedClientState instanceof cm&&(this.sharedClientState.syncEngine={no:oM.bind(null,n),ro:uM.bind(null,n),io:cM.bind(null,n),Qi:lM.bind(null,n),eo:sM.bind(null,n)},await this.sharedClientState.start()),await this.persistence.yi(async r=>{await aM(this.Ja.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Wa(e){const n=$k();if(!cm.D(n))throw new oe(Y.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=jk(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new cm(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class Rc{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Sx(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=nM.bind(null,this.syncEngine),await Ug(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Uj}()}createDatastore(e){const n=tp(e.databaseInfo.databaseId),r=function(o){return new Tj(o)}(e.databaseInfo);return function(o,a,u,d){return new kj(o,a,u,d)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,o,a,u){return new Pj(r,i,o,a,u)}(this.localStore,this.datastore,e.asyncQueue,n=>Sx(this.syncEngine,n,0),function(){return bx.D()?new bx:new wj}())}createSyncEngine(e,n){return function(i,o,a,u,d,p,_){const w=new Wj(i,o,a,u,d,p);return _&&(w.Qa=!0),w}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const o=fe(i);te("RemoteStore","RemoteStore shutting down."),o.L_.add(5),await eh(o),o.k_.shutdown(),o.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Rc.provider={build:()=>new Rc};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fy{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Mt("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dM{constructor(e,n,r,i,o){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=un.UNAUTHENTICATED,this.clientId=TI.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,async a=>{te("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(te("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ri;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Ay(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function dm(t,e){t.asyncQueue.verifyOperationInProgress(),te("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await Vk(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Ax(t,e){t.asyncQueue.verifyOperationInProgress();const n=await fM(t);te("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Tx(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>Tx(e.remoteStore,i)),t._onlineComponents=e}async function fM(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){te("FirestoreClient","Using user provided OfflineComponentProvider");try{await dm(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===Y.FAILED_PRECONDITION||i.code===Y.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;wc("Error using user provided cache. Falling back to memory cache: "+n),await dm(t,new Nc)}}else te("FirestoreClient","Using default OfflineComponentProvider"),await dm(t,new Nc);return t._offlineComponents}async function sS(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(te("FirestoreClient","Using user provided OnlineComponentProvider"),await Ax(t,t._uninitializedComponentsProvider._online)):(te("FirestoreClient","Using default OnlineComponentProvider"),await Ax(t,new Rc))),t._onlineComponents}function pM(t){return sS(t).then(e=>e.syncEngine)}async function yf(t){const e=await sS(t),n=e.eventManager;return n.onListen=Gj.bind(null,e.syncEngine),n.onUnlisten=Zj.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=Kj.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=Qj.bind(null,e.syncEngine),n}function mM(t,e,n={}){const r=new ri;return t.asyncQueue.enqueueAndForget(async()=>function(o,a,u,d,p){const _=new Fy({next:x=>{_.Za(),a.enqueueAndForget(()=>Ny(o,w));const k=x.docs.has(u);!k&&x.fromCache?p.reject(new oe(Y.UNAVAILABLE,"Failed to get document because the client is offline.")):k&&x.fromCache&&d&&d.source==="server"?p.reject(new oe(Y.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(x)},error:x=>p.reject(x)}),w=new Ly(Qc(u.path),_,{includeMetadataChanges:!0,_a:!0});return Cy(o,w)}(await yf(t),t.asyncQueue,e,n,r)),r.promise}function gM(t,e,n={}){const r=new ri;return t.asyncQueue.enqueueAndForget(async()=>function(o,a,u,d,p){const _=new Fy({next:x=>{_.Za(),a.enqueueAndForget(()=>Ny(o,w)),x.fromCache&&d.source==="server"?p.reject(new oe(Y.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(x)},error:x=>p.reject(x)}),w=new Ly(u,_,{includeMetadataChanges:!0,_a:!0});return Cy(o,w)}(await yf(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oS(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cx=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aS(t,e,n){if(!n)throw new oe(Y.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function _M(t,e,n,r){if(e===!0&&r===!0)throw new oe(Y.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Nx(t){if(!le.isDocumentKey(t))throw new oe(Y.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Rx(t){if(le.isDocumentKey(t))throw new oe(Y.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function sp(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":de()}function Jn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new oe(Y.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=sp(t);throw new oe(Y.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lx{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new oe(Y.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new oe(Y.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}_M("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=oS((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new oe(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new oe(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new oe(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Uy{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Lx({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new oe(Y.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new oe(Y.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Lx(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new vL;switch(r.type){case"firstParty":return new bL(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new oe(Y.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Cx.get(n);r&&(te("ComponentProvider","Removing Datastore"),Cx.delete(n),r.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lo{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new lo(this.firestore,e,this._query)}}class pn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Gs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new pn(this.firestore,e,this._key)}}class Gs extends lo{constructor(e,n,r){super(e,n,Qc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new pn(this.firestore,null,new le(e))}withConverter(e){return new Gs(this.firestore,e,this._path)}}function Dr(t,e,...n){if(t=Ze(t),aS("collection","path",e),t instanceof Uy){const r=Qe.fromString(e,...n);return Rx(r),new Gs(t,null,r)}{if(!(t instanceof pn||t instanceof Gs))throw new oe(Y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Qe.fromString(e,...n));return Rx(r),new Gs(t.firestore,null,r)}}function Jt(t,e,...n){if(t=Ze(t),arguments.length===1&&(e=TI.newId()),aS("doc","path",e),t instanceof Uy){const r=Qe.fromString(e,...n);return Nx(r),new pn(t,null,new le(r))}{if(!(t instanceof pn||t instanceof Gs))throw new oe(Y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Qe.fromString(e,...n));return Nx(r),new pn(t.firestore,t instanceof Gs?t.converter:null,new le(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dx{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Hk(this,"async_queue_retry"),this.Vu=()=>{const r=bd();r&&te("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=bd();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=bd();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new ri;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!so(e))throw e;te("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(a){let u=a.message||"";return a.stack&&(u=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),u}(r);throw Mt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const i=Py.createAndSchedule(this,e,n,r,o=>this.yu(o));return this.Tu.push(i),i}fu(){this.Eu&&de()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function jx(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const o of r)if(o in i&&typeof i[o]=="function")return!0;return!1}(t,["next","error","complete"])}class Wi extends Uy{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new Dx,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Dx(e),this._firestoreClient=void 0,await e}}}function yM(t,e,n){const r=ro(t,"firestore");if(r.isInitialized(n)){const i=r.getImmediate({identifier:n}),o=r.getOptions(n);if(gc(o,e))return i;throw new oe(Y.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new oe(Y.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new oe(Y.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:n})}function op(t){if(t._terminated)throw new oe(Y.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||vM(t),t._firestoreClient}function vM(t){var e,n,r;const i=t._freezeSettings(),o=function(u,d,p,_){return new YL(u,d,p,_.host,_.ssl,_.experimentalForceLongPolling,_.experimentalAutoDetectLongPolling,oS(_.experimentalLongPollingOptions),_.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new dM(t._authCredentials,t._appCheckCredentials,t._queue,o,t._componentsProvider&&function(u){const d=u==null?void 0:u._online.build();return{_offline:u==null?void 0:u._offline.build(d),_online:d}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rl{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Rl(Ot.fromBase64String(e))}catch(n){throw new oe(Y.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Rl(Ot.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new oe(Y.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Et(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class By{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zy{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new oe(Y.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new oe(Y.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ne(this._lat,e._lat)||Ne(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qy{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wM=/^__.*__$/;class xM{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Qi(e,this.data,this.fieldMask,n,this.fieldTransforms):new Fl(e,this.data,n,this.fieldTransforms)}}class lS{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Qi(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function uS(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw de()}}class $y{constructor(e,n,r,i,o,a){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.vu(),this.fieldTransforms=o||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new $y(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return vf(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(uS(this.Cu)&&wM.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class bM{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||tp(e)}Qu(e,n,r,i=!1){return new $y({Cu:e,methodName:n,qu:r,path:Et.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function lp(t){const e=t._freezeSettings(),n=tp(t._databaseId);return new bM(t._databaseId,!!e.ignoreUndefinedProperties,n)}function cS(t,e,n,r,i,o={}){const a=t.Qu(o.merge||o.mergeFields?2:0,e,n,i);Hy("Data must be an object, but it was:",a,r);const u=hS(r,a);let d,p;if(o.merge)d=new Vn(a.fieldMask),p=a.fieldTransforms;else if(o.mergeFields){const _=[];for(const w of o.mergeFields){const x=qg(e,w,n);if(!a.contains(x))throw new oe(Y.INVALID_ARGUMENT,`Field '${x}' is specified in your field mask but missing from your input data.`);fS(_,x)||_.push(x)}d=new Vn(_),p=a.fieldTransforms.filter(w=>d.covers(w.field))}else d=null,p=a.fieldTransforms;return new xM(new hn(u),d,p)}class up extends By{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof up}}function TM(t,e,n,r){const i=t.Qu(1,e,n);Hy("Data must be an object, but it was:",i,r);const o=[],a=hn.empty();ua(r,(d,p)=>{const _=Wy(e,d,n);p=Ze(p);const w=i.Nu(_);if(p instanceof up)o.push(_);else{const x=th(p,w);x!=null&&(o.push(_),a.set(_,x))}});const u=new Vn(o);return new lS(a,u,i.fieldTransforms)}function EM(t,e,n,r,i,o){const a=t.Qu(1,e,n),u=[qg(e,r,n)],d=[i];if(o.length%2!=0)throw new oe(Y.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let x=0;x<o.length;x+=2)u.push(qg(e,o[x])),d.push(o[x+1]);const p=[],_=hn.empty();for(let x=u.length-1;x>=0;--x)if(!fS(p,u[x])){const k=u[x];let P=d[x];P=Ze(P);const j=a.Nu(k);if(P instanceof up)p.push(k);else{const B=th(P,j);B!=null&&(p.push(k),_.set(k,B))}}const w=new Vn(p);return new lS(_,w,a.fieldTransforms)}function IM(t,e,n,r=!1){return th(n,t.Qu(r?4:3,e))}function th(t,e){if(dS(t=Ze(t)))return Hy("Unsupported field value:",e,t),hS(t,e);if(t instanceof By)return function(r,i){if(!uS(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const o=[];let a=0;for(const u of r){let d=th(u,i.Lu(a));d==null&&(d={nullValue:"NULL_VALUE"}),o.push(d),a++}return{arrayValue:{values:o}}}(t,e)}return function(r,i){if((r=Ze(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return pD(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const o=Ke.fromDate(r);return{timestampValue:Sl(i.serializer,o)}}if(r instanceof Ke){const o=new Ke(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Sl(i.serializer,o)}}if(r instanceof zy)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Rl)return{bytesValue:dk(i.serializer,r._byteString)};if(r instanceof pn){const o=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(o))throw i.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:yy(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof qy)return function(a,u){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(d=>{if(typeof d!="number")throw u.Bu("VectorValues must only contain numeric values.");return fy(u.serializer,d)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${sp(r)}`)}(t,e)}function hS(t,e){const n={};return jI(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ua(t,(r,i)=>{const o=th(i,e.Mu(r));o!=null&&(n[r]=o)}),{mapValue:{fields:n}}}function dS(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ke||t instanceof zy||t instanceof Rl||t instanceof pn||t instanceof By||t instanceof qy)}function Hy(t,e,n){if(!dS(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=sp(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function qg(t,e,n){if((e=Ze(e))instanceof ap)return e._internalPath;if(typeof e=="string")return Wy(t,e);throw vf("Field path arguments must be of type string or ",t,!1,void 0,n)}const kM=new RegExp("[~\\*/\\[\\]]");function Wy(t,e,n){if(e.search(kM)>=0)throw vf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new ap(...e.split("."))._internalPath}catch{throw vf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function vf(t,e,n,r,i){const o=r&&!r.isEmpty(),a=i!==void 0;let u=`Function ${e}() called with invalid data`;n&&(u+=" (via `toFirestore()`)"),u+=". ";let d="";return(o||a)&&(d+=" (found",o&&(d+=` in field ${r}`),a&&(d+=` in document ${i}`),d+=")"),new oe(Y.INVALID_ARGUMENT,u+t+d)}function fS(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pS{constructor(e,n,r,i,o){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new pn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new SM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(cp("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class SM extends pS{data(){return super.data()}}function cp(t,e){return typeof e=="string"?Wy(t,e):e instanceof ap?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mS(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new oe(Y.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Gy{}class gS extends Gy{}function _S(t,e,...n){let r=[];e instanceof Gy&&r.push(e),r=r.concat(n),function(o){const a=o.filter(d=>d instanceof Ky).length,u=o.filter(d=>d instanceof hp).length;if(a>1||a>0&&u>0)throw new oe(Y.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class hp extends gS{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new hp(e,n,r)}_apply(e){const n=this._parse(e);return yS(e._query,n),new lo(e.firestore,e.converter,Ag(e._query,n))}_parse(e){const n=lp(e.firestore);return function(o,a,u,d,p,_,w){let x;if(p.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new oe(Y.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){Ox(w,_);const k=[];for(const P of w)k.push(Mx(d,o,P));x={arrayValue:{values:k}}}else x=Mx(d,o,w)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||Ox(w,_),x=IM(u,a,w,_==="in"||_==="not-in");return qe.create(p,_,x)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function PM(t,e,n){const r=e,i=cp("where",t);return hp._create(i,r,n)}class Ky extends Gy{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Ky(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Xe.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,o){let a=i;const u=o.getFlattenedFilters();for(const d of u)yS(a,d),a=Ag(a,d)}(e._query,n),new lo(e.firestore,e.converter,Ag(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Zy extends gS{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Zy(e,n)}_apply(e){const n=function(i,o,a){if(i.startAt!==null)throw new oe(Y.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new oe(Y.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Pc(o,a)}(e._query,this._field,this._direction);return new lo(e.firestore,e.converter,function(i,o){const a=i.explicitOrderBy.concat([o]);return new Vl(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}function AM(t,e="asc"){const n=e,r=cp("orderBy",t);return Zy._create(r,n)}function Mx(t,e,n){if(typeof(n=Ze(n))=="string"){if(n==="")throw new oe(Y.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!KI(e)&&n.indexOf("/")!==-1)throw new oe(Y.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Qe.fromString(n));if(!le.isDocumentKey(r))throw new oe(Y.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return kc(t,new le(r))}if(n instanceof pn)return kc(t,n._key);throw new oe(Y.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${sp(n)}.`)}function Ox(t,e){if(!Array.isArray(t)||t.length===0)throw new oe(Y.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function yS(t,e){const n=function(i,o){for(const a of i)for(const u of a.getFlattenedFilters())if(o.indexOf(u.op)>=0)return u.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new oe(Y.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new oe(Y.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class CM{convertValue(e,n="none"){switch(Qo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return gt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ys(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw de()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return ua(e,(i,o)=>{r[i]=this.convertValue(o,n)}),r}convertVectorValue(e){var n,r,i;const o=(i=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(a=>gt(a.doubleValue));return new qy(o)}convertGeoPoint(e){return new zy(gt(e.latitude),gt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=cy(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Ec(e));default:return null}}convertTimestamp(e){const n=Hi(e);return new Ke(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Qe.fromString(e);ge(bk(r));const i=new Zo(r.get(1),r.get(3)),o=new le(r.popFirst(5));return i.isEqual(n)||Mt(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vS(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ju{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class wS extends pS{constructor(e,n,r,i,o,a){super(e,n,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Td(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(cp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Td extends wS{data(e={}){return super.data(e)}}class xS{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new ju(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Td(this._firestore,this._userDataWriter,r.key,r,new ju(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new oe(Y.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(u=>{const d=new Td(i._firestore,i._userDataWriter,u.doc.key,u.doc,new ju(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:d,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>o||u.type!==3).map(u=>{const d=new Td(i._firestore,i._userDataWriter,u.doc.key,u.doc,new ju(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);let p=-1,_=-1;return u.type!==0&&(p=a.indexOf(u.doc.key),a=a.delete(u.doc.key)),u.type!==1&&(a=a.add(u.doc),_=a.indexOf(u.doc.key)),{type:NM(u.type),doc:d,oldIndex:p,newIndex:_}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function NM(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return de()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nl(t){t=Jn(t,pn);const e=Jn(t.firestore,Wi);return mM(op(e),t._key).then(n=>IS(e,t,n))}class Qy extends CM{constructor(e){super(),this.firestore=e}convertBytes(e){return new Rl(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new pn(this.firestore,null,n)}}function bu(t){t=Jn(t,lo);const e=Jn(t.firestore,Wi),n=op(e),r=new Qy(e);return mS(t._query),gM(n,t._query).then(i=>new xS(e,r,t,i))}function Ks(t,e,n){t=Jn(t,pn);const r=Jn(t.firestore,Wi),i=vS(t.converter,e,n);return dp(r,[cS(lp(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,dn.none())])}function bS(t,e,n,...r){t=Jn(t,pn);const i=Jn(t.firestore,Wi),o=lp(i);let a;return a=typeof(e=Ze(e))=="string"||e instanceof ap?EM(o,"updateDoc",t._key,e,n,r):TM(o,"updateDoc",t._key,e),dp(i,[a.toMutation(t._key,dn.exists(!0))])}function TS(t){return dp(Jn(t.firestore,Wi),[new Yf(t._key,dn.none())])}function ES(t,e){const n=Jn(t.firestore,Wi),r=Jt(t),i=vS(t.converter,e);return dp(n,[cS(lp(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,dn.exists(!1))]).then(()=>r)}function Lc(t,...e){var n,r,i;t=Ze(t);let o={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||jx(e[a])||(o=e[a],a++);const u={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(jx(e[a])){const w=e[a];e[a]=(n=w.next)===null||n===void 0?void 0:n.bind(w),e[a+1]=(r=w.error)===null||r===void 0?void 0:r.bind(w),e[a+2]=(i=w.complete)===null||i===void 0?void 0:i.bind(w)}let d,p,_;if(t instanceof pn)p=Jn(t.firestore,Wi),_=Qc(t._key.path),d={next:w=>{e[a]&&e[a](IS(p,t,w))},error:e[a+1],complete:e[a+2]};else{const w=Jn(t,lo);p=Jn(w.firestore,Wi),_=w._query;const x=new Qy(p);d={next:k=>{e[a]&&e[a](new xS(p,x,w,k))},error:e[a+1],complete:e[a+2]},mS(t._query)}return function(x,k,P,j){const B=new Fy(j),R=new Ly(k,B,P);return x.asyncQueue.enqueueAndForget(async()=>Cy(await yf(x),R)),()=>{B.Za(),x.asyncQueue.enqueueAndForget(async()=>Ny(await yf(x),R))}}(op(p),_,u,d)}function dp(t,e){return function(r,i){const o=new ri;return r.asyncQueue.enqueueAndForget(async()=>Yj(await pM(r),i,o)),o.promise}(op(t),e)}function IS(t,e,n){const r=n.docs.get(e._key),i=new Qy(t);return new wS(t,i,e._key,r,new ju(n.hasPendingWrites,n.fromCache),e.converter)}class RM{constructor(e){let n;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),n=e.tabManager):(n=MM(),n._initialize(e)),this._onlineComponentProvider=n._onlineComponentProvider,this._offlineComponentProvider=n._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function LM(t){return new RM(t)}class DM{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Rc.provider,this._offlineComponentProvider={build:n=>new iS(n,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class jM{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Rc.provider,this._offlineComponentProvider={build:n=>new hM(n,e==null?void 0:e.cacheSizeBytes)}}}function MM(t){return new DM(void 0)}function OM(){return new jM}(function(e,n=!0){(function(i){Ol=i})(la),_r(new er("firestore",(r,{instanceIdentifier:i,options:o})=>{const a=r.getProvider("app").getImmediate(),u=new Wi(new wL(r.getProvider("auth-internal")),new EL(r.getProvider("app-check-internal")),function(p,_){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new oe(Y.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Zo(p.options.projectId,_)}(a,i),a);return o=Object.assign({useFetchStreams:n},o),u._setSettings(o),u},"PUBLIC").setMultipleInstances(!0)),fn(Aw,"4.7.3",e),fn(Aw,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VM="type.googleapis.com/google.protobuf.Int64Value",FM="type.googleapis.com/google.protobuf.UInt64Value";function kS(t,e){const n={};for(const r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}function $g(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>$g(e));if(typeof t=="function"||typeof t=="object")return kS(t,e=>$g(e));throw new Error("Data cannot be encoded in JSON: "+t)}function wf(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case VM:case FM:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>wf(e)):typeof t=="function"||typeof t=="object"?kS(t,e=>wf(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yy="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vx={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class fl extends vr{constructor(e,n,r){super(`${Yy}/${e}`,n||""),this.details=r}}function UM(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function BM(t,e){let n=UM(t),r=n,i;try{const o=e&&e.error;if(o){const a=o.status;if(typeof a=="string"){if(!Vx[a])return new fl("internal","internal");n=Vx[a],r=a}const u=o.message;typeof u=="string"&&(r=u),i=o.details,i!==void 0&&(i=wf(i))}}catch{}return n==="ok"?null:new fl(n,r,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zM{constructor(e,n,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(i=>this.auth=i,()=>{}),this.messaging||n.get().then(i=>this.messaging=i,()=>{}),this.appCheck||r.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),i=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:i}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hg="us-central1";function qM(t){let e=null;return{promise:new Promise((n,r)=>{e=setTimeout(()=>{r(new fl("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class $M{constructor(e,n,r,i,o=Hg,a){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new zM(n,r,i),this.cancelAllRequests=new Promise(u=>{this.deleteService=()=>Promise.resolve(u())});try{const u=new URL(o);this.customDomain=u.origin+(u.pathname==="/"?"":u.pathname),this.region=Hg}catch{this.customDomain=null,this.region=o}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function HM(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}function WM(t,e,n){return r=>KM(t,e,r,{})}async function GM(t,e,n,r){n["Content-Type"]="application/json";let i;try{i=await r(t,{method:"POST",body:JSON.stringify(e),headers:n})}catch{return{status:0,json:null}}let o=null;try{o=await i.json()}catch{}return{status:i.status,json:o}}function KM(t,e,n,r){const i=t._url(e);return ZM(t,i,n,r)}async function ZM(t,e,n,r){n=$g(n);const i={data:n},o={},a=await t.contextProvider.getContext(r.limitedUseAppCheckTokens);a.authToken&&(o.Authorization="Bearer "+a.authToken),a.messagingToken&&(o["Firebase-Instance-ID-Token"]=a.messagingToken),a.appCheckToken!==null&&(o["X-Firebase-AppCheck"]=a.appCheckToken);const u=r.timeout||7e4,d=qM(u),p=await Promise.race([GM(e,i,o,t.fetchImpl),d.promise,t.cancelAllRequests]);if(d.cancel(),!p)throw new fl("cancelled","Firebase Functions instance was deleted.");const _=BM(p.status,p.json);if(_)throw _;if(!p.json)throw new fl("internal","Response is not valid JSON object.");let w=p.json.data;if(typeof w>"u"&&(w=p.json.result),typeof w>"u")throw new fl("internal","Response is missing data field.");return{data:wf(w)}}const Fx="@firebase/functions",Ux="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QM="auth-internal",YM="app-check-internal",JM="messaging-internal";function XM(t,e){const n=(r,{instanceIdentifier:i})=>{const o=r.getProvider("app").getImmediate(),a=r.getProvider(QM),u=r.getProvider(JM),d=r.getProvider(YM);return new $M(o,a,u,d,i,t)};_r(new er(Yy,n,"PUBLIC").setMultipleInstances(!0)),fn(Fx,Ux,e),fn(Fx,Ux,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ar(t=Bf(),e=Hg){const r=ro(Ze(t),Yy).getImmediate({identifier:e}),i=EE("functions");return i&&eO(r,...i),r}function eO(t,e,n){HM(Ze(t),e,n)}function Cr(t,e,n){return WM(Ze(t),e)}XM(fetch.bind(self));var tO="firebase",nO="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */fn(tO,nO,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SS="firebasestorage.googleapis.com",PS="storageBucket",rO=2*60*1e3,iO=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nt extends vr{constructor(e,n,r=0){super(fm(e),`Firebase Storage: ${n} (${fm(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Nt.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return fm(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ct;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ct||(Ct={}));function fm(t){return"storage/"+t}function Jy(){const t="An unknown error occurred, please check the error payload for server response.";return new Nt(Ct.UNKNOWN,t)}function sO(t){return new Nt(Ct.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function oO(t){return new Nt(Ct.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function aO(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Nt(Ct.UNAUTHENTICATED,t)}function lO(){return new Nt(Ct.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function uO(t){return new Nt(Ct.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function cO(){return new Nt(Ct.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function hO(){return new Nt(Ct.CANCELED,"User canceled the upload/download.")}function dO(t){return new Nt(Ct.INVALID_URL,"Invalid URL '"+t+"'.")}function fO(t){return new Nt(Ct.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function pO(){return new Nt(Ct.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+PS+"' property when initializing the app?")}function mO(){return new Nt(Ct.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function gO(){return new Nt(Ct.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function _O(t){return new Nt(Ct.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Wg(t){return new Nt(Ct.INVALID_ARGUMENT,t)}function AS(){return new Nt(Ct.APP_DELETED,"The Firebase app was deleted.")}function yO(t){return new Nt(Ct.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Ju(t,e){return new Nt(Ct.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function Tu(t){throw new Nt(Ct.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Zn.makeFromUrl(e,n)}catch{return new Zn(e,"")}if(r.path==="")return r;throw fO(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)";function o(z){z.path.charAt(z.path.length-1)==="/"&&(z.path_=z.path_.slice(0,-1))}const a="(/(.*))?$",u=new RegExp("^gs://"+i+a,"i"),d={bucket:1,path:3};function p(z){z.path_=decodeURIComponent(z.path)}const _="v[A-Za-z0-9_]+",w=n.replace(/[.]/g,"\\."),x="(/([^?#]*).*)?$",k=new RegExp(`^https?://${w}/${_}/b/${i}/o${x}`,"i"),P={bucket:1,path:3},j=n===SS?"(?:storage.googleapis.com|storage.cloud.google.com)":n,B="([^?#]*)",R=new RegExp(`^https?://${j}/${i}/${B}`,"i"),N=[{regex:u,indices:d,postModify:o},{regex:k,indices:P,postModify:p},{regex:R,indices:{bucket:1,path:2},postModify:p}];for(let z=0;z<N.length;z++){const G=N[z],F=G.regex.exec(e);if(F){const I=F[G.indices.bucket];let T=F[G.indices.path];T||(T=""),r=new Zn(I,T),G.postModify(r);break}}if(r==null)throw dO(e);return r}}class vO{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wO(t,e,n){let r=1,i=null,o=null,a=!1,u=0;function d(){return u===2}let p=!1;function _(...B){p||(p=!0,e.apply(null,B))}function w(B){i=setTimeout(()=>{i=null,t(k,d())},B)}function x(){o&&clearTimeout(o)}function k(B,...R){if(p){x();return}if(B){x(),_.call(null,B,...R);return}if(d()||a){x(),_.call(null,B,...R);return}r<64&&(r*=2);let N;u===1?(u=2,N=0):N=(r+Math.random())*1e3,w(N)}let P=!1;function j(B){P||(P=!0,x(),!p&&(i!==null?(B||(u=2),clearTimeout(i),w(0)):B||(u=1)))}return w(0),o=setTimeout(()=>{a=!0,j(!0)},n),j}function xO(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bO(t){return t!==void 0}function TO(t){return typeof t=="object"&&!Array.isArray(t)}function Xy(t){return typeof t=="string"||t instanceof String}function Bx(t){return ev()&&t instanceof Blob}function ev(){return typeof Blob<"u"}function zx(t,e,n,r){if(r<e)throw Wg(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw Wg(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fp(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function CS(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var Uo;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Uo||(Uo={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EO(t,e){const n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,o=e.indexOf(t)!==-1;return n||i||o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IO{constructor(e,n,r,i,o,a,u,d,p,_,w,x=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=o,this.additionalRetryCodes_=a,this.callback_=u,this.errorCallback_=d,this.timeout_=p,this.progressCallback_=_,this.connectionFactory_=w,this.retry=x,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((k,P)=>{this.resolve_=k,this.reject_=P,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new Gh(!1,null,!0));return}const o=this.connectionFactory_();this.pendingConnection_=o;const a=u=>{const d=u.loaded,p=u.lengthComputable?u.total:-1;this.progressCallback_!==null&&this.progressCallback_(d,p)};this.progressCallback_!==null&&o.addUploadProgressListener(a),o.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&o.removeUploadProgressListener(a),this.pendingConnection_=null;const u=o.getErrorCode()===Uo.NO_ERROR,d=o.getStatus();if(!u||EO(d,this.additionalRetryCodes_)&&this.retry){const _=o.getErrorCode()===Uo.ABORT;r(!1,new Gh(!1,null,_));return}const p=this.successCodes_.indexOf(d)!==-1;r(!0,new Gh(p,o))})},n=(r,i)=>{const o=this.resolve_,a=this.reject_,u=i.connection;if(i.wasSuccessCode)try{const d=this.callback_(u,u.getResponse());bO(d)?o(d):o()}catch(d){a(d)}else if(u!==null){const d=Jy();d.serverResponse=u.getErrorText(),this.errorCallback_?a(this.errorCallback_(u,d)):a(d)}else if(i.canceled){const d=this.appDelete_?AS():hO();a(d)}else{const d=cO();a(d)}};this.canceled_?n(!1,new Gh(!1,null,!0)):this.backoffId_=wO(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&xO(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Gh{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function kO(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function SO(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function PO(t,e){e&&(t["X-Firebase-GMPID"]=e)}function AO(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function CO(t,e,n,r,i,o,a=!0){const u=CS(t.urlParams),d=t.url+u,p=Object.assign({},t.headers);return PO(p,e),kO(p,n),SO(p,o),AO(p,r),new IO(d,t.method,p,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NO(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function RO(...t){const e=NO();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(ev())return new Blob(t);throw new Nt(Ct.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function LO(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DO(t){if(typeof atob>"u")throw _O("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class pm{constructor(e,n){this.data=e,this.contentType=n||null}}function jO(t,e){switch(t){case Xr.RAW:return new pm(NS(e));case Xr.BASE64:case Xr.BASE64URL:return new pm(RS(t,e));case Xr.DATA_URL:return new pm(OO(e),VO(e))}throw Jy()}function NS(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const o=r,a=t.charCodeAt(++n);r=65536|(o&1023)<<10|a&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function MO(t){let e;try{e=decodeURIComponent(t)}catch{throw Ju(Xr.DATA_URL,"Malformed data URL.")}return NS(e)}function RS(t,e){switch(t){case Xr.BASE64:{const i=e.indexOf("-")!==-1,o=e.indexOf("_")!==-1;if(i||o)throw Ju(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case Xr.BASE64URL:{const i=e.indexOf("+")!==-1,o=e.indexOf("/")!==-1;if(i||o)throw Ju(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=DO(e)}catch(i){throw i.message.includes("polyfill")?i:Ju(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}class LS{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Ju(Xr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=FO(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function OO(t){const e=new LS(t);return e.base64?RS(Xr.BASE64,e.rest):MO(e.rest)}function VO(t){return new LS(t).contentType}function FO(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ns{constructor(e,n){let r=0,i="";Bx(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,n){if(Bx(this.data_)){const r=this.data_,i=LO(r,e,n);return i===null?null:new Ns(i)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Ns(r,!0)}}static getBlob(...e){if(ev()){const n=e.map(r=>r instanceof Ns?r.data_:r);return new Ns(RO.apply(null,n))}else{const n=e.map(a=>Xy(a)?jO(Xr.RAW,a).data:a.data_);let r=0;n.forEach(a=>{r+=a.byteLength});const i=new Uint8Array(r);let o=0;return n.forEach(a=>{for(let u=0;u<a.length;u++)i[o++]=a[u]}),new Ns(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DS(t){let e;try{e=JSON.parse(t)}catch{return null}return TO(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UO(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function BO(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function jS(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zO(t,e){return e}class xn{constructor(e,n,r,i){this.server=e,this.local=n||e,this.writable=!!r,this.xform=i||zO}}let Kh=null;function qO(t){return!Xy(t)||t.length<2?t:jS(t)}function MS(){if(Kh)return Kh;const t=[];t.push(new xn("bucket")),t.push(new xn("generation")),t.push(new xn("metageneration")),t.push(new xn("name","fullPath",!0));function e(o,a){return qO(a)}const n=new xn("name");n.xform=e,t.push(n);function r(o,a){return a!==void 0?Number(a):a}const i=new xn("size");return i.xform=r,t.push(i),t.push(new xn("timeCreated")),t.push(new xn("updated")),t.push(new xn("md5Hash",null,!0)),t.push(new xn("cacheControl",null,!0)),t.push(new xn("contentDisposition",null,!0)),t.push(new xn("contentEncoding",null,!0)),t.push(new xn("contentLanguage",null,!0)),t.push(new xn("contentType",null,!0)),t.push(new xn("metadata","customMetadata",!0)),Kh=t,Kh}function $O(t,e){function n(){const r=t.bucket,i=t.fullPath,o=new Zn(r,i);return e._makeStorageReference(o)}Object.defineProperty(t,"ref",{get:n})}function HO(t,e,n){const r={};r.type="file";const i=n.length;for(let o=0;o<i;o++){const a=n[o];r[a.local]=a.xform(r,e[a.server])}return $O(r,t),r}function OS(t,e,n){const r=DS(e);return r===null?null:HO(t,r,n)}function WO(t,e,n,r){const i=DS(e);if(i===null||!Xy(i.downloadTokens))return null;const o=i.downloadTokens;if(o.length===0)return null;const a=encodeURIComponent;return o.split(",").map(p=>{const _=t.bucket,w=t.fullPath,x="/b/"+a(_)+"/o/"+a(w),k=fp(x,n,r),P=CS({alt:"media",token:p});return k+P})[0]}function GO(t,e){const n={},r=e.length;for(let i=0;i<r;i++){const o=e[i];o.writable&&(n[o.server]=t[o.local])}return JSON.stringify(n)}class tv{constructor(e,n,r,i){this.url=e,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VS(t){if(!t)throw Jy()}function KO(t,e){function n(r,i){const o=OS(t,i,e);return VS(o!==null),o}return n}function ZO(t,e){function n(r,i){const o=OS(t,i,e);return VS(o!==null),WO(o,i,t.host,t._protocol)}return n}function FS(t){function e(n,r){let i;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?i=lO():i=aO():n.getStatus()===402?i=oO(t.bucket):n.getStatus()===403?i=uO(t.path):i=r,i.status=n.getStatus(),i.serverResponse=r.serverResponse,i}return e}function US(t){const e=FS(t);function n(r,i){let o=e(r,i);return r.getStatus()===404&&(o=sO(t.path)),o.serverResponse=i.serverResponse,o}return n}function QO(t,e,n){const r=e.fullServerUrl(),i=fp(r,t.host,t._protocol),o="GET",a=t.maxOperationRetryTime,u=new tv(i,o,ZO(t,n),a);return u.errorHandler=US(e),u}function YO(t,e){const n=e.fullServerUrl(),r=fp(n,t.host,t._protocol),i="DELETE",o=t.maxOperationRetryTime;function a(d,p){}const u=new tv(r,i,a,o);return u.successCodes=[200,204],u.errorHandler=US(e),u}function JO(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function XO(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=JO(null,e)),r}function eV(t,e,n,r,i){const o=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};function u(){let N="";for(let z=0;z<2;z++)N=N+Math.random().toString().slice(2);return N}const d=u();a["Content-Type"]="multipart/related; boundary="+d;const p=XO(e,r,i),_=GO(p,n),w="--"+d+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+_+`\r
--`+d+`\r
Content-Type: `+p.contentType+`\r
\r
`,x=`\r
--`+d+"--",k=Ns.getBlob(w,r,x);if(k===null)throw mO();const P={name:p.fullPath},j=fp(o,t.host,t._protocol),B="POST",R=t.maxUploadRetryTime,S=new tv(j,B,KO(t,n),R);return S.urlParams=P,S.headers=a,S.body=k.uploadData(),S.errorHandler=FS(e),S}class tV{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Uo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Uo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Uo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,i){if(this.sent_)throw Tu("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Tu("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Tu("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Tu("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Tu("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class nV extends tV{initXhr(){this.xhr_.responseType="text"}}function nv(){return new nV}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ta{constructor(e,n){this._service=e,n instanceof Zn?this._location=n:this._location=Zn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new ta(e,n)}get root(){const e=new Zn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return jS(this._location.path)}get storage(){return this._service}get parent(){const e=UO(this._location.path);if(e===null)return null;const n=new Zn(this._location.bucket,e);return new ta(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw yO(e)}}function rV(t,e,n){t._throwIfRoot("uploadBytes");const r=eV(t.storage,t._location,MS(),new Ns(e,!0),n);return t.storage.makeRequestWithTokens(r,nv).then(i=>({metadata:i,ref:t}))}function iV(t){t._throwIfRoot("getDownloadURL");const e=QO(t.storage,t._location,MS());return t.storage.makeRequestWithTokens(e,nv).then(n=>{if(n===null)throw gO();return n})}function sV(t){t._throwIfRoot("deleteObject");const e=YO(t.storage,t._location);return t.storage.makeRequestWithTokens(e,nv)}function oV(t,e){const n=BO(t._location.path,e),r=new Zn(t._location.bucket,n);return new ta(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aV(t){return/^[A-Za-z]+:\/\//.test(t)}function lV(t,e){return new ta(t,e)}function BS(t,e){if(t instanceof rv){const n=t;if(n._bucket==null)throw pO();const r=new ta(n,n._bucket);return e!=null?BS(r,e):r}else return e!==void 0?oV(t,e):t}function uV(t,e){if(e&&aV(e)){if(t instanceof rv)return lV(t,e);throw Wg("To use ref(service, url), the first argument must be a Storage instance.")}else return BS(t,e)}function qx(t,e){const n=e==null?void 0:e[PS];return n==null?null:Zn.makeFromBucketSpec(n,t)}function cV(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:jC(i,t.app.options.projectId))}class rv{constructor(e,n,r,i,o){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=o,this._bucket=null,this._host=SS,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=rO,this._maxUploadRetryTime=iO,this._requests=new Set,i!=null?this._bucket=Zn.makeFromBucketSpec(i,this._host):this._bucket=qx(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Zn.makeFromBucketSpec(this._url,e):this._bucket=qx(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){zx("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){zx("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ta(this,e)}_makeRequest(e,n,r,i,o=!0){if(this._deleted)return new vO(AS());{const a=CO(e,this._appId,r,i,n,this._firebaseVersion,o);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,n){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()}}const $x="@firebase/storage",Hx="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zS="storage";function iv(t,e,n){return t=Ze(t),rV(t,e,n)}function sv(t){return t=Ze(t),iV(t)}function qS(t){return t=Ze(t),sV(t)}function Dc(t,e){return t=Ze(t),uV(t,e)}function hV(t=Bf(),e){t=Ze(t);const r=ro(t,zS).getImmediate({identifier:e}),i=EE("storage");return i&&dV(r,...i),r}function dV(t,e,n,r={}){cV(t,e,n,r)}function fV(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new rv(n,r,i,e,la)}function pV(){_r(new er(zS,fV,"PUBLIC").setMultipleInstances(!0)),fn($x,Hx,""),fn($x,Hx,"esm2017")}pV();const $S="@firebase/installations",ov="0.6.9";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HS=1e4,WS=`w:${ov}`,GS="FIS_v2",mV="https://firebaseinstallations.googleapis.com/v1",gV=60*60*1e3,_V="installations",yV="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vV={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},na=new aa(_V,yV,vV);function KS(t){return t instanceof vr&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZS({projectId:t}){return`${mV}/projects/${t}/installations`}function QS(t){return{token:t.token,requestStatus:2,expiresIn:xV(t.expiresIn),creationTime:Date.now()}}async function YS(t,e){const r=(await e.json()).error;return na.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function JS({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function wV(t,{refreshToken:e}){const n=JS(t);return n.append("Authorization",bV(e)),n}async function XS(t){const e=await t();return e.status>=500&&e.status<600?t():e}function xV(t){return Number(t.replace("s","000"))}function bV(t){return`${GS} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TV({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=ZS(t),i=JS(t),o=e.getImmediate({optional:!0});if(o){const p=await o.getHeartbeatsHeader();p&&i.append("x-firebase-client",p)}const a={fid:n,authVersion:GS,appId:t.appId,sdkVersion:WS},u={method:"POST",headers:i,body:JSON.stringify(a)},d=await XS(()=>fetch(r,u));if(d.ok){const p=await d.json();return{fid:p.fid||n,registrationStatus:2,refreshToken:p.refreshToken,authToken:QS(p.authToken)}}else throw await YS("Create Installation",d)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eP(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EV(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IV=/^[cdef][\w-]{21}$/,Gg="";function kV(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=SV(t);return IV.test(n)?n:Gg}catch{return Gg}}function SV(t){return EV(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pp(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tP=new Map;function nP(t,e){const n=pp(t);rP(n,e),PV(n,e)}function rP(t,e){const n=tP.get(t);if(n)for(const r of n)r(e)}function PV(t,e){const n=AV();n&&n.postMessage({key:t,fid:e}),CV()}let jo=null;function AV(){return!jo&&"BroadcastChannel"in self&&(jo=new BroadcastChannel("[Firebase] FID Change"),jo.onmessage=t=>{rP(t.data.key,t.data.fid)}),jo}function CV(){tP.size===0&&jo&&(jo.close(),jo=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NV="firebase-installations-database",RV=1,ra="firebase-installations-store";let mm=null;function av(){return mm||(mm=Uf(NV,RV,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(ra)}}})),mm}async function xf(t,e){const n=pp(t),i=(await av()).transaction(ra,"readwrite"),o=i.objectStore(ra),a=await o.get(n);return await o.put(e,n),await i.done,(!a||a.fid!==e.fid)&&nP(t,e.fid),e}async function iP(t){const e=pp(t),r=(await av()).transaction(ra,"readwrite");await r.objectStore(ra).delete(e),await r.done}async function mp(t,e){const n=pp(t),i=(await av()).transaction(ra,"readwrite"),o=i.objectStore(ra),a=await o.get(n),u=e(a);return u===void 0?await o.delete(n):await o.put(u,n),await i.done,u&&(!a||a.fid!==u.fid)&&nP(t,u.fid),u}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lv(t){let e;const n=await mp(t.appConfig,r=>{const i=LV(r),o=DV(t,i);return e=o.registrationPromise,o.installationEntry});return n.fid===Gg?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function LV(t){const e=t||{fid:kV(),registrationStatus:0};return sP(e)}function DV(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(na.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=jV(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:MV(t)}:{installationEntry:e}}async function jV(t,e){try{const n=await TV(t,e);return xf(t.appConfig,n)}catch(n){throw KS(n)&&n.customData.serverCode===409?await iP(t.appConfig):await xf(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function MV(t){let e=await Wx(t.appConfig);for(;e.registrationStatus===1;)await eP(100),e=await Wx(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await lv(t);return r||n}return e}function Wx(t){return mp(t,e=>{if(!e)throw na.create("installation-not-found");return sP(e)})}function sP(t){return OV(t)?{fid:t.fid,registrationStatus:0}:t}function OV(t){return t.registrationStatus===1&&t.registrationTime+HS<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VV({appConfig:t,heartbeatServiceProvider:e},n){const r=FV(t,n),i=wV(t,n),o=e.getImmediate({optional:!0});if(o){const p=await o.getHeartbeatsHeader();p&&i.append("x-firebase-client",p)}const a={installation:{sdkVersion:WS,appId:t.appId}},u={method:"POST",headers:i,body:JSON.stringify(a)},d=await XS(()=>fetch(r,u));if(d.ok){const p=await d.json();return QS(p)}else throw await YS("Generate Auth Token",d)}function FV(t,{fid:e}){return`${ZS(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uv(t,e=!1){let n;const r=await mp(t.appConfig,o=>{if(!oP(o))throw na.create("not-registered");const a=o.authToken;if(!e&&zV(a))return o;if(a.requestStatus===1)return n=UV(t,e),o;{if(!navigator.onLine)throw na.create("app-offline");const u=$V(o);return n=BV(t,u),u}});return n?await n:r.authToken}async function UV(t,e){let n=await Gx(t.appConfig);for(;n.authToken.requestStatus===1;)await eP(100),n=await Gx(t.appConfig);const r=n.authToken;return r.requestStatus===0?uv(t,e):r}function Gx(t){return mp(t,e=>{if(!oP(e))throw na.create("not-registered");const n=e.authToken;return HV(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function BV(t,e){try{const n=await VV(t,e),r=Object.assign(Object.assign({},e),{authToken:n});return await xf(t.appConfig,r),n}catch(n){if(KS(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await iP(t.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await xf(t.appConfig,r)}throw n}}function oP(t){return t!==void 0&&t.registrationStatus===2}function zV(t){return t.requestStatus===2&&!qV(t)}function qV(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+gV}function $V(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function HV(t){return t.requestStatus===1&&t.requestTime+HS<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WV(t){const e=t,{installationEntry:n,registrationPromise:r}=await lv(e);return r?r.catch(console.error):uv(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GV(t,e=!1){const n=t;return await KV(n),(await uv(n,e)).token}async function KV(t){const{registrationPromise:e}=await lv(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZV(t){if(!t||!t.options)throw gm("App Configuration");if(!t.name)throw gm("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw gm(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function gm(t){return na.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aP="installations",QV="installations-internal",YV=t=>{const e=t.getProvider("app").getImmediate(),n=ZV(e),r=ro(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},JV=t=>{const e=t.getProvider("app").getImmediate(),n=ro(e,aP).getImmediate();return{getId:()=>WV(n),getToken:i=>GV(n,i)}};function XV(){_r(new er(aP,YV,"PUBLIC")),_r(new er(QV,JV,"PRIVATE"))}XV();fn($S,ov);fn($S,ov,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e4="/firebase-messaging-sw.js",t4="/firebase-cloud-messaging-push-scope",lP="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",n4="https://fcmregistrations.googleapis.com/v1",uP="google.c.a.c_id",r4="google.c.a.c_l",i4="google.c.a.ts",s4="google.c.a.e";var Kx;(function(t){t[t.DATA_MESSAGE=1]="DATA_MESSAGE",t[t.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(Kx||(Kx={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var jc;(function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"})(jc||(jc={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ki(t){const e=new Uint8Array(t);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function o4(t){const e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(n),i=new Uint8Array(r.length);for(let o=0;o<r.length;++o)i[o]=r.charCodeAt(o);return i}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _m="fcm_token_details_db",a4=5,Zx="fcm_token_object_Store";async function l4(t){if("databases"in indexedDB&&!(await indexedDB.databases()).map(o=>o.name).includes(_m))return null;let e=null;return(await Uf(_m,a4,{upgrade:async(r,i,o,a)=>{var u;if(i<2||!r.objectStoreNames.contains(Zx))return;const d=a.objectStore(Zx),p=await d.index("fcmSenderId").get(t);if(await d.clear(),!!p){if(i===2){const _=p;if(!_.auth||!_.p256dh||!_.endpoint)return;e={token:_.fcmToken,createTime:(u=_.createTime)!==null&&u!==void 0?u:Date.now(),subscriptionOptions:{auth:_.auth,p256dh:_.p256dh,endpoint:_.endpoint,swScope:_.swScope,vapidKey:typeof _.vapidKey=="string"?_.vapidKey:ki(_.vapidKey)}}}else if(i===3){const _=p;e={token:_.fcmToken,createTime:_.createTime,subscriptionOptions:{auth:ki(_.auth),p256dh:ki(_.p256dh),endpoint:_.endpoint,swScope:_.swScope,vapidKey:ki(_.vapidKey)}}}else if(i===4){const _=p;e={token:_.fcmToken,createTime:_.createTime,subscriptionOptions:{auth:ki(_.auth),p256dh:ki(_.p256dh),endpoint:_.endpoint,swScope:_.swScope,vapidKey:ki(_.vapidKey)}}}}}})).close(),await nm(_m),await nm("fcm_vapid_details_db"),await nm("undefined"),u4(e)?e:null}function u4(t){if(!t||!t.subscriptionOptions)return!1;const{subscriptionOptions:e}=t;return typeof t.createTime=="number"&&t.createTime>0&&typeof t.token=="string"&&t.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c4="firebase-messaging-database",h4=1,Mc="firebase-messaging-store";let ym=null;function cP(){return ym||(ym=Uf(c4,h4,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Mc)}}})),ym}async function d4(t){const e=hP(t),r=await(await cP()).transaction(Mc).objectStore(Mc).get(e);if(r)return r;{const i=await l4(t.appConfig.senderId);if(i)return await cv(t,i),i}}async function cv(t,e){const n=hP(t),i=(await cP()).transaction(Mc,"readwrite");return await i.objectStore(Mc).put(e,n),await i.done,e}function hP({appConfig:t}){return t.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f4={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},mn=new aa("messaging","Messaging",f4);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function p4(t,e){const n=await dv(t),r=dP(e),i={method:"POST",headers:n,body:JSON.stringify(r)};let o;try{o=await(await fetch(hv(t.appConfig),i)).json()}catch(a){throw mn.create("token-subscribe-failed",{errorInfo:a==null?void 0:a.toString()})}if(o.error){const a=o.error.message;throw mn.create("token-subscribe-failed",{errorInfo:a})}if(!o.token)throw mn.create("token-subscribe-no-token");return o.token}async function m4(t,e){const n=await dv(t),r=dP(e.subscriptionOptions),i={method:"PATCH",headers:n,body:JSON.stringify(r)};let o;try{o=await(await fetch(`${hv(t.appConfig)}/${e.token}`,i)).json()}catch(a){throw mn.create("token-update-failed",{errorInfo:a==null?void 0:a.toString()})}if(o.error){const a=o.error.message;throw mn.create("token-update-failed",{errorInfo:a})}if(!o.token)throw mn.create("token-update-no-token");return o.token}async function g4(t,e){const r={method:"DELETE",headers:await dv(t)};try{const o=await(await fetch(`${hv(t.appConfig)}/${e}`,r)).json();if(o.error){const a=o.error.message;throw mn.create("token-unsubscribe-failed",{errorInfo:a})}}catch(i){throw mn.create("token-unsubscribe-failed",{errorInfo:i==null?void 0:i.toString()})}}function hv({projectId:t}){return`${n4}/projects/${t}/registrations`}async function dv({appConfig:t,installations:e}){const n=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function dP({p256dh:t,auth:e,endpoint:n,vapidKey:r}){const i={web:{endpoint:n,auth:e,p256dh:t}};return r!==lP&&(i.web.applicationPubKey=r),i}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _4=7*24*60*60*1e3;async function y4(t){const e=await w4(t.swRegistration,t.vapidKey),n={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:e.endpoint,auth:ki(e.getKey("auth")),p256dh:ki(e.getKey("p256dh"))},r=await d4(t.firebaseDependencies);if(r){if(x4(r.subscriptionOptions,n))return Date.now()>=r.createTime+_4?v4(t,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await g4(t.firebaseDependencies,r.token)}catch(i){console.warn(i)}return Qx(t.firebaseDependencies,n)}else return Qx(t.firebaseDependencies,n)}async function v4(t,e){try{const n=await m4(t.firebaseDependencies,e),r=Object.assign(Object.assign({},e),{token:n,createTime:Date.now()});return await cv(t.firebaseDependencies,r),n}catch(n){throw n}}async function Qx(t,e){const r={token:await p4(t,e),createTime:Date.now(),subscriptionOptions:e};return await cv(t,r),r.token}async function w4(t,e){const n=await t.pushManager.getSubscription();return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:o4(e)})}function x4(t,e){const n=e.vapidKey===t.vapidKey,r=e.endpoint===t.endpoint,i=e.auth===t.auth,o=e.p256dh===t.p256dh;return n&&r&&i&&o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yx(t){const e={from:t.from,collapseKey:t.collapse_key,messageId:t.fcmMessageId};return b4(e,t),T4(e,t),E4(e,t),e}function b4(t,e){if(!e.notification)return;t.notification={};const n=e.notification.title;n&&(t.notification.title=n);const r=e.notification.body;r&&(t.notification.body=r);const i=e.notification.image;i&&(t.notification.image=i);const o=e.notification.icon;o&&(t.notification.icon=o)}function T4(t,e){e.data&&(t.data=e.data)}function E4(t,e){var n,r,i,o,a;if(!e.fcmOptions&&!(!((n=e.notification)===null||n===void 0)&&n.click_action))return;t.fcmOptions={};const u=(i=(r=e.fcmOptions)===null||r===void 0?void 0:r.link)!==null&&i!==void 0?i:(o=e.notification)===null||o===void 0?void 0:o.click_action;u&&(t.fcmOptions.link=u);const d=(a=e.fcmOptions)===null||a===void 0?void 0:a.analytics_label;d&&(t.fcmOptions.analyticsLabel=d)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I4(t){return typeof t=="object"&&!!t&&uP in t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k4(t){if(!t||!t.options)throw vm("App Configuration Object");if(!t.name)throw vm("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:n}=t;for(const r of e)if(!n[r])throw vm(r);return{appName:t.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}function vm(t){return mn.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S4{constructor(e,n,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const i=k4(e);this.firebaseDependencies={app:e,appConfig:i,installations:n,analyticsProvider:r}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function P4(t){try{t.swRegistration=await navigator.serviceWorker.register(e4,{scope:t4}),t.swRegistration.update().catch(()=>{})}catch(e){throw mn.create("failed-service-worker-registration",{browserErrorMessage:e==null?void 0:e.message})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function A4(t,e){if(!e&&!t.swRegistration&&await P4(t),!(!e&&t.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw mn.create("invalid-sw-registration");t.swRegistration=e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function C4(t,e){e?t.vapidKey=e:t.vapidKey||(t.vapidKey=lP)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fP(t,e){if(!navigator)throw mn.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw mn.create("permission-blocked");return await C4(t,e==null?void 0:e.vapidKey),await A4(t,e==null?void 0:e.serviceWorkerRegistration),y4(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function N4(t,e,n){const r=R4(e);(await t.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:n[uP],message_name:n[r4],message_time:n[i4],message_device_time:Math.floor(Date.now()/1e3)})}function R4(t){switch(t){case jc.NOTIFICATION_CLICKED:return"notification_open";case jc.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function L4(t,e){const n=e.data;if(!n.isFirebaseMessaging)return;t.onMessageHandler&&n.messageType===jc.PUSH_RECEIVED&&(typeof t.onMessageHandler=="function"?t.onMessageHandler(Yx(n)):t.onMessageHandler.next(Yx(n)));const r=n.data;I4(r)&&r[s4]==="1"&&await N4(t,n.messageType,r)}const Jx="@firebase/messaging",Xx="0.12.12";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D4=t=>{const e=new S4(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),t.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",n=>L4(e,n)),e},j4=t=>{const e=t.getProvider("messaging").getImmediate();return{getToken:r=>fP(e,r)}};function M4(){_r(new er("messaging",D4,"PUBLIC")),_r(new er("messaging-internal",j4,"PRIVATE")),fn(Jx,Xx),fn(Jx,Xx,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pP(){try{await PE()}catch{return!1}return typeof window<"u"&&H_()&&zC()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O4(t,e){if(!navigator)throw mn.create("only-available-in-window");return t.onMessageHandler=e,()=>{t.onMessageHandler=null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V4(t=Bf()){return pP().then(e=>{if(!e)throw mn.create("unsupported-browser")},e=>{throw mn.create("indexed-db-unsupported")}),ro(Ze(t),"messaging").getImmediate()}async function F4(t,e){return t=Ze(t),fP(t,e)}function eb(t,e){return t=Ze(t),O4(t,e)}M4();const U4={apiKey:"AIzaSyCWp0X6bLJBsyYKTjUaVsXBSuVD8KeeEqY",authDomain:"carnival-planner.firebaseapp.com",projectId:"carnival-planner",storageBucket:"carnival-planner.firebasestorage.app",messagingSenderId:"1036340118282",appId:"1:1036340118282:web:809dc12c298ff1b8f2f0f3",measurementId:"G-XC1K69PSVC"},Tn=NE(U4),Ms=gL(Tn),st=yM(Tn,{localCache:LM({tabManager:OM()})},"squad-db"),Oc=hV(Tn);Promise.resolve(!0);console.log("Firestore initialized");let ji=null;const fv=async()=>{try{return await pP()?(ji=V4(Tn),console.log("Firebase Messaging initialized"),ji):(console.log("Firebase Messaging not supported in this browser"),null)}catch(t){return console.log("Error initializing Firebase Messaging:",t),null}},B4=async t=>{try{if(await Notification.requestPermission()!=="granted")return console.log("Notification permission denied"),null;if(ji||await fv(),!ji)return null;const n=await F4(ji,{vapidKey:t});return console.log("FCM Token:",n),n}catch(e){return console.log("Error getting FCM token:",e),null}},z4=t=>{ji?eb(ji,t):fv().then(()=>{ji&&eb(ji,t)})};fv();const Zh="/assets/carnival-logo-CBA9n7vt.png",q4=[{name:"Sugar Mas (St. Kitts)",date:"2026-01-01"},{name:"St. Croix Carnival",date:"2026-01-03"},{name:"Carnaval Ponceno (Puerto Rico)",date:"2026-02-12"},{name:"Aruba Carnival",date:"2026-02-14"},{name:"Barranquilla Carnival (Colombia)",date:"2026-02-14"},{name:"Martinique Carnival",date:"2026-02-15"},{name:"Rio Carnival (Brazil)",date:"2026-02-15"},{name:"Carnaval De Saint-Martin",date:"2026-02-15"},{name:"Mas Domnik (Dominica)",date:"2026-02-16"},{name:"Carriacou & Petite Martinique",date:"2026-02-16"},{name:"Venezuela Carnival",date:"2026-02-16"},{name:"Trinidad Carnival",date:"2026-02-16"},{name:"Guyana Mashramani",date:"2026-02-23"},{name:"Carnaval De San Pedro (Belize)",date:"2026-02-23"},{name:"Cape Town Carnival (South Africa)",date:"2026-03-21"},{name:"Virgin Gorda Easter Festival",date:"2026-04-05"},{name:"Jamaica Carnival",date:"2026-04-12"},{name:"Tampa Bay Carnival (USA)",date:"2026-04-18"},{name:"St. Maarten Carnival",date:"2026-04-30"},{name:"St. Thomas Carnival (USVI)",date:"2026-05-02"},{name:"Cayman Carnival Batabano",date:"2026-05-09"},{name:"Braccanal (Cayman Islands)",date:"2026-05-13"},{name:"Berlin Carnival (Germany)",date:"2026-05-22"},{name:"Atlanta Caribbean Carnival",date:"2026-05-23"},{name:"Aalborg Karneval (Denmark)",date:"2026-05-23"},{name:"Orlando Carnival",date:"2026-05-24"},{name:"Luton International Carnival (UK)",date:"2026-05-24"},{name:"Guyana Independence",date:"2026-05-26"},{name:"Munich Carnival (Germany)",date:"2026-06-04"},{name:"Bahamas Carnival",date:"2026-06-06"},{name:"South Carolina Carnival",date:"2026-06-11"},{name:"Bermuda Carnival",date:"2026-06-15"},{name:"Hollywood Carnival (USA)",date:"2026-06-20"},{name:"Caymas Carnival (Cayman Islands)",date:"2026-06-20"},{name:"Philadelphia Carnival",date:"2026-06-20"},{name:"Vienna Carnival (Austria)",date:"2026-06-26"},{name:"Vincy Mas (St. Vincent)",date:"2026-07-06"},{name:"Saint Lucia Carnival",date:"2026-07-20"},{name:"Anguilla Summer Festival",date:"2026-07-24"},{name:"Zomercarnaval (Rotterdam)",date:"2026-07-25"},{name:"Toronto Caribbean Carnival (Caribana)",date:"2026-08-01"},{name:"Crop Over (Barbados)",date:"2026-08-03"},{name:"Antigua Carnival",date:"2026-08-03"},{name:"Nevis Culturama Festival",date:"2026-08-04"},{name:"Cariwest (Canada)",date:"2026-08-07"},{name:"Spice Mas (Grenada)",date:"2026-08-10"},{name:"Notting Hill Carnival (London)",date:"2026-08-31"},{name:"New York Carnival (Labor Day)",date:"2026-09-07"},{name:"Japan Caribbean Carnival",date:"2026-09-23"},{name:"Miami Carnival",date:"2026-10-11"},{name:"Tobago Carnival",date:"2026-11-01"}];function mP(t,e){const n=W.useRef(e);W.useEffect(function(){e!==n.current&&t.attributionControl!=null&&(n.current!=null&&t.attributionControl.removeAttribution(n.current),e!=null&&t.attributionControl.addAttribution(e)),n.current=e},[t,e])}const $4=1;function H4(t){return Object.freeze({__version:$4,map:t})}function W4(t,e){return Object.freeze({...t,...e})}const gP=W.createContext(null),_P=gP.Provider;function pv(){const t=W.useContext(gP);if(t==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return t}function G4(t){function e(n,r){const{instance:i,context:o}=t(n).current;return W.useImperativeHandle(r,()=>i),n.children==null?null:kd.createElement(_P,{value:o},n.children)}return W.forwardRef(e)}function K4(t){function e(n,r){const[i,o]=W.useState(!1),{instance:a}=t(n,o).current;W.useImperativeHandle(r,()=>a),W.useEffect(function(){i&&a.update()},[a,i,n.children]);const u=a._contentNode;return u?vE.createPortal(n.children,u):null}return W.forwardRef(e)}function Z4(t){function e(n,r){const{instance:i}=t(n).current;return W.useImperativeHandle(r,()=>i),null}return W.forwardRef(e)}function yP(t,e){const n=W.useRef();W.useEffect(function(){return e!=null&&t.instance.on(e),n.current=e,function(){n.current!=null&&t.instance.off(n.current),n.current=null}},[t,e])}function mv(t,e){const n=t.pane??e.pane;return n?{...t,pane:n}:t}function Q4(t,e){return function(r,i){const o=pv(),a=t(mv(r,o),o);return mP(o.map,r.attribution),yP(a.current,r.eventHandlers),e(a.current,o,r,i),a}}var Kg={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(t,e){(function(n,r){r(e)})(t1,function(n){var r="1.9.4";function i(s){var l,f,m,y;for(f=1,m=arguments.length;f<m;f++){y=arguments[f];for(l in y)s[l]=y[l]}return s}var o=Object.create||function(){function s(){}return function(l){return s.prototype=l,new s}}();function a(s,l){var f=Array.prototype.slice;if(s.bind)return s.bind.apply(s,f.call(arguments,1));var m=f.call(arguments,2);return function(){return s.apply(l,m.length?m.concat(f.call(arguments)):arguments)}}var u=0;function d(s){return"_leaflet_id"in s||(s._leaflet_id=++u),s._leaflet_id}function p(s,l,f){var m,y,b,V;return V=function(){m=!1,y&&(b.apply(f,y),y=!1)},b=function(){m?y=arguments:(s.apply(f,arguments),setTimeout(V,l),m=!0)},b}function _(s,l,f){var m=l[1],y=l[0],b=m-y;return s===m&&f?s:((s-y)%b+b)%b+y}function w(){return!1}function x(s,l){if(l===!1)return s;var f=Math.pow(10,l===void 0?6:l);return Math.round(s*f)/f}function k(s){return s.trim?s.trim():s.replace(/^\s+|\s+$/g,"")}function P(s){return k(s).split(/\s+/)}function j(s,l){Object.prototype.hasOwnProperty.call(s,"options")||(s.options=s.options?o(s.options):{});for(var f in l)s.options[f]=l[f];return s.options}function B(s,l,f){var m=[];for(var y in s)m.push(encodeURIComponent(f?y.toUpperCase():y)+"="+encodeURIComponent(s[y]));return(!l||l.indexOf("?")===-1?"?":"&")+m.join("&")}var R=/\{ *([\w_ -]+) *\}/g;function S(s,l){return s.replace(R,function(f,m){var y=l[m];if(y===void 0)throw new Error("No value provided for variable "+f);return typeof y=="function"&&(y=y(l)),y})}var N=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"};function z(s,l){for(var f=0;f<s.length;f++)if(s[f]===l)return f;return-1}var G="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function F(s){return window["webkit"+s]||window["moz"+s]||window["ms"+s]}var I=0;function T(s){var l=+new Date,f=Math.max(0,16-(l-I));return I=l+f,window.setTimeout(s,f)}var C=window.requestAnimationFrame||F("RequestAnimationFrame")||T,A=window.cancelAnimationFrame||F("CancelAnimationFrame")||F("CancelRequestAnimationFrame")||function(s){window.clearTimeout(s)};function M(s,l,f){if(f&&C===T)s.call(l);else return C.call(window,a(s,l))}function U(s){s&&A.call(window,s)}var D={__proto__:null,extend:i,create:o,bind:a,get lastId(){return u},stamp:d,throttle:p,wrapNum:_,falseFn:w,formatNum:x,trim:k,splitWords:P,setOptions:j,getParamString:B,template:S,isArray:N,indexOf:z,emptyImageUrl:G,requestFn:C,cancelFn:A,requestAnimFrame:M,cancelAnimFrame:U};function we(){}we.extend=function(s){var l=function(){j(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},f=l.__super__=this.prototype,m=o(f);m.constructor=l,l.prototype=m;for(var y in this)Object.prototype.hasOwnProperty.call(this,y)&&y!=="prototype"&&y!=="__super__"&&(l[y]=this[y]);return s.statics&&i(l,s.statics),s.includes&&(De(s.includes),i.apply(null,[m].concat(s.includes))),i(m,s),delete m.statics,delete m.includes,m.options&&(m.options=f.options?o(f.options):{},i(m.options,s.options)),m._initHooks=[],m.callInitHooks=function(){if(!this._initHooksCalled){f.callInitHooks&&f.callInitHooks.call(this),this._initHooksCalled=!0;for(var b=0,V=m._initHooks.length;b<V;b++)m._initHooks[b].call(this)}},l},we.include=function(s){var l=this.prototype.options;return i(this.prototype,s),s.options&&(this.prototype.options=l,this.mergeOptions(s.options)),this},we.mergeOptions=function(s){return i(this.prototype.options,s),this},we.addInitHook=function(s){var l=Array.prototype.slice.call(arguments,1),f=typeof s=="function"?s:function(){this[s].apply(this,l)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(f),this};function De(s){if(!(typeof L>"u"||!L||!L.Mixin)){s=N(s)?s:[s];for(var l=0;l<s.length;l++)s[l]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Pe={on:function(s,l,f){if(typeof s=="object")for(var m in s)this._on(m,s[m],l);else{s=P(s);for(var y=0,b=s.length;y<b;y++)this._on(s[y],l,f)}return this},off:function(s,l,f){if(!arguments.length)delete this._events;else if(typeof s=="object")for(var m in s)this._off(m,s[m],l);else{s=P(s);for(var y=arguments.length===1,b=0,V=s.length;b<V;b++)y?this._off(s[b]):this._off(s[b],l,f)}return this},_on:function(s,l,f,m){if(typeof l!="function"){console.warn("wrong listener type: "+typeof l);return}if(this._listens(s,l,f)===!1){f===this&&(f=void 0);var y={fn:l,ctx:f};m&&(y.once=!0),this._events=this._events||{},this._events[s]=this._events[s]||[],this._events[s].push(y)}},_off:function(s,l,f){var m,y,b;if(this._events&&(m=this._events[s],!!m)){if(arguments.length===1){if(this._firingCount)for(y=0,b=m.length;y<b;y++)m[y].fn=w;delete this._events[s];return}if(typeof l!="function"){console.warn("wrong listener type: "+typeof l);return}var V=this._listens(s,l,f);if(V!==!1){var $=m[V];this._firingCount&&($.fn=w,this._events[s]=m=m.slice()),m.splice(V,1)}}},fire:function(s,l,f){if(!this.listens(s,f))return this;var m=i({},l,{type:s,target:this,sourceTarget:l&&l.sourceTarget||this});if(this._events){var y=this._events[s];if(y){this._firingCount=this._firingCount+1||1;for(var b=0,V=y.length;b<V;b++){var $=y[b],Z=$.fn;$.once&&this.off(s,Z,$.ctx),Z.call($.ctx||this,m)}this._firingCount--}}return f&&this._propagateEvent(m),this},listens:function(s,l,f,m){typeof s!="string"&&console.warn('"string" type argument expected');var y=l;typeof l!="function"&&(m=!!l,y=void 0,f=void 0);var b=this._events&&this._events[s];if(b&&b.length&&this._listens(s,y,f)!==!1)return!0;if(m){for(var V in this._eventParents)if(this._eventParents[V].listens(s,l,f,m))return!0}return!1},_listens:function(s,l,f){if(!this._events)return!1;var m=this._events[s]||[];if(!l)return!!m.length;f===this&&(f=void 0);for(var y=0,b=m.length;y<b;y++)if(m[y].fn===l&&m[y].ctx===f)return y;return!1},once:function(s,l,f){if(typeof s=="object")for(var m in s)this._on(m,s[m],l,!0);else{s=P(s);for(var y=0,b=s.length;y<b;y++)this._on(s[y],l,f,!0)}return this},addEventParent:function(s){return this._eventParents=this._eventParents||{},this._eventParents[d(s)]=s,this},removeEventParent:function(s){return this._eventParents&&delete this._eventParents[d(s)],this},_propagateEvent:function(s){for(var l in this._eventParents)this._eventParents[l].fire(s.type,i({layer:s.target,propagatedFrom:s.target},s),!0)}};Pe.addEventListener=Pe.on,Pe.removeEventListener=Pe.clearAllEventListeners=Pe.off,Pe.addOneTimeEventListener=Pe.once,Pe.fireEvent=Pe.fire,Pe.hasEventListeners=Pe.listens;var tt=we.extend(Pe);function K(s,l,f){this.x=f?Math.round(s):s,this.y=f?Math.round(l):l}var ie=Math.trunc||function(s){return s>0?Math.floor(s):Math.ceil(s)};K.prototype={clone:function(){return new K(this.x,this.y)},add:function(s){return this.clone()._add(J(s))},_add:function(s){return this.x+=s.x,this.y+=s.y,this},subtract:function(s){return this.clone()._subtract(J(s))},_subtract:function(s){return this.x-=s.x,this.y-=s.y,this},divideBy:function(s){return this.clone()._divideBy(s)},_divideBy:function(s){return this.x/=s,this.y/=s,this},multiplyBy:function(s){return this.clone()._multiplyBy(s)},_multiplyBy:function(s){return this.x*=s,this.y*=s,this},scaleBy:function(s){return new K(this.x*s.x,this.y*s.y)},unscaleBy:function(s){return new K(this.x/s.x,this.y/s.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=ie(this.x),this.y=ie(this.y),this},distanceTo:function(s){s=J(s);var l=s.x-this.x,f=s.y-this.y;return Math.sqrt(l*l+f*f)},equals:function(s){return s=J(s),s.x===this.x&&s.y===this.y},contains:function(s){return s=J(s),Math.abs(s.x)<=Math.abs(this.x)&&Math.abs(s.y)<=Math.abs(this.y)},toString:function(){return"Point("+x(this.x)+", "+x(this.y)+")"}};function J(s,l,f){return s instanceof K?s:N(s)?new K(s[0],s[1]):s==null?s:typeof s=="object"&&"x"in s&&"y"in s?new K(s.x,s.y):new K(s,l,f)}function ae(s,l){if(s)for(var f=l?[s,l]:s,m=0,y=f.length;m<y;m++)this.extend(f[m])}ae.prototype={extend:function(s){var l,f;if(!s)return this;if(s instanceof K||typeof s[0]=="number"||"x"in s)l=f=J(s);else if(s=ce(s),l=s.min,f=s.max,!l||!f)return this;return!this.min&&!this.max?(this.min=l.clone(),this.max=f.clone()):(this.min.x=Math.min(l.x,this.min.x),this.max.x=Math.max(f.x,this.max.x),this.min.y=Math.min(l.y,this.min.y),this.max.y=Math.max(f.y,this.max.y)),this},getCenter:function(s){return J((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,s)},getBottomLeft:function(){return J(this.min.x,this.max.y)},getTopRight:function(){return J(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(s){var l,f;return typeof s[0]=="number"||s instanceof K?s=J(s):s=ce(s),s instanceof ae?(l=s.min,f=s.max):l=f=s,l.x>=this.min.x&&f.x<=this.max.x&&l.y>=this.min.y&&f.y<=this.max.y},intersects:function(s){s=ce(s);var l=this.min,f=this.max,m=s.min,y=s.max,b=y.x>=l.x&&m.x<=f.x,V=y.y>=l.y&&m.y<=f.y;return b&&V},overlaps:function(s){s=ce(s);var l=this.min,f=this.max,m=s.min,y=s.max,b=y.x>l.x&&m.x<f.x,V=y.y>l.y&&m.y<f.y;return b&&V},isValid:function(){return!!(this.min&&this.max)},pad:function(s){var l=this.min,f=this.max,m=Math.abs(l.x-f.x)*s,y=Math.abs(l.y-f.y)*s;return ce(J(l.x-m,l.y-y),J(f.x+m,f.y+y))},equals:function(s){return s?(s=ce(s),this.min.equals(s.getTopLeft())&&this.max.equals(s.getBottomRight())):!1}};function ce(s,l){return!s||s instanceof ae?s:new ae(s,l)}function _e(s,l){if(s)for(var f=l?[s,l]:s,m=0,y=f.length;m<y;m++)this.extend(f[m])}_e.prototype={extend:function(s){var l=this._southWest,f=this._northEast,m,y;if(s instanceof Se)m=s,y=s;else if(s instanceof _e){if(m=s._southWest,y=s._northEast,!m||!y)return this}else return s?this.extend(me(s)||ke(s)):this;return!l&&!f?(this._southWest=new Se(m.lat,m.lng),this._northEast=new Se(y.lat,y.lng)):(l.lat=Math.min(m.lat,l.lat),l.lng=Math.min(m.lng,l.lng),f.lat=Math.max(y.lat,f.lat),f.lng=Math.max(y.lng,f.lng)),this},pad:function(s){var l=this._southWest,f=this._northEast,m=Math.abs(l.lat-f.lat)*s,y=Math.abs(l.lng-f.lng)*s;return new _e(new Se(l.lat-m,l.lng-y),new Se(f.lat+m,f.lng+y))},getCenter:function(){return new Se((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Se(this.getNorth(),this.getWest())},getSouthEast:function(){return new Se(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(s){typeof s[0]=="number"||s instanceof Se||"lat"in s?s=me(s):s=ke(s);var l=this._southWest,f=this._northEast,m,y;return s instanceof _e?(m=s.getSouthWest(),y=s.getNorthEast()):m=y=s,m.lat>=l.lat&&y.lat<=f.lat&&m.lng>=l.lng&&y.lng<=f.lng},intersects:function(s){s=ke(s);var l=this._southWest,f=this._northEast,m=s.getSouthWest(),y=s.getNorthEast(),b=y.lat>=l.lat&&m.lat<=f.lat,V=y.lng>=l.lng&&m.lng<=f.lng;return b&&V},overlaps:function(s){s=ke(s);var l=this._southWest,f=this._northEast,m=s.getSouthWest(),y=s.getNorthEast(),b=y.lat>l.lat&&m.lat<f.lat,V=y.lng>l.lng&&m.lng<f.lng;return b&&V},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(s,l){return s?(s=ke(s),this._southWest.equals(s.getSouthWest(),l)&&this._northEast.equals(s.getNorthEast(),l)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function ke(s,l){return s instanceof _e?s:new _e(s,l)}function Se(s,l,f){if(isNaN(s)||isNaN(l))throw new Error("Invalid LatLng object: ("+s+", "+l+")");this.lat=+s,this.lng=+l,f!==void 0&&(this.alt=+f)}Se.prototype={equals:function(s,l){if(!s)return!1;s=me(s);var f=Math.max(Math.abs(this.lat-s.lat),Math.abs(this.lng-s.lng));return f<=(l===void 0?1e-9:l)},toString:function(s){return"LatLng("+x(this.lat,s)+", "+x(this.lng,s)+")"},distanceTo:function(s){return en.distance(this,me(s))},wrap:function(){return en.wrapLatLng(this)},toBounds:function(s){var l=180*s/40075017,f=l/Math.cos(Math.PI/180*this.lat);return ke([this.lat-l,this.lng-f],[this.lat+l,this.lng+f])},clone:function(){return new Se(this.lat,this.lng,this.alt)}};function me(s,l,f){return s instanceof Se?s:N(s)&&typeof s[0]!="object"?s.length===3?new Se(s[0],s[1],s[2]):s.length===2?new Se(s[0],s[1]):null:s==null?s:typeof s=="object"&&"lat"in s?new Se(s.lat,"lng"in s?s.lng:s.lon,s.alt):l===void 0?null:new Se(s,l,f)}var at={latLngToPoint:function(s,l){var f=this.projection.project(s),m=this.scale(l);return this.transformation._transform(f,m)},pointToLatLng:function(s,l){var f=this.scale(l),m=this.transformation.untransform(s,f);return this.projection.unproject(m)},project:function(s){return this.projection.project(s)},unproject:function(s){return this.projection.unproject(s)},scale:function(s){return 256*Math.pow(2,s)},zoom:function(s){return Math.log(s/256)/Math.LN2},getProjectedBounds:function(s){if(this.infinite)return null;var l=this.projection.bounds,f=this.scale(s),m=this.transformation.transform(l.min,f),y=this.transformation.transform(l.max,f);return new ae(m,y)},infinite:!1,wrapLatLng:function(s){var l=this.wrapLng?_(s.lng,this.wrapLng,!0):s.lng,f=this.wrapLat?_(s.lat,this.wrapLat,!0):s.lat,m=s.alt;return new Se(f,l,m)},wrapLatLngBounds:function(s){var l=s.getCenter(),f=this.wrapLatLng(l),m=l.lat-f.lat,y=l.lng-f.lng;if(m===0&&y===0)return s;var b=s.getSouthWest(),V=s.getNorthEast(),$=new Se(b.lat-m,b.lng-y),Z=new Se(V.lat-m,V.lng-y);return new _e($,Z)}},en=i({},at,{wrapLng:[-180,180],R:6371e3,distance:function(s,l){var f=Math.PI/180,m=s.lat*f,y=l.lat*f,b=Math.sin((l.lat-s.lat)*f/2),V=Math.sin((l.lng-s.lng)*f/2),$=b*b+Math.cos(m)*Math.cos(y)*V*V,Z=2*Math.atan2(Math.sqrt($),Math.sqrt(1-$));return this.R*Z}}),ct=6378137,nt={R:ct,MAX_LATITUDE:85.0511287798,project:function(s){var l=Math.PI/180,f=this.MAX_LATITUDE,m=Math.max(Math.min(f,s.lat),-f),y=Math.sin(m*l);return new K(this.R*s.lng*l,this.R*Math.log((1+y)/(1-y))/2)},unproject:function(s){var l=180/Math.PI;return new Se((2*Math.atan(Math.exp(s.y/this.R))-Math.PI/2)*l,s.x*l/this.R)},bounds:function(){var s=ct*Math.PI;return new ae([-s,-s],[s,s])}()};function Me(s,l,f,m){if(N(s)){this._a=s[0],this._b=s[1],this._c=s[2],this._d=s[3];return}this._a=s,this._b=l,this._c=f,this._d=m}Me.prototype={transform:function(s,l){return this._transform(s.clone(),l)},_transform:function(s,l){return l=l||1,s.x=l*(this._a*s.x+this._b),s.y=l*(this._c*s.y+this._d),s},untransform:function(s,l){return l=l||1,new K((s.x/l-this._b)/this._a,(s.y/l-this._d)/this._c)}};function ft(s,l,f,m){return new Me(s,l,f,m)}var Ye=i({},en,{code:"EPSG:3857",projection:nt,transformation:function(){var s=.5/(Math.PI*nt.R);return ft(s,.5,-s,.5)}()}),_n=i({},Ye,{code:"EPSG:900913"});function Yi(s){return document.createElementNS("http://www.w3.org/2000/svg",s)}function Ji(s,l){var f="",m,y,b,V,$,Z;for(m=0,b=s.length;m<b;m++){for($=s[m],y=0,V=$.length;y<V;y++)Z=$[y],f+=(y?"L":"M")+Z.x+" "+Z.y;f+=l?pe.svg?"z":"x":""}return f||"M0 0"}var Xi=document.documentElement.style,oi="ActiveXObject"in window,zn=oi&&!document.addEventListener,es="msLaunchUri"in navigator&&!("documentMode"in document),Br=Cn("webkit"),uo=Cn("android"),wr=Cn("android 2")||Cn("android 3"),co=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),ho=uo&&Cn("Google")&&co<537&&!("AudioNode"in window),yt=!!window.opera,Rt=!es&&Cn("chrome"),ai=Cn("gecko")&&!Br&&!yt&&!oi,fo=!Rt&&Cn("safari"),ts=Cn("phantom"),ha="OTransition"in Xi,li=navigator.platform.indexOf("Win")===0,po=oi&&"transition"in Xi,ns="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!wr,ui="MozPerspective"in Xi,zl=!window.L_DISABLE_3D&&(po||ns||ui)&&!ha&&!ts,yn=typeof orientation<"u"||Cn("mobile"),Lt=yn&&Br,An=yn&&ns,xr=!window.PointerEvent&&window.MSPointerEvent,br=!!(window.PointerEvent||xr),ci="ontouchstart"in window||!!window.TouchEvent,rs=!window.L_NO_TOUCH&&(ci||br),Be=yn&&yt,da=yn&&ai,is=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,fa=function(){var s=!1;try{var l=Object.defineProperty({},"passive",{get:function(){s=!0}});window.addEventListener("testPassiveEventSupport",w,l),window.removeEventListener("testPassiveEventSupport",w,l)}catch{}return s}(),hi=function(){return!!document.createElement("canvas").getContext}(),ss=!!(document.createElementNS&&Yi("svg").createSVGRect),Vt=!!ss&&function(){var s=document.createElement("div");return s.innerHTML="<svg/>",(s.firstChild&&s.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),pa=!ss&&function(){try{var s=document.createElement("div");s.innerHTML='<v:shape adj="1"/>';var l=s.firstChild;return l.style.behavior="url(#default#VML)",l&&typeof l.adj=="object"}catch{return!1}}(),di=navigator.platform.indexOf("Mac")===0,fi=navigator.platform.indexOf("Linux")===0;function Cn(s){return navigator.userAgent.toLowerCase().indexOf(s)>=0}var pe={ie:oi,ielt9:zn,edge:es,webkit:Br,android:uo,android23:wr,androidStock:ho,opera:yt,chrome:Rt,gecko:ai,safari:fo,phantom:ts,opera12:ha,win:li,ie3d:po,webkit3d:ns,gecko3d:ui,any3d:zl,mobile:yn,mobileWebkit:Lt,mobileWebkit3d:An,msPointer:xr,pointer:br,touch:rs,touchNative:ci,mobileOpera:Be,mobileGecko:da,retina:is,passiveEvents:fa,canvas:hi,svg:ss,vml:pa,inlineSvg:Vt,mac:di,linux:fi},Tr=pe.msPointer?"MSPointerDown":"pointerdown",pi=pe.msPointer?"MSPointerMove":"pointermove",ma=pe.msPointer?"MSPointerUp":"pointerup",mi=pe.msPointer?"MSPointerCancel":"pointercancel",os={touchstart:Tr,touchmove:pi,touchend:ma,touchcancel:mi},as={touchstart:_i,touchmove:gi,touchend:gi,touchcancel:gi},qt={},ye=!1;function ga(s,l,f){return l==="touchstart"&&go(),as[l]?(f=as[l].bind(this,f),s.addEventListener(os[l],f,!1),f):(console.warn("wrong event specified:",l),w)}function mo(s,l,f){if(!os[l]){console.warn("wrong event specified:",l);return}s.removeEventListener(os[l],f,!1)}function ls(s){qt[s.pointerId]=s}function us(s){qt[s.pointerId]&&(qt[s.pointerId]=s)}function cs(s){delete qt[s.pointerId]}function go(){ye||(document.addEventListener(Tr,ls,!0),document.addEventListener(pi,us,!0),document.addEventListener(ma,cs,!0),document.addEventListener(mi,cs,!0),ye=!0)}function gi(s,l){if(l.pointerType!==(l.MSPOINTER_TYPE_MOUSE||"mouse")){l.touches=[];for(var f in qt)l.touches.push(qt[f]);l.changedTouches=[l],s(l)}}function _i(s,l){l.MSPOINTER_TYPE_TOUCH&&l.pointerType===l.MSPOINTER_TYPE_TOUCH&&xt(l),gi(s,l)}function _o(s){var l={},f,m;for(m in s)f=s[m],l[m]=f&&f.bind?f.bind(s):f;return s=l,l.type="dblclick",l.detail=2,l.isTrusted=!1,l._simulated=!0,l}var hs=200;function O(s,l){s.addEventListener("dblclick",l);var f=0,m;function y(b){if(b.detail!==1){m=b.detail;return}if(!(b.pointerType==="mouse"||b.sourceCapabilities&&!b.sourceCapabilities.firesTouchEvents)){var V=Yl(b);if(!(V.some(function(Z){return Z instanceof HTMLLabelElement&&Z.attributes.for})&&!V.some(function(Z){return Z instanceof HTMLInputElement||Z instanceof HTMLSelectElement}))){var $=Date.now();$-f<=hs?(m++,m===2&&l(_o(b))):m=1,f=$}}}return s.addEventListener("click",y),{dblclick:l,simDblclick:y}}function X(s,l){s.removeEventListener("dblclick",l.dblclick),s.removeEventListener("click",l.simDblclick)}var re=yi(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),xe=yi(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Le=xe==="webkitTransition"||xe==="OTransition"?xe+"End":"transitionend";function vt(s){return typeof s=="string"?document.getElementById(s):s}function wt(s,l){var f=s.style[l]||s.currentStyle&&s.currentStyle[l];if((!f||f==="auto")&&document.defaultView){var m=document.defaultView.getComputedStyle(s,null);f=m?m[l]:null}return f==="auto"?null:f}function Re(s,l,f){var m=document.createElement(s);return m.className=l||"",f&&f.appendChild(m),m}function $e(s){var l=s.parentNode;l&&l.removeChild(s)}function zr(s){for(;s.firstChild;)s.removeChild(s.firstChild)}function Er(s){var l=s.parentNode;l&&l.lastChild!==s&&l.appendChild(s)}function qr(s){var l=s.parentNode;l&&l.firstChild!==s&&l.insertBefore(s,l.firstChild)}function yo(s,l){if(s.classList!==void 0)return s.classList.contains(l);var f=ir(s);return f.length>0&&new RegExp("(^|\\s)"+l+"(\\s|$)").test(f)}function Ae(s,l){if(s.classList!==void 0)for(var f=P(l),m=0,y=f.length;m<y;m++)s.classList.add(f[m]);else if(!yo(s,l)){var b=ir(s);ql(s,(b?b+" ":"")+l)}}function pt(s,l){s.classList!==void 0?s.classList.remove(l):ql(s,k((" "+ir(s)+" ").replace(" "+l+" "," ")))}function ql(s,l){s.className.baseVal===void 0?s.className=l:s.className.baseVal=l}function ir(s){return s.correspondingElement&&(s=s.correspondingElement),s.className.baseVal===void 0?s.className:s.className.baseVal}function St(s,l){"opacity"in s.style?s.style.opacity=l:"filter"in s.style&&_a(s,l)}function _a(s,l){var f=!1,m="DXImageTransform.Microsoft.Alpha";try{f=s.filters.item(m)}catch{if(l===1)return}l=Math.round(l*100),f?(f.Enabled=l!==100,f.Opacity=l):s.style.filter+=" progid:"+m+"(opacity="+l+")"}function yi(s){for(var l=document.documentElement.style,f=0;f<s.length;f++)if(s[f]in l)return s[f];return!1}function $r(s,l,f){var m=l||new K(0,0);s.style[re]=(pe.ie3d?"translate("+m.x+"px,"+m.y+"px)":"translate3d("+m.x+"px,"+m.y+"px,0)")+(f?" scale("+f+")":"")}function Ce(s,l){s._leaflet_pos=l,pe.any3d?$r(s,l):(s.style.left=l.x+"px",s.style.top=l.y+"px")}function sr(s){return s._leaflet_pos||new K(0,0)}var Ir,kr,$l;if("onselectstart"in document)Ir=function(){Te(window,"selectstart",xt)},kr=function(){rt(window,"selectstart",xt)};else{var ds=yi(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Ir=function(){if(ds){var s=document.documentElement.style;$l=s[ds],s[ds]="none"}},kr=function(){ds&&(document.documentElement.style[ds]=$l,$l=void 0)}}function Hl(){Te(window,"dragstart",xt)}function Wl(){rt(window,"dragstart",xt)}var ya,Gl;function vi(s){for(;s.tabIndex===-1;)s=s.parentNode;s.style&&(qn(),ya=s,Gl=s.style.outlineStyle,s.style.outlineStyle="none",Te(window,"keydown",qn))}function qn(){ya&&(ya.style.outlineStyle=Gl,ya=void 0,Gl=void 0,rt(window,"keydown",qn))}function Kl(s){do s=s.parentNode;while((!s.offsetWidth||!s.offsetHeight)&&s!==document.body);return s}function va(s){var l=s.getBoundingClientRect();return{x:l.width/s.offsetWidth||1,y:l.height/s.offsetHeight||1,boundingClientRect:l}}var rh={__proto__:null,TRANSFORM:re,TRANSITION:xe,TRANSITION_END:Le,get:vt,getStyle:wt,create:Re,remove:$e,empty:zr,toFront:Er,toBack:qr,hasClass:yo,addClass:Ae,removeClass:pt,setClass:ql,getClass:ir,setOpacity:St,testProp:yi,setTransform:$r,setPosition:Ce,getPosition:sr,get disableTextSelection(){return Ir},get enableTextSelection(){return kr},disableImageDrag:Hl,enableImageDrag:Wl,preventOutline:vi,restoreOutline:qn,getSizedParentNode:Kl,getScale:va};function Te(s,l,f,m){if(l&&typeof l=="object")for(var y in l)Zl(s,y,l[y],f);else{l=P(l);for(var b=0,V=l.length;b<V;b++)Zl(s,l[b],f,m)}return this}var or="_leaflet_events";function rt(s,l,f,m){if(arguments.length===1)ih(s),delete s[or];else if(l&&typeof l=="object")for(var y in l)Ql(s,y,l[y],f);else if(l=P(l),arguments.length===2)ih(s,function($){return z(l,$)!==-1});else for(var b=0,V=l.length;b<V;b++)Ql(s,l[b],f,m);return this}function ih(s,l){for(var f in s[or]){var m=f.split(/\d/)[0];(!l||l(m))&&Ql(s,m,null,null,f)}}var ar={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Zl(s,l,f,m){var y=l+d(f)+(m?"_"+d(m):"");if(s[or]&&s[or][y])return this;var b=function($){return f.call(m||s,$||window.event)},V=b;!pe.touchNative&&pe.pointer&&l.indexOf("touch")===0?b=ga(s,l,b):pe.touch&&l==="dblclick"?b=O(s,b):"addEventListener"in s?l==="touchstart"||l==="touchmove"||l==="wheel"||l==="mousewheel"?s.addEventListener(ar[l]||l,b,pe.passiveEvents?{passive:!1}:!1):l==="mouseenter"||l==="mouseleave"?(b=function($){$=$||window.event,Jl(s,$)&&V($)},s.addEventListener(ar[l],b,!1)):s.addEventListener(l,V,!1):s.attachEvent("on"+l,b),s[or]=s[or]||{},s[or][y]=b}function Ql(s,l,f,m,y){y=y||l+d(f)+(m?"_"+d(m):"");var b=s[or]&&s[or][y];if(!b)return this;!pe.touchNative&&pe.pointer&&l.indexOf("touch")===0?mo(s,l,b):pe.touch&&l==="dblclick"?X(s,b):"removeEventListener"in s?s.removeEventListener(ar[l]||l,b,!1):s.detachEvent("on"+l,b),s[or][y]=null}function lr(s){return s.stopPropagation?s.stopPropagation():s.originalEvent?s.originalEvent._stopped=!0:s.cancelBubble=!0,this}function fs(s){return Zl(s,"wheel",lr),this}function ps(s){return Te(s,"mousedown touchstart dblclick contextmenu",lr),s._leaflet_disable_click=!0,this}function xt(s){return s.preventDefault?s.preventDefault():s.returnValue=!1,this}function $n(s){return xt(s),lr(s),this}function Yl(s){if(s.composedPath)return s.composedPath();for(var l=[],f=s.target;f;)l.push(f),f=f.parentNode;return l}function wa(s,l){if(!l)return new K(s.clientX,s.clientY);var f=va(l),m=f.boundingClientRect;return new K((s.clientX-m.left)/f.x-l.clientLeft,(s.clientY-m.top)/f.y-l.clientTop)}var mt=pe.linux&&pe.chrome?window.devicePixelRatio:pe.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function sh(s){return pe.edge?s.wheelDeltaY/2:s.deltaY&&s.deltaMode===0?-s.deltaY/mt:s.deltaY&&s.deltaMode===1?-s.deltaY*20:s.deltaY&&s.deltaMode===2?-s.deltaY*60:s.deltaX||s.deltaZ?0:s.wheelDelta?(s.wheelDeltaY||s.wheelDelta)/2:s.detail&&Math.abs(s.detail)<32765?-s.detail*20:s.detail?s.detail/-32765*60:0}function Jl(s,l){var f=l.relatedTarget;if(!f)return!0;try{for(;f&&f!==s;)f=f.parentNode}catch{return!1}return f!==s}var oh={__proto__:null,on:Te,off:rt,stopPropagation:lr,disableScrollPropagation:fs,disableClickPropagation:ps,preventDefault:xt,stop:$n,getPropagationPath:Yl,getMousePosition:wa,getWheelDelta:sh,isExternalTarget:Jl,addListener:Te,removeListener:rt},Xl=tt.extend({run:function(s,l,f,m){this.stop(),this._el=s,this._inProgress=!0,this._duration=f||.25,this._easeOutPower=1/Math.max(m||.5,.2),this._startPos=sr(s),this._offset=l.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=M(this._animate,this),this._step()},_step:function(s){var l=+new Date-this._startTime,f=this._duration*1e3;l<f?this._runFrame(this._easeOut(l/f),s):(this._runFrame(1),this._complete())},_runFrame:function(s,l){var f=this._startPos.add(this._offset.multiplyBy(s));l&&f._round(),Ce(this._el,f),this.fire("step")},_complete:function(){U(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(s){return 1-Math.pow(1-s,this._easeOutPower)}}),Fe=tt.extend({options:{crs:Ye,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(s,l){l=j(this,l),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(s),this._initLayout(),this._onResize=a(this._onResize,this),this._initEvents(),l.maxBounds&&this.setMaxBounds(l.maxBounds),l.zoom!==void 0&&(this._zoom=this._limitZoom(l.zoom)),l.center&&l.zoom!==void 0&&this.setView(me(l.center),l.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=xe&&pe.any3d&&!pe.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Te(this._proxy,Le,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(s,l,f){if(l=l===void 0?this._zoom:this._limitZoom(l),s=this._limitCenter(me(s),l,this.options.maxBounds),f=f||{},this._stop(),this._loaded&&!f.reset&&f!==!0){f.animate!==void 0&&(f.zoom=i({animate:f.animate},f.zoom),f.pan=i({animate:f.animate,duration:f.duration},f.pan));var m=this._zoom!==l?this._tryAnimatedZoom&&this._tryAnimatedZoom(s,l,f.zoom):this._tryAnimatedPan(s,f.pan);if(m)return clearTimeout(this._sizeTimer),this}return this._resetView(s,l,f.pan&&f.pan.noMoveStart),this},setZoom:function(s,l){return this._loaded?this.setView(this.getCenter(),s,{zoom:l}):(this._zoom=s,this)},zoomIn:function(s,l){return s=s||(pe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+s,l)},zoomOut:function(s,l){return s=s||(pe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-s,l)},setZoomAround:function(s,l,f){var m=this.getZoomScale(l),y=this.getSize().divideBy(2),b=s instanceof K?s:this.latLngToContainerPoint(s),V=b.subtract(y).multiplyBy(1-1/m),$=this.containerPointToLatLng(y.add(V));return this.setView($,l,{zoom:f})},_getBoundsCenterZoom:function(s,l){l=l||{},s=s.getBounds?s.getBounds():ke(s);var f=J(l.paddingTopLeft||l.padding||[0,0]),m=J(l.paddingBottomRight||l.padding||[0,0]),y=this.getBoundsZoom(s,!1,f.add(m));if(y=typeof l.maxZoom=="number"?Math.min(l.maxZoom,y):y,y===1/0)return{center:s.getCenter(),zoom:y};var b=m.subtract(f).divideBy(2),V=this.project(s.getSouthWest(),y),$=this.project(s.getNorthEast(),y),Z=this.unproject(V.add($).divideBy(2).add(b),y);return{center:Z,zoom:y}},fitBounds:function(s,l){if(s=ke(s),!s.isValid())throw new Error("Bounds are not valid.");var f=this._getBoundsCenterZoom(s,l);return this.setView(f.center,f.zoom,l)},fitWorld:function(s){return this.fitBounds([[-90,-180],[90,180]],s)},panTo:function(s,l){return this.setView(s,this._zoom,{pan:l})},panBy:function(s,l){if(s=J(s).round(),l=l||{},!s.x&&!s.y)return this.fire("moveend");if(l.animate!==!0&&!this.getSize().contains(s))return this._resetView(this.unproject(this.project(this.getCenter()).add(s)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Xl,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),l.noMoveStart||this.fire("movestart"),l.animate!==!1){Ae(this._mapPane,"leaflet-pan-anim");var f=this._getMapPanePos().subtract(s).round();this._panAnim.run(this._mapPane,f,l.duration||.25,l.easeLinearity)}else this._rawPanBy(s),this.fire("move").fire("moveend");return this},flyTo:function(s,l,f){if(f=f||{},f.animate===!1||!pe.any3d)return this.setView(s,l,f);this._stop();var m=this.project(this.getCenter()),y=this.project(s),b=this.getSize(),V=this._zoom;s=me(s),l=l===void 0?V:l;var $=Math.max(b.x,b.y),Z=$*this.getZoomScale(V,l),ee=y.distanceTo(m)||1,ue=1.42,Ee=ue*ue;function Oe(Ut){var bh=Ut?-1:1,YP=Ut?Z:$,JP=Z*Z-$*$+bh*Ee*Ee*ee*ee,XP=2*YP*Ee*ee,kp=JP/XP,qv=Math.sqrt(kp*kp+1)-kp,e1=qv<1e-9?-18:Math.log(qv);return e1}function wn(Ut){return(Math.exp(Ut)-Math.exp(-Ut))/2}function Zt(Ut){return(Math.exp(Ut)+Math.exp(-Ut))/2}function cr(Ut){return wn(Ut)/Zt(Ut)}var Rn=Oe(0);function La(Ut){return $*(Zt(Rn)/Zt(Rn+ue*Ut))}function GP(Ut){return $*(Zt(Rn)*cr(Rn+ue*Ut)-wn(Rn))/Ee}function KP(Ut){return 1-Math.pow(1-Ut,1.5)}var ZP=Date.now(),Bv=(Oe(1)-Rn)/ue,QP=f.duration?1e3*f.duration:1e3*Bv*.8;function zv(){var Ut=(Date.now()-ZP)/QP,bh=KP(Ut)*Bv;Ut<=1?(this._flyToFrame=M(zv,this),this._move(this.unproject(m.add(y.subtract(m).multiplyBy(GP(bh)/ee)),V),this.getScaleZoom($/La(bh),V),{flyTo:!0})):this._move(s,l)._moveEnd(!0)}return this._moveStart(!0,f.noMoveStart),zv.call(this),this},flyToBounds:function(s,l){var f=this._getBoundsCenterZoom(s,l);return this.flyTo(f.center,f.zoom,l)},setMaxBounds:function(s){return s=ke(s),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),s.isValid()?(this.options.maxBounds=s,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(s){var l=this.options.minZoom;return this.options.minZoom=s,this._loaded&&l!==s&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(s):this},setMaxZoom:function(s){var l=this.options.maxZoom;return this.options.maxZoom=s,this._loaded&&l!==s&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(s):this},panInsideBounds:function(s,l){this._enforcingBounds=!0;var f=this.getCenter(),m=this._limitCenter(f,this._zoom,ke(s));return f.equals(m)||this.panTo(m,l),this._enforcingBounds=!1,this},panInside:function(s,l){l=l||{};var f=J(l.paddingTopLeft||l.padding||[0,0]),m=J(l.paddingBottomRight||l.padding||[0,0]),y=this.project(this.getCenter()),b=this.project(s),V=this.getPixelBounds(),$=ce([V.min.add(f),V.max.subtract(m)]),Z=$.getSize();if(!$.contains(b)){this._enforcingBounds=!0;var ee=b.subtract($.getCenter()),ue=$.extend(b).getSize().subtract(Z);y.x+=ee.x<0?-ue.x:ue.x,y.y+=ee.y<0?-ue.y:ue.y,this.panTo(this.unproject(y),l),this._enforcingBounds=!1}return this},invalidateSize:function(s){if(!this._loaded)return this;s=i({animate:!1,pan:!0},s===!0?{animate:!0}:s);var l=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var f=this.getSize(),m=l.divideBy(2).round(),y=f.divideBy(2).round(),b=m.subtract(y);return!b.x&&!b.y?this:(s.animate&&s.pan?this.panBy(b):(s.pan&&this._rawPanBy(b),this.fire("move"),s.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(a(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:l,newSize:f}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(s){if(s=this._locateOptions=i({timeout:1e4,watch:!1},s),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var l=a(this._handleGeolocationResponse,this),f=a(this._handleGeolocationError,this);return s.watch?this._locationWatchId=navigator.geolocation.watchPosition(l,f,s):navigator.geolocation.getCurrentPosition(l,f,s),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(s){if(this._container._leaflet_id){var l=s.code,f=s.message||(l===1?"permission denied":l===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:l,message:"Geolocation error: "+f+"."})}},_handleGeolocationResponse:function(s){if(this._container._leaflet_id){var l=s.coords.latitude,f=s.coords.longitude,m=new Se(l,f),y=m.toBounds(s.coords.accuracy*2),b=this._locateOptions;if(b.setView){var V=this.getBoundsZoom(y);this.setView(m,b.maxZoom?Math.min(V,b.maxZoom):V)}var $={latlng:m,bounds:y,timestamp:s.timestamp};for(var Z in s.coords)typeof s.coords[Z]=="number"&&($[Z]=s.coords[Z]);this.fire("locationfound",$)}},addHandler:function(s,l){if(!l)return this;var f=this[s]=new l(this);return this._handlers.push(f),this.options[s]&&f.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),$e(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(U(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var s;for(s in this._layers)this._layers[s].remove();for(s in this._panes)$e(this._panes[s]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(s,l){var f="leaflet-pane"+(s?" leaflet-"+s.replace("Pane","")+"-pane":""),m=Re("div",f,l||this._mapPane);return s&&(this._panes[s]=m),m},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var s=this.getPixelBounds(),l=this.unproject(s.getBottomLeft()),f=this.unproject(s.getTopRight());return new _e(l,f)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(s,l,f){s=ke(s),f=J(f||[0,0]);var m=this.getZoom()||0,y=this.getMinZoom(),b=this.getMaxZoom(),V=s.getNorthWest(),$=s.getSouthEast(),Z=this.getSize().subtract(f),ee=ce(this.project($,m),this.project(V,m)).getSize(),ue=pe.any3d?this.options.zoomSnap:1,Ee=Z.x/ee.x,Oe=Z.y/ee.y,wn=l?Math.max(Ee,Oe):Math.min(Ee,Oe);return m=this.getScaleZoom(wn,m),ue&&(m=Math.round(m/(ue/100))*(ue/100),m=l?Math.ceil(m/ue)*ue:Math.floor(m/ue)*ue),Math.max(y,Math.min(b,m))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new K(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(s,l){var f=this._getTopLeftPoint(s,l);return new ae(f,f.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(s){return this.options.crs.getProjectedBounds(s===void 0?this.getZoom():s)},getPane:function(s){return typeof s=="string"?this._panes[s]:s},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(s,l){var f=this.options.crs;return l=l===void 0?this._zoom:l,f.scale(s)/f.scale(l)},getScaleZoom:function(s,l){var f=this.options.crs;l=l===void 0?this._zoom:l;var m=f.zoom(s*f.scale(l));return isNaN(m)?1/0:m},project:function(s,l){return l=l===void 0?this._zoom:l,this.options.crs.latLngToPoint(me(s),l)},unproject:function(s,l){return l=l===void 0?this._zoom:l,this.options.crs.pointToLatLng(J(s),l)},layerPointToLatLng:function(s){var l=J(s).add(this.getPixelOrigin());return this.unproject(l)},latLngToLayerPoint:function(s){var l=this.project(me(s))._round();return l._subtract(this.getPixelOrigin())},wrapLatLng:function(s){return this.options.crs.wrapLatLng(me(s))},wrapLatLngBounds:function(s){return this.options.crs.wrapLatLngBounds(ke(s))},distance:function(s,l){return this.options.crs.distance(me(s),me(l))},containerPointToLayerPoint:function(s){return J(s).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(s){return J(s).add(this._getMapPanePos())},containerPointToLatLng:function(s){var l=this.containerPointToLayerPoint(J(s));return this.layerPointToLatLng(l)},latLngToContainerPoint:function(s){return this.layerPointToContainerPoint(this.latLngToLayerPoint(me(s)))},mouseEventToContainerPoint:function(s){return wa(s,this._container)},mouseEventToLayerPoint:function(s){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(s))},mouseEventToLatLng:function(s){return this.layerPointToLatLng(this.mouseEventToLayerPoint(s))},_initContainer:function(s){var l=this._container=vt(s);if(l){if(l._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Te(l,"scroll",this._onScroll,this),this._containerId=d(l)},_initLayout:function(){var s=this._container;this._fadeAnimated=this.options.fadeAnimation&&pe.any3d,Ae(s,"leaflet-container"+(pe.touch?" leaflet-touch":"")+(pe.retina?" leaflet-retina":"")+(pe.ielt9?" leaflet-oldie":"")+(pe.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var l=wt(s,"position");l!=="absolute"&&l!=="relative"&&l!=="fixed"&&l!=="sticky"&&(s.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var s=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Ce(this._mapPane,new K(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Ae(s.markerPane,"leaflet-zoom-hide"),Ae(s.shadowPane,"leaflet-zoom-hide"))},_resetView:function(s,l,f){Ce(this._mapPane,new K(0,0));var m=!this._loaded;this._loaded=!0,l=this._limitZoom(l),this.fire("viewprereset");var y=this._zoom!==l;this._moveStart(y,f)._move(s,l)._moveEnd(y),this.fire("viewreset"),m&&this.fire("load")},_moveStart:function(s,l){return s&&this.fire("zoomstart"),l||this.fire("movestart"),this},_move:function(s,l,f,m){l===void 0&&(l=this._zoom);var y=this._zoom!==l;return this._zoom=l,this._lastCenter=s,this._pixelOrigin=this._getNewPixelOrigin(s),m?f&&f.pinch&&this.fire("zoom",f):((y||f&&f.pinch)&&this.fire("zoom",f),this.fire("move",f)),this},_moveEnd:function(s){return s&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return U(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(s){Ce(this._mapPane,this._getMapPanePos().subtract(s))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(s){this._targets={},this._targets[d(this._container)]=this;var l=s?rt:Te;l(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&l(window,"resize",this._onResize,this),pe.any3d&&this.options.transform3DLimit&&(s?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){U(this._resizeRequest),this._resizeRequest=M(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var s=this._getMapPanePos();Math.max(Math.abs(s.x),Math.abs(s.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(s,l){for(var f=[],m,y=l==="mouseout"||l==="mouseover",b=s.target||s.srcElement,V=!1;b;){if(m=this._targets[d(b)],m&&(l==="click"||l==="preclick")&&this._draggableMoved(m)){V=!0;break}if(m&&m.listens(l,!0)&&(y&&!Jl(b,s)||(f.push(m),y))||b===this._container)break;b=b.parentNode}return!f.length&&!V&&!y&&this.listens(l,!0)&&(f=[this]),f},_isClickDisabled:function(s){for(;s&&s!==this._container;){if(s._leaflet_disable_click)return!0;s=s.parentNode}},_handleDOMEvent:function(s){var l=s.target||s.srcElement;if(!(!this._loaded||l._leaflet_disable_events||s.type==="click"&&this._isClickDisabled(l))){var f=s.type;f==="mousedown"&&vi(l),this._fireDOMEvent(s,f)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(s,l,f){if(s.type==="click"){var m=i({},s);m.type="preclick",this._fireDOMEvent(m,m.type,f)}var y=this._findEventTargets(s,l);if(f){for(var b=[],V=0;V<f.length;V++)f[V].listens(l,!0)&&b.push(f[V]);y=b.concat(y)}if(y.length){l==="contextmenu"&&xt(s);var $=y[0],Z={originalEvent:s};if(s.type!=="keypress"&&s.type!=="keydown"&&s.type!=="keyup"){var ee=$.getLatLng&&(!$._radius||$._radius<=10);Z.containerPoint=ee?this.latLngToContainerPoint($.getLatLng()):this.mouseEventToContainerPoint(s),Z.layerPoint=this.containerPointToLayerPoint(Z.containerPoint),Z.latlng=ee?$.getLatLng():this.layerPointToLatLng(Z.layerPoint)}for(V=0;V<y.length;V++)if(y[V].fire(l,Z,!0),Z.originalEvent._stopped||y[V].options.bubblingMouseEvents===!1&&z(this._mouseEvents,l)!==-1)return}},_draggableMoved:function(s){return s=s.dragging&&s.dragging.enabled()?s:this,s.dragging&&s.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var s=0,l=this._handlers.length;s<l;s++)this._handlers[s].disable()},whenReady:function(s,l){return this._loaded?s.call(l||this,{target:this}):this.on("load",s,l),this},_getMapPanePos:function(){return sr(this._mapPane)||new K(0,0)},_moved:function(){var s=this._getMapPanePos();return s&&!s.equals([0,0])},_getTopLeftPoint:function(s,l){var f=s&&l!==void 0?this._getNewPixelOrigin(s,l):this.getPixelOrigin();return f.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(s,l){var f=this.getSize()._divideBy(2);return this.project(s,l)._subtract(f)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(s,l,f){var m=this._getNewPixelOrigin(f,l);return this.project(s,l)._subtract(m)},_latLngBoundsToNewLayerBounds:function(s,l,f){var m=this._getNewPixelOrigin(f,l);return ce([this.project(s.getSouthWest(),l)._subtract(m),this.project(s.getNorthWest(),l)._subtract(m),this.project(s.getSouthEast(),l)._subtract(m),this.project(s.getNorthEast(),l)._subtract(m)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(s){return this.latLngToLayerPoint(s).subtract(this._getCenterLayerPoint())},_limitCenter:function(s,l,f){if(!f)return s;var m=this.project(s,l),y=this.getSize().divideBy(2),b=new ae(m.subtract(y),m.add(y)),V=this._getBoundsOffset(b,f,l);return Math.abs(V.x)<=1&&Math.abs(V.y)<=1?s:this.unproject(m.add(V),l)},_limitOffset:function(s,l){if(!l)return s;var f=this.getPixelBounds(),m=new ae(f.min.add(s),f.max.add(s));return s.add(this._getBoundsOffset(m,l))},_getBoundsOffset:function(s,l,f){var m=ce(this.project(l.getNorthEast(),f),this.project(l.getSouthWest(),f)),y=m.min.subtract(s.min),b=m.max.subtract(s.max),V=this._rebound(y.x,-b.x),$=this._rebound(y.y,-b.y);return new K(V,$)},_rebound:function(s,l){return s+l>0?Math.round(s-l)/2:Math.max(0,Math.ceil(s))-Math.max(0,Math.floor(l))},_limitZoom:function(s){var l=this.getMinZoom(),f=this.getMaxZoom(),m=pe.any3d?this.options.zoomSnap:1;return m&&(s=Math.round(s/m)*m),Math.max(l,Math.min(f,s))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){pt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(s,l){var f=this._getCenterOffset(s)._trunc();return(l&&l.animate)!==!0&&!this.getSize().contains(f)?!1:(this.panBy(f,l),!0)},_createAnimProxy:function(){var s=this._proxy=Re("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(s),this.on("zoomanim",function(l){var f=re,m=this._proxy.style[f];$r(this._proxy,this.project(l.center,l.zoom),this.getZoomScale(l.zoom,1)),m===this._proxy.style[f]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){$e(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var s=this.getCenter(),l=this.getZoom();$r(this._proxy,this.project(s,l),this.getZoomScale(l,1))},_catchTransitionEnd:function(s){this._animatingZoom&&s.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(s,l,f){if(this._animatingZoom)return!0;if(f=f||{},!this._zoomAnimated||f.animate===!1||this._nothingToAnimate()||Math.abs(l-this._zoom)>this.options.zoomAnimationThreshold)return!1;var m=this.getZoomScale(l),y=this._getCenterOffset(s)._divideBy(1-1/m);return f.animate!==!0&&!this.getSize().contains(y)?!1:(M(function(){this._moveStart(!0,f.noMoveStart||!1)._animateZoom(s,l,!0)},this),!0)},_animateZoom:function(s,l,f,m){this._mapPane&&(f&&(this._animatingZoom=!0,this._animateToCenter=s,this._animateToZoom=l,Ae(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:s,zoom:l,noUpdate:m}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(a(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&pt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function xa(s,l){return new Fe(s,l)}var Nn=we.extend({options:{position:"topright"},initialize:function(s){j(this,s)},getPosition:function(){return this.options.position},setPosition:function(s){var l=this._map;return l&&l.removeControl(this),this.options.position=s,l&&l.addControl(this),this},getContainer:function(){return this._container},addTo:function(s){this.remove(),this._map=s;var l=this._container=this.onAdd(s),f=this.getPosition(),m=s._controlCorners[f];return Ae(l,"leaflet-control"),f.indexOf("bottom")!==-1?m.insertBefore(l,m.firstChild):m.appendChild(l),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?($e(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(s){this._map&&s&&s.screenX>0&&s.screenY>0&&this._map.getContainer().focus()}}),vn=function(s){return new Nn(s)};Fe.include({addControl:function(s){return s.addTo(this),this},removeControl:function(s){return s.remove(),this},_initControlPos:function(){var s=this._controlCorners={},l="leaflet-",f=this._controlContainer=Re("div",l+"control-container",this._container);function m(y,b){var V=l+y+" "+l+b;s[y+b]=Re("div",V,f)}m("top","left"),m("top","right"),m("bottom","left"),m("bottom","right")},_clearControlPos:function(){for(var s in this._controlCorners)$e(this._controlCorners[s]);$e(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var eu=Nn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(s,l,f,m){return f<m?-1:m<f?1:0}},initialize:function(s,l,f){j(this,f),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var m in s)this._addLayer(s[m],m);for(m in l)this._addLayer(l[m],m,!0)},onAdd:function(s){this._initLayout(),this._update(),this._map=s,s.on("zoomend",this._checkDisabledLayers,this);for(var l=0;l<this._layers.length;l++)this._layers[l].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(s){return Nn.prototype.addTo.call(this,s),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var s=0;s<this._layers.length;s++)this._layers[s].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(s,l){return this._addLayer(s,l),this._map?this._update():this},addOverlay:function(s,l){return this._addLayer(s,l,!0),this._map?this._update():this},removeLayer:function(s){s.off("add remove",this._onLayerChange,this);var l=this._getLayer(d(s));return l&&this._layers.splice(this._layers.indexOf(l),1),this._map?this._update():this},expand:function(){Ae(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var s=this._map.getSize().y-(this._container.offsetTop+50);return s<this._section.clientHeight?(Ae(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=s+"px"):pt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return pt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var s="leaflet-control-layers",l=this._container=Re("div",s),f=this.options.collapsed;l.setAttribute("aria-haspopup",!0),ps(l),fs(l);var m=this._section=Re("section",s+"-list");f&&(this._map.on("click",this.collapse,this),Te(l,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var y=this._layersLink=Re("a",s+"-toggle",l);y.href="#",y.title="Layers",y.setAttribute("role","button"),Te(y,{keydown:function(b){b.keyCode===13&&this._expandSafely()},click:function(b){xt(b),this._expandSafely()}},this),f||this.expand(),this._baseLayersList=Re("div",s+"-base",m),this._separator=Re("div",s+"-separator",m),this._overlaysList=Re("div",s+"-overlays",m),l.appendChild(m)},_getLayer:function(s){for(var l=0;l<this._layers.length;l++)if(this._layers[l]&&d(this._layers[l].layer)===s)return this._layers[l]},_addLayer:function(s,l,f){this._map&&s.on("add remove",this._onLayerChange,this),this._layers.push({layer:s,name:l,overlay:f}),this.options.sortLayers&&this._layers.sort(a(function(m,y){return this.options.sortFunction(m.layer,y.layer,m.name,y.name)},this)),this.options.autoZIndex&&s.setZIndex&&(this._lastZIndex++,s.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;zr(this._baseLayersList),zr(this._overlaysList),this._layerControlInputs=[];var s,l,f,m,y=0;for(f=0;f<this._layers.length;f++)m=this._layers[f],this._addItem(m),l=l||m.overlay,s=s||!m.overlay,y+=m.overlay?0:1;return this.options.hideSingleBase&&(s=s&&y>1,this._baseLayersList.style.display=s?"":"none"),this._separator.style.display=l&&s?"":"none",this},_onLayerChange:function(s){this._handlingClick||this._update();var l=this._getLayer(d(s.target)),f=l.overlay?s.type==="add"?"overlayadd":"overlayremove":s.type==="add"?"baselayerchange":null;f&&this._map.fire(f,l)},_createRadioElement:function(s,l){var f='<input type="radio" class="leaflet-control-layers-selector" name="'+s+'"'+(l?' checked="checked"':"")+"/>",m=document.createElement("div");return m.innerHTML=f,m.firstChild},_addItem:function(s){var l=document.createElement("label"),f=this._map.hasLayer(s.layer),m;s.overlay?(m=document.createElement("input"),m.type="checkbox",m.className="leaflet-control-layers-selector",m.defaultChecked=f):m=this._createRadioElement("leaflet-base-layers_"+d(this),f),this._layerControlInputs.push(m),m.layerId=d(s.layer),Te(m,"click",this._onInputClick,this);var y=document.createElement("span");y.innerHTML=" "+s.name;var b=document.createElement("span");l.appendChild(b),b.appendChild(m),b.appendChild(y);var V=s.overlay?this._overlaysList:this._baseLayersList;return V.appendChild(l),this._checkDisabledLayers(),l},_onInputClick:function(){if(!this._preventClick){var s=this._layerControlInputs,l,f,m=[],y=[];this._handlingClick=!0;for(var b=s.length-1;b>=0;b--)l=s[b],f=this._getLayer(l.layerId).layer,l.checked?m.push(f):l.checked||y.push(f);for(b=0;b<y.length;b++)this._map.hasLayer(y[b])&&this._map.removeLayer(y[b]);for(b=0;b<m.length;b++)this._map.hasLayer(m[b])||this._map.addLayer(m[b]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var s=this._layerControlInputs,l,f,m=this._map.getZoom(),y=s.length-1;y>=0;y--)l=s[y],f=this._getLayer(l.layerId).layer,l.disabled=f.options.minZoom!==void 0&&m<f.options.minZoom||f.options.maxZoom!==void 0&&m>f.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var s=this._section;this._preventClick=!0,Te(s,"click",xt),this.expand();var l=this;setTimeout(function(){rt(s,"click",xt),l._preventClick=!1})}}),wp=function(s,l,f){return new eu(s,l,f)},wi=Nn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(s){var l="leaflet-control-zoom",f=Re("div",l+" leaflet-bar"),m=this.options;return this._zoomInButton=this._createButton(m.zoomInText,m.zoomInTitle,l+"-in",f,this._zoomIn),this._zoomOutButton=this._createButton(m.zoomOutText,m.zoomOutTitle,l+"-out",f,this._zoomOut),this._updateDisabled(),s.on("zoomend zoomlevelschange",this._updateDisabled,this),f},onRemove:function(s){s.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(s){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(s.shiftKey?3:1))},_zoomOut:function(s){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(s.shiftKey?3:1))},_createButton:function(s,l,f,m,y){var b=Re("a",f,m);return b.innerHTML=s,b.href="#",b.title=l,b.setAttribute("role","button"),b.setAttribute("aria-label",l),ps(b),Te(b,"click",$n),Te(b,"click",y,this),Te(b,"click",this._refocusOnMap,this),b},_updateDisabled:function(){var s=this._map,l="leaflet-disabled";pt(this._zoomInButton,l),pt(this._zoomOutButton,l),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||s._zoom===s.getMinZoom())&&(Ae(this._zoomOutButton,l),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||s._zoom===s.getMaxZoom())&&(Ae(this._zoomInButton,l),this._zoomInButton.setAttribute("aria-disabled","true"))}});Fe.mergeOptions({zoomControl:!0}),Fe.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new wi,this.addControl(this.zoomControl))});var ah=function(s){return new wi(s)},ba=Nn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(s){var l="leaflet-control-scale",f=Re("div",l),m=this.options;return this._addScales(m,l+"-line",f),s.on(m.updateWhenIdle?"moveend":"move",this._update,this),s.whenReady(this._update,this),f},onRemove:function(s){s.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(s,l,f){s.metric&&(this._mScale=Re("div",l,f)),s.imperial&&(this._iScale=Re("div",l,f))},_update:function(){var s=this._map,l=s.getSize().y/2,f=s.distance(s.containerPointToLatLng([0,l]),s.containerPointToLatLng([this.options.maxWidth,l]));this._updateScales(f)},_updateScales:function(s){this.options.metric&&s&&this._updateMetric(s),this.options.imperial&&s&&this._updateImperial(s)},_updateMetric:function(s){var l=this._getRoundNum(s),f=l<1e3?l+" m":l/1e3+" km";this._updateScale(this._mScale,f,l/s)},_updateImperial:function(s){var l=s*3.2808399,f,m,y;l>5280?(f=l/5280,m=this._getRoundNum(f),this._updateScale(this._iScale,m+" mi",m/f)):(y=this._getRoundNum(l),this._updateScale(this._iScale,y+" ft",y/l))},_updateScale:function(s,l,f){s.style.width=Math.round(this.options.maxWidth*f)+"px",s.innerHTML=l},_getRoundNum:function(s){var l=Math.pow(10,(Math.floor(s)+"").length-1),f=s/l;return f=f>=10?10:f>=5?5:f>=3?3:f>=2?2:1,l*f}}),Ta=function(s){return new ba(s)},lh='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',ms=Nn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(pe.inlineSvg?lh+" ":"")+"Leaflet</a>"},initialize:function(s){j(this,s),this._attributions={}},onAdd:function(s){s.attributionControl=this,this._container=Re("div","leaflet-control-attribution"),ps(this._container);for(var l in s._layers)s._layers[l].getAttribution&&this.addAttribution(s._layers[l].getAttribution());return this._update(),s.on("layeradd",this._addAttribution,this),this._container},onRemove:function(s){s.off("layeradd",this._addAttribution,this)},_addAttribution:function(s){s.layer.getAttribution&&(this.addAttribution(s.layer.getAttribution()),s.layer.once("remove",function(){this.removeAttribution(s.layer.getAttribution())},this))},setPrefix:function(s){return this.options.prefix=s,this._update(),this},addAttribution:function(s){return s?(this._attributions[s]||(this._attributions[s]=0),this._attributions[s]++,this._update(),this):this},removeAttribution:function(s){return s?(this._attributions[s]&&(this._attributions[s]--,this._update()),this):this},_update:function(){if(this._map){var s=[];for(var l in this._attributions)this._attributions[l]&&s.push(l);var f=[];this.options.prefix&&f.push(this.options.prefix),s.length&&f.push(s.join(", ")),this._container.innerHTML=f.join(' <span aria-hidden="true">|</span> ')}}});Fe.mergeOptions({attributionControl:!0}),Fe.addInitHook(function(){this.options.attributionControl&&new ms().addTo(this)});var xp=function(s){return new ms(s)};Nn.Layers=eu,Nn.Zoom=wi,Nn.Scale=ba,Nn.Attribution=ms,vn.layers=wp,vn.zoom=ah,vn.scale=Ta,vn.attribution=xp;var Hn=we.extend({initialize:function(s){this._map=s},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Hn.addTo=function(s,l){return s.addHandler(l,this),this};var vo={Events:Pe},tu=pe.touch?"touchstart mousedown":"mousedown",Sr=tt.extend({options:{clickTolerance:3},initialize:function(s,l,f,m){j(this,m),this._element=s,this._dragStartTarget=l||s,this._preventOutline=f},enable:function(){this._enabled||(Te(this._dragStartTarget,tu,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Sr._dragging===this&&this.finishDrag(!0),rt(this._dragStartTarget,tu,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(s){if(this._enabled&&(this._moved=!1,!yo(this._element,"leaflet-zoom-anim"))){if(s.touches&&s.touches.length!==1){Sr._dragging===this&&this.finishDrag();return}if(!(Sr._dragging||s.shiftKey||s.which!==1&&s.button!==1&&!s.touches)&&(Sr._dragging=this,this._preventOutline&&vi(this._element),Hl(),Ir(),!this._moving)){this.fire("down");var l=s.touches?s.touches[0]:s,f=Kl(this._element);this._startPoint=new K(l.clientX,l.clientY),this._startPos=sr(this._element),this._parentScale=va(f);var m=s.type==="mousedown";Te(document,m?"mousemove":"touchmove",this._onMove,this),Te(document,m?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(s){if(this._enabled){if(s.touches&&s.touches.length>1){this._moved=!0;return}var l=s.touches&&s.touches.length===1?s.touches[0]:s,f=new K(l.clientX,l.clientY)._subtract(this._startPoint);!f.x&&!f.y||Math.abs(f.x)+Math.abs(f.y)<this.options.clickTolerance||(f.x/=this._parentScale.x,f.y/=this._parentScale.y,xt(s),this._moved||(this.fire("dragstart"),this._moved=!0,Ae(document.body,"leaflet-dragging"),this._lastTarget=s.target||s.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Ae(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(f),this._moving=!0,this._lastEvent=s,this._updatePosition())}},_updatePosition:function(){var s={originalEvent:this._lastEvent};this.fire("predrag",s),Ce(this._element,this._newPos),this.fire("drag",s)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(s){pt(document.body,"leaflet-dragging"),this._lastTarget&&(pt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),rt(document,"mousemove touchmove",this._onMove,this),rt(document,"mouseup touchend touchcancel",this._onUp,this),Wl(),kr();var l=this._moved&&this._moving;this._moving=!1,Sr._dragging=!1,l&&this.fire("dragend",{noInertia:s,distance:this._newPos.distanceTo(this._startPos)})}});function Ea(s,l,f){var m,y=[1,4,2,8],b,V,$,Z,ee,ue,Ee,Oe;for(b=0,ue=s.length;b<ue;b++)s[b]._code=Hr(s[b],l);for($=0;$<4;$++){for(Ee=y[$],m=[],b=0,ue=s.length,V=ue-1;b<ue;V=b++)Z=s[b],ee=s[V],Z._code&Ee?ee._code&Ee||(Oe=Kt(ee,Z,Ee,l,f),Oe._code=Hr(Oe,l),m.push(Oe)):(ee._code&Ee&&(Oe=Kt(ee,Z,Ee,l,f),Oe._code=Hr(Oe,l),m.push(Oe)),m.push(Z));s=m}return s}function Ia(s,l){var f,m,y,b,V,$,Z,ee,ue;if(!s||s.length===0)throw new Error("latlngs not passed");c(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var Ee=me([0,0]),Oe=ke(s),wn=Oe.getNorthWest().distanceTo(Oe.getSouthWest())*Oe.getNorthEast().distanceTo(Oe.getNorthWest());wn<1700&&(Ee=ka(s));var Zt=s.length,cr=[];for(f=0;f<Zt;f++){var Rn=me(s[f]);cr.push(l.project(me([Rn.lat-Ee.lat,Rn.lng-Ee.lng])))}for($=Z=ee=0,f=0,m=Zt-1;f<Zt;m=f++)y=cr[f],b=cr[m],V=y.y*b.x-b.y*y.x,Z+=(y.x+b.x)*V,ee+=(y.y+b.y)*V,$+=V*3;$===0?ue=cr[0]:ue=[Z/$,ee/$];var La=l.unproject(J(ue));return me([La.lat+Ee.lat,La.lng+Ee.lng])}function ka(s){for(var l=0,f=0,m=0,y=0;y<s.length;y++){var b=me(s[y]);l+=b.lat,f+=b.lng,m++}return me([l/m,f/m])}var Sa={__proto__:null,clipPolygon:Ea,polygonCenter:Ia,centroid:ka};function nu(s,l){if(!l||!s.length)return s.slice();var f=l*l;return s=ch(s,f),s=uh(s,f),s}function ru(s,l,f){return Math.sqrt(ur(s,l,f,!0))}function xi(s,l,f){return ur(s,l,f)}function uh(s,l){var f=s.length,m=typeof Uint8Array<"u"?Uint8Array:Array,y=new m(f);y[0]=y[f-1]=1,Pa(s,y,l,0,f-1);var b,V=[];for(b=0;b<f;b++)y[b]&&V.push(s[b]);return V}function Pa(s,l,f,m,y){var b=0,V,$,Z;for($=m+1;$<=y-1;$++)Z=ur(s[$],s[m],s[y],!0),Z>b&&(V=$,b=Z);b>f&&(l[V]=1,Pa(s,l,f,m,V),Pa(s,l,f,V,y))}function ch(s,l){for(var f=[s[0]],m=1,y=0,b=s.length;m<b;m++)hh(s[m],s[y])>l&&(f.push(s[m]),y=m);return y<b-1&&f.push(s[b-1]),f}var iu;function wo(s,l,f,m,y){var b=m?iu:Hr(s,f),V=Hr(l,f),$,Z,ee;for(iu=V;;){if(!(b|V))return[s,l];if(b&V)return!1;$=b||V,Z=Kt(s,l,$,f,y),ee=Hr(Z,f),$===b?(s=Z,b=ee):(l=Z,V=ee)}}function Kt(s,l,f,m,y){var b=l.x-s.x,V=l.y-s.y,$=m.min,Z=m.max,ee,ue;return f&8?(ee=s.x+b*(Z.y-s.y)/V,ue=Z.y):f&4?(ee=s.x+b*($.y-s.y)/V,ue=$.y):f&2?(ee=Z.x,ue=s.y+V*(Z.x-s.x)/b):f&1&&(ee=$.x,ue=s.y+V*($.x-s.x)/b),new K(ee,ue,y)}function Hr(s,l){var f=0;return s.x<l.min.x?f|=1:s.x>l.max.x&&(f|=2),s.y<l.min.y?f|=4:s.y>l.max.y&&(f|=8),f}function hh(s,l){var f=l.x-s.x,m=l.y-s.y;return f*f+m*m}function ur(s,l,f,m){var y=l.x,b=l.y,V=f.x-y,$=f.y-b,Z=V*V+$*$,ee;return Z>0&&(ee=((s.x-y)*V+(s.y-b)*$)/Z,ee>1?(y=f.x,b=f.y):ee>0&&(y+=V*ee,b+=$*ee)),V=s.x-y,$=s.y-b,m?V*V+$*$:new K(y,b)}function c(s){return!N(s[0])||typeof s[0][0]!="object"&&typeof s[0][0]<"u"}function g(s){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),c(s)}function v(s,l){var f,m,y,b,V,$,Z,ee;if(!s||s.length===0)throw new Error("latlngs not passed");c(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var ue=me([0,0]),Ee=ke(s),Oe=Ee.getNorthWest().distanceTo(Ee.getSouthWest())*Ee.getNorthEast().distanceTo(Ee.getNorthWest());Oe<1700&&(ue=ka(s));var wn=s.length,Zt=[];for(f=0;f<wn;f++){var cr=me(s[f]);Zt.push(l.project(me([cr.lat-ue.lat,cr.lng-ue.lng])))}for(f=0,m=0;f<wn-1;f++)m+=Zt[f].distanceTo(Zt[f+1])/2;if(m===0)ee=Zt[0];else for(f=0,b=0;f<wn-1;f++)if(V=Zt[f],$=Zt[f+1],y=V.distanceTo($),b+=y,b>m){Z=(b-m)/y,ee=[$.x-Z*($.x-V.x),$.y-Z*($.y-V.y)];break}var Rn=l.unproject(J(ee));return me([Rn.lat+ue.lat,Rn.lng+ue.lng])}var E={__proto__:null,simplify:nu,pointToSegmentDistance:ru,closestPointOnSegment:xi,clipSegment:wo,_getEdgeIntersection:Kt,_getBitCode:Hr,_sqClosestPointOnSegment:ur,isFlat:c,_flat:g,polylineCenter:v},q={project:function(s){return new K(s.lng,s.lat)},unproject:function(s){return new Se(s.y,s.x)},bounds:new ae([-180,-90],[180,90])},Q={R:6378137,R_MINOR:6356752314245179e-9,bounds:new ae([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(s){var l=Math.PI/180,f=this.R,m=s.lat*l,y=this.R_MINOR/f,b=Math.sqrt(1-y*y),V=b*Math.sin(m),$=Math.tan(Math.PI/4-m/2)/Math.pow((1-V)/(1+V),b/2);return m=-f*Math.log(Math.max($,1e-10)),new K(s.lng*l*f,m)},unproject:function(s){for(var l=180/Math.PI,f=this.R,m=this.R_MINOR/f,y=Math.sqrt(1-m*m),b=Math.exp(-s.y/f),V=Math.PI/2-2*Math.atan(b),$=0,Z=.1,ee;$<15&&Math.abs(Z)>1e-7;$++)ee=y*Math.sin(V),ee=Math.pow((1-ee)/(1+ee),y/2),Z=Math.PI/2-2*Math.atan(b*ee)-V,V+=Z;return new Se(V*l,s.x*l/f)}},se={__proto__:null,LonLat:q,Mercator:Q,SphericalMercator:nt},Je=i({},en,{code:"EPSG:3395",projection:Q,transformation:function(){var s=.5/(Math.PI*Q.R);return ft(s,.5,-s,.5)}()}),Ft=i({},en,{code:"EPSG:4326",projection:q,transformation:ft(1/180,1,-1/180,.5)}),He=i({},at,{projection:q,transformation:ft(1,0,-1,0),scale:function(s){return Math.pow(2,s)},zoom:function(s){return Math.log(s)/Math.LN2},distance:function(s,l){var f=l.lng-s.lng,m=l.lat-s.lat;return Math.sqrt(f*f+m*m)},infinite:!0});at.Earth=en,at.EPSG3395=Je,at.EPSG3857=Ye,at.EPSG900913=_n,at.EPSG4326=Ft,at.Simple=He;var it=tt.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(s){return s.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(s){return s&&s.removeLayer(this),this},getPane:function(s){return this._map.getPane(s?this.options[s]||s:this.options.pane)},addInteractiveTarget:function(s){return this._map._targets[d(s)]=this,this},removeInteractiveTarget:function(s){return delete this._map._targets[d(s)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(s){var l=s.target;if(l.hasLayer(this)){if(this._map=l,this._zoomAnimated=l._zoomAnimated,this.getEvents){var f=this.getEvents();l.on(f,this),this.once("remove",function(){l.off(f,this)},this)}this.onAdd(l),this.fire("add"),l.fire("layeradd",{layer:this})}}});Fe.include({addLayer:function(s){if(!s._layerAdd)throw new Error("The provided object is not a Layer.");var l=d(s);return this._layers[l]?this:(this._layers[l]=s,s._mapToAdd=this,s.beforeAdd&&s.beforeAdd(this),this.whenReady(s._layerAdd,s),this)},removeLayer:function(s){var l=d(s);return this._layers[l]?(this._loaded&&s.onRemove(this),delete this._layers[l],this._loaded&&(this.fire("layerremove",{layer:s}),s.fire("remove")),s._map=s._mapToAdd=null,this):this},hasLayer:function(s){return d(s)in this._layers},eachLayer:function(s,l){for(var f in this._layers)s.call(l,this._layers[f]);return this},_addLayers:function(s){s=s?N(s)?s:[s]:[];for(var l=0,f=s.length;l<f;l++)this.addLayer(s[l])},_addZoomLimit:function(s){(!isNaN(s.options.maxZoom)||!isNaN(s.options.minZoom))&&(this._zoomBoundLayers[d(s)]=s,this._updateZoomLevels())},_removeZoomLimit:function(s){var l=d(s);this._zoomBoundLayers[l]&&(delete this._zoomBoundLayers[l],this._updateZoomLevels())},_updateZoomLevels:function(){var s=1/0,l=-1/0,f=this._getZoomSpan();for(var m in this._zoomBoundLayers){var y=this._zoomBoundLayers[m].options;s=y.minZoom===void 0?s:Math.min(s,y.minZoom),l=y.maxZoom===void 0?l:Math.max(l,y.maxZoom)}this._layersMaxZoom=l===-1/0?void 0:l,this._layersMinZoom=s===1/0?void 0:s,f!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var bt=it.extend({initialize:function(s,l){j(this,l),this._layers={};var f,m;if(s)for(f=0,m=s.length;f<m;f++)this.addLayer(s[f])},addLayer:function(s){var l=this.getLayerId(s);return this._layers[l]=s,this._map&&this._map.addLayer(s),this},removeLayer:function(s){var l=s in this._layers?s:this.getLayerId(s);return this._map&&this._layers[l]&&this._map.removeLayer(this._layers[l]),delete this._layers[l],this},hasLayer:function(s){var l=typeof s=="number"?s:this.getLayerId(s);return l in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(s){var l=Array.prototype.slice.call(arguments,1),f,m;for(f in this._layers)m=this._layers[f],m[s]&&m[s].apply(m,l);return this},onAdd:function(s){this.eachLayer(s.addLayer,s)},onRemove:function(s){this.eachLayer(s.removeLayer,s)},eachLayer:function(s,l){for(var f in this._layers)s.call(l,this._layers[f]);return this},getLayer:function(s){return this._layers[s]},getLayers:function(){var s=[];return this.eachLayer(s.push,s),s},setZIndex:function(s){return this.invoke("setZIndex",s)},getLayerId:function(s){return d(s)}}),gs=function(s,l){return new bt(s,l)},Dt=bt.extend({addLayer:function(s){return this.hasLayer(s)?this:(s.addEventParent(this),bt.prototype.addLayer.call(this,s),this.fire("layeradd",{layer:s}))},removeLayer:function(s){return this.hasLayer(s)?(s in this._layers&&(s=this._layers[s]),s.removeEventParent(this),bt.prototype.removeLayer.call(this,s),this.fire("layerremove",{layer:s})):this},setStyle:function(s){return this.invoke("setStyle",s)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var s=new _e;for(var l in this._layers){var f=this._layers[l];s.extend(f.getBounds?f.getBounds():f.getLatLng())}return s}}),Aa=function(s,l){return new Dt(s,l)},Wr=we.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(s){j(this,s)},createIcon:function(s){return this._createIcon("icon",s)},createShadow:function(s){return this._createIcon("shadow",s)},_createIcon:function(s,l){var f=this._getIconUrl(s);if(!f){if(s==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var m=this._createImg(f,l&&l.tagName==="IMG"?l:null);return this._setIconStyles(m,s),(this.options.crossOrigin||this.options.crossOrigin==="")&&(m.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),m},_setIconStyles:function(s,l){var f=this.options,m=f[l+"Size"];typeof m=="number"&&(m=[m,m]);var y=J(m),b=J(l==="shadow"&&f.shadowAnchor||f.iconAnchor||y&&y.divideBy(2,!0));s.className="leaflet-marker-"+l+" "+(f.className||""),b&&(s.style.marginLeft=-b.x+"px",s.style.marginTop=-b.y+"px"),y&&(s.style.width=y.x+"px",s.style.height=y.y+"px")},_createImg:function(s,l){return l=l||document.createElement("img"),l.src=s,l},_getIconUrl:function(s){return pe.retina&&this.options[s+"RetinaUrl"]||this.options[s+"Url"]}});function PP(s){return new Wr(s)}var su=Wr.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(s){return typeof su.imagePath!="string"&&(su.imagePath=this._detectIconPath()),(this.options.imagePath||su.imagePath)+Wr.prototype._getIconUrl.call(this,s)},_stripUrl:function(s){var l=function(f,m,y){var b=m.exec(f);return b&&b[y]};return s=l(s,/^url\((['"])?(.+)\1\)$/,2),s&&l(s,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var s=Re("div","leaflet-default-icon-path",document.body),l=wt(s,"background-image")||wt(s,"backgroundImage");if(document.body.removeChild(s),l=this._stripUrl(l),l)return l;var f=document.querySelector('link[href$="leaflet.css"]');return f?f.href.substring(0,f.href.length-11-1):""}}),bv=Hn.extend({initialize:function(s){this._marker=s},addHooks:function(){var s=this._marker._icon;this._draggable||(this._draggable=new Sr(s,s,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Ae(s,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&pt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(s){var l=this._marker,f=l._map,m=this._marker.options.autoPanSpeed,y=this._marker.options.autoPanPadding,b=sr(l._icon),V=f.getPixelBounds(),$=f.getPixelOrigin(),Z=ce(V.min._subtract($).add(y),V.max._subtract($).subtract(y));if(!Z.contains(b)){var ee=J((Math.max(Z.max.x,b.x)-Z.max.x)/(V.max.x-Z.max.x)-(Math.min(Z.min.x,b.x)-Z.min.x)/(V.min.x-Z.min.x),(Math.max(Z.max.y,b.y)-Z.max.y)/(V.max.y-Z.max.y)-(Math.min(Z.min.y,b.y)-Z.min.y)/(V.min.y-Z.min.y)).multiplyBy(m);f.panBy(ee,{animate:!1}),this._draggable._newPos._add(ee),this._draggable._startPos._add(ee),Ce(l._icon,this._draggable._newPos),this._onDrag(s),this._panRequest=M(this._adjustPan.bind(this,s))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(s){this._marker.options.autoPan&&(U(this._panRequest),this._panRequest=M(this._adjustPan.bind(this,s)))},_onDrag:function(s){var l=this._marker,f=l._shadow,m=sr(l._icon),y=l._map.layerPointToLatLng(m);f&&Ce(f,m),l._latlng=y,s.latlng=y,s.oldLatLng=this._oldLatLng,l.fire("move",s).fire("drag",s)},_onDragEnd:function(s){U(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",s)}}),dh=it.extend({options:{icon:new su,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(s,l){j(this,l),this._latlng=me(s)},onAdd:function(s){this._zoomAnimated=this._zoomAnimated&&s.options.markerZoomAnimation,this._zoomAnimated&&s.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(s){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&s.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(s){var l=this._latlng;return this._latlng=me(s),this.update(),this.fire("move",{oldLatLng:l,latlng:this._latlng})},setZIndexOffset:function(s){return this.options.zIndexOffset=s,this.update()},getIcon:function(){return this.options.icon},setIcon:function(s){return this.options.icon=s,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var s=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(s)}return this},_initIcon:function(){var s=this.options,l="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),f=s.icon.createIcon(this._icon),m=!1;f!==this._icon&&(this._icon&&this._removeIcon(),m=!0,s.title&&(f.title=s.title),f.tagName==="IMG"&&(f.alt=s.alt||"")),Ae(f,l),s.keyboard&&(f.tabIndex="0",f.setAttribute("role","button")),this._icon=f,s.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Te(f,"focus",this._panOnFocus,this);var y=s.icon.createShadow(this._shadow),b=!1;y!==this._shadow&&(this._removeShadow(),b=!0),y&&(Ae(y,l),y.alt=""),this._shadow=y,s.opacity<1&&this._updateOpacity(),m&&this.getPane().appendChild(this._icon),this._initInteraction(),y&&b&&this.getPane(s.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&rt(this._icon,"focus",this._panOnFocus,this),$e(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&$e(this._shadow),this._shadow=null},_setPos:function(s){this._icon&&Ce(this._icon,s),this._shadow&&Ce(this._shadow,s),this._zIndex=s.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(s){this._icon&&(this._icon.style.zIndex=this._zIndex+s)},_animateZoom:function(s){var l=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center).round();this._setPos(l)},_initInteraction:function(){if(this.options.interactive&&(Ae(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),bv)){var s=this.options.draggable;this.dragging&&(s=this.dragging.enabled(),this.dragging.disable()),this.dragging=new bv(this),s&&this.dragging.enable()}},setOpacity:function(s){return this.options.opacity=s,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var s=this.options.opacity;this._icon&&St(this._icon,s),this._shadow&&St(this._shadow,s)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var s=this._map;if(s){var l=this.options.icon.options,f=l.iconSize?J(l.iconSize):J(0,0),m=l.iconAnchor?J(l.iconAnchor):J(0,0);s.panInside(this._latlng,{paddingTopLeft:m,paddingBottomRight:f.subtract(m)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function AP(s,l){return new dh(s,l)}var _s=it.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(s){this._renderer=s.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(s){return j(this,s),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&s&&Object.prototype.hasOwnProperty.call(s,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),fh=_s.extend({options:{fill:!0,radius:10},initialize:function(s,l){j(this,l),this._latlng=me(s),this._radius=this.options.radius},setLatLng:function(s){var l=this._latlng;return this._latlng=me(s),this.redraw(),this.fire("move",{oldLatLng:l,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(s){return this.options.radius=this._radius=s,this.redraw()},getRadius:function(){return this._radius},setStyle:function(s){var l=s&&s.radius||this._radius;return _s.prototype.setStyle.call(this,s),this.setRadius(l),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var s=this._radius,l=this._radiusY||s,f=this._clickTolerance(),m=[s+f,l+f];this._pxBounds=new ae(this._point.subtract(m),this._point.add(m))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(s){return s.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function CP(s,l){return new fh(s,l)}var bp=fh.extend({initialize:function(s,l,f){if(typeof l=="number"&&(l=i({},f,{radius:l})),j(this,l),this._latlng=me(s),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(s){return this._mRadius=s,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var s=[this._radius,this._radiusY||this._radius];return new _e(this._map.layerPointToLatLng(this._point.subtract(s)),this._map.layerPointToLatLng(this._point.add(s)))},setStyle:_s.prototype.setStyle,_project:function(){var s=this._latlng.lng,l=this._latlng.lat,f=this._map,m=f.options.crs;if(m.distance===en.distance){var y=Math.PI/180,b=this._mRadius/en.R/y,V=f.project([l+b,s]),$=f.project([l-b,s]),Z=V.add($).divideBy(2),ee=f.unproject(Z).lat,ue=Math.acos((Math.cos(b*y)-Math.sin(l*y)*Math.sin(ee*y))/(Math.cos(l*y)*Math.cos(ee*y)))/y;(isNaN(ue)||ue===0)&&(ue=b/Math.cos(Math.PI/180*l)),this._point=Z.subtract(f.getPixelOrigin()),this._radius=isNaN(ue)?0:Z.x-f.project([ee,s-ue]).x,this._radiusY=Z.y-V.y}else{var Ee=m.unproject(m.project(this._latlng).subtract([this._mRadius,0]));this._point=f.latLngToLayerPoint(this._latlng),this._radius=this._point.x-f.latLngToLayerPoint(Ee).x}this._updateBounds()}});function NP(s,l,f){return new bp(s,l,f)}var bi=_s.extend({options:{smoothFactor:1,noClip:!1},initialize:function(s,l){j(this,l),this._setLatLngs(s)},getLatLngs:function(){return this._latlngs},setLatLngs:function(s){return this._setLatLngs(s),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(s){for(var l=1/0,f=null,m=ur,y,b,V=0,$=this._parts.length;V<$;V++)for(var Z=this._parts[V],ee=1,ue=Z.length;ee<ue;ee++){y=Z[ee-1],b=Z[ee];var Ee=m(s,y,b,!0);Ee<l&&(l=Ee,f=m(s,y,b))}return f&&(f.distance=Math.sqrt(l)),f},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return v(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(s,l){return l=l||this._defaultShape(),s=me(s),l.push(s),this._bounds.extend(s),this.redraw()},_setLatLngs:function(s){this._bounds=new _e,this._latlngs=this._convertLatLngs(s)},_defaultShape:function(){return c(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(s){for(var l=[],f=c(s),m=0,y=s.length;m<y;m++)f?(l[m]=me(s[m]),this._bounds.extend(l[m])):l[m]=this._convertLatLngs(s[m]);return l},_project:function(){var s=new ae;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,s),this._bounds.isValid()&&s.isValid()&&(this._rawPxBounds=s,this._updateBounds())},_updateBounds:function(){var s=this._clickTolerance(),l=new K(s,s);this._rawPxBounds&&(this._pxBounds=new ae([this._rawPxBounds.min.subtract(l),this._rawPxBounds.max.add(l)]))},_projectLatlngs:function(s,l,f){var m=s[0]instanceof Se,y=s.length,b,V;if(m){for(V=[],b=0;b<y;b++)V[b]=this._map.latLngToLayerPoint(s[b]),f.extend(V[b]);l.push(V)}else for(b=0;b<y;b++)this._projectLatlngs(s[b],l,f)},_clipPoints:function(){var s=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}var l=this._parts,f,m,y,b,V,$,Z;for(f=0,y=0,b=this._rings.length;f<b;f++)for(Z=this._rings[f],m=0,V=Z.length;m<V-1;m++)$=wo(Z[m],Z[m+1],s,m,!0),$&&(l[y]=l[y]||[],l[y].push($[0]),($[1]!==Z[m+1]||m===V-2)&&(l[y].push($[1]),y++))}},_simplifyPoints:function(){for(var s=this._parts,l=this.options.smoothFactor,f=0,m=s.length;f<m;f++)s[f]=nu(s[f],l)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(s,l){var f,m,y,b,V,$,Z=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(f=0,b=this._parts.length;f<b;f++)for($=this._parts[f],m=0,V=$.length,y=V-1;m<V;y=m++)if(!(!l&&m===0)&&ru(s,$[y],$[m])<=Z)return!0;return!1}});function RP(s,l){return new bi(s,l)}bi._flat=g;var Ca=bi.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ia(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(s){var l=bi.prototype._convertLatLngs.call(this,s),f=l.length;return f>=2&&l[0]instanceof Se&&l[0].equals(l[f-1])&&l.pop(),l},_setLatLngs:function(s){bi.prototype._setLatLngs.call(this,s),c(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return c(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var s=this._renderer._bounds,l=this.options.weight,f=new K(l,l);if(s=new ae(s.min.subtract(f),s.max.add(f)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}for(var m=0,y=this._rings.length,b;m<y;m++)b=Ea(this._rings[m],s,!0),b.length&&this._parts.push(b)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(s){var l=!1,f,m,y,b,V,$,Z,ee;if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(b=0,Z=this._parts.length;b<Z;b++)for(f=this._parts[b],V=0,ee=f.length,$=ee-1;V<ee;$=V++)m=f[V],y=f[$],m.y>s.y!=y.y>s.y&&s.x<(y.x-m.x)*(s.y-m.y)/(y.y-m.y)+m.x&&(l=!l);return l||bi.prototype._containsPoint.call(this,s,!0)}});function LP(s,l){return new Ca(s,l)}var Ti=Dt.extend({initialize:function(s,l){j(this,l),this._layers={},s&&this.addData(s)},addData:function(s){var l=N(s)?s:s.features,f,m,y;if(l){for(f=0,m=l.length;f<m;f++)y=l[f],(y.geometries||y.geometry||y.features||y.coordinates)&&this.addData(y);return this}var b=this.options;if(b.filter&&!b.filter(s))return this;var V=ph(s,b);return V?(V.feature=_h(s),V.defaultOptions=V.options,this.resetStyle(V),b.onEachFeature&&b.onEachFeature(s,V),this.addLayer(V)):this},resetStyle:function(s){return s===void 0?this.eachLayer(this.resetStyle,this):(s.options=i({},s.defaultOptions),this._setLayerStyle(s,this.options.style),this)},setStyle:function(s){return this.eachLayer(function(l){this._setLayerStyle(l,s)},this)},_setLayerStyle:function(s,l){s.setStyle&&(typeof l=="function"&&(l=l(s.feature)),s.setStyle(l))}});function ph(s,l){var f=s.type==="Feature"?s.geometry:s,m=f?f.coordinates:null,y=[],b=l&&l.pointToLayer,V=l&&l.coordsToLatLng||Tp,$,Z,ee,ue;if(!m&&!f)return null;switch(f.type){case"Point":return $=V(m),Tv(b,s,$,l);case"MultiPoint":for(ee=0,ue=m.length;ee<ue;ee++)$=V(m[ee]),y.push(Tv(b,s,$,l));return new Dt(y);case"LineString":case"MultiLineString":return Z=mh(m,f.type==="LineString"?0:1,V),new bi(Z,l);case"Polygon":case"MultiPolygon":return Z=mh(m,f.type==="Polygon"?1:2,V),new Ca(Z,l);case"GeometryCollection":for(ee=0,ue=f.geometries.length;ee<ue;ee++){var Ee=ph({geometry:f.geometries[ee],type:"Feature",properties:s.properties},l);Ee&&y.push(Ee)}return new Dt(y);case"FeatureCollection":for(ee=0,ue=f.features.length;ee<ue;ee++){var Oe=ph(f.features[ee],l);Oe&&y.push(Oe)}return new Dt(y);default:throw new Error("Invalid GeoJSON object.")}}function Tv(s,l,f,m){return s?s(l,f):new dh(f,m&&m.markersInheritOptions&&m)}function Tp(s){return new Se(s[1],s[0],s[2])}function mh(s,l,f){for(var m=[],y=0,b=s.length,V;y<b;y++)V=l?mh(s[y],l-1,f):(f||Tp)(s[y]),m.push(V);return m}function Ep(s,l){return s=me(s),s.alt!==void 0?[x(s.lng,l),x(s.lat,l),x(s.alt,l)]:[x(s.lng,l),x(s.lat,l)]}function gh(s,l,f,m){for(var y=[],b=0,V=s.length;b<V;b++)y.push(l?gh(s[b],c(s[b])?0:l-1,f,m):Ep(s[b],m));return!l&&f&&y.length>0&&y.push(y[0].slice()),y}function Na(s,l){return s.feature?i({},s.feature,{geometry:l}):_h(l)}function _h(s){return s.type==="Feature"||s.type==="FeatureCollection"?s:{type:"Feature",properties:{},geometry:s}}var Ip={toGeoJSON:function(s){return Na(this,{type:"Point",coordinates:Ep(this.getLatLng(),s)})}};dh.include(Ip),bp.include(Ip),fh.include(Ip),bi.include({toGeoJSON:function(s){var l=!c(this._latlngs),f=gh(this._latlngs,l?1:0,!1,s);return Na(this,{type:(l?"Multi":"")+"LineString",coordinates:f})}}),Ca.include({toGeoJSON:function(s){var l=!c(this._latlngs),f=l&&!c(this._latlngs[0]),m=gh(this._latlngs,f?2:l?1:0,!0,s);return l||(m=[m]),Na(this,{type:(f?"Multi":"")+"Polygon",coordinates:m})}}),bt.include({toMultiPoint:function(s){var l=[];return this.eachLayer(function(f){l.push(f.toGeoJSON(s).geometry.coordinates)}),Na(this,{type:"MultiPoint",coordinates:l})},toGeoJSON:function(s){var l=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(l==="MultiPoint")return this.toMultiPoint(s);var f=l==="GeometryCollection",m=[];return this.eachLayer(function(y){if(y.toGeoJSON){var b=y.toGeoJSON(s);if(f)m.push(b.geometry);else{var V=_h(b);V.type==="FeatureCollection"?m.push.apply(m,V.features):m.push(V)}}}),f?Na(this,{geometries:m,type:"GeometryCollection"}):{type:"FeatureCollection",features:m}}});function Ev(s,l){return new Ti(s,l)}var DP=Ev,yh=it.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(s,l,f){this._url=s,this._bounds=ke(l),j(this,f)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Ae(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){$e(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(s){return this.options.opacity=s,this._image&&this._updateOpacity(),this},setStyle:function(s){return s.opacity&&this.setOpacity(s.opacity),this},bringToFront:function(){return this._map&&Er(this._image),this},bringToBack:function(){return this._map&&qr(this._image),this},setUrl:function(s){return this._url=s,this._image&&(this._image.src=s),this},setBounds:function(s){return this._bounds=ke(s),this._map&&this._reset(),this},getEvents:function(){var s={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var s=this._url.tagName==="IMG",l=this._image=s?this._url:Re("img");if(Ae(l,"leaflet-image-layer"),this._zoomAnimated&&Ae(l,"leaflet-zoom-animated"),this.options.className&&Ae(l,this.options.className),l.onselectstart=w,l.onmousemove=w,l.onload=a(this.fire,this,"load"),l.onerror=a(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(l.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),s){this._url=l.src;return}l.src=this._url,l.alt=this.options.alt},_animateZoom:function(s){var l=this._map.getZoomScale(s.zoom),f=this._map._latLngBoundsToNewLayerBounds(this._bounds,s.zoom,s.center).min;$r(this._image,f,l)},_reset:function(){var s=this._image,l=new ae(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),f=l.getSize();Ce(s,l.min),s.style.width=f.x+"px",s.style.height=f.y+"px"},_updateOpacity:function(){St(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var s=this.options.errorOverlayUrl;s&&this._url!==s&&(this._url=s,this._image.src=s)},getCenter:function(){return this._bounds.getCenter()}}),jP=function(s,l,f){return new yh(s,l,f)},Iv=yh.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var s=this._url.tagName==="VIDEO",l=this._image=s?this._url:Re("video");if(Ae(l,"leaflet-image-layer"),this._zoomAnimated&&Ae(l,"leaflet-zoom-animated"),this.options.className&&Ae(l,this.options.className),l.onselectstart=w,l.onmousemove=w,l.onloadeddata=a(this.fire,this,"load"),s){for(var f=l.getElementsByTagName("source"),m=[],y=0;y<f.length;y++)m.push(f[y].src);this._url=f.length>0?m:[l.src];return}N(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(l.style,"objectFit")&&(l.style.objectFit="fill"),l.autoplay=!!this.options.autoplay,l.loop=!!this.options.loop,l.muted=!!this.options.muted,l.playsInline=!!this.options.playsInline;for(var b=0;b<this._url.length;b++){var V=Re("source");V.src=this._url[b],l.appendChild(V)}}});function MP(s,l,f){return new Iv(s,l,f)}var kv=yh.extend({_initImage:function(){var s=this._image=this._url;Ae(s,"leaflet-image-layer"),this._zoomAnimated&&Ae(s,"leaflet-zoom-animated"),this.options.className&&Ae(s,this.options.className),s.onselectstart=w,s.onmousemove=w}});function OP(s,l,f){return new kv(s,l,f)}var Gr=it.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(s,l){s&&(s instanceof Se||N(s))?(this._latlng=me(s),j(this,l)):(j(this,s),this._source=l),this.options.content&&(this._content=this.options.content)},openOn:function(s){return s=arguments.length?s:this._source._map,s.hasLayer(this)||s.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(s){return this._map?this.close():(arguments.length?this._source=s:s=this._source,this._prepareOpen(),this.openOn(s._map)),this},onAdd:function(s){this._zoomAnimated=s._zoomAnimated,this._container||this._initLayout(),s._fadeAnimated&&St(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),s._fadeAnimated&&St(this._container,1),this.bringToFront(),this.options.interactive&&(Ae(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(s){s._fadeAnimated?(St(this._container,0),this._removeTimeout=setTimeout(a($e,void 0,this._container),200)):$e(this._container),this.options.interactive&&(pt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(s){return this._latlng=me(s),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(s){return this._content=s,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var s={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Er(this._container),this},bringToBack:function(){return this._map&&qr(this._container),this},_prepareOpen:function(s){var l=this._source;if(!l._map)return!1;if(l instanceof Dt){l=null;var f=this._source._layers;for(var m in f)if(f[m]._map){l=f[m];break}if(!l)return!1;this._source=l}if(!s)if(l.getCenter)s=l.getCenter();else if(l.getLatLng)s=l.getLatLng();else if(l.getBounds)s=l.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(s),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var s=this._contentNode,l=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof l=="string")s.innerHTML=l;else{for(;s.hasChildNodes();)s.removeChild(s.firstChild);s.appendChild(l)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var s=this._map.latLngToLayerPoint(this._latlng),l=J(this.options.offset),f=this._getAnchor();this._zoomAnimated?Ce(this._container,s.add(f)):l=l.add(s).add(f);var m=this._containerBottom=-l.y,y=this._containerLeft=-Math.round(this._containerWidth/2)+l.x;this._container.style.bottom=m+"px",this._container.style.left=y+"px"}},_getAnchor:function(){return[0,0]}});Fe.include({_initOverlay:function(s,l,f,m){var y=l;return y instanceof s||(y=new s(m).setContent(l)),f&&y.setLatLng(f),y}}),it.include({_initOverlay:function(s,l,f,m){var y=f;return y instanceof s?(j(y,m),y._source=this):(y=l&&!m?l:new s(m,this),y.setContent(f)),y}});var vh=Gr.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(s){return s=arguments.length?s:this._source._map,!s.hasLayer(this)&&s._popup&&s._popup.options.autoClose&&s.removeLayer(s._popup),s._popup=this,Gr.prototype.openOn.call(this,s)},onAdd:function(s){Gr.prototype.onAdd.call(this,s),s.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof _s||this._source.on("preclick",lr))},onRemove:function(s){Gr.prototype.onRemove.call(this,s),s.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof _s||this._source.off("preclick",lr))},getEvents:function(){var s=Gr.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(s.preclick=this.close),this.options.keepInView&&(s.moveend=this._adjustPan),s},_initLayout:function(){var s="leaflet-popup",l=this._container=Re("div",s+" "+(this.options.className||"")+" leaflet-zoom-animated"),f=this._wrapper=Re("div",s+"-content-wrapper",l);if(this._contentNode=Re("div",s+"-content",f),ps(l),fs(this._contentNode),Te(l,"contextmenu",lr),this._tipContainer=Re("div",s+"-tip-container",l),this._tip=Re("div",s+"-tip",this._tipContainer),this.options.closeButton){var m=this._closeButton=Re("a",s+"-close-button",l);m.setAttribute("role","button"),m.setAttribute("aria-label","Close popup"),m.href="#close",m.innerHTML='<span aria-hidden="true">&#215;</span>',Te(m,"click",function(y){xt(y),this.close()},this)}},_updateLayout:function(){var s=this._contentNode,l=s.style;l.width="",l.whiteSpace="nowrap";var f=s.offsetWidth;f=Math.min(f,this.options.maxWidth),f=Math.max(f,this.options.minWidth),l.width=f+1+"px",l.whiteSpace="",l.height="";var m=s.offsetHeight,y=this.options.maxHeight,b="leaflet-popup-scrolled";y&&m>y?(l.height=y+"px",Ae(s,b)):pt(s,b),this._containerWidth=this._container.offsetWidth},_animateZoom:function(s){var l=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center),f=this._getAnchor();Ce(this._container,l.add(f))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var s=this._map,l=parseInt(wt(this._container,"marginBottom"),10)||0,f=this._container.offsetHeight+l,m=this._containerWidth,y=new K(this._containerLeft,-f-this._containerBottom);y._add(sr(this._container));var b=s.layerPointToContainerPoint(y),V=J(this.options.autoPanPadding),$=J(this.options.autoPanPaddingTopLeft||V),Z=J(this.options.autoPanPaddingBottomRight||V),ee=s.getSize(),ue=0,Ee=0;b.x+m+Z.x>ee.x&&(ue=b.x+m-ee.x+Z.x),b.x-ue-$.x<0&&(ue=b.x-$.x),b.y+f+Z.y>ee.y&&(Ee=b.y+f-ee.y+Z.y),b.y-Ee-$.y<0&&(Ee=b.y-$.y),(ue||Ee)&&(this.options.keepInView&&(this._autopanning=!0),s.fire("autopanstart").panBy([ue,Ee]))}},_getAnchor:function(){return J(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),VP=function(s,l){return new vh(s,l)};Fe.mergeOptions({closePopupOnClick:!0}),Fe.include({openPopup:function(s,l,f){return this._initOverlay(vh,s,l,f).openOn(this),this},closePopup:function(s){return s=arguments.length?s:this._popup,s&&s.close(),this}}),it.include({bindPopup:function(s,l){return this._popup=this._initOverlay(vh,this._popup,s,l),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(s){return this._popup&&(this instanceof Dt||(this._popup._source=this),this._popup._prepareOpen(s||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(s){return this._popup&&this._popup.setContent(s),this},getPopup:function(){return this._popup},_openPopup:function(s){if(!(!this._popup||!this._map)){$n(s);var l=s.layer||s.target;if(this._popup._source===l&&!(l instanceof _s)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(s.latlng);return}this._popup._source=l,this.openPopup(s.latlng)}},_movePopup:function(s){this._popup.setLatLng(s.latlng)},_onKeyPress:function(s){s.originalEvent.keyCode===13&&this._openPopup(s)}});var wh=Gr.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(s){Gr.prototype.onAdd.call(this,s),this.setOpacity(this.options.opacity),s.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(s){Gr.prototype.onRemove.call(this,s),s.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var s=Gr.prototype.getEvents.call(this);return this.options.permanent||(s.preclick=this.close),s},_initLayout:function(){var s="leaflet-tooltip",l=s+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Re("div",l),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+d(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(s){var l,f,m=this._map,y=this._container,b=m.latLngToContainerPoint(m.getCenter()),V=m.layerPointToContainerPoint(s),$=this.options.direction,Z=y.offsetWidth,ee=y.offsetHeight,ue=J(this.options.offset),Ee=this._getAnchor();$==="top"?(l=Z/2,f=ee):$==="bottom"?(l=Z/2,f=0):$==="center"?(l=Z/2,f=ee/2):$==="right"?(l=0,f=ee/2):$==="left"?(l=Z,f=ee/2):V.x<b.x?($="right",l=0,f=ee/2):($="left",l=Z+(ue.x+Ee.x)*2,f=ee/2),s=s.subtract(J(l,f,!0)).add(ue).add(Ee),pt(y,"leaflet-tooltip-right"),pt(y,"leaflet-tooltip-left"),pt(y,"leaflet-tooltip-top"),pt(y,"leaflet-tooltip-bottom"),Ae(y,"leaflet-tooltip-"+$),Ce(y,s)},_updatePosition:function(){var s=this._map.latLngToLayerPoint(this._latlng);this._setPosition(s)},setOpacity:function(s){this.options.opacity=s,this._container&&St(this._container,s)},_animateZoom:function(s){var l=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center);this._setPosition(l)},_getAnchor:function(){return J(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),FP=function(s,l){return new wh(s,l)};Fe.include({openTooltip:function(s,l,f){return this._initOverlay(wh,s,l,f).openOn(this),this},closeTooltip:function(s){return s.close(),this}}),it.include({bindTooltip:function(s,l){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(wh,this._tooltip,s,l),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(s){if(!(!s&&this._tooltipHandlersAdded)){var l=s?"off":"on",f={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?f.add=this._openTooltip:(f.mouseover=this._openTooltip,f.mouseout=this.closeTooltip,f.click=this._openTooltip,this._map?this._addFocusListeners():f.add=this._addFocusListeners),this._tooltip.options.sticky&&(f.mousemove=this._moveTooltip),this[l](f),this._tooltipHandlersAdded=!s}},openTooltip:function(s){return this._tooltip&&(this instanceof Dt||(this._tooltip._source=this),this._tooltip._prepareOpen(s)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(s){return this._tooltip&&this._tooltip.setContent(s),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(s){var l=typeof s.getElement=="function"&&s.getElement();l&&(Te(l,"focus",function(){this._tooltip._source=s,this.openTooltip()},this),Te(l,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(s){var l=typeof s.getElement=="function"&&s.getElement();l&&l.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(s){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var l=this;this._map.once("moveend",function(){l._openOnceFlag=!1,l._openTooltip(s)});return}this._tooltip._source=s.layer||s.target,this.openTooltip(this._tooltip.options.sticky?s.latlng:void 0)}},_moveTooltip:function(s){var l=s.latlng,f,m;this._tooltip.options.sticky&&s.originalEvent&&(f=this._map.mouseEventToContainerPoint(s.originalEvent),m=this._map.containerPointToLayerPoint(f),l=this._map.layerPointToLatLng(m)),this._tooltip.setLatLng(l)}});var Sv=Wr.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(s){var l=s&&s.tagName==="DIV"?s:document.createElement("div"),f=this.options;if(f.html instanceof Element?(zr(l),l.appendChild(f.html)):l.innerHTML=f.html!==!1?f.html:"",f.bgPos){var m=J(f.bgPos);l.style.backgroundPosition=-m.x+"px "+-m.y+"px"}return this._setIconStyles(l,"icon"),l},createShadow:function(){return null}});function UP(s){return new Sv(s)}Wr.Default=su;var ou=it.extend({options:{tileSize:256,opacity:1,updateWhenIdle:pe.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(s){j(this,s)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(s){s._addZoomLimit(this)},onRemove:function(s){this._removeAllTiles(),$e(this._container),s._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Er(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(qr(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(s){return this.options.opacity=s,this._updateOpacity(),this},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var s=this._clampZoom(this._map.getZoom());s!==this._tileZoom&&(this._tileZoom=s,this._updateLevels()),this._update()}return this},getEvents:function(){var s={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=p(this._onMoveEnd,this.options.updateInterval,this)),s.move=this._onMove),this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},createTile:function(){return document.createElement("div")},getTileSize:function(){var s=this.options.tileSize;return s instanceof K?s:new K(s,s)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(s){for(var l=this.getPane().children,f=-s(-1/0,1/0),m=0,y=l.length,b;m<y;m++)b=l[m].style.zIndex,l[m]!==this._container&&b&&(f=s(f,+b));isFinite(f)&&(this.options.zIndex=f+s(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!pe.ielt9){St(this._container,this.options.opacity);var s=+new Date,l=!1,f=!1;for(var m in this._tiles){var y=this._tiles[m];if(!(!y.current||!y.loaded)){var b=Math.min(1,(s-y.loaded)/200);St(y.el,b),b<1?l=!0:(y.active?f=!0:this._onOpaqueTile(y),y.active=!0)}}f&&!this._noPrune&&this._pruneTiles(),l&&(U(this._fadeFrame),this._fadeFrame=M(this._updateOpacity,this))}},_onOpaqueTile:w,_initContainer:function(){this._container||(this._container=Re("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var s=this._tileZoom,l=this.options.maxZoom;if(s!==void 0){for(var f in this._levels)f=Number(f),this._levels[f].el.children.length||f===s?(this._levels[f].el.style.zIndex=l-Math.abs(s-f),this._onUpdateLevel(f)):($e(this._levels[f].el),this._removeTilesAtZoom(f),this._onRemoveLevel(f),delete this._levels[f]);var m=this._levels[s],y=this._map;return m||(m=this._levels[s]={},m.el=Re("div","leaflet-tile-container leaflet-zoom-animated",this._container),m.el.style.zIndex=l,m.origin=y.project(y.unproject(y.getPixelOrigin()),s).round(),m.zoom=s,this._setZoomTransform(m,y.getCenter(),y.getZoom()),w(m.el.offsetWidth),this._onCreateLevel(m)),this._level=m,m}},_onUpdateLevel:w,_onRemoveLevel:w,_onCreateLevel:w,_pruneTiles:function(){if(this._map){var s,l,f=this._map.getZoom();if(f>this.options.maxZoom||f<this.options.minZoom){this._removeAllTiles();return}for(s in this._tiles)l=this._tiles[s],l.retain=l.current;for(s in this._tiles)if(l=this._tiles[s],l.current&&!l.active){var m=l.coords;this._retainParent(m.x,m.y,m.z,m.z-5)||this._retainChildren(m.x,m.y,m.z,m.z+2)}for(s in this._tiles)this._tiles[s].retain||this._removeTile(s)}},_removeTilesAtZoom:function(s){for(var l in this._tiles)this._tiles[l].coords.z===s&&this._removeTile(l)},_removeAllTiles:function(){for(var s in this._tiles)this._removeTile(s)},_invalidateAll:function(){for(var s in this._levels)$e(this._levels[s].el),this._onRemoveLevel(Number(s)),delete this._levels[s];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(s,l,f,m){var y=Math.floor(s/2),b=Math.floor(l/2),V=f-1,$=new K(+y,+b);$.z=+V;var Z=this._tileCoordsToKey($),ee=this._tiles[Z];return ee&&ee.active?(ee.retain=!0,!0):(ee&&ee.loaded&&(ee.retain=!0),V>m?this._retainParent(y,b,V,m):!1)},_retainChildren:function(s,l,f,m){for(var y=2*s;y<2*s+2;y++)for(var b=2*l;b<2*l+2;b++){var V=new K(y,b);V.z=f+1;var $=this._tileCoordsToKey(V),Z=this._tiles[$];if(Z&&Z.active){Z.retain=!0;continue}else Z&&Z.loaded&&(Z.retain=!0);f+1<m&&this._retainChildren(y,b,f+1,m)}},_resetView:function(s){var l=s&&(s.pinch||s.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),l,l)},_animateZoom:function(s){this._setView(s.center,s.zoom,!0,s.noUpdate)},_clampZoom:function(s){var l=this.options;return l.minNativeZoom!==void 0&&s<l.minNativeZoom?l.minNativeZoom:l.maxNativeZoom!==void 0&&l.maxNativeZoom<s?l.maxNativeZoom:s},_setView:function(s,l,f,m){var y=Math.round(l);this.options.maxZoom!==void 0&&y>this.options.maxZoom||this.options.minZoom!==void 0&&y<this.options.minZoom?y=void 0:y=this._clampZoom(y);var b=this.options.updateWhenZooming&&y!==this._tileZoom;(!m||b)&&(this._tileZoom=y,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),y!==void 0&&this._update(s),f||this._pruneTiles(),this._noPrune=!!f),this._setZoomTransforms(s,l)},_setZoomTransforms:function(s,l){for(var f in this._levels)this._setZoomTransform(this._levels[f],s,l)},_setZoomTransform:function(s,l,f){var m=this._map.getZoomScale(f,s.zoom),y=s.origin.multiplyBy(m).subtract(this._map._getNewPixelOrigin(l,f)).round();pe.any3d?$r(s.el,y,m):Ce(s.el,y)},_resetGrid:function(){var s=this._map,l=s.options.crs,f=this._tileSize=this.getTileSize(),m=this._tileZoom,y=this._map.getPixelWorldBounds(this._tileZoom);y&&(this._globalTileRange=this._pxBoundsToTileRange(y)),this._wrapX=l.wrapLng&&!this.options.noWrap&&[Math.floor(s.project([0,l.wrapLng[0]],m).x/f.x),Math.ceil(s.project([0,l.wrapLng[1]],m).x/f.y)],this._wrapY=l.wrapLat&&!this.options.noWrap&&[Math.floor(s.project([l.wrapLat[0],0],m).y/f.x),Math.ceil(s.project([l.wrapLat[1],0],m).y/f.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(s){var l=this._map,f=l._animatingZoom?Math.max(l._animateToZoom,l.getZoom()):l.getZoom(),m=l.getZoomScale(f,this._tileZoom),y=l.project(s,this._tileZoom).floor(),b=l.getSize().divideBy(m*2);return new ae(y.subtract(b),y.add(b))},_update:function(s){var l=this._map;if(l){var f=this._clampZoom(l.getZoom());if(s===void 0&&(s=l.getCenter()),this._tileZoom!==void 0){var m=this._getTiledPixelBounds(s),y=this._pxBoundsToTileRange(m),b=y.getCenter(),V=[],$=this.options.keepBuffer,Z=new ae(y.getBottomLeft().subtract([$,-$]),y.getTopRight().add([$,-$]));if(!(isFinite(y.min.x)&&isFinite(y.min.y)&&isFinite(y.max.x)&&isFinite(y.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var ee in this._tiles){var ue=this._tiles[ee].coords;(ue.z!==this._tileZoom||!Z.contains(new K(ue.x,ue.y)))&&(this._tiles[ee].current=!1)}if(Math.abs(f-this._tileZoom)>1){this._setView(s,f);return}for(var Ee=y.min.y;Ee<=y.max.y;Ee++)for(var Oe=y.min.x;Oe<=y.max.x;Oe++){var wn=new K(Oe,Ee);if(wn.z=this._tileZoom,!!this._isValidTile(wn)){var Zt=this._tiles[this._tileCoordsToKey(wn)];Zt?Zt.current=!0:V.push(wn)}}if(V.sort(function(Rn,La){return Rn.distanceTo(b)-La.distanceTo(b)}),V.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var cr=document.createDocumentFragment();for(Oe=0;Oe<V.length;Oe++)this._addTile(V[Oe],cr);this._level.el.appendChild(cr)}}}},_isValidTile:function(s){var l=this._map.options.crs;if(!l.infinite){var f=this._globalTileRange;if(!l.wrapLng&&(s.x<f.min.x||s.x>f.max.x)||!l.wrapLat&&(s.y<f.min.y||s.y>f.max.y))return!1}if(!this.options.bounds)return!0;var m=this._tileCoordsToBounds(s);return ke(this.options.bounds).overlaps(m)},_keyToBounds:function(s){return this._tileCoordsToBounds(this._keyToTileCoords(s))},_tileCoordsToNwSe:function(s){var l=this._map,f=this.getTileSize(),m=s.scaleBy(f),y=m.add(f),b=l.unproject(m,s.z),V=l.unproject(y,s.z);return[b,V]},_tileCoordsToBounds:function(s){var l=this._tileCoordsToNwSe(s),f=new _e(l[0],l[1]);return this.options.noWrap||(f=this._map.wrapLatLngBounds(f)),f},_tileCoordsToKey:function(s){return s.x+":"+s.y+":"+s.z},_keyToTileCoords:function(s){var l=s.split(":"),f=new K(+l[0],+l[1]);return f.z=+l[2],f},_removeTile:function(s){var l=this._tiles[s];l&&($e(l.el),delete this._tiles[s],this.fire("tileunload",{tile:l.el,coords:this._keyToTileCoords(s)}))},_initTile:function(s){Ae(s,"leaflet-tile");var l=this.getTileSize();s.style.width=l.x+"px",s.style.height=l.y+"px",s.onselectstart=w,s.onmousemove=w,pe.ielt9&&this.options.opacity<1&&St(s,this.options.opacity)},_addTile:function(s,l){var f=this._getTilePos(s),m=this._tileCoordsToKey(s),y=this.createTile(this._wrapCoords(s),a(this._tileReady,this,s));this._initTile(y),this.createTile.length<2&&M(a(this._tileReady,this,s,null,y)),Ce(y,f),this._tiles[m]={el:y,coords:s,current:!0},l.appendChild(y),this.fire("tileloadstart",{tile:y,coords:s})},_tileReady:function(s,l,f){l&&this.fire("tileerror",{error:l,tile:f,coords:s});var m=this._tileCoordsToKey(s);f=this._tiles[m],f&&(f.loaded=+new Date,this._map._fadeAnimated?(St(f.el,0),U(this._fadeFrame),this._fadeFrame=M(this._updateOpacity,this)):(f.active=!0,this._pruneTiles()),l||(Ae(f.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:f.el,coords:s})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),pe.ielt9||!this._map._fadeAnimated?M(this._pruneTiles,this):setTimeout(a(this._pruneTiles,this),250)))},_getTilePos:function(s){return s.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(s){var l=new K(this._wrapX?_(s.x,this._wrapX):s.x,this._wrapY?_(s.y,this._wrapY):s.y);return l.z=s.z,l},_pxBoundsToTileRange:function(s){var l=this.getTileSize();return new ae(s.min.unscaleBy(l).floor(),s.max.unscaleBy(l).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var s in this._tiles)if(!this._tiles[s].loaded)return!1;return!0}});function BP(s){return new ou(s)}var Ra=ou.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(s,l){this._url=s,l=j(this,l),l.detectRetina&&pe.retina&&l.maxZoom>0?(l.tileSize=Math.floor(l.tileSize/2),l.zoomReverse?(l.zoomOffset--,l.minZoom=Math.min(l.maxZoom,l.minZoom+1)):(l.zoomOffset++,l.maxZoom=Math.max(l.minZoom,l.maxZoom-1)),l.minZoom=Math.max(0,l.minZoom)):l.zoomReverse?l.minZoom=Math.min(l.maxZoom,l.minZoom):l.maxZoom=Math.max(l.minZoom,l.maxZoom),typeof l.subdomains=="string"&&(l.subdomains=l.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(s,l){return this._url===s&&l===void 0&&(l=!0),this._url=s,l||this.redraw(),this},createTile:function(s,l){var f=document.createElement("img");return Te(f,"load",a(this._tileOnLoad,this,l,f)),Te(f,"error",a(this._tileOnError,this,l,f)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(f.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(f.referrerPolicy=this.options.referrerPolicy),f.alt="",f.src=this.getTileUrl(s),f},getTileUrl:function(s){var l={r:pe.retina?"@2x":"",s:this._getSubdomain(s),x:s.x,y:s.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var f=this._globalTileRange.max.y-s.y;this.options.tms&&(l.y=f),l["-y"]=f}return S(this._url,i(l,this.options))},_tileOnLoad:function(s,l){pe.ielt9?setTimeout(a(s,this,null,l),0):s(null,l)},_tileOnError:function(s,l,f){var m=this.options.errorTileUrl;m&&l.getAttribute("src")!==m&&(l.src=m),s(f,l)},_onTileRemove:function(s){s.tile.onload=null},_getZoomForUrl:function(){var s=this._tileZoom,l=this.options.maxZoom,f=this.options.zoomReverse,m=this.options.zoomOffset;return f&&(s=l-s),s+m},_getSubdomain:function(s){var l=Math.abs(s.x+s.y)%this.options.subdomains.length;return this.options.subdomains[l]},_abortLoading:function(){var s,l;for(s in this._tiles)if(this._tiles[s].coords.z!==this._tileZoom&&(l=this._tiles[s].el,l.onload=w,l.onerror=w,!l.complete)){l.src=G;var f=this._tiles[s].coords;$e(l),delete this._tiles[s],this.fire("tileabort",{tile:l,coords:f})}},_removeTile:function(s){var l=this._tiles[s];if(l)return l.el.setAttribute("src",G),ou.prototype._removeTile.call(this,s)},_tileReady:function(s,l,f){if(!(!this._map||f&&f.getAttribute("src")===G))return ou.prototype._tileReady.call(this,s,l,f)}});function Pv(s,l){return new Ra(s,l)}var Av=Ra.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(s,l){this._url=s;var f=i({},this.defaultWmsParams);for(var m in l)m in this.options||(f[m]=l[m]);l=j(this,l);var y=l.detectRetina&&pe.retina?2:1,b=this.getTileSize();f.width=b.x*y,f.height=b.y*y,this.wmsParams=f},onAdd:function(s){this._crs=this.options.crs||s.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var l=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[l]=this._crs.code,Ra.prototype.onAdd.call(this,s)},getTileUrl:function(s){var l=this._tileCoordsToNwSe(s),f=this._crs,m=ce(f.project(l[0]),f.project(l[1])),y=m.min,b=m.max,V=(this._wmsVersion>=1.3&&this._crs===Ft?[y.y,y.x,b.y,b.x]:[y.x,y.y,b.x,b.y]).join(","),$=Ra.prototype.getTileUrl.call(this,s);return $+B(this.wmsParams,$,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+V},setParams:function(s,l){return i(this.wmsParams,s),l||this.redraw(),this}});function zP(s,l){return new Av(s,l)}Ra.WMS=Av,Pv.wms=zP;var Ei=it.extend({options:{padding:.1},initialize:function(s){j(this,s),d(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Ae(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var s={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(s.zoomanim=this._onAnimZoom),s},_onAnimZoom:function(s){this._updateTransform(s.center,s.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(s,l){var f=this._map.getZoomScale(l,this._zoom),m=this._map.getSize().multiplyBy(.5+this.options.padding),y=this._map.project(this._center,l),b=m.multiplyBy(-f).add(y).subtract(this._map._getNewPixelOrigin(s,l));pe.any3d?$r(this._container,b,f):Ce(this._container,b)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var s in this._layers)this._layers[s]._reset()},_onZoomEnd:function(){for(var s in this._layers)this._layers[s]._project()},_updatePaths:function(){for(var s in this._layers)this._layers[s]._update()},_update:function(){var s=this.options.padding,l=this._map.getSize(),f=this._map.containerPointToLayerPoint(l.multiplyBy(-s)).round();this._bounds=new ae(f,f.add(l.multiplyBy(1+s*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Cv=Ei.extend({options:{tolerance:0},getEvents:function(){var s=Ei.prototype.getEvents.call(this);return s.viewprereset=this._onViewPreReset,s},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Ei.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var s=this._container=document.createElement("canvas");Te(s,"mousemove",this._onMouseMove,this),Te(s,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Te(s,"mouseout",this._handleMouseOut,this),s._leaflet_disable_events=!0,this._ctx=s.getContext("2d")},_destroyContainer:function(){U(this._redrawRequest),delete this._ctx,$e(this._container),rt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var s;this._redrawBounds=null;for(var l in this._layers)s=this._layers[l],s._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Ei.prototype._update.call(this);var s=this._bounds,l=this._container,f=s.getSize(),m=pe.retina?2:1;Ce(l,s.min),l.width=m*f.x,l.height=m*f.y,l.style.width=f.x+"px",l.style.height=f.y+"px",pe.retina&&this._ctx.scale(2,2),this._ctx.translate(-s.min.x,-s.min.y),this.fire("update")}},_reset:function(){Ei.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(s){this._updateDashArray(s),this._layers[d(s)]=s;var l=s._order={layer:s,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=l),this._drawLast=l,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(s){this._requestRedraw(s)},_removePath:function(s){var l=s._order,f=l.next,m=l.prev;f?f.prev=m:this._drawLast=m,m?m.next=f:this._drawFirst=f,delete s._order,delete this._layers[d(s)],this._requestRedraw(s)},_updatePath:function(s){this._extendRedrawBounds(s),s._project(),s._update(),this._requestRedraw(s)},_updateStyle:function(s){this._updateDashArray(s),this._requestRedraw(s)},_updateDashArray:function(s){if(typeof s.options.dashArray=="string"){var l=s.options.dashArray.split(/[, ]+/),f=[],m,y;for(y=0;y<l.length;y++){if(m=Number(l[y]),isNaN(m))return;f.push(m)}s.options._dashArray=f}else s.options._dashArray=s.options.dashArray},_requestRedraw:function(s){this._map&&(this._extendRedrawBounds(s),this._redrawRequest=this._redrawRequest||M(this._redraw,this))},_extendRedrawBounds:function(s){if(s._pxBounds){var l=(s.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new ae,this._redrawBounds.extend(s._pxBounds.min.subtract([l,l])),this._redrawBounds.extend(s._pxBounds.max.add([l,l]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var s=this._redrawBounds;if(s){var l=s.getSize();this._ctx.clearRect(s.min.x,s.min.y,l.x,l.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var s,l=this._redrawBounds;if(this._ctx.save(),l){var f=l.getSize();this._ctx.beginPath(),this._ctx.rect(l.min.x,l.min.y,f.x,f.y),this._ctx.clip()}this._drawing=!0;for(var m=this._drawFirst;m;m=m.next)s=m.layer,(!l||s._pxBounds&&s._pxBounds.intersects(l))&&s._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(s,l){if(this._drawing){var f,m,y,b,V=s._parts,$=V.length,Z=this._ctx;if($){for(Z.beginPath(),f=0;f<$;f++){for(m=0,y=V[f].length;m<y;m++)b=V[f][m],Z[m?"lineTo":"moveTo"](b.x,b.y);l&&Z.closePath()}this._fillStroke(Z,s)}}},_updateCircle:function(s){if(!(!this._drawing||s._empty())){var l=s._point,f=this._ctx,m=Math.max(Math.round(s._radius),1),y=(Math.max(Math.round(s._radiusY),1)||m)/m;y!==1&&(f.save(),f.scale(1,y)),f.beginPath(),f.arc(l.x,l.y/y,m,0,Math.PI*2,!1),y!==1&&f.restore(),this._fillStroke(f,s)}},_fillStroke:function(s,l){var f=l.options;f.fill&&(s.globalAlpha=f.fillOpacity,s.fillStyle=f.fillColor||f.color,s.fill(f.fillRule||"evenodd")),f.stroke&&f.weight!==0&&(s.setLineDash&&s.setLineDash(l.options&&l.options._dashArray||[]),s.globalAlpha=f.opacity,s.lineWidth=f.weight,s.strokeStyle=f.color,s.lineCap=f.lineCap,s.lineJoin=f.lineJoin,s.stroke())},_onClick:function(s){for(var l=this._map.mouseEventToLayerPoint(s),f,m,y=this._drawFirst;y;y=y.next)f=y.layer,f.options.interactive&&f._containsPoint(l)&&(!(s.type==="click"||s.type==="preclick")||!this._map._draggableMoved(f))&&(m=f);this._fireEvent(m?[m]:!1,s)},_onMouseMove:function(s){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var l=this._map.mouseEventToLayerPoint(s);this._handleMouseHover(s,l)}},_handleMouseOut:function(s){var l=this._hoveredLayer;l&&(pt(this._container,"leaflet-interactive"),this._fireEvent([l],s,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(s,l){if(!this._mouseHoverThrottled){for(var f,m,y=this._drawFirst;y;y=y.next)f=y.layer,f.options.interactive&&f._containsPoint(l)&&(m=f);m!==this._hoveredLayer&&(this._handleMouseOut(s),m&&(Ae(this._container,"leaflet-interactive"),this._fireEvent([m],s,"mouseover"),this._hoveredLayer=m)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,s),this._mouseHoverThrottled=!0,setTimeout(a(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(s,l,f){this._map._fireDOMEvent(l,f||l.type,s)},_bringToFront:function(s){var l=s._order;if(l){var f=l.next,m=l.prev;if(f)f.prev=m;else return;m?m.next=f:f&&(this._drawFirst=f),l.prev=this._drawLast,this._drawLast.next=l,l.next=null,this._drawLast=l,this._requestRedraw(s)}},_bringToBack:function(s){var l=s._order;if(l){var f=l.next,m=l.prev;if(m)m.next=f;else return;f?f.prev=m:m&&(this._drawLast=m),l.prev=null,l.next=this._drawFirst,this._drawFirst.prev=l,this._drawFirst=l,this._requestRedraw(s)}}});function Nv(s){return pe.canvas?new Cv(s):null}var au=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(s){return document.createElement("<lvml:"+s+' class="lvml">')}}catch{}return function(s){return document.createElement("<"+s+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),qP={_initContainer:function(){this._container=Re("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Ei.prototype._update.call(this),this.fire("update"))},_initPath:function(s){var l=s._container=au("shape");Ae(l,"leaflet-vml-shape "+(this.options.className||"")),l.coordsize="1 1",s._path=au("path"),l.appendChild(s._path),this._updateStyle(s),this._layers[d(s)]=s},_addPath:function(s){var l=s._container;this._container.appendChild(l),s.options.interactive&&s.addInteractiveTarget(l)},_removePath:function(s){var l=s._container;$e(l),s.removeInteractiveTarget(l),delete this._layers[d(s)]},_updateStyle:function(s){var l=s._stroke,f=s._fill,m=s.options,y=s._container;y.stroked=!!m.stroke,y.filled=!!m.fill,m.stroke?(l||(l=s._stroke=au("stroke")),y.appendChild(l),l.weight=m.weight+"px",l.color=m.color,l.opacity=m.opacity,m.dashArray?l.dashStyle=N(m.dashArray)?m.dashArray.join(" "):m.dashArray.replace(/( *, *)/g," "):l.dashStyle="",l.endcap=m.lineCap.replace("butt","flat"),l.joinstyle=m.lineJoin):l&&(y.removeChild(l),s._stroke=null),m.fill?(f||(f=s._fill=au("fill")),y.appendChild(f),f.color=m.fillColor||m.color,f.opacity=m.fillOpacity):f&&(y.removeChild(f),s._fill=null)},_updateCircle:function(s){var l=s._point.round(),f=Math.round(s._radius),m=Math.round(s._radiusY||f);this._setPath(s,s._empty()?"M0 0":"AL "+l.x+","+l.y+" "+f+","+m+" 0,"+65535*360)},_setPath:function(s,l){s._path.v=l},_bringToFront:function(s){Er(s._container)},_bringToBack:function(s){qr(s._container)}},xh=pe.vml?au:Yi,lu=Ei.extend({_initContainer:function(){this._container=xh("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=xh("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){$e(this._container),rt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Ei.prototype._update.call(this);var s=this._bounds,l=s.getSize(),f=this._container;(!this._svgSize||!this._svgSize.equals(l))&&(this._svgSize=l,f.setAttribute("width",l.x),f.setAttribute("height",l.y)),Ce(f,s.min),f.setAttribute("viewBox",[s.min.x,s.min.y,l.x,l.y].join(" ")),this.fire("update")}},_initPath:function(s){var l=s._path=xh("path");s.options.className&&Ae(l,s.options.className),s.options.interactive&&Ae(l,"leaflet-interactive"),this._updateStyle(s),this._layers[d(s)]=s},_addPath:function(s){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(s._path),s.addInteractiveTarget(s._path)},_removePath:function(s){$e(s._path),s.removeInteractiveTarget(s._path),delete this._layers[d(s)]},_updatePath:function(s){s._project(),s._update()},_updateStyle:function(s){var l=s._path,f=s.options;l&&(f.stroke?(l.setAttribute("stroke",f.color),l.setAttribute("stroke-opacity",f.opacity),l.setAttribute("stroke-width",f.weight),l.setAttribute("stroke-linecap",f.lineCap),l.setAttribute("stroke-linejoin",f.lineJoin),f.dashArray?l.setAttribute("stroke-dasharray",f.dashArray):l.removeAttribute("stroke-dasharray"),f.dashOffset?l.setAttribute("stroke-dashoffset",f.dashOffset):l.removeAttribute("stroke-dashoffset")):l.setAttribute("stroke","none"),f.fill?(l.setAttribute("fill",f.fillColor||f.color),l.setAttribute("fill-opacity",f.fillOpacity),l.setAttribute("fill-rule",f.fillRule||"evenodd")):l.setAttribute("fill","none"))},_updatePoly:function(s,l){this._setPath(s,Ji(s._parts,l))},_updateCircle:function(s){var l=s._point,f=Math.max(Math.round(s._radius),1),m=Math.max(Math.round(s._radiusY),1)||f,y="a"+f+","+m+" 0 1,0 ",b=s._empty()?"M0 0":"M"+(l.x-f)+","+l.y+y+f*2+",0 "+y+-f*2+",0 ";this._setPath(s,b)},_setPath:function(s,l){s._path.setAttribute("d",l)},_bringToFront:function(s){Er(s._path)},_bringToBack:function(s){qr(s._path)}});pe.vml&&lu.include(qP);function Rv(s){return pe.svg||pe.vml?new lu(s):null}Fe.include({getRenderer:function(s){var l=s.options.renderer||this._getPaneRenderer(s.options.pane)||this.options.renderer||this._renderer;return l||(l=this._renderer=this._createRenderer()),this.hasLayer(l)||this.addLayer(l),l},_getPaneRenderer:function(s){if(s==="overlayPane"||s===void 0)return!1;var l=this._paneRenderers[s];return l===void 0&&(l=this._createRenderer({pane:s}),this._paneRenderers[s]=l),l},_createRenderer:function(s){return this.options.preferCanvas&&Nv(s)||Rv(s)}});var Lv=Ca.extend({initialize:function(s,l){Ca.prototype.initialize.call(this,this._boundsToLatLngs(s),l)},setBounds:function(s){return this.setLatLngs(this._boundsToLatLngs(s))},_boundsToLatLngs:function(s){return s=ke(s),[s.getSouthWest(),s.getNorthWest(),s.getNorthEast(),s.getSouthEast()]}});function $P(s,l){return new Lv(s,l)}lu.create=xh,lu.pointsToPath=Ji,Ti.geometryToLayer=ph,Ti.coordsToLatLng=Tp,Ti.coordsToLatLngs=mh,Ti.latLngToCoords=Ep,Ti.latLngsToCoords=gh,Ti.getFeature=Na,Ti.asFeature=_h,Fe.mergeOptions({boxZoom:!0});var Dv=Hn.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane,this._resetStateTimeout=0,s.on("unload",this._destroy,this)},addHooks:function(){Te(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){rt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){$e(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(s){if(!s.shiftKey||s.which!==1&&s.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Ir(),Hl(),this._startPoint=this._map.mouseEventToContainerPoint(s),Te(document,{contextmenu:$n,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(s){this._moved||(this._moved=!0,this._box=Re("div","leaflet-zoom-box",this._container),Ae(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(s);var l=new ae(this._point,this._startPoint),f=l.getSize();Ce(this._box,l.min),this._box.style.width=f.x+"px",this._box.style.height=f.y+"px"},_finish:function(){this._moved&&($e(this._box),pt(this._container,"leaflet-crosshair")),kr(),Wl(),rt(document,{contextmenu:$n,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(s){if(!(s.which!==1&&s.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(a(this._resetState,this),0);var l=new _e(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(l).fire("boxzoomend",{boxZoomBounds:l})}},_onKeyDown:function(s){s.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Fe.addInitHook("addHandler","boxZoom",Dv),Fe.mergeOptions({doubleClickZoom:!0});var jv=Hn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(s){var l=this._map,f=l.getZoom(),m=l.options.zoomDelta,y=s.originalEvent.shiftKey?f-m:f+m;l.options.doubleClickZoom==="center"?l.setZoom(y):l.setZoomAround(s.containerPoint,y)}});Fe.addInitHook("addHandler","doubleClickZoom",jv),Fe.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Mv=Hn.extend({addHooks:function(){if(!this._draggable){var s=this._map;this._draggable=new Sr(s._mapPane,s._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),s.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),s.on("zoomend",this._onZoomEnd,this),s.whenReady(this._onZoomEnd,this))}Ae(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){pt(this._map._container,"leaflet-grab"),pt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var s=this._map;if(s._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var l=ke(this._map.options.maxBounds);this._offsetLimit=ce(this._map.latLngToContainerPoint(l.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(l.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;s.fire("movestart").fire("dragstart"),s.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(s){if(this._map.options.inertia){var l=this._lastTime=+new Date,f=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(f),this._times.push(l),this._prunePositions(l)}this._map.fire("move",s).fire("drag",s)},_prunePositions:function(s){for(;this._positions.length>1&&s-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var s=this._map.getSize().divideBy(2),l=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=l.subtract(s).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(s,l){return s-(s-l)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var s=this._draggable._newPos.subtract(this._draggable._startPos),l=this._offsetLimit;s.x<l.min.x&&(s.x=this._viscousLimit(s.x,l.min.x)),s.y<l.min.y&&(s.y=this._viscousLimit(s.y,l.min.y)),s.x>l.max.x&&(s.x=this._viscousLimit(s.x,l.max.x)),s.y>l.max.y&&(s.y=this._viscousLimit(s.y,l.max.y)),this._draggable._newPos=this._draggable._startPos.add(s)}},_onPreDragWrap:function(){var s=this._worldWidth,l=Math.round(s/2),f=this._initialWorldOffset,m=this._draggable._newPos.x,y=(m-l+f)%s+l-f,b=(m+l+f)%s-l-f,V=Math.abs(y+f)<Math.abs(b+f)?y:b;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=V},_onDragEnd:function(s){var l=this._map,f=l.options,m=!f.inertia||s.noInertia||this._times.length<2;if(l.fire("dragend",s),m)l.fire("moveend");else{this._prunePositions(+new Date);var y=this._lastPos.subtract(this._positions[0]),b=(this._lastTime-this._times[0])/1e3,V=f.easeLinearity,$=y.multiplyBy(V/b),Z=$.distanceTo([0,0]),ee=Math.min(f.inertiaMaxSpeed,Z),ue=$.multiplyBy(ee/Z),Ee=ee/(f.inertiaDeceleration*V),Oe=ue.multiplyBy(-Ee/2).round();!Oe.x&&!Oe.y?l.fire("moveend"):(Oe=l._limitOffset(Oe,l.options.maxBounds),M(function(){l.panBy(Oe,{duration:Ee,easeLinearity:V,noMoveStart:!0,animate:!0})}))}}});Fe.addInitHook("addHandler","dragging",Mv),Fe.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Ov=Hn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(s){this._map=s,this._setPanDelta(s.options.keyboardPanDelta),this._setZoomDelta(s.options.zoomDelta)},addHooks:function(){var s=this._map._container;s.tabIndex<=0&&(s.tabIndex="0"),Te(s,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),rt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var s=document.body,l=document.documentElement,f=s.scrollTop||l.scrollTop,m=s.scrollLeft||l.scrollLeft;this._map._container.focus(),window.scrollTo(m,f)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(s){var l=this._panKeys={},f=this.keyCodes,m,y;for(m=0,y=f.left.length;m<y;m++)l[f.left[m]]=[-1*s,0];for(m=0,y=f.right.length;m<y;m++)l[f.right[m]]=[s,0];for(m=0,y=f.down.length;m<y;m++)l[f.down[m]]=[0,s];for(m=0,y=f.up.length;m<y;m++)l[f.up[m]]=[0,-1*s]},_setZoomDelta:function(s){var l=this._zoomKeys={},f=this.keyCodes,m,y;for(m=0,y=f.zoomIn.length;m<y;m++)l[f.zoomIn[m]]=s;for(m=0,y=f.zoomOut.length;m<y;m++)l[f.zoomOut[m]]=-s},_addHooks:function(){Te(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){rt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(s){if(!(s.altKey||s.ctrlKey||s.metaKey)){var l=s.keyCode,f=this._map,m;if(l in this._panKeys){if(!f._panAnim||!f._panAnim._inProgress)if(m=this._panKeys[l],s.shiftKey&&(m=J(m).multiplyBy(3)),f.options.maxBounds&&(m=f._limitOffset(J(m),f.options.maxBounds)),f.options.worldCopyJump){var y=f.wrapLatLng(f.unproject(f.project(f.getCenter()).add(m)));f.panTo(y)}else f.panBy(m)}else if(l in this._zoomKeys)f.setZoom(f.getZoom()+(s.shiftKey?3:1)*this._zoomKeys[l]);else if(l===27&&f._popup&&f._popup.options.closeOnEscapeKey)f.closePopup();else return;$n(s)}}});Fe.addInitHook("addHandler","keyboard",Ov),Fe.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Vv=Hn.extend({addHooks:function(){Te(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){rt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(s){var l=sh(s),f=this._map.options.wheelDebounceTime;this._delta+=l,this._lastMousePos=this._map.mouseEventToContainerPoint(s),this._startTime||(this._startTime=+new Date);var m=Math.max(f-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(a(this._performZoom,this),m),$n(s)},_performZoom:function(){var s=this._map,l=s.getZoom(),f=this._map.options.zoomSnap||0;s._stop();var m=this._delta/(this._map.options.wheelPxPerZoomLevel*4),y=4*Math.log(2/(1+Math.exp(-Math.abs(m))))/Math.LN2,b=f?Math.ceil(y/f)*f:y,V=s._limitZoom(l+(this._delta>0?b:-b))-l;this._delta=0,this._startTime=null,V&&(s.options.scrollWheelZoom==="center"?s.setZoom(l+V):s.setZoomAround(this._lastMousePos,l+V))}});Fe.addInitHook("addHandler","scrollWheelZoom",Vv);var HP=600;Fe.mergeOptions({tapHold:pe.touchNative&&pe.safari&&pe.mobile,tapTolerance:15});var Fv=Hn.extend({addHooks:function(){Te(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){rt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(s){if(clearTimeout(this._holdTimeout),s.touches.length===1){var l=s.touches[0];this._startPos=this._newPos=new K(l.clientX,l.clientY),this._holdTimeout=setTimeout(a(function(){this._cancel(),this._isTapValid()&&(Te(document,"touchend",xt),Te(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",l))},this),HP),Te(document,"touchend touchcancel contextmenu",this._cancel,this),Te(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function s(){rt(document,"touchend",xt),rt(document,"touchend touchcancel",s)},_cancel:function(){clearTimeout(this._holdTimeout),rt(document,"touchend touchcancel contextmenu",this._cancel,this),rt(document,"touchmove",this._onMove,this)},_onMove:function(s){var l=s.touches[0];this._newPos=new K(l.clientX,l.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(s,l){var f=new MouseEvent(s,{bubbles:!0,cancelable:!0,view:window,screenX:l.screenX,screenY:l.screenY,clientX:l.clientX,clientY:l.clientY});f._simulated=!0,l.target.dispatchEvent(f)}});Fe.addInitHook("addHandler","tapHold",Fv),Fe.mergeOptions({touchZoom:pe.touch,bounceAtZoomLimits:!0});var Uv=Hn.extend({addHooks:function(){Ae(this._map._container,"leaflet-touch-zoom"),Te(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){pt(this._map._container,"leaflet-touch-zoom"),rt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(s){var l=this._map;if(!(!s.touches||s.touches.length!==2||l._animatingZoom||this._zooming)){var f=l.mouseEventToContainerPoint(s.touches[0]),m=l.mouseEventToContainerPoint(s.touches[1]);this._centerPoint=l.getSize()._divideBy(2),this._startLatLng=l.containerPointToLatLng(this._centerPoint),l.options.touchZoom!=="center"&&(this._pinchStartLatLng=l.containerPointToLatLng(f.add(m)._divideBy(2))),this._startDist=f.distanceTo(m),this._startZoom=l.getZoom(),this._moved=!1,this._zooming=!0,l._stop(),Te(document,"touchmove",this._onTouchMove,this),Te(document,"touchend touchcancel",this._onTouchEnd,this),xt(s)}},_onTouchMove:function(s){if(!(!s.touches||s.touches.length!==2||!this._zooming)){var l=this._map,f=l.mouseEventToContainerPoint(s.touches[0]),m=l.mouseEventToContainerPoint(s.touches[1]),y=f.distanceTo(m)/this._startDist;if(this._zoom=l.getScaleZoom(y,this._startZoom),!l.options.bounceAtZoomLimits&&(this._zoom<l.getMinZoom()&&y<1||this._zoom>l.getMaxZoom()&&y>1)&&(this._zoom=l._limitZoom(this._zoom)),l.options.touchZoom==="center"){if(this._center=this._startLatLng,y===1)return}else{var b=f._add(m)._divideBy(2)._subtract(this._centerPoint);if(y===1&&b.x===0&&b.y===0)return;this._center=l.unproject(l.project(this._pinchStartLatLng,this._zoom).subtract(b),this._zoom)}this._moved||(l._moveStart(!0,!1),this._moved=!0),U(this._animRequest);var V=a(l._move,l,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=M(V,this,!0),xt(s)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,U(this._animRequest),rt(document,"touchmove",this._onTouchMove,this),rt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Fe.addInitHook("addHandler","touchZoom",Uv),Fe.BoxZoom=Dv,Fe.DoubleClickZoom=jv,Fe.Drag=Mv,Fe.Keyboard=Ov,Fe.ScrollWheelZoom=Vv,Fe.TapHold=Fv,Fe.TouchZoom=Uv,n.Bounds=ae,n.Browser=pe,n.CRS=at,n.Canvas=Cv,n.Circle=bp,n.CircleMarker=fh,n.Class=we,n.Control=Nn,n.DivIcon=Sv,n.DivOverlay=Gr,n.DomEvent=oh,n.DomUtil=rh,n.Draggable=Sr,n.Evented=tt,n.FeatureGroup=Dt,n.GeoJSON=Ti,n.GridLayer=ou,n.Handler=Hn,n.Icon=Wr,n.ImageOverlay=yh,n.LatLng=Se,n.LatLngBounds=_e,n.Layer=it,n.LayerGroup=bt,n.LineUtil=E,n.Map=Fe,n.Marker=dh,n.Mixin=vo,n.Path=_s,n.Point=K,n.PolyUtil=Sa,n.Polygon=Ca,n.Polyline=bi,n.Popup=vh,n.PosAnimation=Xl,n.Projection=se,n.Rectangle=Lv,n.Renderer=Ei,n.SVG=lu,n.SVGOverlay=kv,n.TileLayer=Ra,n.Tooltip=wh,n.Transformation=Me,n.Util=D,n.VideoOverlay=Iv,n.bind=a,n.bounds=ce,n.canvas=Nv,n.circle=NP,n.circleMarker=CP,n.control=vn,n.divIcon=UP,n.extend=i,n.featureGroup=Aa,n.geoJSON=Ev,n.geoJson=DP,n.gridLayer=BP,n.icon=PP,n.imageOverlay=jP,n.latLng=me,n.latLngBounds=ke,n.layerGroup=gs,n.map=xa,n.marker=AP,n.point=J,n.polygon=LP,n.polyline=RP,n.popup=VP,n.rectangle=$P,n.setOptions=j,n.stamp=d,n.svg=Rv,n.svgOverlay=OP,n.tileLayer=Pv,n.tooltip=FP,n.transformation=ft,n.version=r,n.videoOverlay=MP;var WP=window.L;n.noConflict=function(){return window.L=WP,this},window.L=n})})(Kg,Kg.exports);var nh=Kg.exports;const gv=ob(nh);function _v(t,e,n){return Object.freeze({instance:t,context:e,container:n})}function yv(t,e){return e==null?function(r,i){const o=W.useRef();return o.current||(o.current=t(r,i)),o}:function(r,i){const o=W.useRef();o.current||(o.current=t(r,i));const a=W.useRef(r),{instance:u}=o.current;return W.useEffect(function(){a.current!==r&&(e(u,r,a.current),a.current=r)},[u,r,i]),o}}function Y4(t,e){W.useEffect(function(){return(e.layerContainer??e.map).addLayer(t.instance),function(){var o;(o=e.layerContainer)==null||o.removeLayer(t.instance),e.map.removeLayer(t.instance)}},[e,t])}function vP(t){return function(n){const r=pv(),i=t(mv(n,r),r);return mP(r.map,n.attribution),yP(i.current,n.eventHandlers),Y4(i.current,r),i}}function J4(t,e){const n=yv(t,e),r=vP(n);return G4(r)}function X4(t,e){const n=yv(t),r=Q4(n,e);return K4(r)}function eF(t,e){const n=yv(t,e),r=vP(n);return Z4(r)}function tF(t,e,n){const{opacity:r,zIndex:i}=e;r!=null&&r!==n.opacity&&t.setOpacity(r),i!=null&&i!==n.zIndex&&t.setZIndex(i)}function nF(){return pv().map}function Zg(){return Zg=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Zg.apply(this,arguments)}function rF({bounds:t,boundsOptions:e,center:n,children:r,className:i,id:o,placeholder:a,style:u,whenReady:d,zoom:p,..._},w){const[x]=W.useState({className:i,id:o,style:u}),[k,P]=W.useState(null);W.useImperativeHandle(w,()=>(k==null?void 0:k.map)??null,[k]);const j=W.useCallback(R=>{if(R!==null&&k===null){const S=new nh.Map(R,_);n!=null&&p!=null?S.setView(n,p):t!=null&&S.fitBounds(t,e),d!=null&&S.whenReady(d),P(H4(S))}},[]);W.useEffect(()=>()=>{k==null||k.map.remove()},[k]);const B=k?kd.createElement(_P,{value:k},r):a??null;return kd.createElement("div",Zg({},x,{ref:j}),B)}const iF=W.forwardRef(rF),sF=J4(function({position:e,...n},r){const i=new nh.Marker(e,n);return _v(i,W4(r,{overlayContainer:i}))},function(e,n,r){n.position!==r.position&&e.setLatLng(n.position),n.icon!=null&&n.icon!==r.icon&&e.setIcon(n.icon),n.zIndexOffset!=null&&n.zIndexOffset!==r.zIndexOffset&&e.setZIndexOffset(n.zIndexOffset),n.opacity!=null&&n.opacity!==r.opacity&&e.setOpacity(n.opacity),e.dragging!=null&&n.draggable!==r.draggable&&(n.draggable===!0?e.dragging.enable():e.dragging.disable())}),oF=X4(function(e,n){const r=new nh.Popup(e,n.overlayContainer);return _v(r,n)},function(e,n,{position:r},i){W.useEffect(function(){const{instance:a}=e;function u(p){p.popup===a&&(a.update(),i(!0))}function d(p){p.popup===a&&i(!1)}return n.map.on({popupopen:u,popupclose:d}),n.overlayContainer==null?(r!=null&&a.setLatLng(r),a.openOn(n.map)):n.overlayContainer.bindPopup(a),function(){var _;n.map.off({popupopen:u,popupclose:d}),(_=n.overlayContainer)==null||_.unbindPopup(),n.map.removeLayer(a)}},[e,n,i,r])}),aF=eF(function({url:e,...n},r){const i=new nh.TileLayer(e,mv(n,r));return _v(i,r)},function(e,n,r){tF(e,n,r);const{url:i}=n;i!=null&&i!==r.url&&e.setUrl(i)});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var lF={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uF=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),be=(t,e)=>{const n=W.forwardRef(({color:r="currentColor",size:i=24,strokeWidth:o=2,absoluteStrokeWidth:a,className:u="",children:d,...p},_)=>W.createElement("svg",{ref:_,...lF,width:i,height:i,stroke:r,strokeWidth:a?Number(o)*24/Number(i):o,className:["lucide",`lucide-${uF(t)}`,u].join(" "),...p},[...e.map(([w,x])=>W.createElement(w,x)),...Array.isArray(d)?d:[d]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cF=be("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vv=be("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hF=be("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dF=be("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fF=be("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pF=be("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wP=be("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mF=be("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gF=be("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _F=be("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yF=be("Cookie",[["path",{d:"M12 2a10 10 0 1 0 10 10 4 4 0 0 1-5-5 4 4 0 0 1-5-5",key:"laymnq"}],["path",{d:"M8.5 8.5v.01",key:"ue8clq"}],["path",{d:"M16 15.5v.01",key:"14dtrp"}],["path",{d:"M12 12v.01",key:"u5ubse"}],["path",{d:"M11 17v.01",key:"1hyl5a"}],["path",{d:"M7 14v.01",key:"uct60s"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vF=be("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vc=be("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gp=be("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wF=be("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xF=be("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wv=be("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bF=be("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xP=be("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ed=be("ImagePlus",[["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7",key:"31hg93"}],["line",{x1:"16",x2:"22",y1:"5",y2:"5",key:"ez7e4s"}],["line",{x1:"19",x2:"19",y1:"2",y2:"8",key:"1gkr8c"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Id=be("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fr=be("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tb=be("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xv=be("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bf=be("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bP=be("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TF=be("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EF=be("PartyPopper",[["path",{d:"M5.8 11.3 2 22l10.7-3.79",key:"gwxi1d"}],["path",{d:"M4 3h.01",key:"1vcuye"}],["path",{d:"M22 8h.01",key:"1mrtc2"}],["path",{d:"M15 2h.01",key:"1cjtqr"}],["path",{d:"M22 20h.01",key:"1mrys2"}],["path",{d:"m22 2-2.24.75a2.9 2.9 0 0 0-1.96 3.12v0c.1.86-.57 1.63-1.45 1.63h-.38c-.86 0-1.6.6-1.76 1.44L14 10",key:"bpx1uq"}],["path",{d:"m22 13-.82-.33c-.86-.34-1.82.2-1.98 1.11v0c-.11.7-.72 1.22-1.43 1.22H17",key:"1pd0s7"}],["path",{d:"m11 2 .33.82c.34.86-.2 1.82-1.11 1.98v0C9.52 4.9 9 5.52 9 6.23V7",key:"zq5xbz"}],["path",{d:"M11 13c1.93 1.93 2.83 4.17 2 5-.83.83-3.07-.07-5-2-1.93-1.93-2.83-4.17-2-5 .83-.83 3.07.07 5 2Z",key:"4kbmks"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IF=be("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TP=be("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kF=be("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SF=be("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PF=be("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AF=be("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CF=be("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EP=be("Shirt",[["path",{d:"M20.38 3.46 16 2a4 4 0 0 1-8 0L3.62 3.46a2 2 0 0 0-1.34 2.23l.58 3.47a1 1 0 0 0 .99.84H6v10c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2V10h2.15a1 1 0 0 0 .99-.84l.58-3.47a2 2 0 0 0-1.34-2.23z",key:"1wgbhj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NF=be("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RF=be("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IP=be("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kP=be("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SP=be("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ia=be("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LF=be("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DF=be("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Co=be("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jF=be("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MF=be("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OF=be("Wifi",[["path",{d:"M5 13a10 10 0 0 1 14 0",key:"6v8j51"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _p=be("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VF=be("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);delete gv.Icon.Default.prototype._getIconUrl;gv.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-shadow.png"});const FF=t=>gv.divIcon({className:"custom-marker",html:`<div style="background-color: ${t}; width: 24px; height: 24px; border-radius: 50% 50% 50% 0; transform: rotate(-45deg); border: 2px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.3);"></div>`,iconSize:[24,24],iconAnchor:[12,24],popupAnchor:[0,-24]}),Qh={accommodation:{label:"Accommodation",color:"#3B82F6",icon:xP},costume:{label:"Costume Pickup",color:"#F59E0B",icon:EP},fete:{label:"Fete Location",color:"#EC4899",icon:EF},meetup:{label:"Meetup Spot",color:"#10B981",icon:Co}};function UF({center:t}){const e=nF();return W.useEffect(()=>{t&&e.setView(t,13)},[t,e]),null}function BF(t,e,n,r){const o=(n-t)*Math.PI/180,a=(r-e)*Math.PI/180,u=Math.sin(o/2)*Math.sin(o/2)+Math.cos(t*Math.PI/180)*Math.cos(n*Math.PI/180)*Math.sin(a/2)*Math.sin(a/2);return 6371*(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)))}const nb={trinidad:{center:[10.6918,-61.2225],zoom:11,country:"Trinidad & Tobago"},"stkitts-sugar-mas":{center:[17.3026,-62.7177],zoom:12,country:"St. Kitts"},aruba:{center:[12.5211,-69.9683],zoom:12,country:"Aruba"},"guyana-mashramani":{center:[6.8013,-58.1551],zoom:12,country:"Guyana"},"guyana-independence":{center:[6.8013,-58.1551],zoom:12,country:"Guyana"},jamaica:{center:[18.0179,-76.8099],zoom:11,country:"Jamaica"},stmaarten:{center:[18.0425,-63.0548],zoom:12,country:"St. Maarten"},bahamas:{center:[25.0343,-77.3963],zoom:12,country:"Bahamas"},bermuda:{center:[32.3078,-64.7505],zoom:13,country:"Bermuda"},vincymas:{center:[13.1587,-61.2248],zoom:12,country:"St. Vincent"},antigua:{center:[17.1274,-61.8468],zoom:12,country:"Antigua"},stlucia:{center:[14.0101,-60.987],zoom:11,country:"St. Lucia"},tobago:{center:[11.1889,-60.732],zoom:11,country:"Tobago"},nottinghill:{center:[51.5156,-.205],zoom:14,country:"London, UK"},miami:{center:[25.7617,-80.1918],zoom:11,country:"Miami, FL"}};function zF({locations:t=[],onLocationsChange:e,carnivalName:n,carnivalId:r}){const[i,o]=W.useState(!1),[a,u]=W.useState({name:"",type:"fete",lat:"",lng:""}),[d,p]=W.useState(""),[_,w]=W.useState([]),[x,k]=W.useState(!1),P=t.find(F=>F.type==="accommodation"),j=nb[r]||nb.trinidad,B=W.useMemo(()=>P?[P.lat,P.lng]:t.length>0?[t[0].lat,t[0].lng]:j.center,[t,P,j]),R=async()=>{if(d.trim()){k(!0);try{const I=await(await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(d)}`)).json();w(I.slice(0,5))}catch(F){console.error("Search error:",F)}k(!1)}},S=F=>{u({...a,lat:parseFloat(F.lat),lng:parseFloat(F.lon),name:a.name||F.display_name.split(",")[0]}),w([]),p("")},N=()=>{if(!a.name||!a.lat||!a.lng)return;const F={id:Date.now().toString(),name:a.name,type:a.type,lat:parseFloat(a.lat),lng:parseFloat(a.lng)};e([...t,F]),u({name:"",type:"fete",lat:"",lng:""}),o(!1)},z=F=>{e(t.filter(I=>I.id!==F))},G=F=>{if(!P||F.type==="accommodation")return null;const I=BF(P.lat,P.lng,F.lat,F.lng);return I<1?`${Math.round(I*1e3)}m`:`${I.toFixed(1)}km`};return h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsxs("h3",{className:"text-lg font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[h.jsx(bf,{className:"w-5 h-5 text-purple-500"}),"Fete Map - ",n]}),h.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 ml-7",children:[" ",j.country]})]}),h.jsxs("button",{onClick:()=>o(!i),className:"flex items-center gap-1 px-3 py-1.5 bg-purple-600 text-white text-sm rounded-lg hover:bg-purple-700 transition",children:[h.jsx(TP,{className:"w-4 h-4"}),"Add Pin"]})]}),i&&h.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 space-y-3",children:[h.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[h.jsx("input",{type:"text",placeholder:"Location name",value:a.name,onChange:F=>u({...a,name:F.target.value}),className:"px-3 py-2 border rounded-lg dark:bg-gray-600 dark:border-gray-500 dark:text-white"}),h.jsx("select",{value:a.type,onChange:F=>u({...a,type:F.target.value}),className:"px-3 py-2 border rounded-lg dark:bg-gray-600 dark:border-gray-500 dark:text-white",children:Object.entries(Qh).map(([F,{label:I}])=>h.jsx("option",{value:F,children:I},F))})]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("input",{type:"text",placeholder:"Search for a place...",value:d,onChange:F=>p(F.target.value),onKeyPress:F=>F.key==="Enter"&&R(),className:"flex-1 px-3 py-2 border rounded-lg dark:bg-gray-600 dark:border-gray-500 dark:text-white"}),h.jsx("button",{onClick:R,disabled:x,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:x?"...":"Search"})]}),_.length>0&&h.jsx("ul",{className:"bg-white dark:bg-gray-600 border dark:border-gray-500 rounded-lg max-h-40 overflow-y-auto",children:_.map((F,I)=>h.jsx("li",{onClick:()=>S(F),className:"px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-500 cursor-pointer text-sm truncate dark:text-white",children:F.display_name},I))}),h.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[h.jsx("input",{type:"number",step:"any",placeholder:"Latitude",value:a.lat,onChange:F=>u({...a,lat:F.target.value}),className:"px-3 py-2 border rounded-lg dark:bg-gray-600 dark:border-gray-500 dark:text-white"}),h.jsx("input",{type:"number",step:"any",placeholder:"Longitude",value:a.lng,onChange:F=>u({...a,lng:F.target.value}),className:"px-3 py-2 border rounded-lg dark:bg-gray-600 dark:border-gray-500 dark:text-white"})]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{onClick:N,disabled:!a.name||!a.lat||!a.lng,className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Add Location"}),h.jsx("button",{onClick:()=>o(!1),className:"px-4 py-2 bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-white rounded-lg hover:bg-gray-400",children:"Cancel"})]})]}),h.jsx("div",{className:"h-[400px] rounded-xl overflow-hidden border-2 border-gray-200 dark:border-gray-600",children:h.jsxs(iF,{center:B,zoom:j.zoom,style:{height:"100%",width:"100%"},children:[h.jsx(aF,{attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),h.jsx(UF,{center:B}),t.map(F=>{var I,T;return h.jsx(sF,{position:[F.lat,F.lng],icon:FF(((I=Qh[F.type])==null?void 0:I.color)||"#6B7280"),children:h.jsxs(oF,{children:[h.jsx("div",{className:"font-medium",children:F.name}),h.jsx("div",{className:"text-xs text-gray-500",children:(T=Qh[F.type])==null?void 0:T.label}),G(F)&&h.jsxs("div",{className:"text-xs text-blue-600 flex items-center gap-1 mt-1",children:[h.jsx(TF,{className:"w-3 h-3"}),G(F)," from accommodation"]})]})},F.id)})]})}),t.length>0&&h.jsxs("div",{className:"space-y-2",children:[h.jsx("h4",{className:"text-sm font-semibold text-gray-600 dark:text-gray-300",children:"Saved Locations"}),h.jsx("div",{className:"grid gap-2",children:t.map(F=>{const I=Qh[F.type],T=(I==null?void 0:I.icon)||bf,C=G(F);return h.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{backgroundColor:(I==null?void 0:I.color)||"#6B7280"},children:h.jsx(T,{className:"w-4 h-4 text-white"})}),h.jsxs("div",{children:[h.jsx("div",{className:"font-medium text-gray-800 dark:text-white",children:F.name}),h.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[I==null?void 0:I.label,C&&`  ${C} from stay`]})]})]}),h.jsx("button",{onClick:()=>z(F.id),className:"p-2 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition",children:h.jsx(ia,{className:"w-4 h-4"})})]},F.id)})})]}),!P&&t.length===0&&h.jsxs("div",{className:"text-center py-6 text-gray-500 dark:text-gray-400",children:[h.jsx(xP,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),h.jsx("p",{children:"Start by adding your accommodation location"}),h.jsx("p",{className:"text-sm",children:"Then add fetes, costume pickup, and meetup spots"})]})]})}const Qg={ticket:{label:"Ticket",icon:IP,color:"#F59E0B"},photo:{label:"Photo",icon:Ed,color:"#3B82F6"}};function qF({files:t=[],onFilesChange:e,carnivalName:n,carnivalId:r,userId:i}){const[o,a]=W.useState(!1),[u,d]=W.useState(""),[p,_]=W.useState(null),[w,x]=W.useState("ticket"),[k,P]=W.useState(""),j=W.useRef(null),B=async G=>{const F=G.target.files[0];if(!F)return;const I=10*1024*1024;if(F.size>I){alert("File too large. Maximum size is 10MB.");return}if(!["image/jpeg","image/png","image/gif","image/webp","application/pdf"].includes(F.type)){alert("Invalid file type. Please upload an image (JPG, PNG, GIF, WebP) or PDF.");return}a(!0),d("Uploading...");try{const C=Date.now(),A=F.name.split(".").pop(),M=`users/${i}/carnivals/${r}/${C}.${A}`,U=Dc(Oc,M);await iv(U,F);const D=await sv(U),we={id:C.toString(),name:k||F.name.split(".")[0],type:w,url:D,storagePath:M,originalName:F.name,uploadedAt:new Date().toISOString(),fileType:F.type};e([...t,we]),P(""),d(""),j.current&&(j.current.value="")}catch(C){console.error("Upload error:",C),alert("Failed to upload file. Please try again.")}a(!1)},R=async G=>{if(confirm("Are you sure you want to delete this file?"))try{const F=Dc(Oc,G.storagePath);await qS(F),e(t.filter(I=>I.id!==G.id))}catch(F){console.error("Delete error:",F),e(t.filter(I=>I.id!==G.id))}},S=G=>{const F=document.createElement("a");F.href=G.url,F.download=G.originalName||G.name,F.target="_blank",document.body.appendChild(F),F.click(),document.body.removeChild(F)},N=t.filter(G=>G.type==="ticket"),z=t.filter(G=>G.type==="photo");return h.jsxs("div",{className:"space-y-6",children:[h.jsx("div",{className:"flex items-center justify-between",children:h.jsxs("div",{children:[h.jsxs("h3",{className:"text-xl font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[h.jsx(Ed,{className:"w-5 h-5 text-purple-500"}),"Media Vault"]}),h.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Store your tickets, photos, and important documents for ",n]})]})}),h.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 rounded-xl p-4 border border-purple-100 dark:border-purple-800",children:[h.jsx("h4",{className:"font-semibold text-gray-800 dark:text-white mb-3",children:"Upload New File"}),h.jsxs("div",{className:"grid gap-3",children:[h.jsxs("div",{className:"flex gap-3",children:[h.jsx("input",{type:"text",placeholder:"File label (e.g., 'Tribe Costume Receipt')",value:k,onChange:G=>P(G.target.value),className:"flex-1 px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white"}),h.jsx("select",{value:w,onChange:G=>x(G.target.value),className:"px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white",children:Object.entries(Qg).map(([G,{label:F}])=>h.jsx("option",{value:G,children:F},G))})]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("input",{ref:j,type:"file",accept:"image/*,.pdf",onChange:B,className:"hidden",id:"file-upload"}),h.jsx("label",{htmlFor:"file-upload",className:`flex-1 flex items-center justify-center gap-2 px-4 py-3 border-2 border-dashed rounded-lg cursor-pointer transition ${o?"border-gray-300 bg-gray-50 dark:bg-gray-800 cursor-not-allowed":"border-purple-300 hover:border-purple-500 hover:bg-purple-50 dark:hover:bg-purple-900/20"}`,children:o?h.jsxs(h.Fragment,{children:[h.jsx(Fr,{className:"w-5 h-5 animate-spin text-purple-500"}),h.jsx("span",{className:"text-purple-600 dark:text-purple-400",children:u})]}):h.jsxs(h.Fragment,{children:[h.jsx(LF,{className:"w-5 h-5 text-purple-500"}),h.jsx("span",{className:"text-purple-600 dark:text-purple-400 font-medium",children:"Click to upload image or PDF (max 10MB)"})]})})]})]})]}),N.length>0&&h.jsxs("div",{children:[h.jsxs("h4",{className:"font-semibold text-gray-800 dark:text-white mb-3 flex items-center gap-2",children:[h.jsx(IP,{className:"w-4 h-4 text-yellow-500"}),"Tickets (",N.length,")"]}),h.jsx("div",{className:"grid gap-3",children:N.map(G=>h.jsx($F,{file:G,onView:_,onDownload:S,onDelete:R},G.id))})]}),z.length>0&&h.jsxs("div",{children:[h.jsxs("h4",{className:"font-semibold text-gray-800 dark:text-white mb-3 flex items-center gap-2",children:[h.jsx(Ed,{className:"w-4 h-4 text-blue-500"}),"Photos (",z.length,")"]}),h.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:z.map(G=>h.jsx(HF,{file:G,onView:_,onDownload:S,onDelete:R},G.id))})]}),t.length===0&&h.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[h.jsx(Ed,{className:"w-16 h-16 mx-auto mb-3 opacity-30"}),h.jsx("p",{className:"font-medium",children:"No files uploaded yet"}),h.jsx("p",{className:"text-sm",children:"Upload your tickets, costume receipts, and travel photos"})]}),p&&h.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4",onClick:()=>_(null),children:h.jsxs("div",{className:"relative max-w-4xl max-h-[90vh] w-full",onClick:G=>G.stopPropagation(),children:[h.jsx("button",{onClick:()=>_(null),className:"absolute -top-12 right-0 text-white hover:text-gray-300",children:h.jsx(_p,{className:"w-8 h-8"})}),p.fileType==="application/pdf"?h.jsx("iframe",{src:p.url,className:"w-full h-[80vh] rounded-lg"}):h.jsx("img",{src:p.url,alt:p.name,className:"max-w-full max-h-[80vh] mx-auto rounded-lg"}),h.jsx("p",{className:"text-white text-center mt-4 font-medium",children:p.name})]})})]})}function $F({file:t,onView:e,onDownload:n,onDelete:r}){const i=Qg[t.type]||Qg.ticket,o=i.icon;return h.jsxs("div",{className:"flex items-center justify-between p-3 bg-white dark:bg-gray-700 rounded-lg border border-gray-100 dark:border-gray-600 shadow-sm",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:{backgroundColor:`${i.color}20`},children:h.jsx(o,{className:"w-5 h-5",style:{color:i.color}})}),h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-800 dark:text-white",children:t.name}),h.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:new Date(t.uploadedAt).toLocaleDateString()})]})]}),h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx("button",{onClick:()=>e(t),className:"p-2 text-gray-500 hover:text-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition",children:h.jsx(wv,{className:"w-4 h-4"})}),h.jsx("button",{onClick:()=>n(t),className:"p-2 text-gray-500 hover:text-green-500 hover:bg-green-50 dark:hover:bg-green-900/20 rounded-lg transition",children:h.jsx(gp,{className:"w-4 h-4"})}),h.jsx("button",{onClick:()=>r(t),className:"p-2 text-gray-500 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition",children:h.jsx(ia,{className:"w-4 h-4"})})]})]})}function HF({file:t,onView:e,onDownload:n,onDelete:r}){return h.jsxs("div",{className:"relative group rounded-lg overflow-hidden border border-gray-200 dark:border-gray-600",children:[h.jsx("img",{src:t.url,alt:t.name,className:"w-full h-32 object-cover cursor-pointer",onClick:()=>e(t)}),h.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2",children:[h.jsx("button",{onClick:()=>e(t),className:"p-2 bg-white/20 hover:bg-white/30 rounded-full text-white transition",children:h.jsx(wv,{className:"w-4 h-4"})}),h.jsx("button",{onClick:()=>n(t),className:"p-2 bg-white/20 hover:bg-white/30 rounded-full text-white transition",children:h.jsx(gp,{className:"w-4 h-4"})}),h.jsx("button",{onClick:()=>r(t),className:"p-2 bg-red-500/50 hover:bg-red-500/70 rounded-full text-white transition",children:h.jsx(ia,{className:"w-4 h-4"})})]}),h.jsx("p",{className:"absolute bottom-0 left-0 right-0 bg-black/60 text-white text-xs p-2 truncate",children:t.name})]})}const rb=[{id:"default-fete-map-banner",title:"Unlock Interactive Fete Map",imageUrl:"/images/promo/premium_fete_map_promo_banner.png",placement:"banner",mediaType:"image",linkUrl:null,isDefault:!0},{id:"default-media-vault-banner",title:"Store Your Tickets & Photos",imageUrl:"/images/promo/premium_media_vault_promo_banner.png",placement:"banner",mediaType:"image",linkUrl:null,isDefault:!0},{id:"default-offline-banner",title:"Plan Offline, Anywhere",imageUrl:"/images/promo/premium_offline_mode_promo_banner.png",placement:"banner",mediaType:"image",linkUrl:null,isDefault:!0},{id:"default-premium-banner",title:"Go Premium - Ad Free Experience",imageUrl:"/images/promo/premium_subscription_promo_banner.png",placement:"banner",mediaType:"image",linkUrl:null,isDefault:!0},{id:"default-fete-map-inline",title:"Unlock Interactive Fete Map",imageUrl:"/images/promo/premium_fete_map_promo_banner.png",placement:"inline",mediaType:"image",linkUrl:null,isDefault:!0},{id:"default-media-vault-inline",title:"Store Your Tickets & Photos",imageUrl:"/images/promo/premium_media_vault_promo_banner.png",placement:"inline",mediaType:"image",linkUrl:null,isDefault:!0},{id:"default-offline-inline",title:"Plan Offline, Anywhere",imageUrl:"/images/promo/premium_offline_mode_promo_banner.png",placement:"inline",mediaType:"image",linkUrl:null,isDefault:!0},{id:"default-premium-inline",title:"Go Premium - Ad Free Experience",imageUrl:"/images/promo/premium_subscription_promo_banner.png",placement:"inline",mediaType:"image",linkUrl:null,isDefault:!0}];function Yh({placement:t="banner",className:e="",onUpgradeClick:n}){const[r,i]=W.useState([]),[o,a]=W.useState(0),[u,d]=W.useState(!1),[p,_]=W.useState(!0),[w,x]=W.useState(null);if(W.useEffect(()=>{_(!0),x(null);const S=Dr(st,"promoAds"),N=_S(S,PM("active","==",!0)),z=Lc(N,G=>{const F=[];G.forEach(T=>{F.push({id:T.id,...T.data()})});const I=F.filter(T=>T.placement===t);if(I.length>0)i(I);else{const T=rb.filter(C=>C.placement===t);i(T)}a(0),_(!1)},G=>{console.error(`PromoAd [${t}] error:`,G);const F=rb.filter(I=>I.placement===t);i(F),x(null),_(!1)});return()=>z()},[t]),W.useEffect(()=>{if(r.length<=1)return;const S=setInterval(()=>{a(N=>(N+1)%r.length)},8e3);return()=>clearInterval(S)},[r.length]),p||u||r.length===0)return null;const k=Math.min(o,r.length-1),P=r[k];if(!P||!P.imageUrl)return null;const j=P.mediaType==="video",B=P.isDefault,R=()=>{B&&n?n():P.linkUrl&&window.open(P.linkUrl,"_blank","noopener,noreferrer")};return h.jsx("div",{className:`p-4 relative ${e}`,children:h.jsxs("div",{onClick:R,className:`relative overflow-hidden rounded-lg shadow-md ${P.linkUrl||B?"cursor-pointer hover:shadow-lg transition-shadow":""}`,children:[j?h.jsx("video",{src:P.imageUrl,className:"w-full h-auto object-cover",style:{maxHeight:t==="banner"?"120px":"250px"},autoPlay:!0,muted:!0,loop:!0,playsInline:!0,onError:S=>console.error("Video load error:",S)}):h.jsx("img",{src:P.imageUrl,alt:P.title||"Promotion",className:"w-full h-auto object-cover",style:{maxHeight:t==="banner"?"120px":"250px"},onError:S=>{console.error("Image load error:",P.imageUrl),S.target.style.display="none"}}),P.title&&h.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/70 to-transparent p-3",children:[h.jsx("p",{className:"text-white text-sm font-bold truncate",children:P.title}),B&&h.jsx("p",{className:"text-yellow-300 text-xs font-medium",children:"Tap to upgrade to Premium"})]}),h.jsx("div",{className:"absolute top-1 left-1 bg-black/50 text-white text-[10px] px-1.5 py-0.5 rounded",children:B?"PREMIUM":"AD"}),h.jsx("button",{onClick:S=>{S.stopPropagation(),d(!0)},className:"absolute top-1 right-1 p-1 bg-black/50 hover:bg-black/70 text-white rounded-full transition",children:h.jsx(_p,{className:"w-3 h-3"})}),r.length>1&&h.jsx("div",{className:"absolute bottom-2 right-2 flex gap-1",children:r.map((S,N)=>h.jsx("div",{className:`w-1.5 h-1.5 rounded-full transition ${N===o?"bg-white":"bg-white/50"}`},N))})]})})}const ib=[{id:"banner",label:"Top Banner"},{id:"sidebar",label:"Sidebar"},{id:"inline",label:"Inline (Between Sections)"}];function WF(){const[t,e]=W.useState([]),[n,r]=W.useState(!1),[i,o]=W.useState(""),[a,u]=W.useState(!1),[d,p]=W.useState({title:"",linkUrl:"",placement:"banner"}),_=W.useRef(null);W.useEffect(()=>{const P=Dr(st,"promoAds"),j=Lc(P,B=>{const R=[];B.forEach(S=>{R.push({id:S.id,...S.data()})}),R.sort((S,N)=>(N.createdAt||0)-(S.createdAt||0)),e(R)});return()=>j()},[]);const w=async P=>{const j=P.target.files[0];if(!j)return;const B=j.type.startsWith("video/"),R=B?10*1024*1024:5*1024*1024;if(j.size>R){alert(`File too large. Maximum size is ${B?"10MB for videos":"5MB for images"}.`);return}const S=["image/jpeg","image/png","image/gif","image/webp"],N=["video/mp4","video/webm"];if(![...S,...N].includes(j.type)){alert("Invalid file type. Please upload JPG, PNG, GIF, WebP, MP4, or WebM.");return}r(!0),o("Preparing upload...");const G=setTimeout(()=>{r(!1),o(""),alert("Upload timed out after 60 seconds. Please check your connection and try again."),_.current&&(_.current.value="")},6e4);try{const F=Date.now(),I=j.name.split(".").pop(),T=`promoAds/${F}.${I}`,C=Dc(Oc,T);o("Uploading to storage..."),console.log("Uploading file to Storage...",T),await iv(C,j),o("Getting download URL...");const A=await sv(C);console.log("File uploaded, URL:",A);const M=j.type.startsWith("video/"),U={title:d.title||"",linkUrl:d.linkUrl||"",placement:d.placement,imageUrl:A,mediaType:M?"video":"image",storagePath:T,active:!0,createdAt:F};o("Saving ad data..."),console.log("Saving ad metadata to Firestore...",U);const D=await ES(Dr(st,"promoAds"),U);console.log("Ad saved to Firestore successfully, ID:",D.id),clearTimeout(G),alert("Ad uploaded successfully!"),p({title:"",linkUrl:"",placement:"banner"}),u(!1),_.current&&(_.current.value="")}catch(F){clearTimeout(G),console.error("Upload error:",F),console.error("Error code:",F.code),console.error("Error message:",F.message),console.error("Full error:",JSON.stringify(F,null,2)),F.code==="storage/unauthorized"?alert("Upload failed: You do not have permission to upload ads. Make sure you are logged in with the admin account (djkrss1@gmail.com)."):F.code==="storage/canceled"?alert("Upload was cancelled."):F.code==="permission-denied"?alert("Firestore permission denied: You do not have permission to save ad metadata. Make sure you are logged in with the admin account (djkrss1@gmail.com)."):alert(`Failed to upload ad: ${F.code||"Unknown error"} - ${F.message||"Please try again."}`)}r(!1),o("")},x=async P=>{try{await bS(Jt(st,"promoAds",P.id),{active:!P.active})}catch(j){console.error("Toggle error:",j)}},k=async P=>{if(confirm("Delete this ad?"))try{if(P.storagePath){const j=Dc(Oc,P.storagePath);await qS(j).catch(()=>{})}await TS(Jt(st,"promoAds",P.id))}catch(j){console.error("Delete error:",j)}};return h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsxs("h3",{className:"text-xl font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[h.jsx(Id,{className:"w-5 h-5 text-orange-500"}),"Ad Manager"]}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Upload promotional ads and flyers for free users"})]}),h.jsxs("button",{onClick:()=>u(!a),className:"flex items-center gap-1 px-3 py-1.5 bg-orange-600 text-white text-sm rounded-lg hover:bg-orange-700 transition",children:[h.jsx(TP,{className:"w-4 h-4"}),"New Ad"]})]}),a&&h.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/20 rounded-xl p-4 border border-orange-200 dark:border-orange-800 space-y-3",children:[h.jsxs("div",{className:"grid gap-3",children:[h.jsx("input",{type:"text",placeholder:"Ad title (optional)",value:d.title,onChange:P=>p({...d,title:P.target.value}),className:"px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white"}),h.jsx("input",{type:"url",placeholder:"Link URL (optional) - where to go when clicked",value:d.linkUrl,onChange:P=>p({...d,linkUrl:P.target.value}),className:"px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white"}),h.jsx("select",{value:d.placement,onChange:P=>p({...d,placement:P.target.value}),className:"px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white",children:ib.map(P=>h.jsx("option",{value:P.id,children:P.label},P.id))})]}),h.jsx("input",{ref:_,type:"file",accept:"image/*,video/mp4,video/webm",onChange:w,className:"hidden",id:"ad-upload"}),h.jsx("label",{htmlFor:"ad-upload",className:`flex flex-col items-center justify-center gap-2 px-4 py-4 border-2 border-dashed rounded-lg cursor-pointer transition ${n?"border-gray-300 bg-gray-50 cursor-not-allowed":"border-orange-300 hover:border-orange-500 hover:bg-orange-50 dark:hover:bg-orange-900/30"}`,children:n?h.jsxs(h.Fragment,{children:[h.jsx(Fr,{className:"w-5 h-5 animate-spin text-orange-500"}),h.jsx("span",{className:"text-orange-600",children:i||"Uploading..."})]}):h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Id,{className:"w-5 h-5 text-orange-500"}),h.jsx(jF,{className:"w-5 h-5 text-orange-500"})]}),h.jsx("span",{className:"text-orange-600 font-medium",children:"Click to upload image or video"}),h.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Images: max 5MB (1200x300 recommended) | Videos: max 10MB (MP4, WebM)"})]})})]}),t.length>0?h.jsx("div",{className:"space-y-3",children:t.map(P=>{var j;return h.jsxs("div",{className:`flex items-center gap-4 p-3 rounded-lg border transition ${P.active?"bg-white dark:bg-gray-700 border-gray-200 dark:border-gray-600":"bg-gray-100 dark:bg-gray-800 border-gray-200 dark:border-gray-700 opacity-60"}`,children:[P.mediaType==="video"?h.jsx("video",{src:P.imageUrl,className:"w-20 h-14 object-cover rounded",muted:!0}):h.jsx("img",{src:P.imageUrl,alt:P.title||"Ad",className:"w-20 h-14 object-cover rounded"}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("p",{className:"font-medium text-gray-800 dark:text-white truncate",children:P.title||"Untitled Ad"}),h.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[((j=ib.find(B=>B.id===P.placement))==null?void 0:j.label)||P.placement,P.linkUrl&&"  Has link"]})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("button",{onClick:()=>x(P),className:`p-2 rounded-lg transition ${P.active?"text-green-600 hover:bg-green-50":"text-gray-400 hover:bg-gray-100"}`,title:P.active?"Active - Click to disable":"Inactive - Click to enable",children:P.active?h.jsx(SP,{className:"w-5 h-5"}):h.jsx(kP,{className:"w-5 h-5"})}),P.linkUrl&&h.jsx("a",{href:P.linkUrl,target:"_blank",rel:"noopener noreferrer",className:"p-2 text-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition",children:h.jsx(wF,{className:"w-4 h-4"})}),h.jsx("button",{onClick:()=>k(P),className:"p-2 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition",children:h.jsx(ia,{className:"w-4 h-4"})})]})]},P.id)})}):h.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[h.jsx(Id,{className:"w-16 h-16 mx-auto mb-3 opacity-30"}),h.jsx("p",{className:"font-medium",children:"No ads uploaded yet"}),h.jsx("p",{className:"text-sm",children:"Upload flyers and promotions to show to free users"})]})]})}const Eu="carnival-planner-v1",GF=["djkrss1@gmail.com"],KF=Ar(Tn);function ZF(){const[t,e]=W.useState([]),[n,r]=W.useState(!0),[i,o]=W.useState(null),[a,u]=W.useState(""),[d,p]=W.useState(null),[_,w]=W.useState({total:0,premium:0,free:0}),[x,k]=W.useState(!1),[P,j]=W.useState(!1),[B,R]=W.useState(null),[S,N]=W.useState(!1),z=async()=>{N(!0),R("Migrating users from Firebase Auth...");try{const M=await Cr(KF,"migrateAuthUsers")({});R(M.data.message),await F()}catch(A){console.error("Auth migration error:",A),R(`Auth migration failed: ${A.message}`)}N(!1)},G=async()=>{var A,M,U,D,we,De,Pe,tt,K,ie,J,ae,ce,_e,ke,Se;j(!0),R("Starting migration...");try{const me=new Map;let at=[];try{const ct=await bu(Dr(st,"user-activity"));console.log("[Migration] Found",ct.size,"user-activity records"),at.push(`${ct.size} activity records`);for(const nt of ct.docs){const Me=nt.data(),ft=Me.uid;if(ft)if(!me.has(ft))me.set(ft,{createdAt:Me.loginAt,lastLoginAt:Me.loginAt,email:Me.email||null,displayName:Me.displayName||null});else{const Ye=me.get(ft);((M=(A=Me.loginAt)==null?void 0:A.toMillis)==null?void 0:M.call(A))<((D=(U=Ye.createdAt)==null?void 0:U.toMillis)==null?void 0:D.call(U))&&(Ye.createdAt=Me.loginAt),((De=(we=Me.loginAt)==null?void 0:we.toMillis)==null?void 0:De.call(we))>((tt=(Pe=Ye.lastLoginAt)==null?void 0:Pe.toMillis)==null?void 0:tt.call(Pe))&&(Ye.lastLoginAt=Me.loginAt),!Ye.email&&Me.email&&(Ye.email=Me.email),!Ye.displayName&&Me.displayName&&(Ye.displayName=Me.displayName)}}}catch(ct){console.log("[Migration] Could not fetch user-activity:",ct.message)}try{const ct=await bu(Dr(st,"artifacts",Eu,"users"));console.log("[Migration] Found",ct.size,"artifact users"),at.push(`${ct.size} artifact users`);for(const nt of ct.docs){const Me=nt.id,ft=nt.data();me.has(Me)||me.set(Me,{createdAt:ft.createdAt||Ke.now(),lastLoginAt:ft.lastLoginAt||Ke.now(),email:null,displayName:null})}}catch(ct){console.log("[Migration] Could not fetch artifacts:",ct.message)}R(`Found ${me.size} unique users (${at.join(", ")})...`);let en=0;for(const[ct,nt]of me)try{const Me=Jt(st,"users",ct),ft=await nl(Me);if(!ft.exists())await Ks(Me,nt),en++;else{const Ye=ft.data(),_n={};nt.createdAt&&(!Ye.createdAt||((ie=(K=nt.createdAt).toMillis)==null?void 0:ie.call(K))<((ae=(J=Ye.createdAt)==null?void 0:J.toMillis)==null?void 0:ae.call(J)))&&(_n.createdAt=nt.createdAt),nt.lastLoginAt&&(!Ye.lastLoginAt||((_e=(ce=nt.lastLoginAt).toMillis)==null?void 0:_e.call(ce))>((Se=(ke=Ye.lastLoginAt)==null?void 0:ke.toMillis)==null?void 0:Se.call(ke)))&&(_n.lastLoginAt=nt.lastLoginAt),!Ye.email&&nt.email&&(_n.email=nt.email),!Ye.displayName&&nt.displayName&&(_n.displayName=nt.displayName),Object.keys(_n).length>0&&(await Ks(Me,_n,{merge:!0}),en++)}}catch(Me){console.error(`Failed to migrate user ${ct}:`,Me)}R(`Migration complete! Migrated ${en} users.`),await F()}catch(me){console.error("Migration error:",me),R(`Migration failed: ${me.message}`)}j(!1)},F=async()=>{var A,M,U,D,we;r(!0),o(null);try{console.log("[AdminAnalytics] Fetching users...");const De=new Map;try{console.log("[AdminAnalytics] Attempting to fetch users collection...");const K=await bu(Dr(st,"users"));console.log("[AdminAnalytics] SUCCESS: Found",K.size,"user documents in users collection"),K.docs.forEach(ie=>console.log("[AdminAnalytics] User doc:",ie.id,ie.data()));for(const ie of K.docs){const J=ie.id,ae=ie.data();De.set(J,{id:J,createdAt:ae.createdAt,lastLoginAt:ae.lastLoginAt,profile:{email:ae.email||null,displayName:ae.displayName||null},source:"users"})}}catch(K){console.log("[AdminAnalytics] Could not fetch users collection:",K.message)}try{console.log("[AdminAnalytics] Attempting to fetch user-activity collection...");const K=await bu(Dr(st,"user-activity"));console.log("[AdminAnalytics] SUCCESS: Found",K.size,"activity records");for(const ie of K.docs){const J=ie.data(),ae=J.uid;if(ae&&!De.has(ae))De.set(ae,{id:ae,createdAt:J.loginAt||null,lastLoginAt:J.loginAt||null,profile:{email:J.email||null,displayName:J.displayName||null},source:"user-activity"});else if(ae&&De.has(ae)){const ce=De.get(ae);J.loginAt&&(!ce.lastLoginAt||((M=(A=J.loginAt).toMillis)==null?void 0:M.call(A))>((D=(U=ce.lastLoginAt).toMillis)==null?void 0:D.call(U)))&&(ce.lastLoginAt=J.loginAt),!ce.profile.email&&J.email&&(ce.profile.email=J.email)}}}catch(K){console.log("[AdminAnalytics] Could not fetch user-activity collection:",K.message)}try{console.log("[AdminAnalytics] Attempting to fetch artifacts collection...");const K=await bu(Dr(st,"artifacts",Eu,"users"));console.log("[AdminAnalytics] SUCCESS: Found",K.size,"users in artifacts collection");for(const ie of K.docs){const J=ie.id;if(!De.has(J)){const ae=ie.data();De.set(J,{id:J,createdAt:ae.createdAt||null,lastLoginAt:ae.lastLoginAt||null,profile:{email:null,displayName:null},source:"artifacts"})}}}catch(K){console.log("[AdminAnalytics] Could not fetch artifacts collection:",K.message)}const Pe=[];for(const[K,ie]of De){try{const ae=Jt(st,"users",K,"profile","info"),ce=await nl(ae);if(ce.exists()){const _e=ce.data();ie.profile={...ie.profile,..._e,email:_e.email||ie.profile.email,displayName:_e.displayName||ie.profile.displayName}}}catch{}ie.isPremium=!1,ie.carnivalCount=0;try{const ae=Jt(st,"users",K,"apps",Eu),ce=await nl(ae);if(ce.exists()){const _e=ce.data();ie.isPremium=!!_e.premiumActive,_e.selectedCarnivals&&(ie.carnivalCount=Object.keys(_e.selectedCarnivals).length)}}catch{try{const ce=Jt(st,"artifacts",Eu,"users",K),_e=await nl(ce);if(_e.exists()){const ke=_e.data();ie.isPremium=!!ke.premiumActive,ke.selectedCarnivals&&(ie.carnivalCount=Object.keys(ke.selectedCarnivals).length)}}catch{}}const J=((we=ie.profile)==null?void 0:we.email)||"";J&&GF.includes(J.toLowerCase())&&(ie.isPremium=!0,ie.premiumOverride=!0),Pe.push(ie)}console.log("[AdminAnalytics] Total unique users found:",Pe.length),Pe.sort((K,ie)=>{var ce,_e,ke,Se;const J=((_e=(ce=K.createdAt)==null?void 0:ce.toDate)==null?void 0:_e.call(ce))||new Date(0);return(((Se=(ke=ie.createdAt)==null?void 0:ke.toDate)==null?void 0:Se.call(ke))||new Date(0))-J}),e(Pe);const tt=Pe.filter(K=>K.isPremium).length;w({total:Pe.length,premium:tt,free:Pe.length-tt})}catch(De){console.error("Error fetching users:",De),o(De.message||"Failed to fetch users")}r(!1)};W.useEffect(()=>{F()},[]);const I=async()=>{k(!0),await F(),k(!1)},T=async(A,M,U)=>{if(U){alert("This user has premium via email override. Cannot toggle manually.");return}try{const D=Jt(st,"users",A,"apps",Eu);await Ks(D,{premiumActive:!M,premiumUpdatedAt:Ke.now(),premiumUpdatedBy:"admin-manual"},{merge:!0}),e(we=>we.map(De=>De.id===A?{...De,isPremium:!M}:De)),w(we=>({...we,premium:M?we.premium-1:we.premium+1,free:M?we.free+1:we.free-1})),alert(`Premium ${M?"disabled":"enabled"} for user.`)}catch(D){console.error("Error toggling premium:",D),alert("Failed to update premium status: "+D.message)}},C=t.filter(A=>{var we,De;const M=((we=A.profile)==null?void 0:we.email)||A.id,U=((De=A.profile)==null?void 0:De.displayName)||"",D=a.toLowerCase();return M.toLowerCase().includes(D)||U.toLowerCase().includes(D)});return n?h.jsxs("div",{className:"flex items-center justify-center py-12",children:[h.jsx(Fr,{className:"w-8 h-8 animate-spin text-blue-500"}),h.jsx("span",{className:"ml-2 text-gray-500 dark:text-gray-400",children:"Loading user data..."})]}):i?h.jsxs("div",{className:"text-center py-12",children:[h.jsx("p",{className:"text-red-500 mb-4",children:i}),h.jsx("button",{onClick:I,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Try Again"})]}):h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsxs("h3",{className:"text-xl font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[h.jsx(Co,{className:"w-5 h-5 text-blue-500"}),"User Analytics"]}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"View and manage registered users"})]}),h.jsxs("div",{className:"flex gap-2 flex-wrap",children:[h.jsxs("button",{onClick:z,disabled:S,className:"flex items-center gap-1 px-3 py-1.5 bg-purple-600 text-white text-sm rounded-lg hover:bg-purple-700 transition disabled:opacity-50",children:[S?h.jsx(Fr,{className:"w-4 h-4 animate-spin"}):h.jsx(gp,{className:"w-4 h-4"}),"Migrate Auth Users"]}),h.jsxs("button",{onClick:G,disabled:P,className:"flex items-center gap-1 px-3 py-1.5 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700 transition disabled:opacity-50",children:[P?h.jsx(Fr,{className:"w-4 h-4 animate-spin"}):h.jsx(Co,{className:"w-4 h-4"}),"Migrate Data"]}),h.jsxs("button",{onClick:I,disabled:x,className:"flex items-center gap-1 px-3 py-1.5 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 transition disabled:opacity-50",children:[h.jsx(kF,{className:`w-4 h-4 ${x?"animate-spin":""}`}),"Refresh"]})]})]}),B&&h.jsx("div",{className:`p-3 rounded-lg text-sm ${B.includes("failed")?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400"}`,children:B}),h.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[h.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl p-4 text-white",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[h.jsx(Co,{className:"w-5 h-5 opacity-80"}),h.jsx("span",{className:"text-sm font-medium opacity-80",children:"Total Users"})]}),h.jsx("p",{className:"text-3xl font-bold",children:_.total})]}),h.jsxs("div",{className:"bg-gradient-to-br from-yellow-500 to-orange-500 rounded-xl p-4 text-white",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[h.jsx(Vc,{className:"w-5 h-5 opacity-80"}),h.jsx("span",{className:"text-sm font-medium opacity-80",children:"Premium"})]}),h.jsx("p",{className:"text-3xl font-bold",children:_.premium})]}),h.jsxs("div",{className:"bg-gradient-to-br from-gray-500 to-gray-600 rounded-xl p-4 text-white",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[h.jsx(Co,{className:"w-5 h-5 opacity-80"}),h.jsx("span",{className:"text-sm font-medium opacity-80",children:"Free"})]}),h.jsx("p",{className:"text-3xl font-bold",children:_.free})]})]}),h.jsxs("div",{className:"relative",children:[h.jsx(PF,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),h.jsx("input",{type:"text",placeholder:"Search by email or name...",value:a,onChange:A=>u(A.target.value),className:"w-full pl-10 pr-4 py-3 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white"})]}),h.jsx("div",{className:"space-y-2",children:C.length===0?h.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:a?"No users match your search":"No users found"}):C.map(A=>{var M,U,D,we;return h.jsxs("div",{className:"bg-white dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600 overflow-hidden",children:[h.jsxs("div",{className:"flex items-center gap-3 p-3 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-600",onClick:()=>p(d===A.id?null:A.id),children:[(M=A.profile)!=null&&M.avatarUrl?h.jsx("img",{src:A.profile.avatarUrl,alt:"",className:"w-10 h-10 rounded-full object-cover"}):h.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-200 dark:bg-gray-500 flex items-center justify-center",children:h.jsx(Co,{className:"w-5 h-5 text-gray-400 dark:text-gray-300"})}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("p",{className:"font-medium text-gray-800 dark:text-white truncate",children:((U=A.profile)==null?void 0:U.displayName)||"No name"}),A.isPremium&&h.jsxs("span",{className:`px-1.5 py-0.5 text-xs rounded-full flex items-center gap-1 ${A.premiumOverride?"bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-400":"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400"}`,children:[h.jsx(Vc,{className:"w-3 h-3"}),A.premiumOverride?"Admin":"Premium"]})]}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate",children:((D=A.profile)==null?void 0:D.email)||A.id})]}),h.jsxs("div",{className:"flex items-center gap-3",children:[A.carnivalCount>0&&h.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400 flex items-center gap-1",children:[h.jsx(bf,{className:"w-4 h-4"}),A.carnivalCount," carnival",A.carnivalCount!==1?"s":""]}),d===A.id?h.jsx(_F,{className:"w-5 h-5 text-gray-400"}):h.jsx(wP,{className:"w-5 h-5 text-gray-400"})]})]}),d===A.id&&h.jsxs("div",{className:"px-4 pb-4 pt-2 border-t border-gray-100 dark:border-gray-600 bg-gray-50 dark:bg-gray-800",children:[h.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"User ID"}),h.jsx("p",{className:"text-sm font-mono text-gray-700 dark:text-gray-300 truncate",children:A.id})]}),h.jsxs("div",{children:[h.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Bio"}),h.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:((we=A.profile)==null?void 0:we.bio)||"No bio"})]})]}),h.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-gray-200 dark:border-gray-600",children:[h.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Premium Status"}),h.jsx("button",{onClick:De=>{De.stopPropagation(),T(A.id,A.isPremium,A.premiumOverride)},className:`flex items-center gap-2 px-3 py-1.5 rounded-lg transition ${A.isPremium?"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"}`,children:A.isPremium?h.jsxs(h.Fragment,{children:[h.jsx(SP,{className:"w-5 h-5"}),h.jsx("span",{children:"Premium Active"})]}):h.jsxs(h.Fragment,{children:[h.jsx(kP,{className:"w-5 h-5"}),h.jsx("span",{children:"Free User"})]})})]})]})]},A.id)})}),h.jsxs("p",{className:"text-xs text-gray-400 dark:text-gray-500 text-center",children:["Showing ",C.length," of ",t.length," users"]})]})}const bs=[{name:"Sugar Mas (St. Kitts)",color:"from-green-500 to-emerald-500",month:"January"},{name:"St. Croix",color:"from-yellow-500 to-amber-500",month:"January"},{name:"Trinidad",color:"from-red-500 to-pink-500",month:"February"},{name:"Dominica",color:"from-lime-500 to-green-500",month:"February"},{name:"Jamaica",color:"from-green-500 to-yellow-500",month:"April"},{name:"Tampa Bay",color:"from-blue-500 to-cyan-500",month:"April"},{name:"St. Maarten",color:"from-orange-500 to-yellow-500",month:"April"},{name:"Cayman Batabano",color:"from-teal-500 to-cyan-500",month:"May"},{name:"St. Thomas",color:"from-indigo-500 to-blue-500",month:"May"},{name:"Guyana",color:"from-green-600 to-yellow-500",month:"May"},{name:"Bahamas",color:"from-sky-500 to-blue-500",month:"June"},{name:"Bermuda",color:"from-pink-400 to-rose-500",month:"June"},{name:"Caymas",color:"from-cyan-500 to-teal-500",month:"June"},{name:"St. Vincent (Vincy Mas)",color:"from-blue-500 to-green-500",month:"July"},{name:"St. Lucia",color:"from-blue-400 to-cyan-400",month:"July"},{name:"Toronto (Caribana)",color:"from-red-500 to-amber-500",month:"August"},{name:"Barbados Crop Over",color:"from-amber-500 to-yellow-500",month:"August"},{name:"Antigua",color:"from-orange-500 to-red-500",month:"August"},{name:"Nevis Culturama",color:"from-purple-500 to-pink-500",month:"August"},{name:"Grenada Spicemas",color:"from-green-500 to-red-500",month:"August"},{name:"Notting Hill",color:"from-purple-500 to-indigo-500",month:"August"},{name:"New York",color:"from-blue-600 to-purple-500",month:"September"},{name:"Japan Caribbean",color:"from-rose-500 to-pink-500",month:"September"},{name:"Miami",color:"from-pink-500 to-purple-500",month:"October"},{name:"Tobago",color:"from-red-600 to-orange-500",month:"November"}],QF=[{icon:MF,title:"Budget Planner",desc:"Track every dollar of your carnival spend"},{icon:EP,title:"Costume Tracker",desc:"Band, section & payment tracking"},{icon:hF,title:"Event Scheduler",desc:"Curated fetes + your custom events"},{icon:Co,title:"Squad Coordination",desc:"Share plans with your crew via code"},{icon:pF,title:"Packing List",desc:"Never forget your essentials"},{icon:VF,title:"Road Ready Mode",desc:"Quick-glance view for carnival day"}],YF=[{icon:bf,title:"Interactive Fete Map",desc:"Pin accommodations, fetes, costume pickups & meetup spots with distance calculations"},{icon:Id,title:"Media Vault",desc:"Upload tickets, photos & documents for each carnival"},{icon:OF,title:"Offline Mode",desc:"Access your plans without internet"},{icon:Vc,title:"Ad-Free Experience",desc:"No promotional interruptions"}];function JF({onGetStarted:t,logo:e,onLegalPage:n}){const[r,i]=W.useState(0),[o,a]=W.useState(0),u=W.useRef(null),[d,p]=W.useState(!0);W.useEffect(()=>{const k=()=>i(window.scrollY);return window.addEventListener("scroll",k),()=>window.removeEventListener("scroll",k)},[]),W.useEffect(()=>{if(!d)return;const k=setInterval(()=>{a(P=>(P+1)%bs.length)},3e3);return()=>clearInterval(k)},[d]),W.useEffect(()=>{if(u.current){const P=o*208-u.current.offsetWidth/2+104;u.current.scrollTo({left:P,behavior:"smooth"})}},[o]);const _=()=>{p(!1),a(k=>(k-1+bs.length)%bs.length)},w=()=>{p(!1),a(k=>(k+1)%bs.length)},x=k=>{p(!1),a(k)};return h.jsxs("div",{className:"min-h-screen bg-slate-950 text-white overflow-x-hidden",children:[h.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[h.jsx("div",{className:"absolute w-[800px] h-[800px] bg-gradient-to-r from-pink-500/30 to-purple-500/30 rounded-full blur-3xl",style:{top:-200+r*.1,right:-200,transform:`rotate(${r*.02}deg)`}}),h.jsx("div",{className:"absolute w-[600px] h-[600px] bg-gradient-to-r from-yellow-500/20 to-orange-500/20 rounded-full blur-3xl",style:{bottom:-100+r*.05,left:-100}}),h.jsx("div",{className:"absolute w-[500px] h-[500px] bg-gradient-to-r from-cyan-500/15 to-blue-500/15 rounded-full blur-3xl",style:{top:"40%",left:"50%",transform:`translate(-50%, -50%) scale(${1+r*5e-4})`}})]}),h.jsxs("section",{className:"relative min-h-screen flex flex-col items-center justify-center px-6",children:[h.jsxs("div",{className:"text-center max-w-4xl mx-auto",children:[h.jsxs("div",{className:"mb-8 relative inline-block",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-pink-500 via-purple-500 to-yellow-500 rounded-3xl blur-2xl opacity-60 animate-pulse scale-110"}),h.jsx("img",{src:e,alt:"Carnival Planner",className:"relative w-32 h-32 md:w-40 md:h-40 rounded-3xl shadow-2xl border-2 border-white/20"})]}),h.jsxs("h1",{className:"text-5xl md:text-7xl font-black mb-6 leading-tight",children:[h.jsx("span",{className:"bg-gradient-to-r from-white via-pink-200 to-white bg-clip-text text-transparent",children:"Plan Your"}),h.jsx("br",{}),h.jsx("span",{className:"bg-gradient-to-r from-pink-400 via-yellow-300 to-orange-400 bg-clip-text text-transparent",children:"Perfect Carnival"})]}),h.jsxs("p",{className:"text-xl md:text-2xl text-gray-400 mb-12 max-w-2xl mx-auto leading-relaxed",children:["The ultimate planning companion for ",h.jsx("span",{className:"text-white font-semibold",children:"25+ Caribbean carnivals"}),". Budget, schedule, squad coordination  all in one place."]}),h.jsx("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mb-16",children:h.jsxs("button",{onClick:t,className:"group relative px-10 py-5 bg-gradient-to-r from-pink-500 via-red-500 to-yellow-500 rounded-2xl font-bold text-xl shadow-2xl shadow-pink-500/30 hover:shadow-pink-500/50 transition-all duration-300 hover:scale-105 overflow-hidden",children:[h.jsxs("span",{className:"relative z-10 flex items-center justify-center gap-2",children:["Get Started Free",h.jsx(RF,{className:"w-5 h-5"})]}),h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-pink-600 via-red-600 to-yellow-600 opacity-0 group-hover:opacity-100 transition-opacity"})]})}),h.jsxs("p",{className:"text-gray-500 text-sm flex items-center justify-center gap-2",children:[h.jsx(Vc,{className:"w-4 h-4 text-yellow-500"}),"Free forever for core features. Premium available for power users."]})]}),h.jsx("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 animate-bounce",children:h.jsx(wP,{className:"w-8 h-8 text-gray-500"})})]}),h.jsx("section",{className:"relative py-24 px-6",children:h.jsxs("div",{className:"max-w-6xl mx-auto",children:[h.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-center mb-4",children:h.jsx("span",{className:"bg-gradient-to-r from-pink-400 to-yellow-400 bg-clip-text text-transparent",children:"25+ Caribbean Carnivals"})}),h.jsx("p",{className:"text-gray-400 text-center mb-12 text-lg",children:"From Trinidad to Miami, we've got your carnival season covered"}),h.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-white/5 backdrop-blur-sm border border-white/10 p-6 md:p-8",children:[h.jsx("button",{onClick:_,className:"absolute left-2 md:left-4 top-1/2 -translate-y-1/2 z-10 w-10 h-10 md:w-12 md:h-12 bg-white/10 hover:bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center transition-all border border-white/20 hover:scale-110","aria-label":"Previous carnival",children:h.jsx(mF,{className:"w-5 h-5 md:w-6 md:h-6 text-white"})}),h.jsx("button",{onClick:w,className:"absolute right-2 md:right-4 top-1/2 -translate-y-1/2 z-10 w-10 h-10 md:w-12 md:h-12 bg-white/10 hover:bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center transition-all border border-white/20 hover:scale-110","aria-label":"Next carnival",children:h.jsx(gF,{className:"w-5 h-5 md:w-6 md:h-6 text-white"})}),h.jsx("div",{ref:u,className:"flex gap-4 overflow-x-auto pb-4 snap-x snap-mandatory scrollbar-hide px-8 md:px-12",style:{scrollbarWidth:"none",msOverflowStyle:"none"},onTouchStart:()=>p(!1),children:bs.map((k,P)=>h.jsxs("div",{onClick:()=>x(P),className:`flex-shrink-0 w-44 md:w-48 h-28 md:h-32 rounded-2xl bg-gradient-to-br ${k.color} p-4 flex flex-col justify-between snap-center transition-all duration-500 cursor-pointer ${P===o?"scale-105 shadow-2xl ring-2 ring-white/50":"opacity-60 hover:opacity-80"}`,children:[h.jsx("span",{className:"text-white font-bold text-base md:text-lg drop-shadow-md",children:k.name}),h.jsx("span",{className:"text-white/90 text-sm font-medium",children:k.month})]},k.name))}),h.jsx("div",{className:"flex justify-center items-center gap-1 mt-6 flex-wrap",children:bs.map((k,P)=>h.jsx("button",{onClick:()=>x(P),className:`w-2 h-2 rounded-full transition-all duration-300 ${P===o?"bg-white w-6":"bg-white/30 hover:bg-white/50"}`,"aria-label":`Go to ${bs[P].name}`},P))}),h.jsx("div",{className:"text-center mt-4",children:h.jsxs("span",{className:"text-white/70 text-sm",children:[o+1," of ",bs.length," carnivals"]})})]})]})}),h.jsx("section",{className:"relative py-24 px-6 bg-gradient-to-b from-transparent via-purple-950/30 to-transparent",children:h.jsxs("div",{className:"max-w-6xl mx-auto",children:[h.jsxs("div",{className:"text-center mb-16",children:[h.jsx("span",{className:"inline-block px-4 py-2 bg-green-500/20 text-green-400 rounded-full text-sm font-semibold mb-4",children:"100% FREE"}),h.jsx("h2",{className:"text-3xl md:text-5xl font-bold mb-4",children:"Everything You Need to Plan"}),h.jsx("p",{className:"text-gray-400 text-lg max-w-2xl mx-auto",children:"All core planning features are completely free. No credit card, no trial limits."})]}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:QF.map((k,P)=>h.jsxs("div",{className:"group bg-white/5 backdrop-blur-sm border border-white/10 rounded-2xl p-6 hover:bg-white/10 hover:border-white/20 transition-all duration-300 hover:scale-[1.02]",children:[h.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-green-500/20 to-emerald-500/20 rounded-xl flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:h.jsx(k.icon,{className:"w-7 h-7 text-green-400"})}),h.jsx("h3",{className:"text-xl font-bold mb-2",children:k.title}),h.jsx("p",{className:"text-gray-400",children:k.desc})]},k.title))})]})}),h.jsx("section",{className:"relative py-24 px-6",children:h.jsxs("div",{className:"max-w-6xl mx-auto",children:[h.jsxs("div",{className:"text-center mb-16",children:[h.jsxs("span",{className:"inline-flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-yellow-500/20 to-orange-500/20 text-yellow-400 rounded-full text-sm font-semibold mb-4",children:[h.jsx(Vc,{className:"w-4 h-4"}),"PREMIUM"]}),h.jsx("h2",{className:"text-3xl md:text-5xl font-bold mb-4",children:h.jsx("span",{className:"bg-gradient-to-r from-yellow-400 to-orange-400 bg-clip-text text-transparent",children:"Level Up Your Experience"})}),h.jsx("p",{className:"text-gray-400 text-lg max-w-2xl mx-auto",children:"Unlock powerful features for the ultimate carnival planning experience"})]}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-12",children:YF.map(k=>h.jsxs("div",{className:"group relative bg-gradient-to-br from-yellow-500/10 via-orange-500/5 to-pink-500/10 border border-yellow-500/20 rounded-2xl p-6 hover:border-yellow-500/40 transition-all duration-300",children:[h.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-yellow-500/10 to-transparent rounded-bl-full"}),h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-yellow-500/30 to-orange-500/30 rounded-xl flex items-center justify-center mb-4",children:h.jsx(k.icon,{className:"w-7 h-7 text-yellow-400"})}),h.jsx("h3",{className:"text-xl font-bold mb-2",children:k.title}),h.jsx("p",{className:"text-gray-400",children:k.desc})]})]},k.title))}),h.jsxs("div",{className:"text-center bg-gradient-to-r from-yellow-500/10 via-orange-500/10 to-pink-500/10 border border-yellow-500/20 rounded-3xl p-8",children:[h.jsxs("p",{className:"text-2xl font-bold mb-2",children:[h.jsx("span",{className:"text-yellow-400",children:"$4.99/month"}),h.jsx("span",{className:"text-gray-500 mx-3",children:"or"}),h.jsx("span",{className:"text-yellow-400",children:"$39.99/year"}),h.jsx("span",{className:"text-green-400 text-sm ml-2",children:"(Save 33%)"})]}),h.jsx("p",{className:"text-gray-400",children:"Cancel anytime. No commitments."})]})]})}),h.jsx("section",{className:"relative py-32 px-6",children:h.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[h.jsxs("h2",{className:"text-4xl md:text-6xl font-black mb-6",children:["Ready to Plan Your",h.jsx("br",{}),h.jsx("span",{className:"bg-gradient-to-r from-pink-400 via-yellow-300 to-orange-400 bg-clip-text text-transparent",children:"Best Carnival Yet?"})]}),h.jsx("p",{className:"text-xl text-gray-400 mb-12",children:"Join thousands of carnival enthusiasts planning their perfect experience"}),h.jsxs("button",{onClick:t,className:"group relative px-12 py-6 bg-gradient-to-r from-pink-500 via-red-500 to-yellow-500 rounded-2xl font-bold text-2xl shadow-2xl shadow-pink-500/30 hover:shadow-pink-500/50 transition-all duration-300 hover:scale-105",children:[h.jsx("span",{className:"relative z-10",children:"Start Planning Now"}),h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-pink-600 via-red-600 to-yellow-600 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"})]}),h.jsx("p",{className:"mt-8 text-gray-500",children:"Free to use. Sign in with Google to get started."})]})}),h.jsx("footer",{className:"border-t border-white/10 py-8 px-6",children:h.jsxs("div",{className:"max-w-6xl mx-auto",children:[h.jsxs("div",{className:"flex items-center justify-center gap-2 mb-4",children:[h.jsx("img",{src:e,alt:"Logo",className:"w-8 h-8 rounded-lg"}),h.jsx("span",{className:"font-bold",children:"Carnival Planner"})]}),h.jsx("p",{className:"text-gray-500 text-sm text-center mb-6",children:"Plan your Mas. Track your Fetes. Coordinate your Squad."}),h.jsxs("div",{className:"flex flex-wrap justify-center gap-4 text-sm text-gray-500",children:[h.jsx("button",{onClick:()=>n==null?void 0:n("privacy"),className:"hover:text-white transition-colors",children:"Privacy Policy"}),h.jsx("span",{className:"text-gray-700",children:"|"}),h.jsx("button",{onClick:()=>n==null?void 0:n("terms"),className:"hover:text-white transition-colors",children:"Terms of Service"}),h.jsx("span",{className:"text-gray-700",children:"|"}),h.jsx("button",{onClick:()=>n==null?void 0:n("cookies"),className:"hover:text-white transition-colors",children:"Cookie Policy"}),h.jsx("span",{className:"text-gray-700",children:"|"}),h.jsx("button",{onClick:()=>n==null?void 0:n("refund"),className:"hover:text-white transition-colors",children:"Refund Policy"}),h.jsx("span",{className:"text-gray-700",children:"|"}),h.jsx("button",{onClick:()=>n==null?void 0:n("contact"),className:"hover:text-white transition-colors",children:"Contact Us"})]}),h.jsxs("p",{className:"text-gray-600 text-xs text-center mt-6",children:[" ",new Date().getFullYear()," Carnival Planner. All rights reserved."]})]})})]})}const Rs="Carnival Planner",jn="support@carnival-planner.com",yp="December 12, 2025";function XF({onBack:t,logo:e}){return h.jsxs(vp,{title:"Privacy Policy",icon:CF,onBack:t,logo:e,children:[h.jsxs("p",{className:"text-gray-400 mb-6",children:["Last Updated: ",yp]}),h.jsx(Ve,{title:"1. Introduction",children:h.jsxs("p",{children:[Rs,' ("we," "our," or "us") is committed to protecting your privacy. This Privacy Policy explains how we collect, use, disclose, and safeguard your information when you use our mobile application and website (collectively, the "Service").']})}),h.jsxs(Ve,{title:"2. Information We Collect",children:[h.jsx("h4",{className:"font-semibold text-white mb-2",children:"2.1 Personal Information"}),h.jsx("p",{className:"mb-4",children:"When you sign in with Google, we collect:"}),h.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[h.jsx("li",{children:"Email address"}),h.jsx("li",{children:"Display name"}),h.jsx("li",{children:"Profile picture URL"}),h.jsx("li",{children:"Google account unique identifier"})]}),h.jsx("h4",{className:"font-semibold text-white mb-2",children:"2.2 User-Generated Content"}),h.jsx("p",{className:"mb-4",children:"Information you voluntarily provide includes:"}),h.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[h.jsx("li",{children:"Carnival planning data (budgets, schedules, packing lists)"}),h.jsx("li",{children:"Costume and band information"}),h.jsx("li",{children:"Squad member names and coordination data"}),h.jsx("li",{children:"Uploaded media files (tickets, photos, documents)"}),h.jsx("li",{children:"Map pins and location notes"})]}),h.jsx("h4",{className:"font-semibold text-white mb-2",children:"2.3 Payment Information"}),h.jsx("p",{children:"For premium subscriptions, payment processing is handled securely by Stripe. We do not store your credit card numbers. We receive only transaction confirmation, subscription status, and billing email from Stripe."})]}),h.jsx(Ve,{title:"3. How We Use Your Information",children:h.jsxs("ul",{className:"list-disc list-inside space-y-2",children:[h.jsx("li",{children:"To provide and maintain the Service"}),h.jsx("li",{children:"To authenticate your identity via Google Sign-In"}),h.jsx("li",{children:"To process premium subscription payments via Stripe"}),h.jsx("li",{children:"To sync your carnival planning data across devices"}),h.jsx("li",{children:"To send push notifications for squad alerts (if enabled)"}),h.jsx("li",{children:"To improve and optimize our Service"}),h.jsx("li",{children:"To respond to your inquiries and support requests"})]})}),h.jsxs(Ve,{title:"4. Data Storage and Security",children:[h.jsx("p",{className:"mb-4",children:"Your data is stored using Firebase services provided by Google:"}),h.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[h.jsxs("li",{children:[h.jsx("strong",{children:"Firebase Authentication:"})," Manages secure sign-in"]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Cloud Firestore:"})," Stores your planning data"]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Firebase Storage:"})," Stores uploaded media files"]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Firebase Cloud Messaging:"})," Delivers push notifications"]})]}),h.jsx("p",{children:"We implement industry-standard security measures including encryption in transit (TLS) and at rest. Firebase services are SOC 2 and ISO 27001 certified."})]}),h.jsxs(Ve,{title:"5. Third-Party Services",children:[h.jsx("p",{className:"mb-4",children:"We use the following third-party services:"}),h.jsxs("ul",{className:"list-disc list-inside space-y-2",children:[h.jsxs("li",{children:[h.jsx("strong",{children:"Google (Firebase):"})," Authentication, database, storage, and hosting. ",h.jsx("a",{href:"https://firebase.google.com/support/privacy",className:"text-pink-400 hover:underline",target:"_blank",rel:"noopener noreferrer",children:"Firebase Privacy Policy"})]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Stripe:"})," Payment processing. ",h.jsx("a",{href:"https://stripe.com/privacy",className:"text-pink-400 hover:underline",target:"_blank",rel:"noopener noreferrer",children:"Stripe Privacy Policy"})]}),h.jsxs("li",{children:[h.jsx("strong",{children:"OpenStreetMap:"})," Map tiles for the Fete Map feature. ",h.jsx("a",{href:"https://wiki.osmfoundation.org/wiki/Privacy_Policy",className:"text-pink-400 hover:underline",target:"_blank",rel:"noopener noreferrer",children:"OSM Privacy Policy"})]})]})]}),h.jsxs(Ve,{title:"6. Your Rights (GDPR/CCPA)",children:[h.jsx("p",{className:"mb-4",children:"Depending on your location, you may have the following rights:"}),h.jsxs("ul",{className:"list-disc list-inside space-y-2",children:[h.jsxs("li",{children:[h.jsx("strong",{children:"Access:"})," Request a copy of your personal data"]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Rectification:"})," Correct inaccurate personal data"]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Erasure:"})," Request deletion of your personal data"]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Portability:"})," Receive your data in a portable format"]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Opt-out:"})," Opt out of certain data processing"]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Non-discrimination:"})," We will not discriminate against you for exercising your rights"]})]}),h.jsxs("p",{className:"mt-4",children:["To exercise these rights, contact us at ",h.jsx("a",{href:`mailto:${jn}`,className:"text-pink-400 hover:underline",children:jn}),"."]})]}),h.jsx(Ve,{title:"7. Data Retention",children:h.jsx("p",{children:"We retain your personal data for as long as your account is active. If you delete your account, we will delete your data within 30 days, except where we are legally required to retain it."})}),h.jsx(Ve,{title:"8. Children's Privacy",children:h.jsx("p",{children:"Our Service is not intended for children under 13. We do not knowingly collect personal information from children under 13. If you believe we have collected such information, please contact us immediately."})}),h.jsx(Ve,{title:"9. Changes to This Policy",children:h.jsx("p",{children:'We may update this Privacy Policy from time to time. We will notify you of any changes by posting the new Privacy Policy on this page and updating the "Last Updated" date.'})}),h.jsxs(Ve,{title:"10. Contact Us",children:[h.jsx("p",{children:"If you have questions about this Privacy Policy, please contact us at:"}),h.jsx("p",{className:"mt-2",children:h.jsx("a",{href:`mailto:${jn}`,className:"text-pink-400 hover:underline",children:jn})})]})]})}function e5({onBack:t,logo:e}){return h.jsxs(vp,{title:"Terms of Service",icon:bF,onBack:t,logo:e,children:[h.jsxs("p",{className:"text-gray-400 mb-6",children:["Last Updated: ",yp]}),h.jsx(Ve,{title:"1. Acceptance of Terms",children:h.jsxs("p",{children:["By accessing or using ",Rs,' ("the Service"), you agree to be bound by these Terms of Service. If you do not agree to these terms, please do not use the Service.']})}),h.jsx(Ve,{title:"2. Description of Service",children:h.jsxs("p",{children:[Rs," is a Progressive Web App that helps users plan and organize Caribbean carnival events. The Service includes free features (budget planning, scheduling, squad coordination) and premium subscription features (interactive maps, media vault, offline mode)."]})}),h.jsxs(Ve,{title:"3. User Accounts",children:[h.jsx("h4",{className:"font-semibold text-white mb-2",children:"3.1 Registration"}),h.jsx("p",{className:"mb-4",children:"You must sign in with a valid Google account to use the Service. You are responsible for maintaining the security of your account."}),h.jsx("h4",{className:"font-semibold text-white mb-2",children:"3.2 Account Responsibilities"}),h.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[h.jsx("li",{children:"You must provide accurate information"}),h.jsx("li",{children:"You are responsible for all activities under your account"}),h.jsx("li",{children:"You must notify us immediately of any unauthorized use"})]})]}),h.jsxs(Ve,{title:"4. Premium Subscriptions",children:[h.jsx("h4",{className:"font-semibold text-white mb-2",children:"4.1 Subscription Plans"}),h.jsx("p",{className:"mb-4",children:"We offer monthly ($4.99/month) and yearly ($39.99/year) subscription plans. Prices are subject to change with reasonable notice."}),h.jsx("h4",{className:"font-semibold text-white mb-2",children:"4.2 Billing"}),h.jsx("p",{className:"mb-4",children:"Subscriptions are billed in advance on a recurring basis. Payment is processed through Stripe. Your subscription will automatically renew unless you cancel before the renewal date."}),h.jsx("h4",{className:"font-semibold text-white mb-2",children:"4.3 Cancellation"}),h.jsx("p",{children:"You may cancel your subscription at any time. You will continue to have access to premium features until the end of your current billing period. See our Refund Policy for details."})]}),h.jsxs(Ve,{title:"5. User Content",children:[h.jsx("h4",{className:"font-semibold text-white mb-2",children:"5.1 Your Content"}),h.jsx("p",{className:"mb-4",children:"You retain ownership of all content you upload to the Service (schedules, media, notes). By uploading content, you grant us a limited license to store, display, and process it to provide the Service."}),h.jsx("h4",{className:"font-semibold text-white mb-2",children:"5.2 Content Restrictions"}),h.jsx("p",{className:"mb-2",children:"You agree not to upload content that:"}),h.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[h.jsx("li",{children:"Is illegal, harmful, or offensive"}),h.jsx("li",{children:"Infringes on intellectual property rights"}),h.jsx("li",{children:"Contains malware or malicious code"}),h.jsx("li",{children:"Violates others' privacy"})]})]}),h.jsxs(Ve,{title:"6. Acceptable Use",children:[h.jsx("p",{className:"mb-2",children:"You agree not to:"}),h.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[h.jsx("li",{children:"Use the Service for any unlawful purpose"}),h.jsx("li",{children:"Attempt to gain unauthorized access to our systems"}),h.jsx("li",{children:"Interfere with or disrupt the Service"}),h.jsx("li",{children:"Reverse engineer or decompile the Service"}),h.jsx("li",{children:"Use automated systems to access the Service without permission"})]})]}),h.jsx(Ve,{title:"7. Intellectual Property",children:h.jsxs("p",{children:["The Service, including its design, features, and content (excluding user content), is owned by ",Rs," and protected by intellectual property laws. You may not copy, modify, or distribute our intellectual property without permission."]})}),h.jsx(Ve,{title:"8. Disclaimer of Warranties",children:h.jsx("p",{children:'THE SERVICE IS PROVIDED "AS IS" WITHOUT WARRANTIES OF ANY KIND, EXPRESS OR IMPLIED. WE DO NOT GUARANTEE THAT THE SERVICE WILL BE UNINTERRUPTED, ERROR-FREE, OR SECURE. YOUR USE OF THE SERVICE IS AT YOUR OWN RISK.'})}),h.jsx(Ve,{title:"9. Limitation of Liability",children:h.jsxs("p",{children:["TO THE MAXIMUM EXTENT PERMITTED BY LAW, ",Rs.toUpperCase()," SHALL NOT BE LIABLE FOR ANY INDIRECT, INCIDENTAL, SPECIAL, CONSEQUENTIAL, OR PUNITIVE DAMAGES ARISING FROM YOUR USE OF THE SERVICE, EVEN IF WE HAVE BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES."]})}),h.jsx(Ve,{title:"10. Termination",children:h.jsx("p",{children:"We may terminate or suspend your account at any time for violation of these Terms. You may delete your account at any time. Upon termination, your right to use the Service will immediately cease."})}),h.jsx(Ve,{title:"11. Governing Law",children:h.jsxs("p",{children:["These Terms shall be governed by the laws of the jurisdiction in which ",Rs," operates, without regard to conflict of law principles."]})}),h.jsx(Ve,{title:"12. Changes to Terms",children:h.jsx("p",{children:"We may modify these Terms at any time. We will notify you of significant changes via email or in-app notification. Continued use of the Service after changes constitutes acceptance of the new Terms."})}),h.jsx(Ve,{title:"13. Contact",children:h.jsxs("p",{children:["For questions about these Terms, contact us at ",h.jsx("a",{href:`mailto:${jn}`,className:"text-pink-400 hover:underline",children:jn}),"."]})})]})}function t5({onBack:t,logo:e}){return h.jsxs(vp,{title:"Cookie Policy",icon:yF,onBack:t,logo:e,children:[h.jsxs("p",{className:"text-gray-400 mb-6",children:["Last Updated: ",yp]}),h.jsx(Ve,{title:"1. What Are Cookies",children:h.jsx("p",{children:"Cookies are small text files stored on your device when you visit a website. They help websites remember your preferences and improve your experience."})}),h.jsxs(Ve,{title:"2. How We Use Cookies",children:[h.jsxs("p",{className:"mb-4",children:[Rs," uses cookies and similar technologies for the following purposes:"]}),h.jsx("h4",{className:"font-semibold text-white mb-2",children:"2.1 Essential Cookies (Required)"}),h.jsx("p",{className:"mb-4",children:"These cookies are necessary for the Service to function and cannot be disabled:"}),h.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[h.jsxs("li",{children:[h.jsx("strong",{children:"Firebase Authentication:"})," Maintains your signed-in session securely"]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Session Management:"})," Remembers your authentication state"]})]}),h.jsx("h4",{className:"font-semibold text-white mb-2",children:"2.2 Functional Cookies"}),h.jsx("p",{className:"mb-4",children:"These cookies enhance your experience:"}),h.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[h.jsxs("li",{children:[h.jsx("strong",{children:"Preferences:"})," Remembers your dark mode setting"]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Local Storage:"})," Caches carnival data for offline access (Premium feature)"]})]}),h.jsx("h4",{className:"font-semibold text-white mb-2",children:"2.3 Third-Party Cookies"}),h.jsx("p",{className:"mb-2",children:"Our third-party services may set their own cookies:"}),h.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[h.jsxs("li",{children:[h.jsx("strong",{children:"Firebase/Google:"})," Authentication and analytics"]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Stripe:"})," Payment processing security"]})]})]}),h.jsx(Ve,{title:"3. Cookie Details",children:h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"w-full text-left text-sm mb-4",children:[h.jsx("thead",{children:h.jsxs("tr",{className:"border-b border-gray-700",children:[h.jsx("th",{className:"py-2 pr-4",children:"Cookie Name"}),h.jsx("th",{className:"py-2 pr-4",children:"Purpose"}),h.jsx("th",{className:"py-2 pr-4",children:"Duration"}),h.jsx("th",{className:"py-2",children:"Type"})]})}),h.jsxs("tbody",{className:"text-gray-400",children:[h.jsxs("tr",{className:"border-b border-gray-800",children:[h.jsx("td",{className:"py-2 pr-4",children:"firebase-auth"}),h.jsx("td",{className:"py-2 pr-4",children:"User authentication"}),h.jsx("td",{className:"py-2 pr-4",children:"Session"}),h.jsx("td",{className:"py-2",children:"Essential"})]}),h.jsxs("tr",{className:"border-b border-gray-800",children:[h.jsx("td",{className:"py-2 pr-4",children:"__stripe_mid"}),h.jsx("td",{className:"py-2 pr-4",children:"Fraud prevention"}),h.jsx("td",{className:"py-2 pr-4",children:"1 year"}),h.jsx("td",{className:"py-2",children:"Essential"})]}),h.jsxs("tr",{className:"border-b border-gray-800",children:[h.jsx("td",{className:"py-2 pr-4",children:"darkMode"}),h.jsx("td",{className:"py-2 pr-4",children:"Theme preference"}),h.jsx("td",{className:"py-2 pr-4",children:"Persistent"}),h.jsx("td",{className:"py-2",children:"Functional"})]})]})]})})}),h.jsxs(Ve,{title:"4. Local Storage",children:[h.jsx("p",{className:"mb-4",children:"In addition to cookies, we use browser local storage for:"}),h.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[h.jsx("li",{children:"Caching carnival data for offline access (Premium)"}),h.jsx("li",{children:"Storing FCM tokens for push notifications"}),h.jsx("li",{children:"Temporary UI state"})]})]}),h.jsxs(Ve,{title:"5. Managing Cookies",children:[h.jsx("p",{className:"mb-4",children:"You can manage cookies through your browser settings:"}),h.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[h.jsxs("li",{children:[h.jsx("strong",{children:"Chrome:"})," Settings  Privacy and security  Cookies"]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Firefox:"})," Settings  Privacy & Security  Cookies"]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Safari:"})," Preferences  Privacy  Cookies"]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Edge:"})," Settings  Cookies and site permissions"]})]}),h.jsx("p",{className:"mt-4 text-yellow-400",children:"Note: Disabling essential cookies may prevent you from using the Service."})]}),h.jsx(Ve,{title:"6. Updates to This Policy",children:h.jsx("p",{children:"We may update this Cookie Policy to reflect changes in our practices or for legal reasons. Check this page periodically for updates."})}),h.jsx(Ve,{title:"7. Contact",children:h.jsxs("p",{children:["For questions about our use of cookies, contact us at ",h.jsx("a",{href:`mailto:${jn}`,className:"text-pink-400 hover:underline",children:jn}),"."]})})]})}function n5({onBack:t,logo:e}){return h.jsxs(vp,{title:"Refund Policy",icon:vF,onBack:t,logo:e,children:[h.jsxs("p",{className:"text-gray-400 mb-6",children:["Last Updated: ",yp]}),h.jsx(Ve,{title:"1. Premium Subscription",children:h.jsxs("p",{children:[Rs," offers premium subscriptions at $4.99/month or $39.99/year. This policy explains our refund terms for these subscriptions."]})}),h.jsxs(Ve,{title:"2. Subscription Cancellation",children:[h.jsx("h4",{className:"font-semibold text-white mb-2",children:"2.1 How to Cancel"}),h.jsx("p",{className:"mb-4",children:"You can cancel your subscription at any time by:"}),h.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[h.jsxs("li",{children:["Contacting us at ",h.jsx("a",{href:`mailto:${jn}`,className:"text-pink-400 hover:underline",children:jn})]}),h.jsx("li",{children:"Managing your subscription through Stripe's customer portal (link provided in your confirmation email)"})]}),h.jsx("h4",{className:"font-semibold text-white mb-2",children:"2.2 Effect of Cancellation"}),h.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[h.jsx("li",{children:"Your premium access continues until the end of your current billing period"}),h.jsx("li",{children:"You will not be charged again after cancellation"}),h.jsx("li",{children:"No partial refunds are provided for unused time in the current billing period"})]})]}),h.jsxs(Ve,{title:"3. Refund Eligibility",children:[h.jsx("h4",{className:"font-semibold text-white mb-2",children:"3.1 Eligible for Refund"}),h.jsx("p",{className:"mb-2",children:"We offer refunds in the following situations:"}),h.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[h.jsxs("li",{children:[h.jsx("strong",{children:"Technical Issues:"})," If the Service was unavailable or significantly impaired for an extended period"]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Accidental Purchase:"})," If you accidentally subscribed and request a refund within 48 hours, without using premium features"]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Duplicate Charges:"})," If you were charged multiple times for the same subscription period"]})]}),h.jsx("h4",{className:"font-semibold text-white mb-2",children:"3.2 Not Eligible for Refund"}),h.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[h.jsx("li",{children:"Change of mind after using premium features"}),h.jsx("li",{children:"Requests made after 30 days from the charge date"}),h.jsx("li",{children:"Failure to cancel before renewal (you must cancel before renewal to avoid charges)"}),h.jsx("li",{children:"Issues caused by your device, browser, or internet connection"})]})]}),h.jsxs(Ve,{title:"4. How to Request a Refund",children:[h.jsx("p",{className:"mb-4",children:"To request a refund:"}),h.jsxs("ol",{className:"list-decimal list-inside space-y-2",children:[h.jsxs("li",{children:["Email us at ",h.jsx("a",{href:`mailto:${jn}`,className:"text-pink-400 hover:underline",children:jn})]}),h.jsx("li",{children:"Include your account email and the date of the charge"}),h.jsx("li",{children:"Explain the reason for your refund request"})]}),h.jsx("p",{className:"mt-4",children:"We will review your request and respond within 5 business days."})]}),h.jsxs(Ve,{title:"5. Refund Processing",children:[h.jsx("p",{className:"mb-4",children:"If your refund is approved:"}),h.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[h.jsx("li",{children:"Refunds are processed through Stripe to your original payment method"}),h.jsx("li",{children:"Allow 5-10 business days for the refund to appear on your statement"}),h.jsx("li",{children:"Your premium access will be revoked upon refund"})]})]}),h.jsx(Ve,{title:"6. Free Trial",children:h.jsx("p",{children:"We do not currently offer free trials. All core features are free to use. Premium features require a paid subscription."})}),h.jsx(Ve,{title:"7. Price Changes",children:h.jsx("p",{children:"If we increase subscription prices, existing subscribers will be notified at least 30 days in advance. You may cancel before the new price takes effect to avoid being charged at the higher rate."})}),h.jsx(Ve,{title:"8. Contact",children:h.jsxs("p",{children:["For refund requests or questions about this policy, contact us at ",h.jsx("a",{href:`mailto:${jn}`,className:"text-pink-400 hover:underline",children:jn}),"."]})})]})}function vp({title:t,icon:e,onBack:n,logo:r,children:i}){return h.jsxs("div",{className:"min-h-screen bg-slate-950 text-white",children:[h.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[h.jsx("div",{className:"absolute w-[600px] h-[600px] bg-gradient-to-r from-pink-500/20 to-purple-500/20 rounded-full blur-3xl -top-48 -right-48"}),h.jsx("div",{className:"absolute w-[400px] h-[400px] bg-gradient-to-r from-blue-500/15 to-cyan-500/15 rounded-full blur-3xl bottom-0 left-0"})]}),h.jsxs("div",{className:"relative max-w-4xl mx-auto px-6 py-12",children:[h.jsxs("button",{onClick:n,className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors mb-8",children:[h.jsx(vv,{className:"w-5 h-5"}),"Back"]}),h.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[r&&h.jsx("img",{src:r,alt:"Logo",className:"w-12 h-12 rounded-xl"}),h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-pink-500/30 to-purple-500/30 rounded-xl flex items-center justify-center",children:h.jsx(e,{className:"w-6 h-6 text-pink-400"})}),h.jsx("h1",{className:"text-3xl md:text-4xl font-bold",children:t})]})]}),h.jsx("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 rounded-2xl p-6 md:p-8",children:i}),h.jsx("footer",{className:"mt-12 text-center text-gray-500 text-sm",children:h.jsx("p",{children:"Carnival Planner - Plan your Mas. Track your Fetes. Coordinate your Squad."})})]})]})}function Ve({title:t,children:e}){return h.jsxs("div",{className:"mb-8",children:[h.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:t}),h.jsx("div",{className:"text-gray-300 leading-relaxed",children:e})]})}function r5(){const[t,e]=W.useState(null),[n,r]=W.useState(!1),[i,o]=W.useState(!1),[a,u]=W.useState(!1);W.useEffect(()=>{if(window.matchMedia("(display-mode: standalone)").matches){o(!0);return}const _=localStorage.getItem("pwa-install-dismissed");_&&(Date.now()-parseInt(_))/864e5<7&&u(!0);const w=k=>{k.preventDefault(),e(k),a||r(!0)},x=()=>{o(!0),r(!1),e(null)};return window.addEventListener("beforeinstallprompt",w),window.addEventListener("appinstalled",x),()=>{window.removeEventListener("beforeinstallprompt",w),window.removeEventListener("appinstalled",x)}},[a]);const d=async()=>{if(!t)return;t.prompt();const{outcome:_}=await t.userChoice;_==="accepted"&&o(!0),e(null),r(!1)},p=()=>{r(!1),u(!0),localStorage.setItem("pwa-install-dismissed",Date.now().toString())};return!n||i?null:h.jsx("div",{className:"fixed bottom-20 left-4 right-4 z-40 animate-slideUp md:left-auto md:right-4 md:max-w-sm safe-bottom",children:h.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 rounded-2xl shadow-2xl p-4 text-white",children:[h.jsx("button",{onClick:p,className:"absolute top-2 right-2 p-1 hover:bg-white/20 rounded-full transition-colors",children:h.jsx(_p,{className:"w-5 h-5"})}),h.jsxs("div",{className:"flex items-start gap-4",children:[h.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center flex-shrink-0",children:h.jsx(NF,{className:"w-6 h-6"})}),h.jsxs("div",{className:"flex-1 pr-6",children:[h.jsx("h3",{className:"font-bold text-lg mb-1",children:"Add to Home Screen"}),h.jsx("p",{className:"text-white/80 text-sm mb-3",children:"Install Carnival Planner for quick access and offline use!"}),h.jsxs("button",{onClick:d,className:"flex items-center gap-2 px-4 py-2 bg-white text-purple-600 font-bold rounded-lg hover:bg-gray-100 transition-colors",children:[h.jsx(gp,{className:"w-4 h-4"}),"Install App"]})]})]})]})})}function i5({onBack:t,logo:e,user:n}){const[r,i]=W.useState(""),[o,a]=W.useState(""),[u,d]=W.useState((n==null?void 0:n.email)||""),[p,_]=W.useState(!1),[w,x]=W.useState(!1),[k,P]=W.useState(""),j=async B=>{if(B.preventDefault(),!o.trim()||!u.trim()){P("Please fill in all required fields");return}_(!0),P("");try{await ES(Dr(st,"support-requests"),{email:u.trim(),subject:r.trim()||"General Inquiry",message:o.trim(),userId:(n==null?void 0:n.uid)||null,userName:(n==null?void 0:n.displayName)||null,status:"new",createdAt:Ke.now()}),x(!0),i(""),a("")}catch(R){console.error("Error submitting support request:",R),P("Failed to send message. Please try again.")}finally{_(!1)}};return w?h.jsx("div",{className:"min-h-screen bg-slate-950 text-white flex items-center justify-center p-6",children:h.jsxs("div",{className:"text-center max-w-md",children:[h.jsx("div",{className:"w-20 h-20 bg-green-500/20 rounded-full flex items-center justify-center mx-auto mb-6",children:h.jsx(fF,{className:"w-10 h-10 text-green-400"})}),h.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Message Sent!"}),h.jsx("p",{className:"text-gray-400 mb-8",children:"Thank you for reaching out. We'll get back to you as soon as possible."}),h.jsx("button",{onClick:t,className:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-500 rounded-xl font-bold hover:opacity-90 transition-opacity",children:"Back to App"})]})}):h.jsxs("div",{className:"min-h-screen bg-slate-950 text-white",children:[h.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[h.jsx("div",{className:"absolute w-[600px] h-[600px] bg-gradient-to-r from-pink-500/20 to-purple-500/20 rounded-full blur-3xl -top-48 -right-48"}),h.jsx("div",{className:"absolute w-[400px] h-[400px] bg-gradient-to-r from-blue-500/15 to-cyan-500/15 rounded-full blur-3xl bottom-0 left-0"})]}),h.jsxs("div",{className:"relative max-w-2xl mx-auto px-6 py-12",children:[h.jsxs("button",{onClick:t,className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors mb-8",children:[h.jsx(vv,{className:"w-5 h-5"}),"Back"]}),h.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e&&h.jsx("img",{src:e,alt:"Logo",className:"w-12 h-12 rounded-xl"}),h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-pink-500/30 to-purple-500/30 rounded-xl flex items-center justify-center",children:h.jsx(bP,{className:"w-6 h-6 text-pink-400"})}),h.jsx("h1",{className:"text-3xl md:text-4xl font-bold",children:"Contact Support"})]})]}),h.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 rounded-2xl p-6 md:p-8",children:[h.jsx("p",{className:"text-gray-400 mb-6",children:"Have a question, feedback, or need help? Send us a message and we'll get back to you as soon as possible."}),h.jsxs("form",{onSubmit:j,className:"space-y-6",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email Address *"}),h.jsxs("div",{className:"relative",children:[h.jsx(xv,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),h.jsx("input",{type:"email",value:u,onChange:B=>d(B.target.value),placeholder:"your@email.com",required:!0,className:"w-full pl-10 pr-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:border-pink-500 transition-colors"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Subject"}),h.jsxs("select",{value:r,onChange:B=>i(B.target.value),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white focus:outline-none focus:border-pink-500 transition-colors",children:[h.jsx("option",{value:"",className:"bg-gray-900",children:"Select a topic..."}),h.jsx("option",{value:"General Question",className:"bg-gray-900",children:"General Question"}),h.jsx("option",{value:"Premium Subscription",className:"bg-gray-900",children:"Premium Subscription"}),h.jsx("option",{value:"Technical Issue",className:"bg-gray-900",children:"Technical Issue"}),h.jsx("option",{value:"Feature Request",className:"bg-gray-900",children:"Feature Request"}),h.jsx("option",{value:"Refund Request",className:"bg-gray-900",children:"Refund Request"}),h.jsx("option",{value:"Account Issue",className:"bg-gray-900",children:"Account Issue"}),h.jsx("option",{value:"Other",className:"bg-gray-900",children:"Other"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Message *"}),h.jsx("textarea",{value:o,onChange:B=>a(B.target.value),placeholder:"How can we help you?",required:!0,rows:6,className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:border-pink-500 transition-colors resize-none"})]}),k&&h.jsx("p",{className:"text-red-400 text-sm",children:k}),h.jsx("button",{type:"submit",disabled:p,className:"w-full flex items-center justify-center gap-2 px-6 py-4 bg-gradient-to-r from-pink-500 to-purple-500 rounded-xl font-bold text-lg hover:opacity-90 transition-opacity disabled:opacity-50",children:p?h.jsxs(h.Fragment,{children:[h.jsx(Fr,{className:"w-5 h-5 animate-spin"}),"Sending..."]}):h.jsxs(h.Fragment,{children:[h.jsx(AF,{className:"w-5 h-5"}),"Send Message"]})})]})]}),h.jsxs("p",{className:"text-gray-500 text-sm text-center mt-8",children:["You can also email us directly at"," ",h.jsx("a",{href:"mailto:support@carnival-planner.com",className:"text-pink-400 hover:underline",children:"support@carnival-planner.com"})]})]})]})}function s5(){const[t,e]=W.useState([]),[n,r]=W.useState(!0);W.useEffect(()=>{const o=_S(Dr(st,"support-requests"),AM("createdAt","desc")),a=Lc(o,u=>{const d=u.docs.map(p=>({id:p.id,...p.data()}));e(d),r(!1)});return()=>a()},[]);const i=async o=>{confirm("Delete this support request?")&&await TS(Jt(st,"support-requests",o))};return n?h.jsx("div",{className:"text-center py-8 text-gray-500",children:h.jsx(Fr,{className:"w-6 h-6 animate-spin mx-auto"})}):h.jsxs("div",{className:"mt-6 border-t border-gray-200 dark:border-gray-700 pt-6",children:[h.jsxs("h3",{className:"font-bold text-lg mb-4 text-gray-800 dark:text-white flex items-center gap-2",children:[h.jsx(bP,{className:"w-5 h-5"}),"Support Requests (",t.length,")"]}),t.length===0?h.jsx("p",{className:"text-gray-500 text-center py-4",children:"No support requests yet"}):h.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:t.map(o=>{var a,u;return h.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700",children:[h.jsxs("div",{className:"flex justify-between items-start mb-2",children:[h.jsxs("div",{children:[h.jsx("span",{className:"font-medium text-gray-800 dark:text-white",children:o.email}),h.jsx("span",{className:"mx-2 text-gray-400",children:"|"}),h.jsx("span",{className:"text-sm text-gray-500",children:o.subject||"General"})]}),h.jsx("button",{onClick:()=>i(o.id),className:"p-1 text-gray-400 hover:text-red-500 transition-colors",children:h.jsx(ia,{className:"w-4 h-4"})})]}),h.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm whitespace-pre-wrap",children:o.message}),h.jsx("p",{className:"text-xs text-gray-400 mt-2",children:((u=(a=o.createdAt)==null?void 0:a.toDate)==null?void 0:u.call(a).toLocaleString())||"Unknown date"})]},o.id)})})]})}function o5({user:t,onClose:e}){const[n,r]=W.useState(!1),[i,o]=W.useState(""),[a,u]=W.useState(!1),[d,p]=W.useState(""),[_,w]=W.useState({displayName:"",bio:"",avatarUrl:""}),[x,k]=W.useState(!1),[P,j]=W.useState(!1),[B,R]=W.useState(!1),[S,N]=W.useState(""),z=W.useRef(null);W.useEffect(()=>{if(!t)return;(async()=>{try{const C=Jt(st,"users",t.uid,"profile","info"),A=await nl(C);if(A.exists()){const M=A.data();w({displayName:M.displayName||t.displayName||"",bio:M.bio||"",avatarUrl:M.avatarUrl||t.photoURL||""})}else w({displayName:t.displayName||"",bio:"",avatarUrl:t.photoURL||""})}catch(C){console.log("Could not load profile:",C)}})()},[t]);const G=async()=>{if(t){j(!0),p("");try{const T=Jt(st,"users",t.uid,"profile","info");await Ks(T,{displayName:_.displayName,bio:_.bio,avatarUrl:_.avatarUrl,updatedAt:Ke.now()},{merge:!0}),k(!1),N("Profile saved!"),setTimeout(()=>N(""),3e3)}catch(T){console.error("Error saving profile:",T),p("Could not save profile. Please try again.")}finally{j(!1)}}},F=async T=>{const C=T.target.files[0];if(!C||!t)return;if(C.size>2*1024*1024){p("Image too large. Max 2MB.");return}if(!["image/jpeg","image/png","image/gif","image/webp"].includes(C.type)){p("Please upload a JPG, PNG, GIF, or WebP image.");return}R(!0),p("");try{const M=Date.now(),U=C.name.split(".").pop(),D=`avatars/${t.uid}/${M}.${U}`,we=Dc(Oc,D);await iv(we,C);const De=await sv(we);w(tt=>({...tt,avatarUrl:De}));const Pe=Jt(st,"users",t.uid,"profile","info");await Ks(Pe,{avatarUrl:De,updatedAt:Ke.now()},{merge:!0}),N("Avatar updated!"),setTimeout(()=>N(""),3e3)}catch(M){console.error("Avatar upload error:",M),p("Could not upload avatar. Please try again.")}finally{R(!1),z.current&&(z.current.value="")}},I=async()=>{if(i!=="DELETE"){p("Please type DELETE to confirm");return}u(!0),p("");try{const T=Ar(Tn);await Cr(T,"deleteUserAccount")(),await iI(Ms),window.location.reload()}catch(T){console.error("Error deleting account:",T),p(T.message||"Failed to delete account. Please try again."),u(!1)}};return h.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 border border-gray-200 dark:border-gray-700",children:[h.jsxs("div",{className:"flex justify-between items-center mb-6",children:[h.jsx("h3",{className:"text-lg font-bold text-gray-800 dark:text-white",children:"Account Settings"}),e&&h.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:h.jsx(_p,{className:"w-5 h-5"})})]}),S&&h.jsx("div",{className:"mb-4 p-3 bg-green-100 dark:bg-green-900/30 border border-green-200 dark:border-green-800 rounded-lg text-green-700 dark:text-green-400 text-sm",children:S}),d&&h.jsx("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg text-red-700 dark:text-red-400 text-sm",children:d}),h.jsxs("div",{className:"space-y-6",children:[h.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-xl p-5",children:h.jsxs("div",{className:"flex items-start gap-4",children:[h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"w-20 h-20 rounded-full overflow-hidden bg-gray-200 dark:bg-gray-600 flex items-center justify-center",children:_.avatarUrl?h.jsx("img",{src:_.avatarUrl,alt:"Avatar",className:"w-full h-full object-cover"}):h.jsx(DF,{className:"w-10 h-10 text-gray-400"})}),h.jsx("input",{ref:z,type:"file",accept:"image/*",onChange:F,className:"hidden",id:"avatar-upload"}),h.jsx("label",{htmlFor:"avatar-upload",className:"absolute -bottom-1 -right-1 p-1.5 bg-blue-600 rounded-full text-white cursor-pointer hover:bg-blue-700 transition",children:B?h.jsx(Fr,{className:"w-4 h-4 animate-spin"}):h.jsx(dF,{className:"w-4 h-4"})})]}),h.jsx("div",{className:"flex-1",children:x?h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Display Name"}),h.jsx("input",{type:"text",value:_.displayName,onChange:T=>w(C=>({...C,displayName:T.target.value})),placeholder:"Your name",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",maxLength:50})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Bio"}),h.jsx("textarea",{value:_.bio,onChange:T=>w(C=>({...C,bio:T.target.value})),placeholder:"Tell us about yourself...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm resize-none",rows:3,maxLength:200}),h.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[_.bio.length,"/200"]})]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsxs("button",{onClick:G,disabled:P,className:"flex items-center gap-1.5 px-3 py-1.5 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[P?h.jsx(Fr,{className:"w-4 h-4 animate-spin"}):h.jsx(SF,{className:"w-4 h-4"}),"Save"]}),h.jsx("button",{onClick:()=>k(!1),className:"px-3 py-1.5 bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300 text-sm rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500",children:"Cancel"})]})]}):h.jsxs("div",{children:[h.jsx("h4",{className:"font-bold text-gray-800 dark:text-white mb-1",children:_.displayName||"No name set"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:t==null?void 0:t.email}),_.bio&&h.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-3",children:_.bio}),h.jsxs("button",{onClick:()=>k(!0),className:"flex items-center gap-1.5 px-3 py-1.5 bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 text-sm rounded-lg hover:bg-blue-200 dark:hover:bg-blue-900/50 transition",children:[h.jsx(IF,{className:"w-4 h-4"}),"Edit Profile"]})]})})]})}),h.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-6",children:[h.jsxs("h4",{className:"text-red-600 dark:text-red-400 font-bold mb-2 flex items-center gap-2",children:[h.jsx(cF,{className:"w-5 h-5"}),"Danger Zone"]}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:"Permanently delete your account and all associated data. This action cannot be undone."}),n?h.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-4",children:[h.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mb-3",children:"This will permanently delete:"}),h.jsxs("ul",{className:"text-sm text-red-500 dark:text-red-400 list-disc list-inside mb-4 space-y-1",children:[h.jsx("li",{children:"All your carnival plans and data"}),h.jsx("li",{children:"Uploaded photos and documents"}),h.jsx("li",{children:"Squad memberships"}),h.jsx("li",{children:"Your account and login"})]}),h.jsxs("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Type ",h.jsx("span",{className:"font-mono bg-gray-200 dark:bg-gray-700 px-1 rounded",children:"DELETE"})," to confirm:"]}),h.jsx("input",{type:"text",value:i,onChange:T=>o(T.target.value),placeholder:"Type DELETE",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white mb-3"}),h.jsxs("div",{className:"flex gap-3",children:[h.jsx("button",{onClick:()=>{r(!1),o(""),p("")},disabled:a,className:"flex-1 px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors disabled:opacity-50",children:"Cancel"}),h.jsx("button",{onClick:I,disabled:a||i!=="DELETE",className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50",children:a?h.jsxs(h.Fragment,{children:[h.jsx(Fr,{className:"w-4 h-4 animate-spin"}),"Deleting..."]}):h.jsxs(h.Fragment,{children:[h.jsx(ia,{className:"w-4 h-4"}),"Delete Forever"]})})]})]}):h.jsxs("button",{onClick:()=>r(!0),className:"flex items-center gap-2 px-4 py-2 bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 rounded-lg hover:bg-red-200 dark:hover:bg-red-900/50 transition-colors",children:[h.jsx(ia,{className:"w-4 h-4"}),"Delete My Account"]})]})]})]})}function a5({onBack:t,onSuccess:e}){const[n,r]=W.useState("login"),[i,o]=W.useState(""),[a,u]=W.useState(""),[d,p]=W.useState(""),[_,w]=W.useState(!1),[x,k]=W.useState(!1),[P,j]=W.useState(""),[B,R]=W.useState(""),S=I=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(I),N=I=>{switch(I){case"auth/email-already-in-use":return"This email is already registered. Try logging in instead.";case"auth/invalid-email":return"Please enter a valid email address.";case"auth/weak-password":return"Password should be at least 6 characters.";case"auth/user-not-found":return"No account found with this email.";case"auth/wrong-password":return"Incorrect password. Please try again.";case"auth/invalid-credential":return"Invalid email or password. Please check and try again.";case"auth/too-many-requests":return"Too many attempts. Please try again later.";default:return"Something went wrong. Please try again."}},z=async I=>{if(I.preventDefault(),j(""),R(""),!S(i)){j("Please enter a valid email address.");return}if(a.length<6){j("Password must be at least 6 characters.");return}if(a!==d){j("Passwords do not match.");return}k(!0);try{const T=await tR(Ms,i,a);await rI(T.user),R("Account created! Please check your email to verify your account."),e&&e(T.user)}catch(T){console.error("Sign up error:",T),j(N(T.code))}finally{k(!1)}},G=async I=>{if(I.preventDefault(),j(""),R(""),!S(i)){j("Please enter a valid email address.");return}if(!a){j("Please enter your password.");return}k(!0);try{const T=await nR(Ms,i,a);e&&e(T.user)}catch(T){console.error("Login error:",T),j(N(T.code))}finally{k(!1)}},F=async()=>{if(j(""),R(""),!S(i)){j("Please enter your email address first.");return}k(!0);try{await eR(Ms,i),R("Password reset email sent! Check your inbox.")}catch(I){console.error("Password reset error:",I),j(N(I.code))}finally{k(!1)}};return h.jsxs("div",{className:"w-full max-w-md mx-auto",children:[h.jsxs("button",{onClick:t,className:"flex items-center gap-2 text-gray-400 hover:text-white mb-6 transition-colors",children:[h.jsx(vv,{className:"w-4 h-4"}),"Back"]}),h.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 rounded-2xl p-6",children:[h.jsx("h2",{className:"text-2xl font-bold text-white mb-6 text-center",children:n==="login"?"Welcome Back":"Create Account"}),P&&h.jsx("div",{className:"mb-4 p-3 bg-red-500/20 border border-red-500/30 rounded-lg text-red-300 text-sm",children:P}),B&&h.jsx("div",{className:"mb-4 p-3 bg-green-500/20 border border-green-500/30 rounded-lg text-green-300 text-sm",children:B}),h.jsxs("form",{onSubmit:n==="login"?G:z,className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Email"}),h.jsxs("div",{className:"relative",children:[h.jsx(xv,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),h.jsx("input",{type:"email",value:i,onChange:I=>o(I.target.value),placeholder:"your@email.com",className:"w-full pl-10 pr-4 py-3 bg-gray-900/80 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:border-pink-500 focus:ring-2 focus:ring-pink-500/20 transition-colors",disabled:x})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Password"}),h.jsxs("div",{className:"relative",children:[h.jsx(tb,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),h.jsx("input",{type:_?"text":"password",value:a,onChange:I=>u(I.target.value),placeholder:"Enter your password",className:"w-full pl-10 pr-12 py-3 bg-gray-900/80 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:border-pink-500 focus:ring-2 focus:ring-pink-500/20 transition-colors",disabled:x}),h.jsx("button",{type:"button",onClick:()=>w(!_),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-300",children:_?h.jsx(xF,{className:"w-5 h-5"}):h.jsx(wv,{className:"w-5 h-5"})})]})]}),n==="signup"&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Confirm Password"}),h.jsxs("div",{className:"relative",children:[h.jsx(tb,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),h.jsx("input",{type:_?"text":"password",value:d,onChange:I=>p(I.target.value),placeholder:"Confirm your password",className:"w-full pl-10 pr-4 py-3 bg-gray-900/80 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:border-pink-500 focus:ring-2 focus:ring-pink-500/20 transition-colors",disabled:x})]})]}),n==="login"&&h.jsx("div",{className:"text-right",children:h.jsx("button",{type:"button",onClick:F,className:"text-sm text-pink-400 hover:text-pink-300 transition-colors",disabled:x,children:"Forgot password?"})}),h.jsx("button",{type:"submit",disabled:x,className:"w-full py-3 bg-gradient-to-r from-pink-500 to-orange-500 rounded-xl font-bold text-white hover:opacity-90 transition-opacity disabled:opacity-50 flex items-center justify-center gap-2",children:x?h.jsxs(h.Fragment,{children:[h.jsx(Fr,{className:"w-5 h-5 animate-spin"}),n==="login"?"Signing in...":"Creating account..."]}):n==="login"?"Sign In":"Create Account"})]}),h.jsx("div",{className:"mt-6 text-center",children:h.jsxs("p",{className:"text-gray-400 text-sm",children:[n==="login"?"Don't have an account?":"Already have an account?",h.jsx("button",{onClick:()=>{r(n==="login"?"signup":"login"),j(""),R("")},className:"ml-2 text-pink-400 hover:text-pink-300 font-semibold transition-colors",children:n==="login"?"Sign Up":"Sign In"})]})})]})]})}function l5({user:t,onResend:e}){const[n,r]=W.useState(!1),[i,o]=W.useState(!1);if(!t||t.emailVerified||!t.email)return null;const a=async()=>{r(!0);try{await rI(t),o(!0),setTimeout(()=>o(!1),5e3)}catch(u){console.error("Error sending verification:",u)}finally{r(!1)}};return h.jsxs("div",{className:"bg-yellow-500/20 border border-yellow-500/30 text-yellow-200 px-4 py-3 flex items-center justify-between gap-4 flex-wrap",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(xv,{className:"w-5 h-5"}),h.jsx("span",{className:"text-sm",children:"Please verify your email address to access all features."})]}),h.jsx("button",{onClick:a,disabled:n||i,className:"text-sm font-semibold bg-yellow-500/30 hover:bg-yellow-500/40 px-3 py-1 rounded-lg transition-colors disabled:opacity-50",children:i?"Email Sent!":n?"Sending...":"Resend Email"})]})}const Jh="carnival-planner-v1",u5="price_1SanHUJR9xpdRiXijLesRPVt",c5="price_1SanMhJR9xpdRiXinv2F9knM",sb={trinidad:[{title:"Soca Brainwash",note:"The main event. Bring drinks."},{title:"AM Bush",note:"J'ouvert style. Wear old clothes."},{title:"Phuket",note:"All inclusive."},{title:"Soaka Street Festival",note:"Iron park."}],stlucia:[{title:"Remedy",note:"Beachside."},{title:"Mess",note:"Paint and Powder."},{title:"Indulgence",note:"Breakfast fete."}],default:[{title:"Catamaran Cruise",note:"Boat ride."},{title:"J'ouvert",note:"Paint and powder."},{title:"Monday Mas",note:"On the road."}]};function h5(){var us,cs,go,gi,_i,_o,hs;const[t,e]=W.useState(null),[n,r]=W.useState({}),[i,o]=W.useState(null),[a,u]=W.useState("Budget"),[d,p]=W.useState(!1),[_,w]=W.useState(!0),[x,k]=W.useState(!1),[P,j]=W.useState(!0),[B,R]=W.useState(!1),[S,N]=W.useState(""),[z,G]=W.useState(""),[F,I]=W.useState(""),[T,C]=W.useState(""),[A,M]=W.useState(""),[U,D]=W.useState(""),[we,De]=W.useState(""),[Pe,tt]=W.useState({band:"",section:"",total:"",paid:""}),[K,ie]=W.useState(""),[J,ae]=W.useState(""),[ce,_e]=W.useState([]),[ke,Se]=W.useState(!1),[me,at]=W.useState(!1),[en,ct]=W.useState(""),[nt,Me]=W.useState(""),[ft,Ye]=W.useState(null),[_n,Yi]=W.useState(!0),[Ji,Xi]=W.useState(!1),[oi,zn]=W.useState(null),[es,Br]=W.useState(!1),[uo,wr]=W.useState([]),[co,ho]=W.useState(!1),[yt,Rt]=W.useState(null),ai=[{id:"stkitts-sugar-mas",name:"St. Kitts (Sugar Mas)",monthIndex:0},{id:"stcroix",name:"St. Croix Carnival",monthIndex:0},{id:"trinidad",name:"Trinidad Carnival",monthIndex:1},{id:"dominica",name:"Dominica (Mas Domnik)",monthIndex:1},{id:"jamaica",name:"Jamaica Carnival",monthIndex:3},{id:"tampa",name:"Tampa Bay Carnival",monthIndex:3},{id:"stmaarten",name:"St. Maarten Carnival",monthIndex:3},{id:"cayman-batabano",name:"Cayman Batabano",monthIndex:4},{id:"stthomas",name:"St. Thomas Carnival",monthIndex:4},{id:"guyana",name:"Guyana Independence",monthIndex:4},{id:"bahamas",name:"Bahamas Carnival",monthIndex:5},{id:"bermuda",name:"Bermuda Carnival",monthIndex:5},{id:"hollywood",name:"Hollywood Carnival",monthIndex:5},{id:"caymas",name:"Caymas Carnival",monthIndex:5},{id:"vincymas",name:"St. Vincent (Vincy Mas)",monthIndex:6},{id:"stlucia",name:"St. Lucia Carnival",monthIndex:6},{id:"toronto",name:"Toronto (Caribana)",monthIndex:7},{id:"barbados",name:"Barbados Crop Over",monthIndex:7},{id:"nevis",name:"Nevis Culturama",monthIndex:7},{id:"antigua",name:"Antigua Carnival",monthIndex:7},{id:"grenada",name:"Grenada Spicemas",monthIndex:7},{id:"ny-labor-day",name:"New York Carnival",monthIndex:8},{id:"japan",name:"Japan Caribbean",monthIndex:8},{id:"miami",name:"Miami Carnival",monthIndex:9},{id:"tobago",name:"Tobago Carnival",monthIndex:10}],fo=["bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500","bg-gradient-to-r from-green-400 to-blue-500","bg-gradient-to-r from-yellow-400 via-red-500 to-pink-500","bg-gradient-to-r from-teal-400 to-cyan-500","bg-gradient-to-r from-red-500 via-orange-500 to-yellow-500","bg-gradient-to-r from-purple-600 to-indigo-600"],ts=["January","February","March","April","May","June","July","August","September","October","November","December"];W.useEffect(()=>{P?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[P]),W.useEffect(()=>{if(!t)return;(async()=>{try{const X=Jt(st,"users",t.uid,"preferences","theme"),re=await nl(X);if(re.exists()){const xe=re.data();typeof xe.darkMode=="boolean"&&j(xe.darkMode)}}catch(X){console.log("Could not load theme preference:",X)}})()},[t]);const ha=async O=>{if(t)try{const X=Jt(st,"users",t.uid,"preferences","theme");await Ks(X,{darkMode:O,updatedAt:Ke.now()},{merge:!0})}catch(X){console.log("Could not save theme preference:",X)}},li=()=>{const O=!P;j(O),ha(O)};W.useEffect(()=>{const O=sR(Ms,async X=>{if(e(X),X){console.log("[Analytics] Creating/updating user doc for:",X.uid,X.email);try{const re=Jt(st,"users",X.uid);await Ks(re,{lastLoginAt:Ke.now(),email:X.email||null,displayName:X.displayName||null},{merge:!0}),console.log("[Analytics] User document updated successfully")}catch(re){console.error("[Analytics] Failed to update user doc:",re.code,re.message)}}});return()=>O()},[]),W.useEffect(()=>{if(!t){p(!1);return}const O=["djkrss1@gmail.com","maikacooke@gmail.com"];O.includes(t.email)&&p(!0);const X=Jt(st,"users",t.uid,"apps",Jh),re=Lc(X,xe=>{if(O.includes(t.email)){p(!0);return}if(xe.exists()){const Le=xe.data();p(!!Le.premiumActive)}else p(!1)});return()=>re()},[t]),W.useEffect(()=>{if(!t){r({}),o(null);return}const O=Dr(st,"users",t.uid,"apps",Jh,"carnivals"),X=Lc(O,re=>{const xe={};re.forEach(Le=>{xe[Le.id]=Le.data()}),r(xe),!i&&re.docs.length>0&&o(re.docs[0].id)});return()=>X()},[t]),W.useEffect(()=>{RR(Ms).catch(O=>console.error(O))},[]),W.useEffect(()=>{if(!t)return;(async()=>{try{const re=await B4("BLbW7EjHjQ9_YjKrRbJwgBgRqnkSmZsXMnEWTQZpqYwSRbVgYLmXW5RvXA2_aS3vH9XJpCxHu4VmXnZL2wQxMvI");if(re){const xe=Ar(Tn);await Cr(xe,"saveFcmToken")({fcmToken:re}),console.log("FCM token saved")}}catch(X){console.log("Error setting up notifications:",X)}})(),z4(X=>{var re,xe;console.log("Foreground message:",X),Ye({title:((re=X.notification)==null?void 0:re.title)||"Squad Alert",body:((xe=X.notification)==null?void 0:xe.body)||"Someone in your squad is Road Ready!"}),setTimeout(()=>Ye(null),5e3)})},[t]);const po=async()=>{const O=new Pi;try{await IR(Ms,O)}catch(X){console.error("Sign in error:",X)}},ns=async()=>{await iI(Ms),w(!0),k(!1),u("Budget"),j(!0)},ui=async O=>{if(!t){alert("You must be signed in to subscribe.");return}const X=O==="yearly"?"yearly":"monthly",re=X==="yearly"?c5:u5;R(!0);try{const xe=Ar(Tn),Le=Cr(xe,"createCheckoutSession");console.log(`Starting checkout... Interval: ${X}, PriceID: ${re}`);const vt=await Le({priceId:re,success_url:window.location.origin,cancel_url:window.location.origin}),{data:wt}=vt||{};wt&&(wt.url||wt.checkoutUrl)?window.location.href=wt.url||wt.checkoutUrl:(console.error("No checkout URL returned:",wt),alert("Unable to start checkout. Please try again."))}catch(xe){console.error("Error starting checkout:",xe),alert("There was a problem starting your checkout: "+xe.message)}finally{R(!1)}},zl=async(O,X)=>{if(t&&(o(O),!n[O]))try{const re=Jt(st,"users",t.uid,"apps",Jh,"carnivals",O);await Ks(re,{name:X,budget:[],schedule:[],packing:[],squad:[],costume:null,createdAt:Ke.now()},{merge:!0})}catch(re){console.error(re)}},yn=(us=n[i])==null?void 0:us.sharedPlanId,Lt=!!yn,[An,xr]=W.useState(null),[br,ci]=W.useState(!1),rs=async()=>{if(!yn||!t){xr(null);return}ci(!0);try{const O=Ar(Tn),re=await Cr(O,"getSharedCarnivalData")({planId:yn,uid:t.uid});xr(re.data)}catch(O){console.log("Could not load shared carnival data:",O.message),xr(null)}finally{ci(!1)}};W.useEffect(()=>{yn?rs():xr(null)},[yn,t]);const Be=async(O,X,re="set")=>{var Le;if(!t||!i)return;if(yn&&["budget","schedule","packing","costume","squad"].includes(O))try{const vt=Ar(Tn),Re=await Cr(vt,"updateSharedCarnivalData")({planId:yn,field:O,data:X,action:re,uid:t.uid,userEmail:t.email});(Le=Re.data)!=null&&Le.data&&xr(Re.data.data);return}catch(vt){console.error("Error updating shared data:",vt)}const xe=Jt(st,"users",t.uid,"apps",Jh,"carnivals",i);await bS(xe,{[O]:X})};W.useEffect(()=>{if(!t||!i||!d){wr([]);return}(async()=>{var X;ho(!0);try{const re=Ar(Tn),Le=await Cr(re,"getScrapedEvents")({carnivalId:i});(X=Le.data)!=null&&X.success?(wr(Le.data.events||[]),Rt(Le.data.lastScrapedAt)):(wr([]),Rt(null))}catch(re){console.log("Error fetching scraped events:",re),wr([])}finally{ho(!1)}})()},[t,i,d]);const da=async()=>{var O,X;if(k(!0),d&&_n&&ye){Xi(!0);try{const re=Ar(Tn),Le=await Cr(re,"sendRoadReadyAlert")({carnivalId:i,carnivalName:ye.name,userName:(t==null?void 0:t.displayName)||((O=t==null?void 0:t.email)==null?void 0:O.split("@")[0])||"Squad Member"});((X=Le.data)==null?void 0:X.notified)>0&&(Ye({title:"Squad Notified!",body:`${Le.data.notified} squad member(s) alerted that you're Road Ready!`}),setTimeout(()=>Ye(null),5e3))}catch(re){console.log("Error sending Road Ready alert:",re)}finally{Xi(!1)}}},is=()=>{var X;if(!S.trim()||!z)return;const O={id:Date.now().toString(),name:S.trim(),cost:parseFloat(z)};if(Lt)Be("budget",[O],"add");else{const re=((X=n[i])==null?void 0:X.budget)||[];Be("budget",[...re,O])}N(""),G("")},fa=O=>{var X;if(Lt)Be("budget",{id:O},"remove");else{const re=((X=n[i])==null?void 0:X.budget)||[];Be("budget",re.filter(xe=>xe.id!==O))}},hi=()=>{var X;if(!F.trim()||!T)return;const O={id:Date.now().toString(),title:F.trim(),datetime:T,note:A.trim()};if(Lt)Be("schedule",[O],"add");else{const re=((X=n[i])==null?void 0:X.schedule)||[];Be("schedule",[...re,O])}I(""),C(""),M("")},ss=O=>{var X;if(Lt)Be("schedule",{id:O},"remove");else{const re=((X=n[i])==null?void 0:X.schedule)||[];Be("schedule",re.filter(xe=>xe.id!==O))}},Vt=O=>{var Le;const X=new Date;X.setDate(X.getDate()+1),X.setHours(12,0,0,0);const re=X.toISOString().slice(0,16),xe={id:Date.now().toString(),title:O.title,datetime:re,note:O.note||"Added from curated list"};if(Lt)Be("schedule",[xe],"add");else{const vt=((Le=n[i])==null?void 0:Le.schedule)||[];Be("schedule",[...vt,xe])}},pa=()=>{var X;if(!U.trim())return;const O={id:Date.now().toString(),item:U.trim(),checked:!1};if(Lt)Be("packing",[O],"add");else{const re=((X=n[i])==null?void 0:X.packing)||[];Be("packing",[...re,O])}D("")},di=O=>{var xe;const X=Lt?(An==null?void 0:An.packing)||[]:((xe=n[i])==null?void 0:xe.packing)||[],re=X.find(Le=>Le.id===O);re&&(Lt?Be("packing",{id:O,checked:!re.checked},"update"):Be("packing",X.map(Le=>Le.id===O?{...Le,checked:!Le.checked}:Le)))},fi=O=>{var X;if(Lt)Be("packing",{id:O},"remove");else{const re=((X=n[i])==null?void 0:X.packing)||[];Be("packing",re.filter(xe=>xe.id!==O))}},Cn=()=>{var X;if(!we.trim())return;const O={id:Date.now().toString(),name:we.trim()};if(Lt)Be("squad",[O],"add");else{const re=((X=n[i])==null?void 0:X.squad)||[];Be("squad",[...re,O])}De("")},pe=O=>{var X;if(Lt)Be("squad",{id:O},"remove");else{const re=((X=n[i])==null?void 0:X.squad)||[];Be("squad",re.filter(xe=>xe.id!==O))}},Tr=async()=>{const O=i?n[i]:null;if(!(!i||!O)){Se(!0),ct("");try{const X=Ar(Tn),xe=await Cr(X,"createSquadShareCode")({carnivalId:i,carnivalName:O.name,uid:t.uid});ie(xe.data.shareCode),Be("shareCode",xe.data.shareCode),Be("sharedPlanId",xe.data.planId),Me("Share code created!"),setTimeout(()=>{pi(),Me("")},1e3)}catch(X){console.error("Error creating share code:",X),ct(X.message||"Failed to create share code")}finally{Se(!1)}}};W.useEffect(()=>{const O=i?n[i]:null;O!=null&&O.shareCode?ie(O.shareCode):ie("")},[i,n]);const pi=async()=>{var X;const O=i?n[i]:null;if(!(O!=null&&O.sharedPlanId)||!t){_e([]);return}try{const re=Ar(Tn),Le=await Cr(re,"getSharedPlanData")({planId:O.sharedPlanId,uid:t.uid});(X=Le.data)!=null&&X.members&&_e(Le.data.members)}catch(re){console.log("Could not fetch squad members:",re.message),_e([])}};W.useEffect(()=>{i&&t&&pi()},[i,n,t]);const ma=async()=>{if(!J.trim()||J.length!==6){ct("Please enter a valid 6-character code");return}at(!0),ct("");try{const O=Ar(Tn),re=await Cr(O,"joinSquadByCode")({shareCode:J.toUpperCase(),uid:t.uid,email:t.email});Me(`Joined ${re.data.carnivalName} squad!`),ae(""),re.data.planId&&Be("sharedPlanId",re.data.planId),setTimeout(()=>{pi()},500),setTimeout(()=>Me(""),3e3)}catch(O){console.error("Error joining squad:",O),ct(O.message||"Failed to join squad")}finally{at(!1)}},mi=()=>{K&&(navigator.clipboard.writeText(K),Me("Code copied to clipboard!"),setTimeout(()=>Me(""),2e3))},os=()=>{Be("costume",{...Pe,total:parseFloat(Pe.total)||0,paid:parseFloat(Pe.paid)||0,updatedAt:Date.now()}),alert("Costume details saved!")},as=()=>{if(!ye)return;const O=[];O.push(`CARNIVAL PLANNER: ${ye.name}`),O.push(`==========================================
`),O.push("-- SQUAD --"),(ye.squad||[]).forEach(vt=>O.push(`- ${vt.name}`)),O.push(`
`),O.push("-- COSTUME --"),ye.costume?(O.push(`Band: ${ye.costume.band}`),O.push(`Section: ${ye.costume.section}`),O.push(`Balance Due: $${((ye.costume.total||0)-(ye.costume.paid||0)).toFixed(2)}`)):O.push("No costume details."),O.push(`
`),O.push("-- SCHEDULE --"),(ye.schedule||[]).slice().sort((vt,wt)=>new Date(vt.datetime)-new Date(wt.datetime)).forEach(vt=>O.push(`${new Date(vt.datetime).toLocaleString()} | ${vt.title}`));const re=new Blob([O.join(`
`)],{type:"text/plain"}),xe=URL.createObjectURL(re),Le=document.createElement("a");Le.href=xe,Le.download=`${ye.name.replace(/\s+/g,"_")}_Plan.txt`,Le.click()},qt=i?n[i]:null,ye=qt?{...qt,...Lt&&An?{budget:An.budget||qt.budget||[],schedule:An.schedule||qt.schedule||[],packing:An.packing||qt.packing||[],costume:An.costume||qt.costume,squad:An.squad||qt.squad||[]}:{}}:null,ga=((cs=ye==null?void 0:ye.budget)==null?void 0:cs.reduce((O,X)=>O+(X.cost||0),0))||0,mo=ye!=null&&ye.costume?ye.costume.total-ye.costume.paid:0,ls=ye?sb[i]||sb.default:[];if(oi){const O={onBack:()=>zn(null),logo:Zh};switch(oi){case"privacy":return h.jsx(XF,{...O});case"terms":return h.jsx(e5,{...O});case"cookies":return h.jsx(t5,{...O});case"refund":return h.jsx(n5,{...O});case"contact":return h.jsx(i5,{...O,user:t});default:zn(null)}}if(_&&!t)return h.jsx(JF,{onGetStarted:()=>w(!1),logo:Zh,onLegalPage:zn});if(t&&x&&ye){const O=(ye.schedule||[]).slice().sort((X,re)=>new Date(X.datetime)-new Date(re.datetime)).find(X=>new Date(X.datetime)>new Date);return h.jsxs("div",{className:"min-h-screen bg-gray-900 text-white p-6 flex flex-col",children:[h.jsxs("div",{className:"flex justify-between items-center mb-8",children:[h.jsx("h1",{className:"text-2xl font-bold italic",children:"ROAD MODE"}),h.jsx("button",{onClick:()=>k(!1),className:"text-sm bg-gray-800 px-3 py-1 rounded",children:"Exit"})]}),h.jsxs("div",{className:"flex-1 flex flex-col gap-6",children:[h.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-blue-600 p-6 rounded-2xl shadow-lg",children:[h.jsx("h2",{className:"text-sm font-bold opacity-75 uppercase tracking-wider mb-1",children:"Up Next"}),O?h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"text-3xl font-black mb-1",children:O.title}),h.jsx("div",{className:"text-xl opacity-90",children:new Date(O.datetime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),h.jsx("div",{className:"mt-2 text-sm bg-white/20 inline-block px-2 py-1 rounded",children:O.note||"No notes"})]}):h.jsx("div",{className:"text-xl italic opacity-75",children:"No more fetes scheduled! Sleep time?"})]}),h.jsxs("div",{className:"bg-gray-800 p-6 rounded-2xl border border-gray-700",children:[h.jsx("h2",{className:"text-sm font-bold opacity-75 uppercase tracking-wider mb-2",children:"Costume Pickup"}),ye.costume?h.jsxs("div",{children:[h.jsx("div",{className:"text-xl font-bold text-yellow-400",children:ye.costume.band}),h.jsxs("div",{className:"text-gray-400",children:["Section: ",ye.costume.section]}),mo>0&&h.jsxs("div",{className:"text-red-400 font-bold mt-1",children:["Balance Due: $",mo]})]}):h.jsx("div",{className:"text-gray-500 italic",children:"No costume details saved."})]})]})]})}return h.jsxs("div",{className:"min-h-screen flex flex-col bg-gray-50 dark:bg-gray-900 transition-colors duration-200",children:[ft&&h.jsx("div",{className:"fixed top-4 right-4 z-50 animate-slideIn",children:h.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 text-white p-4 rounded-xl shadow-2xl max-w-sm",children:h.jsxs("div",{className:"flex items-start gap-3",children:[h.jsx("span",{className:"text-2xl",children:""}),h.jsxs("div",{children:[h.jsx("p",{className:"font-bold",children:ft.title}),h.jsx("p",{className:"text-sm opacity-90",children:ft.body})]}),h.jsx("button",{onClick:()=>Ye(null),className:"ml-2 text-white/70 hover:text-white",children:""})]})})}),h.jsx(r5,{}),h.jsxs("header",{className:"bg-white dark:bg-gray-800 shadow-sm py-4 px-4 flex justify-between items-center sticky top-0 z-20 transition-colors",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("img",{src:Zh,alt:"Logo",className:"w-8 h-8"}),h.jsx("h1",{className:"text-lg font-bold text-gray-800 dark:text-white hidden sm:block",children:"Carnival Planner"})]}),t&&h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("button",{onClick:li,className:"p-2 rounded-full bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-yellow-300",children:P?"":""}),ye&&h.jsx("button",{onClick:da,disabled:Ji,className:"px-3 py-1 text-xs font-bold rounded-full transition bg-purple-100 text-purple-700 hover:bg-purple-200 dark:bg-purple-900 dark:text-purple-200 disabled:opacity-50",children:Ji?"...":"GO ROAD READY"}),d?h.jsx("span",{className:"px-2 py-1 text-xs bg-yellow-100 text-yellow-800 rounded-full font-bold",children:"Premium"}):h.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500",children:"Free Plan"}),h.jsx("button",{onClick:ns,className:"text-sm font-medium text-gray-500 hover:text-red-500 dark:text-gray-400",children:"Sign Out"})]})]}),t&&h.jsx(l5,{user:t}),h.jsx("main",{className:"flex-1 p-4 max-w-4xl mx-auto w-full",children:t?h.jsxs("div",{children:[h.jsx("div",{className:"mb-8",children:h.jsx("div",{className:"flex gap-4 overflow-x-auto pb-4 snap-x",children:ai.map((O,X)=>{const re=i===O.id,xe=fo[X%fo.length],vt={"stkitts-sugar-mas":"Sugar Mas",stcroix:"St. Croix Carnival",trinidad:"Trinidad Carnival",dominica:"Mas Domnik",jamaica:"Jamaica Carnival",tampa:"Tampa Bay Carnival",stmaarten:"St. Maarten Carnival","cayman-batabano":"Cayman Carnival Batabano",stthomas:"St. Thomas Carnival",guyana:"Guyana Independence",bahamas:"Bahamas Carnival",bermuda:"Bermuda Carnival",hollywood:"Hollywood Carnival",caymas:"Caymas Carnival",vincymas:"Vincy Mas",stlucia:"Saint Lucia Carnival",toronto:"Toronto Caribbean Carnival",barbados:"Crop Over",nevis:"Nevis Culturama",antigua:"Antigua Carnival",grenada:"Spice Mas","ny-labor-day":"New York Carnival",japan:"Japan Caribbean Carnival",miami:"Miami Carnival",tobago:"Tobago Carnival"}[O.id]||O.name,wt=q4.find($e=>$e.name.toLowerCase().includes(vt.toLowerCase())||vt.toLowerCase().includes($e.name.split("(")[0].trim().toLowerCase()));let Re=null;if(wt){const $e=new Date,zr=new Date($e.getFullYear(),$e.getMonth(),$e.getDate()),[Er,qr,yo]=wt.date.split("-").map(Number),Ae=new Date(Er,qr-1,yo);Ae>=zr&&(Re=Math.round((Ae-zr)/(1e3*60*60*24)))}return h.jsx("div",{onClick:()=>zl(O.id,`${O.name} - ${ts[O.monthIndex]}`),className:`snap-center min-w-[200px] cursor-pointer rounded-2xl p-5 shadow-lg relative overflow-hidden transition-all duration-300 ${re?"ring-4 ring-offset-2 ring-blue-400 scale-105":"hover:scale-105 opacity-90"} ${xe}`,children:h.jsxs("div",{className:"relative z-10 text-white",children:[h.jsx("h4",{className:"font-bold text-lg leading-tight mb-1",children:O.name}),h.jsx("p",{className:"text-xs font-medium uppercase tracking-wider opacity-90",children:ts[O.monthIndex]}),wt&&h.jsx("p",{className:"text-xs font-medium opacity-80 mt-1",children:new Date(wt.date+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),Re!==null&&h.jsxs("div",{className:"mt-2 bg-white/20 backdrop-blur-sm rounded-lg px-2 py-1 inline-block",children:[h.jsx("span",{className:"text-lg font-black",children:Re}),h.jsx("span",{className:"text-xs ml-1 opacity-90",children:"days"})]})]})},O.id)})})}),ye?h.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-100 dark:border-gray-700 overflow-hidden transition-colors",children:[!d&&h.jsxs("div",{className:"bg-gradient-to-r from-yellow-400 via-orange-500 to-pink-500 p-4 flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("span",{className:"text-2xl",children:""}),h.jsxs("div",{children:[h.jsx("p",{className:"text-white font-bold text-sm",children:"Unlock Premium Features"}),h.jsx("p",{className:"text-white/80 text-xs",children:"Go ad-free and get a Premium badge!"})]})]}),h.jsx("button",{onClick:()=>u("Info"),className:"px-4 py-2 bg-white text-orange-600 font-bold text-sm rounded-full hover:bg-gray-100 transition",children:"Upgrade"})]}),!d&&h.jsx("div",{className:"border-b border-gray-100 dark:border-gray-700",children:h.jsx(Yh,{placement:"banner",onUpgradeClick:()=>u("Info")})}),h.jsx("div",{className:"flex border-b border-gray-100 dark:border-gray-700 overflow-x-auto scrollbar-hide",children:["Budget","Costume","Schedule","Squad","Packing",...d?["Map","Media"]:[],"Info"].map(O=>h.jsxs("button",{onClick:()=>u(O),className:`flex-shrink-0 px-3 sm:px-4 py-3 sm:py-4 text-xs sm:text-sm font-medium transition-colors relative whitespace-nowrap ${a===O?"text-blue-600 dark:text-blue-400 bg-blue-50/50 dark:bg-blue-900/20":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"}`,children:[O,(O==="Map"||O==="Media")&&h.jsx("span",{className:"ml-1 text-xs text-yellow-500",children:""}),a===O&&h.jsx("div",{className:"absolute bottom-0 left-0 w-full h-0.5 bg-blue-600 dark:bg-blue-400"})]},O))}),Lt&&h.jsxs("div",{className:"bg-gradient-to-r from-green-500 to-teal-500 px-4 py-2 flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-white text-lg",children:""}),h.jsxs("div",{children:[h.jsx("p",{className:"text-white font-medium text-sm",children:"Squad Mode Active"}),h.jsxs("p",{className:"text-white/80 text-xs",children:["Changes sync with ",ce.length," squad member(s)"]})]})]}),h.jsx("button",{onClick:rs,disabled:br,className:"px-3 py-1 bg-white/20 text-white text-xs font-medium rounded-full hover:bg-white/30 transition disabled:opacity-50",children:br?"Syncing...":"Refresh"})]}),h.jsxs("div",{className:"p-6",children:[a==="Budget"&&h.jsxs("div",{className:"animate-fadeIn",children:[h.jsxs("div",{className:"flex justify-between items-end mb-6",children:[h.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-white",children:"Budget"}),h.jsxs("div",{className:"text-right",children:[h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total Estimate"}),h.jsxs("p",{className:"text-2xl font-black text-green-600 dark:text-green-400",children:["$",ga.toFixed(2)]})]})]}),h.jsx("div",{className:"space-y-3 mb-6",children:(ye.budget||[]).map(O=>{var X;return h.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 dark:bg-gray-700 rounded-lg group hover:bg-gray-100 dark:hover:bg-gray-600",children:[h.jsxs("div",{children:[h.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-200",children:O.name}),O.addedBy&&Lt&&h.jsxs("span",{className:"ml-2 text-xs text-gray-400 dark:text-gray-500",children:["by ",((X=O.addedBy.email)==null?void 0:X.split("@")[0])||"squad member"]})]}),h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsxs("span",{className:"font-bold text-gray-900 dark:text-white",children:["$",O.cost.toFixed(2)]}),h.jsx("button",{onClick:()=>fa(O.id),className:"text-gray-400 hover:text-red-500",children:""})]})]},O.id)})}),h.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[h.jsxs("div",{className:"flex gap-2 flex-1",children:[h.jsx("input",{type:"text",placeholder:"Item",value:S,onChange:O=>N(O.target.value),className:"flex-[2] p-3 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm"}),h.jsx("input",{type:"number",placeholder:"0.00",value:z,onChange:O=>G(O.target.value),className:"flex-1 p-3 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm"})]}),h.jsx("button",{onClick:is,className:"w-full sm:w-auto px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium",children:"Add"})]}),!d&&h.jsx("div",{className:"mt-6 pt-4 border-t border-gray-100 dark:border-gray-700",children:h.jsx(Yh,{placement:"inline",onUpgradeClick:()=>u("Info")})})]}),a==="Costume"&&h.jsxs("div",{className:"animate-fadeIn",children:[h.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-white mb-4",children:"Mas Costume"}),h.jsxs("div",{className:"bg-pink-50 dark:bg-pink-900/20 p-6 rounded-xl border border-pink-100 dark:border-pink-900 mb-4",children:[h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-bold text-pink-800 dark:text-pink-300 uppercase mb-1",children:"Band Name"}),h.jsx("input",{type:"text",className:"w-full p-2 border border-pink-200 dark:border-pink-800 rounded dark:bg-gray-700 dark:text-white",value:Pe.band||((go=ye.costume)==null?void 0:go.band)||"",onChange:O=>tt({...Pe,band:O.target.value}),placeholder:"e.g. Tribe, Bliss..."})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-bold text-pink-800 dark:text-pink-300 uppercase mb-1",children:"Section"}),h.jsx("input",{type:"text",className:"w-full p-2 border border-pink-200 dark:border-pink-800 rounded dark:bg-gray-700 dark:text-white",value:Pe.section||((gi=ye.costume)==null?void 0:gi.section)||"",onChange:O=>tt({...Pe,section:O.target.value}),placeholder:"e.g. The Monarch"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-bold text-pink-800 dark:text-pink-300 uppercase mb-1",children:"Total Cost"}),h.jsx("input",{type:"number",className:"w-full p-2 border border-pink-200 dark:border-pink-800 rounded dark:bg-gray-700 dark:text-white",value:Pe.total||((_i=ye.costume)==null?void 0:_i.total)||"",onChange:O=>tt({...Pe,total:O.target.value}),placeholder:"0.00"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-bold text-pink-800 dark:text-pink-300 uppercase mb-1",children:"Amount Paid"}),h.jsx("input",{type:"number",className:"w-full p-2 border border-pink-200 dark:border-pink-800 rounded dark:bg-gray-700 dark:text-white",value:Pe.paid||((_o=ye.costume)==null?void 0:_o.paid)||"",onChange:O=>tt({...Pe,paid:O.target.value}),placeholder:"0.00"})]})]}),h.jsx("button",{onClick:os,className:"mt-4 w-full py-2 bg-pink-600 text-white font-bold rounded hover:bg-pink-700",children:"Save Details"})]})]}),a==="Schedule"&&h.jsxs("div",{className:"animate-fadeIn",children:[h.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-white mb-4",children:"Itinerary"}),ls.length>0&&h.jsxs("div",{className:"mb-6",children:[h.jsx("p",{className:"text-xs font-bold text-gray-400 uppercase mb-2",children:"Popular Events (Click to Add)"}),h.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:ls.map((O,X)=>h.jsxs("button",{onClick:()=>Vt(O),className:"min-w-[140px] p-3 text-left rounded-lg border transition bg-blue-50 dark:bg-blue-900/30 border-blue-100 dark:border-blue-800 hover:bg-blue-100 dark:hover:bg-blue-800",children:[h.jsx("div",{className:"font-bold text-blue-900 dark:text-blue-300 text-sm",children:O.title}),h.jsx("div",{className:"text-xs text-blue-700 dark:text-blue-400 opacity-75 truncate",children:O.note})]},X))})]}),d?h.jsxs("div",{className:"mb-6",children:[h.jsxs("div",{className:"flex items-center justify-between mb-2",children:[h.jsxs("p",{className:"text-xs font-bold text-emerald-600 dark:text-emerald-400 uppercase flex items-center gap-1",children:[h.jsx("span",{className:"inline-block w-2 h-2 bg-emerald-500 rounded-full animate-pulse"}),"Live Events from Fete Sites"]}),yt&&h.jsxs("span",{className:"text-xs text-gray-400",children:["Updated: ",new Date(yt).toLocaleDateString()]})]}),co?h.jsxs("div",{className:"text-center py-4 text-gray-500 dark:text-gray-400",children:[h.jsx("div",{className:"animate-spin inline-block w-5 h-5 border-2 border-emerald-500 border-t-transparent rounded-full mb-2"}),h.jsx("p",{className:"text-sm",children:"Loading live events..."})]}):uo.length>0?h.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:uo.slice(0,10).map((O,X)=>h.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gradient-to-r from-emerald-50 to-teal-50 dark:from-emerald-900/20 dark:to-teal-900/20 border border-emerald-200 dark:border-emerald-800 rounded-lg hover:shadow-md transition",children:[O.image&&h.jsx("img",{src:O.image,alt:"",className:"w-12 h-12 rounded object-cover flex-shrink-0"}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("h5",{className:"font-bold text-emerald-900 dark:text-emerald-300 text-sm truncate",children:O.title}),O.date&&h.jsxs("p",{className:"text-xs text-emerald-700 dark:text-emerald-400",children:[new Date(O.date+"T00:00:00").toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"}),O.time&&` at ${O.time}`]}),O.venue&&h.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:O.venue}),h.jsxs("p",{className:"text-xs text-gray-400",children:["via ",O.source]})]}),h.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[O.url&&h.jsx("a",{href:O.url,target:"_blank",rel:"noopener noreferrer",className:"px-2 py-1 text-xs bg-emerald-600 text-white rounded hover:bg-emerald-700",children:"Tickets"}),h.jsx("button",{onClick:()=>Vt({title:O.title,note:O.venue||`via ${O.source}`}),className:"px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700",children:"+ Add"})]})]},O.id||X))}):h.jsxs("div",{className:"text-center py-4 bg-emerald-50 dark:bg-emerald-900/20 rounded-lg border border-emerald-200 dark:border-emerald-800",children:[h.jsx("p",{className:"text-sm text-emerald-700 dark:text-emerald-400",children:"No live events found for this carnival yet."}),h.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Events are updated daily from fetelist.com & frontlineticketing.com"})]})]}):h.jsx("div",{className:"mb-6 p-4 bg-gradient-to-r from-amber-50 to-orange-50 dark:from-amber-900/20 dark:to-orange-900/20 border border-amber-200 dark:border-amber-800 rounded-xl",children:h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("span",{className:"text-2xl",children:""}),h.jsxs("div",{className:"flex-1",children:[h.jsx("p",{className:"font-bold text-amber-900 dark:text-amber-300",children:"Unlock Live Event Listings"}),h.jsx("p",{className:"text-xs text-amber-700 dark:text-amber-400",children:"Premium members get daily-updated fete listings from fetelist.com & frontlineticketing.com"})]}),h.jsx("button",{onClick:()=>u("Info"),className:"px-3 py-2 bg-gradient-to-r from-amber-500 to-orange-500 text-white text-sm font-bold rounded-lg hover:opacity-90 flex-shrink-0",children:"Upgrade"})]})}),h.jsx("div",{className:"space-y-4 mb-6",children:(ye.schedule||[]).map(O=>{var X;return h.jsxs("div",{className:"flex gap-4 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg border-l-4 border-blue-400 relative group",children:[h.jsxs("div",{className:"text-center min-w-[60px]",children:[h.jsx("span",{className:"block text-xs font-bold text-gray-500 dark:text-gray-400 uppercase",children:new Date(O.datetime).toLocaleDateString(void 0,{month:"short"})}),h.jsx("span",{className:"block text-xl font-black text-gray-800 dark:text-white",children:new Date(O.datetime).getDate()}),h.jsx("span",{className:"block text-xs text-gray-500 dark:text-gray-400",children:new Date(O.datetime).toLocaleTimeString(void 0,{hour:"numeric",minute:"2-digit"})})]}),h.jsxs("div",{className:"flex-1",children:[h.jsx("h4",{className:"font-bold text-gray-800 dark:text-white",children:O.title}),O.note&&h.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-1",children:O.note}),O.addedBy&&Lt&&h.jsxs("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:["Added by ",((X=O.addedBy.email)==null?void 0:X.split("@")[0])||"squad member"]})]}),h.jsx("button",{onClick:()=>ss(O.id),className:"absolute top-2 right-2 text-gray-400 hover:text-red-500 opacity-0 group-hover:opacity-100",children:""})]},O.id)})}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 bg-gray-50 dark:bg-gray-700 p-4 rounded-xl",children:[h.jsx("input",{type:"text",placeholder:"Event Name",value:F,onChange:O=>I(O.target.value),className:"p-2 border rounded dark:bg-gray-800 dark:border-gray-600 dark:text-white"}),h.jsx("input",{type:"datetime-local",value:T,onChange:O=>C(O.target.value),className:"p-2 border rounded dark:bg-gray-800 dark:border-gray-600 dark:text-white"}),h.jsx("input",{type:"text",placeholder:"Notes",value:A,onChange:O=>M(O.target.value),className:"p-2 border rounded md:col-span-2 dark:bg-gray-800 dark:border-gray-600 dark:text-white"}),h.jsx("button",{onClick:hi,className:"md:col-span-2 py-2 bg-blue-600 text-white rounded font-medium hover:bg-blue-700",children:"Add Event"})]})]}),a==="Squad"&&h.jsxs("div",{className:"animate-fadeIn",children:[h.jsxs("div",{className:"flex justify-between items-center mb-4",children:[h.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-white",children:"Your Squad"}),h.jsxs("span",{className:"text-sm bg-purple-100 text-purple-800 px-2 py-1 rounded-full",children:[((hs=ye.squad)==null?void 0:hs.length)||0," members"]})]}),h.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 border border-purple-200 dark:border-purple-800 rounded-xl p-4 mb-4",children:[h.jsxs("h4",{className:"font-bold text-purple-800 dark:text-purple-300 mb-3 flex items-center gap-2",children:[h.jsx("span",{children:""})," Squad Sharing"]}),en&&h.jsx("div",{className:"mb-3 p-2 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 rounded text-sm",children:en}),nt&&h.jsx("div",{className:"mb-3 p-2 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 rounded text-sm",children:nt}),h.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[h.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-3",children:[h.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Share your carnival plan with friends:"}),K?h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-2xl font-mono font-bold text-purple-600 dark:text-purple-400 tracking-wider",children:K}),h.jsx("button",{onClick:mi,className:"text-sm bg-purple-100 dark:bg-purple-900/50 text-purple-700 dark:text-purple-300 px-3 py-1 rounded hover:bg-purple-200",children:"Copy"})]}):h.jsx("button",{onClick:Tr,disabled:ke,className:"w-full py-2 bg-purple-600 text-white rounded font-medium hover:bg-purple-700 disabled:opacity-50",children:ke?"Creating...":"Generate Share Code"})]}),h.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-3",children:[h.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Join a friend's squad:"}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("input",{type:"text",placeholder:"Enter 6-digit code",value:J,onChange:O=>ae(O.target.value.toUpperCase().slice(0,6)),className:"flex-1 p-2 border rounded font-mono text-center tracking-wider uppercase dark:bg-gray-700 dark:border-gray-600 dark:text-white",maxLength:6}),h.jsx("button",{onClick:ma,disabled:me||J.length!==6,className:"bg-pink-600 text-white px-4 rounded hover:bg-pink-700 disabled:opacity-50",children:me?"...":"Join"})]})]})]}),d&&h.jsx("div",{className:"mt-4 pt-4 border-t border-purple-200 dark:border-purple-700",children:h.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[h.jsx("input",{type:"checkbox",checked:_n,onChange:O=>Yi(O.target.checked),className:"w-5 h-5 text-purple-600 rounded"}),h.jsxs("div",{children:[h.jsx("span",{className:"font-medium text-purple-800 dark:text-purple-300",children:"Notify squad when I go Road Ready"}),h.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Send push notification to squad members"})]}),h.jsx("span",{className:"ml-auto text-xs bg-yellow-100 text-yellow-800 px-2 py-0.5 rounded-full",children:"Premium"})]})})]}),ce.length>0&&h.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-green-200 dark:border-green-800 rounded-xl p-4 mb-4",children:[h.jsxs("div",{className:"flex items-center justify-between mb-3",children:[h.jsxs("h4",{className:"font-medium text-green-700 dark:text-green-400 flex items-center gap-2",children:[h.jsx("span",{children:""})," Connected Squad Members"]}),h.jsx("button",{onClick:pi,className:"text-xs bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 px-2 py-1 rounded hover:bg-green-200 dark:hover:bg-green-800",children:"Refresh"})]}),h.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-3",children:'These users joined using your share code and can see this carnival plan. Click "Refresh" to check for new members.'}),h.jsx("div",{className:"flex flex-wrap gap-2",children:ce.map((O,X)=>{var re;return h.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 rounded-full border ${O.role==="owner"?"bg-yellow-50 dark:bg-yellow-900/30 border-yellow-200 dark:border-yellow-800":"bg-green-50 dark:bg-green-900/30 border-green-200 dark:border-green-800"}`,children:[h.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-white text-sm font-bold",children:(O.email||O.uid||"?").charAt(0).toUpperCase()}),h.jsxs("div",{className:"flex flex-col",children:[h.jsx("span",{className:`font-medium text-sm ${O.role==="owner"?"text-yellow-800 dark:text-yellow-300":"text-green-800 dark:text-green-300"}`,children:O.email||`User ${(re=O.uid)==null?void 0:re.slice(0,6)}...`}),h.jsx("span",{className:`text-xs ${O.role==="owner"?"text-yellow-600 dark:text-yellow-400":"text-green-600 dark:text-green-400"}`,children:O.role==="owner"?" Owner":" Member"})]})]},O.uid||X)})})]}),h.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl p-4 mb-4",children:[h.jsx("h4",{className:"font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Quick Add (Offline List)"}),h.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-4",children:[h.jsx("input",{type:"text",placeholder:"Add friend's name",value:we,onChange:O=>De(O.target.value),className:"flex-1 p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm"}),h.jsx("button",{onClick:Cn,className:"w-full sm:w-auto bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700 font-medium",children:"Add"})]}),h.jsxs("div",{className:"flex flex-wrap gap-2",children:[(ye.squad||[]).map(O=>h.jsxs("div",{className:"flex items-center gap-2 bg-purple-50 dark:bg-purple-900/30 px-3 py-1 rounded-full border border-purple-100 dark:border-purple-800",children:[h.jsx("span",{className:"text-purple-900 dark:text-purple-200 font-medium",children:O.name}),h.jsx("button",{onClick:()=>pe(O.id),className:"text-purple-400 hover:text-red-500 text-xs font-bold",children:""})]},O.id)),(ye.squad||[]).length===0&&h.jsx("p",{className:"text-gray-400 italic text-sm",children:"No squad members added yet. Riding solo?"})]})]}),!d&&h.jsx("div",{className:"mt-4",children:h.jsx(Yh,{placement:"inline",onUpgradeClick:()=>u("Info")})})]}),a==="Packing"&&h.jsxs("div",{className:"animate-fadeIn",children:[h.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-white mb-4",children:"Packing List"}),h.jsx("div",{className:"space-y-2 mb-6",children:(ye.packing||[]).map(O=>h.jsxs("div",{className:"flex items-center justify-between p-3 bg-white dark:bg-gray-700 border border-gray-100 dark:border-gray-600 shadow-sm rounded-lg",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("input",{type:"checkbox",checked:O.checked,onChange:()=>di(O.id),className:"w-5 h-5 text-blue-600 rounded"}),h.jsx("span",{className:`text-gray-700 dark:text-gray-200 ${O.checked?"line-through opacity-50":""}`,children:O.item})]}),h.jsx("button",{onClick:()=>fi(O.id),className:"text-gray-400 hover:text-red-500",children:""})]},O.id))}),h.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[h.jsx("input",{type:"text",placeholder:"Item",value:U,onChange:O=>D(O.target.value),className:"flex-1 p-3 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm"}),h.jsx("button",{onClick:pa,className:"w-full sm:w-auto px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium",children:"Add"})]}),!d&&h.jsx("div",{className:"mt-6 pt-4 border-t border-gray-100 dark:border-gray-700",children:h.jsx(Yh,{placement:"inline",onUpgradeClick:()=>u("Info")})})]}),a==="Map"&&d&&h.jsx("div",{className:"animate-fadeIn",children:h.jsx(zF,{locations:ye.mapLocations||[],onLocationsChange:O=>Be("mapLocations",O),carnivalName:ye.name,carnivalId:i})}),a==="Media"&&d&&h.jsx("div",{className:"animate-fadeIn",children:h.jsx(qF,{files:ye.mediaFiles||[],onFilesChange:O=>Be("mediaFiles",O),carnivalName:ye.name,carnivalId:i,userId:t.uid})}),a==="Info"&&h.jsxs("div",{className:"animate-fadeIn text-center",children:[h.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-gray-800 text-white rounded-2xl p-8 mb-6 shadow-xl",children:[h.jsx("img",{src:Zh,alt:"Logo",className:"w-20 h-20 mx-auto mb-4"}),h.jsx("h2",{className:"text-2xl font-bold mb-2",children:d?"Premium Supporter":"Support the App"}),h.jsx("p",{className:"text-gray-400 mb-6",children:d?"Thank you for supporting Carnival Planner!":"All features are free! Premium removes ads and shows your support."}),h.jsxs("button",{onClick:as,className:"flex items-center justify-center gap-2 mx-auto px-6 py-3 rounded-full font-bold transition-colors bg-white text-gray-900 hover:bg-gray-100",children:[h.jsx("span",{children:""})," Export Itinerary"]})]}),!d&&h.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/10 border border-yellow-200 dark:border-yellow-800 rounded-xl p-6",children:[h.jsx("h3",{className:"font-bold text-yellow-800 dark:text-yellow-400 mb-2",children:"Become a Premium Supporter"}),h.jsx("p",{className:"text-yellow-700 dark:text-yellow-500 text-sm mb-4",children:"Get an ad-free experience and a Premium badge to show your support!"}),h.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[h.jsx("button",{onClick:()=>ui("monthly"),disabled:B,className:"px-4 py-2 bg-blue-600 text-white font-bold rounded shadow hover:bg-blue-700 disabled:opacity-50",children:B?"Loading...":"Monthly - $4.99"}),h.jsx("button",{onClick:()=>ui("yearly"),disabled:B,className:"px-4 py-2 bg-yellow-400 text-yellow-900 font-bold rounded shadow hover:bg-yellow-500 disabled:opacity-50",children:B?"Loading...":"Yearly - $39.99"})]})]}),h.jsx("div",{className:"mt-6",children:h.jsx(o5,{user:t})}),(t==null?void 0:t.email)==="djkrss1@gmail.com"&&h.jsxs("div",{className:"mt-6 text-left space-y-8",children:[h.jsx(WF,{}),h.jsx(s5,{}),h.jsx(ZF,{})]})]})]})]}):h.jsx("div",{className:"text-center py-12 bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-dashed border-gray-300 dark:border-gray-600",children:h.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Select a carnival above to begin."})})]}):h.jsx("div",{className:"flex flex-col items-center justify-center min-h-[60vh] text-center px-4",children:es?h.jsx(a5,{onBack:()=>Br(!1),onSuccess:()=>Br(!1)}):h.jsxs(h.Fragment,{children:[h.jsx("h2",{className:"text-3xl font-bold mb-6 text-gray-800 dark:text-white",children:"Welcome Back"}),h.jsxs("div",{className:"space-y-3 w-full max-w-sm",children:[h.jsxs("button",{onClick:po,className:"w-full flex items-center justify-center px-6 py-3 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-lg shadow-sm hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-800 dark:text-white transition-colors",children:[h.jsx("img",{src:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg",className:"w-5 h-5 mr-3",alt:"G"}),"Continue with Google"]}),h.jsxs("div",{className:"flex items-center gap-3 text-gray-400 dark:text-gray-500",children:[h.jsx("div",{className:"flex-1 h-px bg-gray-300 dark:bg-gray-600"}),h.jsx("span",{className:"text-sm",children:"or"}),h.jsx("div",{className:"flex-1 h-px bg-gray-300 dark:bg-gray-600"})]}),h.jsx("button",{onClick:()=>Br(!0),className:"w-full flex items-center justify-center px-6 py-3 bg-gradient-to-r from-pink-500 to-orange-500 rounded-lg shadow-sm hover:opacity-90 text-white font-semibold transition-opacity",children:"Continue with Email"})]}),h.jsx("button",{onClick:()=>w(!0),className:"mt-6 text-sm text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300",children:"Back to home"})]})})}),h.jsx("footer",{className:"bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 py-6 px-4 mt-auto",children:h.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[h.jsxs("div",{className:"flex flex-wrap justify-center gap-3 text-sm text-gray-500 dark:text-gray-400",children:[h.jsx("button",{onClick:()=>zn("privacy"),className:"hover:text-gray-900 dark:hover:text-white transition-colors",children:"Privacy"}),h.jsx("span",{children:"|"}),h.jsx("button",{onClick:()=>zn("terms"),className:"hover:text-gray-900 dark:hover:text-white transition-colors",children:"Terms"}),h.jsx("span",{children:"|"}),h.jsx("button",{onClick:()=>zn("cookies"),className:"hover:text-gray-900 dark:hover:text-white transition-colors",children:"Cookies"}),h.jsx("span",{children:"|"}),h.jsx("button",{onClick:()=>zn("refund"),className:"hover:text-gray-900 dark:hover:text-white transition-colors",children:"Refunds"}),h.jsx("span",{children:"|"}),h.jsx("button",{onClick:()=>zn("contact"),className:"hover:text-gray-900 dark:hover:text-white transition-colors",children:"Contact"})]}),h.jsxs("p",{className:"text-gray-400 dark:text-gray-500 text-xs mt-3",children:[" ",new Date().getFullYear()," Carnival Planner"]})]})})]})}wm.createRoot(document.getElementById("root")).render(h.jsx(kd.StrictMode,{children:h.jsx(h5,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(t=>{console.log("SW registered:",t.scope)}).catch(t=>{console.log("SW registration failed:",t)})});
