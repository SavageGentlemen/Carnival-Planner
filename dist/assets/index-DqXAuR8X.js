(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var o2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Xb(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ek={exports:{}},$f={},tk={exports:{}},$e={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ju=Symbol.for("react.element"),a2=Symbol.for("react.portal"),l2=Symbol.for("react.fragment"),c2=Symbol.for("react.strict_mode"),u2=Symbol.for("react.profiler"),d2=Symbol.for("react.provider"),h2=Symbol.for("react.context"),f2=Symbol.for("react.forward_ref"),m2=Symbol.for("react.suspense"),p2=Symbol.for("react.memo"),g2=Symbol.for("react.lazy"),Iv=Symbol.iterator;function y2(t){return t===null||typeof t!="object"?null:(t=Iv&&t[Iv]||t["@@iterator"],typeof t=="function"?t:null)}var nk={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},rk=Object.assign,ik={};function rc(t,e,n){this.props=t,this.context=e,this.refs=ik,this.updater=n||nk}rc.prototype.isReactComponent={};rc.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};rc.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function sk(){}sk.prototype=rc.prototype;function Sy(t,e,n){this.props=t,this.context=e,this.refs=ik,this.updater=n||nk}var Ny=Sy.prototype=new sk;Ny.constructor=Sy;rk(Ny,rc.prototype);Ny.isPureReactComponent=!0;var Tv=Array.isArray,ok=Object.prototype.hasOwnProperty,Py={current:null},ak={key:!0,ref:!0,__self:!0,__source:!0};function lk(t,e,n){var r,i={},o=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(o=""+e.key),e)ok.call(e,r)&&!ak.hasOwnProperty(r)&&(i[r]=e[r]);var u=arguments.length-2;if(u===1)i.children=n;else if(1<u){for(var d=Array(u),m=0;m<u;m++)d[m]=arguments[m+2];i.children=d}if(t&&t.defaultProps)for(r in u=t.defaultProps,u)i[r]===void 0&&(i[r]=u[r]);return{$$typeof:Ju,type:t,key:o,ref:a,props:i,_owner:Py.current}}function _2(t,e){return{$$typeof:Ju,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Cy(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ju}function v2(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Ev=/\/+/g;function tp(t,e){return typeof t=="object"&&t!==null&&t.key!=null?v2(""+t.key):e.toString(36)}function _h(t,e,n,r,i){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(o){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Ju:case a2:a=!0}}if(a)return a=t,i=i(a),t=r===""?"."+tp(a,0):r,Tv(i)?(n="",t!=null&&(n=t.replace(Ev,"$&/")+"/"),_h(i,e,n,"",function(m){return m})):i!=null&&(Cy(i)&&(i=_2(i,n+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(Ev,"$&/")+"/")+t)),e.push(i)),1;if(a=0,r=r===""?".":r+":",Tv(t))for(var u=0;u<t.length;u++){o=t[u];var d=r+tp(o,u);a+=_h(o,e,n,d,i)}else if(d=y2(t),typeof d=="function")for(t=d.call(t),u=0;!(o=t.next()).done;)o=o.value,d=r+tp(o,u++),a+=_h(o,e,n,d,i);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Bd(t,e,n){if(t==null)return t;var r=[],i=0;return _h(t,r,"","",function(o){return e.call(n,o,i++)}),r}function x2(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Mn={current:null},vh={transition:null},w2={ReactCurrentDispatcher:Mn,ReactCurrentBatchConfig:vh,ReactCurrentOwner:Py};function ck(){throw Error("act(...) is not supported in production builds of React.")}$e.Children={map:Bd,forEach:function(t,e,n){Bd(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Bd(t,function(){e++}),e},toArray:function(t){return Bd(t,function(e){return e})||[]},only:function(t){if(!Cy(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};$e.Component=rc;$e.Fragment=l2;$e.Profiler=u2;$e.PureComponent=Sy;$e.StrictMode=c2;$e.Suspense=m2;$e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=w2;$e.act=ck;$e.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=rk({},t.props),i=t.key,o=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,a=Py.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(d in e)ok.call(e,d)&&!ak.hasOwnProperty(d)&&(r[d]=e[d]===void 0&&u!==void 0?u[d]:e[d])}var d=arguments.length-2;if(d===1)r.children=n;else if(1<d){u=Array(d);for(var m=0;m<d;m++)u[m]=arguments[m+2];r.children=u}return{$$typeof:Ju,type:t.type,key:i,ref:o,props:r,_owner:a}};$e.createContext=function(t){return t={$$typeof:h2,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:d2,_context:t},t.Consumer=t};$e.createElement=lk;$e.createFactory=function(t){var e=lk.bind(null,t);return e.type=t,e};$e.createRef=function(){return{current:null}};$e.forwardRef=function(t){return{$$typeof:f2,render:t}};$e.isValidElement=Cy;$e.lazy=function(t){return{$$typeof:g2,_payload:{_status:-1,_result:t},_init:x2}};$e.memo=function(t,e){return{$$typeof:p2,type:t,compare:e===void 0?null:e}};$e.startTransition=function(t){var e=vh.transition;vh.transition={};try{t()}finally{vh.transition=e}};$e.unstable_act=ck;$e.useCallback=function(t,e){return Mn.current.useCallback(t,e)};$e.useContext=function(t){return Mn.current.useContext(t)};$e.useDebugValue=function(){};$e.useDeferredValue=function(t){return Mn.current.useDeferredValue(t)};$e.useEffect=function(t,e){return Mn.current.useEffect(t,e)};$e.useId=function(){return Mn.current.useId()};$e.useImperativeHandle=function(t,e,n){return Mn.current.useImperativeHandle(t,e,n)};$e.useInsertionEffect=function(t,e){return Mn.current.useInsertionEffect(t,e)};$e.useLayoutEffect=function(t,e){return Mn.current.useLayoutEffect(t,e)};$e.useMemo=function(t,e){return Mn.current.useMemo(t,e)};$e.useReducer=function(t,e,n){return Mn.current.useReducer(t,e,n)};$e.useRef=function(t){return Mn.current.useRef(t)};$e.useState=function(t){return Mn.current.useState(t)};$e.useSyncExternalStore=function(t,e,n){return Mn.current.useSyncExternalStore(t,e,n)};$e.useTransition=function(){return Mn.current.useTransition()};$e.version="18.3.1";tk.exports=$e;var U=tk.exports;const Hh=Xb(U);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b2=U,k2=Symbol.for("react.element"),I2=Symbol.for("react.fragment"),T2=Object.prototype.hasOwnProperty,E2=b2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,S2={key:!0,ref:!0,__self:!0,__source:!0};function uk(t,e,n){var r,i={},o=null,a=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)T2.call(e,r)&&!S2.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:k2,type:t,key:o,ref:a,props:i,_owner:E2.current}}$f.Fragment=I2;$f.jsx=uk;$f.jsxs=uk;ek.exports=$f;var l=ek.exports,Zp={},dk={exports:{}},fr={},hk={exports:{}},fk={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(G,le){var te=G.length;G.push(le);e:for(;0<te;){var ke=te-1>>>1,de=G[ke];if(0<i(de,le))G[ke]=le,G[te]=de,te=ke;else break e}}function n(G){return G.length===0?null:G[0]}function r(G){if(G.length===0)return null;var le=G[0],te=G.pop();if(te!==le){G[0]=te;e:for(var ke=0,de=G.length,pe=de>>>1;ke<pe;){var ve=2*(ke+1)-1,he=G[ve],se=ve+1,Me=G[se];if(0>i(he,te))se<de&&0>i(Me,he)?(G[ke]=Me,G[se]=te,ke=se):(G[ke]=he,G[ve]=te,ke=ve);else if(se<de&&0>i(Me,te))G[ke]=Me,G[se]=te,ke=se;else break e}}return le}function i(G,le){var te=G.sortIndex-le.sortIndex;return te!==0?te:G.id-le.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,u=a.now();t.unstable_now=function(){return a.now()-u}}var d=[],m=[],g=1,v=null,w=3,E=!1,C=!1,P=!1,F=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function A(G){for(var le=n(m);le!==null;){if(le.callback===null)r(m);else if(le.startTime<=G)r(m),le.sortIndex=le.expirationTime,e(d,le);else break;le=n(m)}}function z(G){if(P=!1,A(G),!C)if(n(d)!==null)C=!0,me(Z);else{var le=n(m);le!==null&&we(z,le.startTime-G)}}function Z(G,le){C=!1,P&&(P=!1,N(b),b=-1),E=!0;var te=w;try{for(A(le),v=n(d);v!==null&&(!(v.expirationTime>le)||G&&!O());){var ke=v.callback;if(typeof ke=="function"){v.callback=null,w=v.priorityLevel;var de=ke(v.expirationTime<=le);le=t.unstable_now(),typeof de=="function"?v.callback=de:v===n(d)&&r(d),A(le)}else r(d);v=n(d)}if(v!==null)var pe=!0;else{var ve=n(m);ve!==null&&we(z,ve.startTime-le),pe=!1}return pe}finally{v=null,w=te,E=!1}}var H=!1,I=null,b=-1,R=5,D=-1;function O(){return!(t.unstable_now()-D<R)}function B(){if(I!==null){var G=t.unstable_now();D=G;var le=!0;try{le=I(!0,G)}finally{le?M():(H=!1,I=null)}}else H=!1}var M;if(typeof T=="function")M=function(){T(B)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,ce=ee.port2;ee.port1.onmessage=B,M=function(){ce.postMessage(null)}}else M=function(){F(B,0)};function me(G){I=G,H||(H=!0,M())}function we(G,le){b=F(function(){G(t.unstable_now())},le)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(G){G.callback=null},t.unstable_continueExecution=function(){C||E||(C=!0,me(Z))},t.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<G?Math.floor(1e3/G):5},t.unstable_getCurrentPriorityLevel=function(){return w},t.unstable_getFirstCallbackNode=function(){return n(d)},t.unstable_next=function(G){switch(w){case 1:case 2:case 3:var le=3;break;default:le=w}var te=w;w=le;try{return G()}finally{w=te}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(G,le){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var te=w;w=G;try{return le()}finally{w=te}},t.unstable_scheduleCallback=function(G,le,te){var ke=t.unstable_now();switch(typeof te=="object"&&te!==null?(te=te.delay,te=typeof te=="number"&&0<te?ke+te:ke):te=ke,G){case 1:var de=-1;break;case 2:de=250;break;case 5:de=1073741823;break;case 4:de=1e4;break;default:de=5e3}return de=te+de,G={id:g++,callback:le,priorityLevel:G,startTime:te,expirationTime:de,sortIndex:-1},te>ke?(G.sortIndex=te,e(m,G),n(d)===null&&G===n(m)&&(P?(N(b),b=-1):P=!0,we(z,te-ke))):(G.sortIndex=de,e(d,G),C||E||(C=!0,me(Z))),G},t.unstable_shouldYield=O,t.unstable_wrapCallback=function(G){var le=w;return function(){var te=w;w=le;try{return G.apply(this,arguments)}finally{w=te}}}})(fk);hk.exports=fk;var N2=hk.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var P2=U,ur=N2;function ie(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var mk=new Set,vu={};function Na(t,e){Ll(t,e),Ll(t+"Capture",e)}function Ll(t,e){for(vu[t]=e,t=0;t<e.length;t++)mk.add(e[t])}var Zi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Qp=Object.prototype.hasOwnProperty,C2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Sv={},Nv={};function A2(t){return Qp.call(Nv,t)?!0:Qp.call(Sv,t)?!1:C2.test(t)?Nv[t]=!0:(Sv[t]=!0,!1)}function R2(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function j2(t,e,n,r){if(e===null||typeof e>"u"||R2(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function On(t,e,n,r,i,o,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=a}var ln={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ln[t]=new On(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ln[e]=new On(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ln[t]=new On(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ln[t]=new On(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ln[t]=new On(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ln[t]=new On(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ln[t]=new On(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ln[t]=new On(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ln[t]=new On(t,5,!1,t.toLowerCase(),null,!1,!1)});var Ay=/[\-:]([a-z])/g;function Ry(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Ay,Ry);ln[e]=new On(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Ay,Ry);ln[e]=new On(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Ay,Ry);ln[e]=new On(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ln[t]=new On(t,1,!1,t.toLowerCase(),null,!1,!1)});ln.xlinkHref=new On("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ln[t]=new On(t,1,!1,t.toLowerCase(),null,!0,!0)});function jy(t,e,n,r){var i=ln.hasOwnProperty(e)?ln[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(j2(e,n,i,r)&&(n=null),r||i===null?A2(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var is=P2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,zd=Symbol.for("react.element"),ul=Symbol.for("react.portal"),dl=Symbol.for("react.fragment"),Ly=Symbol.for("react.strict_mode"),Yp=Symbol.for("react.profiler"),pk=Symbol.for("react.provider"),gk=Symbol.for("react.context"),Dy=Symbol.for("react.forward_ref"),Jp=Symbol.for("react.suspense"),Xp=Symbol.for("react.suspense_list"),My=Symbol.for("react.memo"),js=Symbol.for("react.lazy"),yk=Symbol.for("react.offscreen"),Pv=Symbol.iterator;function Nc(t){return t===null||typeof t!="object"?null:(t=Pv&&t[Pv]||t["@@iterator"],typeof t=="function"?t:null)}var Nt=Object.assign,np;function $c(t){if(np===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);np=e&&e[1]||""}return`
`+np+t}var rp=!1;function ip(t,e){if(!t||rp)return"";rp=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(m){var r=m}Reflect.construct(t,[],e)}else{try{e.call()}catch(m){r=m}t.call(e.prototype)}else{try{throw Error()}catch(m){r=m}t()}}catch(m){if(m&&r&&typeof m.stack=="string"){for(var i=m.stack.split(`
`),o=r.stack.split(`
`),a=i.length-1,u=o.length-1;1<=a&&0<=u&&i[a]!==o[u];)u--;for(;1<=a&&0<=u;a--,u--)if(i[a]!==o[u]){if(a!==1||u!==1)do if(a--,u--,0>u||i[a]!==o[u]){var d=`
`+i[a].replace(" at new "," at ");return t.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",t.displayName)),d}while(1<=a&&0<=u);break}}}finally{rp=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?$c(t):""}function L2(t){switch(t.tag){case 5:return $c(t.type);case 16:return $c("Lazy");case 13:return $c("Suspense");case 19:return $c("SuspenseList");case 0:case 2:case 15:return t=ip(t.type,!1),t;case 11:return t=ip(t.type.render,!1),t;case 1:return t=ip(t.type,!0),t;default:return""}}function eg(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case dl:return"Fragment";case ul:return"Portal";case Yp:return"Profiler";case Ly:return"StrictMode";case Jp:return"Suspense";case Xp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case gk:return(t.displayName||"Context")+".Consumer";case pk:return(t._context.displayName||"Context")+".Provider";case Dy:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case My:return e=t.displayName||null,e!==null?e:eg(t.type)||"Memo";case js:e=t._payload,t=t._init;try{return eg(t(e))}catch{}}return null}function D2(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return eg(e);case 8:return e===Ly?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function so(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function _k(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function M2(t){var e=_k(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){r=""+a,o.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function qd(t){t._valueTracker||(t._valueTracker=M2(t))}function vk(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=_k(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Wh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function tg(t,e){var n=e.checked;return Nt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Cv(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=so(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function xk(t,e){e=e.checked,e!=null&&jy(t,"checked",e,!1)}function ng(t,e){xk(t,e);var n=so(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?rg(t,e.type,n):e.hasOwnProperty("defaultValue")&&rg(t,e.type,so(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Av(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function rg(t,e,n){(e!=="number"||Wh(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Hc=Array.isArray;function kl(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+so(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function ig(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ie(91));return Nt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Rv(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ie(92));if(Hc(n)){if(1<n.length)throw Error(ie(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:so(n)}}function wk(t,e){var n=so(e.value),r=so(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function jv(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function bk(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function sg(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?bk(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var $d,kk=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for($d=$d||document.createElement("div"),$d.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=$d.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function xu(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var tu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},O2=["Webkit","ms","Moz","O"];Object.keys(tu).forEach(function(t){O2.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),tu[e]=tu[t]})});function Ik(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||tu.hasOwnProperty(t)&&tu[t]?(""+e).trim():e+"px"}function Tk(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=Ik(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var V2=Nt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function og(t,e){if(e){if(V2[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ie(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ie(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ie(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ie(62))}}function ag(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var lg=null;function Oy(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var cg=null,Il=null,Tl=null;function Lv(t){if(t=td(t)){if(typeof cg!="function")throw Error(ie(280));var e=t.stateNode;e&&(e=Zf(e),cg(t.stateNode,t.type,e))}}function Ek(t){Il?Tl?Tl.push(t):Tl=[t]:Il=t}function Sk(){if(Il){var t=Il,e=Tl;if(Tl=Il=null,Lv(t),e)for(t=0;t<e.length;t++)Lv(e[t])}}function Nk(t,e){return t(e)}function Pk(){}var sp=!1;function Ck(t,e,n){if(sp)return t(e,n);sp=!0;try{return Nk(t,e,n)}finally{sp=!1,(Il!==null||Tl!==null)&&(Pk(),Sk())}}function wu(t,e){var n=t.stateNode;if(n===null)return null;var r=Zf(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ie(231,e,typeof n));return n}var ug=!1;if(Zi)try{var Pc={};Object.defineProperty(Pc,"passive",{get:function(){ug=!0}}),window.addEventListener("test",Pc,Pc),window.removeEventListener("test",Pc,Pc)}catch{ug=!1}function F2(t,e,n,r,i,o,a,u,d){var m=Array.prototype.slice.call(arguments,3);try{e.apply(n,m)}catch(g){this.onError(g)}}var nu=!1,Gh=null,Kh=!1,dg=null,U2={onError:function(t){nu=!0,Gh=t}};function B2(t,e,n,r,i,o,a,u,d){nu=!1,Gh=null,F2.apply(U2,arguments)}function z2(t,e,n,r,i,o,a,u,d){if(B2.apply(this,arguments),nu){if(nu){var m=Gh;nu=!1,Gh=null}else throw Error(ie(198));Kh||(Kh=!0,dg=m)}}function Pa(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Ak(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Dv(t){if(Pa(t)!==t)throw Error(ie(188))}function q2(t){var e=t.alternate;if(!e){if(e=Pa(t),e===null)throw Error(ie(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return Dv(i),t;if(o===r)return Dv(i),e;o=o.sibling}throw Error(ie(188))}if(n.return!==r.return)n=i,r=o;else{for(var a=!1,u=i.child;u;){if(u===n){a=!0,n=i,r=o;break}if(u===r){a=!0,r=i,n=o;break}u=u.sibling}if(!a){for(u=o.child;u;){if(u===n){a=!0,n=o,r=i;break}if(u===r){a=!0,r=o,n=i;break}u=u.sibling}if(!a)throw Error(ie(189))}}if(n.alternate!==r)throw Error(ie(190))}if(n.tag!==3)throw Error(ie(188));return n.stateNode.current===n?t:e}function Rk(t){return t=q2(t),t!==null?jk(t):null}function jk(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=jk(t);if(e!==null)return e;t=t.sibling}return null}var Lk=ur.unstable_scheduleCallback,Mv=ur.unstable_cancelCallback,$2=ur.unstable_shouldYield,H2=ur.unstable_requestPaint,Ot=ur.unstable_now,W2=ur.unstable_getCurrentPriorityLevel,Vy=ur.unstable_ImmediatePriority,Dk=ur.unstable_UserBlockingPriority,Zh=ur.unstable_NormalPriority,G2=ur.unstable_LowPriority,Mk=ur.unstable_IdlePriority,Hf=null,ui=null;function K2(t){if(ui&&typeof ui.onCommitFiberRoot=="function")try{ui.onCommitFiberRoot(Hf,t,void 0,(t.current.flags&128)===128)}catch{}}var qr=Math.clz32?Math.clz32:Y2,Z2=Math.log,Q2=Math.LN2;function Y2(t){return t>>>=0,t===0?32:31-(Z2(t)/Q2|0)|0}var Hd=64,Wd=4194304;function Wc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Qh(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,o=t.pingedLanes,a=n&268435455;if(a!==0){var u=a&~i;u!==0?r=Wc(u):(o&=a,o!==0&&(r=Wc(o)))}else a=n&~i,a!==0?r=Wc(a):o!==0&&(r=Wc(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,o=e&-e,i>=o||i===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-qr(e),i=1<<n,r|=t[n],e&=~i;return r}function J2(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function X2(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,o=t.pendingLanes;0<o;){var a=31-qr(o),u=1<<a,d=i[a];d===-1?(!(u&n)||u&r)&&(i[a]=J2(u,e)):d<=e&&(t.expiredLanes|=u),o&=~u}}function hg(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Ok(){var t=Hd;return Hd<<=1,!(Hd&4194240)&&(Hd=64),t}function op(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Xu(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-qr(e),t[e]=n}function eP(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-qr(n),o=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~o}}function Fy(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-qr(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var it=0;function Vk(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Fk,Uy,Uk,Bk,zk,fg=!1,Gd=[],Zs=null,Qs=null,Ys=null,bu=new Map,ku=new Map,Os=[],tP="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ov(t,e){switch(t){case"focusin":case"focusout":Zs=null;break;case"dragenter":case"dragleave":Qs=null;break;case"mouseover":case"mouseout":Ys=null;break;case"pointerover":case"pointerout":bu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ku.delete(e.pointerId)}}function Cc(t,e,n,r,i,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},e!==null&&(e=td(e),e!==null&&Uy(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function nP(t,e,n,r,i){switch(e){case"focusin":return Zs=Cc(Zs,t,e,n,r,i),!0;case"dragenter":return Qs=Cc(Qs,t,e,n,r,i),!0;case"mouseover":return Ys=Cc(Ys,t,e,n,r,i),!0;case"pointerover":var o=i.pointerId;return bu.set(o,Cc(bu.get(o)||null,t,e,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,ku.set(o,Cc(ku.get(o)||null,t,e,n,r,i)),!0}return!1}function qk(t){var e=Yo(t.target);if(e!==null){var n=Pa(e);if(n!==null){if(e=n.tag,e===13){if(e=Ak(n),e!==null){t.blockedOn=e,zk(t.priority,function(){Uk(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function xh(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=mg(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);lg=r,n.target.dispatchEvent(r),lg=null}else return e=td(n),e!==null&&Uy(e),t.blockedOn=n,!1;e.shift()}return!0}function Vv(t,e,n){xh(t)&&n.delete(e)}function rP(){fg=!1,Zs!==null&&xh(Zs)&&(Zs=null),Qs!==null&&xh(Qs)&&(Qs=null),Ys!==null&&xh(Ys)&&(Ys=null),bu.forEach(Vv),ku.forEach(Vv)}function Ac(t,e){t.blockedOn===e&&(t.blockedOn=null,fg||(fg=!0,ur.unstable_scheduleCallback(ur.unstable_NormalPriority,rP)))}function Iu(t){function e(i){return Ac(i,t)}if(0<Gd.length){Ac(Gd[0],t);for(var n=1;n<Gd.length;n++){var r=Gd[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Zs!==null&&Ac(Zs,t),Qs!==null&&Ac(Qs,t),Ys!==null&&Ac(Ys,t),bu.forEach(e),ku.forEach(e),n=0;n<Os.length;n++)r=Os[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Os.length&&(n=Os[0],n.blockedOn===null);)qk(n),n.blockedOn===null&&Os.shift()}var El=is.ReactCurrentBatchConfig,Yh=!0;function iP(t,e,n,r){var i=it,o=El.transition;El.transition=null;try{it=1,By(t,e,n,r)}finally{it=i,El.transition=o}}function sP(t,e,n,r){var i=it,o=El.transition;El.transition=null;try{it=4,By(t,e,n,r)}finally{it=i,El.transition=o}}function By(t,e,n,r){if(Yh){var i=mg(t,e,n,r);if(i===null)gp(t,e,r,Jh,n),Ov(t,r);else if(nP(i,t,e,n,r))r.stopPropagation();else if(Ov(t,r),e&4&&-1<tP.indexOf(t)){for(;i!==null;){var o=td(i);if(o!==null&&Fk(o),o=mg(t,e,n,r),o===null&&gp(t,e,r,Jh,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else gp(t,e,r,null,n)}}var Jh=null;function mg(t,e,n,r){if(Jh=null,t=Oy(r),t=Yo(t),t!==null)if(e=Pa(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Ak(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Jh=t,null}function $k(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(W2()){case Vy:return 1;case Dk:return 4;case Zh:case G2:return 16;case Mk:return 536870912;default:return 16}default:return 16}}var Hs=null,zy=null,wh=null;function Hk(){if(wh)return wh;var t,e=zy,n=e.length,r,i="value"in Hs?Hs.value:Hs.textContent,o=i.length;for(t=0;t<n&&e[t]===i[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===i[o-r];r++);return wh=i.slice(t,1<r?1-r:void 0)}function bh(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Kd(){return!0}function Fv(){return!1}function mr(t){function e(n,r,i,o,a){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=a,this.currentTarget=null;for(var u in t)t.hasOwnProperty(u)&&(n=t[u],this[u]=n?n(o):o[u]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Kd:Fv,this.isPropagationStopped=Fv,this}return Nt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Kd)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Kd)},persist:function(){},isPersistent:Kd}),e}var ic={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qy=mr(ic),ed=Nt({},ic,{view:0,detail:0}),oP=mr(ed),ap,lp,Rc,Wf=Nt({},ed,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:$y,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Rc&&(Rc&&t.type==="mousemove"?(ap=t.screenX-Rc.screenX,lp=t.screenY-Rc.screenY):lp=ap=0,Rc=t),ap)},movementY:function(t){return"movementY"in t?t.movementY:lp}}),Uv=mr(Wf),aP=Nt({},Wf,{dataTransfer:0}),lP=mr(aP),cP=Nt({},ed,{relatedTarget:0}),cp=mr(cP),uP=Nt({},ic,{animationName:0,elapsedTime:0,pseudoElement:0}),dP=mr(uP),hP=Nt({},ic,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),fP=mr(hP),mP=Nt({},ic,{data:0}),Bv=mr(mP),pP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gP={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yP={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _P(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=yP[t])?!!e[t]:!1}function $y(){return _P}var vP=Nt({},ed,{key:function(t){if(t.key){var e=pP[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=bh(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?gP[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:$y,charCode:function(t){return t.type==="keypress"?bh(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?bh(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),xP=mr(vP),wP=Nt({},Wf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),zv=mr(wP),bP=Nt({},ed,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:$y}),kP=mr(bP),IP=Nt({},ic,{propertyName:0,elapsedTime:0,pseudoElement:0}),TP=mr(IP),EP=Nt({},Wf,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),SP=mr(EP),NP=[9,13,27,32],Hy=Zi&&"CompositionEvent"in window,ru=null;Zi&&"documentMode"in document&&(ru=document.documentMode);var PP=Zi&&"TextEvent"in window&&!ru,Wk=Zi&&(!Hy||ru&&8<ru&&11>=ru),qv=" ",$v=!1;function Gk(t,e){switch(t){case"keyup":return NP.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Kk(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var hl=!1;function CP(t,e){switch(t){case"compositionend":return Kk(e);case"keypress":return e.which!==32?null:($v=!0,qv);case"textInput":return t=e.data,t===qv&&$v?null:t;default:return null}}function AP(t,e){if(hl)return t==="compositionend"||!Hy&&Gk(t,e)?(t=Hk(),wh=zy=Hs=null,hl=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Wk&&e.locale!=="ko"?null:e.data;default:return null}}var RP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hv(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!RP[t.type]:e==="textarea"}function Zk(t,e,n,r){Ek(r),e=Xh(e,"onChange"),0<e.length&&(n=new qy("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var iu=null,Tu=null;function jP(t){oI(t,0)}function Gf(t){var e=pl(t);if(vk(e))return t}function LP(t,e){if(t==="change")return e}var Qk=!1;if(Zi){var up;if(Zi){var dp="oninput"in document;if(!dp){var Wv=document.createElement("div");Wv.setAttribute("oninput","return;"),dp=typeof Wv.oninput=="function"}up=dp}else up=!1;Qk=up&&(!document.documentMode||9<document.documentMode)}function Gv(){iu&&(iu.detachEvent("onpropertychange",Yk),Tu=iu=null)}function Yk(t){if(t.propertyName==="value"&&Gf(Tu)){var e=[];Zk(e,Tu,t,Oy(t)),Ck(jP,e)}}function DP(t,e,n){t==="focusin"?(Gv(),iu=e,Tu=n,iu.attachEvent("onpropertychange",Yk)):t==="focusout"&&Gv()}function MP(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Gf(Tu)}function OP(t,e){if(t==="click")return Gf(e)}function VP(t,e){if(t==="input"||t==="change")return Gf(e)}function FP(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Wr=typeof Object.is=="function"?Object.is:FP;function Eu(t,e){if(Wr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Qp.call(e,i)||!Wr(t[i],e[i]))return!1}return!0}function Kv(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Zv(t,e){var n=Kv(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Kv(n)}}function Jk(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Jk(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Xk(){for(var t=window,e=Wh();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Wh(t.document)}return e}function Wy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function UP(t){var e=Xk(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Jk(n.ownerDocument.documentElement,n)){if(r!==null&&Wy(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!t.extend&&o>r&&(i=r,r=o,o=i),i=Zv(n,o);var a=Zv(n,r);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var BP=Zi&&"documentMode"in document&&11>=document.documentMode,fl=null,pg=null,su=null,gg=!1;function Qv(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;gg||fl==null||fl!==Wh(r)||(r=fl,"selectionStart"in r&&Wy(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),su&&Eu(su,r)||(su=r,r=Xh(pg,"onSelect"),0<r.length&&(e=new qy("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=fl)))}function Zd(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var ml={animationend:Zd("Animation","AnimationEnd"),animationiteration:Zd("Animation","AnimationIteration"),animationstart:Zd("Animation","AnimationStart"),transitionend:Zd("Transition","TransitionEnd")},hp={},eI={};Zi&&(eI=document.createElement("div").style,"AnimationEvent"in window||(delete ml.animationend.animation,delete ml.animationiteration.animation,delete ml.animationstart.animation),"TransitionEvent"in window||delete ml.transitionend.transition);function Kf(t){if(hp[t])return hp[t];if(!ml[t])return t;var e=ml[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in eI)return hp[t]=e[n];return t}var tI=Kf("animationend"),nI=Kf("animationiteration"),rI=Kf("animationstart"),iI=Kf("transitionend"),sI=new Map,Yv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function po(t,e){sI.set(t,e),Na(e,[t])}for(var fp=0;fp<Yv.length;fp++){var mp=Yv[fp],zP=mp.toLowerCase(),qP=mp[0].toUpperCase()+mp.slice(1);po(zP,"on"+qP)}po(tI,"onAnimationEnd");po(nI,"onAnimationIteration");po(rI,"onAnimationStart");po("dblclick","onDoubleClick");po("focusin","onFocus");po("focusout","onBlur");po(iI,"onTransitionEnd");Ll("onMouseEnter",["mouseout","mouseover"]);Ll("onMouseLeave",["mouseout","mouseover"]);Ll("onPointerEnter",["pointerout","pointerover"]);Ll("onPointerLeave",["pointerout","pointerover"]);Na("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Na("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Na("onBeforeInput",["compositionend","keypress","textInput","paste"]);Na("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Na("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Na("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Gc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$P=new Set("cancel close invalid load scroll toggle".split(" ").concat(Gc));function Jv(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,z2(r,e,void 0,t),t.currentTarget=null}function oI(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var a=r.length-1;0<=a;a--){var u=r[a],d=u.instance,m=u.currentTarget;if(u=u.listener,d!==o&&i.isPropagationStopped())break e;Jv(i,u,m),o=d}else for(a=0;a<r.length;a++){if(u=r[a],d=u.instance,m=u.currentTarget,u=u.listener,d!==o&&i.isPropagationStopped())break e;Jv(i,u,m),o=d}}}if(Kh)throw t=dg,Kh=!1,dg=null,t}function gt(t,e){var n=e[wg];n===void 0&&(n=e[wg]=new Set);var r=t+"__bubble";n.has(r)||(aI(e,t,2,!1),n.add(r))}function pp(t,e,n){var r=0;e&&(r|=4),aI(n,t,r,e)}var Qd="_reactListening"+Math.random().toString(36).slice(2);function Su(t){if(!t[Qd]){t[Qd]=!0,mk.forEach(function(n){n!=="selectionchange"&&($P.has(n)||pp(n,!1,t),pp(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Qd]||(e[Qd]=!0,pp("selectionchange",!1,e))}}function aI(t,e,n,r){switch($k(e)){case 1:var i=iP;break;case 4:i=sP;break;default:i=By}n=i.bind(null,e,n,t),i=void 0,!ug||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function gp(t,e,n,r,i){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var u=r.stateNode.containerInfo;if(u===i||u.nodeType===8&&u.parentNode===i)break;if(a===4)for(a=r.return;a!==null;){var d=a.tag;if((d===3||d===4)&&(d=a.stateNode.containerInfo,d===i||d.nodeType===8&&d.parentNode===i))return;a=a.return}for(;u!==null;){if(a=Yo(u),a===null)return;if(d=a.tag,d===5||d===6){r=o=a;continue e}u=u.parentNode}}r=r.return}Ck(function(){var m=o,g=Oy(n),v=[];e:{var w=sI.get(t);if(w!==void 0){var E=qy,C=t;switch(t){case"keypress":if(bh(n)===0)break e;case"keydown":case"keyup":E=xP;break;case"focusin":C="focus",E=cp;break;case"focusout":C="blur",E=cp;break;case"beforeblur":case"afterblur":E=cp;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":E=Uv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":E=lP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":E=kP;break;case tI:case nI:case rI:E=dP;break;case iI:E=TP;break;case"scroll":E=oP;break;case"wheel":E=SP;break;case"copy":case"cut":case"paste":E=fP;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":E=zv}var P=(e&4)!==0,F=!P&&t==="scroll",N=P?w!==null?w+"Capture":null:w;P=[];for(var T=m,A;T!==null;){A=T;var z=A.stateNode;if(A.tag===5&&z!==null&&(A=z,N!==null&&(z=wu(T,N),z!=null&&P.push(Nu(T,z,A)))),F)break;T=T.return}0<P.length&&(w=new E(w,C,null,n,g),v.push({event:w,listeners:P}))}}if(!(e&7)){e:{if(w=t==="mouseover"||t==="pointerover",E=t==="mouseout"||t==="pointerout",w&&n!==lg&&(C=n.relatedTarget||n.fromElement)&&(Yo(C)||C[Qi]))break e;if((E||w)&&(w=g.window===g?g:(w=g.ownerDocument)?w.defaultView||w.parentWindow:window,E?(C=n.relatedTarget||n.toElement,E=m,C=C?Yo(C):null,C!==null&&(F=Pa(C),C!==F||C.tag!==5&&C.tag!==6)&&(C=null)):(E=null,C=m),E!==C)){if(P=Uv,z="onMouseLeave",N="onMouseEnter",T="mouse",(t==="pointerout"||t==="pointerover")&&(P=zv,z="onPointerLeave",N="onPointerEnter",T="pointer"),F=E==null?w:pl(E),A=C==null?w:pl(C),w=new P(z,T+"leave",E,n,g),w.target=F,w.relatedTarget=A,z=null,Yo(g)===m&&(P=new P(N,T+"enter",C,n,g),P.target=A,P.relatedTarget=F,z=P),F=z,E&&C)t:{for(P=E,N=C,T=0,A=P;A;A=el(A))T++;for(A=0,z=N;z;z=el(z))A++;for(;0<T-A;)P=el(P),T--;for(;0<A-T;)N=el(N),A--;for(;T--;){if(P===N||N!==null&&P===N.alternate)break t;P=el(P),N=el(N)}P=null}else P=null;E!==null&&Xv(v,w,E,P,!1),C!==null&&F!==null&&Xv(v,F,C,P,!0)}}e:{if(w=m?pl(m):window,E=w.nodeName&&w.nodeName.toLowerCase(),E==="select"||E==="input"&&w.type==="file")var Z=LP;else if(Hv(w))if(Qk)Z=VP;else{Z=MP;var H=DP}else(E=w.nodeName)&&E.toLowerCase()==="input"&&(w.type==="checkbox"||w.type==="radio")&&(Z=OP);if(Z&&(Z=Z(t,m))){Zk(v,Z,n,g);break e}H&&H(t,w,m),t==="focusout"&&(H=w._wrapperState)&&H.controlled&&w.type==="number"&&rg(w,"number",w.value)}switch(H=m?pl(m):window,t){case"focusin":(Hv(H)||H.contentEditable==="true")&&(fl=H,pg=m,su=null);break;case"focusout":su=pg=fl=null;break;case"mousedown":gg=!0;break;case"contextmenu":case"mouseup":case"dragend":gg=!1,Qv(v,n,g);break;case"selectionchange":if(BP)break;case"keydown":case"keyup":Qv(v,n,g)}var I;if(Hy)e:{switch(t){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else hl?Gk(t,n)&&(b="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(b="onCompositionStart");b&&(Wk&&n.locale!=="ko"&&(hl||b!=="onCompositionStart"?b==="onCompositionEnd"&&hl&&(I=Hk()):(Hs=g,zy="value"in Hs?Hs.value:Hs.textContent,hl=!0)),H=Xh(m,b),0<H.length&&(b=new Bv(b,t,null,n,g),v.push({event:b,listeners:H}),I?b.data=I:(I=Kk(n),I!==null&&(b.data=I)))),(I=PP?CP(t,n):AP(t,n))&&(m=Xh(m,"onBeforeInput"),0<m.length&&(g=new Bv("onBeforeInput","beforeinput",null,n,g),v.push({event:g,listeners:m}),g.data=I))}oI(v,e)})}function Nu(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Xh(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=wu(t,n),o!=null&&r.unshift(Nu(t,o,i)),o=wu(t,e),o!=null&&r.push(Nu(t,o,i))),t=t.return}return r}function el(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Xv(t,e,n,r,i){for(var o=e._reactName,a=[];n!==null&&n!==r;){var u=n,d=u.alternate,m=u.stateNode;if(d!==null&&d===r)break;u.tag===5&&m!==null&&(u=m,i?(d=wu(n,o),d!=null&&a.unshift(Nu(n,d,u))):i||(d=wu(n,o),d!=null&&a.push(Nu(n,d,u)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var HP=/\r\n?/g,WP=/\u0000|\uFFFD/g;function ex(t){return(typeof t=="string"?t:""+t).replace(HP,`
`).replace(WP,"")}function Yd(t,e,n){if(e=ex(e),ex(t)!==e&&n)throw Error(ie(425))}function ef(){}var yg=null,_g=null;function vg(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var xg=typeof setTimeout=="function"?setTimeout:void 0,GP=typeof clearTimeout=="function"?clearTimeout:void 0,tx=typeof Promise=="function"?Promise:void 0,KP=typeof queueMicrotask=="function"?queueMicrotask:typeof tx<"u"?function(t){return tx.resolve(null).then(t).catch(ZP)}:xg;function ZP(t){setTimeout(function(){throw t})}function yp(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Iu(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Iu(e)}function Js(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function nx(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var sc=Math.random().toString(36).slice(2),oi="__reactFiber$"+sc,Pu="__reactProps$"+sc,Qi="__reactContainer$"+sc,wg="__reactEvents$"+sc,QP="__reactListeners$"+sc,YP="__reactHandles$"+sc;function Yo(t){var e=t[oi];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Qi]||n[oi]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=nx(t);t!==null;){if(n=t[oi])return n;t=nx(t)}return e}t=n,n=t.parentNode}return null}function td(t){return t=t[oi]||t[Qi],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function pl(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ie(33))}function Zf(t){return t[Pu]||null}var bg=[],gl=-1;function go(t){return{current:t}}function yt(t){0>gl||(t.current=bg[gl],bg[gl]=null,gl--)}function ut(t,e){gl++,bg[gl]=t.current,t.current=e}var oo={},kn=go(oo),Yn=go(!1),aa=oo;function Dl(t,e){var n=t.type.contextTypes;if(!n)return oo;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in n)i[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Jn(t){return t=t.childContextTypes,t!=null}function tf(){yt(Yn),yt(kn)}function rx(t,e,n){if(kn.current!==oo)throw Error(ie(168));ut(kn,e),ut(Yn,n)}function lI(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ie(108,D2(t)||"Unknown",i));return Nt({},n,r)}function nf(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||oo,aa=kn.current,ut(kn,t),ut(Yn,Yn.current),!0}function ix(t,e,n){var r=t.stateNode;if(!r)throw Error(ie(169));n?(t=lI(t,e,aa),r.__reactInternalMemoizedMergedChildContext=t,yt(Yn),yt(kn),ut(kn,t)):yt(Yn),ut(Yn,n)}var Di=null,Qf=!1,_p=!1;function cI(t){Di===null?Di=[t]:Di.push(t)}function JP(t){Qf=!0,cI(t)}function yo(){if(!_p&&Di!==null){_p=!0;var t=0,e=it;try{var n=Di;for(it=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Di=null,Qf=!1}catch(i){throw Di!==null&&(Di=Di.slice(t+1)),Lk(Vy,yo),i}finally{it=e,_p=!1}}return null}var yl=[],_l=0,rf=null,sf=0,wr=[],br=0,la=null,Oi=1,Vi="";function Bo(t,e){yl[_l++]=sf,yl[_l++]=rf,rf=t,sf=e}function uI(t,e,n){wr[br++]=Oi,wr[br++]=Vi,wr[br++]=la,la=t;var r=Oi;t=Vi;var i=32-qr(r)-1;r&=~(1<<i),n+=1;var o=32-qr(e)+i;if(30<o){var a=i-i%5;o=(r&(1<<a)-1).toString(32),r>>=a,i-=a,Oi=1<<32-qr(e)+i|n<<i|r,Vi=o+t}else Oi=1<<o|n<<i|r,Vi=t}function Gy(t){t.return!==null&&(Bo(t,1),uI(t,1,0))}function Ky(t){for(;t===rf;)rf=yl[--_l],yl[_l]=null,sf=yl[--_l],yl[_l]=null;for(;t===la;)la=wr[--br],wr[br]=null,Vi=wr[--br],wr[br]=null,Oi=wr[--br],wr[br]=null}var lr=null,sr=null,xt=!1,Ur=null;function dI(t,e){var n=Ir(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function sx(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,lr=t,sr=Js(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,lr=t,sr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=la!==null?{id:Oi,overflow:Vi}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Ir(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,lr=t,sr=null,!0):!1;default:return!1}}function kg(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Ig(t){if(xt){var e=sr;if(e){var n=e;if(!sx(t,e)){if(kg(t))throw Error(ie(418));e=Js(n.nextSibling);var r=lr;e&&sx(t,e)?dI(r,n):(t.flags=t.flags&-4097|2,xt=!1,lr=t)}}else{if(kg(t))throw Error(ie(418));t.flags=t.flags&-4097|2,xt=!1,lr=t}}}function ox(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;lr=t}function Jd(t){if(t!==lr)return!1;if(!xt)return ox(t),xt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!vg(t.type,t.memoizedProps)),e&&(e=sr)){if(kg(t))throw hI(),Error(ie(418));for(;e;)dI(t,e),e=Js(e.nextSibling)}if(ox(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ie(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){sr=Js(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}sr=null}}else sr=lr?Js(t.stateNode.nextSibling):null;return!0}function hI(){for(var t=sr;t;)t=Js(t.nextSibling)}function Ml(){sr=lr=null,xt=!1}function Zy(t){Ur===null?Ur=[t]:Ur.push(t)}var XP=is.ReactCurrentBatchConfig;function jc(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ie(309));var r=n.stateNode}if(!r)throw Error(ie(147,t));var i=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(a){var u=i.refs;a===null?delete u[o]:u[o]=a},e._stringRef=o,e)}if(typeof t!="string")throw Error(ie(284));if(!n._owner)throw Error(ie(290,t))}return t}function Xd(t,e){throw t=Object.prototype.toString.call(e),Error(ie(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function ax(t){var e=t._init;return e(t._payload)}function fI(t){function e(N,T){if(t){var A=N.deletions;A===null?(N.deletions=[T],N.flags|=16):A.push(T)}}function n(N,T){if(!t)return null;for(;T!==null;)e(N,T),T=T.sibling;return null}function r(N,T){for(N=new Map;T!==null;)T.key!==null?N.set(T.key,T):N.set(T.index,T),T=T.sibling;return N}function i(N,T){return N=no(N,T),N.index=0,N.sibling=null,N}function o(N,T,A){return N.index=A,t?(A=N.alternate,A!==null?(A=A.index,A<T?(N.flags|=2,T):A):(N.flags|=2,T)):(N.flags|=1048576,T)}function a(N){return t&&N.alternate===null&&(N.flags|=2),N}function u(N,T,A,z){return T===null||T.tag!==6?(T=Tp(A,N.mode,z),T.return=N,T):(T=i(T,A),T.return=N,T)}function d(N,T,A,z){var Z=A.type;return Z===dl?g(N,T,A.props.children,z,A.key):T!==null&&(T.elementType===Z||typeof Z=="object"&&Z!==null&&Z.$$typeof===js&&ax(Z)===T.type)?(z=i(T,A.props),z.ref=jc(N,T,A),z.return=N,z):(z=Ph(A.type,A.key,A.props,null,N.mode,z),z.ref=jc(N,T,A),z.return=N,z)}function m(N,T,A,z){return T===null||T.tag!==4||T.stateNode.containerInfo!==A.containerInfo||T.stateNode.implementation!==A.implementation?(T=Ep(A,N.mode,z),T.return=N,T):(T=i(T,A.children||[]),T.return=N,T)}function g(N,T,A,z,Z){return T===null||T.tag!==7?(T=ra(A,N.mode,z,Z),T.return=N,T):(T=i(T,A),T.return=N,T)}function v(N,T,A){if(typeof T=="string"&&T!==""||typeof T=="number")return T=Tp(""+T,N.mode,A),T.return=N,T;if(typeof T=="object"&&T!==null){switch(T.$$typeof){case zd:return A=Ph(T.type,T.key,T.props,null,N.mode,A),A.ref=jc(N,null,T),A.return=N,A;case ul:return T=Ep(T,N.mode,A),T.return=N,T;case js:var z=T._init;return v(N,z(T._payload),A)}if(Hc(T)||Nc(T))return T=ra(T,N.mode,A,null),T.return=N,T;Xd(N,T)}return null}function w(N,T,A,z){var Z=T!==null?T.key:null;if(typeof A=="string"&&A!==""||typeof A=="number")return Z!==null?null:u(N,T,""+A,z);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case zd:return A.key===Z?d(N,T,A,z):null;case ul:return A.key===Z?m(N,T,A,z):null;case js:return Z=A._init,w(N,T,Z(A._payload),z)}if(Hc(A)||Nc(A))return Z!==null?null:g(N,T,A,z,null);Xd(N,A)}return null}function E(N,T,A,z,Z){if(typeof z=="string"&&z!==""||typeof z=="number")return N=N.get(A)||null,u(T,N,""+z,Z);if(typeof z=="object"&&z!==null){switch(z.$$typeof){case zd:return N=N.get(z.key===null?A:z.key)||null,d(T,N,z,Z);case ul:return N=N.get(z.key===null?A:z.key)||null,m(T,N,z,Z);case js:var H=z._init;return E(N,T,A,H(z._payload),Z)}if(Hc(z)||Nc(z))return N=N.get(A)||null,g(T,N,z,Z,null);Xd(T,z)}return null}function C(N,T,A,z){for(var Z=null,H=null,I=T,b=T=0,R=null;I!==null&&b<A.length;b++){I.index>b?(R=I,I=null):R=I.sibling;var D=w(N,I,A[b],z);if(D===null){I===null&&(I=R);break}t&&I&&D.alternate===null&&e(N,I),T=o(D,T,b),H===null?Z=D:H.sibling=D,H=D,I=R}if(b===A.length)return n(N,I),xt&&Bo(N,b),Z;if(I===null){for(;b<A.length;b++)I=v(N,A[b],z),I!==null&&(T=o(I,T,b),H===null?Z=I:H.sibling=I,H=I);return xt&&Bo(N,b),Z}for(I=r(N,I);b<A.length;b++)R=E(I,N,b,A[b],z),R!==null&&(t&&R.alternate!==null&&I.delete(R.key===null?b:R.key),T=o(R,T,b),H===null?Z=R:H.sibling=R,H=R);return t&&I.forEach(function(O){return e(N,O)}),xt&&Bo(N,b),Z}function P(N,T,A,z){var Z=Nc(A);if(typeof Z!="function")throw Error(ie(150));if(A=Z.call(A),A==null)throw Error(ie(151));for(var H=Z=null,I=T,b=T=0,R=null,D=A.next();I!==null&&!D.done;b++,D=A.next()){I.index>b?(R=I,I=null):R=I.sibling;var O=w(N,I,D.value,z);if(O===null){I===null&&(I=R);break}t&&I&&O.alternate===null&&e(N,I),T=o(O,T,b),H===null?Z=O:H.sibling=O,H=O,I=R}if(D.done)return n(N,I),xt&&Bo(N,b),Z;if(I===null){for(;!D.done;b++,D=A.next())D=v(N,D.value,z),D!==null&&(T=o(D,T,b),H===null?Z=D:H.sibling=D,H=D);return xt&&Bo(N,b),Z}for(I=r(N,I);!D.done;b++,D=A.next())D=E(I,N,b,D.value,z),D!==null&&(t&&D.alternate!==null&&I.delete(D.key===null?b:D.key),T=o(D,T,b),H===null?Z=D:H.sibling=D,H=D);return t&&I.forEach(function(B){return e(N,B)}),xt&&Bo(N,b),Z}function F(N,T,A,z){if(typeof A=="object"&&A!==null&&A.type===dl&&A.key===null&&(A=A.props.children),typeof A=="object"&&A!==null){switch(A.$$typeof){case zd:e:{for(var Z=A.key,H=T;H!==null;){if(H.key===Z){if(Z=A.type,Z===dl){if(H.tag===7){n(N,H.sibling),T=i(H,A.props.children),T.return=N,N=T;break e}}else if(H.elementType===Z||typeof Z=="object"&&Z!==null&&Z.$$typeof===js&&ax(Z)===H.type){n(N,H.sibling),T=i(H,A.props),T.ref=jc(N,H,A),T.return=N,N=T;break e}n(N,H);break}else e(N,H);H=H.sibling}A.type===dl?(T=ra(A.props.children,N.mode,z,A.key),T.return=N,N=T):(z=Ph(A.type,A.key,A.props,null,N.mode,z),z.ref=jc(N,T,A),z.return=N,N=z)}return a(N);case ul:e:{for(H=A.key;T!==null;){if(T.key===H)if(T.tag===4&&T.stateNode.containerInfo===A.containerInfo&&T.stateNode.implementation===A.implementation){n(N,T.sibling),T=i(T,A.children||[]),T.return=N,N=T;break e}else{n(N,T);break}else e(N,T);T=T.sibling}T=Ep(A,N.mode,z),T.return=N,N=T}return a(N);case js:return H=A._init,F(N,T,H(A._payload),z)}if(Hc(A))return C(N,T,A,z);if(Nc(A))return P(N,T,A,z);Xd(N,A)}return typeof A=="string"&&A!==""||typeof A=="number"?(A=""+A,T!==null&&T.tag===6?(n(N,T.sibling),T=i(T,A),T.return=N,N=T):(n(N,T),T=Tp(A,N.mode,z),T.return=N,N=T),a(N)):n(N,T)}return F}var Ol=fI(!0),mI=fI(!1),of=go(null),af=null,vl=null,Qy=null;function Yy(){Qy=vl=af=null}function Jy(t){var e=of.current;yt(of),t._currentValue=e}function Tg(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Sl(t,e){af=t,Qy=vl=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Kn=!0),t.firstContext=null)}function Er(t){var e=t._currentValue;if(Qy!==t)if(t={context:t,memoizedValue:e,next:null},vl===null){if(af===null)throw Error(ie(308));vl=t,af.dependencies={lanes:0,firstContext:t}}else vl=vl.next=t;return e}var Jo=null;function Xy(t){Jo===null?Jo=[t]:Jo.push(t)}function pI(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Xy(e)):(n.next=i.next,i.next=n),e.interleaved=n,Yi(t,r)}function Yi(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ls=!1;function e0(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function gI(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Hi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Xs(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Je&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Yi(t,n)}return i=r.interleaved,i===null?(e.next=e,Xy(r)):(e.next=i.next,i.next=e),r.interleaved=e,Yi(t,n)}function kh(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Fy(t,n)}}function lx(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?i=o=a:o=o.next=a,n=n.next}while(n!==null);o===null?i=o=e:o=o.next=e}else i=o=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function lf(t,e,n,r){var i=t.updateQueue;Ls=!1;var o=i.firstBaseUpdate,a=i.lastBaseUpdate,u=i.shared.pending;if(u!==null){i.shared.pending=null;var d=u,m=d.next;d.next=null,a===null?o=m:a.next=m,a=d;var g=t.alternate;g!==null&&(g=g.updateQueue,u=g.lastBaseUpdate,u!==a&&(u===null?g.firstBaseUpdate=m:u.next=m,g.lastBaseUpdate=d))}if(o!==null){var v=i.baseState;a=0,g=m=d=null,u=o;do{var w=u.lane,E=u.eventTime;if((r&w)===w){g!==null&&(g=g.next={eventTime:E,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var C=t,P=u;switch(w=e,E=n,P.tag){case 1:if(C=P.payload,typeof C=="function"){v=C.call(E,v,w);break e}v=C;break e;case 3:C.flags=C.flags&-65537|128;case 0:if(C=P.payload,w=typeof C=="function"?C.call(E,v,w):C,w==null)break e;v=Nt({},v,w);break e;case 2:Ls=!0}}u.callback!==null&&u.lane!==0&&(t.flags|=64,w=i.effects,w===null?i.effects=[u]:w.push(u))}else E={eventTime:E,lane:w,tag:u.tag,payload:u.payload,callback:u.callback,next:null},g===null?(m=g=E,d=v):g=g.next=E,a|=w;if(u=u.next,u===null){if(u=i.shared.pending,u===null)break;w=u,u=w.next,w.next=null,i.lastBaseUpdate=w,i.shared.pending=null}}while(!0);if(g===null&&(d=v),i.baseState=d,i.firstBaseUpdate=m,i.lastBaseUpdate=g,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else o===null&&(i.shared.lanes=0);ua|=a,t.lanes=a,t.memoizedState=v}}function cx(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ie(191,i));i.call(r)}}}var nd={},di=go(nd),Cu=go(nd),Au=go(nd);function Xo(t){if(t===nd)throw Error(ie(174));return t}function t0(t,e){switch(ut(Au,e),ut(Cu,t),ut(di,nd),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:sg(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=sg(e,t)}yt(di),ut(di,e)}function Vl(){yt(di),yt(Cu),yt(Au)}function yI(t){Xo(Au.current);var e=Xo(di.current),n=sg(e,t.type);e!==n&&(ut(Cu,t),ut(di,n))}function n0(t){Cu.current===t&&(yt(di),yt(Cu))}var Et=go(0);function cf(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var vp=[];function r0(){for(var t=0;t<vp.length;t++)vp[t]._workInProgressVersionPrimary=null;vp.length=0}var Ih=is.ReactCurrentDispatcher,xp=is.ReactCurrentBatchConfig,ca=0,St=null,Wt=null,en=null,uf=!1,ou=!1,Ru=0,eC=0;function fn(){throw Error(ie(321))}function i0(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Wr(t[n],e[n]))return!1;return!0}function s0(t,e,n,r,i,o){if(ca=o,St=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ih.current=t===null||t.memoizedState===null?iC:sC,t=n(r,i),ou){o=0;do{if(ou=!1,Ru=0,25<=o)throw Error(ie(301));o+=1,en=Wt=null,e.updateQueue=null,Ih.current=oC,t=n(r,i)}while(ou)}if(Ih.current=df,e=Wt!==null&&Wt.next!==null,ca=0,en=Wt=St=null,uf=!1,e)throw Error(ie(300));return t}function o0(){var t=Ru!==0;return Ru=0,t}function si(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return en===null?St.memoizedState=en=t:en=en.next=t,en}function Sr(){if(Wt===null){var t=St.alternate;t=t!==null?t.memoizedState:null}else t=Wt.next;var e=en===null?St.memoizedState:en.next;if(e!==null)en=e,Wt=t;else{if(t===null)throw Error(ie(310));Wt=t,t={memoizedState:Wt.memoizedState,baseState:Wt.baseState,baseQueue:Wt.baseQueue,queue:Wt.queue,next:null},en===null?St.memoizedState=en=t:en=en.next=t}return en}function ju(t,e){return typeof e=="function"?e(t):e}function wp(t){var e=Sr(),n=e.queue;if(n===null)throw Error(ie(311));n.lastRenderedReducer=t;var r=Wt,i=r.baseQueue,o=n.pending;if(o!==null){if(i!==null){var a=i.next;i.next=o.next,o.next=a}r.baseQueue=i=o,n.pending=null}if(i!==null){o=i.next,r=r.baseState;var u=a=null,d=null,m=o;do{var g=m.lane;if((ca&g)===g)d!==null&&(d=d.next={lane:0,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null}),r=m.hasEagerState?m.eagerState:t(r,m.action);else{var v={lane:g,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null};d===null?(u=d=v,a=r):d=d.next=v,St.lanes|=g,ua|=g}m=m.next}while(m!==null&&m!==o);d===null?a=r:d.next=u,Wr(r,e.memoizedState)||(Kn=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=d,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do o=i.lane,St.lanes|=o,ua|=o,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function bp(t){var e=Sr(),n=e.queue;if(n===null)throw Error(ie(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,o=e.memoizedState;if(i!==null){n.pending=null;var a=i=i.next;do o=t(o,a.action),a=a.next;while(a!==i);Wr(o,e.memoizedState)||(Kn=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function _I(){}function vI(t,e){var n=St,r=Sr(),i=e(),o=!Wr(r.memoizedState,i);if(o&&(r.memoizedState=i,Kn=!0),r=r.queue,a0(bI.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||en!==null&&en.memoizedState.tag&1){if(n.flags|=2048,Lu(9,wI.bind(null,n,r,i,e),void 0,null),tn===null)throw Error(ie(349));ca&30||xI(n,e,i)}return i}function xI(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=St.updateQueue,e===null?(e={lastEffect:null,stores:null},St.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function wI(t,e,n,r){e.value=n,e.getSnapshot=r,kI(e)&&II(t)}function bI(t,e,n){return n(function(){kI(e)&&II(t)})}function kI(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Wr(t,n)}catch{return!0}}function II(t){var e=Yi(t,1);e!==null&&$r(e,t,1,-1)}function ux(t){var e=si();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ju,lastRenderedState:t},e.queue=t,t=t.dispatch=rC.bind(null,St,t),[e.memoizedState,t]}function Lu(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=St.updateQueue,e===null?(e={lastEffect:null,stores:null},St.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function TI(){return Sr().memoizedState}function Th(t,e,n,r){var i=si();St.flags|=t,i.memoizedState=Lu(1|e,n,void 0,r===void 0?null:r)}function Yf(t,e,n,r){var i=Sr();r=r===void 0?null:r;var o=void 0;if(Wt!==null){var a=Wt.memoizedState;if(o=a.destroy,r!==null&&i0(r,a.deps)){i.memoizedState=Lu(e,n,o,r);return}}St.flags|=t,i.memoizedState=Lu(1|e,n,o,r)}function dx(t,e){return Th(8390656,8,t,e)}function a0(t,e){return Yf(2048,8,t,e)}function EI(t,e){return Yf(4,2,t,e)}function SI(t,e){return Yf(4,4,t,e)}function NI(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function PI(t,e,n){return n=n!=null?n.concat([t]):null,Yf(4,4,NI.bind(null,e,t),n)}function l0(){}function CI(t,e){var n=Sr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&i0(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function AI(t,e){var n=Sr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&i0(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function RI(t,e,n){return ca&21?(Wr(n,e)||(n=Ok(),St.lanes|=n,ua|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Kn=!0),t.memoizedState=n)}function tC(t,e){var n=it;it=n!==0&&4>n?n:4,t(!0);var r=xp.transition;xp.transition={};try{t(!1),e()}finally{it=n,xp.transition=r}}function jI(){return Sr().memoizedState}function nC(t,e,n){var r=to(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},LI(t))DI(e,n);else if(n=pI(t,e,n,r),n!==null){var i=jn();$r(n,t,r,i),MI(n,e,r)}}function rC(t,e,n){var r=to(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(LI(t))DI(e,i);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var a=e.lastRenderedState,u=o(a,n);if(i.hasEagerState=!0,i.eagerState=u,Wr(u,a)){var d=e.interleaved;d===null?(i.next=i,Xy(e)):(i.next=d.next,d.next=i),e.interleaved=i;return}}catch{}finally{}n=pI(t,e,i,r),n!==null&&(i=jn(),$r(n,t,r,i),MI(n,e,r))}}function LI(t){var e=t.alternate;return t===St||e!==null&&e===St}function DI(t,e){ou=uf=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function MI(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Fy(t,n)}}var df={readContext:Er,useCallback:fn,useContext:fn,useEffect:fn,useImperativeHandle:fn,useInsertionEffect:fn,useLayoutEffect:fn,useMemo:fn,useReducer:fn,useRef:fn,useState:fn,useDebugValue:fn,useDeferredValue:fn,useTransition:fn,useMutableSource:fn,useSyncExternalStore:fn,useId:fn,unstable_isNewReconciler:!1},iC={readContext:Er,useCallback:function(t,e){return si().memoizedState=[t,e===void 0?null:e],t},useContext:Er,useEffect:dx,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Th(4194308,4,NI.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Th(4194308,4,t,e)},useInsertionEffect:function(t,e){return Th(4,2,t,e)},useMemo:function(t,e){var n=si();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=si();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=nC.bind(null,St,t),[r.memoizedState,t]},useRef:function(t){var e=si();return t={current:t},e.memoizedState=t},useState:ux,useDebugValue:l0,useDeferredValue:function(t){return si().memoizedState=t},useTransition:function(){var t=ux(!1),e=t[0];return t=tC.bind(null,t[1]),si().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=St,i=si();if(xt){if(n===void 0)throw Error(ie(407));n=n()}else{if(n=e(),tn===null)throw Error(ie(349));ca&30||xI(r,e,n)}i.memoizedState=n;var o={value:n,getSnapshot:e};return i.queue=o,dx(bI.bind(null,r,o,t),[t]),r.flags|=2048,Lu(9,wI.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=si(),e=tn.identifierPrefix;if(xt){var n=Vi,r=Oi;n=(r&~(1<<32-qr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Ru++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=eC++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},sC={readContext:Er,useCallback:CI,useContext:Er,useEffect:a0,useImperativeHandle:PI,useInsertionEffect:EI,useLayoutEffect:SI,useMemo:AI,useReducer:wp,useRef:TI,useState:function(){return wp(ju)},useDebugValue:l0,useDeferredValue:function(t){var e=Sr();return RI(e,Wt.memoizedState,t)},useTransition:function(){var t=wp(ju)[0],e=Sr().memoizedState;return[t,e]},useMutableSource:_I,useSyncExternalStore:vI,useId:jI,unstable_isNewReconciler:!1},oC={readContext:Er,useCallback:CI,useContext:Er,useEffect:a0,useImperativeHandle:PI,useInsertionEffect:EI,useLayoutEffect:SI,useMemo:AI,useReducer:bp,useRef:TI,useState:function(){return bp(ju)},useDebugValue:l0,useDeferredValue:function(t){var e=Sr();return Wt===null?e.memoizedState=t:RI(e,Wt.memoizedState,t)},useTransition:function(){var t=bp(ju)[0],e=Sr().memoizedState;return[t,e]},useMutableSource:_I,useSyncExternalStore:vI,useId:jI,unstable_isNewReconciler:!1};function Vr(t,e){if(t&&t.defaultProps){e=Nt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Eg(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Nt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Jf={isMounted:function(t){return(t=t._reactInternals)?Pa(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=jn(),i=to(t),o=Hi(r,i);o.payload=e,n!=null&&(o.callback=n),e=Xs(t,o,i),e!==null&&($r(e,t,i,r),kh(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=jn(),i=to(t),o=Hi(r,i);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=Xs(t,o,i),e!==null&&($r(e,t,i,r),kh(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=jn(),r=to(t),i=Hi(n,r);i.tag=2,e!=null&&(i.callback=e),e=Xs(t,i,r),e!==null&&($r(e,t,r,n),kh(e,t,r))}};function hx(t,e,n,r,i,o,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,a):e.prototype&&e.prototype.isPureReactComponent?!Eu(n,r)||!Eu(i,o):!0}function OI(t,e,n){var r=!1,i=oo,o=e.contextType;return typeof o=="object"&&o!==null?o=Er(o):(i=Jn(e)?aa:kn.current,r=e.contextTypes,o=(r=r!=null)?Dl(t,i):oo),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Jf,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function fx(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Jf.enqueueReplaceState(e,e.state,null)}function Sg(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},e0(t);var o=e.contextType;typeof o=="object"&&o!==null?i.context=Er(o):(o=Jn(e)?aa:kn.current,i.context=Dl(t,o)),i.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(Eg(t,e,o,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Jf.enqueueReplaceState(i,i.state,null),lf(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Fl(t,e){try{var n="",r=e;do n+=L2(r),r=r.return;while(r);var i=n}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:i,digest:null}}function kp(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Ng(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var aC=typeof WeakMap=="function"?WeakMap:Map;function VI(t,e,n){n=Hi(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){ff||(ff=!0,Vg=r),Ng(t,e)},n}function FI(t,e,n){n=Hi(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Ng(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){Ng(t,e),typeof r!="function"&&(eo===null?eo=new Set([this]):eo.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function mx(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new aC;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=wC.bind(null,t,e,n),e.then(t,t))}function px(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function gx(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Hi(-1,1),e.tag=2,Xs(n,e,1))),n.lanes|=1),t)}var lC=is.ReactCurrentOwner,Kn=!1;function An(t,e,n,r){e.child=t===null?mI(e,null,n,r):Ol(e,t.child,n,r)}function yx(t,e,n,r,i){n=n.render;var o=e.ref;return Sl(e,i),r=s0(t,e,n,r,o,i),n=o0(),t!==null&&!Kn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ji(t,e,i)):(xt&&n&&Gy(e),e.flags|=1,An(t,e,r,i),e.child)}function _x(t,e,n,r,i){if(t===null){var o=n.type;return typeof o=="function"&&!g0(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,UI(t,e,o,r,i)):(t=Ph(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&i)){var a=o.memoizedProps;if(n=n.compare,n=n!==null?n:Eu,n(a,r)&&t.ref===e.ref)return Ji(t,e,i)}return e.flags|=1,t=no(o,r),t.ref=e.ref,t.return=e,e.child=t}function UI(t,e,n,r,i){if(t!==null){var o=t.memoizedProps;if(Eu(o,r)&&t.ref===e.ref)if(Kn=!1,e.pendingProps=r=o,(t.lanes&i)!==0)t.flags&131072&&(Kn=!0);else return e.lanes=t.lanes,Ji(t,e,i)}return Pg(t,e,n,r,i)}function BI(t,e,n){var r=e.pendingProps,i=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ut(wl,ir),ir|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ut(wl,ir),ir|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,ut(wl,ir),ir|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,ut(wl,ir),ir|=r;return An(t,e,i,n),e.child}function zI(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Pg(t,e,n,r,i){var o=Jn(n)?aa:kn.current;return o=Dl(e,o),Sl(e,i),n=s0(t,e,n,r,o,i),r=o0(),t!==null&&!Kn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ji(t,e,i)):(xt&&r&&Gy(e),e.flags|=1,An(t,e,n,i),e.child)}function vx(t,e,n,r,i){if(Jn(n)){var o=!0;nf(e)}else o=!1;if(Sl(e,i),e.stateNode===null)Eh(t,e),OI(e,n,r),Sg(e,n,r,i),r=!0;else if(t===null){var a=e.stateNode,u=e.memoizedProps;a.props=u;var d=a.context,m=n.contextType;typeof m=="object"&&m!==null?m=Er(m):(m=Jn(n)?aa:kn.current,m=Dl(e,m));var g=n.getDerivedStateFromProps,v=typeof g=="function"||typeof a.getSnapshotBeforeUpdate=="function";v||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(u!==r||d!==m)&&fx(e,a,r,m),Ls=!1;var w=e.memoizedState;a.state=w,lf(e,r,a,i),d=e.memoizedState,u!==r||w!==d||Yn.current||Ls?(typeof g=="function"&&(Eg(e,n,g,r),d=e.memoizedState),(u=Ls||hx(e,n,u,r,w,d,m))?(v||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=d),a.props=r,a.state=d,a.context=m,r=u):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,gI(t,e),u=e.memoizedProps,m=e.type===e.elementType?u:Vr(e.type,u),a.props=m,v=e.pendingProps,w=a.context,d=n.contextType,typeof d=="object"&&d!==null?d=Er(d):(d=Jn(n)?aa:kn.current,d=Dl(e,d));var E=n.getDerivedStateFromProps;(g=typeof E=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(u!==v||w!==d)&&fx(e,a,r,d),Ls=!1,w=e.memoizedState,a.state=w,lf(e,r,a,i);var C=e.memoizedState;u!==v||w!==C||Yn.current||Ls?(typeof E=="function"&&(Eg(e,n,E,r),C=e.memoizedState),(m=Ls||hx(e,n,m,r,w,C,d)||!1)?(g||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,C,d),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,C,d)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||u===t.memoizedProps&&w===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&w===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=C),a.props=r,a.state=C,a.context=d,r=m):(typeof a.componentDidUpdate!="function"||u===t.memoizedProps&&w===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&w===t.memoizedState||(e.flags|=1024),r=!1)}return Cg(t,e,n,r,o,i)}function Cg(t,e,n,r,i,o){zI(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return i&&ix(e,n,!1),Ji(t,e,o);r=e.stateNode,lC.current=e;var u=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=Ol(e,t.child,null,o),e.child=Ol(e,null,u,o)):An(t,e,u,o),e.memoizedState=r.state,i&&ix(e,n,!0),e.child}function qI(t){var e=t.stateNode;e.pendingContext?rx(t,e.pendingContext,e.pendingContext!==e.context):e.context&&rx(t,e.context,!1),t0(t,e.containerInfo)}function xx(t,e,n,r,i){return Ml(),Zy(i),e.flags|=256,An(t,e,n,r),e.child}var Ag={dehydrated:null,treeContext:null,retryLane:0};function Rg(t){return{baseLanes:t,cachePool:null,transitions:null}}function $I(t,e,n){var r=e.pendingProps,i=Et.current,o=!1,a=(e.flags&128)!==0,u;if((u=a)||(u=t!==null&&t.memoizedState===null?!1:(i&2)!==0),u?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),ut(Et,i&1),t===null)return Ig(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,o?(r=e.mode,o=e.child,a={mode:"hidden",children:a},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=a):o=tm(a,r,0,null),t=ra(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=Rg(n),e.memoizedState=Ag,t):c0(e,a));if(i=t.memoizedState,i!==null&&(u=i.dehydrated,u!==null))return cC(t,e,a,r,u,i,n);if(o){o=r.fallback,a=e.mode,i=t.child,u=i.sibling;var d={mode:"hidden",children:r.children};return!(a&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=d,e.deletions=null):(r=no(i,d),r.subtreeFlags=i.subtreeFlags&14680064),u!==null?o=no(u,o):(o=ra(o,a,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,a=t.child.memoizedState,a=a===null?Rg(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},o.memoizedState=a,o.childLanes=t.childLanes&~n,e.memoizedState=Ag,r}return o=t.child,t=o.sibling,r=no(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function c0(t,e){return e=tm({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function eh(t,e,n,r){return r!==null&&Zy(r),Ol(e,t.child,null,n),t=c0(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function cC(t,e,n,r,i,o,a){if(n)return e.flags&256?(e.flags&=-257,r=kp(Error(ie(422))),eh(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,i=e.mode,r=tm({mode:"visible",children:r.children},i,0,null),o=ra(o,i,a,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&Ol(e,t.child,null,a),e.child.memoizedState=Rg(a),e.memoizedState=Ag,o);if(!(e.mode&1))return eh(t,e,a,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var u=r.dgst;return r=u,o=Error(ie(419)),r=kp(o,r,void 0),eh(t,e,a,r)}if(u=(a&t.childLanes)!==0,Kn||u){if(r=tn,r!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|a)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,Yi(t,i),$r(r,t,i,-1))}return p0(),r=kp(Error(ie(421))),eh(t,e,a,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=bC.bind(null,t),i._reactRetry=e,null):(t=o.treeContext,sr=Js(i.nextSibling),lr=e,xt=!0,Ur=null,t!==null&&(wr[br++]=Oi,wr[br++]=Vi,wr[br++]=la,Oi=t.id,Vi=t.overflow,la=e),e=c0(e,r.children),e.flags|=4096,e)}function wx(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Tg(t.return,e,n)}function Ip(t,e,n,r,i){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function HI(t,e,n){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(An(t,e,r.children,n),r=Et.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&wx(t,n,e);else if(t.tag===19)wx(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ut(Et,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&cf(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Ip(e,!1,i,n,o);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&cf(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Ip(e,!0,n,null,o);break;case"together":Ip(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Eh(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ji(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ua|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ie(153));if(e.child!==null){for(t=e.child,n=no(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=no(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function uC(t,e,n){switch(e.tag){case 3:qI(e),Ml();break;case 5:yI(e);break;case 1:Jn(e.type)&&nf(e);break;case 4:t0(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;ut(of,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ut(Et,Et.current&1),e.flags|=128,null):n&e.child.childLanes?$I(t,e,n):(ut(Et,Et.current&1),t=Ji(t,e,n),t!==null?t.sibling:null);ut(Et,Et.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return HI(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ut(Et,Et.current),r)break;return null;case 22:case 23:return e.lanes=0,BI(t,e,n)}return Ji(t,e,n)}var WI,jg,GI,KI;WI=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};jg=function(){};GI=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Xo(di.current);var o=null;switch(n){case"input":i=tg(t,i),r=tg(t,r),o=[];break;case"select":i=Nt({},i,{value:void 0}),r=Nt({},r,{value:void 0}),o=[];break;case"textarea":i=ig(t,i),r=ig(t,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=ef)}og(n,r);var a;n=null;for(m in i)if(!r.hasOwnProperty(m)&&i.hasOwnProperty(m)&&i[m]!=null)if(m==="style"){var u=i[m];for(a in u)u.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else m!=="dangerouslySetInnerHTML"&&m!=="children"&&m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&m!=="autoFocus"&&(vu.hasOwnProperty(m)?o||(o=[]):(o=o||[]).push(m,null));for(m in r){var d=r[m];if(u=i!=null?i[m]:void 0,r.hasOwnProperty(m)&&d!==u&&(d!=null||u!=null))if(m==="style")if(u){for(a in u)!u.hasOwnProperty(a)||d&&d.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in d)d.hasOwnProperty(a)&&u[a]!==d[a]&&(n||(n={}),n[a]=d[a])}else n||(o||(o=[]),o.push(m,n)),n=d;else m==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,u=u?u.__html:void 0,d!=null&&u!==d&&(o=o||[]).push(m,d)):m==="children"?typeof d!="string"&&typeof d!="number"||(o=o||[]).push(m,""+d):m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&(vu.hasOwnProperty(m)?(d!=null&&m==="onScroll"&&gt("scroll",t),o||u===d||(o=[])):(o=o||[]).push(m,d))}n&&(o=o||[]).push("style",n);var m=o;(e.updateQueue=m)&&(e.flags|=4)}};KI=function(t,e,n,r){n!==r&&(e.flags|=4)};function Lc(t,e){if(!xt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function mn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function dC(t,e,n){var r=e.pendingProps;switch(Ky(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return mn(e),null;case 1:return Jn(e.type)&&tf(),mn(e),null;case 3:return r=e.stateNode,Vl(),yt(Yn),yt(kn),r0(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Jd(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ur!==null&&(Bg(Ur),Ur=null))),jg(t,e),mn(e),null;case 5:n0(e);var i=Xo(Au.current);if(n=e.type,t!==null&&e.stateNode!=null)GI(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ie(166));return mn(e),null}if(t=Xo(di.current),Jd(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[oi]=e,r[Pu]=o,t=(e.mode&1)!==0,n){case"dialog":gt("cancel",r),gt("close",r);break;case"iframe":case"object":case"embed":gt("load",r);break;case"video":case"audio":for(i=0;i<Gc.length;i++)gt(Gc[i],r);break;case"source":gt("error",r);break;case"img":case"image":case"link":gt("error",r),gt("load",r);break;case"details":gt("toggle",r);break;case"input":Cv(r,o),gt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},gt("invalid",r);break;case"textarea":Rv(r,o),gt("invalid",r)}og(n,o),i=null;for(var a in o)if(o.hasOwnProperty(a)){var u=o[a];a==="children"?typeof u=="string"?r.textContent!==u&&(o.suppressHydrationWarning!==!0&&Yd(r.textContent,u,t),i=["children",u]):typeof u=="number"&&r.textContent!==""+u&&(o.suppressHydrationWarning!==!0&&Yd(r.textContent,u,t),i=["children",""+u]):vu.hasOwnProperty(a)&&u!=null&&a==="onScroll"&&gt("scroll",r)}switch(n){case"input":qd(r),Av(r,o,!0);break;case"textarea":qd(r),jv(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=ef)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=bk(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[oi]=e,t[Pu]=r,WI(t,e,!1,!1),e.stateNode=t;e:{switch(a=ag(n,r),n){case"dialog":gt("cancel",t),gt("close",t),i=r;break;case"iframe":case"object":case"embed":gt("load",t),i=r;break;case"video":case"audio":for(i=0;i<Gc.length;i++)gt(Gc[i],t);i=r;break;case"source":gt("error",t),i=r;break;case"img":case"image":case"link":gt("error",t),gt("load",t),i=r;break;case"details":gt("toggle",t),i=r;break;case"input":Cv(t,r),i=tg(t,r),gt("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Nt({},r,{value:void 0}),gt("invalid",t);break;case"textarea":Rv(t,r),i=ig(t,r),gt("invalid",t);break;default:i=r}og(n,i),u=i;for(o in u)if(u.hasOwnProperty(o)){var d=u[o];o==="style"?Tk(t,d):o==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,d!=null&&kk(t,d)):o==="children"?typeof d=="string"?(n!=="textarea"||d!=="")&&xu(t,d):typeof d=="number"&&xu(t,""+d):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(vu.hasOwnProperty(o)?d!=null&&o==="onScroll"&&gt("scroll",t):d!=null&&jy(t,o,d,a))}switch(n){case"input":qd(t),Av(t,r,!1);break;case"textarea":qd(t),jv(t);break;case"option":r.value!=null&&t.setAttribute("value",""+so(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?kl(t,!!r.multiple,o,!1):r.defaultValue!=null&&kl(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=ef)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return mn(e),null;case 6:if(t&&e.stateNode!=null)KI(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ie(166));if(n=Xo(Au.current),Xo(di.current),Jd(e)){if(r=e.stateNode,n=e.memoizedProps,r[oi]=e,(o=r.nodeValue!==n)&&(t=lr,t!==null))switch(t.tag){case 3:Yd(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Yd(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[oi]=e,e.stateNode=r}return mn(e),null;case 13:if(yt(Et),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(xt&&sr!==null&&e.mode&1&&!(e.flags&128))hI(),Ml(),e.flags|=98560,o=!1;else if(o=Jd(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(ie(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(ie(317));o[oi]=e}else Ml(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;mn(e),o=!1}else Ur!==null&&(Bg(Ur),Ur=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Et.current&1?Gt===0&&(Gt=3):p0())),e.updateQueue!==null&&(e.flags|=4),mn(e),null);case 4:return Vl(),jg(t,e),t===null&&Su(e.stateNode.containerInfo),mn(e),null;case 10:return Jy(e.type._context),mn(e),null;case 17:return Jn(e.type)&&tf(),mn(e),null;case 19:if(yt(Et),o=e.memoizedState,o===null)return mn(e),null;if(r=(e.flags&128)!==0,a=o.rendering,a===null)if(r)Lc(o,!1);else{if(Gt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=cf(t),a!==null){for(e.flags|=128,Lc(o,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,a=o.alternate,a===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=a.childLanes,o.lanes=a.lanes,o.child=a.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=a.memoizedProps,o.memoizedState=a.memoizedState,o.updateQueue=a.updateQueue,o.type=a.type,t=a.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ut(Et,Et.current&1|2),e.child}t=t.sibling}o.tail!==null&&Ot()>Ul&&(e.flags|=128,r=!0,Lc(o,!1),e.lanes=4194304)}else{if(!r)if(t=cf(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Lc(o,!0),o.tail===null&&o.tailMode==="hidden"&&!a.alternate&&!xt)return mn(e),null}else 2*Ot()-o.renderingStartTime>Ul&&n!==1073741824&&(e.flags|=128,r=!0,Lc(o,!1),e.lanes=4194304);o.isBackwards?(a.sibling=e.child,e.child=a):(n=o.last,n!==null?n.sibling=a:e.child=a,o.last=a)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=Ot(),e.sibling=null,n=Et.current,ut(Et,r?n&1|2:n&1),e):(mn(e),null);case 22:case 23:return m0(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?ir&1073741824&&(mn(e),e.subtreeFlags&6&&(e.flags|=8192)):mn(e),null;case 24:return null;case 25:return null}throw Error(ie(156,e.tag))}function hC(t,e){switch(Ky(e),e.tag){case 1:return Jn(e.type)&&tf(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Vl(),yt(Yn),yt(kn),r0(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return n0(e),null;case 13:if(yt(Et),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ie(340));Ml()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return yt(Et),null;case 4:return Vl(),null;case 10:return Jy(e.type._context),null;case 22:case 23:return m0(),null;case 24:return null;default:return null}}var th=!1,yn=!1,fC=typeof WeakSet=="function"?WeakSet:Set,xe=null;function xl(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ct(t,e,r)}else n.current=null}function Lg(t,e,n){try{n()}catch(r){Ct(t,e,r)}}var bx=!1;function mC(t,e){if(yg=Yh,t=Xk(),Wy(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var a=0,u=-1,d=-1,m=0,g=0,v=t,w=null;t:for(;;){for(var E;v!==n||i!==0&&v.nodeType!==3||(u=a+i),v!==o||r!==0&&v.nodeType!==3||(d=a+r),v.nodeType===3&&(a+=v.nodeValue.length),(E=v.firstChild)!==null;)w=v,v=E;for(;;){if(v===t)break t;if(w===n&&++m===i&&(u=a),w===o&&++g===r&&(d=a),(E=v.nextSibling)!==null)break;v=w,w=v.parentNode}v=E}n=u===-1||d===-1?null:{start:u,end:d}}else n=null}n=n||{start:0,end:0}}else n=null;for(_g={focusedElem:t,selectionRange:n},Yh=!1,xe=e;xe!==null;)if(e=xe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,xe=t;else for(;xe!==null;){e=xe;try{var C=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(C!==null){var P=C.memoizedProps,F=C.memoizedState,N=e.stateNode,T=N.getSnapshotBeforeUpdate(e.elementType===e.type?P:Vr(e.type,P),F);N.__reactInternalSnapshotBeforeUpdate=T}break;case 3:var A=e.stateNode.containerInfo;A.nodeType===1?A.textContent="":A.nodeType===9&&A.documentElement&&A.removeChild(A.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ie(163))}}catch(z){Ct(e,e.return,z)}if(t=e.sibling,t!==null){t.return=e.return,xe=t;break}xe=e.return}return C=bx,bx=!1,C}function au(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var o=i.destroy;i.destroy=void 0,o!==void 0&&Lg(e,n,o)}i=i.next}while(i!==r)}}function Xf(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Dg(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function ZI(t){var e=t.alternate;e!==null&&(t.alternate=null,ZI(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[oi],delete e[Pu],delete e[wg],delete e[QP],delete e[YP])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function QI(t){return t.tag===5||t.tag===3||t.tag===4}function kx(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||QI(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Mg(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=ef));else if(r!==4&&(t=t.child,t!==null))for(Mg(t,e,n),t=t.sibling;t!==null;)Mg(t,e,n),t=t.sibling}function Og(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Og(t,e,n),t=t.sibling;t!==null;)Og(t,e,n),t=t.sibling}var nn=null,Fr=!1;function Ps(t,e,n){for(n=n.child;n!==null;)YI(t,e,n),n=n.sibling}function YI(t,e,n){if(ui&&typeof ui.onCommitFiberUnmount=="function")try{ui.onCommitFiberUnmount(Hf,n)}catch{}switch(n.tag){case 5:yn||xl(n,e);case 6:var r=nn,i=Fr;nn=null,Ps(t,e,n),nn=r,Fr=i,nn!==null&&(Fr?(t=nn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):nn.removeChild(n.stateNode));break;case 18:nn!==null&&(Fr?(t=nn,n=n.stateNode,t.nodeType===8?yp(t.parentNode,n):t.nodeType===1&&yp(t,n),Iu(t)):yp(nn,n.stateNode));break;case 4:r=nn,i=Fr,nn=n.stateNode.containerInfo,Fr=!0,Ps(t,e,n),nn=r,Fr=i;break;case 0:case 11:case 14:case 15:if(!yn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,a=o.destroy;o=o.tag,a!==void 0&&(o&2||o&4)&&Lg(n,e,a),i=i.next}while(i!==r)}Ps(t,e,n);break;case 1:if(!yn&&(xl(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(u){Ct(n,e,u)}Ps(t,e,n);break;case 21:Ps(t,e,n);break;case 22:n.mode&1?(yn=(r=yn)||n.memoizedState!==null,Ps(t,e,n),yn=r):Ps(t,e,n);break;default:Ps(t,e,n)}}function Ix(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new fC),e.forEach(function(r){var i=kC.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Or(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var o=t,a=e,u=a;e:for(;u!==null;){switch(u.tag){case 5:nn=u.stateNode,Fr=!1;break e;case 3:nn=u.stateNode.containerInfo,Fr=!0;break e;case 4:nn=u.stateNode.containerInfo,Fr=!0;break e}u=u.return}if(nn===null)throw Error(ie(160));YI(o,a,i),nn=null,Fr=!1;var d=i.alternate;d!==null&&(d.return=null),i.return=null}catch(m){Ct(i,e,m)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)JI(e,t),e=e.sibling}function JI(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Or(e,t),ii(t),r&4){try{au(3,t,t.return),Xf(3,t)}catch(P){Ct(t,t.return,P)}try{au(5,t,t.return)}catch(P){Ct(t,t.return,P)}}break;case 1:Or(e,t),ii(t),r&512&&n!==null&&xl(n,n.return);break;case 5:if(Or(e,t),ii(t),r&512&&n!==null&&xl(n,n.return),t.flags&32){var i=t.stateNode;try{xu(i,"")}catch(P){Ct(t,t.return,P)}}if(r&4&&(i=t.stateNode,i!=null)){var o=t.memoizedProps,a=n!==null?n.memoizedProps:o,u=t.type,d=t.updateQueue;if(t.updateQueue=null,d!==null)try{u==="input"&&o.type==="radio"&&o.name!=null&&xk(i,o),ag(u,a);var m=ag(u,o);for(a=0;a<d.length;a+=2){var g=d[a],v=d[a+1];g==="style"?Tk(i,v):g==="dangerouslySetInnerHTML"?kk(i,v):g==="children"?xu(i,v):jy(i,g,v,m)}switch(u){case"input":ng(i,o);break;case"textarea":wk(i,o);break;case"select":var w=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var E=o.value;E!=null?kl(i,!!o.multiple,E,!1):w!==!!o.multiple&&(o.defaultValue!=null?kl(i,!!o.multiple,o.defaultValue,!0):kl(i,!!o.multiple,o.multiple?[]:"",!1))}i[Pu]=o}catch(P){Ct(t,t.return,P)}}break;case 6:if(Or(e,t),ii(t),r&4){if(t.stateNode===null)throw Error(ie(162));i=t.stateNode,o=t.memoizedProps;try{i.nodeValue=o}catch(P){Ct(t,t.return,P)}}break;case 3:if(Or(e,t),ii(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Iu(e.containerInfo)}catch(P){Ct(t,t.return,P)}break;case 4:Or(e,t),ii(t);break;case 13:Or(e,t),ii(t),i=t.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(h0=Ot())),r&4&&Ix(t);break;case 22:if(g=n!==null&&n.memoizedState!==null,t.mode&1?(yn=(m=yn)||g,Or(e,t),yn=m):Or(e,t),ii(t),r&8192){if(m=t.memoizedState!==null,(t.stateNode.isHidden=m)&&!g&&t.mode&1)for(xe=t,g=t.child;g!==null;){for(v=xe=g;xe!==null;){switch(w=xe,E=w.child,w.tag){case 0:case 11:case 14:case 15:au(4,w,w.return);break;case 1:xl(w,w.return);var C=w.stateNode;if(typeof C.componentWillUnmount=="function"){r=w,n=w.return;try{e=r,C.props=e.memoizedProps,C.state=e.memoizedState,C.componentWillUnmount()}catch(P){Ct(r,n,P)}}break;case 5:xl(w,w.return);break;case 22:if(w.memoizedState!==null){Ex(v);continue}}E!==null?(E.return=w,xe=E):Ex(v)}g=g.sibling}e:for(g=null,v=t;;){if(v.tag===5){if(g===null){g=v;try{i=v.stateNode,m?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(u=v.stateNode,d=v.memoizedProps.style,a=d!=null&&d.hasOwnProperty("display")?d.display:null,u.style.display=Ik("display",a))}catch(P){Ct(t,t.return,P)}}}else if(v.tag===6){if(g===null)try{v.stateNode.nodeValue=m?"":v.memoizedProps}catch(P){Ct(t,t.return,P)}}else if((v.tag!==22&&v.tag!==23||v.memoizedState===null||v===t)&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===t)break e;for(;v.sibling===null;){if(v.return===null||v.return===t)break e;g===v&&(g=null),v=v.return}g===v&&(g=null),v.sibling.return=v.return,v=v.sibling}}break;case 19:Or(e,t),ii(t),r&4&&Ix(t);break;case 21:break;default:Or(e,t),ii(t)}}function ii(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(QI(n)){var r=n;break e}n=n.return}throw Error(ie(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(xu(i,""),r.flags&=-33);var o=kx(t);Og(t,o,i);break;case 3:case 4:var a=r.stateNode.containerInfo,u=kx(t);Mg(t,u,a);break;default:throw Error(ie(161))}}catch(d){Ct(t,t.return,d)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function pC(t,e,n){xe=t,XI(t)}function XI(t,e,n){for(var r=(t.mode&1)!==0;xe!==null;){var i=xe,o=i.child;if(i.tag===22&&r){var a=i.memoizedState!==null||th;if(!a){var u=i.alternate,d=u!==null&&u.memoizedState!==null||yn;u=th;var m=yn;if(th=a,(yn=d)&&!m)for(xe=i;xe!==null;)a=xe,d=a.child,a.tag===22&&a.memoizedState!==null?Sx(i):d!==null?(d.return=a,xe=d):Sx(i);for(;o!==null;)xe=o,XI(o),o=o.sibling;xe=i,th=u,yn=m}Tx(t)}else i.subtreeFlags&8772&&o!==null?(o.return=i,xe=o):Tx(t)}}function Tx(t){for(;xe!==null;){var e=xe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:yn||Xf(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!yn)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Vr(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&cx(e,o,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}cx(e,a,n)}break;case 5:var u=e.stateNode;if(n===null&&e.flags&4){n=u;var d=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":d.autoFocus&&n.focus();break;case"img":d.src&&(n.src=d.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var m=e.alternate;if(m!==null){var g=m.memoizedState;if(g!==null){var v=g.dehydrated;v!==null&&Iu(v)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ie(163))}yn||e.flags&512&&Dg(e)}catch(w){Ct(e,e.return,w)}}if(e===t){xe=null;break}if(n=e.sibling,n!==null){n.return=e.return,xe=n;break}xe=e.return}}function Ex(t){for(;xe!==null;){var e=xe;if(e===t){xe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,xe=n;break}xe=e.return}}function Sx(t){for(;xe!==null;){var e=xe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Xf(4,e)}catch(d){Ct(e,n,d)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(d){Ct(e,i,d)}}var o=e.return;try{Dg(e)}catch(d){Ct(e,o,d)}break;case 5:var a=e.return;try{Dg(e)}catch(d){Ct(e,a,d)}}}catch(d){Ct(e,e.return,d)}if(e===t){xe=null;break}var u=e.sibling;if(u!==null){u.return=e.return,xe=u;break}xe=e.return}}var gC=Math.ceil,hf=is.ReactCurrentDispatcher,u0=is.ReactCurrentOwner,Tr=is.ReactCurrentBatchConfig,Je=0,tn=null,qt=null,on=0,ir=0,wl=go(0),Gt=0,Du=null,ua=0,em=0,d0=0,lu=null,Hn=null,h0=0,Ul=1/0,ji=null,ff=!1,Vg=null,eo=null,nh=!1,Ws=null,mf=0,cu=0,Fg=null,Sh=-1,Nh=0;function jn(){return Je&6?Ot():Sh!==-1?Sh:Sh=Ot()}function to(t){return t.mode&1?Je&2&&on!==0?on&-on:XP.transition!==null?(Nh===0&&(Nh=Ok()),Nh):(t=it,t!==0||(t=window.event,t=t===void 0?16:$k(t.type)),t):1}function $r(t,e,n,r){if(50<cu)throw cu=0,Fg=null,Error(ie(185));Xu(t,n,r),(!(Je&2)||t!==tn)&&(t===tn&&(!(Je&2)&&(em|=n),Gt===4&&Vs(t,on)),Xn(t,r),n===1&&Je===0&&!(e.mode&1)&&(Ul=Ot()+500,Qf&&yo()))}function Xn(t,e){var n=t.callbackNode;X2(t,e);var r=Qh(t,t===tn?on:0);if(r===0)n!==null&&Mv(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Mv(n),e===1)t.tag===0?JP(Nx.bind(null,t)):cI(Nx.bind(null,t)),KP(function(){!(Je&6)&&yo()}),n=null;else{switch(Vk(r)){case 1:n=Vy;break;case 4:n=Dk;break;case 16:n=Zh;break;case 536870912:n=Mk;break;default:n=Zh}n=aT(n,eT.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function eT(t,e){if(Sh=-1,Nh=0,Je&6)throw Error(ie(327));var n=t.callbackNode;if(Nl()&&t.callbackNode!==n)return null;var r=Qh(t,t===tn?on:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=pf(t,r);else{e=r;var i=Je;Je|=2;var o=nT();(tn!==t||on!==e)&&(ji=null,Ul=Ot()+500,na(t,e));do try{vC();break}catch(u){tT(t,u)}while(!0);Yy(),hf.current=o,Je=i,qt!==null?e=0:(tn=null,on=0,e=Gt)}if(e!==0){if(e===2&&(i=hg(t),i!==0&&(r=i,e=Ug(t,i))),e===1)throw n=Du,na(t,0),Vs(t,r),Xn(t,Ot()),n;if(e===6)Vs(t,r);else{if(i=t.current.alternate,!(r&30)&&!yC(i)&&(e=pf(t,r),e===2&&(o=hg(t),o!==0&&(r=o,e=Ug(t,o))),e===1))throw n=Du,na(t,0),Vs(t,r),Xn(t,Ot()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(ie(345));case 2:zo(t,Hn,ji);break;case 3:if(Vs(t,r),(r&130023424)===r&&(e=h0+500-Ot(),10<e)){if(Qh(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){jn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=xg(zo.bind(null,t,Hn,ji),e);break}zo(t,Hn,ji);break;case 4:if(Vs(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var a=31-qr(r);o=1<<a,a=e[a],a>i&&(i=a),r&=~o}if(r=i,r=Ot()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*gC(r/1960))-r,10<r){t.timeoutHandle=xg(zo.bind(null,t,Hn,ji),r);break}zo(t,Hn,ji);break;case 5:zo(t,Hn,ji);break;default:throw Error(ie(329))}}}return Xn(t,Ot()),t.callbackNode===n?eT.bind(null,t):null}function Ug(t,e){var n=lu;return t.current.memoizedState.isDehydrated&&(na(t,e).flags|=256),t=pf(t,e),t!==2&&(e=Hn,Hn=n,e!==null&&Bg(e)),t}function Bg(t){Hn===null?Hn=t:Hn.push.apply(Hn,t)}function yC(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!Wr(o(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Vs(t,e){for(e&=~d0,e&=~em,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-qr(e),r=1<<n;t[n]=-1,e&=~r}}function Nx(t){if(Je&6)throw Error(ie(327));Nl();var e=Qh(t,0);if(!(e&1))return Xn(t,Ot()),null;var n=pf(t,e);if(t.tag!==0&&n===2){var r=hg(t);r!==0&&(e=r,n=Ug(t,r))}if(n===1)throw n=Du,na(t,0),Vs(t,e),Xn(t,Ot()),n;if(n===6)throw Error(ie(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,zo(t,Hn,ji),Xn(t,Ot()),null}function f0(t,e){var n=Je;Je|=1;try{return t(e)}finally{Je=n,Je===0&&(Ul=Ot()+500,Qf&&yo())}}function da(t){Ws!==null&&Ws.tag===0&&!(Je&6)&&Nl();var e=Je;Je|=1;var n=Tr.transition,r=it;try{if(Tr.transition=null,it=1,t)return t()}finally{it=r,Tr.transition=n,Je=e,!(Je&6)&&yo()}}function m0(){ir=wl.current,yt(wl)}function na(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,GP(n)),qt!==null)for(n=qt.return;n!==null;){var r=n;switch(Ky(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&tf();break;case 3:Vl(),yt(Yn),yt(kn),r0();break;case 5:n0(r);break;case 4:Vl();break;case 13:yt(Et);break;case 19:yt(Et);break;case 10:Jy(r.type._context);break;case 22:case 23:m0()}n=n.return}if(tn=t,qt=t=no(t.current,null),on=ir=e,Gt=0,Du=null,d0=em=ua=0,Hn=lu=null,Jo!==null){for(e=0;e<Jo.length;e++)if(n=Jo[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,o=n.pending;if(o!==null){var a=o.next;o.next=i,r.next=a}n.pending=r}Jo=null}return t}function tT(t,e){do{var n=qt;try{if(Yy(),Ih.current=df,uf){for(var r=St.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}uf=!1}if(ca=0,en=Wt=St=null,ou=!1,Ru=0,u0.current=null,n===null||n.return===null){Gt=1,Du=e,qt=null;break}e:{var o=t,a=n.return,u=n,d=e;if(e=on,u.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){var m=d,g=u,v=g.tag;if(!(g.mode&1)&&(v===0||v===11||v===15)){var w=g.alternate;w?(g.updateQueue=w.updateQueue,g.memoizedState=w.memoizedState,g.lanes=w.lanes):(g.updateQueue=null,g.memoizedState=null)}var E=px(a);if(E!==null){E.flags&=-257,gx(E,a,u,o,e),E.mode&1&&mx(o,m,e),e=E,d=m;var C=e.updateQueue;if(C===null){var P=new Set;P.add(d),e.updateQueue=P}else C.add(d);break e}else{if(!(e&1)){mx(o,m,e),p0();break e}d=Error(ie(426))}}else if(xt&&u.mode&1){var F=px(a);if(F!==null){!(F.flags&65536)&&(F.flags|=256),gx(F,a,u,o,e),Zy(Fl(d,u));break e}}o=d=Fl(d,u),Gt!==4&&(Gt=2),lu===null?lu=[o]:lu.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var N=VI(o,d,e);lx(o,N);break e;case 1:u=d;var T=o.type,A=o.stateNode;if(!(o.flags&128)&&(typeof T.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(eo===null||!eo.has(A)))){o.flags|=65536,e&=-e,o.lanes|=e;var z=FI(o,u,e);lx(o,z);break e}}o=o.return}while(o!==null)}iT(n)}catch(Z){e=Z,qt===n&&n!==null&&(qt=n=n.return);continue}break}while(!0)}function nT(){var t=hf.current;return hf.current=df,t===null?df:t}function p0(){(Gt===0||Gt===3||Gt===2)&&(Gt=4),tn===null||!(ua&268435455)&&!(em&268435455)||Vs(tn,on)}function pf(t,e){var n=Je;Je|=2;var r=nT();(tn!==t||on!==e)&&(ji=null,na(t,e));do try{_C();break}catch(i){tT(t,i)}while(!0);if(Yy(),Je=n,hf.current=r,qt!==null)throw Error(ie(261));return tn=null,on=0,Gt}function _C(){for(;qt!==null;)rT(qt)}function vC(){for(;qt!==null&&!$2();)rT(qt)}function rT(t){var e=oT(t.alternate,t,ir);t.memoizedProps=t.pendingProps,e===null?iT(t):qt=e,u0.current=null}function iT(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=hC(n,e),n!==null){n.flags&=32767,qt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Gt=6,qt=null;return}}else if(n=dC(n,e,ir),n!==null){qt=n;return}if(e=e.sibling,e!==null){qt=e;return}qt=e=t}while(e!==null);Gt===0&&(Gt=5)}function zo(t,e,n){var r=it,i=Tr.transition;try{Tr.transition=null,it=1,xC(t,e,n,r)}finally{Tr.transition=i,it=r}return null}function xC(t,e,n,r){do Nl();while(Ws!==null);if(Je&6)throw Error(ie(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ie(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(eP(t,o),t===tn&&(qt=tn=null,on=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||nh||(nh=!0,aT(Zh,function(){return Nl(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Tr.transition,Tr.transition=null;var a=it;it=1;var u=Je;Je|=4,u0.current=null,mC(t,n),JI(n,t),UP(_g),Yh=!!yg,_g=yg=null,t.current=n,pC(n),H2(),Je=u,it=a,Tr.transition=o}else t.current=n;if(nh&&(nh=!1,Ws=t,mf=i),o=t.pendingLanes,o===0&&(eo=null),K2(n.stateNode),Xn(t,Ot()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(ff)throw ff=!1,t=Vg,Vg=null,t;return mf&1&&t.tag!==0&&Nl(),o=t.pendingLanes,o&1?t===Fg?cu++:(cu=0,Fg=t):cu=0,yo(),null}function Nl(){if(Ws!==null){var t=Vk(mf),e=Tr.transition,n=it;try{if(Tr.transition=null,it=16>t?16:t,Ws===null)var r=!1;else{if(t=Ws,Ws=null,mf=0,Je&6)throw Error(ie(331));var i=Je;for(Je|=4,xe=t.current;xe!==null;){var o=xe,a=o.child;if(xe.flags&16){var u=o.deletions;if(u!==null){for(var d=0;d<u.length;d++){var m=u[d];for(xe=m;xe!==null;){var g=xe;switch(g.tag){case 0:case 11:case 15:au(8,g,o)}var v=g.child;if(v!==null)v.return=g,xe=v;else for(;xe!==null;){g=xe;var w=g.sibling,E=g.return;if(ZI(g),g===m){xe=null;break}if(w!==null){w.return=E,xe=w;break}xe=E}}}var C=o.alternate;if(C!==null){var P=C.child;if(P!==null){C.child=null;do{var F=P.sibling;P.sibling=null,P=F}while(P!==null)}}xe=o}}if(o.subtreeFlags&2064&&a!==null)a.return=o,xe=a;else e:for(;xe!==null;){if(o=xe,o.flags&2048)switch(o.tag){case 0:case 11:case 15:au(9,o,o.return)}var N=o.sibling;if(N!==null){N.return=o.return,xe=N;break e}xe=o.return}}var T=t.current;for(xe=T;xe!==null;){a=xe;var A=a.child;if(a.subtreeFlags&2064&&A!==null)A.return=a,xe=A;else e:for(a=T;xe!==null;){if(u=xe,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:Xf(9,u)}}catch(Z){Ct(u,u.return,Z)}if(u===a){xe=null;break e}var z=u.sibling;if(z!==null){z.return=u.return,xe=z;break e}xe=u.return}}if(Je=i,yo(),ui&&typeof ui.onPostCommitFiberRoot=="function")try{ui.onPostCommitFiberRoot(Hf,t)}catch{}r=!0}return r}finally{it=n,Tr.transition=e}}return!1}function Px(t,e,n){e=Fl(n,e),e=VI(t,e,1),t=Xs(t,e,1),e=jn(),t!==null&&(Xu(t,1,e),Xn(t,e))}function Ct(t,e,n){if(t.tag===3)Px(t,t,n);else for(;e!==null;){if(e.tag===3){Px(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(eo===null||!eo.has(r))){t=Fl(n,t),t=FI(e,t,1),e=Xs(e,t,1),t=jn(),e!==null&&(Xu(e,1,t),Xn(e,t));break}}e=e.return}}function wC(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=jn(),t.pingedLanes|=t.suspendedLanes&n,tn===t&&(on&n)===n&&(Gt===4||Gt===3&&(on&130023424)===on&&500>Ot()-h0?na(t,0):d0|=n),Xn(t,e)}function sT(t,e){e===0&&(t.mode&1?(e=Wd,Wd<<=1,!(Wd&130023424)&&(Wd=4194304)):e=1);var n=jn();t=Yi(t,e),t!==null&&(Xu(t,e,n),Xn(t,n))}function bC(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),sT(t,n)}function kC(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ie(314))}r!==null&&r.delete(e),sT(t,n)}var oT;oT=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Yn.current)Kn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Kn=!1,uC(t,e,n);Kn=!!(t.flags&131072)}else Kn=!1,xt&&e.flags&1048576&&uI(e,sf,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Eh(t,e),t=e.pendingProps;var i=Dl(e,kn.current);Sl(e,n),i=s0(null,e,r,t,i,n);var o=o0();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Jn(r)?(o=!0,nf(e)):o=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,e0(e),i.updater=Jf,e.stateNode=i,i._reactInternals=e,Sg(e,r,t,n),e=Cg(null,e,r,!0,o,n)):(e.tag=0,xt&&o&&Gy(e),An(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Eh(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=TC(r),t=Vr(r,t),i){case 0:e=Pg(null,e,r,t,n);break e;case 1:e=vx(null,e,r,t,n);break e;case 11:e=yx(null,e,r,t,n);break e;case 14:e=_x(null,e,r,Vr(r.type,t),n);break e}throw Error(ie(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Vr(r,i),Pg(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Vr(r,i),vx(t,e,r,i,n);case 3:e:{if(qI(e),t===null)throw Error(ie(387));r=e.pendingProps,o=e.memoizedState,i=o.element,gI(t,e),lf(e,r,null,n);var a=e.memoizedState;if(r=a.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){i=Fl(Error(ie(423)),e),e=xx(t,e,r,n,i);break e}else if(r!==i){i=Fl(Error(ie(424)),e),e=xx(t,e,r,n,i);break e}else for(sr=Js(e.stateNode.containerInfo.firstChild),lr=e,xt=!0,Ur=null,n=mI(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ml(),r===i){e=Ji(t,e,n);break e}An(t,e,r,n)}e=e.child}return e;case 5:return yI(e),t===null&&Ig(e),r=e.type,i=e.pendingProps,o=t!==null?t.memoizedProps:null,a=i.children,vg(r,i)?a=null:o!==null&&vg(r,o)&&(e.flags|=32),zI(t,e),An(t,e,a,n),e.child;case 6:return t===null&&Ig(e),null;case 13:return $I(t,e,n);case 4:return t0(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Ol(e,null,r,n):An(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Vr(r,i),yx(t,e,r,i,n);case 7:return An(t,e,e.pendingProps,n),e.child;case 8:return An(t,e,e.pendingProps.children,n),e.child;case 12:return An(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,o=e.memoizedProps,a=i.value,ut(of,r._currentValue),r._currentValue=a,o!==null)if(Wr(o.value,a)){if(o.children===i.children&&!Yn.current){e=Ji(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var u=o.dependencies;if(u!==null){a=o.child;for(var d=u.firstContext;d!==null;){if(d.context===r){if(o.tag===1){d=Hi(-1,n&-n),d.tag=2;var m=o.updateQueue;if(m!==null){m=m.shared;var g=m.pending;g===null?d.next=d:(d.next=g.next,g.next=d),m.pending=d}}o.lanes|=n,d=o.alternate,d!==null&&(d.lanes|=n),Tg(o.return,n,e),u.lanes|=n;break}d=d.next}}else if(o.tag===10)a=o.type===e.type?null:o.child;else if(o.tag===18){if(a=o.return,a===null)throw Error(ie(341));a.lanes|=n,u=a.alternate,u!==null&&(u.lanes|=n),Tg(a,n,e),a=o.sibling}else a=o.child;if(a!==null)a.return=o;else for(a=o;a!==null;){if(a===e){a=null;break}if(o=a.sibling,o!==null){o.return=a.return,a=o;break}a=a.return}o=a}An(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Sl(e,n),i=Er(i),r=r(i),e.flags|=1,An(t,e,r,n),e.child;case 14:return r=e.type,i=Vr(r,e.pendingProps),i=Vr(r.type,i),_x(t,e,r,i,n);case 15:return UI(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Vr(r,i),Eh(t,e),e.tag=1,Jn(r)?(t=!0,nf(e)):t=!1,Sl(e,n),OI(e,r,i),Sg(e,r,i,n),Cg(null,e,r,!0,t,n);case 19:return HI(t,e,n);case 22:return BI(t,e,n)}throw Error(ie(156,e.tag))};function aT(t,e){return Lk(t,e)}function IC(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ir(t,e,n,r){return new IC(t,e,n,r)}function g0(t){return t=t.prototype,!(!t||!t.isReactComponent)}function TC(t){if(typeof t=="function")return g0(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Dy)return 11;if(t===My)return 14}return 2}function no(t,e){var n=t.alternate;return n===null?(n=Ir(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ph(t,e,n,r,i,o){var a=2;if(r=t,typeof t=="function")g0(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case dl:return ra(n.children,i,o,e);case Ly:a=8,i|=8;break;case Yp:return t=Ir(12,n,e,i|2),t.elementType=Yp,t.lanes=o,t;case Jp:return t=Ir(13,n,e,i),t.elementType=Jp,t.lanes=o,t;case Xp:return t=Ir(19,n,e,i),t.elementType=Xp,t.lanes=o,t;case yk:return tm(n,i,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case pk:a=10;break e;case gk:a=9;break e;case Dy:a=11;break e;case My:a=14;break e;case js:a=16,r=null;break e}throw Error(ie(130,t==null?t:typeof t,""))}return e=Ir(a,n,e,i),e.elementType=t,e.type=r,e.lanes=o,e}function ra(t,e,n,r){return t=Ir(7,t,r,e),t.lanes=n,t}function tm(t,e,n,r){return t=Ir(22,t,r,e),t.elementType=yk,t.lanes=n,t.stateNode={isHidden:!1},t}function Tp(t,e,n){return t=Ir(6,t,null,e),t.lanes=n,t}function Ep(t,e,n){return e=Ir(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function EC(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=op(0),this.expirationTimes=op(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=op(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function y0(t,e,n,r,i,o,a,u,d){return t=new EC(t,e,n,u,d),e===1?(e=1,o===!0&&(e|=8)):e=0,o=Ir(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},e0(o),t}function SC(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ul,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function lT(t){if(!t)return oo;t=t._reactInternals;e:{if(Pa(t)!==t||t.tag!==1)throw Error(ie(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Jn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ie(171))}if(t.tag===1){var n=t.type;if(Jn(n))return lI(t,n,e)}return e}function cT(t,e,n,r,i,o,a,u,d){return t=y0(n,r,!0,t,i,o,a,u,d),t.context=lT(null),n=t.current,r=jn(),i=to(n),o=Hi(r,i),o.callback=e??null,Xs(n,o,i),t.current.lanes=i,Xu(t,i,r),Xn(t,r),t}function nm(t,e,n,r){var i=e.current,o=jn(),a=to(i);return n=lT(n),e.context===null?e.context=n:e.pendingContext=n,e=Hi(o,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Xs(i,e,a),t!==null&&($r(t,i,a,o),kh(t,i,a)),a}function gf(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Cx(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function _0(t,e){Cx(t,e),(t=t.alternate)&&Cx(t,e)}function NC(){return null}var uT=typeof reportError=="function"?reportError:function(t){console.error(t)};function v0(t){this._internalRoot=t}rm.prototype.render=v0.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ie(409));nm(t,e,null,null)};rm.prototype.unmount=v0.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;da(function(){nm(null,t,null,null)}),e[Qi]=null}};function rm(t){this._internalRoot=t}rm.prototype.unstable_scheduleHydration=function(t){if(t){var e=Bk();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Os.length&&e!==0&&e<Os[n].priority;n++);Os.splice(n,0,t),n===0&&qk(t)}};function x0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function im(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Ax(){}function PC(t,e,n,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var m=gf(a);o.call(m)}}var a=cT(e,r,t,0,null,!1,!1,"",Ax);return t._reactRootContainer=a,t[Qi]=a.current,Su(t.nodeType===8?t.parentNode:t),da(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var u=r;r=function(){var m=gf(d);u.call(m)}}var d=y0(t,0,!1,null,null,!1,!1,"",Ax);return t._reactRootContainer=d,t[Qi]=d.current,Su(t.nodeType===8?t.parentNode:t),da(function(){nm(e,d,n,r)}),d}function sm(t,e,n,r,i){var o=n._reactRootContainer;if(o){var a=o;if(typeof i=="function"){var u=i;i=function(){var d=gf(a);u.call(d)}}nm(e,a,t,i)}else a=PC(n,e,t,i,r);return gf(a)}Fk=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Wc(e.pendingLanes);n!==0&&(Fy(e,n|1),Xn(e,Ot()),!(Je&6)&&(Ul=Ot()+500,yo()))}break;case 13:da(function(){var r=Yi(t,1);if(r!==null){var i=jn();$r(r,t,1,i)}}),_0(t,1)}};Uy=function(t){if(t.tag===13){var e=Yi(t,134217728);if(e!==null){var n=jn();$r(e,t,134217728,n)}_0(t,134217728)}};Uk=function(t){if(t.tag===13){var e=to(t),n=Yi(t,e);if(n!==null){var r=jn();$r(n,t,e,r)}_0(t,e)}};Bk=function(){return it};zk=function(t,e){var n=it;try{return it=t,e()}finally{it=n}};cg=function(t,e,n){switch(e){case"input":if(ng(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Zf(r);if(!i)throw Error(ie(90));vk(r),ng(r,i)}}}break;case"textarea":wk(t,n);break;case"select":e=n.value,e!=null&&kl(t,!!n.multiple,e,!1)}};Nk=f0;Pk=da;var CC={usingClientEntryPoint:!1,Events:[td,pl,Zf,Ek,Sk,f0]},Dc={findFiberByHostInstance:Yo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},AC={bundleType:Dc.bundleType,version:Dc.version,rendererPackageName:Dc.rendererPackageName,rendererConfig:Dc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:is.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Rk(t),t===null?null:t.stateNode},findFiberByHostInstance:Dc.findFiberByHostInstance||NC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var rh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rh.isDisabled&&rh.supportsFiber)try{Hf=rh.inject(AC),ui=rh}catch{}}fr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=CC;fr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!x0(e))throw Error(ie(200));return SC(t,e,null,n)};fr.createRoot=function(t,e){if(!x0(t))throw Error(ie(299));var n=!1,r="",i=uT;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=y0(t,1,!1,null,null,n,!1,r,i),t[Qi]=e.current,Su(t.nodeType===8?t.parentNode:t),new v0(e)};fr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ie(188)):(t=Object.keys(t).join(","),Error(ie(268,t)));return t=Rk(e),t=t===null?null:t.stateNode,t};fr.flushSync=function(t){return da(t)};fr.hydrate=function(t,e,n){if(!im(e))throw Error(ie(200));return sm(null,t,e,!0,n)};fr.hydrateRoot=function(t,e,n){if(!x0(t))throw Error(ie(405));var r=n!=null&&n.hydratedSources||null,i=!1,o="",a=uT;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=cT(e,null,t,1,n??null,i,!1,o,a),t[Qi]=e.current,Su(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new rm(e)};fr.render=function(t,e,n){if(!im(e))throw Error(ie(200));return sm(null,t,e,!1,n)};fr.unmountComponentAtNode=function(t){if(!im(t))throw Error(ie(40));return t._reactRootContainer?(da(function(){sm(null,null,t,!1,function(){t._reactRootContainer=null,t[Qi]=null})}),!0):!1};fr.unstable_batchedUpdates=f0;fr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!im(n))throw Error(ie(200));if(t==null||t._reactInternals===void 0)throw Error(ie(38));return sm(t,e,n,!1,r)};fr.version="18.3.1-next-f1338f8080-20240426";function dT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(dT)}catch(t){console.error(t)}}dT(),dk.exports=fr;var hT=dk.exports,Rx=hT;Zp.createRoot=Rx.createRoot,Zp.hydrateRoot=Rx.hydrateRoot;const RC="modulepreload",jC=function(t){return"/"+t},jx={},zg=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),u=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(n.map(d=>{if(d=jC(d),d in jx)return;jx[d]=!0;const m=d.endsWith(".css"),g=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${g}`))return;const v=document.createElement("link");if(v.rel=m?"stylesheet":RC,m||(v.as="script"),v.crossOrigin="",v.href=d,u&&v.setAttribute("nonce",u),document.head.appendChild(v),m)return new Promise((w,E)=>{v.addEventListener("load",w),v.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${d}`)))})}))}function o(a){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=a,window.dispatchEvent(u),!u.defaultPrevented)throw a}return i.then(a=>{for(const u of a||[])u.status==="rejected"&&o(u.reason);return e().catch(o)})};var Lx={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fT=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},LC=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const o=t[n++];e[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=t[n++],a=t[n++],u=t[n++],d=((i&7)<<18|(o&63)<<12|(a&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(d>>10)),e[r++]=String.fromCharCode(56320+(d&1023))}else{const o=t[n++],a=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|a&63)}}return e.join("")},mT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const o=t[i],a=i+1<t.length,u=a?t[i+1]:0,d=i+2<t.length,m=d?t[i+2]:0,g=o>>2,v=(o&3)<<4|u>>4;let w=(u&15)<<2|m>>6,E=m&63;d||(E=64,a||(w=64)),r.push(n[g],n[v],n[w],n[E])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(fT(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):LC(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const o=n[t.charAt(i++)],u=i<t.length?n[t.charAt(i)]:0;++i;const m=i<t.length?n[t.charAt(i)]:64;++i;const v=i<t.length?n[t.charAt(i)]:64;if(++i,o==null||u==null||m==null||v==null)throw new DC;const w=o<<2|u>>4;if(r.push(w),m!==64){const E=u<<4&240|m>>2;if(r.push(E),v!==64){const C=m<<6&192|v;r.push(C)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class DC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const MC=function(t){const e=fT(t);return mT.encodeByteArray(e,!0)},yf=function(t){return MC(t).replace(/\./g,"")},pT=function(t){try{return mT.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VC=()=>OC().__FIREBASE_DEFAULTS__,FC=()=>{if(typeof process>"u"||typeof Lx>"u")return;const t=Lx.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},UC=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&pT(t[1]);return e&&JSON.parse(e)},om=()=>{try{return VC()||FC()||UC()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},gT=t=>{var e,n;return(n=(e=om())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},yT=t=>{const e=gT(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},_T=()=>{var t;return(t=om())===null||t===void 0?void 0:t.config},vT=t=>{var e;return(e=om())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zC(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},t);return[yf(JSON.stringify(n)),yf(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function qC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Kt())}function $C(){var t;const e=(t=om())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function HC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function WC(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function GC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function KC(){const t=Kt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function xT(){return!$C()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function w0(){try{return typeof indexedDB=="object"}catch{return!1}}function wT(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var o;e(((o=i.error)===null||o===void 0?void 0:o.message)||"")}}catch(n){e(n)}})}function ZC(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QC="FirebaseError";class Cr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=QC,Object.setPrototypeOf(this,Cr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ca.prototype.create)}}class Ca{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,o=this.errors[e],a=o?YC(o,r):"Error",u=`${this.serviceName}: ${a} (${i}).`;return new Cr(i,u,r)}}function YC(t,e){return t.replace(JC,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const JC=/\{\$([^}]+)}/g;function XC(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function ha(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const o=t[i],a=e[i];if(Dx(o)&&Dx(a)){if(!ha(o,a))return!1}else if(o!==a)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Dx(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rd(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Kc(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,o]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(o)}}),e}function Zc(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function eA(t,e){const n=new tA(t,e);return n.subscribe.bind(n)}class tA{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");nA(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=Sp),i.error===void 0&&(i.error=Sp),i.complete===void 0&&(i.complete=Sp);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function nA(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Sp(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xe(t){return t&&t._delegate?t._delegate:t}class dr{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rA{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new BC;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(sA(e))try{this.getOrInitializeService({instanceIdentifier:qo})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(e=qo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=qo){return this.instances.has(e)}getOptions(e=qo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[o,a]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(o);r===u&&a.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),o=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;o.add(e),this.onInitCallbacks.set(i,o);const a=this.instances.get(i);return a&&e(a,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:iA(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=qo){return this.component?this.component.multipleInstances?e:qo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function iA(t){return t===qo?void 0:t}function sA(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oA{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new rA(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var He;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(He||(He={}));const aA={debug:He.DEBUG,verbose:He.VERBOSE,info:He.INFO,warn:He.WARN,error:He.ERROR,silent:He.SILENT},lA=He.INFO,cA={[He.DEBUG]:"log",[He.VERBOSE]:"log",[He.INFO]:"info",[He.WARN]:"warn",[He.ERROR]:"error"},uA=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=cA[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class b0{constructor(e){this.name=e,this._logLevel=lA,this._logHandler=uA,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in He))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?aA[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,He.DEBUG,...e),this._logHandler(this,He.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,He.VERBOSE,...e),this._logHandler(this,He.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,He.INFO,...e),this._logHandler(this,He.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,He.WARN,...e),this._logHandler(this,He.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,He.ERROR,...e),this._logHandler(this,He.ERROR,...e)}}const dA=(t,e)=>e.some(n=>t instanceof n);let Mx,Ox;function hA(){return Mx||(Mx=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function fA(){return Ox||(Ox=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const bT=new WeakMap,qg=new WeakMap,kT=new WeakMap,Np=new WeakMap,k0=new WeakMap;function mA(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",o),t.removeEventListener("error",a)},o=()=>{n(Wi(t.result)),i()},a=()=>{r(t.error),i()};t.addEventListener("success",o),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&bT.set(n,t)}).catch(()=>{}),k0.set(e,t),e}function pA(t){if(qg.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",a),t.removeEventListener("abort",a)},o=()=>{n(),i()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",o),t.addEventListener("error",a),t.addEventListener("abort",a)});qg.set(t,e)}let $g={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return qg.get(t);if(e==="objectStoreNames")return t.objectStoreNames||kT.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Wi(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function gA(t){$g=t($g)}function yA(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Pp(this),e,...n);return kT.set(r,e.sort?e.sort():[e]),Wi(r)}:fA().includes(t)?function(...e){return t.apply(Pp(this),e),Wi(bT.get(this))}:function(...e){return Wi(t.apply(Pp(this),e))}}function _A(t){return typeof t=="function"?yA(t):(t instanceof IDBTransaction&&pA(t),dA(t,hA())?new Proxy(t,$g):t)}function Wi(t){if(t instanceof IDBRequest)return mA(t);if(Np.has(t))return Np.get(t);const e=_A(t);return e!==t&&(Np.set(t,e),k0.set(e,t)),e}const Pp=t=>k0.get(t);function am(t,e,{blocked:n,upgrade:r,blocking:i,terminated:o}={}){const a=indexedDB.open(t,e),u=Wi(a);return r&&a.addEventListener("upgradeneeded",d=>{r(Wi(a.result),d.oldVersion,d.newVersion,Wi(a.transaction),d)}),n&&a.addEventListener("blocked",d=>n(d.oldVersion,d.newVersion,d)),u.then(d=>{o&&d.addEventListener("close",()=>o()),i&&d.addEventListener("versionchange",m=>i(m.oldVersion,m.newVersion,m))}).catch(()=>{}),u}function Cp(t,{blocked:e}={}){const n=indexedDB.deleteDatabase(t);return e&&n.addEventListener("blocked",r=>e(r.oldVersion,r)),Wi(n).then(()=>{})}const vA=["get","getKey","getAll","getAllKeys","count"],xA=["put","add","delete","clear"],Ap=new Map;function Vx(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Ap.get(e))return Ap.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=xA.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||vA.includes(n)))return;const o=async function(a,...u){const d=this.transaction(a,i?"readwrite":"readonly");let m=d.store;return r&&(m=m.index(u.shift())),(await Promise.all([m[n](...u),i&&d.done]))[0]};return Ap.set(e,o),o}gA(t=>({...t,get:(e,n,r)=>Vx(e,n)||t.get(e,n,r),has:(e,n)=>!!Vx(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wA{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(bA(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function bA(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Hg="@firebase/app",Fx="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xi=new b0("@firebase/app"),kA="@firebase/app-compat",IA="@firebase/analytics-compat",TA="@firebase/analytics",EA="@firebase/app-check-compat",SA="@firebase/app-check",NA="@firebase/auth",PA="@firebase/auth-compat",CA="@firebase/database",AA="@firebase/data-connect",RA="@firebase/database-compat",jA="@firebase/functions",LA="@firebase/functions-compat",DA="@firebase/installations",MA="@firebase/installations-compat",OA="@firebase/messaging",VA="@firebase/messaging-compat",FA="@firebase/performance",UA="@firebase/performance-compat",BA="@firebase/remote-config",zA="@firebase/remote-config-compat",qA="@firebase/storage",$A="@firebase/storage-compat",HA="@firebase/firestore",WA="@firebase/vertexai-preview",GA="@firebase/firestore-compat",KA="firebase",ZA="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wg="[DEFAULT]",QA={[Hg]:"fire-core",[kA]:"fire-core-compat",[TA]:"fire-analytics",[IA]:"fire-analytics-compat",[SA]:"fire-app-check",[EA]:"fire-app-check-compat",[NA]:"fire-auth",[PA]:"fire-auth-compat",[CA]:"fire-rtdb",[AA]:"fire-data-connect",[RA]:"fire-rtdb-compat",[jA]:"fire-fn",[LA]:"fire-fn-compat",[DA]:"fire-iid",[MA]:"fire-iid-compat",[OA]:"fire-fcm",[VA]:"fire-fcm-compat",[FA]:"fire-perf",[UA]:"fire-perf-compat",[BA]:"fire-rc",[zA]:"fire-rc-compat",[qA]:"fire-gcs",[$A]:"fire-gcs-compat",[HA]:"fire-fst",[GA]:"fire-fst-compat",[WA]:"fire-vertex","fire-js":"fire-js",[KA]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _f=new Map,YA=new Map,Gg=new Map;function Ux(t,e){try{t.container.addComponent(e)}catch(n){Xi.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Nr(t){const e=t.name;if(Gg.has(e))return Xi.debug(`There were multiple attempts to register component ${e}.`),!1;Gg.set(e,t);for(const n of _f.values())Ux(n,t);for(const n of YA.values())Ux(n,t);return!0}function _o(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Br(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JA={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ro=new Ca("app","Firebase",JA);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XA{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new dr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ro.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aa=ZA;function IT(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Wg,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw ro.create("bad-app-name",{appName:String(i)});if(n||(n=_T()),!n)throw ro.create("no-options");const o=_f.get(i);if(o){if(ha(n,o.options)&&ha(r,o.config))return o;throw ro.create("duplicate-app",{appName:i})}const a=new oA(i);for(const d of Gg.values())a.addComponent(d);const u=new XA(n,r,a);return _f.set(i,u),u}function lm(t=Wg){const e=_f.get(t);if(!e&&t===Wg&&_T())return IT();if(!e)throw ro.create("no-app",{appName:t});return e}function xn(t,e,n){var r;let i=(r=QA[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const o=i.match(/\s|\//),a=e.match(/\s|\//);if(o||a){const u=[`Unable to register library "${i}" with version "${e}":`];o&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&a&&u.push("and"),a&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Xi.warn(u.join(" "));return}Nr(new dr(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eR="firebase-heartbeat-database",tR=1,Mu="firebase-heartbeat-store";let Rp=null;function TT(){return Rp||(Rp=am(eR,tR,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Mu)}catch(n){console.warn(n)}}}}).catch(t=>{throw ro.create("idb-open",{originalErrorMessage:t.message})})),Rp}async function nR(t){try{const n=(await TT()).transaction(Mu),r=await n.objectStore(Mu).get(ET(t));return await n.done,r}catch(e){if(e instanceof Cr)Xi.warn(e.message);else{const n=ro.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Xi.warn(n.message)}}}async function Bx(t,e){try{const r=(await TT()).transaction(Mu,"readwrite");await r.objectStore(Mu).put(e,ET(t)),await r.done}catch(n){if(n instanceof Cr)Xi.warn(n.message);else{const r=ro.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Xi.warn(r.message)}}}function ET(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rR=1024,iR=30*24*60*60*1e3;class sR{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new aR(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=zx();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(a=>a.date===o)?void 0:(this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const u=new Date(a.date).valueOf();return Date.now()-u<=iR}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Xi.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=zx(),{heartbeatsToSend:r,unsentEntries:i}=oR(this._heartbeatsCache.heartbeats),o=yf(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(n){return Xi.warn(n),""}}}function zx(){return new Date().toISOString().substring(0,10)}function oR(t,e=rR){const n=[];let r=t.slice();for(const i of t){const o=n.find(a=>a.agent===i.agent);if(o){if(o.dates.push(i.date),qx(n)>e){o.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),qx(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class aR{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return w0()?wT().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await nR(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Bx(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Bx(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function qx(t){return yf(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lR(t){Nr(new dr("platform-logger",e=>new wA(e),"PRIVATE")),Nr(new dr("heartbeat",e=>new sR(e),"PRIVATE")),xn(Hg,Fx,t),xn(Hg,Fx,"esm2017"),xn("fire-js","")}lR("");function I0(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function ST(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const cR=ST,NT=new Ca("auth","Firebase",ST());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vf=new b0("@firebase/auth");function uR(t,...e){vf.logLevel<=He.WARN&&vf.warn(`Auth (${Aa}): ${t}`,...e)}function Ch(t,...e){vf.logLevel<=He.ERROR&&vf.error(`Auth (${Aa}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pr(t,...e){throw E0(t,...e)}function Hr(t,...e){return E0(t,...e)}function T0(t,e,n){const r=Object.assign(Object.assign({},cR()),{[e]:n});return new Ca("auth","Firebase",r).create(e,{appName:t.name})}function Gi(t){return T0(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function dR(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Pr(t,"argument-error"),T0(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function E0(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return NT.create(t,...e)}function Re(t,e,...n){if(!t)throw E0(e,...n)}function Fi(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Ch(e),new Error(e)}function es(t,e){t||Fi(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kg(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function hR(){return $x()==="http:"||$x()==="https:"}function $x(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fR(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(hR()||WC()||"connection"in navigator)?navigator.onLine:!0}function mR(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class id{constructor(e,n){this.shortDelay=e,this.longDelay=n,es(n>e,"Short delay should be less than long delay!"),this.isMobile=qC()||GC()}get(){return fR()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S0(t,e){es(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PT{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Fi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Fi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Fi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pR={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gR=new id(3e4,6e4);function ss(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function os(t,e,n,r,i={}){return CT(t,i,async()=>{let o={},a={};r&&(e==="GET"?a=r:o={body:JSON.stringify(r)});const u=rd(Object.assign({key:t.config.apiKey},a)).slice(1),d=await t._getAdditionalHeaders();d["Content-Type"]="application/json",t.languageCode&&(d["X-Firebase-Locale"]=t.languageCode);const m=Object.assign({method:e,headers:d},o);return HC()||(m.referrerPolicy="no-referrer"),PT.fetch()(AT(t,t.config.apiHost,n,u),m)})}async function CT(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},pR),e);try{const i=new _R(t),o=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const a=await o.json();if("needConfirmation"in a)throw ih(t,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{const u=o.ok?a.errorMessage:a.error.message,[d,m]=u.split(" : ");if(d==="FEDERATED_USER_ID_ALREADY_LINKED")throw ih(t,"credential-already-in-use",a);if(d==="EMAIL_EXISTS")throw ih(t,"email-already-in-use",a);if(d==="USER_DISABLED")throw ih(t,"user-disabled",a);const g=r[d]||d.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw T0(t,g,m);Pr(t,g)}}catch(i){if(i instanceof Cr)throw i;Pr(t,"network-request-failed",{message:String(i)})}}async function sd(t,e,n,r,i={}){const o=await os(t,e,n,r,i);return"mfaPendingCredential"in o&&Pr(t,"multi-factor-auth-required",{_serverResponse:o}),o}function AT(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?S0(t.config,i):`${t.config.apiScheme}://${i}`}function yR(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class _R{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Hr(this.auth,"network-request-failed")),gR.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function ih(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Hr(t,e,r);return i.customData._tokenResponse=n,i}function Hx(t){return t!==void 0&&t.enterprise!==void 0}class vR{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return yR(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function xR(t,e){return os(t,"GET","/v2/recaptchaConfig",ss(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wR(t,e){return os(t,"POST","/v1/accounts:delete",e)}async function RT(t,e){return os(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uu(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function bR(t,e=!1){const n=Xe(t),r=await n.getIdToken(e),i=N0(r);Re(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const o=typeof i.firebase=="object"?i.firebase:void 0,a=o==null?void 0:o.sign_in_provider;return{claims:i,token:r,authTime:uu(jp(i.auth_time)),issuedAtTime:uu(jp(i.iat)),expirationTime:uu(jp(i.exp)),signInProvider:a||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function jp(t){return Number(t)*1e3}function N0(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Ch("JWT malformed, contained fewer than 3 sections"),null;try{const i=pT(n);return i?JSON.parse(i):(Ch("Failed to decode base64 JWT payload"),null)}catch(i){return Ch("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function Wx(t){const e=N0(t);return Re(e,"internal-error"),Re(typeof e.exp<"u","internal-error"),Re(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ou(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Cr&&kR(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function kR({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IR{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zg{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=uu(this.lastLoginAt),this.creationTime=uu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xf(t){var e;const n=t.auth,r=await t.getIdToken(),i=await Ou(t,RT(n,{idToken:r}));Re(i==null?void 0:i.users.length,n,"internal-error");const o=i.users[0];t._notifyReloadListener(o);const a=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?jT(o.providerUserInfo):[],u=ER(t.providerData,a),d=t.isAnonymous,m=!(t.email&&o.passwordHash)&&!(u!=null&&u.length),g=d?m:!1,v={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new Zg(o.createdAt,o.lastLoginAt),isAnonymous:g};Object.assign(t,v)}async function TR(t){const e=Xe(t);await xf(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function ER(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function jT(t){return t.map(e=>{var{providerId:n}=e,r=I0(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SR(t,e){const n=await CT(t,{},async()=>{const r=rd({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=t.config,a=AT(t,i,"/v1/token",`key=${o}`),u=await t._getAdditionalHeaders();return u["Content-Type"]="application/x-www-form-urlencoded",PT.fetch()(a,{method:"POST",headers:u,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function NR(t,e){return os(t,"POST","/v2/accounts:revokeToken",ss(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Re(e.idToken,"internal-error"),Re(typeof e.idToken<"u","internal-error"),Re(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Wx(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Re(e.length!==0,"internal-error");const n=Wx(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Re(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:o}=await SR(e,n);this.updateTokensAndExpiration(r,i,Number(o))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:o}=n,a=new Pl;return r&&(Re(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(Re(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),o&&(Re(typeof o=="number","internal-error",{appName:e}),a.expirationTime=o),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Pl,this.toJSON())}_performRefresh(){return Fi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cs(t,e){Re(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Ui{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,o=I0(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new IR(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new Zg(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const n=await Ou(this,this.stsTokenManager.getToken(this.auth,e));return Re(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return bR(this,e)}reload(){return TR(this)}_assign(e){this!==e&&(Re(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Ui(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){Re(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await xf(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Br(this.auth.app))return Promise.reject(Gi(this.auth));const e=await this.getIdToken();return await Ou(this,wR(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,o,a,u,d,m,g;const v=(r=n.displayName)!==null&&r!==void 0?r:void 0,w=(i=n.email)!==null&&i!==void 0?i:void 0,E=(o=n.phoneNumber)!==null&&o!==void 0?o:void 0,C=(a=n.photoURL)!==null&&a!==void 0?a:void 0,P=(u=n.tenantId)!==null&&u!==void 0?u:void 0,F=(d=n._redirectEventId)!==null&&d!==void 0?d:void 0,N=(m=n.createdAt)!==null&&m!==void 0?m:void 0,T=(g=n.lastLoginAt)!==null&&g!==void 0?g:void 0,{uid:A,emailVerified:z,isAnonymous:Z,providerData:H,stsTokenManager:I}=n;Re(A&&I,e,"internal-error");const b=Pl.fromJSON(this.name,I);Re(typeof A=="string",e,"internal-error"),Cs(v,e.name),Cs(w,e.name),Re(typeof z=="boolean",e,"internal-error"),Re(typeof Z=="boolean",e,"internal-error"),Cs(E,e.name),Cs(C,e.name),Cs(P,e.name),Cs(F,e.name),Cs(N,e.name),Cs(T,e.name);const R=new Ui({uid:A,auth:e,email:w,emailVerified:z,displayName:v,isAnonymous:Z,photoURL:C,phoneNumber:E,tenantId:P,stsTokenManager:b,createdAt:N,lastLoginAt:T});return H&&Array.isArray(H)&&(R.providerData=H.map(D=>Object.assign({},D))),F&&(R._redirectEventId=F),R}static async _fromIdTokenResponse(e,n,r=!1){const i=new Pl;i.updateFromServerResponse(n);const o=new Ui({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await xf(o),o}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];Re(i.localId!==void 0,"internal-error");const o=i.providerUserInfo!==void 0?jT(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(o!=null&&o.length),u=new Pl;u.updateFromIdToken(r);const d=new Ui({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:a}),m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Zg(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(o!=null&&o.length)};return Object.assign(d,m),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gx=new Map;function Bi(t){es(t instanceof Function,"Expected a class definition");let e=Gx.get(t);return e?(es(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Gx.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}LT.type="NONE";const Kx=LT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ah(t,e,n){return`firebase:${t}:${e}:${n}`}class Cl{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:o}=this.auth;this.fullUserKey=Ah(this.userKey,i.apiKey,o),this.fullPersistenceKey=Ah("persistence",i.apiKey,o),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Ui._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Cl(Bi(Kx),e,r);const i=(await Promise.all(n.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let o=i[0]||Bi(Kx);const a=Ah(r,e.config.apiKey,e.name);let u=null;for(const m of n)try{const g=await m._get(a);if(g){const v=Ui._fromJSON(e,g);m!==o&&(u=v),o=m;break}}catch{}const d=i.filter(m=>m._shouldAllowMigration);return!o._shouldAllowMigration||!d.length?new Cl(o,e,r):(o=d[0],u&&await o._set(a,u.toJSON()),await Promise.all(n.map(async m=>{if(m!==o)try{await m._remove(a)}catch{}})),new Cl(o,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zx(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(VT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(DT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(UT(e))return"Blackberry";if(BT(e))return"Webos";if(MT(e))return"Safari";if((e.includes("chrome/")||OT(e))&&!e.includes("edge/"))return"Chrome";if(FT(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function DT(t=Kt()){return/firefox\//i.test(t)}function MT(t=Kt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function OT(t=Kt()){return/crios\//i.test(t)}function VT(t=Kt()){return/iemobile/i.test(t)}function FT(t=Kt()){return/android/i.test(t)}function UT(t=Kt()){return/blackberry/i.test(t)}function BT(t=Kt()){return/webos/i.test(t)}function P0(t=Kt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function PR(t=Kt()){var e;return P0(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function CR(){return KC()&&document.documentMode===10}function zT(t=Kt()){return P0(t)||FT(t)||BT(t)||UT(t)||/windows phone/i.test(t)||VT(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qT(t,e=[]){let n;switch(t){case"Browser":n=Zx(Kt());break;case"Worker":n=`${Zx(Kt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Aa}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AR{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=o=>new Promise((a,u)=>{try{const d=e(o);a(d)}catch(d){u(d)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RR(t,e={}){return os(t,"GET","/v2/passwordPolicy",ss(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jR=6;class LR{constructor(e){var n,r,i,o;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=a.minPasswordLength)!==null&&n!==void 0?n:jR,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,o,a,u;const d={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,d),this.validatePasswordCharacterOptions(e,d),d.isValid&&(d.isValid=(n=d.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),d.isValid&&(d.isValid=(r=d.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),d.isValid&&(d.isValid=(i=d.containsLowercaseLetter)!==null&&i!==void 0?i:!0),d.isValid&&(d.isValid=(o=d.containsUppercaseLetter)!==null&&o!==void 0?o:!0),d.isValid&&(d.isValid=(a=d.containsNumericCharacter)!==null&&a!==void 0?a:!0),d.isValid&&(d.isValid=(u=d.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),d}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DR{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Qx(this),this.idTokenSubscription=new Qx(this),this.beforeStateQueue=new AR(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=NT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Bi(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await Cl.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await RT(this,{idToken:e}),r=await Ui._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(Br(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(u,u))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,u=i==null?void 0:i._redirectEventId,d=await this.tryRedirectSignIn(e);(!a||a===u)&&(d!=null&&d.user)&&(i=d.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Re(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await xf(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=mR()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Br(this.app))return Promise.reject(Gi(this));const n=e?Xe(e):null;return n&&Re(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Re(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Br(this.app)?Promise.reject(Gi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Br(this.app)?Promise.reject(Gi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Bi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await RR(this),n=new LR(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Ca("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await NR(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Bi(e)||this._popupRedirectResolver;Re(n,this,"argument-error"),this.redirectPersistenceManager=await Cl.create(this,[Bi(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const o=typeof n=="function"?n:n.next.bind(n);let a=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(Re(u,this,"internal-error"),u.then(()=>{a||o(this.currentUser)}),typeof n=="function"){const d=e.addObserver(n,r,i);return()=>{a=!0,d()}}else{const d=e.addObserver(n);return()=>{a=!0,d()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Re(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=qT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&uR(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function gi(t){return Xe(t)}class Qx{constructor(e){this.auth=e,this.observer=null,this.addObserver=eA(n=>this.observer=n)}get next(){return Re(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cm={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function MR(t){cm=t}function $T(t){return cm.loadJS(t)}function OR(){return cm.recaptchaEnterpriseScript}function VR(){return cm.gapiScript}function FR(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const UR="recaptcha-enterprise",BR="NO_RECAPTCHA";class zR{constructor(e){this.type=UR,this.auth=gi(e)}async verify(e="verify",n=!1){async function r(o){if(!n){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(a,u)=>{xR(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(d=>{if(d.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{const m=new vR(d);return o.tenantId==null?o._agentRecaptchaConfig=m:o._tenantRecaptchaConfigs[o.tenantId]=m,a(m.siteKey)}}).catch(d=>{u(d)})})}function i(o,a,u){const d=window.grecaptcha;Hx(d)?d.enterprise.ready(()=>{d.enterprise.execute(o,{action:e}).then(m=>{a(m)}).catch(()=>{a(BR)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((o,a)=>{r(this.auth).then(u=>{if(!n&&Hx(window.grecaptcha))i(u,o,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let d=OR();d.length!==0&&(d+=u),$T(d).then(()=>{i(u,o,a)}).catch(m=>{a(m)})}}).catch(u=>{a(u)})})}}async function Yx(t,e,n,r=!1){const i=new zR(t);let o;try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const a=Object.assign({},e);return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function wf(t,e,n,r){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await Yx(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await Yx(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qR(t,e){const n=_o(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),o=n.getOptions();if(ha(o,e??{}))return i;Pr(i,"already-initialized")}return n.initialize({options:e})}function $R(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Bi);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function HR(t,e,n){const r=gi(t);Re(r._canInitEmulator,r,"emulator-config-failed"),Re(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,o=HT(e),{host:a,port:u}=WR(e),d=u===null?"":`:${u}`;r.config.emulator={url:`${o}//${a}${d}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:u,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})}),GR()}function HT(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function WR(t){const e=HT(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const o=i[1];return{host:o,port:Jx(r.substr(o.length+1))}}else{const[o,a]=r.split(":");return{host:o,port:Jx(a)}}}function Jx(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function GR(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C0{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Fi("not implemented")}_getIdTokenResponse(e){return Fi("not implemented")}_linkToIdToken(e,n){return Fi("not implemented")}_getReauthenticationResolver(e){return Fi("not implemented")}}async function KR(t,e){return os(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZR(t,e){return sd(t,"POST","/v1/accounts:signInWithPassword",ss(t,e))}async function WT(t,e){return os(t,"POST","/v1/accounts:sendOobCode",ss(t,e))}async function QR(t,e){return WT(t,e)}async function YR(t,e){return WT(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JR(t,e){return sd(t,"POST","/v1/accounts:signInWithEmailLink",ss(t,e))}async function XR(t,e){return sd(t,"POST","/v1/accounts:signInWithEmailLink",ss(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu extends C0{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new Vu(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Vu(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return wf(e,n,"signInWithPassword",ZR);case"emailLink":return JR(e,{email:this._email,oobCode:this._password});default:Pr(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return wf(e,r,"signUpPassword",KR);case"emailLink":return XR(e,{idToken:n,email:this._email,oobCode:this._password});default:Pr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Al(t,e){return sd(t,"POST","/v1/accounts:signInWithIdp",ss(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ej="http://localhost";class fa extends C0{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new fa(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Pr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,o=I0(n,["providerId","signInMethod"]);if(!r||!i)return null;const a=new fa(r,i);return a.idToken=o.idToken||void 0,a.accessToken=o.accessToken||void 0,a.secret=o.secret,a.nonce=o.nonce,a.pendingToken=o.pendingToken||null,a}_getIdTokenResponse(e){const n=this.buildRequest();return Al(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Al(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Al(e,n)}buildRequest(){const e={requestUri:ej,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=rd(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tj(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function nj(t){const e=Kc(Zc(t)).link,n=e?Kc(Zc(e)).deep_link_id:null,r=Kc(Zc(t)).deep_link_id;return(r?Kc(Zc(r)).link:null)||r||n||e||t}class A0{constructor(e){var n,r,i,o,a,u;const d=Kc(Zc(e)),m=(n=d.apiKey)!==null&&n!==void 0?n:null,g=(r=d.oobCode)!==null&&r!==void 0?r:null,v=tj((i=d.mode)!==null&&i!==void 0?i:null);Re(m&&g&&v,"argument-error"),this.apiKey=m,this.operation=v,this.code=g,this.continueUrl=(o=d.continueUrl)!==null&&o!==void 0?o:null,this.languageCode=(a=d.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(u=d.tenantId)!==null&&u!==void 0?u:null}static parseLink(e){const n=nj(e);try{return new A0(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oc{constructor(){this.providerId=oc.PROVIDER_ID}static credential(e,n){return Vu._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=A0.parseLink(n);return Re(r,"argument-error"),Vu._fromEmailAndCode(e,r.code,r.tenantId)}}oc.PROVIDER_ID="password";oc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";oc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R0{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class od extends R0{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs extends od{constructor(){super("facebook.com")}static credential(e){return fa._fromParams({providerId:Fs.PROVIDER_ID,signInMethod:Fs.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Fs.credentialFromTaggedObject(e)}static credentialFromError(e){return Fs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Fs.credential(e.oauthAccessToken)}catch{return null}}}Fs.FACEBOOK_SIGN_IN_METHOD="facebook.com";Fs.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi extends od{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return fa._fromParams({providerId:Mi.PROVIDER_ID,signInMethod:Mi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Mi.credentialFromTaggedObject(e)}static credentialFromError(e){return Mi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Mi.credential(n,r)}catch{return null}}}Mi.GOOGLE_SIGN_IN_METHOD="google.com";Mi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Us extends od{constructor(){super("github.com")}static credential(e){return fa._fromParams({providerId:Us.PROVIDER_ID,signInMethod:Us.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Us.credentialFromTaggedObject(e)}static credentialFromError(e){return Us.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Us.credential(e.oauthAccessToken)}catch{return null}}}Us.GITHUB_SIGN_IN_METHOD="github.com";Us.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bs extends od{constructor(){super("twitter.com")}static credential(e,n){return fa._fromParams({providerId:Bs.PROVIDER_ID,signInMethod:Bs.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Bs.credentialFromTaggedObject(e)}static credentialFromError(e){return Bs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Bs.credential(n,r)}catch{return null}}}Bs.TWITTER_SIGN_IN_METHOD="twitter.com";Bs.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rj(t,e){return sd(t,"POST","/v1/accounts:signUp",ss(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ma{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const o=await Ui._fromIdTokenResponse(e,r,i),a=Xx(r);return new ma({user:o,providerId:a,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=Xx(r);return new ma({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function Xx(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bf extends Cr{constructor(e,n,r,i){var o;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,bf.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new bf(e,n,r,i)}}function GT(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?bf._fromErrorAndOperation(t,o,e,r):o})}async function ij(t,e,n=!1){const r=await Ou(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ma._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sj(t,e,n=!1){const{auth:r}=t;if(Br(r.app))return Promise.reject(Gi(r));const i="reauthenticate";try{const o=await Ou(t,GT(r,i,e,t),n);Re(o.idToken,r,"internal-error");const a=N0(o.idToken);Re(a,r,"internal-error");const{sub:u}=a;return Re(t.uid===u,r,"user-mismatch"),ma._forOperation(t,i,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&Pr(r,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KT(t,e,n=!1){if(Br(t.app))return Promise.reject(Gi(t));const r="signIn",i=await GT(t,r,e),o=await ma._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(o.user),o}async function oj(t,e){return KT(gi(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZT(t){const e=gi(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function aj(t,e,n){const r=gi(t);await wf(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",YR)}async function lj(t,e,n){if(Br(t.app))return Promise.reject(Gi(t));const r=gi(t),a=await wf(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",rj).catch(d=>{throw d.code==="auth/password-does-not-meet-requirements"&&ZT(t),d}),u=await ma._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(u.user),u}function cj(t,e,n){return Br(t.app)?Promise.reject(Gi(t)):oj(Xe(t),oc.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&ZT(t),r})}async function QT(t,e){const n=Xe(t),i={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()},{email:o}=await QR(n.auth,i);o!==t.email&&await t.reload()}function uj(t,e,n,r){return Xe(t).onIdTokenChanged(e,n,r)}function dj(t,e,n){return Xe(t).beforeAuthStateChanged(e,n)}function hj(t,e,n,r){return Xe(t).onAuthStateChanged(e,n,r)}function YT(t){return Xe(t).signOut()}const kf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JT{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(kf,"1"),this.storage.removeItem(kf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fj=1e3,mj=10;class XT extends JT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=zT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((a,u,d)=>{this.notifyListeners(a,d)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(r);!n&&this.localCache[r]===a||this.notifyListeners(r,a)},o=this.storage.getItem(r);CR()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,mj):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},fj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}XT.type="LOCAL";const pj=XT;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eE extends JT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}eE.type="SESSION";const tE=eE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gj(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class um{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new um(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:o}=n.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const u=Array.from(a).map(async m=>m(n.origin,o)),d=await gj(u);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:d})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}um.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j0(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yj{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,a;return new Promise((u,d)=>{const m=j0("",20);i.port1.start();const g=setTimeout(()=>{d(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(v){const w=v;if(w.data.eventId===m)switch(w.data.status){case"ack":clearTimeout(g),o=setTimeout(()=>{d(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),u(w.data.response);break;default:clearTimeout(g),clearTimeout(o),d(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:m,data:n},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hi(){return window}function _j(t){hi().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nE(){return typeof hi().WorkerGlobalScope<"u"&&typeof hi().importScripts=="function"}async function vj(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function xj(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function wj(){return nE()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rE="firebaseLocalStorageDb",bj=1,If="firebaseLocalStorage",iE="fbase_key";class ad{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function dm(t,e){return t.transaction([If],e?"readwrite":"readonly").objectStore(If)}function kj(){const t=indexedDB.deleteDatabase(rE);return new ad(t).toPromise()}function Qg(){const t=indexedDB.open(rE,bj);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(If,{keyPath:iE})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(If)?e(r):(r.close(),await kj(),e(await Qg()))})})}async function ew(t,e,n){const r=dm(t,!0).put({[iE]:e,value:n});return new ad(r).toPromise()}async function Ij(t,e){const n=dm(t,!1).get(e),r=await new ad(n).toPromise();return r===void 0?null:r.value}function tw(t,e){const n=dm(t,!0).delete(e);return new ad(n).toPromise()}const Tj=800,Ej=3;class sE{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Qg(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>Ej)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return nE()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=um._getInstance(wj()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await vj(),!this.activeServiceWorker)return;this.sender=new yj(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||xj()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Qg();return await ew(e,kf,"1"),await tw(e,kf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>ew(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>Ij(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>tw(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const o=dm(i,!1).getAll();return new ad(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:o}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(o)&&(this.notifyListeners(i,o),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Tj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}sE.type="LOCAL";const Sj=sE;new id(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oE(t,e){return e?Bi(e):(Re(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L0 extends C0{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Al(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Al(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Al(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function Nj(t){return KT(t.auth,new L0(t),t.bypassAuthState)}function Pj(t){const{auth:e,user:n}=t;return Re(n,e,"internal-error"),sj(n,new L0(t),t.bypassAuthState)}async function Cj(t){const{auth:e,user:n}=t;return Re(n,e,"internal-error"),ij(n,new L0(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aE{constructor(e,n,r,i,o=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:o,error:a,type:u}=e;if(a){this.reject(a);return}const d={auth:this.auth,requestUri:n,sessionId:r,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(d))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Nj;case"linkViaPopup":case"linkViaRedirect":return Cj;case"reauthViaPopup":case"reauthViaRedirect":return Pj;default:Pr(this.auth,"internal-error")}}resolve(e){es(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){es(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aj=new id(2e3,1e4);async function Rj(t,e,n){if(Br(t.app))return Promise.reject(Hr(t,"operation-not-supported-in-this-environment"));const r=gi(t);dR(t,e,R0);const i=oE(r,n);return new ea(r,"signInViaPopup",e,i).executeNotNull()}class ea extends aE{constructor(e,n,r,i,o){super(e,n,i,o),this.provider=r,this.authWindow=null,this.pollId=null,ea.currentPopupAction&&ea.currentPopupAction.cancel(),ea.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Re(e,this.auth,"internal-error"),e}async onExecution(){es(this.filter.length===1,"Popup operations only handle one event");const e=j0();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Hr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Hr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ea.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Hr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Aj.get())};e()}}ea.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jj="pendingRedirect",Rh=new Map;class Lj extends aE{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Rh.get(this.auth._key());if(!e){try{const r=await Dj(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Rh.set(this.auth._key(),e)}return this.bypassAuthState||Rh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Dj(t,e){const n=Vj(e),r=Oj(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function Mj(t,e){Rh.set(t._key(),e)}function Oj(t){return Bi(t._redirectPersistence)}function Vj(t){return Ah(jj,t.config.apiKey,t.name)}async function Fj(t,e){return await gi(t)._initializationPromise,lE(t,e,!1)}async function lE(t,e,n=!1){if(Br(t.app))return Promise.reject(Gi(t));const r=gi(t),i=oE(r,e),a=await new Lj(r,i,n).execute();return a&&!n&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uj=10*60*1e3;class Bj{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!zj(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!cE(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Hr(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Uj&&this.cachedEventUids.clear(),this.cachedEventUids.has(nw(e))}saveEventToCache(e){this.cachedEventUids.add(nw(e)),this.lastProcessedEventTime=Date.now()}}function nw(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function cE({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function zj(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return cE(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qj(t,e={}){return os(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $j=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Hj=/^https?/;async function Wj(t){if(t.config.emulator)return;const{authorizedDomains:e}=await qj(t);for(const n of e)try{if(Gj(n))return}catch{}Pr(t,"unauthorized-domain")}function Gj(t){const e=Kg(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&a.hostname===r}if(!Hj.test(n))return!1;if($j.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kj=new id(3e4,6e4);function rw(){const t=hi().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function Zj(t){return new Promise((e,n)=>{var r,i,o;function a(){rw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{rw(),n(Hr(t,"network-request-failed"))},timeout:Kj.get()})}if(!((i=(r=hi().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((o=hi().gapi)===null||o===void 0)&&o.load)a();else{const u=FR("iframefcb");return hi()[u]=()=>{gapi.load?a():n(Hr(t,"network-request-failed"))},$T(`${VR()}?onload=${u}`).catch(d=>n(d))}}).catch(e=>{throw jh=null,e})}let jh=null;function Qj(t){return jh=jh||Zj(t),jh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yj=new id(5e3,15e3),Jj="__/auth/iframe",Xj="emulator/auth/iframe",eL={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},tL=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function nL(t){const e=t.config;Re(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?S0(e,Xj):`https://${t.config.authDomain}/${Jj}`,r={apiKey:e.apiKey,appName:t.name,v:Aa},i=tL.get(t.config.apiHost);i&&(r.eid=i);const o=t._getFrameworks();return o.length&&(r.fw=o.join(",")),`${n}?${rd(r).slice(1)}`}async function rL(t){const e=await Qj(t),n=hi().gapi;return Re(n,t,"internal-error"),e.open({where:document.body,url:nL(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:eL,dontclear:!0},r=>new Promise(async(i,o)=>{await r.restyle({setHideOnLeave:!1});const a=Hr(t,"network-request-failed"),u=hi().setTimeout(()=>{o(a)},Yj.get());function d(){hi().clearTimeout(u),i(r)}r.ping(d).then(d,()=>{o(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iL={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},sL=500,oL=600,aL="_blank",lL="http://localhost";class iw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function cL(t,e,n,r=sL,i=oL){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let u="";const d=Object.assign(Object.assign({},iL),{width:r.toString(),height:i.toString(),top:o,left:a}),m=Kt().toLowerCase();n&&(u=OT(m)?aL:n),DT(m)&&(e=e||lL,d.scrollbars="yes");const g=Object.entries(d).reduce((w,[E,C])=>`${w}${E}=${C},`,"");if(PR(m)&&u!=="_self")return uL(e||"",u),new iw(null);const v=window.open(e||"",u,g);Re(v,t,"popup-blocked");try{v.focus()}catch{}return new iw(v)}function uL(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dL="__/auth/handler",hL="emulator/auth/handler",fL=encodeURIComponent("fac");async function sw(t,e,n,r,i,o){Re(t.config.authDomain,t,"auth-domain-config-required"),Re(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Aa,eventId:i};if(e instanceof R0){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",XC(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[g,v]of Object.entries({}))a[g]=v}if(e instanceof od){const g=e.getScopes().filter(v=>v!=="");g.length>0&&(a.scopes=g.join(","))}t.tenantId&&(a.tid=t.tenantId);const u=a;for(const g of Object.keys(u))u[g]===void 0&&delete u[g];const d=await t._getAppCheckToken(),m=d?`#${fL}=${encodeURIComponent(d)}`:"";return`${mL(t)}?${rd(u).slice(1)}${m}`}function mL({config:t}){return t.emulator?S0(t,hL):`https://${t.authDomain}/${dL}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lp="webStorageSupport";class pL{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=tE,this._completeRedirectFn=lE,this._overrideRedirectResult=Mj}async _openPopup(e,n,r,i){var o;es((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");const a=await sw(e,n,r,Kg(),i);return cL(e,a,j0())}async _openRedirect(e,n,r,i){await this._originValidation(e);const o=await sw(e,n,r,Kg(),i);return _j(o),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:o}=this.eventManagers[n];return i?Promise.resolve(i):(es(o,"If manager is not set, promise should be"),o)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await rL(e),r=new Bj(e);return n.register("authEvent",i=>(Re(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Lp,{type:Lp},i=>{var o;const a=(o=i==null?void 0:i[0])===null||o===void 0?void 0:o[Lp];a!==void 0&&n(!!a),Pr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=Wj(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return zT()||MT()||P0()}}const gL=pL;var ow="@firebase/auth",aw="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yL{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Re(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _L(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function vL(t){Nr(new dr("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:a,authDomain:u}=r.options;Re(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const d={apiKey:a,authDomain:u,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:qT(t)},m=new DR(r,i,o,d);return $R(m,n),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Nr(new dr("auth-internal",e=>{const n=gi(e.getProvider("auth").getImmediate());return(r=>new yL(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),xn(ow,aw,_L(t)),xn(ow,aw,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xL=5*60,wL=vT("authIdTokenMaxAge")||xL;let lw=null;const bL=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>wL)return;const i=n==null?void 0:n.token;lw!==i&&(lw=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function kL(t=lm()){const e=_o(t,"auth");if(e.isInitialized())return e.getImmediate();const n=qR(t,{popupRedirectResolver:gL,persistence:[Sj,pj,tE]}),r=vT("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(r,location.origin);if(location.origin===o.origin){const a=bL(o.toString());dj(n,a,()=>a(n.currentUser)),uj(n,u=>a(u))}}const i=gT("auth");return i&&HR(n,`http://${i}`),n}function IL(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}MR({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const o=Hr("internal-error");o.customData=i,n(o)},r.type="text/javascript",r.charset="UTF-8",IL().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});vL("Browser");var cw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ia,uE;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,b){function R(){}R.prototype=b.prototype,I.D=b.prototype,I.prototype=new R,I.prototype.constructor=I,I.C=function(D,O,B){for(var M=Array(arguments.length-2),ee=2;ee<arguments.length;ee++)M[ee-2]=arguments[ee];return b.prototype[O].apply(D,M)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,b,R){R||(R=0);var D=Array(16);if(typeof b=="string")for(var O=0;16>O;++O)D[O]=b.charCodeAt(R++)|b.charCodeAt(R++)<<8|b.charCodeAt(R++)<<16|b.charCodeAt(R++)<<24;else for(O=0;16>O;++O)D[O]=b[R++]|b[R++]<<8|b[R++]<<16|b[R++]<<24;b=I.g[0],R=I.g[1],O=I.g[2];var B=I.g[3],M=b+(B^R&(O^B))+D[0]+3614090360&4294967295;b=R+(M<<7&4294967295|M>>>25),M=B+(O^b&(R^O))+D[1]+3905402710&4294967295,B=b+(M<<12&4294967295|M>>>20),M=O+(R^B&(b^R))+D[2]+606105819&4294967295,O=B+(M<<17&4294967295|M>>>15),M=R+(b^O&(B^b))+D[3]+3250441966&4294967295,R=O+(M<<22&4294967295|M>>>10),M=b+(B^R&(O^B))+D[4]+4118548399&4294967295,b=R+(M<<7&4294967295|M>>>25),M=B+(O^b&(R^O))+D[5]+1200080426&4294967295,B=b+(M<<12&4294967295|M>>>20),M=O+(R^B&(b^R))+D[6]+2821735955&4294967295,O=B+(M<<17&4294967295|M>>>15),M=R+(b^O&(B^b))+D[7]+4249261313&4294967295,R=O+(M<<22&4294967295|M>>>10),M=b+(B^R&(O^B))+D[8]+1770035416&4294967295,b=R+(M<<7&4294967295|M>>>25),M=B+(O^b&(R^O))+D[9]+2336552879&4294967295,B=b+(M<<12&4294967295|M>>>20),M=O+(R^B&(b^R))+D[10]+4294925233&4294967295,O=B+(M<<17&4294967295|M>>>15),M=R+(b^O&(B^b))+D[11]+2304563134&4294967295,R=O+(M<<22&4294967295|M>>>10),M=b+(B^R&(O^B))+D[12]+1804603682&4294967295,b=R+(M<<7&4294967295|M>>>25),M=B+(O^b&(R^O))+D[13]+4254626195&4294967295,B=b+(M<<12&4294967295|M>>>20),M=O+(R^B&(b^R))+D[14]+2792965006&4294967295,O=B+(M<<17&4294967295|M>>>15),M=R+(b^O&(B^b))+D[15]+1236535329&4294967295,R=O+(M<<22&4294967295|M>>>10),M=b+(O^B&(R^O))+D[1]+4129170786&4294967295,b=R+(M<<5&4294967295|M>>>27),M=B+(R^O&(b^R))+D[6]+3225465664&4294967295,B=b+(M<<9&4294967295|M>>>23),M=O+(b^R&(B^b))+D[11]+643717713&4294967295,O=B+(M<<14&4294967295|M>>>18),M=R+(B^b&(O^B))+D[0]+3921069994&4294967295,R=O+(M<<20&4294967295|M>>>12),M=b+(O^B&(R^O))+D[5]+3593408605&4294967295,b=R+(M<<5&4294967295|M>>>27),M=B+(R^O&(b^R))+D[10]+38016083&4294967295,B=b+(M<<9&4294967295|M>>>23),M=O+(b^R&(B^b))+D[15]+3634488961&4294967295,O=B+(M<<14&4294967295|M>>>18),M=R+(B^b&(O^B))+D[4]+3889429448&4294967295,R=O+(M<<20&4294967295|M>>>12),M=b+(O^B&(R^O))+D[9]+568446438&4294967295,b=R+(M<<5&4294967295|M>>>27),M=B+(R^O&(b^R))+D[14]+3275163606&4294967295,B=b+(M<<9&4294967295|M>>>23),M=O+(b^R&(B^b))+D[3]+4107603335&4294967295,O=B+(M<<14&4294967295|M>>>18),M=R+(B^b&(O^B))+D[8]+1163531501&4294967295,R=O+(M<<20&4294967295|M>>>12),M=b+(O^B&(R^O))+D[13]+2850285829&4294967295,b=R+(M<<5&4294967295|M>>>27),M=B+(R^O&(b^R))+D[2]+4243563512&4294967295,B=b+(M<<9&4294967295|M>>>23),M=O+(b^R&(B^b))+D[7]+1735328473&4294967295,O=B+(M<<14&4294967295|M>>>18),M=R+(B^b&(O^B))+D[12]+2368359562&4294967295,R=O+(M<<20&4294967295|M>>>12),M=b+(R^O^B)+D[5]+4294588738&4294967295,b=R+(M<<4&4294967295|M>>>28),M=B+(b^R^O)+D[8]+2272392833&4294967295,B=b+(M<<11&4294967295|M>>>21),M=O+(B^b^R)+D[11]+1839030562&4294967295,O=B+(M<<16&4294967295|M>>>16),M=R+(O^B^b)+D[14]+4259657740&4294967295,R=O+(M<<23&4294967295|M>>>9),M=b+(R^O^B)+D[1]+2763975236&4294967295,b=R+(M<<4&4294967295|M>>>28),M=B+(b^R^O)+D[4]+1272893353&4294967295,B=b+(M<<11&4294967295|M>>>21),M=O+(B^b^R)+D[7]+4139469664&4294967295,O=B+(M<<16&4294967295|M>>>16),M=R+(O^B^b)+D[10]+3200236656&4294967295,R=O+(M<<23&4294967295|M>>>9),M=b+(R^O^B)+D[13]+681279174&4294967295,b=R+(M<<4&4294967295|M>>>28),M=B+(b^R^O)+D[0]+3936430074&4294967295,B=b+(M<<11&4294967295|M>>>21),M=O+(B^b^R)+D[3]+3572445317&4294967295,O=B+(M<<16&4294967295|M>>>16),M=R+(O^B^b)+D[6]+76029189&4294967295,R=O+(M<<23&4294967295|M>>>9),M=b+(R^O^B)+D[9]+3654602809&4294967295,b=R+(M<<4&4294967295|M>>>28),M=B+(b^R^O)+D[12]+3873151461&4294967295,B=b+(M<<11&4294967295|M>>>21),M=O+(B^b^R)+D[15]+530742520&4294967295,O=B+(M<<16&4294967295|M>>>16),M=R+(O^B^b)+D[2]+3299628645&4294967295,R=O+(M<<23&4294967295|M>>>9),M=b+(O^(R|~B))+D[0]+4096336452&4294967295,b=R+(M<<6&4294967295|M>>>26),M=B+(R^(b|~O))+D[7]+1126891415&4294967295,B=b+(M<<10&4294967295|M>>>22),M=O+(b^(B|~R))+D[14]+2878612391&4294967295,O=B+(M<<15&4294967295|M>>>17),M=R+(B^(O|~b))+D[5]+4237533241&4294967295,R=O+(M<<21&4294967295|M>>>11),M=b+(O^(R|~B))+D[12]+1700485571&4294967295,b=R+(M<<6&4294967295|M>>>26),M=B+(R^(b|~O))+D[3]+2399980690&4294967295,B=b+(M<<10&4294967295|M>>>22),M=O+(b^(B|~R))+D[10]+4293915773&4294967295,O=B+(M<<15&4294967295|M>>>17),M=R+(B^(O|~b))+D[1]+2240044497&4294967295,R=O+(M<<21&4294967295|M>>>11),M=b+(O^(R|~B))+D[8]+1873313359&4294967295,b=R+(M<<6&4294967295|M>>>26),M=B+(R^(b|~O))+D[15]+4264355552&4294967295,B=b+(M<<10&4294967295|M>>>22),M=O+(b^(B|~R))+D[6]+2734768916&4294967295,O=B+(M<<15&4294967295|M>>>17),M=R+(B^(O|~b))+D[13]+1309151649&4294967295,R=O+(M<<21&4294967295|M>>>11),M=b+(O^(R|~B))+D[4]+4149444226&4294967295,b=R+(M<<6&4294967295|M>>>26),M=B+(R^(b|~O))+D[11]+3174756917&4294967295,B=b+(M<<10&4294967295|M>>>22),M=O+(b^(B|~R))+D[2]+718787259&4294967295,O=B+(M<<15&4294967295|M>>>17),M=R+(B^(O|~b))+D[9]+3951481745&4294967295,I.g[0]=I.g[0]+b&4294967295,I.g[1]=I.g[1]+(O+(M<<21&4294967295|M>>>11))&4294967295,I.g[2]=I.g[2]+O&4294967295,I.g[3]=I.g[3]+B&4294967295}r.prototype.u=function(I,b){b===void 0&&(b=I.length);for(var R=b-this.blockSize,D=this.B,O=this.h,B=0;B<b;){if(O==0)for(;B<=R;)i(this,I,B),B+=this.blockSize;if(typeof I=="string"){for(;B<b;)if(D[O++]=I.charCodeAt(B++),O==this.blockSize){i(this,D),O=0;break}}else for(;B<b;)if(D[O++]=I[B++],O==this.blockSize){i(this,D),O=0;break}}this.h=O,this.o+=b},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var b=1;b<I.length-8;++b)I[b]=0;var R=8*this.o;for(b=I.length-8;b<I.length;++b)I[b]=R&255,R/=256;for(this.u(I),I=Array(16),b=R=0;4>b;++b)for(var D=0;32>D;D+=8)I[R++]=this.g[b]>>>D&255;return I};function o(I,b){var R=u;return Object.prototype.hasOwnProperty.call(R,I)?R[I]:R[I]=b(I)}function a(I,b){this.h=b;for(var R=[],D=!0,O=I.length-1;0<=O;O--){var B=I[O]|0;D&&B==b||(R[O]=B,D=!1)}this.g=R}var u={};function d(I){return-128<=I&&128>I?o(I,function(b){return new a([b|0],0>b?-1:0)}):new a([I|0],0>I?-1:0)}function m(I){if(isNaN(I)||!isFinite(I))return v;if(0>I)return F(m(-I));for(var b=[],R=1,D=0;I>=R;D++)b[D]=I/R|0,R*=4294967296;return new a(b,0)}function g(I,b){if(I.length==0)throw Error("number format error: empty string");if(b=b||10,2>b||36<b)throw Error("radix out of range: "+b);if(I.charAt(0)=="-")return F(g(I.substring(1),b));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var R=m(Math.pow(b,8)),D=v,O=0;O<I.length;O+=8){var B=Math.min(8,I.length-O),M=parseInt(I.substring(O,O+B),b);8>B?(B=m(Math.pow(b,B)),D=D.j(B).add(m(M))):(D=D.j(R),D=D.add(m(M)))}return D}var v=d(0),w=d(1),E=d(16777216);t=a.prototype,t.m=function(){if(P(this))return-F(this).m();for(var I=0,b=1,R=0;R<this.g.length;R++){var D=this.i(R);I+=(0<=D?D:4294967296+D)*b,b*=4294967296}return I},t.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(C(this))return"0";if(P(this))return"-"+F(this).toString(I);for(var b=m(Math.pow(I,6)),R=this,D="";;){var O=z(R,b).g;R=N(R,O.j(b));var B=((0<R.g.length?R.g[0]:R.h)>>>0).toString(I);if(R=O,C(R))return B+D;for(;6>B.length;)B="0"+B;D=B+D}},t.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function C(I){if(I.h!=0)return!1;for(var b=0;b<I.g.length;b++)if(I.g[b]!=0)return!1;return!0}function P(I){return I.h==-1}t.l=function(I){return I=N(this,I),P(I)?-1:C(I)?0:1};function F(I){for(var b=I.g.length,R=[],D=0;D<b;D++)R[D]=~I.g[D];return new a(R,~I.h).add(w)}t.abs=function(){return P(this)?F(this):this},t.add=function(I){for(var b=Math.max(this.g.length,I.g.length),R=[],D=0,O=0;O<=b;O++){var B=D+(this.i(O)&65535)+(I.i(O)&65535),M=(B>>>16)+(this.i(O)>>>16)+(I.i(O)>>>16);D=M>>>16,B&=65535,M&=65535,R[O]=M<<16|B}return new a(R,R[R.length-1]&-2147483648?-1:0)};function N(I,b){return I.add(F(b))}t.j=function(I){if(C(this)||C(I))return v;if(P(this))return P(I)?F(this).j(F(I)):F(F(this).j(I));if(P(I))return F(this.j(F(I)));if(0>this.l(E)&&0>I.l(E))return m(this.m()*I.m());for(var b=this.g.length+I.g.length,R=[],D=0;D<2*b;D++)R[D]=0;for(D=0;D<this.g.length;D++)for(var O=0;O<I.g.length;O++){var B=this.i(D)>>>16,M=this.i(D)&65535,ee=I.i(O)>>>16,ce=I.i(O)&65535;R[2*D+2*O]+=M*ce,T(R,2*D+2*O),R[2*D+2*O+1]+=B*ce,T(R,2*D+2*O+1),R[2*D+2*O+1]+=M*ee,T(R,2*D+2*O+1),R[2*D+2*O+2]+=B*ee,T(R,2*D+2*O+2)}for(D=0;D<b;D++)R[D]=R[2*D+1]<<16|R[2*D];for(D=b;D<2*b;D++)R[D]=0;return new a(R,0)};function T(I,b){for(;(I[b]&65535)!=I[b];)I[b+1]+=I[b]>>>16,I[b]&=65535,b++}function A(I,b){this.g=I,this.h=b}function z(I,b){if(C(b))throw Error("division by zero");if(C(I))return new A(v,v);if(P(I))return b=z(F(I),b),new A(F(b.g),F(b.h));if(P(b))return b=z(I,F(b)),new A(F(b.g),b.h);if(30<I.g.length){if(P(I)||P(b))throw Error("slowDivide_ only works with positive integers.");for(var R=w,D=b;0>=D.l(I);)R=Z(R),D=Z(D);var O=H(R,1),B=H(D,1);for(D=H(D,2),R=H(R,2);!C(D);){var M=B.add(D);0>=M.l(I)&&(O=O.add(R),B=M),D=H(D,1),R=H(R,1)}return b=N(I,O.j(b)),new A(O,b)}for(O=v;0<=I.l(b);){for(R=Math.max(1,Math.floor(I.m()/b.m())),D=Math.ceil(Math.log(R)/Math.LN2),D=48>=D?1:Math.pow(2,D-48),B=m(R),M=B.j(b);P(M)||0<M.l(I);)R-=D,B=m(R),M=B.j(b);C(B)&&(B=w),O=O.add(B),I=N(I,M)}return new A(O,I)}t.A=function(I){return z(this,I).h},t.and=function(I){for(var b=Math.max(this.g.length,I.g.length),R=[],D=0;D<b;D++)R[D]=this.i(D)&I.i(D);return new a(R,this.h&I.h)},t.or=function(I){for(var b=Math.max(this.g.length,I.g.length),R=[],D=0;D<b;D++)R[D]=this.i(D)|I.i(D);return new a(R,this.h|I.h)},t.xor=function(I){for(var b=Math.max(this.g.length,I.g.length),R=[],D=0;D<b;D++)R[D]=this.i(D)^I.i(D);return new a(R,this.h^I.h)};function Z(I){for(var b=I.g.length+1,R=[],D=0;D<b;D++)R[D]=I.i(D)<<1|I.i(D-1)>>>31;return new a(R,I.h)}function H(I,b){var R=b>>5;b%=32;for(var D=I.g.length-R,O=[],B=0;B<D;B++)O[B]=0<b?I.i(B+R)>>>b|I.i(B+R+1)<<32-b:I.i(B+R);return new a(O,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,uE=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=m,a.fromString=g,ia=a}).apply(typeof cw<"u"?cw:typeof self<"u"?self:typeof window<"u"?window:{});var sh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var dE,Qc,hE,Lh,Yg,fE,mE,pE;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,y,x){return h==Array.prototype||h==Object.prototype||(h[y]=x.value),h};function n(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof sh=="object"&&sh];for(var y=0;y<h.length;++y){var x=h[y];if(x&&x.Math==Math)return x}throw Error("Cannot find global object")}var r=n(this);function i(h,y){if(y)e:{var x=r;h=h.split(".");for(var S=0;S<h.length-1;S++){var q=h[S];if(!(q in x))break e;x=x[q]}h=h[h.length-1],S=x[h],y=y(S),y!=S&&y!=null&&e(x,h,{configurable:!0,writable:!0,value:y})}}function o(h,y){h instanceof String&&(h+="");var x=0,S=!1,q={next:function(){if(!S&&x<h.length){var J=x++;return{value:y(J,h[J]),done:!1}}return S=!0,{done:!0,value:void 0}}};return q[Symbol.iterator]=function(){return q},q}i("Array.prototype.values",function(h){return h||function(){return o(this,function(y,x){return x})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},u=this||self;function d(h){var y=typeof h;return y=y!="object"?y:h?Array.isArray(h)?"array":y:"null",y=="array"||y=="object"&&typeof h.length=="number"}function m(h){var y=typeof h;return y=="object"&&h!=null||y=="function"}function g(h,y,x){return h.call.apply(h.bind,arguments)}function v(h,y,x){if(!h)throw Error();if(2<arguments.length){var S=Array.prototype.slice.call(arguments,2);return function(){var q=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(q,S),h.apply(y,q)}}return function(){return h.apply(y,arguments)}}function w(h,y,x){return w=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?g:v,w.apply(null,arguments)}function E(h,y){var x=Array.prototype.slice.call(arguments,1);return function(){var S=x.slice();return S.push.apply(S,arguments),h.apply(this,S)}}function C(h,y){function x(){}x.prototype=y.prototype,h.aa=y.prototype,h.prototype=new x,h.prototype.constructor=h,h.Qb=function(S,q,J){for(var oe=Array(arguments.length-2),nt=2;nt<arguments.length;nt++)oe[nt-2]=arguments[nt];return y.prototype[q].apply(S,oe)}}function P(h){const y=h.length;if(0<y){const x=Array(y);for(let S=0;S<y;S++)x[S]=h[S];return x}return[]}function F(h,y){for(let x=1;x<arguments.length;x++){const S=arguments[x];if(d(S)){const q=h.length||0,J=S.length||0;h.length=q+J;for(let oe=0;oe<J;oe++)h[q+oe]=S[oe]}else h.push(S)}}class N{constructor(y,x){this.i=y,this.j=x,this.h=0,this.g=null}get(){let y;return 0<this.h?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function T(h){return/^[\s\xa0]*$/.test(h)}function A(){var h=u.navigator;return h&&(h=h.userAgent)?h:""}function z(h){return z[" "](h),h}z[" "]=function(){};var Z=A().indexOf("Gecko")!=-1&&!(A().toLowerCase().indexOf("webkit")!=-1&&A().indexOf("Edge")==-1)&&!(A().indexOf("Trident")!=-1||A().indexOf("MSIE")!=-1)&&A().indexOf("Edge")==-1;function H(h,y,x){for(const S in h)y.call(x,h[S],S,h)}function I(h,y){for(const x in h)y.call(void 0,h[x],x,h)}function b(h){const y={};for(const x in h)y[x]=h[x];return y}const R="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function D(h,y){let x,S;for(let q=1;q<arguments.length;q++){S=arguments[q];for(x in S)h[x]=S[x];for(let J=0;J<R.length;J++)x=R[J],Object.prototype.hasOwnProperty.call(S,x)&&(h[x]=S[x])}}function O(h){var y=1;h=h.split(":");const x=[];for(;0<y&&h.length;)x.push(h.shift()),y--;return h.length&&x.push(h.join(":")),x}function B(h){u.setTimeout(()=>{throw h},0)}function M(){var h=le;let y=null;return h.g&&(y=h.g,h.g=h.g.next,h.g||(h.h=null),y.next=null),y}class ee{constructor(){this.h=this.g=null}add(y,x){const S=ce.get();S.set(y,x),this.h?this.h.next=S:this.g=S,this.h=S}}var ce=new N(()=>new me,h=>h.reset());class me{constructor(){this.next=this.g=this.h=null}set(y,x){this.h=y,this.g=x,this.next=null}reset(){this.next=this.g=this.h=null}}let we,G=!1,le=new ee,te=()=>{const h=u.Promise.resolve(void 0);we=()=>{h.then(ke)}};var ke=()=>{for(var h;h=M();){try{h.h.call(h.g)}catch(x){B(x)}var y=ce;y.j(h),100>y.h&&(y.h++,h.next=y.g,y.g=h)}G=!1};function de(){this.s=this.s,this.C=this.C}de.prototype.s=!1,de.prototype.ma=function(){this.s||(this.s=!0,this.N())},de.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function pe(h,y){this.type=h,this.g=this.target=y,this.defaultPrevented=!1}pe.prototype.h=function(){this.defaultPrevented=!0};var ve=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var h=!1,y=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const x=()=>{};u.addEventListener("test",x,y),u.removeEventListener("test",x,y)}catch{}return h}();function he(h,y){if(pe.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var x=this.type=h.type,S=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=y,y=h.relatedTarget){if(Z){e:{try{z(y.nodeName);var q=!0;break e}catch{}q=!1}q||(y=null)}}else x=="mouseover"?y=h.fromElement:x=="mouseout"&&(y=h.toElement);this.relatedTarget=y,S?(this.clientX=S.clientX!==void 0?S.clientX:S.pageX,this.clientY=S.clientY!==void 0?S.clientY:S.pageY,this.screenX=S.screenX||0,this.screenY=S.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:se[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&he.aa.h.call(this)}}C(he,pe);var se={2:"touch",3:"pen",4:"mouse"};he.prototype.h=function(){he.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var Me="closure_listenable_"+(1e6*Math.random()|0),Ye=0;function tr(h,y,x,S,q){this.listener=h,this.proxy=null,this.src=y,this.type=x,this.capture=!!S,this.ha=q,this.key=++Ye,this.da=this.fa=!1}function Pt(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function In(h){this.src=h,this.g={},this.h=0}In.prototype.add=function(h,y,x,S,q){var J=h.toString();h=this.g[J],h||(h=this.g[J]=[],this.h++);var oe=ht(h,y,S,q);return-1<oe?(y=h[oe],x||(y.fa=!1)):(y=new tr(y,this.src,J,!!S,q),y.fa=x,h.push(y)),y};function cn(h,y){var x=y.type;if(x in h.g){var S=h.g[x],q=Array.prototype.indexOf.call(S,y,void 0),J;(J=0<=q)&&Array.prototype.splice.call(S,q,1),J&&(Pt(y),h.g[x].length==0&&(delete h.g[x],h.h--))}}function ht(h,y,x,S){for(var q=0;q<h.length;++q){var J=h[q];if(!J.da&&J.listener==y&&J.capture==!!x&&J.ha==S)return q}return-1}var ft="closure_lm_"+(1e6*Math.random()|0),Ke={};function $t(h,y,x,S,q){if(Array.isArray(y)){for(var J=0;J<y.length;J++)$t(h,y[J],x,S,q);return null}return x=Vn(x),h&&h[Me]?h.K(y,x,m(S)?!!S.capture:!1,q):mt(h,y,x,!1,S,q)}function mt(h,y,x,S,q,J){if(!y)throw Error("Invalid event type");var oe=m(q)?!!q.capture:!!q,nt=ds(h);if(nt||(h[ft]=nt=new In(h)),x=nt.add(y,x,S,oe,J),x.proxy)return x;if(S=un(),x.proxy=S,S.src=h,S.listener=x,h.addEventListener)ve||(q=oe),q===void 0&&(q=!1),h.addEventListener(y.toString(),S,q);else if(h.attachEvent)h.attachEvent(us(y.toString()),S);else if(h.addListener&&h.removeListener)h.addListener(S);else throw Error("addEventListener and attachEvent are unavailable.");return x}function un(){function h(x){return y.call(h.src,h.listener,x)}const y=Ma;return h}function ls(h,y,x,S,q){if(Array.isArray(y))for(var J=0;J<y.length;J++)ls(h,y[J],x,S,q);else S=m(S)?!!S.capture:!!S,x=Vn(x),h&&h[Me]?(h=h.i,y=String(y).toString(),y in h.g&&(J=h.g[y],x=ht(J,x,S,q),-1<x&&(Pt(J[x]),Array.prototype.splice.call(J,x,1),J.length==0&&(delete h.g[y],h.h--)))):h&&(h=ds(h))&&(y=h.g[y.toString()],h=-1,y&&(h=ht(y,x,S,q)),(x=-1<h?y[h]:null)&&cs(x))}function cs(h){if(typeof h!="number"&&h&&!h.da){var y=h.src;if(y&&y[Me])cn(y.i,h);else{var x=h.type,S=h.proxy;y.removeEventListener?y.removeEventListener(x,S,h.capture):y.detachEvent?y.detachEvent(us(x),S):y.addListener&&y.removeListener&&y.removeListener(S),(x=ds(y))?(cn(x,h),x.h==0&&(x.src=null,y[ft]=null)):Pt(h)}}}function us(h){return h in Ke?Ke[h]:Ke[h]="on"+h}function Ma(h,y){if(h.da)h=!0;else{y=new he(y,this);var x=h.listener,S=h.ha||h.src;h.fa&&cs(h),h=x.call(S,y)}return h}function ds(h){return h=h[ft],h instanceof In?h:null}var vi="__closure_events_fn_"+(1e9*Math.random()>>>0);function Vn(h){return typeof h=="function"?h:(h[vi]||(h[vi]=function(y){return h.handleEvent(y)}),h[vi])}function bt(){de.call(this),this.i=new In(this),this.M=this,this.F=null}C(bt,de),bt.prototype[Me]=!0,bt.prototype.removeEventListener=function(h,y,x,S){ls(this,h,y,x,S)};function Ft(h,y){var x,S=h.F;if(S)for(x=[];S;S=S.F)x.push(S);if(h=h.M,S=y.type||y,typeof y=="string")y=new pe(y,h);else if(y instanceof pe)y.target=y.target||h;else{var q=y;y=new pe(S,h),D(y,q)}if(q=!0,x)for(var J=x.length-1;0<=J;J--){var oe=y.g=x[J];q=Gr(oe,S,!0,y)&&q}if(oe=y.g=h,q=Gr(oe,S,!0,y)&&q,q=Gr(oe,S,!1,y)&&q,x)for(J=0;J<x.length;J++)oe=y.g=x[J],q=Gr(oe,S,!1,y)&&q}bt.prototype.N=function(){if(bt.aa.N.call(this),this.i){var h=this.i,y;for(y in h.g){for(var x=h.g[y],S=0;S<x.length;S++)Pt(x[S]);delete h.g[y],h.h--}}this.F=null},bt.prototype.K=function(h,y,x,S){return this.i.add(String(h),y,!1,x,S)},bt.prototype.L=function(h,y,x,S){return this.i.add(String(h),y,!0,x,S)};function Gr(h,y,x,S){if(y=h.i.g[String(y)],!y)return!0;y=y.concat();for(var q=!0,J=0;J<y.length;++J){var oe=y[J];if(oe&&!oe.da&&oe.capture==x){var nt=oe.listener,Ut=oe.ha||oe.src;oe.fa&&cn(h.i,oe),q=nt.call(Ut,S)!==!1&&q}}return q&&!S.defaultPrevented}function ko(h,y,x){if(typeof h=="function")x&&(h=w(h,x));else if(h&&typeof h.handleEvent=="function")h=w(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(y)?-1:u.setTimeout(h,y||0)}function xi(h){h.g=ko(()=>{h.g=null,h.i&&(h.i=!1,xi(h))},h.l);const y=h.h;h.h=null,h.m.apply(null,y)}class Io extends de{constructor(y,x){super(),this.m=y,this.l=x,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:xi(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Kr(h){de.call(this),this.h=h,this.g={}}C(Kr,de);var Fn=[];function hs(h){H(h.g,function(y,x){this.g.hasOwnProperty(x)&&cs(y)},h),h.g={}}Kr.prototype.N=function(){Kr.aa.N.call(this),hs(this)},Kr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var fs=u.JSON.stringify,hc=u.JSON.parse,Zr=class{stringify(h){return u.JSON.stringify(h,void 0)}parse(h){return u.JSON.parse(h,void 0)}};function ms(){}ms.prototype.h=null;function ps(h){return h.h||(h.h=h.i())}function To(){}var Ar={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function gs(){pe.call(this,"d")}C(gs,pe);function wi(){pe.call(this,"c")}C(wi,pe);var Tn={},bi=null;function ys(){return bi=bi||new bt}Tn.La="serverreachability";function Eo(h){pe.call(this,Tn.La,h)}C(Eo,pe);function Qr(h){const y=ys();Ft(y,new Eo(y))}Tn.STAT_EVENT="statevent";function ki(h,y){pe.call(this,Tn.STAT_EVENT,h),this.stat=y}C(ki,pe);function Ht(h){const y=ys();Ft(y,new ki(y,h))}Tn.Ma="timingevent";function So(h,y){pe.call(this,Tn.Ma,h),this.size=y}C(So,pe);function Yr(h,y){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){h()},y)}function Ii(){this.g=!0}Ii.prototype.xa=function(){this.g=!1};function Un(h,y,x,S,q,J){h.info(function(){if(h.g)if(J)for(var oe="",nt=J.split("&"),Ut=0;Ut<nt.length;Ut++){var Ze=nt[Ut].split("=");if(1<Ze.length){var ot=Ze[0];Ze=Ze[1];var Tt=ot.split("_");oe=2<=Tt.length&&Tt[1]=="type"?oe+(ot+"="+Ze+"&"):oe+(ot+"=redacted&")}}else oe=null;else oe=J;return"XMLHTTP REQ ("+S+") [attempt "+q+"]: "+y+`
`+x+`
`+oe})}function Te(h,y,x,S,q,J,oe){h.info(function(){return"XMLHTTP RESP ("+S+") [ attempt "+q+"]: "+y+`
`+x+`
`+J+" "+oe})}function Rr(h,y,x,S){h.info(function(){return"XMLHTTP TEXT ("+y+"): "+Oa(h,x)+(S?" "+S:"")})}function No(h,y){h.info(function(){return"TIMEOUT: "+y})}Ii.prototype.info=function(){};function Oa(h,y){if(!h.g)return y;if(!y)return null;try{var x=JSON.parse(y);if(x){for(h=0;h<x.length;h++)if(Array.isArray(x[h])){var S=x[h];if(!(2>S.length)){var q=S[1];if(Array.isArray(q)&&!(1>q.length)){var J=q[0];if(J!="noop"&&J!="stop"&&J!="close")for(var oe=1;oe<q.length;oe++)q[oe]=""}}}}return fs(x)}catch{return y}}var En={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},kt={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},dn;function ct(){}C(ct,ms),ct.prototype.g=function(){return new XMLHttpRequest},ct.prototype.i=function(){return{}},dn=new ct;function Bn(h,y,x,S){this.j=h,this.i=y,this.l=x,this.R=S||1,this.U=new Kr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Po}function Po(){this.i=null,this.g="",this.h=!1}var Co={},tt={};function Ao(h,y,x){h.L=1,h.v=fe(pt(y)),h.m=x,h.P=!0,Ro(h,null)}function Ro(h,y){h.F=Date.now(),vs(h),h.A=pt(h.v);var x=h.A,S=h.R;Array.isArray(S)||(S=[String(S)]),wd(x.i,"t",S),h.C=0,x=h.j.J,h.h=new Po,h.g=Nd(h.j,x?y:null,!h.m),0<h.O&&(h.M=new Io(w(h.Y,h,h.g),h.O)),y=h.U,x=h.g,S=h.ca;var q="readystatechange";Array.isArray(q)||(q&&(Fn[0]=q.toString()),q=Fn);for(var J=0;J<q.length;J++){var oe=$t(x,q[J],S||y.handleEvent,!1,y.h||y);if(!oe)break;y.g[oe.key]=oe}y=h.H?b(h.H):{},h.m?(h.u||(h.u="POST"),y["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,y)):(h.u="GET",h.g.ea(h.A,h.u,null,y)),Qr(),Un(h.i,h.u,h.A,h.l,h.R,h.m)}Bn.prototype.ca=function(h){h=h.target;const y=this.M;y&&Nn(h)==3?y.j():this.Y(h)},Bn.prototype.Y=function(h){try{if(h==this.g)e:{const Tt=Nn(this.g);var y=this.g.Ba();const Ss=this.g.Z();if(!(3>Tt)&&(Tt!=3||this.g&&(this.h.h||this.g.oa()||vc(this.g)))){this.J||Tt!=4||y==7||(y==8||0>=Ss?Qr(3):Qr(2)),Lo(this);var x=this.g.Z();this.X=x;t:if(Va(this)){var S=vc(this.g);h="";var q=S.length,J=Nn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){jr(this),Ti(this);var oe="";break t}this.h.i=new u.TextDecoder}for(y=0;y<q;y++)this.h.h=!0,h+=this.h.i.decode(S[y],{stream:!(J&&y==q-1)});S.length=0,this.h.g+=h,this.C=0,oe=this.h.g}else oe=this.g.oa();if(this.o=x==200,Te(this.i,this.u,this.A,this.l,this.R,Tt,x),this.o){if(this.T&&!this.K){t:{if(this.g){var nt,Ut=this.g;if((nt=Ut.g?Ut.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!T(nt)){var Ze=nt;break t}}Ze=null}if(x=Ze)Rr(this.i,this.l,x,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ei(this,x);else{this.o=!1,this.s=3,Ht(12),jr(this),Ti(this);break e}}if(this.P){x=!0;let Mt;for(;!this.J&&this.C<oe.length;)if(Mt=_s(this,oe),Mt==tt){Tt==4&&(this.s=4,Ht(14),x=!1),Rr(this.i,this.l,null,"[Incomplete Response]");break}else if(Mt==Co){this.s=4,Ht(15),Rr(this.i,this.l,oe,"[Invalid Chunk]"),x=!1;break}else Rr(this.i,this.l,Mt,null),Ei(this,Mt);if(Va(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Tt!=4||oe.length!=0||this.h.h||(this.s=1,Ht(16),x=!1),this.o=this.o&&x,!x)Rr(this.i,this.l,oe,"[Invalid Chunked Response]"),jr(this),Ti(this);else if(0<oe.length&&!this.W){this.W=!0;var ot=this.j;ot.g==this&&ot.ba&&!ot.M&&(ot.j.info("Great, no buffering proxy detected. Bytes received: "+oe.length),Ha(ot),ot.M=!0,Ht(11))}}else Rr(this.i,this.l,oe,null),Ei(this,oe);Tt==4&&jr(this),this.o&&!this.J&&(Tt==4?wc(this.j,this):(this.o=!1,vs(this)))}else Km(this.g),x==400&&0<oe.indexOf("Unknown SID")?(this.s=3,Ht(12)):(this.s=0,Ht(13)),jr(this),Ti(this)}}}catch{}finally{}};function Va(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function _s(h,y){var x=h.C,S=y.indexOf(`
`,x);return S==-1?tt:(x=Number(y.substring(x,S)),isNaN(x)?Co:(S+=1,S+x>y.length?tt:(y=y.slice(S,S+x),h.C=S+x,y)))}Bn.prototype.cancel=function(){this.J=!0,jr(this)};function vs(h){h.S=Date.now()+h.I,jo(h,h.I)}function jo(h,y){if(h.B!=null)throw Error("WatchDog timer not null");h.B=Yr(w(h.ba,h),y)}function Lo(h){h.B&&(u.clearTimeout(h.B),h.B=null)}Bn.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(No(this.i,this.A),this.L!=2&&(Qr(),Ht(17)),jr(this),this.s=2,Ti(this)):jo(this,this.S-h)};function Ti(h){h.j.G==0||h.J||wc(h.j,h)}function jr(h){Lo(h);var y=h.M;y&&typeof y.ma=="function"&&y.ma(),h.M=null,hs(h.U),h.g&&(y=h.g,h.g=null,y.abort(),y.ma())}function Ei(h,y){try{var x=h.j;if(x.G!=0&&(x.g==h||Le(x.h,h))){if(!h.K&&Le(x.h,h)&&x.G==3){try{var S=x.Da.g.parse(y)}catch{S=null}if(Array.isArray(S)&&S.length==3){var q=S;if(q[0]==0){e:if(!x.u){if(x.g)if(x.g.F+3e3<h.F)Ga(x),qa(x);else break e;$a(x),Ht(18)}}else x.za=q[1],0<x.za-x.T&&37500>q[2]&&x.F&&x.v==0&&!x.C&&(x.C=Yr(w(x.Za,x),6e3));if(1>=Xr(x.h)&&x.ca){try{x.ca()}catch{}x.ca=void 0}}else Pi(x,11)}else if((h.K||x.g==h)&&Ga(x),!T(y))for(q=x.Da.g.parse(y),y=0;y<q.length;y++){let Ze=q[y];if(x.T=Ze[0],Ze=Ze[1],x.G==2)if(Ze[0]=="c"){x.K=Ze[1],x.ia=Ze[2];const ot=Ze[3];ot!=null&&(x.la=ot,x.j.info("VER="+x.la));const Tt=Ze[4];Tt!=null&&(x.Aa=Tt,x.j.info("SVER="+x.Aa));const Ss=Ze[5];Ss!=null&&typeof Ss=="number"&&0<Ss&&(S=1.5*Ss,x.L=S,x.j.info("backChannelRequestTimeoutMs_="+S)),S=x;const Mt=h.g;if(Mt){const Za=Mt.g?Mt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Za){var J=S.h;J.g||Za.indexOf("spdy")==-1&&Za.indexOf("quic")==-1&&Za.indexOf("h2")==-1||(J.j=J.l,J.g=new Set,J.h&&(ye(J,J.h),J.h=null))}if(S.D){const ni=Mt.g?Mt.g.getResponseHeader("X-HTTP-Session-Id"):null;ni&&(S.ya=ni,Q(S.I,S.D,ni))}}x.G=3,x.l&&x.l.ua(),x.ba&&(x.R=Date.now()-h.F,x.j.info("Handshake RTT: "+x.R+"ms")),S=x;var oe=h;if(S.qa=Ka(S,S.J?S.ia:null,S.W),oe.K){ei(S.h,oe);var nt=oe,Ut=S.L;Ut&&(nt.I=Ut),nt.B&&(Lo(nt),vs(nt)),S.g=oe}else Mr(S);0<x.i.length&&Es(x)}else Ze[0]!="stop"&&Ze[0]!="close"||Pi(x,7);else x.G==3&&(Ze[0]=="stop"||Ze[0]=="close"?Ze[0]=="stop"?Pi(x,7):za(x):Ze[0]!="noop"&&x.l&&x.l.ta(Ze),x.v=0)}}Qr(4)}catch{}}var Jr=class{constructor(h,y){this.g=h,this.map=y}};function Do(h){this.l=h||10,u.PerformanceNavigationTiming?(h=u.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Mo(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Xr(h){return h.h?1:h.g?h.g.size:0}function Le(h,y){return h.h?h.h==y:h.g?h.g.has(y):!1}function ye(h,y){h.g?h.g.add(y):h.h=y}function ei(h,y){h.h&&h.h==y?h.h=null:h.g&&h.g.has(y)&&h.g.delete(y)}Do.prototype.cancel=function(){if(this.i=pr(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function pr(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let y=h.i;for(const x of h.g.values())y=y.concat(x.D);return y}return P(h.i)}function Lr(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(d(h)){for(var y=[],x=h.length,S=0;S<x;S++)y.push(h[S]);return y}y=[],x=0;for(S in h)y[x++]=h[S];return y}function xs(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(d(h)||typeof h=="string"){var y=[];h=h.length;for(var x=0;x<h;x++)y.push(x);return y}y=[],x=0;for(const S in h)y[x++]=S;return y}}}function je(h,y){if(h.forEach&&typeof h.forEach=="function")h.forEach(y,void 0);else if(d(h)||typeof h=="string")Array.prototype.forEach.call(h,y,void 0);else for(var x=xs(h),S=Lr(h),q=S.length,J=0;J<q;J++)y.call(void 0,S[J],x&&x[J],h)}var lt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ws(h,y){if(h){h=h.split("&");for(var x=0;x<h.length;x++){var S=h[x].indexOf("="),q=null;if(0<=S){var J=h[x].substring(0,S);q=h[x].substring(S+1)}else J=h[x];y(J,q?decodeURIComponent(q.replace(/\+/g," ")):"")}}}function Sn(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof Sn){this.h=h.h,Si(this,h.j),this.o=h.o,this.g=h.g,j(this,h.s),this.l=h.l;var y=h.i,x=new Dr;x.i=y.i,y.g&&(x.g=new Map(y.g),x.h=y.h),K(this,x),this.m=h.m}else h&&(y=String(h).match(lt))?(this.h=!1,Si(this,y[1]||"",!0),this.o=Ae(y[2]||""),this.g=Ae(y[3]||"",!0),j(this,y[4]),this.l=Ae(y[5]||"",!0),K(this,y[6]||"",!0),this.m=Ae(y[7]||"")):(this.h=!1,this.i=new Dr(null,this.h))}Sn.prototype.toString=function(){var h=[],y=this.j;y&&h.push(ze(y,Dt,!0),":");var x=this.g;return(x||y=="file")&&(h.push("//"),(y=this.o)&&h.push(ze(y,Dt,!0),"@"),h.push(encodeURIComponent(String(x)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),x=this.s,x!=null&&h.push(":",String(x))),(x=this.l)&&(this.g&&x.charAt(0)!="/"&&h.push("/"),h.push(ze(x,x.charAt(0)=="/"?bs:Qt,!0))),(x=this.i.toString())&&h.push("?",x),(x=this.m)&&h.push("#",ze(x,Oo)),h.join("")};function pt(h){return new Sn(h)}function Si(h,y,x){h.j=x?Ae(y,!0):y,h.j&&(h.j=h.j.replace(/:$/,""))}function j(h,y){if(y){if(y=Number(y),isNaN(y)||0>y)throw Error("Bad port number "+y);h.s=y}else h.s=null}function K(h,y,x){y instanceof Dr?(h.i=y,gr(h.i,h.h)):(x||(y=ze(y,ks)),h.i=new Dr(y,h.h))}function Q(h,y,x){h.i.set(y,x)}function fe(h){return Q(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function Ae(h,y){return h?y?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function ze(h,y,x){return typeof h=="string"?(h=encodeURI(h).replace(y,Ve),x&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function Ve(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Dt=/[#\/\?@]/g,Qt=/[#\?:]/g,bs=/[#\?]/g,ks=/[#\?@]/g,Oo=/#/g;function Dr(h,y){this.h=this.g=null,this.i=h||null,this.j=!!y}function hn(h){h.g||(h.g=new Map,h.h=0,h.i&&ws(h.i,function(y,x){h.add(decodeURIComponent(y.replace(/\+/g," ")),x)}))}t=Dr.prototype,t.add=function(h,y){hn(this),this.i=null,h=Pe(this,h);var x=this.g.get(h);return x||this.g.set(h,x=[]),x.push(y),this.h+=1,this};function fc(h,y){hn(h),y=Pe(h,y),h.g.has(y)&&(h.i=null,h.h-=h.g.get(y).length,h.g.delete(y))}function Fa(h,y){return hn(h),y=Pe(h,y),h.g.has(y)}t.forEach=function(h,y){hn(this),this.g.forEach(function(x,S){x.forEach(function(q){h.call(y,q,S,this)},this)},this)},t.na=function(){hn(this);const h=Array.from(this.g.values()),y=Array.from(this.g.keys()),x=[];for(let S=0;S<y.length;S++){const q=h[S];for(let J=0;J<q.length;J++)x.push(y[S])}return x},t.V=function(h){hn(this);let y=[];if(typeof h=="string")Fa(this,h)&&(y=y.concat(this.g.get(Pe(this,h))));else{h=Array.from(this.g.values());for(let x=0;x<h.length;x++)y=y.concat(h[x])}return y},t.set=function(h,y){return hn(this),this.i=null,h=Pe(this,h),Fa(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[y]),this.h+=1,this},t.get=function(h,y){return h?(h=this.V(h),0<h.length?String(h[0]):y):y};function wd(h,y,x){fc(h,y),0<x.length&&(h.i=null,h.g.set(Pe(h,y),P(x)),h.h+=x.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],y=Array.from(this.g.keys());for(var x=0;x<y.length;x++){var S=y[x];const J=encodeURIComponent(String(S)),oe=this.V(S);for(S=0;S<oe.length;S++){var q=J;oe[S]!==""&&(q+="="+encodeURIComponent(String(oe[S]))),h.push(q)}}return this.i=h.join("&")};function Pe(h,y){return y=String(y),h.j&&(y=y.toLowerCase()),y}function gr(h,y){y&&!h.j&&(hn(h),h.i=null,h.g.forEach(function(x,S){var q=S.toLowerCase();S!=q&&(fc(this,S),wd(this,q,x))},h)),h.j=y}function st(h,y){const x=new Ii;if(u.Image){const S=new Image;S.onload=E(yr,x,"TestLoadImage: loaded",!0,y,S),S.onerror=E(yr,x,"TestLoadImage: error",!1,y,S),S.onabort=E(yr,x,"TestLoadImage: abort",!1,y,S),S.ontimeout=E(yr,x,"TestLoadImage: timeout",!1,y,S),u.setTimeout(function(){S.ontimeout&&S.ontimeout()},1e4),S.src=h}else y(!1)}function bd(h,y){const x=new Ii,S=new AbortController,q=setTimeout(()=>{S.abort(),yr(x,"TestPingServer: timeout",!1,y)},1e4);fetch(h,{signal:S.signal}).then(J=>{clearTimeout(q),J.ok?yr(x,"TestPingServer: ok",!0,y):yr(x,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(q),yr(x,"TestPingServer: error",!1,y)})}function yr(h,y,x,S,q){try{q&&(q.onload=null,q.onerror=null,q.onabort=null,q.ontimeout=null),S(x)}catch{}}function mc(){this.g=new Zr}function pc(h,y,x){const S=x||"";try{je(h,function(q,J){let oe=q;m(q)&&(oe=fs(q)),y.push(S+J+"="+encodeURIComponent(oe))})}catch(q){throw y.push(S+"type="+encodeURIComponent("_badmap")),q}}function _r(h){this.l=h.Ub||null,this.j=h.eb||!1}C(_r,ms),_r.prototype.g=function(){return new Is(this.l,this.j)},_r.prototype.i=function(h){return function(){return h}}({});function Is(h,y){bt.call(this),this.D=h,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}C(Is,bt),t=Is.prototype,t.open=function(h,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=y,this.readyState=1,nr(this)},t.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(y.body=h),(this.D||u).fetch(new Request(this.A,y)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,It(this)),this.readyState=0},t.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,nr(this)),this.g&&(this.readyState=3,nr(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ts(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function Ts(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}t.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var y=h.value?h.value:new Uint8Array(0);(y=this.v.decode(y,{stream:!h.done}))&&(this.response=this.responseText+=y)}h.done?It(this):nr(this),this.readyState==3&&Ts(this)}},t.Ra=function(h){this.g&&(this.response=this.responseText=h,It(this))},t.Qa=function(h){this.g&&(this.response=h,It(this))},t.ga=function(){this.g&&It(this)};function It(h){h.readyState=4,h.l=null,h.j=null,h.v=null,nr(h)}t.setRequestHeader=function(h,y){this.u.append(h,y)},t.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],y=this.h.entries();for(var x=y.next();!x.done;)x=x.value,h.push(x[0]+": "+x[1]),x=y.next();return h.join(`\r
`)};function nr(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Is.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function gc(h){let y="";return H(h,function(x,S){y+=S,y+=":",y+=x,y+=`\r
`}),y}function Ua(h,y,x){e:{for(S in x){var S=!1;break e}S=!0}S||(x=gc(x),typeof h=="string"?x!=null&&encodeURIComponent(String(x)):Q(h,y,x))}function _t(h){bt.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}C(_t,bt);var kd=/^https?$/i,yc=["POST","PUT"];t=_t.prototype,t.Ha=function(h){this.J=h},t.ea=function(h,y,x,S){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);y=y?y.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():dn.g(),this.v=this.o?ps(this.o):ps(dn),this.g.onreadystatechange=w(this.Ea,this);try{this.B=!0,this.g.open(y,String(h),!0),this.B=!1}catch(J){Id(this,J);return}if(h=x||"",x=new Map(this.headers),S)if(Object.getPrototypeOf(S)===Object.prototype)for(var q in S)x.set(q,S[q]);else if(typeof S.keys=="function"&&typeof S.get=="function")for(const J of S.keys())x.set(J,S.get(J));else throw Error("Unknown input type for opt_headers: "+String(S));S=Array.from(x.keys()).find(J=>J.toLowerCase()=="content-type"),q=u.FormData&&h instanceof u.FormData,!(0<=Array.prototype.indexOf.call(yc,y,void 0))||S||q||x.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[J,oe]of x)this.g.setRequestHeader(J,oe);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{zn(this),this.u=!0,this.g.send(h),this.u=!1}catch(J){Id(this,J)}};function Id(h,y){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=y,h.m=5,_c(h),Ba(h)}function _c(h){h.A||(h.A=!0,Ft(h,"complete"),Ft(h,"error"))}t.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,Ft(this,"complete"),Ft(this,"abort"),Ba(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ba(this,!0)),_t.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?qe(this):this.bb())},t.bb=function(){qe(this)};function qe(h){if(h.h&&typeof a<"u"&&(!h.v[1]||Nn(h)!=4||h.Z()!=2)){if(h.u&&Nn(h)==4)ko(h.Ea,0,h);else if(Ft(h,"readystatechange"),Nn(h)==4){h.h=!1;try{const oe=h.Z();e:switch(oe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var x;if(!(x=y)){var S;if(S=oe===0){var q=String(h.D).match(lt)[1]||null;!q&&u.self&&u.self.location&&(q=u.self.location.protocol.slice(0,-1)),S=!kd.test(q?q.toLowerCase():"")}x=S}if(x)Ft(h,"complete"),Ft(h,"success");else{h.m=6;try{var J=2<Nn(h)?h.g.statusText:""}catch{J=""}h.l=J+" ["+h.Z()+"]",_c(h)}}finally{Ba(h)}}}}function Ba(h,y){if(h.g){zn(h);const x=h.g,S=h.v[0]?()=>{}:null;h.g=null,h.v=null,y||Ft(h,"ready");try{x.onreadystatechange=S}catch{}}}function zn(h){h.I&&(u.clearTimeout(h.I),h.I=null)}t.isActive=function(){return!!this.g};function Nn(h){return h.g?h.g.readyState:0}t.Z=function(){try{return 2<Nn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(h){if(this.g){var y=this.g.responseText;return h&&y.indexOf(h)==0&&(y=y.substring(h.length)),hc(y)}};function vc(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function Km(h){const y={};h=(h.g&&2<=Nn(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let S=0;S<h.length;S++){if(T(h[S]))continue;var x=O(h[S]);const q=x[0];if(x=x[1],typeof x!="string")continue;x=x.trim();const J=y[q]||[];y[q]=J,J.push(x)}I(y,function(S){return S.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ni(h,y,x){return x&&x.internalChannelParams&&x.internalChannelParams[h]||y}function Td(h){this.Aa=0,this.i=[],this.j=new Ii,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ni("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ni("baseRetryDelayMs",5e3,h),this.cb=Ni("retryDelaySeedMs",1e4,h),this.Wa=Ni("forwardChannelMaxRetries",2,h),this.wa=Ni("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new Do(h&&h.concurrentRequestLimit),this.Da=new mc,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Td.prototype,t.la=8,t.G=1,t.connect=function(h,y,x,S){Ht(0),this.W=h,this.H=y||{},x&&S!==void 0&&(this.H.OSID=x,this.H.OAID=S),this.F=this.X,this.I=Ka(this,null,this.W),Es(this)};function za(h){if(Ed(h),h.G==3){var y=h.U++,x=pt(h.I);if(Q(x,"SID",h.K),Q(x,"RID",y),Q(x,"TYPE","terminate"),Vo(h,x),y=new Bn(h,h.j,y),y.L=2,y.v=fe(pt(x)),x=!1,u.navigator&&u.navigator.sendBeacon)try{x=u.navigator.sendBeacon(y.v.toString(),"")}catch{}!x&&u.Image&&(new Image().src=y.v,x=!0),x||(y.g=Nd(y.j,null),y.g.ea(y.v)),y.F=Date.now(),vs(y)}Sd(h)}function qa(h){h.g&&(Ha(h),h.g.cancel(),h.g=null)}function Ed(h){qa(h),h.u&&(u.clearTimeout(h.u),h.u=null),Ga(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&u.clearTimeout(h.s),h.s=null)}function Es(h){if(!Mo(h.h)&&!h.s){h.s=!0;var y=h.Ga;we||te(),G||(we(),G=!0),le.add(y,h),h.B=0}}function Zm(h,y){return Xr(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=y.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=Yr(w(h.Ga,h,y),bc(h,h.B)),h.B++,!0)}t.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const q=new Bn(this,this.j,h);let J=this.o;if(this.S&&(J?(J=b(J),D(J,this.S)):J=this.S),this.m!==null||this.O||(q.H=J,J=null),this.P)e:{for(var y=0,x=0;x<this.i.length;x++){t:{var S=this.i[x];if("__data__"in S.map&&(S=S.map.__data__,typeof S=="string")){S=S.length;break t}S=void 0}if(S===void 0)break;if(y+=S,4096<y){y=x;break e}if(y===4096||x===this.i.length-1){y=x+1;break e}}y=1e3}else y=1e3;y=xc(this,q,y),x=pt(this.I),Q(x,"RID",h),Q(x,"CVER",22),this.D&&Q(x,"X-HTTP-Session-Id",this.D),Vo(this,x),J&&(this.O?y="headers="+encodeURIComponent(String(gc(J)))+"&"+y:this.m&&Ua(x,this.m,J)),ye(this.h,q),this.Ua&&Q(x,"TYPE","init"),this.P?(Q(x,"$req",y),Q(x,"SID","null"),q.T=!0,Ao(q,x,null)):Ao(q,x,y),this.G=2}}else this.G==3&&(h?rr(this,h):this.i.length==0||Mo(this.h)||rr(this))};function rr(h,y){var x;y?x=y.l:x=h.U++;const S=pt(h.I);Q(S,"SID",h.K),Q(S,"RID",x),Q(S,"AID",h.T),Vo(h,S),h.m&&h.o&&Ua(S,h.m,h.o),x=new Bn(h,h.j,x,h.B+1),h.m===null&&(x.H=h.o),y&&(h.i=y.D.concat(h.i)),y=xc(h,x,1e3),x.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),ye(h.h,x),Ao(x,S,y)}function Vo(h,y){h.H&&H(h.H,function(x,S){Q(y,S,x)}),h.l&&je({},function(x,S){Q(y,S,x)})}function xc(h,y,x){x=Math.min(h.i.length,x);var S=h.l?w(h.l.Na,h.l,h):null;e:{var q=h.i;let J=-1;for(;;){const oe=["count="+x];J==-1?0<x?(J=q[0].g,oe.push("ofs="+J)):J=0:oe.push("ofs="+J);let nt=!0;for(let Ut=0;Ut<x;Ut++){let Ze=q[Ut].g;const ot=q[Ut].map;if(Ze-=J,0>Ze)J=Math.max(0,q[Ut].g-100),nt=!1;else try{pc(ot,oe,"req"+Ze+"_")}catch{S&&S(ot)}}if(nt){S=oe.join("&");break e}}}return h=h.i.splice(0,x),y.D=h,S}function Mr(h){if(!h.g&&!h.u){h.Y=1;var y=h.Fa;we||te(),G||(we(),G=!0),le.add(y,h),h.v=0}}function $a(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=Yr(w(h.Fa,h),bc(h,h.v)),h.v++,!0)}t.Fa=function(){if(this.u=null,Wa(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=Yr(w(this.ab,this),h)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ht(10),qa(this),Wa(this))};function Ha(h){h.A!=null&&(u.clearTimeout(h.A),h.A=null)}function Wa(h){h.g=new Bn(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var y=pt(h.qa);Q(y,"RID","rpc"),Q(y,"SID",h.K),Q(y,"AID",h.T),Q(y,"CI",h.F?"0":"1"),!h.F&&h.ja&&Q(y,"TO",h.ja),Q(y,"TYPE","xmlhttp"),Vo(h,y),h.m&&h.o&&Ua(y,h.m,h.o),h.L&&(h.g.I=h.L);var x=h.g;h=h.ia,x.L=1,x.v=fe(pt(y)),x.m=null,x.P=!0,Ro(x,h)}t.Za=function(){this.C!=null&&(this.C=null,qa(this),$a(this),Ht(19))};function Ga(h){h.C!=null&&(u.clearTimeout(h.C),h.C=null)}function wc(h,y){var x=null;if(h.g==y){Ga(h),Ha(h),h.g=null;var S=2}else if(Le(h.h,y))x=y.D,ei(h.h,y),S=1;else return;if(h.G!=0){if(y.o)if(S==1){x=y.m?y.m.length:0,y=Date.now()-y.F;var q=h.B;S=ys(),Ft(S,new So(S,x)),Es(h)}else Mr(h);else if(q=y.s,q==3||q==0&&0<y.X||!(S==1&&Zm(h,y)||S==2&&$a(h)))switch(x&&0<x.length&&(y=h.h,y.i=y.i.concat(x)),q){case 1:Pi(h,5);break;case 4:Pi(h,10);break;case 3:Pi(h,6);break;default:Pi(h,2)}}}function bc(h,y){let x=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(x*=2),x*y}function Pi(h,y){if(h.j.info("Error code "+y),y==2){var x=w(h.fb,h),S=h.Xa;const q=!S;S=new Sn(S||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Si(S,"https"),fe(S),q?st(S.toString(),x):bd(S.toString(),x)}else Ht(2);h.G=0,h.l&&h.l.sa(y),Sd(h),Ed(h)}t.fb=function(h){h?(this.j.info("Successfully pinged google.com"),Ht(2)):(this.j.info("Failed to ping google.com"),Ht(1))};function Sd(h){if(h.G=0,h.ka=[],h.l){const y=pr(h.h);(y.length!=0||h.i.length!=0)&&(F(h.ka,y),F(h.ka,h.i),h.h.i.length=0,P(h.i),h.i.length=0),h.l.ra()}}function Ka(h,y,x){var S=x instanceof Sn?pt(x):new Sn(x);if(S.g!="")y&&(S.g=y+"."+S.g),j(S,S.s);else{var q=u.location;S=q.protocol,y=y?y+"."+q.hostname:q.hostname,q=+q.port;var J=new Sn(null);S&&Si(J,S),y&&(J.g=y),q&&j(J,q),x&&(J.l=x),S=J}return x=h.D,y=h.ya,x&&y&&Q(S,x,y),Q(S,"VER",h.la),Vo(h,S),S}function Nd(h,y,x){if(y&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return y=h.Ca&&!h.pa?new _t(new _r({eb:x})):new _t(h.pa),y.Ha(h.J),y}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function kc(){}t=kc.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Fo(){}Fo.prototype.g=function(h,y){return new Yt(h,y)};function Yt(h,y){bt.call(this),this.g=new Td(y),this.l=h,this.h=y&&y.messageUrlParams||null,h=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(h?h["X-WebChannel-Content-Type"]=y.messageContentType:h={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.va&&(h?h["X-WebChannel-Client-Profile"]=y.va:h={"X-WebChannel-Client-Profile":y.va}),this.g.S=h,(h=y&&y.Sb)&&!T(h)&&(this.g.m=h),this.v=y&&y.supportsCrossDomainXhr||!1,this.u=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!T(y)&&(this.g.D=y,h=this.h,h!==null&&y in h&&(h=this.h,y in h&&delete h[y])),this.j=new vr(this)}C(Yt,bt),Yt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Yt.prototype.close=function(){za(this.g)},Yt.prototype.o=function(h){var y=this.g;if(typeof h=="string"){var x={};x.__data__=h,h=x}else this.u&&(x={},x.__data__=fs(h),h=x);y.i.push(new Jr(y.Ya++,h)),y.G==3&&Es(y)},Yt.prototype.N=function(){this.g.l=null,delete this.j,za(this.g),delete this.g,Yt.aa.N.call(this)};function ti(h){gs.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var y=h.__sm__;if(y){e:{for(const x in y){h=x;break e}h=void 0}(this.i=h)&&(h=this.i,y=y!==null&&h in y?y[h]:void 0),this.data=y}else this.data=h}C(ti,gs);function Pd(){wi.call(this),this.status=1}C(Pd,wi);function vr(h){this.g=h}C(vr,kc),vr.prototype.ua=function(){Ft(this.g,"a")},vr.prototype.ta=function(h){Ft(this.g,new ti(h))},vr.prototype.sa=function(h){Ft(this.g,new Pd)},vr.prototype.ra=function(){Ft(this.g,"b")},Fo.prototype.createWebChannel=Fo.prototype.g,Yt.prototype.send=Yt.prototype.o,Yt.prototype.open=Yt.prototype.m,Yt.prototype.close=Yt.prototype.close,pE=function(){return new Fo},mE=function(){return ys()},fE=Tn,Yg={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},En.NO_ERROR=0,En.TIMEOUT=8,En.HTTP_ERROR=6,Lh=En,kt.COMPLETE="complete",hE=kt,To.EventType=Ar,Ar.OPEN="a",Ar.CLOSE="b",Ar.ERROR="c",Ar.MESSAGE="d",bt.prototype.listen=bt.prototype.K,Qc=To,_t.prototype.listenOnce=_t.prototype.L,_t.prototype.getLastError=_t.prototype.Ka,_t.prototype.getLastErrorCode=_t.prototype.Ba,_t.prototype.getStatus=_t.prototype.Z,_t.prototype.getResponseJson=_t.prototype.Oa,_t.prototype.getResponseText=_t.prototype.oa,_t.prototype.send=_t.prototype.ea,_t.prototype.setWithCredentials=_t.prototype.Ha,dE=_t}).apply(typeof sh<"u"?sh:typeof self<"u"?self:typeof window<"u"?window:{});const uw="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};gn.UNAUTHENTICATED=new gn(null),gn.GOOGLE_CREDENTIALS=new gn("google-credentials-uid"),gn.FIRST_PARTY=new gn("first-party-uid"),gn.MOCK_USER=new gn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ac="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pa=new b0("@firebase/firestore");function sl(){return pa.logLevel}function re(t,...e){if(pa.logLevel<=He.DEBUG){const n=e.map(D0);pa.debug(`Firestore (${ac}): ${t}`,...n)}}function Vt(t,...e){if(pa.logLevel<=He.ERROR){const n=e.map(D0);pa.error(`Firestore (${ac}): ${t}`,...n)}}function Bl(t,...e){if(pa.logLevel<=He.WARN){const n=e.map(D0);pa.warn(`Firestore (${ac}): ${t}`,...n)}}function D0(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function be(t="Unexpected state"){const e=`FIRESTORE (${ac}) INTERNAL ASSERTION FAILED: `+t;throw Vt(e),new Error(e)}function Ee(t,e){t||be()}function Ie(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ae extends Cr{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TL{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class gE{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(gn.UNAUTHENTICATED))}shutdown(){}}class EL{constructor(e){this.t=e,this.currentUser=gn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Ee(this.o===void 0);let r=this.i;const i=d=>this.i!==r?(r=this.i,n(d)):Promise.resolve();let o=new fi;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new fi,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const d=o;e.enqueueRetryable(async()=>{await d.promise,await i(this.currentUser)})},u=d=>{re("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(d=>u(d)),setTimeout(()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?u(d):(re("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new fi)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(re("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ee(typeof r.accessToken=="string"),new TL(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ee(e===null||typeof e=="string"),new gn(e)}}class SL{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=gn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class NL{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new SL(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(gn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class PL{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class CL{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Ee(this.o===void 0);const r=o=>{o.error!=null&&re("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const a=o.token!==this.R;return this.R=o.token,re("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};const i=o=>{re("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){const o=this.A.getImmediate({optional:!0});o?i(o):re("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Ee(typeof n.token=="string"),this.R=n.token,new PL(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AL(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=AL(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<n&&(r+=e.charAt(i[o]%e.length))}return r}}function De(t,e){return t<e?-1:t>e?1:0}function zl(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function yE(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Be{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new ae(X.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ae(X.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new ae(X.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ae(X.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Be.fromMillis(Date.now())}static fromDate(e){return Be.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Be(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?De(this.nanoseconds,e.nanoseconds):De(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Se{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Se(e)}static min(){return new Se(new Be(0,0))}static max(){return new Se(new Be(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fu{constructor(e,n,r){n===void 0?n=0:n>e.length&&be(),r===void 0?r=e.length-n:r>e.length-n&&be(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Fu.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Fu?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const o=e.get(i),a=n.get(i);if(o<a)return-1;if(o>a)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class et extends Fu{construct(e,n,r){return new et(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new ae(X.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new et(n)}static emptyPath(){return new et([])}}const RL=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class wt extends Fu{construct(e,n,r){return new wt(e,n,r)}static isValidIdentifier(e){return RL.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),wt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new wt(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const o=()=>{if(r.length===0)throw new ae(X.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let a=!1;for(;i<e.length;){const u=e[i];if(u==="\\"){if(i+1===e.length)throw new ae(X.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[i+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new ae(X.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=d,i+=2}else u==="`"?(a=!a,i++):u!=="."||a?(r+=u,i++):(o(),i++)}if(o(),a)throw new ae(X.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new wt(n)}static emptyPath(){return new wt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ue{constructor(e){this.path=e}static fromPath(e){return new ue(et.fromString(e))}static fromName(e){return new ue(et.fromString(e).popFirst(5))}static empty(){return new ue(et.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&et.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return et.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ue(new et(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tf{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function Jg(t){return t.fields.find(e=>e.kind===2)}function $o(t){return t.fields.filter(e=>e.kind!==2)}Tf.UNKNOWN_ID=-1;class Dh{constructor(e,n){this.fieldPath=e,this.kind=n}}class Uu{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Uu(0,hr.min())}}function _E(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=Se.fromTimestamp(r===1e9?new Be(n+1,0):new Be(n,r));return new hr(i,ue.empty(),e)}function vE(t){return new hr(t.readTime,t.key,-1)}class hr{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new hr(Se.min(),ue.empty(),-1)}static max(){return new hr(Se.max(),ue.empty(),-1)}}function O0(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ue.comparator(t.documentKey,e.documentKey),n!==0?n:De(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xE="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class wE{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vo(t){if(t.code!==X.FAILED_PRECONDITION||t.message!==xE)throw t;re("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&be(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new W((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(n,o).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof W?n:W.resolve(n)}catch(n){return W.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):W.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):W.reject(n)}static resolve(e){return new W((n,r)=>{n(e)})}static reject(e){return new W((n,r)=>{r(e)})}static waitFor(e){return new W((n,r)=>{let i=0,o=0,a=!1;e.forEach(u=>{++i,u.next(()=>{++o,a&&o===i&&n()},d=>r(d))}),a=!0,o===i&&n()})}static or(e){let n=W.resolve(!1);for(const r of e)n=n.next(i=>i?W.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,o)=>{r.push(n.call(this,i,o))}),this.waitFor(r)}static mapArray(e,n){return new W((r,i)=>{const o=e.length,a=new Array(o);let u=0;for(let d=0;d<o;d++){const m=d;n(e[m]).next(g=>{a[m]=g,++u,u===o&&r(a)},g=>i(g))}})}static doWhile(e,n){return new W((r,i)=>{const o=()=>{e()===!0?n().next(()=>{o()},i):r()};o()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hm{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new fi,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new du(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=V0(r.target.error);this.V.reject(new du(e,i))}}static open(e,n,r,i){try{return new hm(n,e.transaction(i,r))}catch(o){throw new du(n,o)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(re("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new LL(n)}}class io{constructor(e,n,r){this.name=e,this.version=n,this.p=r,io.S(Kt())===12.2&&Vt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return re("SimpleDb","Removing database:",e),Wo(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!w0())return!1;if(io.v())return!0;const e=Kt(),n=io.S(e),r=0<n&&n<10,i=bE(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(re("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=o=>{const a=o.target.result;n(a)},i.onblocked=()=>{r(new du(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=o=>{const a=o.target.error;a.name==="VersionError"?r(new ae(X.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):a.name==="InvalidStateError"?r(new ae(X.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a)):r(new du(e,a))},i.onupgradeneeded=o=>{re("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);const a=o.target.result;this.p.O(a,i.transaction,o.oldVersion,this.version).next(()=>{re("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=n=>this.N(n)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const o=n==="readonly";let a=0;for(;;){++a;try{this.db=await this.M(e);const u=hm.open(this.db,e,o?"readonly":"readwrite",r),d=i(u).next(m=>(u.g(),m)).catch(m=>(u.abort(m),W.reject(m))).toPromise();return d.catch(()=>{}),await u.m,d}catch(u){const d=u,m=d.name!=="FirebaseError"&&a<3;if(re("SimpleDb","Transaction failed with error:",d.message,"Retrying:",m),this.close(),!m)return Promise.reject(d)}}}close(){this.db&&this.db.close(),this.db=void 0}}function bE(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class jL{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Wo(this.B.delete())}}class du extends ae{constructor(e,n){super(X.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function xo(t){return t.name==="IndexedDbTransactionError"}class LL{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(re("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(re("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Wo(r)}add(e){return re("SimpleDb","ADD",this.store.name,e,e),Wo(this.store.add(e))}get(e){return Wo(this.store.get(e)).next(n=>(n===void 0&&(n=null),re("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return re("SimpleDb","DELETE",this.store.name,e),Wo(this.store.delete(e))}count(){return re("SimpleDb","COUNT",this.store.name),Wo(this.store.count())}U(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const o=i.getAll(r.range);return new W((a,u)=>{o.onerror=d=>{u(d.target.error)},o.onsuccess=d=>{a(d.target.result)}})}{const o=this.cursor(r),a=[];return this.W(o,(u,d)=>{a.push(d)}).next(()=>a)}}G(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new W((i,o)=>{r.onerror=a=>{o(a.target.error)},r.onsuccess=a=>{i(a.target.result)}})}j(e,n){re("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.H=!1;const i=this.cursor(r);return this.W(i,(o,a,u)=>u.delete())}J(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.W(i,n)}Y(e){const n=this.cursor({});return new W((r,i)=>{n.onerror=o=>{const a=V0(o.target.error);i(a)},n.onsuccess=o=>{const a=o.target.result;a?e(a.primaryKey,a.value).next(u=>{u?a.continue():r()}):r()}})}W(e,n){const r=[];return new W((i,o)=>{e.onerror=a=>{o(a.target.error)},e.onsuccess=a=>{const u=a.target.result;if(!u)return void i();const d=new jL(u),m=n(u.primaryKey,u.value,d);if(m instanceof W){const g=m.catch(v=>(d.done(),W.reject(v)));r.push(g)}d.isDone?i():d.K===null?u.continue():u.continue(d.K)}}).next(()=>W.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Wo(t){return new W((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=V0(r.target.error);n(i)}})}let dw=!1;function V0(t){const e=io.S(Kt());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new ae("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return dw||(dw=!0,setTimeout(()=>{throw r},0)),r}}return t}class DL{constructor(e,n){this.asyncQueue=e,this.Z=n,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){re("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{re("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(n){xo(n)?re("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):await vo(n)}await this.X(6e4)})}}class ML{constructor(e,n){this.localStore=e,this.persistence=n}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.te(n,e))}te(e,n){const r=new Set;let i=n,o=!0;return W.doWhile(()=>o===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(a=>{if(a!==null&&!r.has(a))return re("IndexBackfiller",`Processing collection: ${a}`),this.ne(e,a,i).next(u=>{i-=u,r.add(a)});o=!1})).next(()=>n-i)}ne(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(o=>{const a=o.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next(()=>this.re(i,o)).next(u=>(re("IndexBackfiller",`Updating offset: ${u}`),this.localStore.indexManager.updateCollectionGroup(e,n,u))).next(()=>a.size)}))}re(e,n){let r=e;return n.changes.forEach((i,o)=>{const a=vE(o);O0(a,r)>0&&(r=a)}),new hr(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Zn.oe=-1;function fm(t){return t==null}function Bu(t){return t===0&&1/t==-1/0}function kE(t){return typeof t=="number"&&Number.isInteger(t)&&!Bu(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ln(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=hw(e)),e=OL(t.get(n),e);return hw(e)}function OL(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function hw(t){return t+""}function ai(t){const e=t.length;if(Ee(e>=2),e===2)return Ee(t.charAt(0)===""&&t.charAt(1)===""),et.emptyPath();const n=e-2,r=[];let i="";for(let o=0;o<e;){const a=t.indexOf("",o);switch((a<0||a>n)&&be(),t.charAt(a+1)){case"":const u=t.substring(o,a);let d;i.length===0?d=u:(i+=u,d=i,i=""),r.push(d);break;case"":i+=t.substring(o,a),i+="\0";break;case"":i+=t.substring(o,a+1);break;default:be()}o=a+2}return new et(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fw=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mh(t,e){return[t,Ln(e)]}function IE(t,e,n){return[t,Ln(e),n]}const VL={},FL=["prefixPath","collectionGroup","readTime","documentId"],UL=["prefixPath","collectionGroup","documentId"],BL=["collectionGroup","readTime","prefixPath","documentId"],zL=["canonicalId","targetId"],qL=["targetId","path"],$L=["path","targetId"],HL=["collectionId","parent"],WL=["indexId","uid"],GL=["uid","sequenceNumber"],KL=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],ZL=["indexId","uid","orderedDocumentKey"],QL=["userId","collectionPath","documentId"],YL=["userId","collectionPath","largestBatchId"],JL=["userId","collectionGroup","largestBatchId"],TE=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],XL=[...TE,"documentOverlays"],EE=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],SE=EE,F0=[...SE,"indexConfiguration","indexState","indexEntries"],eD=F0,tD=[...F0,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xg extends wE{constructor(e,n){super(),this._e=e,this.currentSequenceNumber=n}}function Zt(t,e){const n=Ie(t);return io.F(n._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mw(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ra(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function NE(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt{constructor(e,n){this.comparator=e,this.root=n||rn.EMPTY}insert(e,n){return new dt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,rn.BLACK,null,null))}remove(e){return new dt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,rn.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new oh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new oh(this.root,e,this.comparator,!1)}getReverseIterator(){return new oh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new oh(this.root,e,this.comparator,!0)}}class oh{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=n?r(e.key,n):1,n&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class rn{constructor(e,n,r,i,o){this.key=e,this.value=n,this.color=r??rn.RED,this.left=i??rn.EMPTY,this.right=o??rn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,o){return new rn(e??this.key,n??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,n,r),null):o===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return rn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return rn.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,rn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,rn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw be();const e=this.left.check();if(e!==this.right.check())throw be();return e+(this.isRed()?0:1)}}rn.EMPTY=null,rn.RED=!0,rn.BLACK=!1;rn.EMPTY=new class{constructor(){this.size=0}get key(){throw be()}get value(){throw be()}get color(){throw be()}get left(){throw be()}get right(){throw be()}copy(e,n,r,i,o){return this}insert(e,n,r){return new rn(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{constructor(e){this.comparator=e,this.data=new dt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new pw(this.data.getIterator())}getIteratorFrom(e){return new pw(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof at)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new at(this.comparator);return n.data=e,n}}class pw{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function tl(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qn{constructor(e){this.fields=e,e.sort(wt.comparator)}static empty(){return new Qn([])}unionWith(e){let n=new at(wt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Qn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return zl(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PE extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new PE("Invalid base64 string: "+o):o}}(e);return new Rt(n)}static fromUint8Array(e){const n=function(i){let o="";for(let a=0;a<i.length;++a)o+=String.fromCharCode(i[a]);return o}(e);return new Rt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return De(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Rt.EMPTY_BYTE_STRING=new Rt("");const nD=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ts(t){if(Ee(!!t),typeof t=="string"){let e=0;const n=nD.exec(t);if(Ee(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:vt(t.seconds),nanos:vt(t.nanos)}}function vt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ao(t){return typeof t=="string"?Rt.fromBase64String(t):Rt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U0(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function B0(t){const e=t.mapValue.fields.__previous_value__;return U0(e)?B0(e):e}function zu(t){const e=ts(t.mapValue.fields.__local_write_time__.timestampValue);return new Be(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rD{constructor(e,n,r,i,o,a,u,d,m){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=d,this.useFetchStreams=m}}class lo{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new lo("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof lo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gs={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Oh={nullValue:"NULL_VALUE"};function ga(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?U0(t)?4:CE(t)?9007199254740991:mm(t)?10:11:be()}function mi(t,e){if(t===e)return!0;const n=ga(t);if(n!==ga(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return zu(t).isEqual(zu(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const a=ts(i.timestampValue),u=ts(o.timestampValue);return a.seconds===u.seconds&&a.nanos===u.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,o){return ao(i.bytesValue).isEqual(ao(o.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,o){return vt(i.geoPointValue.latitude)===vt(o.geoPointValue.latitude)&&vt(i.geoPointValue.longitude)===vt(o.geoPointValue.longitude)}(t,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return vt(i.integerValue)===vt(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const a=vt(i.doubleValue),u=vt(o.doubleValue);return a===u?Bu(a)===Bu(u):isNaN(a)&&isNaN(u)}return!1}(t,e);case 9:return zl(t.arrayValue.values||[],e.arrayValue.values||[],mi);case 10:case 11:return function(i,o){const a=i.mapValue.fields||{},u=o.mapValue.fields||{};if(mw(a)!==mw(u))return!1;for(const d in a)if(a.hasOwnProperty(d)&&(u[d]===void 0||!mi(a[d],u[d])))return!1;return!0}(t,e);default:return be()}}function qu(t,e){return(t.values||[]).find(n=>mi(n,e))!==void 0}function co(t,e){if(t===e)return 0;const n=ga(t),r=ga(e);if(n!==r)return De(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return De(t.booleanValue,e.booleanValue);case 2:return function(o,a){const u=vt(o.integerValue||o.doubleValue),d=vt(a.integerValue||a.doubleValue);return u<d?-1:u>d?1:u===d?0:isNaN(u)?isNaN(d)?0:-1:1}(t,e);case 3:return gw(t.timestampValue,e.timestampValue);case 4:return gw(zu(t),zu(e));case 5:return De(t.stringValue,e.stringValue);case 6:return function(o,a){const u=ao(o),d=ao(a);return u.compareTo(d)}(t.bytesValue,e.bytesValue);case 7:return function(o,a){const u=o.split("/"),d=a.split("/");for(let m=0;m<u.length&&m<d.length;m++){const g=De(u[m],d[m]);if(g!==0)return g}return De(u.length,d.length)}(t.referenceValue,e.referenceValue);case 8:return function(o,a){const u=De(vt(o.latitude),vt(a.latitude));return u!==0?u:De(vt(o.longitude),vt(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return yw(t.arrayValue,e.arrayValue);case 10:return function(o,a){var u,d,m,g;const v=o.fields||{},w=a.fields||{},E=(u=v.value)===null||u===void 0?void 0:u.arrayValue,C=(d=w.value)===null||d===void 0?void 0:d.arrayValue,P=De(((m=E==null?void 0:E.values)===null||m===void 0?void 0:m.length)||0,((g=C==null?void 0:C.values)===null||g===void 0?void 0:g.length)||0);return P!==0?P:yw(E,C)}(t.mapValue,e.mapValue);case 11:return function(o,a){if(o===Gs.mapValue&&a===Gs.mapValue)return 0;if(o===Gs.mapValue)return 1;if(a===Gs.mapValue)return-1;const u=o.fields||{},d=Object.keys(u),m=a.fields||{},g=Object.keys(m);d.sort(),g.sort();for(let v=0;v<d.length&&v<g.length;++v){const w=De(d[v],g[v]);if(w!==0)return w;const E=co(u[d[v]],m[g[v]]);if(E!==0)return E}return De(d.length,g.length)}(t.mapValue,e.mapValue);default:throw be()}}function gw(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return De(t,e);const n=ts(t),r=ts(e),i=De(n.seconds,r.seconds);return i!==0?i:De(n.nanos,r.nanos)}function yw(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const o=co(n[i],r[i]);if(o)return o}return De(n.length,r.length)}function ql(t){return ey(t)}function ey(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=ts(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return ao(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ue.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const o of n.values||[])i?i=!1:r+=",",r+=ey(o);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",o=!0;for(const a of r)o?o=!1:i+=",",i+=`${a}:${ey(n.fields[a])}`;return i+"}"}(t.mapValue):be()}function $u(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function ty(t){return!!t&&"integerValue"in t}function Hu(t){return!!t&&"arrayValue"in t}function _w(t){return!!t&&"nullValue"in t}function vw(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Vh(t){return!!t&&"mapValue"in t}function mm(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function hu(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Ra(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=hu(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=hu(t.arrayValue.values[n]);return e}return Object.assign({},t)}function CE(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const AE={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function iD(t){return"nullValue"in t?Oh:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?$u(lo.empty(),ue.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?mm(t)?AE:{mapValue:{}}:be()}function sD(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?$u(lo.empty(),ue.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?AE:"mapValue"in t?mm(t)?{mapValue:{}}:Gs:be()}function xw(t,e){const n=co(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function ww(t,e){const n=co(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e){this.value=e}static empty(){return new _n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Vh(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=hu(n)}setAll(e){let n=wt.emptyPath(),r={},i=[];e.forEach((a,u)=>{if(!n.isImmediateParentOf(u)){const d=this.getFieldsMap(n);this.applyChanges(d,r,i),r={},i=[],n=u.popLast()}a?r[u.lastSegment()]=hu(a):i.push(u.lastSegment())});const o=this.getFieldsMap(n);this.applyChanges(o,r,i)}delete(e){const n=this.field(e.popLast());Vh(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return mi(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Vh(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Ra(n,(i,o)=>e[i]=o);for(const i of r)delete e[i]}clone(){return new _n(hu(this.value))}}function RE(t){const e=[];return Ra(t.fields,(n,r)=>{const i=new wt([n]);if(Vh(r)){const o=RE(r.mapValue).fields;if(o.length===0)e.push(i);else for(const a of o)e.push(i.child(a))}else e.push(i)}),new Qn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class At{constructor(e,n,r,i,o,a,u){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=o,this.data=a,this.documentState=u}static newInvalidDocument(e){return new At(e,0,Se.min(),Se.min(),Se.min(),_n.empty(),0)}static newFoundDocument(e,n,r,i){return new At(e,1,n,Se.min(),r,i,0)}static newNoDocument(e,n){return new At(e,2,n,Se.min(),Se.min(),_n.empty(),0)}static newUnknownDocument(e,n){return new At(e,3,n,Se.min(),Se.min(),_n.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Se.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=_n.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=_n.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Se.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof At&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new At(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $l{constructor(e,n){this.position=e,this.inclusive=n}}function bw(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const o=e[i],a=t.position[i];if(o.field.isKeyField()?r=ue.comparator(ue.fromName(a.referenceValue),n.key):r=co(a,n.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function kw(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!mi(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wu{constructor(e,n="asc"){this.field=e,this.dir=n}}function oD(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jE{}class Ge extends jE{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new aD(e,n,r):n==="array-contains"?new uD(e,r):n==="in"?new FE(e,r):n==="not-in"?new dD(e,r):n==="array-contains-any"?new hD(e,r):new Ge(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new lD(e,r):new cD(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(co(n,this.value)):n!==null&&ga(this.value)===ga(n)&&this.matchesComparison(co(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return be()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class rt extends jE{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new rt(e,n)}matches(e){return Hl(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Hl(t){return t.op==="and"}function ny(t){return t.op==="or"}function z0(t){return LE(t)&&Hl(t)}function LE(t){for(const e of t.filters)if(e instanceof rt)return!1;return!0}function ry(t){if(t instanceof Ge)return t.field.canonicalString()+t.op.toString()+ql(t.value);if(z0(t))return t.filters.map(e=>ry(e)).join(",");{const e=t.filters.map(n=>ry(n)).join(",");return`${t.op}(${e})`}}function DE(t,e){return t instanceof Ge?function(r,i){return i instanceof Ge&&r.op===i.op&&r.field.isEqual(i.field)&&mi(r.value,i.value)}(t,e):t instanceof rt?function(r,i){return i instanceof rt&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,a,u)=>o&&DE(a,i.filters[u]),!0):!1}(t,e):void be()}function ME(t,e){const n=t.filters.concat(e);return rt.create(n,t.op)}function OE(t){return t instanceof Ge?function(n){return`${n.field.canonicalString()} ${n.op} ${ql(n.value)}`}(t):t instanceof rt?function(n){return n.op.toString()+" {"+n.getFilters().map(OE).join(" ,")+"}"}(t):"Filter"}class aD extends Ge{constructor(e,n,r){super(e,n,r),this.key=ue.fromName(r.referenceValue)}matches(e){const n=ue.comparator(e.key,this.key);return this.matchesComparison(n)}}class lD extends Ge{constructor(e,n){super(e,"in",n),this.keys=VE("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class cD extends Ge{constructor(e,n){super(e,"not-in",n),this.keys=VE("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function VE(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>ue.fromName(r.referenceValue))}class uD extends Ge{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Hu(n)&&qu(n.arrayValue,this.value)}}class FE extends Ge{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&qu(this.value.arrayValue,n)}}class dD extends Ge{constructor(e,n){super(e,"not-in",n)}matches(e){if(qu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!qu(this.value.arrayValue,n)}}class hD extends Ge{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Hu(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>qu(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fD{constructor(e,n=null,r=[],i=[],o=null,a=null,u=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=a,this.endAt=u,this.ue=null}}function iy(t,e=null,n=[],r=[],i=null,o=null,a=null){return new fD(t,e,n,r,i,o,a)}function ya(t){const e=Ie(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>ry(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),fm(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>ql(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>ql(r)).join(",")),e.ue=n}return e.ue}function ld(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!oD(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!DE(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!kw(t.startAt,e.startAt)&&kw(t.endAt,e.endAt)}function Ef(t){return ue.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Sf(t,e){return t.filters.filter(n=>n instanceof Ge&&n.field.isEqual(e))}function Iw(t,e,n){let r=Oh,i=!0;for(const o of Sf(t,e)){let a=Oh,u=!0;switch(o.op){case"<":case"<=":a=iD(o.value);break;case"==":case"in":case">=":a=o.value;break;case">":a=o.value,u=!1;break;case"!=":case"not-in":a=Oh}xw({value:r,inclusive:i},{value:a,inclusive:u})<0&&(r=a,i=u)}if(n!==null){for(let o=0;o<t.orderBy.length;++o)if(t.orderBy[o].field.isEqual(e)){const a=n.position[o];xw({value:r,inclusive:i},{value:a,inclusive:n.inclusive})<0&&(r=a,i=n.inclusive);break}}return{value:r,inclusive:i}}function Tw(t,e,n){let r=Gs,i=!0;for(const o of Sf(t,e)){let a=Gs,u=!0;switch(o.op){case">=":case">":a=sD(o.value),u=!1;break;case"==":case"in":case"<=":a=o.value;break;case"<":a=o.value,u=!1;break;case"!=":case"not-in":a=Gs}ww({value:r,inclusive:i},{value:a,inclusive:u})>0&&(r=a,i=u)}if(n!==null){for(let o=0;o<t.orderBy.length;++o)if(t.orderBy[o].field.isEqual(e)){const a=n.position[o];ww({value:r,inclusive:i},{value:a,inclusive:n.inclusive})>0&&(r=a,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lc{constructor(e,n=null,r=[],i=[],o=null,a="F",u=null,d=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=a,this.startAt=u,this.endAt=d,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function UE(t,e,n,r,i,o,a,u){return new lc(t,e,n,r,i,o,a,u)}function cd(t){return new lc(t)}function Ew(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function BE(t){return t.collectionGroup!==null}function fu(t){const e=Ie(t);if(e.ce===null){e.ce=[];const n=new Set;for(const o of e.explicitOrderBy)e.ce.push(o),n.add(o.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let u=new at(wt.comparator);return a.filters.forEach(d=>{d.getFlattenedFilters().forEach(m=>{m.isInequality()&&(u=u.add(m.field))})}),u})(e).forEach(o=>{n.has(o.canonicalString())||o.isKeyField()||e.ce.push(new Wu(o,r))}),n.has(wt.keyField().canonicalString())||e.ce.push(new Wu(wt.keyField(),r))}return e.ce}function cr(t){const e=Ie(t);return e.le||(e.le=mD(e,fu(t))),e.le}function mD(t,e){if(t.limitType==="F")return iy(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const o=i.dir==="desc"?"asc":"desc";return new Wu(i.field,o)});const n=t.endAt?new $l(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new $l(t.startAt.position,t.startAt.inclusive):null;return iy(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function sy(t,e){const n=t.filters.concat([e]);return new lc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Nf(t,e,n){return new lc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function pm(t,e){return ld(cr(t),cr(e))&&t.limitType===e.limitType}function zE(t){return`${ya(cr(t))}|lt:${t.limitType}`}function ol(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>OE(i)).join(", ")}]`),fm(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>ql(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>ql(i)).join(",")),`Target(${r})`}(cr(t))}; limitType=${t.limitType})`}function ud(t,e){return e.isFoundDocument()&&function(r,i){const o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):ue.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(t,e)&&function(r,i){for(const o of fu(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const o of r.filters)if(!o.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(a,u,d){const m=bw(a,u,d);return a.inclusive?m<=0:m<0}(r.startAt,fu(r),i)||r.endAt&&!function(a,u,d){const m=bw(a,u,d);return a.inclusive?m>=0:m>0}(r.endAt,fu(r),i))}(t,e)}function qE(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function $E(t){return(e,n)=>{let r=!1;for(const i of fu(t)){const o=pD(i,e,n);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function pD(t,e,n){const r=t.field.isKeyField()?ue.comparator(e.key,n.key):function(o,a,u){const d=a.data.field(o),m=u.data.field(o);return d!==null&&m!==null?co(d,m):be()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return be()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wo{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Ra(this.inner,(n,r)=>{for(const[i,o]of r)e(i,o)})}isEmpty(){return NE(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gD=new dt(ue.comparator);function or(){return gD}const HE=new dt(ue.comparator);function Yc(...t){let e=HE;for(const n of t)e=e.insert(n.key,n);return e}function WE(t){let e=HE;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function li(){return mu()}function GE(){return mu()}function mu(){return new wo(t=>t.toString(),(t,e)=>t.isEqual(e))}const yD=new dt(ue.comparator),_D=new at(ue.comparator);function Oe(...t){let e=_D;for(const n of t)e=e.add(n);return e}const vD=new at(De);function q0(){return vD}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $0(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Bu(e)?"-0":e}}function KE(t){return{integerValue:""+t}}function xD(t,e){return kE(e)?KE(e):$0(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gm{constructor(){this._=void 0}}function wD(t,e,n){return t instanceof Wl?function(i,o){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&U0(o)&&(o=B0(o)),o&&(a.fields.__previous_value__=o),{mapValue:a}}(n,e):t instanceof _a?QE(t,e):t instanceof va?YE(t,e):function(i,o){const a=ZE(i,o),u=Sw(a)+Sw(i.Pe);return ty(a)&&ty(i.Pe)?KE(u):$0(i.serializer,u)}(t,e)}function bD(t,e,n){return t instanceof _a?QE(t,e):t instanceof va?YE(t,e):n}function ZE(t,e){return t instanceof Gu?function(r){return ty(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}class Wl extends gm{}class _a extends gm{constructor(e){super(),this.elements=e}}function QE(t,e){const n=JE(e);for(const r of t.elements)n.some(i=>mi(i,r))||n.push(r);return{arrayValue:{values:n}}}class va extends gm{constructor(e){super(),this.elements=e}}function YE(t,e){let n=JE(e);for(const r of t.elements)n=n.filter(i=>!mi(i,r));return{arrayValue:{values:n}}}class Gu extends gm{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function Sw(t){return vt(t.integerValue||t.doubleValue)}function JE(t){return Hu(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ym{constructor(e,n){this.field=e,this.transform=n}}function kD(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof _a&&i instanceof _a||r instanceof va&&i instanceof va?zl(r.elements,i.elements,mi):r instanceof Gu&&i instanceof Gu?mi(r.Pe,i.Pe):r instanceof Wl&&i instanceof Wl}(t.transform,e.transform)}class ID{constructor(e,n){this.version=e,this.transformResults=n}}class vn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new vn}static exists(e){return new vn(void 0,e)}static updateTime(e){return new vn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Fh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class _m{}function XE(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new vm(t.key,vn.none()):new cc(t.key,t.data,vn.none());{const n=t.data,r=_n.empty();let i=new at(wt.comparator);for(let o of e.fields)if(!i.has(o)){let a=n.field(o);a===null&&o.length>1&&(o=o.popLast(),a=n.field(o)),a===null?r.delete(o):r.set(o,a),i=i.add(o)}return new as(t.key,r,new Qn(i.toArray()),vn.none())}}function TD(t,e,n){t instanceof cc?function(i,o,a){const u=i.value.clone(),d=Pw(i.fieldTransforms,o,a.transformResults);u.setAll(d),o.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(t,e,n):t instanceof as?function(i,o,a){if(!Fh(i.precondition,o))return void o.convertToUnknownDocument(a.version);const u=Pw(i.fieldTransforms,o,a.transformResults),d=o.data;d.setAll(eS(i)),d.setAll(u),o.convertToFoundDocument(a.version,d).setHasCommittedMutations()}(t,e,n):function(i,o,a){o.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function pu(t,e,n,r){return t instanceof cc?function(o,a,u,d){if(!Fh(o.precondition,a))return u;const m=o.value.clone(),g=Cw(o.fieldTransforms,d,a);return m.setAll(g),a.convertToFoundDocument(a.version,m).setHasLocalMutations(),null}(t,e,n,r):t instanceof as?function(o,a,u,d){if(!Fh(o.precondition,a))return u;const m=Cw(o.fieldTransforms,d,a),g=a.data;return g.setAll(eS(o)),g.setAll(m),a.convertToFoundDocument(a.version,g).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(v=>v.field))}(t,e,n,r):function(o,a,u){return Fh(o.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):u}(t,e,n)}function ED(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),o=ZE(r.transform,i||null);o!=null&&(n===null&&(n=_n.empty()),n.set(r.field,o))}return n||null}function Nw(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&zl(r,i,(o,a)=>kD(o,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class cc extends _m{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class as extends _m{constructor(e,n,r,i,o=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function eS(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Pw(t,e,n){const r=new Map;Ee(t.length===n.length);for(let i=0;i<n.length;i++){const o=t[i],a=o.transform,u=e.data.field(o.field);r.set(o.field,bD(a,u,n[i]))}return r}function Cw(t,e,n){const r=new Map;for(const i of t){const o=i.transform,a=n.data.field(i.field);r.set(i.field,wD(o,a,e))}return r}class vm extends _m{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class tS extends _m{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H0{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&TD(o,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=pu(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=pu(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=GE();return this.mutations.forEach(i=>{const o=e.get(i.key),a=o.overlayedDocument;let u=this.applyToLocalView(a,o.mutatedFields);u=n.has(i.key)?null:u;const d=XE(a,u);d!==null&&r.set(i.key,d),a.isValidDocument()||a.convertToNoDocument(Se.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Oe())}isEqual(e){return this.batchId===e.batchId&&zl(this.mutations,e.mutations,(n,r)=>Nw(n,r))&&zl(this.baseMutations,e.baseMutations,(n,r)=>Nw(n,r))}}class W0{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){Ee(e.mutations.length===r.length);let i=function(){return yD}();const o=e.mutations;for(let a=0;a<o.length;a++)i=i.insert(o[a].key,r[a].version);return new W0(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G0{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SD{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var zt,Qe;function ND(t){switch(t){default:return be();case X.CANCELLED:case X.UNKNOWN:case X.DEADLINE_EXCEEDED:case X.RESOURCE_EXHAUSTED:case X.INTERNAL:case X.UNAVAILABLE:case X.UNAUTHENTICATED:return!1;case X.INVALID_ARGUMENT:case X.NOT_FOUND:case X.ALREADY_EXISTS:case X.PERMISSION_DENIED:case X.FAILED_PRECONDITION:case X.ABORTED:case X.OUT_OF_RANGE:case X.UNIMPLEMENTED:case X.DATA_LOSS:return!0}}function nS(t){if(t===void 0)return Vt("GRPC error has no .code"),X.UNKNOWN;switch(t){case zt.OK:return X.OK;case zt.CANCELLED:return X.CANCELLED;case zt.UNKNOWN:return X.UNKNOWN;case zt.DEADLINE_EXCEEDED:return X.DEADLINE_EXCEEDED;case zt.RESOURCE_EXHAUSTED:return X.RESOURCE_EXHAUSTED;case zt.INTERNAL:return X.INTERNAL;case zt.UNAVAILABLE:return X.UNAVAILABLE;case zt.UNAUTHENTICATED:return X.UNAUTHENTICATED;case zt.INVALID_ARGUMENT:return X.INVALID_ARGUMENT;case zt.NOT_FOUND:return X.NOT_FOUND;case zt.ALREADY_EXISTS:return X.ALREADY_EXISTS;case zt.PERMISSION_DENIED:return X.PERMISSION_DENIED;case zt.FAILED_PRECONDITION:return X.FAILED_PRECONDITION;case zt.ABORTED:return X.ABORTED;case zt.OUT_OF_RANGE:return X.OUT_OF_RANGE;case zt.UNIMPLEMENTED:return X.UNIMPLEMENTED;case zt.DATA_LOSS:return X.DATA_LOSS;default:return be()}}(Qe=zt||(zt={}))[Qe.OK=0]="OK",Qe[Qe.CANCELLED=1]="CANCELLED",Qe[Qe.UNKNOWN=2]="UNKNOWN",Qe[Qe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Qe[Qe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Qe[Qe.NOT_FOUND=5]="NOT_FOUND",Qe[Qe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Qe[Qe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Qe[Qe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Qe[Qe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Qe[Qe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Qe[Qe.ABORTED=10]="ABORTED",Qe[Qe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Qe[Qe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Qe[Qe.INTERNAL=13]="INTERNAL",Qe[Qe.UNAVAILABLE=14]="UNAVAILABLE",Qe[Qe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PD(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CD=new ia([4294967295,4294967295],0);function Aw(t){const e=PD().encode(t),n=new uE;return n.update(e),new Uint8Array(n.digest())}function Rw(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new ia([n,r],0),new ia([i,o],0)]}class K0{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Jc(`Invalid padding: ${n}`);if(r<0)throw new Jc(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Jc(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Jc(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=ia.fromNumber(this.Ie)}Ee(e,n,r){let i=e.add(n.multiply(ia.fromNumber(r)));return i.compare(CD)===1&&(i=new ia([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=Aw(e),[r,i]=Rw(n);for(let o=0;o<this.hashCount;o++){const a=this.Ee(r,i,o);if(!this.de(a))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),a=new K0(o,i,n);return r.forEach(u=>a.insert(u)),a}insert(e){if(this.Ie===0)return;const n=Aw(e),[r,i]=Rw(n);for(let o=0;o<this.hashCount;o++){const a=this.Ee(r,i,o);this.Ae(a)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Jc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dd{constructor(e,n,r,i,o){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,hd.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new dd(Se.min(),i,new dt(De),or(),Oe())}}class hd{constructor(e,n,r,i,o){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new hd(r,n,Oe(),Oe(),Oe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}}class rS{constructor(e,n){this.targetId=e,this.me=n}}class iS{constructor(e,n,r=Rt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class jw{constructor(){this.fe=0,this.ge=Dw(),this.pe=Rt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Oe(),n=Oe(),r=Oe();return this.ge.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:be()}}),new hd(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=Dw()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Ee(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class AD{constructor(e){this.Le=e,this.Be=new Map,this.ke=or(),this.qe=Lw(),this.Qe=new dt(De)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:be()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.ze(i)&&n(i)})}He(e){const n=e.targetId,r=e.me.count,i=this.Je(n);if(i){const o=i.target;if(Ef(o))if(r===0){const a=new ue(o.path);this.Ue(n,a,At.newNoDocument(a,Se.min()))}else Ee(r===1);else{const a=this.Ye(n);if(a!==r){const u=this.Ze(e),d=u?this.Xe(u,e,a):1;if(d!==0){this.je(n);const m=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,m)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=n;let a,u;try{a=ao(r).toUint8Array()}catch(d){if(d instanceof PE)return Bl("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{u=new K0(a,i,o)}catch(d){return Bl(d instanceof Jc?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return u.Ie===0?null:u}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(o=>{const a=this.Le.tt(),u=`projects/${a.projectId}/databases/${a.database}/documents/${o.path.canonicalString()}`;e.mightContain(u)||(this.Ue(n,o,null),i++)}),i}rt(e){const n=new Map;this.Be.forEach((o,a)=>{const u=this.Je(a);if(u){if(o.current&&Ef(u.target)){const d=new ue(u.target.path);this.ke.get(d)!==null||this.it(a,d)||this.Ue(a,d,At.newNoDocument(d,e))}o.be&&(n.set(a,o.ve()),o.Ce())}});let r=Oe();this.qe.forEach((o,a)=>{let u=!0;a.forEachWhile(d=>{const m=this.Je(d);return!m||m.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(o))}),this.ke.forEach((o,a)=>a.setReadTime(e));const i=new dd(e,n,this.Qe,this.ke,r);return this.ke=or(),this.qe=Lw(),this.Qe=new dt(De),i}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,n)?i.Fe(n,1):i.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new jw,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new at(De),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||re("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new jw),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Lw(){return new dt(ue.comparator)}function Dw(){return new dt(ue.comparator)}const RD={asc:"ASCENDING",desc:"DESCENDING"},jD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},LD={and:"AND",or:"OR"};class DD{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function oy(t,e){return t.useProto3Json||fm(e)?e:{value:e}}function Gl(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function sS(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function MD(t,e){return Gl(t,e.toTimestamp())}function Dn(t){return Ee(!!t),Se.fromTimestamp(function(n){const r=ts(n);return new Be(r.seconds,r.nanos)}(t))}function Z0(t,e){return ay(t,e).canonicalString()}function ay(t,e){const n=function(i){return new et(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function oS(t){const e=et.fromString(t);return Ee(pS(e)),e}function Pf(t,e){return Z0(t.databaseId,e.path)}function sa(t,e){const n=oS(e);if(n.get(1)!==t.databaseId.projectId)throw new ae(X.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ae(X.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ue(cS(n))}function aS(t,e){return Z0(t.databaseId,e)}function lS(t){const e=oS(t);return e.length===4?et.emptyPath():cS(e)}function ly(t){return new et(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function cS(t){return Ee(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Mw(t,e,n){return{name:Pf(t,e),fields:n.value.mapValue.fields}}function OD(t,e,n){const r=sa(t,e.name),i=Dn(e.updateTime),o=e.createTime?Dn(e.createTime):Se.min(),a=new _n({mapValue:{fields:e.fields}}),u=At.newFoundDocument(r,i,o,a);return n&&u.setHasCommittedMutations(),n?u.setHasCommittedMutations():u}function VD(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:be()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(m,g){return m.useProto3Json?(Ee(g===void 0||typeof g=="string"),Rt.fromBase64String(g||"")):(Ee(g===void 0||g instanceof Buffer||g instanceof Uint8Array),Rt.fromUint8Array(g||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,u=a&&function(m){const g=m.code===void 0?X.UNKNOWN:nS(m.code);return new ae(g,m.message||"")}(a);n=new iS(r,i,o,u||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=sa(t,r.document.name),o=Dn(r.document.updateTime),a=r.document.createTime?Dn(r.document.createTime):Se.min(),u=new _n({mapValue:{fields:r.document.fields}}),d=At.newFoundDocument(i,o,a,u),m=r.targetIds||[],g=r.removedTargetIds||[];n=new Uh(m,g,d.key,d)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=sa(t,r.document),o=r.readTime?Dn(r.readTime):Se.min(),a=At.newNoDocument(i,o),u=r.removedTargetIds||[];n=new Uh([],u,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=sa(t,r.document),o=r.removedTargetIds||[];n=new Uh([],o,i,null)}else{if(!("filter"in e))return be();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:o}=r,a=new SD(i,o),u=r.targetId;n=new rS(u,a)}}return n}function Cf(t,e){let n;if(e instanceof cc)n={update:Mw(t,e.key,e.value)};else if(e instanceof vm)n={delete:Pf(t,e.key)};else if(e instanceof as)n={update:Mw(t,e.key,e.data),updateMask:$D(e.fieldMask)};else{if(!(e instanceof tS))return be();n={verify:Pf(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(o,a){const u=a.transform;if(u instanceof Wl)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof _a)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof va)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Gu)return{fieldPath:a.field.canonicalString(),increment:u.Pe};throw be()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:MD(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:be()}(t,e.precondition)),n}function cy(t,e){const n=e.currentDocument?function(o){return o.updateTime!==void 0?vn.updateTime(Dn(o.updateTime)):o.exists!==void 0?vn.exists(o.exists):vn.none()}(e.currentDocument):vn.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(a,u){let d=null;if("setToServerValue"in u)Ee(u.setToServerValue==="REQUEST_TIME"),d=new Wl;else if("appendMissingElements"in u){const g=u.appendMissingElements.values||[];d=new _a(g)}else if("removeAllFromArray"in u){const g=u.removeAllFromArray.values||[];d=new va(g)}else"increment"in u?d=new Gu(a,u.increment):be();const m=wt.fromServerFormat(u.fieldPath);return new ym(m,d)}(t,i)):[];if(e.update){e.update.name;const i=sa(t,e.update.name),o=new _n({mapValue:{fields:e.update.fields}});if(e.updateMask){const a=function(d){const m=d.fieldPaths||[];return new Qn(m.map(g=>wt.fromServerFormat(g)))}(e.updateMask);return new as(i,o,a,n,r)}return new cc(i,o,n,r)}if(e.delete){const i=sa(t,e.delete);return new vm(i,n)}if(e.verify){const i=sa(t,e.verify);return new tS(i,n)}return be()}function FD(t,e){return t&&t.length>0?(Ee(e!==void 0),t.map(n=>function(i,o){let a=i.updateTime?Dn(i.updateTime):Dn(o);return a.isEqual(Se.min())&&(a=Dn(o)),new ID(a,i.transformResults||[])}(n,e))):[]}function uS(t,e){return{documents:[aS(t,e.path)]}}function dS(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=aS(t,i);const o=function(m){if(m.length!==0)return mS(rt.create(m,"and"))}(e.filters);o&&(n.structuredQuery.where=o);const a=function(m){if(m.length!==0)return m.map(g=>function(w){return{field:al(w.field),direction:BD(w.dir)}}(g))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);const u=oy(t,e.limit);return u!==null&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=function(m){return{before:m.inclusive,values:m.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(m){return{before:!m.inclusive,values:m.position}}(e.endAt)),{_t:n,parent:i}}function hS(t){let e=lS(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Ee(r===1);const g=n.from[0];g.allDescendants?i=g.collectionId:e=e.child(g.collectionId)}let o=[];n.where&&(o=function(v){const w=fS(v);return w instanceof rt&&z0(w)?w.getFilters():[w]}(n.where));let a=[];n.orderBy&&(a=function(v){return v.map(w=>function(C){return new Wu(ll(C.field),function(F){switch(F){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(C.direction))}(w))}(n.orderBy));let u=null;n.limit&&(u=function(v){let w;return w=typeof v=="object"?v.value:v,fm(w)?null:w}(n.limit));let d=null;n.startAt&&(d=function(v){const w=!!v.before,E=v.values||[];return new $l(E,w)}(n.startAt));let m=null;return n.endAt&&(m=function(v){const w=!v.before,E=v.values||[];return new $l(E,w)}(n.endAt)),UE(e,i,a,o,u,"F",d,m)}function UD(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return be()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function fS(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=ll(n.unaryFilter.field);return Ge.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=ll(n.unaryFilter.field);return Ge.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=ll(n.unaryFilter.field);return Ge.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=ll(n.unaryFilter.field);return Ge.create(a,"!=",{nullValue:"NULL_VALUE"});default:return be()}}(t):t.fieldFilter!==void 0?function(n){return Ge.create(ll(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return be()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return rt.create(n.compositeFilter.filters.map(r=>fS(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return be()}}(n.compositeFilter.op))}(t):be()}function BD(t){return RD[t]}function zD(t){return jD[t]}function qD(t){return LD[t]}function al(t){return{fieldPath:t.canonicalString()}}function ll(t){return wt.fromServerFormat(t.fieldPath)}function mS(t){return t instanceof Ge?function(n){if(n.op==="=="){if(vw(n.value))return{unaryFilter:{field:al(n.field),op:"IS_NAN"}};if(_w(n.value))return{unaryFilter:{field:al(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(vw(n.value))return{unaryFilter:{field:al(n.field),op:"IS_NOT_NAN"}};if(_w(n.value))return{unaryFilter:{field:al(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:al(n.field),op:zD(n.op),value:n.value}}}(t):t instanceof rt?function(n){const r=n.getFilters().map(i=>mS(i));return r.length===1?r[0]:{compositeFilter:{op:qD(n.op),filters:r}}}(t):be()}function $D(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function pS(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zi{constructor(e,n,r,i,o=Se.min(),a=Se.min(),u=Rt.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=u,this.expectedCount=d}withSequenceNumber(e){return new zi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new zi(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new zi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new zi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gS{constructor(e){this.ct=e}}function HD(t,e){let n;if(e.document)n=OD(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ue.fromSegments(e.noDocument.path),i=wa(e.noDocument.readTime);n=At.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return be();{const r=ue.fromSegments(e.unknownDocument.path),i=wa(e.unknownDocument.version);n=At.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const o=new Be(i[0],i[1]);return Se.fromTimestamp(o)}(e.readTime)),n}function Ow(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Af(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(o,a){return{name:Pf(o,a.key),fields:a.data.value.mapValue.fields,updateTime:Gl(o,a.version.toTimestamp()),createTime:Gl(o,a.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:xa(e.version)};else{if(!e.isUnknownDocument())return be();r.unknownDocument={path:n.path.toArray(),version:xa(e.version)}}return r}function Af(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function xa(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function wa(t){const e=new Be(t.seconds,t.nanoseconds);return Se.fromTimestamp(e)}function Go(t,e){const n=(e.baseMutations||[]).map(o=>cy(t.ct,o));for(let o=0;o<e.mutations.length-1;++o){const a=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){const u=e.mutations[o+1];a.updateTransforms=u.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}const r=e.mutations.map(o=>cy(t.ct,o)),i=Be.fromMillis(e.localWriteTimeMs);return new H0(e.batchId,i,n,r)}function Xc(t){const e=wa(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?wa(t.lastLimboFreeSnapshotVersion):Se.min();let r;return r=function(o){return o.documents!==void 0}(t.query)?function(o){return Ee(o.documents.length===1),cr(cd(lS(o.documents[0])))}(t.query):function(o){return cr(hS(o))}(t.query),new zi(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Rt.fromBase64String(t.resumeToken))}function yS(t,e){const n=xa(e.snapshotVersion),r=xa(e.lastLimboFreeSnapshotVersion);let i;i=Ef(e.target)?uS(t.ct,e.target):dS(t.ct,e.target)._t;const o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ya(e.target),readTime:n,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function _S(t){const e=hS({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Nf(e,e.limit,"L"):e}function Dp(t,e){return new G0(e.largestBatchId,cy(t.ct,e.overlayMutation))}function Vw(t,e){const n=e.path.lastSegment();return[t,Ln(e.path.popLast()),n]}function Fw(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:xa(r.readTime),documentKey:Ln(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WD{getBundleMetadata(e,n){return Uw(e).get(n).next(r=>{if(r)return function(o){return{id:o.bundleId,createTime:wa(o.createTime),version:o.version}}(r)})}saveBundleMetadata(e,n){return Uw(e).put(function(i){return{bundleId:i.id,createTime:xa(Dn(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return Bw(e).get(n).next(r=>{if(r)return function(o){return{name:o.name,query:_S(o.bundledQuery),readTime:wa(o.readTime)}}(r)})}saveNamedQuery(e,n){return Bw(e).put(function(i){return{name:i.name,readTime:xa(Dn(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function Uw(t){return Zt(t,"bundles")}function Bw(t){return Zt(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xm{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){const r=n.uid||"";return new xm(e,r)}getOverlay(e,n){return Mc(e).get(Vw(this.userId,n)).next(r=>r?Dp(this.serializer,r):null)}getOverlays(e,n){const r=li();return W.forEach(n,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((o,a)=>{const u=new G0(n,a);i.push(this.ht(e,u))}),W.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(a=>i.add(Ln(a.getCollectionPath())));const o=[];return i.forEach(a=>{const u=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,r+1],!1,!0);o.push(Mc(e).j("collectionPathOverlayIndex",u))}),W.waitFor(o)}getOverlaysForCollection(e,n,r){const i=li(),o=Ln(n),a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,Number.POSITIVE_INFINITY],!0);return Mc(e).U("collectionPathOverlayIndex",a).next(u=>{for(const d of u){const m=Dp(this.serializer,d);i.set(m.getKey(),m)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const o=li();let a;const u=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Mc(e).J({index:"collectionGroupOverlayIndex",range:u},(d,m,g)=>{const v=Dp(this.serializer,m);o.size()<i||v.largestBatchId===a?(o.set(v.getKey(),v),a=v.largestBatchId):g.done()}).next(()=>o)}ht(e,n){return Mc(e).put(function(i,o,a){const[u,d,m]=Vw(o,a.mutation.key);return{userId:o,collectionPath:d,documentId:m,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:Cf(i.ct,a.mutation)}}(this.serializer,this.userId,n))}}function Mc(t){return Zt(t,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GD{Pt(e){return Zt(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?Rt.fromUint8Array(r):Rt.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.Pt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ko{constructor(){}It(e,n){this.Tt(e,n),n.Et()}Tt(e,n){if("nullValue"in e)this.dt(n,5);else if("booleanValue"in e)this.dt(n,10),n.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(n,15),n.At(vt(e.integerValue));else if("doubleValue"in e){const r=vt(e.doubleValue);isNaN(r)?this.dt(n,13):(this.dt(n,15),Bu(r)?n.At(0):n.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(n,20),typeof r=="string"&&(r=ts(r)),n.Rt(`${r.seconds||""}`),n.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,n),this.ft(n);else if("bytesValue"in e)this.dt(n,30),n.gt(ao(e.bytesValue)),this.ft(n);else if("referenceValue"in e)this.yt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(n,45),n.At(r.latitude||0),n.At(r.longitude||0)}else"mapValue"in e?CE(e)?this.dt(n,Number.MAX_SAFE_INTEGER):mm(e)?this.wt(e.mapValue,n):(this.St(e.mapValue,n),this.ft(n)):"arrayValue"in e?(this.bt(e.arrayValue,n),this.ft(n)):be()}Vt(e,n){this.dt(n,25),this.Dt(e,n)}Dt(e,n){n.Rt(e)}St(e,n){const r=e.fields||{};this.dt(n,55);for(const i of Object.keys(r))this.Vt(i,n),this.Tt(r[i],n)}wt(e,n){var r,i;const o=e.fields||{};this.dt(n,53);const a="value",u=((i=(r=o[a].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(n,15),n.At(vt(u)),this.Vt(a,n),this.Tt(o[a],n)}bt(e,n){const r=e.values||[];this.dt(n,50);for(const i of r)this.Tt(i,n)}yt(e,n){this.dt(n,37),ue.fromName(e).path.forEach(r=>{this.dt(n,60),this.Dt(r,n)})}dt(e,n){e.At(n)}ft(e){e.At(2)}}Ko.vt=new Ko;function KD(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function zw(t){const e=64-function(r){let i=0;for(let o=0;o<8;++o){const a=KD(255&r[o]);if(i+=a,a!==8)break}return i}(t);return Math.ceil(e/8)}class ZD{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ft(r.value),r=n.next();this.Mt()}xt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ot(r.value),r=n.next();this.Nt()}Lt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=n.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const i=n.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){const n=this.qt(e),r=zw(n);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}Kt(e){const n=this.qt(e),r=zw(n);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const n=function(o){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,o,!1),new Uint8Array(a.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Ft(e){const n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(n)}Ot(e){const n=255&e;n===0?(this.Gt(0),this.Gt(255)):n===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class QD{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class YD{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class Oc{constructor(){this.jt=new ZD,this.Ht=new QD(this.jt),this.Jt=new YD(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zo{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Zt(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Zo(this.indexId,this.documentKey,this.arrayValue,r)}}function As(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=qw(t.arrayValue,e.arrayValue),n!==0?n:(n=qw(t.directionalValue,e.directionalValue),n!==0?n:ue.comparator(t.documentKey,e.documentKey)))}function qw(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $w{constructor(e){this.Xt=new at((n,r)=>wt.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const n of e.filters){const r=n;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(Ee(e.collectionGroup===this.collectionId),this.nn)return!1;const n=Jg(e);if(n!==void 0&&!this.sn(n))return!1;const r=$o(e);let i=new Set,o=0,a=0;for(;o<r.length&&this.sn(r[o]);++o)i=i.add(r[o].fieldPath.canonicalString());if(o===r.length)return!0;if(this.Xt.size>0){const u=this.Xt.getIterator().getNext();if(!i.has(u.field.canonicalString())){const d=r[o];if(!this.on(u,d)||!this._n(this.en[a++],d))return!1}++o}for(;o<r.length;++o){const u=r[o];if(a>=this.en.length||!this._n(this.en[a++],u))return!1}return!0}an(){if(this.nn)return null;let e=new at(wt.comparator);const n=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Dh(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Dh(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Dh(r.field,r.dir==="asc"?0:1)));return new Tf(Tf.UNKNOWN_ID,this.collectionId,n,Uu.empty())}sn(e){for(const n of this.tn)if(this.on(n,e))return!0;return!1}on(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}_n(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vS(t){var e,n;if(Ee(t instanceof Ge||t instanceof rt),t instanceof Ge){if(t instanceof FE){const i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(o=>Ge.create(t.field,"==",o)))||[];return rt.create(i,"or")}return t}const r=t.filters.map(i=>vS(i));return rt.create(r,t.op)}function JD(t){if(t.getFilters().length===0)return[];const e=hy(vS(t));return Ee(xS(e)),uy(e)||dy(e)?[e]:e.getFilters()}function uy(t){return t instanceof Ge}function dy(t){return t instanceof rt&&z0(t)}function xS(t){return uy(t)||dy(t)||function(n){if(n instanceof rt&&ny(n)){for(const r of n.getFilters())if(!uy(r)&&!dy(r))return!1;return!0}return!1}(t)}function hy(t){if(Ee(t instanceof Ge||t instanceof rt),t instanceof Ge)return t;if(t.filters.length===1)return hy(t.filters[0]);const e=t.filters.map(r=>hy(r));let n=rt.create(e,t.op);return n=Rf(n),xS(n)?n:(Ee(n instanceof rt),Ee(Hl(n)),Ee(n.filters.length>1),n.filters.reduce((r,i)=>Q0(r,i)))}function Q0(t,e){let n;return Ee(t instanceof Ge||t instanceof rt),Ee(e instanceof Ge||e instanceof rt),n=t instanceof Ge?e instanceof Ge?function(i,o){return rt.create([i,o],"and")}(t,e):Hw(t,e):e instanceof Ge?Hw(e,t):function(i,o){if(Ee(i.filters.length>0&&o.filters.length>0),Hl(i)&&Hl(o))return ME(i,o.getFilters());const a=ny(i)?i:o,u=ny(i)?o:i,d=a.filters.map(m=>Q0(m,u));return rt.create(d,"or")}(t,e),Rf(n)}function Hw(t,e){if(Hl(e))return ME(e,t.getFilters());{const n=e.filters.map(r=>Q0(t,r));return rt.create(n,"or")}}function Rf(t){if(Ee(t instanceof Ge||t instanceof rt),t instanceof Ge)return t;const e=t.getFilters();if(e.length===1)return Rf(e[0]);if(LE(t))return t;const n=e.map(i=>Rf(i)),r=[];return n.forEach(i=>{i instanceof Ge?r.push(i):i instanceof rt&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:rt.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XD{constructor(){this.un=new Y0}addToCollectionParentIndex(e,n){return this.un.add(n),W.resolve()}getCollectionParents(e,n){return W.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return W.resolve()}deleteFieldIndex(e,n){return W.resolve()}deleteAllFieldIndexes(e){return W.resolve()}createTargetIndexes(e,n){return W.resolve()}getDocumentsMatchingTarget(e,n){return W.resolve(null)}getIndexType(e,n){return W.resolve(0)}getFieldIndexes(e,n){return W.resolve([])}getNextCollectionGroupToUpdate(e){return W.resolve(null)}getMinOffset(e,n){return W.resolve(hr.min())}getMinOffsetFromCollectionGroup(e,n){return W.resolve(hr.min())}updateCollectionGroup(e,n,r){return W.resolve()}updateIndexEntries(e,n){return W.resolve()}}class Y0{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new at(et.comparator),o=!i.has(r);return this.index[n]=i.add(r),o}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new at(et.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ah=new Uint8Array(0);class eM{constructor(e,n){this.databaseId=n,this.cn=new Y0,this.ln=new wo(r=>ya(r),(r,i)=>ld(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.cn.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.cn.add(n)});const o={collectionId:r,parent:Ln(i)};return Ww(e).put(o)}return W.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[yE(n),""],!1,!0);return Ww(e).U(i).next(o=>{for(const a of o){if(a.collectionId!==n)break;r.push(ai(a.parent))}return r})}addFieldIndex(e,n){const r=Vc(e),i=function(u){return{indexId:u.indexId,collectionGroup:u.collectionGroup,fields:u.fields.map(d=>[d.fieldPath.canonicalString(),d.kind])}}(n);delete i.indexId;const o=r.add(i);if(n.indexState){const a=rl(e);return o.next(u=>{a.put(Fw(u,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return o.next()}deleteFieldIndex(e,n){const r=Vc(e),i=rl(e),o=nl(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>o.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=Vc(e),r=nl(e),i=rl(e);return n.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,n){return W.forEach(this.hn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const o=new $w(r).an();if(o!=null)return this.addFieldIndex(e,o)}}))}getDocumentsMatchingTarget(e,n){const r=nl(e);let i=!0;const o=new Map;return W.forEach(this.hn(n),a=>this.Pn(e,a).next(u=>{i&&(i=!!u),o.set(a,u)})).next(()=>{if(i){let a=Oe();const u=[];return W.forEach(o,(d,m)=>{re("IndexedDbIndexManager",`Using index ${function(A){return`id=${A.indexId}|cg=${A.collectionGroup}|f=${A.fields.map(z=>`${z.fieldPath}:${z.kind}`).join(",")}`}(d)} to execute ${ya(n)}`);const g=function(A,z){const Z=Jg(z);if(Z===void 0)return null;for(const H of Sf(A,Z.fieldPath))switch(H.op){case"array-contains-any":return H.value.arrayValue.values||[];case"array-contains":return[H.value]}return null}(m,d),v=function(A,z){const Z=new Map;for(const H of $o(z))for(const I of Sf(A,H.fieldPath))switch(I.op){case"==":case"in":Z.set(H.fieldPath.canonicalString(),I.value);break;case"not-in":case"!=":return Z.set(H.fieldPath.canonicalString(),I.value),Array.from(Z.values())}return null}(m,d),w=function(A,z){const Z=[];let H=!0;for(const I of $o(z)){const b=I.kind===0?Iw(A,I.fieldPath,A.startAt):Tw(A,I.fieldPath,A.startAt);Z.push(b.value),H&&(H=b.inclusive)}return new $l(Z,H)}(m,d),E=function(A,z){const Z=[];let H=!0;for(const I of $o(z)){const b=I.kind===0?Tw(A,I.fieldPath,A.endAt):Iw(A,I.fieldPath,A.endAt);Z.push(b.value),H&&(H=b.inclusive)}return new $l(Z,H)}(m,d),C=this.In(d,m,w),P=this.In(d,m,E),F=this.Tn(d,m,v),N=this.En(d.indexId,g,C,w.inclusive,P,E.inclusive,F);return W.forEach(N,T=>r.G(T,n.limit).next(A=>{A.forEach(z=>{const Z=ue.fromSegments(z.documentKey);a.has(Z)||(a=a.add(Z),u.push(Z))})}))}).next(()=>u)}return W.resolve(null)})}hn(e){let n=this.ln.get(e);return n||(e.filters.length===0?n=[e]:n=JD(rt.create(e.filters,"and")).map(r=>iy(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,n),n)}En(e,n,r,i,o,a,u){const d=(n!=null?n.length:1)*Math.max(r.length,o.length),m=d/(n!=null?n.length:1),g=[];for(let v=0;v<d;++v){const w=n?this.dn(n[v/m]):ah,E=this.An(e,w,r[v%m],i),C=this.Rn(e,w,o[v%m],a),P=u.map(F=>this.An(e,w,F,!0));g.push(...this.createRange(E,C,P))}return g}An(e,n,r,i){const o=new Zo(e,ue.empty(),n,r);return i?o:o.Zt()}Rn(e,n,r,i){const o=new Zo(e,ue.empty(),n,r);return i?o.Zt():o}Pn(e,n){const r=new $w(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(o=>{let a=null;for(const u of o)r.rn(u)&&(!a||u.fields.length>a.fields.length)&&(a=u);return a})}getIndexType(e,n){let r=2;const i=this.hn(n);return W.forEach(i,o=>this.Pn(e,o).next(a=>{a?r!==0&&a.fields.length<function(d){let m=new at(wt.comparator),g=!1;for(const v of d.filters)for(const w of v.getFlattenedFilters())w.field.isKeyField()||(w.op==="array-contains"||w.op==="array-contains-any"?g=!0:m=m.add(w.field));for(const v of d.orderBy)v.field.isKeyField()||(m=m.add(v.field));return m.size+(g?1:0)}(o)&&(r=1):r=0})).next(()=>function(a){return a.limit!==null}(n)&&i.length>1&&r===2?1:r)}Vn(e,n){const r=new Oc;for(const i of $o(e)){const o=n.data.field(i.fieldPath);if(o==null)return null;const a=r.Yt(i.kind);Ko.vt.It(o,a)}return r.zt()}dn(e){const n=new Oc;return Ko.vt.It(e,n.Yt(0)),n.zt()}mn(e,n){const r=new Oc;return Ko.vt.It($u(this.databaseId,n),r.Yt(function(o){const a=$o(o);return a.length===0?0:a[a.length-1].kind}(e))),r.zt()}Tn(e,n,r){if(r===null)return[];let i=[];i.push(new Oc);let o=0;for(const a of $o(e)){const u=r[o++];for(const d of i)if(this.fn(n,a.fieldPath)&&Hu(u))i=this.gn(i,a,u);else{const m=d.Yt(a.kind);Ko.vt.It(u,m)}}return this.pn(i)}In(e,n,r){return this.Tn(e,n,r.position)}pn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].zt();return n}gn(e,n,r){const i=[...e],o=[];for(const a of r.arrayValue.values||[])for(const u of i){const d=new Oc;d.seed(u.zt()),Ko.vt.It(a,d.Yt(n.kind)),o.push(d)}return o}fn(e,n){return!!e.filters.find(r=>r instanceof Ge&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=Vc(e),i=rl(e);return(n?r.U("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.U()).next(o=>{const a=[];return W.forEach(o,u=>i.get([u.indexId,this.uid]).next(d=>{a.push(function(g,v){const w=v?new Uu(v.sequenceNumber,new hr(wa(v.readTime),new ue(ai(v.documentKey)),v.largestBatchId)):Uu.empty(),E=g.fields.map(([C,P])=>new Dh(wt.fromServerFormat(C),P));return new Tf(g.indexId,g.collectionGroup,E,w)}(u,d))})).next(()=>a)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const o=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return o!==0?o:De(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=Vc(e),o=rl(e);return this.yn(e).next(a=>i.U("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(u=>W.forEach(u,d=>o.put(Fw(d.indexId,this.uid,a,r)))))}updateIndexEntries(e,n){const r=new Map;return W.forEach(n,(i,o)=>{const a=r.get(i.collectionGroup);return(a?W.resolve(a):this.getFieldIndexes(e,i.collectionGroup)).next(u=>(r.set(i.collectionGroup,u),W.forEach(u,d=>this.wn(e,i,d).next(m=>{const g=this.Sn(o,d);return m.isEqual(g)?W.resolve():this.bn(e,o,d,m,g)}))))})}Dn(e,n,r,i){return nl(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(r,n.key),documentKey:n.key.path.toArray()})}vn(e,n,r,i){return nl(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(r,n.key),n.key.path.toArray()])}wn(e,n,r){const i=nl(e);let o=new at(As);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,n)])},(a,u)=>{o=o.add(new Zo(r.indexId,n,u.arrayValue,u.directionalValue))}).next(()=>o)}Sn(e,n){let r=new at(As);const i=this.Vn(n,e);if(i==null)return r;const o=Jg(n);if(o!=null){const a=e.data.field(o.fieldPath);if(Hu(a))for(const u of a.arrayValue.values||[])r=r.add(new Zo(n.indexId,e.key,this.dn(u),i))}else r=r.add(new Zo(n.indexId,e.key,ah,i));return r}bn(e,n,r,i,o){re("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const a=[];return function(d,m,g,v,w){const E=d.getIterator(),C=m.getIterator();let P=tl(E),F=tl(C);for(;P||F;){let N=!1,T=!1;if(P&&F){const A=g(P,F);A<0?T=!0:A>0&&(N=!0)}else P!=null?T=!0:N=!0;N?(v(F),F=tl(C)):T?(w(P),P=tl(E)):(P=tl(E),F=tl(C))}}(i,o,As,u=>{a.push(this.Dn(e,n,r,u))},u=>{a.push(this.vn(e,n,r,u))}),W.waitFor(a)}yn(e){let n=1;return rl(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,o)=>{o.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((a,u)=>As(a,u)).filter((a,u,d)=>!u||As(a,d[u-1])!==0);const i=[];i.push(e);for(const a of r){const u=As(a,e),d=As(a,n);if(u===0)i[0]=e.Zt();else if(u>0&&d<0)i.push(a),i.push(a.Zt());else if(d>0)break}i.push(n);const o=[];for(let a=0;a<i.length;a+=2){if(this.Cn(i[a],i[a+1]))return[];const u=[i[a].indexId,this.uid,i[a].arrayValue,i[a].directionalValue,ah,[]],d=[i[a+1].indexId,this.uid,i[a+1].arrayValue,i[a+1].directionalValue,ah,[]];o.push(IDBKeyRange.bound(u,d))}return o}Cn(e,n){return As(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(Gw)}getMinOffset(e,n){return W.mapArray(this.hn(n),r=>this.Pn(e,r).next(i=>i||be())).next(Gw)}}function Ww(t){return Zt(t,"collectionParents")}function nl(t){return Zt(t,"indexEntries")}function Vc(t){return Zt(t,"indexConfiguration")}function rl(t){return Zt(t,"indexState")}function Gw(t){Ee(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;O0(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new hr(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class $n{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new $n(e,$n.DEFAULT_COLLECTION_PERCENTILE,$n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wS(t,e,n){const r=t.store("mutations"),i=t.store("documentMutations"),o=[],a=IDBKeyRange.only(n.batchId);let u=0;const d=r.J({range:a},(g,v,w)=>(u++,w.delete()));o.push(d.next(()=>{Ee(u===1)}));const m=[];for(const g of n.mutations){const v=IE(e,g.key.path,n.batchId);o.push(i.delete(v)),m.push(g.key)}return W.waitFor(o).next(()=>m)}function jf(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw be();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */$n.DEFAULT_COLLECTION_PERCENTILE=10,$n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,$n.DEFAULT=new $n(41943040,$n.DEFAULT_COLLECTION_PERCENTILE,$n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),$n.DISABLED=new $n(-1,0,0);class wm{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Fn={}}static lt(e,n,r,i){Ee(e.uid!=="");const o=e.isAuthenticated()?e.uid:"";return new wm(o,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Rs(e).J({index:"userMutationsIndex",range:r},(i,o,a)=>{n=!1,a.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const o=cl(e),a=Rs(e);return a.add({}).next(u=>{Ee(typeof u=="number");const d=new H0(u,n,r,i),m=function(E,C,P){const F=P.baseMutations.map(T=>Cf(E.ct,T)),N=P.mutations.map(T=>Cf(E.ct,T));return{userId:C,batchId:P.batchId,localWriteTimeMs:P.localWriteTime.toMillis(),baseMutations:F,mutations:N}}(this.serializer,this.userId,d),g=[];let v=new at((w,E)=>De(w.canonicalString(),E.canonicalString()));for(const w of i){const E=IE(this.userId,w.key.path,u);v=v.add(w.key.path.popLast()),g.push(a.put(m)),g.push(o.put(E,VL))}return v.forEach(w=>{g.push(this.indexManager.addToCollectionParentIndex(e,w))}),e.addOnCommittedListener(()=>{this.Fn[u]=d.keys()}),W.waitFor(g).next(()=>d)})}lookupMutationBatch(e,n){return Rs(e).get(n).next(r=>r?(Ee(r.userId===this.userId),Go(this.serializer,r)):null)}Mn(e,n){return this.Fn[n]?W.resolve(this.Fn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Fn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let o=null;return Rs(e).J({index:"userMutationsIndex",range:i},(a,u,d)=>{u.userId===this.userId&&(Ee(u.batchId>=r),o=Go(this.serializer,u)),d.done()}).next(()=>o)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Rs(e).J({index:"userMutationsIndex",range:n,reverse:!0},(i,o,a)=>{r=o.batchId,a.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Rs(e).U("userMutationsIndex",n).next(r=>r.map(i=>Go(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Mh(this.userId,n.path),i=IDBKeyRange.lowerBound(r),o=[];return cl(e).J({range:i},(a,u,d)=>{const[m,g,v]=a,w=ai(g);if(m===this.userId&&n.path.isEqual(w))return Rs(e).get(v).next(E=>{if(!E)throw be();Ee(E.userId===this.userId),o.push(Go(this.serializer,E))});d.done()}).next(()=>o)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new at(De);const i=[];return n.forEach(o=>{const a=Mh(this.userId,o.path),u=IDBKeyRange.lowerBound(a),d=cl(e).J({range:u},(m,g,v)=>{const[w,E,C]=m,P=ai(E);w===this.userId&&o.path.isEqual(P)?r=r.add(C):v.done()});i.push(d)}),W.waitFor(i).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,o=Mh(this.userId,r),a=IDBKeyRange.lowerBound(o);let u=new at(De);return cl(e).J({range:a},(d,m,g)=>{const[v,w,E]=d,C=ai(w);v===this.userId&&r.isPrefixOf(C)?C.length===i&&(u=u.add(E)):g.done()}).next(()=>this.xn(e,u))}xn(e,n){const r=[],i=[];return n.forEach(o=>{i.push(Rs(e).get(o).next(a=>{if(a===null)throw be();Ee(a.userId===this.userId),r.push(Go(this.serializer,a))}))}),W.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return wS(e._e,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.On(n.batchId)}),W.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return W.resolve();const r=IDBKeyRange.lowerBound(function(a){return[a]}(this.userId)),i=[];return cl(e).J({range:r},(o,a,u)=>{if(o[0]===this.userId){const d=ai(o[1]);i.push(d)}else u.done()}).next(()=>{Ee(i.length===0)})})}containsKey(e,n){return bS(e,this.userId,n)}Nn(e){return kS(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function bS(t,e,n){const r=Mh(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r);let a=!1;return cl(t).J({range:o,H:!0},(u,d,m)=>{const[g,v,w]=u;g===e&&v===i&&(a=!0),m.done()}).next(()=>a)}function Rs(t){return Zt(t,"mutations")}function cl(t){return Zt(t,"documentMutations")}function kS(t){return Zt(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ba{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new ba(0)}static kn(){return new ba(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tM{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.qn(e).next(n=>{const r=new ba(n.highestTargetId);return n.highestTargetId=r.next(),this.Qn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(n=>Se.fromTimestamp(new Be(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.qn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.Qn(e,i)))}addTargetData(e,n){return this.Kn(e,n).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(n,r),this.Qn(e,r))))}updateTargetData(e,n){return this.Kn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>il(e).delete(n.targetId)).next(()=>this.qn(e)).next(r=>(Ee(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,n,r){let i=0;const o=[];return il(e).J((a,u)=>{const d=Xc(u);d.sequenceNumber<=n&&r.get(d.targetId)===null&&(i++,o.push(this.removeTargetData(e,d)))}).next(()=>W.waitFor(o)).next(()=>i)}forEachTarget(e,n){return il(e).J((r,i)=>{const o=Xc(i);n(o)})}qn(e){return Zw(e).get("targetGlobalKey").next(n=>(Ee(n!==null),n))}Qn(e,n){return Zw(e).put("targetGlobalKey",n)}Kn(e,n){return il(e).put(yS(this.serializer,n))}$n(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=ya(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let o=null;return il(e).J({range:i,index:"queryTargetsIndex"},(a,u,d)=>{const m=Xc(u);ld(n,m.target)&&(o=m,d.done())}).next(()=>o)}addMatchingKeys(e,n,r){const i=[],o=zs(e);return n.forEach(a=>{const u=Ln(a.path);i.push(o.put({targetId:r,path:u})),i.push(this.referenceDelegate.addReference(e,r,a))}),W.waitFor(i)}removeMatchingKeys(e,n,r){const i=zs(e);return W.forEach(n,o=>{const a=Ln(o.path);return W.waitFor([i.delete([r,a]),this.referenceDelegate.removeReference(e,r,o)])})}removeMatchingKeysForTargetId(e,n){const r=zs(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=zs(e);let o=Oe();return i.J({range:r,H:!0},(a,u,d)=>{const m=ai(a[1]),g=new ue(m);o=o.add(g)}).next(()=>o)}containsKey(e,n){const r=Ln(n.path),i=IDBKeyRange.bound([r],[yE(r)],!1,!0);let o=0;return zs(e).J({index:"documentTargetsIndex",H:!0,range:i},([a,u],d,m)=>{a!==0&&(o++,m.done())}).next(()=>o>0)}ot(e,n){return il(e).get(n).next(r=>r?Xc(r):null)}}function il(t){return Zt(t,"targets")}function Zw(t){return Zt(t,"targetGlobal")}function zs(t){return Zt(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qw([t,e],[n,r]){const i=De(t,n);return i===0?De(e,r):i}class nM{constructor(e){this.Un=e,this.buffer=new at(Qw),this.Wn=0}Gn(){return++this.Wn}zn(e){const n=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Qw(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class rM{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){re("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){xo(n)?re("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await vo(n)}await this.Hn(3e5)})}}class iM{constructor(e,n){this.Jn=e,this.params=n}calculateTargetCount(e,n){return this.Jn.Yn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return W.resolve(Zn.oe);const r=new nM(n);return this.Jn.forEachTarget(e,i=>r.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>r.zn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(re("LruGarbageCollector","Garbage collection skipped; disabled"),W.resolve(Kw)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(re("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Kw):this.Xn(e,n))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,n){let r,i,o,a,u,d,m;const g=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(v=>(v>this.params.maximumSequenceNumbersToCollect?(re("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),i=this.params.maximumSequenceNumbersToCollect):i=v,a=Date.now(),this.nthSequenceNumber(e,i))).next(v=>(r=v,u=Date.now(),this.removeTargets(e,r,n))).next(v=>(o=v,d=Date.now(),this.removeOrphanedDocuments(e,r))).next(v=>(m=Date.now(),sl()<=He.DEBUG&&re("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-g}ms
	Determined least recently used ${i} in `+(u-a)+`ms
	Removed ${o} targets in `+(d-u)+`ms
	Removed ${v} documents in `+(m-d)+`ms
Total Duration: ${m-g}ms`),W.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:v})))}}function sM(t,e){return new iM(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oM{constructor(e,n){this.db=e,this.garbageCollector=sM(this,n)}Yn(e){const n=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}er(e){let n=0;return this.Zn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Zn(e,n){return this.tr(e,(r,i)=>n(i))}addReference(e,n,r){return lh(e,r)}removeReference(e,n,r){return lh(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return lh(e,n)}nr(e,n){return function(i,o){let a=!1;return kS(i).Y(u=>bS(i,u,o).next(d=>(d&&(a=!0),W.resolve(!d)))).next(()=>a)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let o=0;return this.tr(e,(a,u)=>{if(u<=n){const d=this.nr(e,a).next(m=>{if(!m)return o++,r.getEntry(e,a).next(()=>(r.removeEntry(a,Se.min()),zs(e).delete(function(v){return[0,Ln(v.path)]}(a))))});i.push(d)}}).next(()=>W.waitFor(i)).next(()=>r.apply(e)).next(()=>o)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return lh(e,n)}tr(e,n){const r=zs(e);let i,o=Zn.oe;return r.J({index:"documentTargetsIndex"},([a,u],{path:d,sequenceNumber:m})=>{a===0?(o!==Zn.oe&&n(new ue(ai(i)),o),o=m,i=d):o=Zn.oe}).next(()=>{o!==Zn.oe&&n(new ue(ai(i)),o)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function lh(t,e){return zs(t).put(function(r,i){return{targetId:0,path:Ln(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IS{constructor(){this.changes=new wo(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,At.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?W.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aM{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Uo(e).put(r)}removeEntry(e,n,r){return Uo(e).delete(function(o,a){const u=o.path.toArray();return[u.slice(0,u.length-2),u[u.length-2],Af(a),u[u.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.rr(e,r)))}getEntry(e,n){let r=At.newInvalidDocument(n);return Uo(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Fc(n))},(i,o)=>{r=this.ir(n,o)}).next(()=>r)}sr(e,n){let r={size:0,document:At.newInvalidDocument(n)};return Uo(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Fc(n))},(i,o)=>{r={document:this.ir(n,o),size:jf(o)}}).next(()=>r)}getEntries(e,n){let r=or();return this._r(e,n,(i,o)=>{const a=this.ir(i,o);r=r.insert(i,a)}).next(()=>r)}ar(e,n){let r=or(),i=new dt(ue.comparator);return this._r(e,n,(o,a)=>{const u=this.ir(o,a);r=r.insert(o,u),i=i.insert(o,jf(a))}).next(()=>({documents:r,ur:i}))}_r(e,n,r){if(n.isEmpty())return W.resolve();let i=new at(Xw);n.forEach(d=>i=i.add(d));const o=IDBKeyRange.bound(Fc(i.first()),Fc(i.last())),a=i.getIterator();let u=a.getNext();return Uo(e).J({index:"documentKeyIndex",range:o},(d,m,g)=>{const v=ue.fromSegments([...m.prefixPath,m.collectionGroup,m.documentId]);for(;u&&Xw(u,v)<0;)r(u,null),u=a.getNext();u&&u.isEqual(v)&&(r(u,m),u=a.hasNext()?a.getNext():null),u?g.$(Fc(u)):g.done()}).next(()=>{for(;u;)r(u,null),u=a.hasNext()?a.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,o){const a=n.path,u=[a.popLast().toArray(),a.lastSegment(),Af(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],d=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Uo(e).U(IDBKeyRange.bound(u,d,!0)).next(m=>{o==null||o.incrementDocumentReadCount(m.length);let g=or();for(const v of m){const w=this.ir(ue.fromSegments(v.prefixPath.concat(v.collectionGroup,v.documentId)),v);w.isFoundDocument()&&(ud(n,w)||i.has(w.key))&&(g=g.insert(w.key,w))}return g})}getAllFromCollectionGroup(e,n,r,i){let o=or();const a=Jw(n,r),u=Jw(n,hr.max());return Uo(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(a,u,!0)},(d,m,g)=>{const v=this.ir(ue.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);o=o.insert(v.key,v),o.size===i&&g.done()}).next(()=>o)}newChangeBuffer(e){return new lM(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return Yw(e).get("remoteDocumentGlobalKey").next(n=>(Ee(!!n),n))}rr(e,n){return Yw(e).put("remoteDocumentGlobalKey",n)}ir(e,n){if(n){const r=HD(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(Se.min())))return r}return At.newInvalidDocument(e)}}function TS(t){return new aM(t)}class lM extends IS{constructor(e,n){super(),this.cr=e,this.trackRemovals=n,this.lr=new wo(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new at((o,a)=>De(o.canonicalString(),a.canonicalString()));return this.changes.forEach((o,a)=>{const u=this.lr.get(o);if(n.push(this.cr.removeEntry(e,o,u.readTime)),a.isValidDocument()){const d=Ow(this.cr.serializer,a);i=i.add(o.path.popLast());const m=jf(d);r+=m-u.size,n.push(this.cr.addEntry(e,o,d))}else if(r-=u.size,this.trackRemovals){const d=Ow(this.cr.serializer,a.convertToNoDocument(Se.min()));n.push(this.cr.addEntry(e,o,d))}}),i.forEach(o=>{n.push(this.cr.indexManager.addToCollectionParentIndex(e,o))}),n.push(this.cr.updateMetadata(e,r)),W.waitFor(n)}getFromCache(e,n){return this.cr.sr(e,n).next(r=>(this.lr.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.cr.ar(e,n).next(({documents:r,ur:i})=>(i.forEach((o,a)=>{this.lr.set(o,{size:a,readTime:r.get(o).readTime})}),r))}}function Yw(t){return Zt(t,"remoteDocumentGlobal")}function Uo(t){return Zt(t,"remoteDocumentsV14")}function Fc(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Jw(t,e){const n=e.documentKey.path.toArray();return[t,Af(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function Xw(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let o=0;o<n.length-2&&o<r.length-2;++o)if(i=De(n[o],r[o]),i)return i;return i=De(n.length,r.length),i||(i=De(n[n.length-2],r[r.length-2]),i||De(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cM{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ES{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&pu(r.mutation,i,Qn.empty(),Be.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Oe()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Oe()){const i=li();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(o=>{let a=Yc();return o.forEach((u,d)=>{a=a.insert(u,d.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const r=li();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Oe()))}populateOverlays(e,n,r){const i=[];return r.forEach(o=>{n.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((a,u)=>{n.set(a,u)})})}computeViews(e,n,r,i){let o=or();const a=mu(),u=function(){return mu()}();return n.forEach((d,m)=>{const g=r.get(m.key);i.has(m.key)&&(g===void 0||g.mutation instanceof as)?o=o.insert(m.key,m):g!==void 0?(a.set(m.key,g.mutation.getFieldMask()),pu(g.mutation,m,g.mutation.getFieldMask(),Be.now())):a.set(m.key,Qn.empty())}),this.recalculateAndSaveOverlays(e,o).next(d=>(d.forEach((m,g)=>a.set(m,g)),n.forEach((m,g)=>{var v;return u.set(m,new cM(g,(v=a.get(m))!==null&&v!==void 0?v:null))}),u))}recalculateAndSaveOverlays(e,n){const r=mu();let i=new dt((a,u)=>a-u),o=Oe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const u of a)u.keys().forEach(d=>{const m=n.get(d);if(m===null)return;let g=r.get(d)||Qn.empty();g=u.applyToLocalView(m,g),r.set(d,g);const v=(i.get(u.batchId)||Oe()).add(d);i=i.insert(u.batchId,v)})}).next(()=>{const a=[],u=i.getReverseIterator();for(;u.hasNext();){const d=u.getNext(),m=d.key,g=d.value,v=GE();g.forEach(w=>{if(!o.has(w)){const E=XE(n.get(w),r.get(w));E!==null&&v.set(w,E),o=o.add(w)}}),a.push(this.documentOverlayCache.saveOverlays(e,m,v))}return W.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(a){return ue.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):BE(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(o=>{const a=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-o.size):W.resolve(li());let u=-1,d=o;return a.next(m=>W.forEach(m,(g,v)=>(u<v.largestBatchId&&(u=v.largestBatchId),o.get(g)?W.resolve():this.remoteDocumentCache.getEntry(e,g).next(w=>{d=d.insert(g,w)}))).next(()=>this.populateOverlays(e,m,o)).next(()=>this.computeViews(e,d,m,Oe())).next(g=>({batchId:u,changes:WE(g)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ue(n)).next(r=>{let i=Yc();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const o=n.collectionGroup;let a=Yc();return this.indexManager.getCollectionParents(e,o).next(u=>W.forEach(u,d=>{const m=function(v,w){return new lc(w,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)}(n,d.child(o));return this.getDocumentsMatchingCollectionQuery(e,m,r,i).next(g=>{g.forEach((v,w)=>{a=a.insert(v,w)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,o,i))).next(a=>{o.forEach((d,m)=>{const g=m.getKey();a.get(g)===null&&(a=a.insert(g,At.newInvalidDocument(g)))});let u=Yc();return a.forEach((d,m)=>{const g=o.get(d);g!==void 0&&pu(g.mutation,m,Qn.empty(),Be.now()),ud(n,m)&&(u=u.insert(d,m))}),u})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uM{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return W.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Dn(i.createTime)}}(n)),W.resolve()}getNamedQuery(e,n){return W.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(i){return{name:i.name,query:_S(i.bundledQuery),readTime:Dn(i.readTime)}}(n)),W.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dM{constructor(){this.overlays=new dt(ue.comparator),this.Ir=new Map}getOverlay(e,n){return W.resolve(this.overlays.get(n))}getOverlays(e,n){const r=li();return W.forEach(n,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,o)=>{this.ht(e,n,o)}),W.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.Ir.delete(r)),W.resolve()}getOverlaysForCollection(e,n,r){const i=li(),o=n.length+1,a=new ue(n.child("")),u=this.overlays.getIteratorFrom(a);for(;u.hasNext();){const d=u.getNext().value,m=d.getKey();if(!n.isPrefixOf(m.path))break;m.path.length===o&&d.largestBatchId>r&&i.set(d.getKey(),d)}return W.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let o=new dt((m,g)=>m-g);const a=this.overlays.getIterator();for(;a.hasNext();){const m=a.getNext().value;if(m.getKey().getCollectionGroup()===n&&m.largestBatchId>r){let g=o.get(m.largestBatchId);g===null&&(g=li(),o=o.insert(m.largestBatchId,g)),g.set(m.getKey(),m)}}const u=li(),d=o.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach((m,g)=>u.set(m,g)),!(u.size()>=i)););return W.resolve(u)}ht(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const a=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new G0(n,r));let o=this.Ir.get(n);o===void 0&&(o=Oe(),this.Ir.set(n,o)),this.Ir.set(n,o.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hM{constructor(){this.sessionToken=Rt.EMPTY_BYTE_STRING}getSessionToken(e){return W.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,W.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J0{constructor(){this.Tr=new at(Xt.Er),this.dr=new at(Xt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new Xt(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new Xt(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new ue(new et([])),r=new Xt(n,e),i=new Xt(n,e+1),o=[];return this.dr.forEachInRange([r,i],a=>{this.Vr(a),o.push(a.key)}),o}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new ue(new et([])),r=new Xt(n,e),i=new Xt(n,e+1);let o=Oe();return this.dr.forEachInRange([r,i],a=>{o=o.add(a.key)}),o}containsKey(e){const n=new Xt(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Xt{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return ue.comparator(e.key,n.key)||De(e.wr,n.wr)}static Ar(e,n){return De(e.wr,n.wr)||ue.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fM{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new at(Xt.Er)}checkEmpty(e){return W.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const o=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new H0(o,n,r,i);this.mutationQueue.push(a);for(const u of i)this.br=this.br.add(new Xt(u.key,o)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return W.resolve(a)}lookupMutationBatch(e,n){return W.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.vr(r),o=i<0?0:i;return W.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return W.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return W.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Xt(n,0),i=new Xt(n,Number.POSITIVE_INFINITY),o=[];return this.br.forEachInRange([r,i],a=>{const u=this.Dr(a.wr);o.push(u)}),W.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new at(De);return n.forEach(i=>{const o=new Xt(i,0),a=new Xt(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([o,a],u=>{r=r.add(u.wr)})}),W.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let o=r;ue.isDocumentKey(o)||(o=o.child(""));const a=new Xt(new ue(o),0);let u=new at(De);return this.br.forEachWhile(d=>{const m=d.key.path;return!!r.isPrefixOf(m)&&(m.length===i&&(u=u.add(d.wr)),!0)},a),W.resolve(this.Cr(u))}Cr(e){const n=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){Ee(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return W.forEach(n.mutations,i=>{const o=new Xt(i.key,n.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new Xt(n,0),i=this.br.firstAfterOrEqual(r);return W.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,W.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mM{constructor(e){this.Mr=e,this.docs=function(){return new dt(ue.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),o=i?i.size:0,a=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return W.resolve(r?r.document.mutableCopy():At.newInvalidDocument(n))}getEntries(e,n){let r=or();return n.forEach(i=>{const o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():At.newInvalidDocument(i))}),W.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let o=or();const a=n.path,u=new ue(a.child("")),d=this.docs.getIteratorFrom(u);for(;d.hasNext();){const{key:m,value:{document:g}}=d.getNext();if(!a.isPrefixOf(m.path))break;m.path.length>a.length+1||O0(vE(g),r)<=0||(i.has(g.key)||ud(n,g))&&(o=o.insert(g.key,g.mutableCopy()))}return W.resolve(o)}getAllFromCollectionGroup(e,n,r,i){be()}Or(e,n){return W.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new pM(this)}getSize(e){return W.resolve(this.size)}}class pM extends IS{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),W.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gM{constructor(e){this.persistence=e,this.Nr=new wo(n=>ya(n),ld),this.lastRemoteSnapshotVersion=Se.min(),this.highestTargetId=0,this.Lr=0,this.Br=new J0,this.targetCount=0,this.kr=ba.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,i)=>n(i)),W.resolve()}getLastRemoteSnapshotVersion(e){return W.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return W.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),W.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),W.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new ba(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,W.resolve()}updateTargetData(e,n){return this.Kn(n),W.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,W.resolve()}removeTargets(e,n,r){let i=0;const o=[];return this.Nr.forEach((a,u)=>{u.sequenceNumber<=n&&r.get(u.targetId)===null&&(this.Nr.delete(a),o.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),W.waitFor(o).next(()=>i)}getTargetCount(e){return W.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return W.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),W.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const i=this.persistence.referenceDelegate,o=[];return i&&n.forEach(a=>{o.push(i.markPotentiallyOrphaned(e,a))}),W.waitFor(o)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),W.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return W.resolve(r)}containsKey(e,n){return W.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SS{constructor(e,n){this.qr={},this.overlays={},this.Qr=new Zn(0),this.Kr=!1,this.Kr=!0,this.$r=new hM,this.referenceDelegate=e(this),this.Ur=new gM(this),this.indexManager=new XD,this.remoteDocumentCache=function(i){return new mM(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new gS(n),this.Gr=new uM(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new dM,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new fM(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){re("MemoryPersistence","Starting transaction:",e);const i=new yM(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(o=>this.referenceDelegate.jr(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Hr(e,n){return W.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class yM extends wE{constructor(e){super(),this.currentSequenceNumber=e}}class bm{constructor(e){this.persistence=e,this.Jr=new J0,this.Yr=null}static Zr(e){return new bm(e)}get Xr(){if(this.Yr)return this.Yr;throw be()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),W.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),W.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),W.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(o=>this.Xr.add(o.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return W.forEach(this.Xr,r=>{const i=ue.fromPath(r);return this.ei(e,i).next(o=>{o||n.removeEntry(i,Se.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return W.or([()=>W.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _M{constructor(e){this.serializer=e}O(e,n,r,i){const o=new hm("createOrUpgrade",n);r<1&&i>=1&&(function(d){d.createObjectStore("owner")}(e),function(d){d.createObjectStore("mutationQueues",{keyPath:"userId"}),d.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",fw,{unique:!0}),d.createObjectStore("documentMutations")}(e),eb(e),function(d){d.createObjectStore("remoteDocuments")}(e));let a=W.resolve();return r<3&&i>=3&&(r!==0&&(function(d){d.deleteObjectStore("targetDocuments"),d.deleteObjectStore("targets"),d.deleteObjectStore("targetGlobal")}(e),eb(e)),a=a.next(()=>function(d){const m=d.store("targetGlobal"),g={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Se.min().toTimestamp(),targetCount:0};return m.put("targetGlobalKey",g)}(o))),r<4&&i>=4&&(r!==0&&(a=a.next(()=>function(d,m){return m.store("mutations").U().next(g=>{d.deleteObjectStore("mutations"),d.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",fw,{unique:!0});const v=m.store("mutations"),w=g.map(E=>v.put(E));return W.waitFor(w)})}(e,o))),a=a.next(()=>{(function(d){d.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(a=a.next(()=>this.ni(o))),r<6&&i>=6&&(a=a.next(()=>(function(d){d.createObjectStore("remoteDocumentGlobal")}(e),this.ri(o)))),r<7&&i>=7&&(a=a.next(()=>this.ii(o))),r<8&&i>=8&&(a=a.next(()=>this.si(e,o))),r<9&&i>=9&&(a=a.next(()=>{(function(d){d.objectStoreNames.contains("remoteDocumentChanges")&&d.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(a=a.next(()=>this.oi(o))),r<11&&i>=11&&(a=a.next(()=>{(function(d){d.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(d){d.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(a=a.next(()=>{(function(d){const m=d.createObjectStore("documentOverlays",{keyPath:QL});m.createIndex("collectionPathOverlayIndex",YL,{unique:!1}),m.createIndex("collectionGroupOverlayIndex",JL,{unique:!1})})(e)})),r<13&&i>=13&&(a=a.next(()=>function(d){const m=d.createObjectStore("remoteDocumentsV14",{keyPath:FL});m.createIndex("documentKeyIndex",UL),m.createIndex("collectionGroupIndex",BL)}(e)).next(()=>this._i(e,o)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(a=a.next(()=>this.ai(e,o))),r<15&&i>=15&&(a=a.next(()=>function(d){d.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),d.createObjectStore("indexState",{keyPath:WL}).createIndex("sequenceNumberIndex",GL,{unique:!1}),d.createObjectStore("indexEntries",{keyPath:KL}).createIndex("documentKeyIndex",ZL,{unique:!1})}(e))),r<16&&i>=16&&(a=a.next(()=>{n.objectStore("indexState").clear()}).next(()=>{n.objectStore("indexEntries").clear()})),r<17&&i>=17&&(a=a.next(()=>{(function(d){d.createObjectStore("globals",{keyPath:"name"})})(e)})),a}ri(e){let n=0;return e.store("remoteDocuments").J((r,i)=>{n+=jf(i)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.U().next(i=>W.forEach(i,o=>{const a=IDBKeyRange.bound([o.userId,-1],[o.userId,o.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",a).next(u=>W.forEach(u,d=>{Ee(d.userId===o.userId);const m=Go(this.serializer,d);return wS(e,o.userId,m).next(()=>{})}))}))}ii(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const o=[];return r.J((a,u)=>{const d=new et(a),m=function(v){return[0,Ln(v)]}(d);o.push(n.get(m).next(g=>g?W.resolve():(v=>n.put({targetId:0,path:Ln(v),sequenceNumber:i.highestListenSequenceNumber}))(d)))}).next(()=>W.waitFor(o))})}si(e,n){e.createObjectStore("collectionParents",{keyPath:HL});const r=n.store("collectionParents"),i=new Y0,o=a=>{if(i.add(a)){const u=a.lastSegment(),d=a.popLast();return r.put({collectionId:u,parent:Ln(d)})}};return n.store("remoteDocuments").J({H:!0},(a,u)=>{const d=new et(a);return o(d.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([a,u,d],m)=>{const g=ai(u);return o(g.popLast())}))}oi(e){const n=e.store("targets");return n.J((r,i)=>{const o=Xc(i),a=yS(this.serializer,o);return n.put(a)})}_i(e,n){const r=n.store("remoteDocuments"),i=[];return r.J((o,a)=>{const u=n.store("remoteDocumentsV14"),d=function(v){return v.document?new ue(et.fromString(v.document.name).popFirst(5)):v.noDocument?ue.fromSegments(v.noDocument.path):v.unknownDocument?ue.fromSegments(v.unknownDocument.path):be()}(a).path.toArray(),m={prefixPath:d.slice(0,d.length-2),collectionGroup:d[d.length-2],documentId:d[d.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};i.push(u.put(m))}).next(()=>W.waitFor(i))}ai(e,n){const r=n.store("mutations"),i=TS(this.serializer),o=new SS(bm.Zr,this.serializer.ct);return r.U().next(a=>{const u=new Map;return a.forEach(d=>{var m;let g=(m=u.get(d.userId))!==null&&m!==void 0?m:Oe();Go(this.serializer,d).keys().forEach(v=>g=g.add(v)),u.set(d.userId,g)}),W.forEach(u,(d,m)=>{const g=new gn(m),v=xm.lt(this.serializer,g),w=o.getIndexManager(g),E=wm.lt(g,this.serializer,w,o.referenceDelegate);return new ES(i,E,v,w).recalculateAndSaveOverlaysForDocumentKeys(new Xg(n,Zn.oe),d).next()})})}}function eb(t){t.createObjectStore("targetDocuments",{keyPath:qL}).createIndex("documentTargetsIndex",$L,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",zL,{unique:!0}),t.createObjectStore("targetGlobal")}const Mp="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class X0{constructor(e,n,r,i,o,a,u,d,m,g,v=17){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.ui=o,this.window=a,this.document=u,this.ci=m,this.li=g,this.hi=v,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=w=>Promise.resolve(),!X0.D())throw new ae(X.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new oM(this,i),this.Ai=n+"main",this.serializer=new gS(d),this.Ri=new io(this.Ai,this.hi,new _M(this.serializer)),this.$r=new GD,this.Ur=new tM(this.referenceDelegate,this.serializer),this.remoteDocumentCache=TS(this.serializer),this.Gr=new WD,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,g===!1&&Vt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ae(X.FAILED_PRECONDITION,Mp);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new Zn(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>ch(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(n=>{n||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(n=>this.isPrimary&&!n?this.bi(e).next(()=>!1):!!n&&this.Di(e).next(()=>!0))).catch(e=>{if(xo(e))return re("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return re("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return Uc(e).get("owner").next(n=>W.resolve(this.vi(n)))}Ci(e){return ch(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Zt(n,"clientMetadata");return r.U().next(i=>{const o=this.xi(i,18e5),a=i.filter(u=>o.indexOf(u)===-1);return W.forEach(a,u=>r.delete(u.clientId)).next(()=>a)})}).catch(()=>[]);if(this.Vi)for(const n of e)this.Vi.removeItem(this.Oi(n.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?W.resolve(!0):Uc(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)){if(this.vi(n)&&this.networkEnabled)return!0;if(!this.vi(n)){if(!n.allowTabSynchronization)throw new ae(X.FAILED_PRECONDITION,Mp);return!1}}return!(!this.networkEnabled||!this.inForeground)||ch(e).U().next(r=>this.xi(r,5e3).find(i=>{if(this.clientId!==i.clientId){const o=!this.networkEnabled&&i.networkEnabled,a=!this.inForeground&&i.inForeground,u=this.networkEnabled===i.networkEnabled;if(o||a&&u)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&re("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new Xg(e,Zn.oe);return this.bi(n).next(()=>this.Ci(n))}),this.Ri.close(),this.qi()}xi(e,n){return e.filter(r=>this.Mi(r.updateTimeMs,n)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>ch(e).U().next(n=>this.xi(n,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,n){return wm.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new eM(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return xm.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,n,r){re("IndexedDbPersistence","Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",o=function(d){return d===17?tD:d===16?eD:d===15?F0:d===14?SE:d===13?EE:d===12?XL:d===11?TE:void be()}(this.hi);let a;return this.Ri.runTransaction(e,i,o,u=>(a=new Xg(u,this.Qr?this.Qr.next():Zn.oe),n==="readwrite-primary"?this.wi(a).next(d=>!!d||this.Si(a)).next(d=>{if(!d)throw Vt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new ae(X.FAILED_PRECONDITION,xE);return r(a)}).next(d=>this.Di(a).next(()=>d)):this.Ki(a).next(()=>r(a)))).then(u=>(a.raiseOnCommittedEvent(),u))}Ki(e){return Uc(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)&&!this.vi(n)&&!(this.li||this.allowTabSynchronization&&n.allowTabSynchronization))throw new ae(X.FAILED_PRECONDITION,Mp)})}Di(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Uc(e).put("owner",n)}static D(){return io.D()}bi(e){const n=Uc(e);return n.get("owner").next(r=>this.vi(r)?(re("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):W.resolve())}Mi(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(Vt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const n=/(?:Version|Mobile)\/1[456]/;xT()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var n;try{const r=((n=this.Vi)===null||n===void 0?void 0:n.getItem(this.Oi(e)))!==null;return re("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Vt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){Vt("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Uc(t){return Zt(t,"owner")}function ch(t){return Zt(t,"clientMetadata")}function NS(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e_{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=i}static Wi(e,n){let r=Oe(),i=Oe();for(const o of n.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new e_(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vM{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PS{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return xT()?8:bE(Kt())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,i){const o={result:null};return this.Yi(e,n).next(a=>{o.result=a}).next(()=>{if(!o.result)return this.Zi(e,n,i,r).next(a=>{o.result=a})}).next(()=>{if(o.result)return;const a=new vM;return this.Xi(e,n,a).next(u=>{if(o.result=u,this.zi)return this.es(e,n,a,u.size)})}).next(()=>o.result)}es(e,n,r,i){return r.documentReadCount<this.ji?(sl()<=He.DEBUG&&re("QueryEngine","SDK will not create cache indexes for query:",ol(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),W.resolve()):(sl()<=He.DEBUG&&re("QueryEngine","Query:",ol(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(sl()<=He.DEBUG&&re("QueryEngine","The SDK decides to create cache indexes for query:",ol(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,cr(n))):W.resolve())}Yi(e,n){if(Ew(n))return W.resolve(null);let r=cr(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Nf(n,null,"F"),r=cr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{const a=Oe(...o);return this.Ji.getDocuments(e,a).next(u=>this.indexManager.getMinOffset(e,r).next(d=>{const m=this.ts(n,u);return this.ns(n,m,a,d.readTime)?this.Yi(e,Nf(n,null,"F")):this.rs(e,m,n,d)}))})))}Zi(e,n,r,i){return Ew(n)||i.isEqual(Se.min())?W.resolve(null):this.Ji.getDocuments(e,r).next(o=>{const a=this.ts(n,o);return this.ns(n,a,r,i)?W.resolve(null):(sl()<=He.DEBUG&&re("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ol(n)),this.rs(e,a,n,_E(i,-1)).next(u=>u))})}ts(e,n){let r=new at($E(e));return n.forEach((i,o)=>{ud(e,o)&&(r=r.add(o))}),r}ns(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const o=e.limitType==="F"?n.last():n.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Xi(e,n,r){return sl()<=He.DEBUG&&re("QueryEngine","Using full collection scan to execute query:",ol(n)),this.Ji.getDocumentsMatchingQuery(e,n,hr.min(),r)}rs(e,n,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(o=>(n.forEach(a=>{o=o.insert(a.key,a)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xM{constructor(e,n,r,i){this.persistence=e,this.ss=n,this.serializer=i,this.os=new dt(De),this._s=new wo(o=>ya(o),ld),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ES(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function CS(t,e,n,r){return new xM(t,e,n,r)}async function AS(t,e){const n=Ie(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(o=>{const a=[],u=[];let d=Oe();for(const m of i){a.push(m.batchId);for(const g of m.mutations)d=d.add(g.key)}for(const m of o){u.push(m.batchId);for(const g of m.mutations)d=d.add(g.key)}return n.localDocuments.getDocuments(r,d).next(m=>({hs:m,removedBatchIds:a,addedBatchIds:u}))})})}function wM(t,e){const n=Ie(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),o=n.cs.newChangeBuffer({trackRemovals:!0});return function(u,d,m,g){const v=m.batch,w=v.keys();let E=W.resolve();return w.forEach(C=>{E=E.next(()=>g.getEntry(d,C)).next(P=>{const F=m.docVersions.get(C);Ee(F!==null),P.version.compareTo(F)<0&&(v.applyToRemoteDocument(P,m),P.isValidDocument()&&(P.setReadTime(m.commitVersion),g.addEntry(P)))})}),E.next(()=>u.mutationQueue.removeMutationBatch(d,v))}(n,r,e,o).next(()=>o.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let d=Oe();for(let m=0;m<u.mutationResults.length;++m)u.mutationResults[m].transformResults.length>0&&(d=d.add(u.batch.mutations[m].key));return d}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function RS(t){const e=Ie(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function bM(t,e){const n=Ie(t),r=e.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const a=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const u=[];e.targetChanges.forEach((g,v)=>{const w=i.get(v);if(!w)return;u.push(n.Ur.removeMatchingKeys(o,g.removedDocuments,v).next(()=>n.Ur.addMatchingKeys(o,g.addedDocuments,v)));let E=w.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(v)!==null?E=E.withResumeToken(Rt.EMPTY_BYTE_STRING,Se.min()).withLastLimboFreeSnapshotVersion(Se.min()):g.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(g.resumeToken,r)),i=i.insert(v,E),function(P,F,N){return P.resumeToken.approximateByteSize()===0||F.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=3e8?!0:N.addedDocuments.size+N.modifiedDocuments.size+N.removedDocuments.size>0}(w,E,g)&&u.push(n.Ur.updateTargetData(o,E))});let d=or(),m=Oe();if(e.documentUpdates.forEach(g=>{e.resolvedLimboDocuments.has(g)&&u.push(n.persistence.referenceDelegate.updateLimboDocument(o,g))}),u.push(kM(o,a,e.documentUpdates).next(g=>{d=g.Ps,m=g.Is})),!r.isEqual(Se.min())){const g=n.Ur.getLastRemoteSnapshotVersion(o).next(v=>n.Ur.setTargetsMetadata(o,o.currentSequenceNumber,r));u.push(g)}return W.waitFor(u).next(()=>a.apply(o)).next(()=>n.localDocuments.getLocalViewOfDocuments(o,d,m)).next(()=>d)}).then(o=>(n.os=i,o))}function kM(t,e,n){let r=Oe(),i=Oe();return n.forEach(o=>r=r.add(o)),e.getEntries(t,r).next(o=>{let a=or();return n.forEach((u,d)=>{const m=o.get(u);d.isFoundDocument()!==m.isFoundDocument()&&(i=i.add(u)),d.isNoDocument()&&d.version.isEqual(Se.min())?(e.removeEntry(u,d.readTime),a=a.insert(u,d)):!m.isValidDocument()||d.version.compareTo(m.version)>0||d.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(d),a=a.insert(u,d)):re("LocalStore","Ignoring outdated watch update for ",u,". Current version:",m.version," Watch version:",d.version)}),{Ps:a,Is:i}})}function IM(t,e){const n=Ie(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Lf(t,e){const n=Ie(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Ur.getTargetData(r,e).next(o=>o?(i=o,W.resolve(i)):n.Ur.allocateTargetId(r).next(a=>(i=new zi(e,a,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Kl(t,e,n){const r=Ie(t),i=r.os.get(e),o=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",o,a=>r.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!xo(a))throw a;re("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function fy(t,e,n){const r=Ie(t);let i=Se.min(),o=Oe();return r.persistence.runTransaction("Execute query","readwrite",a=>function(d,m,g){const v=Ie(d),w=v._s.get(g);return w!==void 0?W.resolve(v.os.get(w)):v.Ur.getTargetData(m,g)}(r,a,cr(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(a,u.targetId).next(d=>{o=d})}).next(()=>r.ss.getDocumentsMatchingQuery(a,e,n?i:Se.min(),n?o:Oe())).next(u=>(DS(r,qE(e),u),{documents:u,Ts:o})))}function jS(t,e){const n=Ie(t),r=Ie(n.Ur),i=n.os.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",o=>r.ot(o,e).next(a=>a?a.target:null))}function LS(t,e){const n=Ie(t),r=n.us.get(e)||Se.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.cs.getAllFromCollectionGroup(i,e,_E(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(DS(n,e,i),i))}function DS(t,e,n){let r=t.us.get(e)||Se.min();n.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),t.us.set(e,r)}function tb(t,e){return`firestore_clients_${t}_${e}`}function nb(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function Op(t,e){return`firestore_targets_${t}_${e}`}class Df{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Rs(e,n,r){const i=JSON.parse(r);let o,a=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return a&&i.error&&(a=typeof i.error.message=="string"&&typeof i.error.code=="string",a&&(o=new ae(i.error.code,i.error.message))),a?new Df(e,n,i.state,o):(Vt("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class gu{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Rs(e,n){const r=JSON.parse(n);let i,o=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return o&&r.error&&(o=typeof r.error.message=="string"&&typeof r.error.code=="string",o&&(i=new ae(r.error.code,r.error.message))),o?new gu(e,r.state,i):(Vt("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Mf{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Rs(e,n){const r=JSON.parse(n);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,o=q0();for(let a=0;i&&a<r.activeTargetIds.length;++a)i=kE(r.activeTargetIds[a]),o=o.add(r.activeTargetIds[a]);return i?new Mf(e,o):(Vt("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class t_{constructor(e,n){this.clientId=e,this.onlineState=n}static Rs(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new t_(n.clientId,n.onlineState):(Vt("SharedClientState",`Failed to parse online state: ${e}`),null)}}class my{constructor(){this.activeTargetIds=q0()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Vp{constructor(e,n,r,i,o){this.window=e,this.ui=n,this.persistenceKey=r,this.ps=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new dt(De),this.started=!1,this.bs=[];const a=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.Ds=tb(this.persistenceKey,this.ps),this.vs=function(d){return`firestore_sequence_number_${d}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new my),this.Cs=new RegExp(`^firestore_clients_${a}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${a}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${a}_(\\d+)$`),this.xs=function(d){return`firestore_online_state_${d}`}(this.persistenceKey),this.Os=function(d){return`firestore_bundle_loaded_v2_${d}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const r of e){if(r===this.ps)continue;const i=this.getItem(tb(this.persistenceKey,r));if(i){const o=Mf.Rs(r,i);o&&(this.Ss=this.Ss.insert(o.clientId,o))}}this.Ns();const n=this.storage.getItem(this.xs);if(n){const r=this.Ls(n);r&&this.Bs(r)}for(const r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let n=!1;return this.Ss.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,n,r){this.qs(e,n,r),this.Qs(e)}addLocalQueryTarget(e,n=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(Op(this.persistenceKey,e));if(i){const o=gu.Rs(e,i);o&&(r=o.state)}}return n&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Op(this.persistenceKey,e))}updateQueryState(e,n,r){this.$s(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Qs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return re("SharedClientState","READ",e,n),n}setItem(e,n){re("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){re("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const n=e;if(n.storageArea===this.storage){if(re("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Ds)return void Vt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.Cs.test(n.key)){if(n.newValue==null){const r=this.Gs(n.key);return this.zs(r,null)}{const r=this.js(n.key,n.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(n.key)){if(n.newValue!==null){const r=this.Hs(n.key,n.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(n.key)){if(n.newValue!==null){const r=this.Ys(n.key,n.newValue);if(r)return this.Zs(r)}}else if(n.key===this.xs){if(n.newValue!==null){const r=this.Ls(n.newValue);if(r)return this.Bs(r)}}else if(n.key===this.vs){const r=function(o){let a=Zn.oe;if(o!=null)try{const u=JSON.parse(o);Ee(typeof u=="number"),a=u}catch(u){Vt("SharedClientState","Failed to read sequence number from WebStorage",u)}return a}(n.newValue);r!==Zn.oe&&this.sequenceNumberHandler(r)}else if(n.key===this.Os){const r=this.Xs(n.newValue);await Promise.all(r.map(i=>this.syncEngine.eo(i)))}}}else this.bs.push(n)})}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,n,r){const i=new Df(this.currentUser,e,n,r),o=nb(this.persistenceKey,this.currentUser,e);this.setItem(o,i.Vs())}Qs(e){const n=nb(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Us(e){const n={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(n))}$s(e,n,r){const i=Op(this.persistenceKey,e),o=new gu(e,n,r);this.setItem(i,o.Vs())}Ws(e){const n=JSON.stringify(Array.from(e));this.setItem(this.Os,n)}Gs(e){const n=this.Cs.exec(e);return n?n[1]:null}js(e,n){const r=this.Gs(e);return Mf.Rs(r,n)}Hs(e,n){const r=this.Fs.exec(e),i=Number(r[1]),o=r[2]!==void 0?r[2]:null;return Df.Rs(new gn(o),i,n)}Ys(e,n){const r=this.Ms.exec(e),i=Number(r[1]);return gu.Rs(i,n)}Ls(e){return t_.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);re("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,n){const r=n?this.Ss.insert(e,n):this.Ss.remove(e),i=this.ks(this.Ss),o=this.ks(r),a=[],u=[];return o.forEach(d=>{i.has(d)||a.push(d)}),i.forEach(d=>{o.has(d)||u.push(d)}),this.syncEngine.io(a,u).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let n=q0();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}}class MS{constructor(){this.so=new my,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new my,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TM{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rb{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){re("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){re("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uh=null;function Fp(){return uh===null?uh=function(){return 268435456+Math.round(2147483648*Math.random())}():uh++,"0x"+uh.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EM={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SM{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pn="WebChannelConnection";class NM extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${i}/databases/${o}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${o}`}get Fo(){return!1}Mo(n,r,i,o,a){const u=Fp(),d=this.xo(n,r.toUriEncodedString());re("RestConnection",`Sending RPC '${n}' ${u}:`,d,i);const m={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(m,o,a),this.No(n,d,m,i).then(g=>(re("RestConnection",`Received RPC '${n}' ${u}: `,g),g),g=>{throw Bl("RestConnection",`RPC '${n}' ${u} failed with error: `,g,"url: ",d,"request:",i),g})}Lo(n,r,i,o,a,u){return this.Mo(n,r,i,o,a)}Oo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ac}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((o,a)=>n[a]=o),i&&i.headers.forEach((o,a)=>n[a]=o)}xo(n,r){const i=EM[n];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,i){const o=Fp();return new Promise((a,u)=>{const d=new dE;d.setWithCredentials(!0),d.listenOnce(hE.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Lh.NO_ERROR:const g=d.getResponseJson();re(pn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(g)),a(g);break;case Lh.TIMEOUT:re(pn,`RPC '${e}' ${o} timed out`),u(new ae(X.DEADLINE_EXCEEDED,"Request time out"));break;case Lh.HTTP_ERROR:const v=d.getStatus();if(re(pn,`RPC '${e}' ${o} failed with status:`,v,"response text:",d.getResponseText()),v>0){let w=d.getResponseJson();Array.isArray(w)&&(w=w[0]);const E=w==null?void 0:w.error;if(E&&E.status&&E.message){const C=function(F){const N=F.toLowerCase().replace(/_/g,"-");return Object.values(X).indexOf(N)>=0?N:X.UNKNOWN}(E.status);u(new ae(C,E.message))}else u(new ae(X.UNKNOWN,"Server responded with status "+d.getStatus()))}else u(new ae(X.UNAVAILABLE,"Connection failed."));break;default:be()}}finally{re(pn,`RPC '${e}' ${o} completed.`)}});const m=JSON.stringify(i);re(pn,`RPC '${e}' ${o} sending request:`,i),d.send(n,"POST",m,r,15)})}Bo(e,n,r){const i=Fp(),o=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=pE(),u=mE(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(d.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(d.useFetchStreams=!0),this.Oo(d.initMessageHeaders,n,r),d.encodeInitMessageHeaders=!0;const g=o.join("");re(pn,`Creating RPC '${e}' stream ${i}: ${g}`,d);const v=a.createWebChannel(g,d);let w=!1,E=!1;const C=new SM({Io:F=>{E?re(pn,`Not sending because RPC '${e}' stream ${i} is closed:`,F):(w||(re(pn,`Opening RPC '${e}' stream ${i} transport.`),v.open(),w=!0),re(pn,`RPC '${e}' stream ${i} sending:`,F),v.send(F))},To:()=>v.close()}),P=(F,N,T)=>{F.listen(N,A=>{try{T(A)}catch(z){setTimeout(()=>{throw z},0)}})};return P(v,Qc.EventType.OPEN,()=>{E||(re(pn,`RPC '${e}' stream ${i} transport opened.`),C.yo())}),P(v,Qc.EventType.CLOSE,()=>{E||(E=!0,re(pn,`RPC '${e}' stream ${i} transport closed`),C.So())}),P(v,Qc.EventType.ERROR,F=>{E||(E=!0,Bl(pn,`RPC '${e}' stream ${i} transport errored:`,F),C.So(new ae(X.UNAVAILABLE,"The operation could not be completed")))}),P(v,Qc.EventType.MESSAGE,F=>{var N;if(!E){const T=F.data[0];Ee(!!T);const A=T,z=A.error||((N=A[0])===null||N===void 0?void 0:N.error);if(z){re(pn,`RPC '${e}' stream ${i} received error:`,z);const Z=z.status;let H=function(R){const D=zt[R];if(D!==void 0)return nS(D)}(Z),I=z.message;H===void 0&&(H=X.INTERNAL,I="Unknown error status: "+Z+" with message "+z.message),E=!0,C.So(new ae(H,I)),v.close()}else re(pn,`RPC '${e}' stream ${i} received:`,T),C.bo(T)}}),P(u,fE.STAT_EVENT,F=>{F.stat===Yg.PROXY?re(pn,`RPC '${e}' stream ${i} detected buffering proxy`):F.stat===Yg.NOPROXY&&re(pn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{C.wo()},0),C}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OS(){return typeof window<"u"?window:null}function Bh(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function km(t){return new DD(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VS{constructor(e,n,r=1e3,i=1.5,o=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=i,this.Qo=o,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,n-r);i>0&&re("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FS{constructor(e,n,r,i,o,a,u,d){this.ui=e,this.Ho=r,this.Jo=i,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=d,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new VS(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===X.RESOURCE_EXHAUSTED?(Vt(n.toString()),Vt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===X.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===n&&this.P_(r,i)},r=>{e(()=>{const i=new ae(X.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return re("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(re("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class PM extends FS{constructor(e,n,r,i,o,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,a),this.serializer=o}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=VD(this.serializer,e),r=function(o){if(!("targetChange"in o))return Se.min();const a=o.targetChange;return a.targetIds&&a.targetIds.length?Se.min():a.readTime?Dn(a.readTime):Se.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=ly(this.serializer),n.addTarget=function(o,a){let u;const d=a.target;if(u=Ef(d)?{documents:uS(o,d)}:{query:dS(o,d)._t},u.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){u.resumeToken=sS(o,a.resumeToken);const m=oy(o,a.expectedCount);m!==null&&(u.expectedCount=m)}else if(a.snapshotVersion.compareTo(Se.min())>0){u.readTime=Gl(o,a.snapshotVersion.toTimestamp());const m=oy(o,a.expectedCount);m!==null&&(u.expectedCount=m)}return u}(this.serializer,e);const r=UD(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=ly(this.serializer),n.removeTarget=e,this.a_(n)}}class CM extends FS{constructor(e,n,r,i,o,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,a),this.serializer=o}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return Ee(!!e.streamToken),this.lastStreamToken=e.streamToken,Ee(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Ee(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=FD(e.writeResults,e.commitTime),r=Dn(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=ly(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Cf(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AM extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new ae(X.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Mo(e,ay(n,r),i,o,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===X.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ae(X.UNKNOWN,o.toString())})}Lo(e,n,r,i,o){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,u])=>this.connection.Lo(e,ay(n,r),i,a,u,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===X.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new ae(X.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class RM{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Vt(n),this.D_=!1):re("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jM{constructor(e,n,r,i,o){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=o,this.k_._o(a=>{r.enqueueAndForget(async()=>{ja(this)&&(re("RemoteStore","Restarting streams for network reachability change."),await async function(d){const m=Ie(d);m.L_.add(4),await fd(m),m.q_.set("Unknown"),m.L_.delete(4),await Im(m)}(this))})}),this.q_=new RM(r,i)}}async function Im(t){if(ja(t))for(const e of t.B_)await e(!0)}async function fd(t){for(const e of t.B_)await e(!1)}function Tm(t,e){const n=Ie(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),i_(n)?r_(n):dc(n).r_()&&n_(n,e))}function Zl(t,e){const n=Ie(t),r=dc(n);n.N_.delete(e),r.r_()&&US(n,e),n.N_.size===0&&(r.r_()?r.o_():ja(n)&&n.q_.set("Unknown"))}function n_(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Se.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}dc(t).A_(e)}function US(t,e){t.Q_.xe(e),dc(t).R_(e)}function r_(t){t.Q_=new AD({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),dc(t).start(),t.q_.v_()}function i_(t){return ja(t)&&!dc(t).n_()&&t.N_.size>0}function ja(t){return Ie(t).L_.size===0}function BS(t){t.Q_=void 0}async function LM(t){t.q_.set("Online")}async function DM(t){t.N_.forEach((e,n)=>{n_(t,e)})}async function MM(t,e){BS(t),i_(t)?(t.q_.M_(e),r_(t)):t.q_.set("Unknown")}async function OM(t,e,n){if(t.q_.set("Online"),e instanceof iS&&e.state===2&&e.cause)try{await async function(i,o){const a=o.cause;for(const u of o.targetIds)i.N_.has(u)&&(await i.remoteSyncer.rejectListen(u,a),i.N_.delete(u),i.Q_.removeTarget(u))}(t,e)}catch(r){re("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Of(t,r)}else if(e instanceof Uh?t.Q_.Ke(e):e instanceof rS?t.Q_.He(e):t.Q_.We(e),!n.isEqual(Se.min()))try{const r=await RS(t.localStore);n.compareTo(r)>=0&&await function(o,a){const u=o.Q_.rt(a);return u.targetChanges.forEach((d,m)=>{if(d.resumeToken.approximateByteSize()>0){const g=o.N_.get(m);g&&o.N_.set(m,g.withResumeToken(d.resumeToken,a))}}),u.targetMismatches.forEach((d,m)=>{const g=o.N_.get(d);if(!g)return;o.N_.set(d,g.withResumeToken(Rt.EMPTY_BYTE_STRING,g.snapshotVersion)),US(o,d);const v=new zi(g.target,d,m,g.sequenceNumber);n_(o,v)}),o.remoteSyncer.applyRemoteEvent(u)}(t,n)}catch(r){re("RemoteStore","Failed to raise snapshot:",r),await Of(t,r)}}async function Of(t,e,n){if(!xo(e))throw e;t.L_.add(1),await fd(t),t.q_.set("Offline"),n||(n=()=>RS(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{re("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await Im(t)})}function zS(t,e){return e().catch(n=>Of(t,n,e))}async function uc(t){const e=Ie(t),n=uo(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;VM(e);)try{const i=await IM(e.localStore,r);if(i===null){e.O_.length===0&&n.o_();break}r=i.batchId,FM(e,i)}catch(i){await Of(e,i)}qS(e)&&$S(e)}function VM(t){return ja(t)&&t.O_.length<10}function FM(t,e){t.O_.push(e);const n=uo(t);n.r_()&&n.V_&&n.m_(e.mutations)}function qS(t){return ja(t)&&!uo(t).n_()&&t.O_.length>0}function $S(t){uo(t).start()}async function UM(t){uo(t).p_()}async function BM(t){const e=uo(t);for(const n of t.O_)e.m_(n.mutations)}async function zM(t,e,n){const r=t.O_.shift(),i=W0.from(r,e,n);await zS(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await uc(t)}async function qM(t,e){e&&uo(t).V_&&await async function(r,i){if(function(a){return ND(a)&&a!==X.ABORTED}(i.code)){const o=r.O_.shift();uo(r).s_(),await zS(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),await uc(r)}}(t,e),qS(t)&&$S(t)}async function ib(t,e){const n=Ie(t);n.asyncQueue.verifyOperationInProgress(),re("RemoteStore","RemoteStore received new credentials");const r=ja(n);n.L_.add(3),await fd(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await Im(n)}async function py(t,e){const n=Ie(t);e?(n.L_.delete(2),await Im(n)):e||(n.L_.add(2),await fd(n),n.q_.set("Unknown"))}function dc(t){return t.K_||(t.K_=function(n,r,i){const o=Ie(n);return o.w_(),new PM(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Eo:LM.bind(null,t),Ro:DM.bind(null,t),mo:MM.bind(null,t),d_:OM.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),i_(t)?r_(t):t.q_.set("Unknown")):(await t.K_.stop(),BS(t))})),t.K_}function uo(t){return t.U_||(t.U_=function(n,r,i){const o=Ie(n);return o.w_(),new CM(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:UM.bind(null,t),mo:qM.bind(null,t),f_:BM.bind(null,t),g_:zM.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await uc(t)):(await t.U_.stop(),t.O_.length>0&&(re("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s_{constructor(e,n,r,i,o){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new fi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,o){const a=Date.now()+r,u=new s_(e,n,a,i,o);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ae(X.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function o_(t,e){if(Vt("AsyncQueue",`${e}: ${t}`),xo(t))return new ae(X.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rl{constructor(e){this.comparator=e?(n,r)=>e(n,r)||ue.comparator(n.key,r.key):(n,r)=>ue.comparator(n.key,r.key),this.keyedMap=Yc(),this.sortedSet=new dt(this.comparator)}static emptySet(e){return new Rl(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Rl)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Rl;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sb{constructor(){this.W_=new dt(ue.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):be():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Ql{constructor(e,n,r,i,o,a,u,d,m){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=a,this.syncStateChanged=u,this.excludesMetadataChanges=d,this.hasCachedResults=m}static fromInitialDocuments(e,n,r,i,o){const a=[];return n.forEach(u=>{a.push({type:0,doc:u})}),new Ql(e,n,Rl.emptySet(n),a,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&pm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $M{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class HM{constructor(){this.queries=ob(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const i=Ie(n),o=i.queries;i.queries=ob(),o.forEach((a,u)=>{for(const d of u.j_)d.onError(r)})})(this,new ae(X.ABORTED,"Firestore shutting down"))}}function ob(){return new wo(t=>zE(t),pm)}async function a_(t,e){const n=Ie(t);let r=3;const i=e.query;let o=n.queries.get(i);o?!o.H_()&&e.J_()&&(r=2):(o=new $M,r=e.J_()?0:1);try{switch(r){case 0:o.z_=await n.onListen(i,!0);break;case 1:o.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(a){const u=o_(a,`Initialization of query '${ol(e.query)}' failed`);return void e.onError(u)}n.queries.set(i,o),o.j_.push(e),e.Z_(n.onlineState),o.z_&&e.X_(o.z_)&&c_(n)}async function l_(t,e){const n=Ie(t),r=e.query;let i=3;const o=n.queries.get(r);if(o){const a=o.j_.indexOf(e);a>=0&&(o.j_.splice(a,1),o.j_.length===0?i=e.J_()?0:1:!o.H_()&&e.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function WM(t,e){const n=Ie(t);let r=!1;for(const i of e){const o=i.query,a=n.queries.get(o);if(a){for(const u of a.j_)u.X_(i)&&(r=!0);a.z_=i}}r&&c_(n)}function GM(t,e,n){const r=Ie(t),i=r.queries.get(e);if(i)for(const o of i.j_)o.onError(n);r.queries.delete(e)}function c_(t){t.Y_.forEach(e=>{e.next()})}var gy,ab;(ab=gy||(gy={})).ea="default",ab.Cache="cache";class u_{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Ql(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=Ql.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==gy.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HS{constructor(e){this.key=e}}class WS{constructor(e){this.key=e}}class KM{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Oe(),this.mutatedKeys=Oe(),this.Aa=$E(e),this.Ra=new Rl(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new sb,i=n?n.Ra:this.Ra;let o=n?n.mutatedKeys:this.mutatedKeys,a=i,u=!1;const d=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,m=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((g,v)=>{const w=i.get(g),E=ud(this.query,v)?v:null,C=!!w&&this.mutatedKeys.has(w.key),P=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let F=!1;w&&E?w.data.isEqual(E.data)?C!==P&&(r.track({type:3,doc:E}),F=!0):this.ga(w,E)||(r.track({type:2,doc:E}),F=!0,(d&&this.Aa(E,d)>0||m&&this.Aa(E,m)<0)&&(u=!0)):!w&&E?(r.track({type:0,doc:E}),F=!0):w&&!E&&(r.track({type:1,doc:w}),F=!0,(d||m)&&(u=!0)),F&&(E?(a=a.add(E),o=P?o.add(g):o.delete(g)):(a=a.delete(g),o=o.delete(g)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const g=this.query.limitType==="F"?a.last():a.first();a=a.delete(g.key),o=o.delete(g.key),r.track({type:1,doc:g})}return{Ra:a,fa:r,ns:u,mutatedKeys:o}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const o=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((g,v)=>function(E,C){const P=F=>{switch(F){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return be()}};return P(E)-P(C)}(g.type,v.type)||this.Aa(g.doc,v.doc)),this.pa(r),i=i!=null&&i;const u=n&&!i?this.ya():[],d=this.da.size===0&&this.current&&!i?1:0,m=d!==this.Ea;return this.Ea=d,a.length!==0||m?{snapshot:new Ql(this.query,e.Ra,o,a,e.mutatedKeys,d===0,m,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:u}:{wa:u}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new sb,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Oe(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new WS(r))}),this.da.forEach(r=>{e.has(r)||n.push(new HS(r))}),n}ba(e){this.Ta=e.Ts,this.da=Oe();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return Ql.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class ZM{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class QM{constructor(e){this.key=e,this.va=!1}}class YM{constructor(e,n,r,i,o,a){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new wo(u=>zE(u),pm),this.Ma=new Map,this.xa=new Set,this.Oa=new dt(ue.comparator),this.Na=new Map,this.La=new J0,this.Ba={},this.ka=new Map,this.qa=ba.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function JM(t,e,n=!0){const r=Em(t);let i;const o=r.Fa.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.Da()):i=await GS(r,e,n,!0),i}async function XM(t,e){const n=Em(t);await GS(n,e,!0,!1)}async function GS(t,e,n,r){const i=await Lf(t.localStore,cr(e)),o=i.targetId,a=t.sharedClientState.addLocalQueryTarget(o,n);let u;return r&&(u=await d_(t,e,o,a==="current",i.resumeToken)),t.isPrimaryClient&&n&&Tm(t.remoteStore,i),u}async function d_(t,e,n,r,i){t.Ka=(v,w,E)=>async function(P,F,N,T){let A=F.view.ma(N);A.ns&&(A=await fy(P.localStore,F.query,!1).then(({documents:I})=>F.view.ma(I,A)));const z=T&&T.targetChanges.get(F.targetId),Z=T&&T.targetMismatches.get(F.targetId)!=null,H=F.view.applyChanges(A,P.isPrimaryClient,z,Z);return yy(P,F.targetId,H.wa),H.snapshot}(t,v,w,E);const o=await fy(t.localStore,e,!0),a=new KM(e,o.Ts),u=a.ma(o.documents),d=hd.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),m=a.applyChanges(u,t.isPrimaryClient,d);yy(t,n,m.wa);const g=new ZM(e,n,a);return t.Fa.set(e,g),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),m.snapshot}async function e4(t,e,n){const r=Ie(t),i=r.Fa.get(e),o=r.Ma.get(i.targetId);if(o.length>1)return r.Ma.set(i.targetId,o.filter(a=>!pm(a,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Kl(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Zl(r.remoteStore,i.targetId),Yl(r,i.targetId)}).catch(vo)):(Yl(r,i.targetId),await Kl(r.localStore,i.targetId,!0))}async function t4(t,e){const n=Ie(t),r=n.Fa.get(e),i=n.Ma.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Zl(n.remoteStore,r.targetId))}async function n4(t,e,n){const r=p_(t);try{const i=await function(a,u){const d=Ie(a),m=Be.now(),g=u.reduce((E,C)=>E.add(C.key),Oe());let v,w;return d.persistence.runTransaction("Locally write mutations","readwrite",E=>{let C=or(),P=Oe();return d.cs.getEntries(E,g).next(F=>{C=F,C.forEach((N,T)=>{T.isValidDocument()||(P=P.add(N))})}).next(()=>d.localDocuments.getOverlayedDocuments(E,C)).next(F=>{v=F;const N=[];for(const T of u){const A=ED(T,v.get(T.key).overlayedDocument);A!=null&&N.push(new as(T.key,A,RE(A.value.mapValue),vn.exists(!0)))}return d.mutationQueue.addMutationBatch(E,m,N,u)}).next(F=>{w=F;const N=F.applyToLocalDocumentSet(v,P);return d.documentOverlayCache.saveOverlays(E,F.batchId,N)})}).then(()=>({batchId:w.batchId,changes:WE(v)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,u,d){let m=a.Ba[a.currentUser.toKey()];m||(m=new dt(De)),m=m.insert(u,d),a.Ba[a.currentUser.toKey()]=m}(r,i.batchId,n),await bo(r,i.changes),await uc(r.remoteStore)}catch(i){const o=o_(i,"Failed to persist write");n.reject(o)}}async function KS(t,e){const n=Ie(t);try{const r=await bM(n.localStore,e);e.targetChanges.forEach((i,o)=>{const a=n.Na.get(o);a&&(Ee(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?Ee(a.va):i.removedDocuments.size>0&&(Ee(a.va),a.va=!1))}),await bo(n,r,e)}catch(r){await vo(r)}}function lb(t,e,n){const r=Ie(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Fa.forEach((o,a)=>{const u=a.view.Z_(e);u.snapshot&&i.push(u.snapshot)}),function(a,u){const d=Ie(a);d.onlineState=u;let m=!1;d.queries.forEach((g,v)=>{for(const w of v.j_)w.Z_(u)&&(m=!0)}),m&&c_(d)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function r4(t,e,n){const r=Ie(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Na.get(e),o=i&&i.key;if(o){let a=new dt(ue.comparator);a=a.insert(o,At.newNoDocument(o,Se.min()));const u=Oe().add(o),d=new dd(Se.min(),new Map,new dt(De),a,u);await KS(r,d),r.Oa=r.Oa.remove(o),r.Na.delete(e),m_(r)}else await Kl(r.localStore,e,!1).then(()=>Yl(r,e,n)).catch(vo)}async function i4(t,e){const n=Ie(t),r=e.batch.batchId;try{const i=await wM(n.localStore,e);f_(n,r,null),h_(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await bo(n,i)}catch(i){await vo(i)}}async function s4(t,e,n){const r=Ie(t);try{const i=await function(a,u){const d=Ie(a);return d.persistence.runTransaction("Reject batch","readwrite-primary",m=>{let g;return d.mutationQueue.lookupMutationBatch(m,u).next(v=>(Ee(v!==null),g=v.keys(),d.mutationQueue.removeMutationBatch(m,v))).next(()=>d.mutationQueue.performConsistencyCheck(m)).next(()=>d.documentOverlayCache.removeOverlaysForBatchId(m,g,u)).next(()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,g)).next(()=>d.localDocuments.getDocuments(m,g))})}(r.localStore,e);f_(r,e,n),h_(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await bo(r,i)}catch(i){await vo(i)}}function h_(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function f_(t,e,n){const r=Ie(t);let i=r.Ba[r.currentUser.toKey()];if(i){const o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function Yl(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||ZS(t,r)})}function ZS(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(Zl(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),m_(t))}function yy(t,e,n){for(const r of n)r instanceof HS?(t.La.addReference(r.key,e),o4(t,r)):r instanceof WS?(re("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||ZS(t,r.key)):be()}function o4(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(re("SyncEngine","New document in limbo: "+n),t.xa.add(r),m_(t))}function m_(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new ue(et.fromString(e)),r=t.qa.next();t.Na.set(r,new QM(n)),t.Oa=t.Oa.insert(n,r),Tm(t.remoteStore,new zi(cr(cd(n.path)),r,"TargetPurposeLimboResolution",Zn.oe))}}async function bo(t,e,n){const r=Ie(t),i=[],o=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((u,d)=>{a.push(r.Ka(d,e,n).then(m=>{var g;if((m||n)&&r.isPrimaryClient){const v=m?!m.fromCache:(g=n==null?void 0:n.targetChanges.get(d.targetId))===null||g===void 0?void 0:g.current;r.sharedClientState.updateQueryState(d.targetId,v?"current":"not-current")}if(m){i.push(m);const v=e_.Wi(d.targetId,m);o.push(v)}}))}),await Promise.all(a),r.Ca.d_(i),await async function(d,m){const g=Ie(d);try{await g.persistence.runTransaction("notifyLocalViewChanges","readwrite",v=>W.forEach(m,w=>W.forEach(w.$i,E=>g.persistence.referenceDelegate.addReference(v,w.targetId,E)).next(()=>W.forEach(w.Ui,E=>g.persistence.referenceDelegate.removeReference(v,w.targetId,E)))))}catch(v){if(!xo(v))throw v;re("LocalStore","Failed to update sequence numbers: "+v)}for(const v of m){const w=v.targetId;if(!v.fromCache){const E=g.os.get(w),C=E.snapshotVersion,P=E.withLastLimboFreeSnapshotVersion(C);g.os=g.os.insert(w,P)}}}(r.localStore,o))}async function a4(t,e){const n=Ie(t);if(!n.currentUser.isEqual(e)){re("SyncEngine","User change. New user:",e.toKey());const r=await AS(n.localStore,e);n.currentUser=e,function(o,a){o.ka.forEach(u=>{u.forEach(d=>{d.reject(new ae(X.CANCELLED,a))})}),o.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await bo(n,r.hs)}}function l4(t,e){const n=Ie(t),r=n.Na.get(e);if(r&&r.va)return Oe().add(r.key);{let i=Oe();const o=n.Ma.get(e);if(!o)return i;for(const a of o){const u=n.Fa.get(a);i=i.unionWith(u.view.Va)}return i}}async function c4(t,e){const n=Ie(t),r=await fy(n.localStore,e.query,!0),i=e.view.ba(r);return n.isPrimaryClient&&yy(n,e.targetId,i.wa),i}async function u4(t,e){const n=Ie(t);return LS(n.localStore,e).then(r=>bo(n,r))}async function d4(t,e,n,r){const i=Ie(t),o=await function(u,d){const m=Ie(u),g=Ie(m.mutationQueue);return m.persistence.runTransaction("Lookup mutation documents","readonly",v=>g.Mn(v,d).next(w=>w?m.localDocuments.getDocuments(v,w):W.resolve(null)))}(i.localStore,e);o!==null?(n==="pending"?await uc(i.remoteStore):n==="acknowledged"||n==="rejected"?(f_(i,e,r||null),h_(i,e),function(u,d){Ie(Ie(u).mutationQueue).On(d)}(i.localStore,e)):be(),await bo(i,o)):re("SyncEngine","Cannot apply mutation batch with id: "+e)}async function h4(t,e){const n=Ie(t);if(Em(n),p_(n),e===!0&&n.Qa!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),i=await cb(n,r.toArray());n.Qa=!0,await py(n.remoteStore,!0);for(const o of i)Tm(n.remoteStore,o)}else if(e===!1&&n.Qa!==!1){const r=[];let i=Promise.resolve();n.Ma.forEach((o,a)=>{n.sharedClientState.isLocalQueryTarget(a)?r.push(a):i=i.then(()=>(Yl(n,a),Kl(n.localStore,a,!0))),Zl(n.remoteStore,a)}),await i,await cb(n,r),function(a){const u=Ie(a);u.Na.forEach((d,m)=>{Zl(u.remoteStore,m)}),u.La.pr(),u.Na=new Map,u.Oa=new dt(ue.comparator)}(n),n.Qa=!1,await py(n.remoteStore,!1)}}async function cb(t,e,n){const r=Ie(t),i=[],o=[];for(const a of e){let u;const d=r.Ma.get(a);if(d&&d.length!==0){u=await Lf(r.localStore,cr(d[0]));for(const m of d){const g=r.Fa.get(m),v=await c4(r,g);v.snapshot&&o.push(v.snapshot)}}else{const m=await jS(r.localStore,a);u=await Lf(r.localStore,m),await d_(r,QS(m),a,!1,u.resumeToken)}i.push(u)}return r.Ca.d_(o),i}function QS(t){return UE(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function f4(t){return function(n){return Ie(Ie(n).persistence).Qi()}(Ie(t).localStore)}async function m4(t,e,n,r){const i=Ie(t);if(i.Qa)return void re("SyncEngine","Ignoring unexpected query state notification.");const o=i.Ma.get(e);if(o&&o.length>0)switch(n){case"current":case"not-current":{const a=await LS(i.localStore,qE(o[0])),u=dd.createSynthesizedRemoteEventForCurrentChange(e,n==="current",Rt.EMPTY_BYTE_STRING);await bo(i,a,u);break}case"rejected":await Kl(i.localStore,e,!0),Yl(i,e,r);break;default:be()}}async function p4(t,e,n){const r=Em(t);if(r.Qa){for(const i of e){if(r.Ma.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){re("SyncEngine","Adding an already active target "+i);continue}const o=await jS(r.localStore,i),a=await Lf(r.localStore,o);await d_(r,QS(o),a.targetId,!1,a.resumeToken),Tm(r.remoteStore,a)}for(const i of n)r.Ma.has(i)&&await Kl(r.localStore,i,!1).then(()=>{Zl(r.remoteStore,i),Yl(r,i)}).catch(vo)}}function Em(t){const e=Ie(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=KS.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=l4.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=r4.bind(null,e),e.Ca.d_=WM.bind(null,e.eventManager),e.Ca.$a=GM.bind(null,e.eventManager),e}function p_(t){const e=Ie(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=i4.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=s4.bind(null,e),e}class Ku{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=km(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return CS(this.persistence,new PS,e.initialUser,this.serializer)}Ga(e){return new SS(bm.Zr,this.serializer)}Wa(e){return new MS}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ku.provider={build:()=>new Ku};class YS extends Ku{constructor(e,n,r){super(),this.Ja=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await p_(this.Ja.syncEngine),await uc(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return CS(this.persistence,new PS,e.initialUser,this.serializer)}ja(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new rM(r,e.asyncQueue,n)}Ha(e,n){const r=new ML(n,this.persistence);return new DL(e.asyncQueue,r)}Ga(e){const n=NS(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?$n.withCacheSize(this.cacheSizeBytes):$n.DEFAULT;return new X0(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,OS(),Bh(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new MS}}class g4 extends YS{constructor(e,n){super(e,n,!1),this.Ja=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.Ja.syncEngine;this.sharedClientState instanceof Vp&&(this.sharedClientState.syncEngine={no:d4.bind(null,n),ro:m4.bind(null,n),io:p4.bind(null,n),Qi:f4.bind(null,n),eo:u4.bind(null,n)},await this.sharedClientState.start()),await this.persistence.yi(async r=>{await h4(this.Ja.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Wa(e){const n=OS();if(!Vp.D(n))throw new ae(X.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=NS(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Vp(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class Zu{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>lb(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=a4.bind(null,this.syncEngine),await py(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new HM}()}createDatastore(e){const n=km(e.databaseInfo.databaseId),r=function(o){return new NM(o)}(e.databaseInfo);return function(o,a,u,d){return new AM(o,a,u,d)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,o,a,u){return new jM(r,i,o,a,u)}(this.localStore,this.datastore,e.asyncQueue,n=>lb(this.syncEngine,n,0),function(){return rb.D()?new rb:new TM}())}createSyncEngine(e,n){return function(i,o,a,u,d,m,g){const v=new YM(i,o,a,u,d,m);return g&&(v.Qa=!0),v}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const o=Ie(i);re("RemoteStore","RemoteStore shutting down."),o.L_.add(5),await fd(o),o.k_.shutdown(),o.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Zu.provider={build:()=>new Zu};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g_{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Vt("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y4{constructor(e,n,r,i,o){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=gn.UNAUTHENTICATED,this.clientId=M0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,async a=>{re("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(re("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new fi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=o_(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Up(t,e){t.asyncQueue.verifyOperationInProgress(),re("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await AS(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function ub(t,e){t.asyncQueue.verifyOperationInProgress();const n=await _4(t);re("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>ib(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>ib(e.remoteStore,i)),t._onlineComponents=e}async function _4(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){re("FirestoreClient","Using user provided OfflineComponentProvider");try{await Up(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===X.FAILED_PRECONDITION||i.code===X.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;Bl("Error using user provided cache. Falling back to memory cache: "+n),await Up(t,new Ku)}}else re("FirestoreClient","Using default OfflineComponentProvider"),await Up(t,new Ku);return t._offlineComponents}async function JS(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(re("FirestoreClient","Using user provided OnlineComponentProvider"),await ub(t,t._uninitializedComponentsProvider._online)):(re("FirestoreClient","Using default OnlineComponentProvider"),await ub(t,new Zu))),t._onlineComponents}function v4(t){return JS(t).then(e=>e.syncEngine)}async function Vf(t){const e=await JS(t),n=e.eventManager;return n.onListen=JM.bind(null,e.syncEngine),n.onUnlisten=e4.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=XM.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=t4.bind(null,e.syncEngine),n}function x4(t,e,n={}){const r=new fi;return t.asyncQueue.enqueueAndForget(async()=>function(o,a,u,d,m){const g=new g_({next:w=>{g.Za(),a.enqueueAndForget(()=>l_(o,v));const E=w.docs.has(u);!E&&w.fromCache?m.reject(new ae(X.UNAVAILABLE,"Failed to get document because the client is offline.")):E&&w.fromCache&&d&&d.source==="server"?m.reject(new ae(X.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(w)},error:w=>m.reject(w)}),v=new u_(cd(u.path),g,{includeMetadataChanges:!0,_a:!0});return a_(o,v)}(await Vf(t),t.asyncQueue,e,n,r)),r.promise}function w4(t,e,n={}){const r=new fi;return t.asyncQueue.enqueueAndForget(async()=>function(o,a,u,d,m){const g=new g_({next:w=>{g.Za(),a.enqueueAndForget(()=>l_(o,v)),w.fromCache&&d.source==="server"?m.reject(new ae(X.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(w)},error:w=>m.reject(w)}),v=new u_(u,g,{includeMetadataChanges:!0,_a:!0});return a_(o,v)}(await Vf(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XS(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const db=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e1(t,e,n){if(!n)throw new ae(X.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function t1(t,e,n,r){if(e===!0&&r===!0)throw new ae(X.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function hb(t){if(!ue.isDocumentKey(t))throw new ae(X.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function fb(t){if(ue.isDocumentKey(t))throw new ae(X.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Sm(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":be()}function er(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ae(X.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Sm(t);throw new ae(X.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mb{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new ae(X.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ae(X.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}t1("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=XS((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new ae(X.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new ae(X.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new ae(X.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class y_{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new mb({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ae(X.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ae(X.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new mb(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new gE;switch(r.type){case"firstParty":return new NL(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ae(X.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=db.get(n);r&&(re("ComponentProvider","Removing Datastore"),db.delete(n),r.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yi{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new yi(this.firestore,e,this._query)}}class an{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ki(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new an(this.firestore,e,this._key)}}class Ki extends yi{constructor(e,n,r){super(e,n,cd(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new an(this.firestore,null,new ue(e))}withConverter(e){return new Ki(this.firestore,e,this._path)}}function sn(t,e,...n){if(t=Xe(t),e1("collection","path",e),t instanceof y_){const r=et.fromString(e,...n);return fb(r),new Ki(t,null,r)}{if(!(t instanceof an||t instanceof Ki))throw new ae(X.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(et.fromString(e,...n));return fb(r),new Ki(t.firestore,null,r)}}function We(t,e,...n){if(t=Xe(t),arguments.length===1&&(e=M0.newId()),e1("doc","path",e),t instanceof y_){const r=et.fromString(e,...n);return hb(r),new an(t,null,new ue(r))}{if(!(t instanceof an||t instanceof Ki))throw new ae(X.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(et.fromString(e,...n));return hb(r),new an(t.firestore,t instanceof Ki?t.converter:null,new ue(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pb{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new VS(this,"async_queue_retry"),this.Vu=()=>{const r=Bh();r&&re("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=Bh();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=Bh();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new fi;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!xo(e))throw e;re("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(a){let u=a.message||"";return a.stack&&(u=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),u}(r);throw Vt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const i=s_.createAndSchedule(this,e,n,r,o=>this.yu(o));return this.Tu.push(i),i}fu(){this.Eu&&be()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function gb(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const o of r)if(o in i&&typeof i[o]=="function")return!0;return!1}(t,["next","error","complete"])}class pi extends y_{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new pb,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new pb(e),this._firestoreClient=void 0,await e}}}function n1(t,e,n){const r=_o(t,"firestore");if(r.isInitialized(n)){const i=r.getImmediate({identifier:n}),o=r.getOptions(n);if(ha(o,e))return i;throw new ae(X.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new ae(X.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ae(X.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:n})}function md(t){if(t._terminated)throw new ae(X.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||b4(t),t._firestoreClient}function b4(t){var e,n,r;const i=t._freezeSettings(),o=function(u,d,m,g){return new rD(u,d,m,g.host,g.ssl,g.experimentalForceLongPolling,g.experimentalAutoDetectLongPolling,XS(g.experimentalLongPollingOptions),g.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new y4(t._authCredentials,t._appCheckCredentials,t._queue,o,t._componentsProvider&&function(u){const d=u==null?void 0:u._online.build();return{_offline:u==null?void 0:u._offline.build(d),_online:d}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ka{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ka(Rt.fromBase64String(e))}catch(n){throw new ae(X.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new ka(Rt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pd{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new ae(X.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new wt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class La{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nm{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new ae(X.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new ae(X.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return De(this._lat,e._lat)||De(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pm{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k4=/^__.*__$/;class I4{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new as(e,this.data,this.fieldMask,n,this.fieldTransforms):new cc(e,this.data,n,this.fieldTransforms)}}class r1{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new as(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function i1(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw be()}}class Cm{constructor(e,n,r,i,o,a){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.vu(),this.fieldTransforms=o||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Cm(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Ff(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(i1(this.Cu)&&k4.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class T4{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||km(e)}Qu(e,n,r,i=!1){return new Cm({Cu:e,methodName:n,qu:r,path:wt.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Am(t){const e=t._freezeSettings(),n=km(t._databaseId);return new T4(t._databaseId,!!e.ignoreUndefinedProperties,n)}function s1(t,e,n,r,i,o={}){const a=t.Qu(o.merge||o.mergeFields?2:0,e,n,i);w_("Data must be an object, but it was:",a,r);const u=a1(r,a);let d,m;if(o.merge)d=new Qn(a.fieldMask),m=a.fieldTransforms;else if(o.mergeFields){const g=[];for(const v of o.mergeFields){const w=_y(e,v,n);if(!a.contains(w))throw new ae(X.INVALID_ARGUMENT,`Field '${w}' is specified in your field mask but missing from your input data.`);c1(g,w)||g.push(w)}d=new Qn(g),m=a.fieldTransforms.filter(v=>d.covers(v.field))}else d=null,m=a.fieldTransforms;return new I4(new _n(u),d,m)}class Rm extends La{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Rm}}function o1(t,e,n){return new Cm({Cu:3,qu:e.settings.qu,methodName:t._methodName,xu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class __ extends La{_toFieldTransform(e){return new ym(e.path,new Wl)}isEqual(e){return e instanceof __}}class v_ extends La{constructor(e,n){super(e),this.Ku=n}_toFieldTransform(e){const n=o1(this,e,!0),r=this.Ku.map(o=>Da(o,n)),i=new _a(r);return new ym(e.path,i)}isEqual(e){return e instanceof v_&&ha(this.Ku,e.Ku)}}class x_ extends La{constructor(e,n){super(e),this.Ku=n}_toFieldTransform(e){const n=o1(this,e,!0),r=this.Ku.map(o=>Da(o,n)),i=new va(r);return new ym(e.path,i)}isEqual(e){return e instanceof x_&&ha(this.Ku,e.Ku)}}function E4(t,e,n,r){const i=t.Qu(1,e,n);w_("Data must be an object, but it was:",i,r);const o=[],a=_n.empty();Ra(r,(d,m)=>{const g=b_(e,d,n);m=Xe(m);const v=i.Nu(g);if(m instanceof Rm)o.push(g);else{const w=Da(m,v);w!=null&&(o.push(g),a.set(g,w))}});const u=new Qn(o);return new r1(a,u,i.fieldTransforms)}function S4(t,e,n,r,i,o){const a=t.Qu(1,e,n),u=[_y(e,r,n)],d=[i];if(o.length%2!=0)throw new ae(X.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let w=0;w<o.length;w+=2)u.push(_y(e,o[w])),d.push(o[w+1]);const m=[],g=_n.empty();for(let w=u.length-1;w>=0;--w)if(!c1(m,u[w])){const E=u[w];let C=d[w];C=Xe(C);const P=a.Nu(E);if(C instanceof Rm)m.push(E);else{const F=Da(C,P);F!=null&&(m.push(E),g.set(E,F))}}const v=new Qn(m);return new r1(g,v,a.fieldTransforms)}function N4(t,e,n,r=!1){return Da(n,t.Qu(r?4:3,e))}function Da(t,e){if(l1(t=Xe(t)))return w_("Unsupported field value:",e,t),a1(t,e);if(t instanceof La)return function(r,i){if(!i1(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const o=[];let a=0;for(const u of r){let d=Da(u,i.Lu(a));d==null&&(d={nullValue:"NULL_VALUE"}),o.push(d),a++}return{arrayValue:{values:o}}}(t,e)}return function(r,i){if((r=Xe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return xD(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const o=Be.fromDate(r);return{timestampValue:Gl(i.serializer,o)}}if(r instanceof Be){const o=new Be(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Gl(i.serializer,o)}}if(r instanceof Nm)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ka)return{bytesValue:sS(i.serializer,r._byteString)};if(r instanceof an){const o=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(o))throw i.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Z0(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Pm)return function(a,u){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(d=>{if(typeof d!="number")throw u.Bu("VectorValues must only contain numeric values.");return $0(u.serializer,d)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${Sm(r)}`)}(t,e)}function a1(t,e){const n={};return NE(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ra(t,(r,i)=>{const o=Da(i,e.Mu(r));o!=null&&(n[r]=o)}),{mapValue:{fields:n}}}function l1(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Be||t instanceof Nm||t instanceof ka||t instanceof an||t instanceof La||t instanceof Pm)}function w_(t,e,n){if(!l1(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=Sm(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function _y(t,e,n){if((e=Xe(e))instanceof pd)return e._internalPath;if(typeof e=="string")return b_(t,e);throw Ff("Field path arguments must be of type string or ",t,!1,void 0,n)}const P4=new RegExp("[~\\*/\\[\\]]");function b_(t,e,n){if(e.search(P4)>=0)throw Ff(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new pd(...e.split("."))._internalPath}catch{throw Ff(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Ff(t,e,n,r,i){const o=r&&!r.isEmpty(),a=i!==void 0;let u=`Function ${e}() called with invalid data`;n&&(u+=" (via `toFirestore()`)"),u+=". ";let d="";return(o||a)&&(d+=" (found",o&&(d+=` in field ${r}`),a&&(d+=` in document ${i}`),d+=")"),new ae(X.INVALID_ARGUMENT,u+t+d)}function c1(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u1{constructor(e,n,r,i,o){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new an(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new C4(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(jm("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class C4 extends u1{data(){return super.data()}}function jm(t,e){return typeof e=="string"?b_(t,e):e instanceof pd?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d1(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ae(X.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class k_{}class Lm extends k_{}function gd(t,e,...n){let r=[];e instanceof k_&&r.push(e),r=r.concat(n),function(o){const a=o.filter(d=>d instanceof Dm).length,u=o.filter(d=>d instanceof yd).length;if(a>1||a>0&&u>0)throw new ae(X.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class yd extends Lm{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new yd(e,n,r)}_apply(e){const n=this._parse(e);return f1(e._query,n),new yi(e.firestore,e.converter,sy(e._query,n))}_parse(e){const n=Am(e.firestore);return function(o,a,u,d,m,g,v){let w;if(m.isKeyField()){if(g==="array-contains"||g==="array-contains-any")throw new ae(X.INVALID_ARGUMENT,`Invalid Query. You can't perform '${g}' queries on documentId().`);if(g==="in"||g==="not-in"){_b(v,g);const E=[];for(const C of v)E.push(yb(d,o,C));w={arrayValue:{values:E}}}else w=yb(d,o,v)}else g!=="in"&&g!=="not-in"&&g!=="array-contains-any"||_b(v,g),w=N4(u,a,v,g==="in"||g==="not-in");return Ge.create(m,g,w)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function I_(t,e,n){const r=e,i=jm("where",t);return yd._create(i,r,n)}class Dm extends k_{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Dm(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:rt.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,o){let a=i;const u=o.getFlattenedFilters();for(const d of u)f1(a,d),a=sy(a,d)}(e._query,n),new yi(e.firestore,e.converter,sy(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Mm extends Lm{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Mm(e,n)}_apply(e){const n=function(i,o,a){if(i.startAt!==null)throw new ae(X.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new ae(X.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Wu(o,a)}(e._query,this._field,this._direction);return new yi(e.firestore,e.converter,function(i,o){const a=i.explicitOrderBy.concat([o]);return new lc(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}function T_(t,e="asc"){const n=e,r=jm("orderBy",t);return Mm._create(r,n)}class Om extends Lm{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new Om(e,n,r)}_apply(e){return new yi(e.firestore,e.converter,Nf(e._query,this._limit,this._limitType))}}function h1(t){return Om._create("limit",t,"F")}function yb(t,e,n){if(typeof(n=Xe(n))=="string"){if(n==="")throw new ae(X.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!BE(e)&&n.indexOf("/")!==-1)throw new ae(X.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(et.fromString(n));if(!ue.isDocumentKey(r))throw new ae(X.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return $u(t,new ue(r))}if(n instanceof an)return $u(t,n._key);throw new ae(X.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Sm(n)}.`)}function _b(t,e){if(!Array.isArray(t)||t.length===0)throw new ae(X.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function f1(t,e){const n=function(i,o){for(const a of i)for(const u of a.getFlattenedFilters())if(o.indexOf(u.op)>=0)return u.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new ae(X.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ae(X.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class m1{convertValue(e,n="none"){switch(ga(e)){case 0:return null;case 1:return e.booleanValue;case 2:return vt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(ao(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw be()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Ra(e,(i,o)=>{r[i]=this.convertValue(o,n)}),r}convertVectorValue(e){var n,r,i;const o=(i=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(a=>vt(a.doubleValue));return new Pm(o)}convertGeoPoint(e){return new Nm(vt(e.latitude),vt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=B0(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(zu(e));default:return null}}convertTimestamp(e){const n=ts(e);return new Be(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=et.fromString(e);Ee(pS(r));const i=new lo(r.get(1),r.get(3)),o=new ue(r.popFirst(5));return i.isEqual(n)||Vt(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p1(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bl{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class E_ extends u1{constructor(e,n,r,i,o,a){super(e,n,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new yu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(jm("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class yu extends E_{data(e={}){return super.data(e)}}class S_{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new bl(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new yu(this._firestore,this._userDataWriter,r.key,r,new bl(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new ae(X.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(u=>{const d=new yu(i._firestore,i._userDataWriter,u.doc.key,u.doc,new bl(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:d,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>o||u.type!==3).map(u=>{const d=new yu(i._firestore,i._userDataWriter,u.doc.key,u.doc,new bl(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);let m=-1,g=-1;return u.type!==0&&(m=a.indexOf(u.doc.key),a=a.delete(u.doc.key)),u.type!==1&&(a=a.add(u.doc),g=a.indexOf(u.doc.key)),{type:A4(u.type),doc:d,oldIndex:m,newIndex:g}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function A4(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return be()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zr(t){t=er(t,an);const e=er(t.firestore,pi);return x4(md(e),t._key).then(n=>g1(e,t,n))}class N_ extends m1{constructor(e){super(),this.firestore=e}convertBytes(e){return new ka(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new an(this.firestore,null,n)}}function Qo(t){t=er(t,yi);const e=er(t.firestore,pi),n=md(e),r=new N_(e);return d1(t._query),w4(n,t._query).then(i=>new S_(e,r,t,i))}function Rn(t,e,n){t=er(t,an);const r=er(t.firestore,pi),i=p1(t.converter,e,n);return _d(r,[s1(Am(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,vn.none())])}function Ia(t,e,n,...r){t=er(t,an);const i=er(t.firestore,pi),o=Am(i);let a;return a=typeof(e=Xe(e))=="string"||e instanceof pd?S4(o,"updateDoc",t._key,e,n,r):E4(o,"updateDoc",t._key,e),_d(i,[a.toMutation(t._key,vn.exists(!0))])}function Vm(t){return _d(er(t.firestore,pi),[new vm(t._key,vn.none())])}function Jl(t,e){const n=er(t.firestore,pi),r=We(t),i=p1(t.converter,e);return _d(n,[s1(Am(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,vn.exists(!1))]).then(()=>r)}function qi(t,...e){var n,r,i;t=Xe(t);let o={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||gb(e[a])||(o=e[a],a++);const u={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(gb(e[a])){const v=e[a];e[a]=(n=v.next)===null||n===void 0?void 0:n.bind(v),e[a+1]=(r=v.error)===null||r===void 0?void 0:r.bind(v),e[a+2]=(i=v.complete)===null||i===void 0?void 0:i.bind(v)}let d,m,g;if(t instanceof an)m=er(t.firestore,pi),g=cd(t._key.path),d={next:v=>{e[a]&&e[a](g1(m,t,v))},error:e[a+1],complete:e[a+2]};else{const v=er(t,yi);m=er(v.firestore,pi),g=v._query;const w=new N_(m);d={next:E=>{e[a]&&e[a](new S_(m,w,v,E))},error:e[a+1],complete:e[a+2]},d1(t._query)}return function(w,E,C,P){const F=new g_(P),N=new u_(E,F,C);return w.asyncQueue.enqueueAndForget(async()=>a_(await Vf(w),N)),()=>{F.Za(),w.asyncQueue.enqueueAndForget(async()=>l_(await Vf(w),N))}}(md(m),g,u,d)}function _d(t,e){return function(r,i){const o=new fi;return r.asyncQueue.enqueueAndForget(async()=>n4(await v4(r),i,o)),o.promise}(md(t),e)}function g1(t,e,n){const r=n.docs.get(e._key),i=new N_(t);return new E_(t,i,e._key,r,new bl(n.hasPendingWrites,n.fromCache),e.converter)}class R4{constructor(e){let n;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),n=e.tabManager):(n=_1(),n._initialize(e)),this._onlineComponentProvider=n._onlineComponentProvider,this._offlineComponentProvider=n._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function y1(t){return new R4(t)}class j4{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Zu.provider,this._offlineComponentProvider={build:n=>new YS(n,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class L4{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Zu.provider,this._offlineComponentProvider={build:n=>new g4(n,e==null?void 0:e.cacheSizeBytes)}}}function _1(t){return new j4(void 0)}function v1(){return new L4}function Uf(){return new __("serverTimestamp")}function x1(...t){return new v_("arrayUnion",t)}function w1(...t){return new x_("arrayRemove",t)}(function(e,n=!0){(function(i){ac=i})(Aa),Nr(new dr("firestore",(r,{instanceIdentifier:i,options:o})=>{const a=r.getProvider("app").getImmediate(),u=new pi(new EL(r.getProvider("auth-internal")),new CL(r.getProvider("app-check-internal")),function(m,g){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new ae(X.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new lo(m.options.projectId,g)}(a,i),a);return o=Object.assign({useFetchStreams:n},o),u._setSettings(o),u},"PUBLIC").setMultipleInstances(!0)),xn(uw,"4.7.3",e),xn(uw,"4.7.3","esm2017")})();const vb=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:m1,Bytes:ka,CollectionReference:Ki,DocumentReference:an,DocumentSnapshot:E_,FieldPath:pd,FieldValue:La,Firestore:pi,FirestoreError:ae,GeoPoint:Nm,Query:yi,QueryCompositeFilterConstraint:Dm,QueryConstraint:Lm,QueryDocumentSnapshot:yu,QueryFieldFilterConstraint:yd,QueryLimitConstraint:Om,QueryOrderByConstraint:Mm,QuerySnapshot:S_,SnapshotMetadata:bl,Timestamp:Be,VectorValue:Pm,_AutoId:M0,_ByteString:Rt,_DatabaseId:lo,_DocumentKey:ue,_EmptyAuthCredentialsProvider:gE,_FieldPath:wt,_cast:er,_logWarn:Bl,_validateIsNotUsedTogether:t1,addDoc:Jl,arrayRemove:w1,arrayUnion:x1,collection:sn,deleteDoc:Vm,doc:We,ensureFirestoreConfigured:md,executeWrite:_d,getDoc:zr,getDocs:Qo,initializeFirestore:n1,limit:h1,onSnapshot:qi,orderBy:T_,persistentLocalCache:y1,persistentMultipleTabManager:v1,persistentSingleTabManager:_1,query:gd,serverTimestamp:Uf,setDoc:Rn,updateDoc:Ia,where:I_},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D4="type.googleapis.com/google.protobuf.Int64Value",M4="type.googleapis.com/google.protobuf.UInt64Value";function b1(t,e){const n={};for(const r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}function vy(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>vy(e));if(typeof t=="function"||typeof t=="object")return b1(t,e=>vy(e));throw new Error("Data cannot be encoded in JSON: "+t)}function Bf(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case D4:case M4:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>Bf(e)):typeof t=="function"||typeof t=="object"?b1(t,e=>Bf(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P_="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xb={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class jl extends Cr{constructor(e,n,r){super(`${P_}/${e}`,n||""),this.details=r}}function O4(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function V4(t,e){let n=O4(t),r=n,i;try{const o=e&&e.error;if(o){const a=o.status;if(typeof a=="string"){if(!xb[a])return new jl("internal","internal");n=xb[a],r=a}const u=o.message;typeof u=="string"&&(r=u),i=o.details,i!==void 0&&(i=Bf(i))}}catch{}return n==="ok"?null:new jl(n,r,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F4{constructor(e,n,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(i=>this.auth=i,()=>{}),this.messaging||n.get().then(i=>this.messaging=i,()=>{}),this.appCheck||r.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),i=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:i}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xy="us-central1";function U4(t){let e=null;return{promise:new Promise((n,r)=>{e=setTimeout(()=>{r(new jl("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class B4{constructor(e,n,r,i,o=xy,a){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new F4(n,r,i),this.cancelAllRequests=new Promise(u=>{this.deleteService=()=>Promise.resolve(u())});try{const u=new URL(o);this.customDomain=u.origin+(u.pathname==="/"?"":u.pathname),this.region=xy}catch{this.customDomain=null,this.region=o}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function z4(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}function q4(t,e,n){return r=>H4(t,e,r,{})}async function $4(t,e,n,r){n["Content-Type"]="application/json";let i;try{i=await r(t,{method:"POST",body:JSON.stringify(e),headers:n})}catch{return{status:0,json:null}}let o=null;try{o=await i.json()}catch{}return{status:i.status,json:o}}function H4(t,e,n,r){const i=t._url(e);return W4(t,i,n,r)}async function W4(t,e,n,r){n=vy(n);const i={data:n},o={},a=await t.contextProvider.getContext(r.limitedUseAppCheckTokens);a.authToken&&(o.Authorization="Bearer "+a.authToken),a.messagingToken&&(o["Firebase-Instance-ID-Token"]=a.messagingToken),a.appCheckToken!==null&&(o["X-Firebase-AppCheck"]=a.appCheckToken);const u=r.timeout||7e4,d=U4(u),m=await Promise.race([$4(e,i,o,t.fetchImpl),d.promise,t.cancelAllRequests]);if(d.cancel(),!m)throw new jl("cancelled","Firebase Functions instance was deleted.");const g=V4(m.status,m.json);if(g)throw g;if(!m.json)throw new jl("internal","Response is not valid JSON object.");let v=m.json.data;if(typeof v>"u"&&(v=m.json.result),typeof v>"u")throw new jl("internal","Response is missing data field.");return{data:Bf(v)}}const wb="@firebase/functions",bb="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G4="auth-internal",K4="app-check-internal",Z4="messaging-internal";function Q4(t,e){const n=(r,{instanceIdentifier:i})=>{const o=r.getProvider("app").getImmediate(),a=r.getProvider(G4),u=r.getProvider(Z4),d=r.getProvider(K4);return new B4(o,a,u,d,i,t)};Nr(new dr(P_,n,"PUBLIC").setMultipleInstances(!0)),xn(wb,bb,e),xn(wb,bb,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ds(t=lm(),e=xy){const r=_o(Xe(t),P_).getImmediate({identifier:e}),i=yT("functions");return i&&Y4(r,...i),r}function Y4(t,e,n){z4(Xe(t),e,n)}function Ms(t,e,n){return q4(Xe(t),e)}Q4(fetch.bind(self));var J4="firebase",X4="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */xn(J4,X4,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k1="firebasestorage.googleapis.com",I1="storageBucket",eO=2*60*1e3,tO=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt extends Cr{constructor(e,n,r=0){super(Bp(e),`Firebase Storage: ${n} (${Bp(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Lt.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Bp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var jt;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(jt||(jt={}));function Bp(t){return"storage/"+t}function C_(){const t="An unknown error occurred, please check the error payload for server response.";return new Lt(jt.UNKNOWN,t)}function nO(t){return new Lt(jt.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function rO(t){return new Lt(jt.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function iO(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Lt(jt.UNAUTHENTICATED,t)}function sO(){return new Lt(jt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function oO(t){return new Lt(jt.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function aO(){return new Lt(jt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function lO(){return new Lt(jt.CANCELED,"User canceled the upload/download.")}function cO(t){return new Lt(jt.INVALID_URL,"Invalid URL '"+t+"'.")}function uO(t){return new Lt(jt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function dO(){return new Lt(jt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+I1+"' property when initializing the app?")}function hO(){return new Lt(jt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function fO(){return new Lt(jt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function mO(t){return new Lt(jt.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function wy(t){return new Lt(jt.INVALID_ARGUMENT,t)}function T1(){return new Lt(jt.APP_DELETED,"The Firebase app was deleted.")}function pO(t){return new Lt(jt.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function _u(t,e){return new Lt(jt.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function Bc(t){throw new Lt(jt.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=ar.makeFromUrl(e,n)}catch{return new ar(e,"")}if(r.path==="")return r;throw uO(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)";function o(z){z.path.charAt(z.path.length-1)==="/"&&(z.path_=z.path_.slice(0,-1))}const a="(/(.*))?$",u=new RegExp("^gs://"+i+a,"i"),d={bucket:1,path:3};function m(z){z.path_=decodeURIComponent(z.path)}const g="v[A-Za-z0-9_]+",v=n.replace(/[.]/g,"\\."),w="(/([^?#]*).*)?$",E=new RegExp(`^https?://${v}/${g}/b/${i}/o${w}`,"i"),C={bucket:1,path:3},P=n===k1?"(?:storage.googleapis.com|storage.cloud.google.com)":n,F="([^?#]*)",N=new RegExp(`^https?://${P}/${i}/${F}`,"i"),A=[{regex:u,indices:d,postModify:o},{regex:E,indices:C,postModify:m},{regex:N,indices:{bucket:1,path:2},postModify:m}];for(let z=0;z<A.length;z++){const Z=A[z],H=Z.regex.exec(e);if(H){const I=H[Z.indices.bucket];let b=H[Z.indices.path];b||(b=""),r=new ar(I,b),Z.postModify(r);break}}if(r==null)throw cO(e);return r}}class gO{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yO(t,e,n){let r=1,i=null,o=null,a=!1,u=0;function d(){return u===2}let m=!1;function g(...F){m||(m=!0,e.apply(null,F))}function v(F){i=setTimeout(()=>{i=null,t(E,d())},F)}function w(){o&&clearTimeout(o)}function E(F,...N){if(m){w();return}if(F){w(),g.call(null,F,...N);return}if(d()||a){w(),g.call(null,F,...N);return}r<64&&(r*=2);let A;u===1?(u=2,A=0):A=(r+Math.random())*1e3,v(A)}let C=!1;function P(F){C||(C=!0,w(),!m&&(i!==null?(F||(u=2),clearTimeout(i),v(0)):F||(u=1)))}return v(0),o=setTimeout(()=>{a=!0,P(!0)},n),P}function _O(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vO(t){return t!==void 0}function xO(t){return typeof t=="object"&&!Array.isArray(t)}function A_(t){return typeof t=="string"||t instanceof String}function kb(t){return R_()&&t instanceof Blob}function R_(){return typeof Blob<"u"}function Ib(t,e,n,r){if(r<e)throw wy(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw wy(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fm(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function E1(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var oa;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(oa||(oa={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wO(t,e){const n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,o=e.indexOf(t)!==-1;return n||i||o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bO{constructor(e,n,r,i,o,a,u,d,m,g,v,w=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=o,this.additionalRetryCodes_=a,this.callback_=u,this.errorCallback_=d,this.timeout_=m,this.progressCallback_=g,this.connectionFactory_=v,this.retry=w,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((E,C)=>{this.resolve_=E,this.reject_=C,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new dh(!1,null,!0));return}const o=this.connectionFactory_();this.pendingConnection_=o;const a=u=>{const d=u.loaded,m=u.lengthComputable?u.total:-1;this.progressCallback_!==null&&this.progressCallback_(d,m)};this.progressCallback_!==null&&o.addUploadProgressListener(a),o.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&o.removeUploadProgressListener(a),this.pendingConnection_=null;const u=o.getErrorCode()===oa.NO_ERROR,d=o.getStatus();if(!u||wO(d,this.additionalRetryCodes_)&&this.retry){const g=o.getErrorCode()===oa.ABORT;r(!1,new dh(!1,null,g));return}const m=this.successCodes_.indexOf(d)!==-1;r(!0,new dh(m,o))})},n=(r,i)=>{const o=this.resolve_,a=this.reject_,u=i.connection;if(i.wasSuccessCode)try{const d=this.callback_(u,u.getResponse());vO(d)?o(d):o()}catch(d){a(d)}else if(u!==null){const d=C_();d.serverResponse=u.getErrorText(),this.errorCallback_?a(this.errorCallback_(u,d)):a(d)}else if(i.canceled){const d=this.appDelete_?T1():lO();a(d)}else{const d=aO();a(d)}};this.canceled_?n(!1,new dh(!1,null,!0)):this.backoffId_=yO(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&_O(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class dh{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function kO(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function IO(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function TO(t,e){e&&(t["X-Firebase-GMPID"]=e)}function EO(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function SO(t,e,n,r,i,o,a=!0){const u=E1(t.urlParams),d=t.url+u,m=Object.assign({},t.headers);return TO(m,e),kO(m,n),IO(m,o),EO(m,r),new bO(d,t.method,m,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NO(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function PO(...t){const e=NO();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(R_())return new Blob(t);throw new Lt(jt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function CO(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AO(t){if(typeof atob>"u")throw mO("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ci={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class zp{constructor(e,n){this.data=e,this.contentType=n||null}}function RO(t,e){switch(t){case ci.RAW:return new zp(S1(e));case ci.BASE64:case ci.BASE64URL:return new zp(N1(t,e));case ci.DATA_URL:return new zp(LO(e),DO(e))}throw C_()}function S1(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const o=r,a=t.charCodeAt(++n);r=65536|(o&1023)<<10|a&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function jO(t){let e;try{e=decodeURIComponent(t)}catch{throw _u(ci.DATA_URL,"Malformed data URL.")}return S1(e)}function N1(t,e){switch(t){case ci.BASE64:{const i=e.indexOf("-")!==-1,o=e.indexOf("_")!==-1;if(i||o)throw _u(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case ci.BASE64URL:{const i=e.indexOf("+")!==-1,o=e.indexOf("/")!==-1;if(i||o)throw _u(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=AO(e)}catch(i){throw i.message.includes("polyfill")?i:_u(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}class P1{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw _u(ci.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=MO(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function LO(t){const e=new P1(t);return e.base64?N1(ci.BASE64,e.rest):jO(e.rest)}function DO(t){return new P1(t).contentType}function MO(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qs{constructor(e,n){let r=0,i="";kb(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,n){if(kb(this.data_)){const r=this.data_,i=CO(r,e,n);return i===null?null:new qs(i)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new qs(r,!0)}}static getBlob(...e){if(R_()){const n=e.map(r=>r instanceof qs?r.data_:r);return new qs(PO.apply(null,n))}else{const n=e.map(a=>A_(a)?RO(ci.RAW,a).data:a.data_);let r=0;n.forEach(a=>{r+=a.byteLength});const i=new Uint8Array(r);let o=0;return n.forEach(a=>{for(let u=0;u<a.length;u++)i[o++]=a[u]}),new qs(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C1(t){let e;try{e=JSON.parse(t)}catch{return null}return xO(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OO(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function VO(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function A1(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FO(t,e){return e}class Cn{constructor(e,n,r,i){this.server=e,this.local=n||e,this.writable=!!r,this.xform=i||FO}}let hh=null;function UO(t){return!A_(t)||t.length<2?t:A1(t)}function R1(){if(hh)return hh;const t=[];t.push(new Cn("bucket")),t.push(new Cn("generation")),t.push(new Cn("metageneration")),t.push(new Cn("name","fullPath",!0));function e(o,a){return UO(a)}const n=new Cn("name");n.xform=e,t.push(n);function r(o,a){return a!==void 0?Number(a):a}const i=new Cn("size");return i.xform=r,t.push(i),t.push(new Cn("timeCreated")),t.push(new Cn("updated")),t.push(new Cn("md5Hash",null,!0)),t.push(new Cn("cacheControl",null,!0)),t.push(new Cn("contentDisposition",null,!0)),t.push(new Cn("contentEncoding",null,!0)),t.push(new Cn("contentLanguage",null,!0)),t.push(new Cn("contentType",null,!0)),t.push(new Cn("metadata","customMetadata",!0)),hh=t,hh}function BO(t,e){function n(){const r=t.bucket,i=t.fullPath,o=new ar(r,i);return e._makeStorageReference(o)}Object.defineProperty(t,"ref",{get:n})}function zO(t,e,n){const r={};r.type="file";const i=n.length;for(let o=0;o<i;o++){const a=n[o];r[a.local]=a.xform(r,e[a.server])}return BO(r,t),r}function j1(t,e,n){const r=C1(e);return r===null?null:zO(t,r,n)}function qO(t,e,n,r){const i=C1(e);if(i===null||!A_(i.downloadTokens))return null;const o=i.downloadTokens;if(o.length===0)return null;const a=encodeURIComponent;return o.split(",").map(m=>{const g=t.bucket,v=t.fullPath,w="/b/"+a(g)+"/o/"+a(v),E=Fm(w,n,r),C=E1({alt:"media",token:m});return E+C})[0]}function $O(t,e){const n={},r=e.length;for(let i=0;i<r;i++){const o=e[i];o.writable&&(n[o.server]=t[o.local])}return JSON.stringify(n)}class j_{constructor(e,n,r,i){this.url=e,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L1(t){if(!t)throw C_()}function HO(t,e){function n(r,i){const o=j1(t,i,e);return L1(o!==null),o}return n}function WO(t,e){function n(r,i){const o=j1(t,i,e);return L1(o!==null),qO(o,i,t.host,t._protocol)}return n}function D1(t){function e(n,r){let i;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?i=sO():i=iO():n.getStatus()===402?i=rO(t.bucket):n.getStatus()===403?i=oO(t.path):i=r,i.status=n.getStatus(),i.serverResponse=r.serverResponse,i}return e}function M1(t){const e=D1(t);function n(r,i){let o=e(r,i);return r.getStatus()===404&&(o=nO(t.path)),o.serverResponse=i.serverResponse,o}return n}function GO(t,e,n){const r=e.fullServerUrl(),i=Fm(r,t.host,t._protocol),o="GET",a=t.maxOperationRetryTime,u=new j_(i,o,WO(t,n),a);return u.errorHandler=M1(e),u}function KO(t,e){const n=e.fullServerUrl(),r=Fm(n,t.host,t._protocol),i="DELETE",o=t.maxOperationRetryTime;function a(d,m){}const u=new j_(r,i,a,o);return u.successCodes=[200,204],u.errorHandler=M1(e),u}function ZO(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function QO(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=ZO(null,e)),r}function YO(t,e,n,r,i){const o=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};function u(){let A="";for(let z=0;z<2;z++)A=A+Math.random().toString().slice(2);return A}const d=u();a["Content-Type"]="multipart/related; boundary="+d;const m=QO(e,r,i),g=$O(m,n),v="--"+d+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+g+`\r
--`+d+`\r
Content-Type: `+m.contentType+`\r
\r
`,w=`\r
--`+d+"--",E=qs.getBlob(v,r,w);if(E===null)throw hO();const C={name:m.fullPath},P=Fm(o,t.host,t._protocol),F="POST",N=t.maxUploadRetryTime,T=new j_(P,F,HO(t,n),N);return T.urlParams=C,T.headers=a,T.body=E.uploadData(),T.errorHandler=D1(e),T}class JO{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=oa.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=oa.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=oa.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,i){if(this.sent_)throw Bc("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Bc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Bc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Bc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Bc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class XO extends JO{initXhr(){this.xhr_.responseType="text"}}function L_(){return new XO}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ta{constructor(e,n){this._service=e,n instanceof ar?this._location=n:this._location=ar.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Ta(e,n)}get root(){const e=new ar(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return A1(this._location.path)}get storage(){return this._service}get parent(){const e=OO(this._location.path);if(e===null)return null;const n=new ar(this._location.bucket,e);return new Ta(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw pO(e)}}function eV(t,e,n){t._throwIfRoot("uploadBytes");const r=YO(t.storage,t._location,R1(),new qs(e,!0),n);return t.storage.makeRequestWithTokens(r,L_).then(i=>({metadata:i,ref:t}))}function tV(t){t._throwIfRoot("getDownloadURL");const e=GO(t.storage,t._location,R1());return t.storage.makeRequestWithTokens(e,L_).then(n=>{if(n===null)throw fO();return n})}function nV(t){t._throwIfRoot("deleteObject");const e=KO(t.storage,t._location);return t.storage.makeRequestWithTokens(e,L_)}function rV(t,e){const n=VO(t._location.path,e),r=new ar(t._location.bucket,n);return new Ta(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iV(t){return/^[A-Za-z]+:\/\//.test(t)}function sV(t,e){return new Ta(t,e)}function O1(t,e){if(t instanceof D_){const n=t;if(n._bucket==null)throw dO();const r=new Ta(n,n._bucket);return e!=null?O1(r,e):r}else return e!==void 0?rV(t,e):t}function oV(t,e){if(e&&iV(e)){if(t instanceof D_)return sV(t,e);throw wy("To use ref(service, url), the first argument must be a Storage instance.")}else return O1(t,e)}function Tb(t,e){const n=e==null?void 0:e[I1];return n==null?null:ar.makeFromBucketSpec(n,t)}function aV(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:zC(i,t.app.options.projectId))}class D_{constructor(e,n,r,i,o){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=o,this._bucket=null,this._host=k1,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=eO,this._maxUploadRetryTime=tO,this._requests=new Set,i!=null?this._bucket=ar.makeFromBucketSpec(i,this._host):this._bucket=Tb(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=ar.makeFromBucketSpec(this._url,e):this._bucket=Tb(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Ib("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Ib("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ta(this,e)}_makeRequest(e,n,r,i,o=!0){if(this._deleted)return new gO(T1());{const a=SO(e,this._appId,r,i,n,this._firebaseVersion,o);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,n){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()}}const Eb="@firebase/storage",Sb="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V1="storage";function Xl(t,e,n){return t=Xe(t),eV(t,e,n)}function ec(t){return t=Xe(t),tV(t)}function F1(t){return t=Xe(t),nV(t)}function ho(t,e){return t=Xe(t),oV(t,e)}function lV(t=lm(),e){t=Xe(t);const r=_o(t,V1).getImmediate({identifier:e}),i=yT("storage");return i&&cV(r,...i),r}function cV(t,e,n,r={}){aV(t,e,n,r)}function uV(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new D_(n,r,i,e,Aa)}function dV(){Nr(new dr(V1,uV,"PUBLIC").setMultipleInstances(!0)),xn(Eb,Sb,""),xn(Eb,Sb,"esm2017")}dV();const U1="@firebase/installations",M_="0.6.9";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B1=1e4,z1=`w:${M_}`,q1="FIS_v2",hV="https://firebaseinstallations.googleapis.com/v1",fV=60*60*1e3,mV="installations",pV="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gV={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Ea=new Ca(mV,pV,gV);function $1(t){return t instanceof Cr&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H1({projectId:t}){return`${hV}/projects/${t}/installations`}function W1(t){return{token:t.token,requestStatus:2,expiresIn:_V(t.expiresIn),creationTime:Date.now()}}async function G1(t,e){const r=(await e.json()).error;return Ea.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function K1({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function yV(t,{refreshToken:e}){const n=K1(t);return n.append("Authorization",vV(e)),n}async function Z1(t){const e=await t();return e.status>=500&&e.status<600?t():e}function _V(t){return Number(t.replace("s","000"))}function vV(t){return`${q1} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xV({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=H1(t),i=K1(t),o=e.getImmediate({optional:!0});if(o){const m=await o.getHeartbeatsHeader();m&&i.append("x-firebase-client",m)}const a={fid:n,authVersion:q1,appId:t.appId,sdkVersion:z1},u={method:"POST",headers:i,body:JSON.stringify(a)},d=await Z1(()=>fetch(r,u));if(d.ok){const m=await d.json();return{fid:m.fid||n,registrationStatus:2,refreshToken:m.refreshToken,authToken:W1(m.authToken)}}else throw await G1("Create Installation",d)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q1(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wV(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bV=/^[cdef][\w-]{21}$/,by="";function kV(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=IV(t);return bV.test(n)?n:by}catch{return by}}function IV(t){return wV(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Um(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y1=new Map;function J1(t,e){const n=Um(t);X1(n,e),TV(n,e)}function X1(t,e){const n=Y1.get(t);if(n)for(const r of n)r(e)}function TV(t,e){const n=EV();n&&n.postMessage({key:t,fid:e}),SV()}let ta=null;function EV(){return!ta&&"BroadcastChannel"in self&&(ta=new BroadcastChannel("[Firebase] FID Change"),ta.onmessage=t=>{X1(t.data.key,t.data.fid)}),ta}function SV(){Y1.size===0&&ta&&(ta.close(),ta=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NV="firebase-installations-database",PV=1,Sa="firebase-installations-store";let qp=null;function O_(){return qp||(qp=am(NV,PV,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Sa)}}})),qp}async function zf(t,e){const n=Um(t),i=(await O_()).transaction(Sa,"readwrite"),o=i.objectStore(Sa),a=await o.get(n);return await o.put(e,n),await i.done,(!a||a.fid!==e.fid)&&J1(t,e.fid),e}async function eN(t){const e=Um(t),r=(await O_()).transaction(Sa,"readwrite");await r.objectStore(Sa).delete(e),await r.done}async function Bm(t,e){const n=Um(t),i=(await O_()).transaction(Sa,"readwrite"),o=i.objectStore(Sa),a=await o.get(n),u=e(a);return u===void 0?await o.delete(n):await o.put(u,n),await i.done,u&&(!a||a.fid!==u.fid)&&J1(t,u.fid),u}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function V_(t){let e;const n=await Bm(t.appConfig,r=>{const i=CV(r),o=AV(t,i);return e=o.registrationPromise,o.installationEntry});return n.fid===by?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function CV(t){const e=t||{fid:kV(),registrationStatus:0};return tN(e)}function AV(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(Ea.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=RV(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:jV(t)}:{installationEntry:e}}async function RV(t,e){try{const n=await xV(t,e);return zf(t.appConfig,n)}catch(n){throw $1(n)&&n.customData.serverCode===409?await eN(t.appConfig):await zf(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function jV(t){let e=await Nb(t.appConfig);for(;e.registrationStatus===1;)await Q1(100),e=await Nb(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await V_(t);return r||n}return e}function Nb(t){return Bm(t,e=>{if(!e)throw Ea.create("installation-not-found");return tN(e)})}function tN(t){return LV(t)?{fid:t.fid,registrationStatus:0}:t}function LV(t){return t.registrationStatus===1&&t.registrationTime+B1<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DV({appConfig:t,heartbeatServiceProvider:e},n){const r=MV(t,n),i=yV(t,n),o=e.getImmediate({optional:!0});if(o){const m=await o.getHeartbeatsHeader();m&&i.append("x-firebase-client",m)}const a={installation:{sdkVersion:z1,appId:t.appId}},u={method:"POST",headers:i,body:JSON.stringify(a)},d=await Z1(()=>fetch(r,u));if(d.ok){const m=await d.json();return W1(m)}else throw await G1("Generate Auth Token",d)}function MV(t,{fid:e}){return`${H1(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F_(t,e=!1){let n;const r=await Bm(t.appConfig,o=>{if(!nN(o))throw Ea.create("not-registered");const a=o.authToken;if(!e&&FV(a))return o;if(a.requestStatus===1)return n=OV(t,e),o;{if(!navigator.onLine)throw Ea.create("app-offline");const u=BV(o);return n=VV(t,u),u}});return n?await n:r.authToken}async function OV(t,e){let n=await Pb(t.appConfig);for(;n.authToken.requestStatus===1;)await Q1(100),n=await Pb(t.appConfig);const r=n.authToken;return r.requestStatus===0?F_(t,e):r}function Pb(t){return Bm(t,e=>{if(!nN(e))throw Ea.create("not-registered");const n=e.authToken;return zV(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function VV(t,e){try{const n=await DV(t,e),r=Object.assign(Object.assign({},e),{authToken:n});return await zf(t.appConfig,r),n}catch(n){if($1(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await eN(t.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await zf(t.appConfig,r)}throw n}}function nN(t){return t!==void 0&&t.registrationStatus===2}function FV(t){return t.requestStatus===2&&!UV(t)}function UV(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+fV}function BV(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function zV(t){return t.requestStatus===1&&t.requestTime+B1<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qV(t){const e=t,{installationEntry:n,registrationPromise:r}=await V_(e);return r?r.catch(console.error):F_(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $V(t,e=!1){const n=t;return await HV(n),(await F_(n,e)).token}async function HV(t){const{registrationPromise:e}=await V_(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WV(t){if(!t||!t.options)throw $p("App Configuration");if(!t.name)throw $p("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw $p(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function $p(t){return Ea.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rN="installations",GV="installations-internal",KV=t=>{const e=t.getProvider("app").getImmediate(),n=WV(e),r=_o(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},ZV=t=>{const e=t.getProvider("app").getImmediate(),n=_o(e,rN).getImmediate();return{getId:()=>qV(n),getToken:i=>$V(n,i)}};function QV(){Nr(new dr(rN,KV,"PUBLIC")),Nr(new dr(GV,ZV,"PRIVATE"))}QV();xn(U1,M_);xn(U1,M_,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YV="/firebase-messaging-sw.js",JV="/firebase-cloud-messaging-push-scope",iN="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",XV="https://fcmregistrations.googleapis.com/v1",sN="google.c.a.c_id",e5="google.c.a.c_l",t5="google.c.a.ts",n5="google.c.a.e";var Cb;(function(t){t[t.DATA_MESSAGE=1]="DATA_MESSAGE",t[t.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(Cb||(Cb={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var Qu;(function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"})(Qu||(Qu={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Li(t){const e=new Uint8Array(t);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function r5(t){const e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(n),i=new Uint8Array(r.length);for(let o=0;o<r.length;++o)i[o]=r.charCodeAt(o);return i}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hp="fcm_token_details_db",i5=5,Ab="fcm_token_object_Store";async function s5(t){if("databases"in indexedDB&&!(await indexedDB.databases()).map(o=>o.name).includes(Hp))return null;let e=null;return(await am(Hp,i5,{upgrade:async(r,i,o,a)=>{var u;if(i<2||!r.objectStoreNames.contains(Ab))return;const d=a.objectStore(Ab),m=await d.index("fcmSenderId").get(t);if(await d.clear(),!!m){if(i===2){const g=m;if(!g.auth||!g.p256dh||!g.endpoint)return;e={token:g.fcmToken,createTime:(u=g.createTime)!==null&&u!==void 0?u:Date.now(),subscriptionOptions:{auth:g.auth,p256dh:g.p256dh,endpoint:g.endpoint,swScope:g.swScope,vapidKey:typeof g.vapidKey=="string"?g.vapidKey:Li(g.vapidKey)}}}else if(i===3){const g=m;e={token:g.fcmToken,createTime:g.createTime,subscriptionOptions:{auth:Li(g.auth),p256dh:Li(g.p256dh),endpoint:g.endpoint,swScope:g.swScope,vapidKey:Li(g.vapidKey)}}}else if(i===4){const g=m;e={token:g.fcmToken,createTime:g.createTime,subscriptionOptions:{auth:Li(g.auth),p256dh:Li(g.p256dh),endpoint:g.endpoint,swScope:g.swScope,vapidKey:Li(g.vapidKey)}}}}}})).close(),await Cp(Hp),await Cp("fcm_vapid_details_db"),await Cp("undefined"),o5(e)?e:null}function o5(t){if(!t||!t.subscriptionOptions)return!1;const{subscriptionOptions:e}=t;return typeof t.createTime=="number"&&t.createTime>0&&typeof t.token=="string"&&t.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a5="firebase-messaging-database",l5=1,Yu="firebase-messaging-store";let Wp=null;function oN(){return Wp||(Wp=am(a5,l5,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Yu)}}})),Wp}async function c5(t){const e=aN(t),r=await(await oN()).transaction(Yu).objectStore(Yu).get(e);if(r)return r;{const i=await s5(t.appConfig.senderId);if(i)return await U_(t,i),i}}async function U_(t,e){const n=aN(t),i=(await oN()).transaction(Yu,"readwrite");return await i.objectStore(Yu).put(e,n),await i.done,e}function aN({appConfig:t}){return t.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u5={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},wn=new Ca("messaging","Messaging",u5);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function d5(t,e){const n=await z_(t),r=lN(e),i={method:"POST",headers:n,body:JSON.stringify(r)};let o;try{o=await(await fetch(B_(t.appConfig),i)).json()}catch(a){throw wn.create("token-subscribe-failed",{errorInfo:a==null?void 0:a.toString()})}if(o.error){const a=o.error.message;throw wn.create("token-subscribe-failed",{errorInfo:a})}if(!o.token)throw wn.create("token-subscribe-no-token");return o.token}async function h5(t,e){const n=await z_(t),r=lN(e.subscriptionOptions),i={method:"PATCH",headers:n,body:JSON.stringify(r)};let o;try{o=await(await fetch(`${B_(t.appConfig)}/${e.token}`,i)).json()}catch(a){throw wn.create("token-update-failed",{errorInfo:a==null?void 0:a.toString()})}if(o.error){const a=o.error.message;throw wn.create("token-update-failed",{errorInfo:a})}if(!o.token)throw wn.create("token-update-no-token");return o.token}async function f5(t,e){const r={method:"DELETE",headers:await z_(t)};try{const o=await(await fetch(`${B_(t.appConfig)}/${e}`,r)).json();if(o.error){const a=o.error.message;throw wn.create("token-unsubscribe-failed",{errorInfo:a})}}catch(i){throw wn.create("token-unsubscribe-failed",{errorInfo:i==null?void 0:i.toString()})}}function B_({projectId:t}){return`${XV}/projects/${t}/registrations`}async function z_({appConfig:t,installations:e}){const n=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function lN({p256dh:t,auth:e,endpoint:n,vapidKey:r}){const i={web:{endpoint:n,auth:e,p256dh:t}};return r!==iN&&(i.web.applicationPubKey=r),i}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m5=7*24*60*60*1e3;async function p5(t){const e=await y5(t.swRegistration,t.vapidKey),n={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:e.endpoint,auth:Li(e.getKey("auth")),p256dh:Li(e.getKey("p256dh"))},r=await c5(t.firebaseDependencies);if(r){if(_5(r.subscriptionOptions,n))return Date.now()>=r.createTime+m5?g5(t,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await f5(t.firebaseDependencies,r.token)}catch(i){console.warn(i)}return Rb(t.firebaseDependencies,n)}else return Rb(t.firebaseDependencies,n)}async function g5(t,e){try{const n=await h5(t.firebaseDependencies,e),r=Object.assign(Object.assign({},e),{token:n,createTime:Date.now()});return await U_(t.firebaseDependencies,r),n}catch(n){throw n}}async function Rb(t,e){const r={token:await d5(t,e),createTime:Date.now(),subscriptionOptions:e};return await U_(t,r),r.token}async function y5(t,e){const n=await t.pushManager.getSubscription();return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:r5(e)})}function _5(t,e){const n=e.vapidKey===t.vapidKey,r=e.endpoint===t.endpoint,i=e.auth===t.auth,o=e.p256dh===t.p256dh;return n&&r&&i&&o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jb(t){const e={from:t.from,collapseKey:t.collapse_key,messageId:t.fcmMessageId};return v5(e,t),x5(e,t),w5(e,t),e}function v5(t,e){if(!e.notification)return;t.notification={};const n=e.notification.title;n&&(t.notification.title=n);const r=e.notification.body;r&&(t.notification.body=r);const i=e.notification.image;i&&(t.notification.image=i);const o=e.notification.icon;o&&(t.notification.icon=o)}function x5(t,e){e.data&&(t.data=e.data)}function w5(t,e){var n,r,i,o,a;if(!e.fcmOptions&&!(!((n=e.notification)===null||n===void 0)&&n.click_action))return;t.fcmOptions={};const u=(i=(r=e.fcmOptions)===null||r===void 0?void 0:r.link)!==null&&i!==void 0?i:(o=e.notification)===null||o===void 0?void 0:o.click_action;u&&(t.fcmOptions.link=u);const d=(a=e.fcmOptions)===null||a===void 0?void 0:a.analytics_label;d&&(t.fcmOptions.analyticsLabel=d)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b5(t){return typeof t=="object"&&!!t&&sN in t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k5(t){if(!t||!t.options)throw Gp("App Configuration Object");if(!t.name)throw Gp("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:n}=t;for(const r of e)if(!n[r])throw Gp(r);return{appName:t.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}function Gp(t){return wn.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I5{constructor(e,n,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const i=k5(e);this.firebaseDependencies={app:e,appConfig:i,installations:n,analyticsProvider:r}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function T5(t){try{t.swRegistration=await navigator.serviceWorker.register(YV,{scope:JV}),t.swRegistration.update().catch(()=>{})}catch(e){throw wn.create("failed-service-worker-registration",{browserErrorMessage:e==null?void 0:e.message})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function E5(t,e){if(!e&&!t.swRegistration&&await T5(t),!(!e&&t.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw wn.create("invalid-sw-registration");t.swRegistration=e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function S5(t,e){e?t.vapidKey=e:t.vapidKey||(t.vapidKey=iN)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cN(t,e){if(!navigator)throw wn.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw wn.create("permission-blocked");return await S5(t,e==null?void 0:e.vapidKey),await E5(t,e==null?void 0:e.serviceWorkerRegistration),p5(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function N5(t,e,n){const r=P5(e);(await t.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:n[sN],message_name:n[e5],message_time:n[t5],message_device_time:Math.floor(Date.now()/1e3)})}function P5(t){switch(t){case Qu.NOTIFICATION_CLICKED:return"notification_open";case Qu.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function C5(t,e){const n=e.data;if(!n.isFirebaseMessaging)return;t.onMessageHandler&&n.messageType===Qu.PUSH_RECEIVED&&(typeof t.onMessageHandler=="function"?t.onMessageHandler(jb(n)):t.onMessageHandler.next(jb(n)));const r=n.data;b5(r)&&r[n5]==="1"&&await N5(t,n.messageType,r)}const Lb="@firebase/messaging",Db="0.12.12";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A5=t=>{const e=new I5(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),t.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",n=>C5(e,n)),e},R5=t=>{const e=t.getProvider("messaging").getImmediate();return{getToken:r=>cN(e,r)}};function j5(){Nr(new dr("messaging",A5,"PUBLIC")),Nr(new dr("messaging-internal",R5,"PRIVATE")),xn(Lb,Db),xn(Lb,Db,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uN(){try{await wT()}catch{return!1}return typeof window<"u"&&w0()&&ZC()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L5(t,e){if(!navigator)throw wn.create("only-available-in-window");return t.onMessageHandler=e,()=>{t.onMessageHandler=null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D5(t=lm()){return uN().then(e=>{if(!e)throw wn.create("unsupported-browser")},e=>{throw wn.create("indexed-db-unsupported")}),_o(Xe(t),"messaging").getImmediate()}async function M5(t,e){return t=Xe(t),cN(t,e)}function Mb(t,e){return t=Xe(t),L5(t,e)}j5();const O5={apiKey:"AIzaSyCWp0X6bLJBsyYKTjUaVsXBSuVD8KeeEqY",authDomain:"carnival-planner.firebaseapp.com",projectId:"carnival-planner",storageBucket:"carnival-planner.firebasestorage.app",messagingSenderId:"1036340118282",appId:"1:1036340118282:web:809dc12c298ff1b8f2f0f3",measurementId:"G-XC1K69PSVC"},kr=IT(O5),Ks=kL(kr),Ne=n1(kr,{localCache:y1({tabManager:v1()})},"squad-db"),fo=lV(kr);Promise.resolve(!0);console.log("Firestore initialized");let $i=null;const q_=async()=>{try{return await uN()?($i=D5(kr),console.log("Firebase Messaging initialized"),$i):(console.log("Firebase Messaging not supported in this browser"),null)}catch(t){return console.log("Error initializing Firebase Messaging:",t),null}},V5=async t=>{try{if(await Notification.requestPermission()!=="granted")return console.log("Notification permission denied"),null;if($i||await q_(),!$i)return null;const n=await M5($i,{vapidKey:t});return console.log("FCM Token:",n),n}catch(e){return console.log("Error getting FCM token:",e),null}},F5=t=>{$i?Mb($i,t):q_().then(()=>{$i&&Mb($i,t)})};q_();const fh="/assets/carnival-logo-CBA9n7vt.png",Kp=[{name:"Sugar Mas (St. Kitts)",date:"2026-01-01"},{name:"St. Croix Carnival",date:"2026-01-03"},{name:"Carnaval Ponceno (Puerto Rico)",date:"2026-02-12"},{name:"Aruba Carnival",date:"2026-02-14"},{name:"Barranquilla Carnival (Colombia)",date:"2026-02-14"},{name:"Martinique Carnival",date:"2026-02-15"},{name:"Rio Carnival (Brazil)",date:"2026-02-15"},{name:"Carnaval De Saint-Martin",date:"2026-02-15"},{name:"Mas Domnik (Dominica)",date:"2026-02-16"},{name:"Carriacou & Petite Martinique",date:"2026-02-16"},{name:"Venezuela Carnival",date:"2026-02-16"},{name:"Trinidad Carnival",date:"2026-02-16"},{name:"Guyana Mashramani",date:"2026-02-23"},{name:"Carnaval De San Pedro (Belize)",date:"2026-02-23"},{name:"Cape Town Carnival (South Africa)",date:"2026-03-21"},{name:"Virgin Gorda Easter Festival",date:"2026-04-05"},{name:"Jamaica Carnival",date:"2026-04-12"},{name:"Tampa Bay Carnival (USA)",date:"2026-04-18"},{name:"St. Maarten Carnival",date:"2026-04-30"},{name:"St. Thomas Carnival (USVI)",date:"2026-05-02"},{name:"Cayman Carnival Batabano",date:"2026-05-09"},{name:"Braccanal (Cayman Islands)",date:"2026-05-13"},{name:"Berlin Carnival (Germany)",date:"2026-05-22"},{name:"Atlanta Caribbean Carnival",date:"2026-05-23"},{name:"Aalborg Karneval (Denmark)",date:"2026-05-23"},{name:"Orlando Carnival",date:"2026-05-24"},{name:"Luton International Carnival (UK)",date:"2026-05-24"},{name:"Guyana Independence",date:"2026-05-26"},{name:"Munich Carnival (Germany)",date:"2026-06-04"},{name:"Bahamas Carnival",date:"2026-06-06"},{name:"South Carolina Carnival",date:"2026-06-11"},{name:"Bermuda Carnival",date:"2026-06-15"},{name:"Hollywood Carnival (USA)",date:"2026-06-20"},{name:"Caymas Carnival (Cayman Islands)",date:"2026-06-20"},{name:"Philadelphia Carnival",date:"2026-06-20"},{name:"Vienna Carnival (Austria)",date:"2026-06-26"},{name:"Vincy Mas (St. Vincent)",date:"2026-07-06"},{name:"Saint Lucia Carnival",date:"2026-07-20"},{name:"Anguilla Summer Festival",date:"2026-07-24"},{name:"Zomercarnaval (Rotterdam)",date:"2026-07-25"},{name:"Toronto Caribbean Carnival (Caribana)",date:"2026-08-01"},{name:"Crop Over (Barbados)",date:"2026-08-03"},{name:"Antigua Carnival",date:"2026-08-03"},{name:"Nevis Culturama Festival",date:"2026-08-04"},{name:"Cariwest (Canada)",date:"2026-08-07"},{name:"Spice Mas (Grenada)",date:"2026-08-10"},{name:"Notting Hill Carnival (London)",date:"2026-08-31"},{name:"New York Carnival (Labor Day)",date:"2026-09-07"},{name:"Japan Caribbean Carnival",date:"2026-09-23"},{name:"Miami Carnival",date:"2026-10-11"},{name:"Tobago Carnival",date:"2026-11-01"}];function dN(t,e){const n=U.useRef(e);U.useEffect(function(){e!==n.current&&t.attributionControl!=null&&(n.current!=null&&t.attributionControl.removeAttribution(n.current),e!=null&&t.attributionControl.addAttribution(e)),n.current=e},[t,e])}const U5=1;function B5(t){return Object.freeze({__version:U5,map:t})}function z5(t,e){return Object.freeze({...t,...e})}const hN=U.createContext(null),fN=hN.Provider;function $_(){const t=U.useContext(hN);if(t==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return t}function q5(t){function e(n,r){const{instance:i,context:o}=t(n).current;return U.useImperativeHandle(r,()=>i),n.children==null?null:Hh.createElement(fN,{value:o},n.children)}return U.forwardRef(e)}function $5(t){function e(n,r){const[i,o]=U.useState(!1),{instance:a}=t(n,o).current;U.useImperativeHandle(r,()=>a),U.useEffect(function(){i&&a.update()},[a,i,n.children]);const u=a._contentNode;return u?hT.createPortal(n.children,u):null}return U.forwardRef(e)}function H5(t){function e(n,r){const{instance:i}=t(n).current;return U.useImperativeHandle(r,()=>i),null}return U.forwardRef(e)}function mN(t,e){const n=U.useRef();U.useEffect(function(){return e!=null&&t.instance.on(e),n.current=e,function(){n.current!=null&&t.instance.off(n.current),n.current=null}},[t,e])}function H_(t,e){const n=t.pane??e.pane;return n?{...t,pane:n}:t}function W5(t,e){return function(r,i){const o=$_(),a=t(H_(r,o),o);return dN(o.map,r.attribution),mN(a.current,r.eventHandlers),e(a.current,o,r,i),a}}var ky={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(t,e){(function(n,r){r(e)})(o2,function(n){var r="1.9.4";function i(s){var c,f,p,_;for(f=1,p=arguments.length;f<p;f++){_=arguments[f];for(c in _)s[c]=_[c]}return s}var o=Object.create||function(){function s(){}return function(c){return s.prototype=c,new s}}();function a(s,c){var f=Array.prototype.slice;if(s.bind)return s.bind.apply(s,f.call(arguments,1));var p=f.call(arguments,2);return function(){return s.apply(c,p.length?p.concat(f.call(arguments)):arguments)}}var u=0;function d(s){return"_leaflet_id"in s||(s._leaflet_id=++u),s._leaflet_id}function m(s,c,f){var p,_,k,V;return V=function(){p=!1,_&&(k.apply(f,_),_=!1)},k=function(){p?_=arguments:(s.apply(f,arguments),setTimeout(V,c),p=!0)},k}function g(s,c,f){var p=c[1],_=c[0],k=p-_;return s===p&&f?s:((s-_)%k+k)%k+_}function v(){return!1}function w(s,c){if(c===!1)return s;var f=Math.pow(10,c===void 0?6:c);return Math.round(s*f)/f}function E(s){return s.trim?s.trim():s.replace(/^\s+|\s+$/g,"")}function C(s){return E(s).split(/\s+/)}function P(s,c){Object.prototype.hasOwnProperty.call(s,"options")||(s.options=s.options?o(s.options):{});for(var f in c)s.options[f]=c[f];return s.options}function F(s,c,f){var p=[];for(var _ in s)p.push(encodeURIComponent(f?_.toUpperCase():_)+"="+encodeURIComponent(s[_]));return(!c||c.indexOf("?")===-1?"?":"&")+p.join("&")}var N=/\{ *([\w_ -]+) *\}/g;function T(s,c){return s.replace(N,function(f,p){var _=c[p];if(_===void 0)throw new Error("No value provided for variable "+f);return typeof _=="function"&&(_=_(c)),_})}var A=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"};function z(s,c){for(var f=0;f<s.length;f++)if(s[f]===c)return f;return-1}var Z="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function H(s){return window["webkit"+s]||window["moz"+s]||window["ms"+s]}var I=0;function b(s){var c=+new Date,f=Math.max(0,16-(c-I));return I=c+f,window.setTimeout(s,f)}var R=window.requestAnimationFrame||H("RequestAnimationFrame")||b,D=window.cancelAnimationFrame||H("CancelAnimationFrame")||H("CancelRequestAnimationFrame")||function(s){window.clearTimeout(s)};function O(s,c,f){if(f&&R===b)s.call(c);else return R.call(window,a(s,c))}function B(s){s&&D.call(window,s)}var M={__proto__:null,extend:i,create:o,bind:a,get lastId(){return u},stamp:d,throttle:m,wrapNum:g,falseFn:v,formatNum:w,trim:E,splitWords:C,setOptions:P,getParamString:F,template:T,isArray:A,indexOf:z,emptyImageUrl:Z,requestFn:R,cancelFn:D,requestAnimFrame:O,cancelAnimFrame:B};function ee(){}ee.extend=function(s){var c=function(){P(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},f=c.__super__=this.prototype,p=o(f);p.constructor=c,c.prototype=p;for(var _ in this)Object.prototype.hasOwnProperty.call(this,_)&&_!=="prototype"&&_!=="__super__"&&(c[_]=this[_]);return s.statics&&i(c,s.statics),s.includes&&(ce(s.includes),i.apply(null,[p].concat(s.includes))),i(p,s),delete p.statics,delete p.includes,p.options&&(p.options=f.options?o(f.options):{},i(p.options,s.options)),p._initHooks=[],p.callInitHooks=function(){if(!this._initHooksCalled){f.callInitHooks&&f.callInitHooks.call(this),this._initHooksCalled=!0;for(var k=0,V=p._initHooks.length;k<V;k++)p._initHooks[k].call(this)}},c},ee.include=function(s){var c=this.prototype.options;return i(this.prototype,s),s.options&&(this.prototype.options=c,this.mergeOptions(s.options)),this},ee.mergeOptions=function(s){return i(this.prototype.options,s),this},ee.addInitHook=function(s){var c=Array.prototype.slice.call(arguments,1),f=typeof s=="function"?s:function(){this[s].apply(this,c)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(f),this};function ce(s){if(!(typeof L>"u"||!L||!L.Mixin)){s=A(s)?s:[s];for(var c=0;c<s.length;c++)s[c]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var me={on:function(s,c,f){if(typeof s=="object")for(var p in s)this._on(p,s[p],c);else{s=C(s);for(var _=0,k=s.length;_<k;_++)this._on(s[_],c,f)}return this},off:function(s,c,f){if(!arguments.length)delete this._events;else if(typeof s=="object")for(var p in s)this._off(p,s[p],c);else{s=C(s);for(var _=arguments.length===1,k=0,V=s.length;k<V;k++)_?this._off(s[k]):this._off(s[k],c,f)}return this},_on:function(s,c,f,p){if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}if(this._listens(s,c,f)===!1){f===this&&(f=void 0);var _={fn:c,ctx:f};p&&(_.once=!0),this._events=this._events||{},this._events[s]=this._events[s]||[],this._events[s].push(_)}},_off:function(s,c,f){var p,_,k;if(this._events&&(p=this._events[s],!!p)){if(arguments.length===1){if(this._firingCount)for(_=0,k=p.length;_<k;_++)p[_].fn=v;delete this._events[s];return}if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}var V=this._listens(s,c,f);if(V!==!1){var $=p[V];this._firingCount&&($.fn=v,this._events[s]=p=p.slice()),p.splice(V,1)}}},fire:function(s,c,f){if(!this.listens(s,f))return this;var p=i({},c,{type:s,target:this,sourceTarget:c&&c.sourceTarget||this});if(this._events){var _=this._events[s];if(_){this._firingCount=this._firingCount+1||1;for(var k=0,V=_.length;k<V;k++){var $=_[k],Y=$.fn;$.once&&this.off(s,Y,$.ctx),Y.call($.ctx||this,p)}this._firingCount--}}return f&&this._propagateEvent(p),this},listens:function(s,c,f,p){typeof s!="string"&&console.warn('"string" type argument expected');var _=c;typeof c!="function"&&(p=!!c,_=void 0,f=void 0);var k=this._events&&this._events[s];if(k&&k.length&&this._listens(s,_,f)!==!1)return!0;if(p){for(var V in this._eventParents)if(this._eventParents[V].listens(s,c,f,p))return!0}return!1},_listens:function(s,c,f){if(!this._events)return!1;var p=this._events[s]||[];if(!c)return!!p.length;f===this&&(f=void 0);for(var _=0,k=p.length;_<k;_++)if(p[_].fn===c&&p[_].ctx===f)return _;return!1},once:function(s,c,f){if(typeof s=="object")for(var p in s)this._on(p,s[p],c,!0);else{s=C(s);for(var _=0,k=s.length;_<k;_++)this._on(s[_],c,f,!0)}return this},addEventParent:function(s){return this._eventParents=this._eventParents||{},this._eventParents[d(s)]=s,this},removeEventParent:function(s){return this._eventParents&&delete this._eventParents[d(s)],this},_propagateEvent:function(s){for(var c in this._eventParents)this._eventParents[c].fire(s.type,i({layer:s.target,propagatedFrom:s.target},s),!0)}};me.addEventListener=me.on,me.removeEventListener=me.clearAllEventListeners=me.off,me.addOneTimeEventListener=me.once,me.fireEvent=me.fire,me.hasEventListeners=me.listens;var we=ee.extend(me);function G(s,c,f){this.x=f?Math.round(s):s,this.y=f?Math.round(c):c}var le=Math.trunc||function(s){return s>0?Math.floor(s):Math.ceil(s)};G.prototype={clone:function(){return new G(this.x,this.y)},add:function(s){return this.clone()._add(te(s))},_add:function(s){return this.x+=s.x,this.y+=s.y,this},subtract:function(s){return this.clone()._subtract(te(s))},_subtract:function(s){return this.x-=s.x,this.y-=s.y,this},divideBy:function(s){return this.clone()._divideBy(s)},_divideBy:function(s){return this.x/=s,this.y/=s,this},multiplyBy:function(s){return this.clone()._multiplyBy(s)},_multiplyBy:function(s){return this.x*=s,this.y*=s,this},scaleBy:function(s){return new G(this.x*s.x,this.y*s.y)},unscaleBy:function(s){return new G(this.x/s.x,this.y/s.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=le(this.x),this.y=le(this.y),this},distanceTo:function(s){s=te(s);var c=s.x-this.x,f=s.y-this.y;return Math.sqrt(c*c+f*f)},equals:function(s){return s=te(s),s.x===this.x&&s.y===this.y},contains:function(s){return s=te(s),Math.abs(s.x)<=Math.abs(this.x)&&Math.abs(s.y)<=Math.abs(this.y)},toString:function(){return"Point("+w(this.x)+", "+w(this.y)+")"}};function te(s,c,f){return s instanceof G?s:A(s)?new G(s[0],s[1]):s==null?s:typeof s=="object"&&"x"in s&&"y"in s?new G(s.x,s.y):new G(s,c,f)}function ke(s,c){if(s)for(var f=c?[s,c]:s,p=0,_=f.length;p<_;p++)this.extend(f[p])}ke.prototype={extend:function(s){var c,f;if(!s)return this;if(s instanceof G||typeof s[0]=="number"||"x"in s)c=f=te(s);else if(s=de(s),c=s.min,f=s.max,!c||!f)return this;return!this.min&&!this.max?(this.min=c.clone(),this.max=f.clone()):(this.min.x=Math.min(c.x,this.min.x),this.max.x=Math.max(f.x,this.max.x),this.min.y=Math.min(c.y,this.min.y),this.max.y=Math.max(f.y,this.max.y)),this},getCenter:function(s){return te((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,s)},getBottomLeft:function(){return te(this.min.x,this.max.y)},getTopRight:function(){return te(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(s){var c,f;return typeof s[0]=="number"||s instanceof G?s=te(s):s=de(s),s instanceof ke?(c=s.min,f=s.max):c=f=s,c.x>=this.min.x&&f.x<=this.max.x&&c.y>=this.min.y&&f.y<=this.max.y},intersects:function(s){s=de(s);var c=this.min,f=this.max,p=s.min,_=s.max,k=_.x>=c.x&&p.x<=f.x,V=_.y>=c.y&&p.y<=f.y;return k&&V},overlaps:function(s){s=de(s);var c=this.min,f=this.max,p=s.min,_=s.max,k=_.x>c.x&&p.x<f.x,V=_.y>c.y&&p.y<f.y;return k&&V},isValid:function(){return!!(this.min&&this.max)},pad:function(s){var c=this.min,f=this.max,p=Math.abs(c.x-f.x)*s,_=Math.abs(c.y-f.y)*s;return de(te(c.x-p,c.y-_),te(f.x+p,f.y+_))},equals:function(s){return s?(s=de(s),this.min.equals(s.getTopLeft())&&this.max.equals(s.getBottomRight())):!1}};function de(s,c){return!s||s instanceof ke?s:new ke(s,c)}function pe(s,c){if(s)for(var f=c?[s,c]:s,p=0,_=f.length;p<_;p++)this.extend(f[p])}pe.prototype={extend:function(s){var c=this._southWest,f=this._northEast,p,_;if(s instanceof he)p=s,_=s;else if(s instanceof pe){if(p=s._southWest,_=s._northEast,!p||!_)return this}else return s?this.extend(se(s)||ve(s)):this;return!c&&!f?(this._southWest=new he(p.lat,p.lng),this._northEast=new he(_.lat,_.lng)):(c.lat=Math.min(p.lat,c.lat),c.lng=Math.min(p.lng,c.lng),f.lat=Math.max(_.lat,f.lat),f.lng=Math.max(_.lng,f.lng)),this},pad:function(s){var c=this._southWest,f=this._northEast,p=Math.abs(c.lat-f.lat)*s,_=Math.abs(c.lng-f.lng)*s;return new pe(new he(c.lat-p,c.lng-_),new he(f.lat+p,f.lng+_))},getCenter:function(){return new he((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new he(this.getNorth(),this.getWest())},getSouthEast:function(){return new he(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(s){typeof s[0]=="number"||s instanceof he||"lat"in s?s=se(s):s=ve(s);var c=this._southWest,f=this._northEast,p,_;return s instanceof pe?(p=s.getSouthWest(),_=s.getNorthEast()):p=_=s,p.lat>=c.lat&&_.lat<=f.lat&&p.lng>=c.lng&&_.lng<=f.lng},intersects:function(s){s=ve(s);var c=this._southWest,f=this._northEast,p=s.getSouthWest(),_=s.getNorthEast(),k=_.lat>=c.lat&&p.lat<=f.lat,V=_.lng>=c.lng&&p.lng<=f.lng;return k&&V},overlaps:function(s){s=ve(s);var c=this._southWest,f=this._northEast,p=s.getSouthWest(),_=s.getNorthEast(),k=_.lat>c.lat&&p.lat<f.lat,V=_.lng>c.lng&&p.lng<f.lng;return k&&V},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(s,c){return s?(s=ve(s),this._southWest.equals(s.getSouthWest(),c)&&this._northEast.equals(s.getNorthEast(),c)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function ve(s,c){return s instanceof pe?s:new pe(s,c)}function he(s,c,f){if(isNaN(s)||isNaN(c))throw new Error("Invalid LatLng object: ("+s+", "+c+")");this.lat=+s,this.lng=+c,f!==void 0&&(this.alt=+f)}he.prototype={equals:function(s,c){if(!s)return!1;s=se(s);var f=Math.max(Math.abs(this.lat-s.lat),Math.abs(this.lng-s.lng));return f<=(c===void 0?1e-9:c)},toString:function(s){return"LatLng("+w(this.lat,s)+", "+w(this.lng,s)+")"},distanceTo:function(s){return Ye.distance(this,se(s))},wrap:function(){return Ye.wrapLatLng(this)},toBounds:function(s){var c=180*s/40075017,f=c/Math.cos(Math.PI/180*this.lat);return ve([this.lat-c,this.lng-f],[this.lat+c,this.lng+f])},clone:function(){return new he(this.lat,this.lng,this.alt)}};function se(s,c,f){return s instanceof he?s:A(s)&&typeof s[0]!="object"?s.length===3?new he(s[0],s[1],s[2]):s.length===2?new he(s[0],s[1]):null:s==null?s:typeof s=="object"&&"lat"in s?new he(s.lat,"lng"in s?s.lng:s.lon,s.alt):c===void 0?null:new he(s,c,f)}var Me={latLngToPoint:function(s,c){var f=this.projection.project(s),p=this.scale(c);return this.transformation._transform(f,p)},pointToLatLng:function(s,c){var f=this.scale(c),p=this.transformation.untransform(s,f);return this.projection.unproject(p)},project:function(s){return this.projection.project(s)},unproject:function(s){return this.projection.unproject(s)},scale:function(s){return 256*Math.pow(2,s)},zoom:function(s){return Math.log(s/256)/Math.LN2},getProjectedBounds:function(s){if(this.infinite)return null;var c=this.projection.bounds,f=this.scale(s),p=this.transformation.transform(c.min,f),_=this.transformation.transform(c.max,f);return new ke(p,_)},infinite:!1,wrapLatLng:function(s){var c=this.wrapLng?g(s.lng,this.wrapLng,!0):s.lng,f=this.wrapLat?g(s.lat,this.wrapLat,!0):s.lat,p=s.alt;return new he(f,c,p)},wrapLatLngBounds:function(s){var c=s.getCenter(),f=this.wrapLatLng(c),p=c.lat-f.lat,_=c.lng-f.lng;if(p===0&&_===0)return s;var k=s.getSouthWest(),V=s.getNorthEast(),$=new he(k.lat-p,k.lng-_),Y=new he(V.lat-p,V.lng-_);return new pe($,Y)}},Ye=i({},Me,{wrapLng:[-180,180],R:6371e3,distance:function(s,c){var f=Math.PI/180,p=s.lat*f,_=c.lat*f,k=Math.sin((c.lat-s.lat)*f/2),V=Math.sin((c.lng-s.lng)*f/2),$=k*k+Math.cos(p)*Math.cos(_)*V*V,Y=2*Math.atan2(Math.sqrt($),Math.sqrt(1-$));return this.R*Y}}),tr=6378137,Pt={R:tr,MAX_LATITUDE:85.0511287798,project:function(s){var c=Math.PI/180,f=this.MAX_LATITUDE,p=Math.max(Math.min(f,s.lat),-f),_=Math.sin(p*c);return new G(this.R*s.lng*c,this.R*Math.log((1+_)/(1-_))/2)},unproject:function(s){var c=180/Math.PI;return new he((2*Math.atan(Math.exp(s.y/this.R))-Math.PI/2)*c,s.x*c/this.R)},bounds:function(){var s=tr*Math.PI;return new ke([-s,-s],[s,s])}()};function In(s,c,f,p){if(A(s)){this._a=s[0],this._b=s[1],this._c=s[2],this._d=s[3];return}this._a=s,this._b=c,this._c=f,this._d=p}In.prototype={transform:function(s,c){return this._transform(s.clone(),c)},_transform:function(s,c){return c=c||1,s.x=c*(this._a*s.x+this._b),s.y=c*(this._c*s.y+this._d),s},untransform:function(s,c){return c=c||1,new G((s.x/c-this._b)/this._a,(s.y/c-this._d)/this._c)}};function cn(s,c,f,p){return new In(s,c,f,p)}var ht=i({},Ye,{code:"EPSG:3857",projection:Pt,transformation:function(){var s=.5/(Math.PI*Pt.R);return cn(s,.5,-s,.5)}()}),ft=i({},ht,{code:"EPSG:900913"});function Ke(s){return document.createElementNS("http://www.w3.org/2000/svg",s)}function $t(s,c){var f="",p,_,k,V,$,Y;for(p=0,k=s.length;p<k;p++){for($=s[p],_=0,V=$.length;_<V;_++)Y=$[_],f+=(_?"L":"M")+Y.x+" "+Y.y;f+=c?Te.svg?"z":"x":""}return f||"M0 0"}var mt=document.documentElement.style,un="ActiveXObject"in window,ls=un&&!document.addEventListener,cs="msLaunchUri"in navigator&&!("documentMode"in document),us=Un("webkit"),Ma=Un("android"),ds=Un("android 2")||Un("android 3"),vi=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Vn=Ma&&Un("Google")&&vi<537&&!("AudioNode"in window),bt=!!window.opera,Ft=!cs&&Un("chrome"),Gr=Un("gecko")&&!us&&!bt&&!un,ko=!Ft&&Un("safari"),xi=Un("phantom"),Io="OTransition"in mt,Kr=navigator.platform.indexOf("Win")===0,Fn=un&&"transition"in mt,hs="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!ds,fs="MozPerspective"in mt,hc=!window.L_DISABLE_3D&&(Fn||hs||fs)&&!Io&&!xi,Zr=typeof orientation<"u"||Un("mobile"),ms=Zr&&us,ps=Zr&&hs,To=!window.PointerEvent&&window.MSPointerEvent,Ar=!!(window.PointerEvent||To),gs="ontouchstart"in window||!!window.TouchEvent,wi=!window.L_NO_TOUCH&&(gs||Ar),Tn=Zr&&bt,bi=Zr&&Gr,ys=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Eo=function(){var s=!1;try{var c=Object.defineProperty({},"passive",{get:function(){s=!0}});window.addEventListener("testPassiveEventSupport",v,c),window.removeEventListener("testPassiveEventSupport",v,c)}catch{}return s}(),Qr=function(){return!!document.createElement("canvas").getContext}(),ki=!!(document.createElementNS&&Ke("svg").createSVGRect),Ht=!!ki&&function(){var s=document.createElement("div");return s.innerHTML="<svg/>",(s.firstChild&&s.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),So=!ki&&function(){try{var s=document.createElement("div");s.innerHTML='<v:shape adj="1"/>';var c=s.firstChild;return c.style.behavior="url(#default#VML)",c&&typeof c.adj=="object"}catch{return!1}}(),Yr=navigator.platform.indexOf("Mac")===0,Ii=navigator.platform.indexOf("Linux")===0;function Un(s){return navigator.userAgent.toLowerCase().indexOf(s)>=0}var Te={ie:un,ielt9:ls,edge:cs,webkit:us,android:Ma,android23:ds,androidStock:Vn,opera:bt,chrome:Ft,gecko:Gr,safari:ko,phantom:xi,opera12:Io,win:Kr,ie3d:Fn,webkit3d:hs,gecko3d:fs,any3d:hc,mobile:Zr,mobileWebkit:ms,mobileWebkit3d:ps,msPointer:To,pointer:Ar,touch:wi,touchNative:gs,mobileOpera:Tn,mobileGecko:bi,retina:ys,passiveEvents:Eo,canvas:Qr,svg:ki,vml:So,inlineSvg:Ht,mac:Yr,linux:Ii},Rr=Te.msPointer?"MSPointerDown":"pointerdown",No=Te.msPointer?"MSPointerMove":"pointermove",Oa=Te.msPointer?"MSPointerUp":"pointerup",En=Te.msPointer?"MSPointerCancel":"pointercancel",kt={touchstart:Rr,touchmove:No,touchend:Oa,touchcancel:En},dn={touchstart:vs,touchmove:_s,touchend:_s,touchcancel:_s},ct={},Bn=!1;function Po(s,c,f){return c==="touchstart"&&Va(),dn[c]?(f=dn[c].bind(this,f),s.addEventListener(kt[c],f,!1),f):(console.warn("wrong event specified:",c),v)}function Co(s,c,f){if(!kt[c]){console.warn("wrong event specified:",c);return}s.removeEventListener(kt[c],f,!1)}function tt(s){ct[s.pointerId]=s}function Ao(s){ct[s.pointerId]&&(ct[s.pointerId]=s)}function Ro(s){delete ct[s.pointerId]}function Va(){Bn||(document.addEventListener(Rr,tt,!0),document.addEventListener(No,Ao,!0),document.addEventListener(Oa,Ro,!0),document.addEventListener(En,Ro,!0),Bn=!0)}function _s(s,c){if(c.pointerType!==(c.MSPOINTER_TYPE_MOUSE||"mouse")){c.touches=[];for(var f in ct)c.touches.push(ct[f]);c.changedTouches=[c],s(c)}}function vs(s,c){c.MSPOINTER_TYPE_TOUCH&&c.pointerType===c.MSPOINTER_TYPE_TOUCH&&It(c),_s(s,c)}function jo(s){var c={},f,p;for(p in s)f=s[p],c[p]=f&&f.bind?f.bind(s):f;return s=c,c.type="dblclick",c.detail=2,c.isTrusted=!1,c._simulated=!0,c}var Lo=200;function Ti(s,c){s.addEventListener("dblclick",c);var f=0,p;function _(k){if(k.detail!==1){p=k.detail;return}if(!(k.pointerType==="mouse"||k.sourceCapabilities&&!k.sourceCapabilities.firesTouchEvents)){var V=gc(k);if(!(V.some(function(Y){return Y instanceof HTMLLabelElement&&Y.attributes.for})&&!V.some(function(Y){return Y instanceof HTMLInputElement||Y instanceof HTMLSelectElement}))){var $=Date.now();$-f<=Lo?(p++,p===2&&c(jo(k))):p=1,f=$}}}return s.addEventListener("click",_),{dblclick:c,simDblclick:_}}function jr(s,c){s.removeEventListener("dblclick",c.dblclick),s.removeEventListener("click",c.simDblclick)}var Ei=j(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Jr=j(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Do=Jr==="webkitTransition"||Jr==="OTransition"?Jr+"End":"transitionend";function Mo(s){return typeof s=="string"?document.getElementById(s):s}function Xr(s,c){var f=s.style[c]||s.currentStyle&&s.currentStyle[c];if((!f||f==="auto")&&document.defaultView){var p=document.defaultView.getComputedStyle(s,null);f=p?p[c]:null}return f==="auto"?null:f}function Le(s,c,f){var p=document.createElement(s);return p.className=c||"",f&&f.appendChild(p),p}function ye(s){var c=s.parentNode;c&&c.removeChild(s)}function ei(s){for(;s.firstChild;)s.removeChild(s.firstChild)}function pr(s){var c=s.parentNode;c&&c.lastChild!==s&&c.appendChild(s)}function Lr(s){var c=s.parentNode;c&&c.firstChild!==s&&c.insertBefore(s,c.firstChild)}function xs(s,c){if(s.classList!==void 0)return s.classList.contains(c);var f=Sn(s);return f.length>0&&new RegExp("(^|\\s)"+c+"(\\s|$)").test(f)}function je(s,c){if(s.classList!==void 0)for(var f=C(c),p=0,_=f.length;p<_;p++)s.classList.add(f[p]);else if(!xs(s,c)){var k=Sn(s);ws(s,(k?k+" ":"")+c)}}function lt(s,c){s.classList!==void 0?s.classList.remove(c):ws(s,E((" "+Sn(s)+" ").replace(" "+c+" "," ")))}function ws(s,c){s.className.baseVal===void 0?s.className=c:s.className.baseVal=c}function Sn(s){return s.correspondingElement&&(s=s.correspondingElement),s.className.baseVal===void 0?s.className:s.className.baseVal}function pt(s,c){"opacity"in s.style?s.style.opacity=c:"filter"in s.style&&Si(s,c)}function Si(s,c){var f=!1,p="DXImageTransform.Microsoft.Alpha";try{f=s.filters.item(p)}catch{if(c===1)return}c=Math.round(c*100),f?(f.Enabled=c!==100,f.Opacity=c):s.style.filter+=" progid:"+p+"(opacity="+c+")"}function j(s){for(var c=document.documentElement.style,f=0;f<s.length;f++)if(s[f]in c)return s[f];return!1}function K(s,c,f){var p=c||new G(0,0);s.style[Ei]=(Te.ie3d?"translate("+p.x+"px,"+p.y+"px)":"translate3d("+p.x+"px,"+p.y+"px,0)")+(f?" scale("+f+")":"")}function Q(s,c){s._leaflet_pos=c,Te.any3d?K(s,c):(s.style.left=c.x+"px",s.style.top=c.y+"px")}function fe(s){return s._leaflet_pos||new G(0,0)}var Ae,ze,Ve;if("onselectstart"in document)Ae=function(){Pe(window,"selectstart",It)},ze=function(){st(window,"selectstart",It)};else{var Dt=j(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Ae=function(){if(Dt){var s=document.documentElement.style;Ve=s[Dt],s[Dt]="none"}},ze=function(){Dt&&(document.documentElement.style[Dt]=Ve,Ve=void 0)}}function Qt(){Pe(window,"dragstart",It)}function bs(){st(window,"dragstart",It)}var ks,Oo;function Dr(s){for(;s.tabIndex===-1;)s=s.parentNode;s.style&&(hn(),ks=s,Oo=s.style.outlineStyle,s.style.outlineStyle="none",Pe(window,"keydown",hn))}function hn(){ks&&(ks.style.outlineStyle=Oo,ks=void 0,Oo=void 0,st(window,"keydown",hn))}function fc(s){do s=s.parentNode;while((!s.offsetWidth||!s.offsetHeight)&&s!==document.body);return s}function Fa(s){var c=s.getBoundingClientRect();return{x:c.width/s.offsetWidth||1,y:c.height/s.offsetHeight||1,boundingClientRect:c}}var wd={__proto__:null,TRANSFORM:Ei,TRANSITION:Jr,TRANSITION_END:Do,get:Mo,getStyle:Xr,create:Le,remove:ye,empty:ei,toFront:pr,toBack:Lr,hasClass:xs,addClass:je,removeClass:lt,setClass:ws,getClass:Sn,setOpacity:pt,testProp:j,setTransform:K,setPosition:Q,getPosition:fe,get disableTextSelection(){return Ae},get enableTextSelection(){return ze},disableImageDrag:Qt,enableImageDrag:bs,preventOutline:Dr,restoreOutline:hn,getSizedParentNode:fc,getScale:Fa};function Pe(s,c,f,p){if(c&&typeof c=="object")for(var _ in c)mc(s,_,c[_],f);else{c=C(c);for(var k=0,V=c.length;k<V;k++)mc(s,c[k],f,p)}return this}var gr="_leaflet_events";function st(s,c,f,p){if(arguments.length===1)bd(s),delete s[gr];else if(c&&typeof c=="object")for(var _ in c)pc(s,_,c[_],f);else if(c=C(c),arguments.length===2)bd(s,function($){return z(c,$)!==-1});else for(var k=0,V=c.length;k<V;k++)pc(s,c[k],f,p);return this}function bd(s,c){for(var f in s[gr]){var p=f.split(/\d/)[0];(!c||c(p))&&pc(s,p,null,null,f)}}var yr={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function mc(s,c,f,p){var _=c+d(f)+(p?"_"+d(p):"");if(s[gr]&&s[gr][_])return this;var k=function($){return f.call(p||s,$||window.event)},V=k;!Te.touchNative&&Te.pointer&&c.indexOf("touch")===0?k=Po(s,c,k):Te.touch&&c==="dblclick"?k=Ti(s,k):"addEventListener"in s?c==="touchstart"||c==="touchmove"||c==="wheel"||c==="mousewheel"?s.addEventListener(yr[c]||c,k,Te.passiveEvents?{passive:!1}:!1):c==="mouseenter"||c==="mouseleave"?(k=function($){$=$||window.event,yc(s,$)&&V($)},s.addEventListener(yr[c],k,!1)):s.addEventListener(c,V,!1):s.attachEvent("on"+c,k),s[gr]=s[gr]||{},s[gr][_]=k}function pc(s,c,f,p,_){_=_||c+d(f)+(p?"_"+d(p):"");var k=s[gr]&&s[gr][_];if(!k)return this;!Te.touchNative&&Te.pointer&&c.indexOf("touch")===0?Co(s,c,k):Te.touch&&c==="dblclick"?jr(s,k):"removeEventListener"in s?s.removeEventListener(yr[c]||c,k,!1):s.detachEvent("on"+c,k),s[gr][_]=null}function _r(s){return s.stopPropagation?s.stopPropagation():s.originalEvent?s.originalEvent._stopped=!0:s.cancelBubble=!0,this}function Is(s){return mc(s,"wheel",_r),this}function Ts(s){return Pe(s,"mousedown touchstart dblclick contextmenu",_r),s._leaflet_disable_click=!0,this}function It(s){return s.preventDefault?s.preventDefault():s.returnValue=!1,this}function nr(s){return It(s),_r(s),this}function gc(s){if(s.composedPath)return s.composedPath();for(var c=[],f=s.target;f;)c.push(f),f=f.parentNode;return c}function Ua(s,c){if(!c)return new G(s.clientX,s.clientY);var f=Fa(c),p=f.boundingClientRect;return new G((s.clientX-p.left)/f.x-c.clientLeft,(s.clientY-p.top)/f.y-c.clientTop)}var _t=Te.linux&&Te.chrome?window.devicePixelRatio:Te.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function kd(s){return Te.edge?s.wheelDeltaY/2:s.deltaY&&s.deltaMode===0?-s.deltaY/_t:s.deltaY&&s.deltaMode===1?-s.deltaY*20:s.deltaY&&s.deltaMode===2?-s.deltaY*60:s.deltaX||s.deltaZ?0:s.wheelDelta?(s.wheelDeltaY||s.wheelDelta)/2:s.detail&&Math.abs(s.detail)<32765?-s.detail*20:s.detail?s.detail/-32765*60:0}function yc(s,c){var f=c.relatedTarget;if(!f)return!0;try{for(;f&&f!==s;)f=f.parentNode}catch{return!1}return f!==s}var Id={__proto__:null,on:Pe,off:st,stopPropagation:_r,disableScrollPropagation:Is,disableClickPropagation:Ts,preventDefault:It,stop:nr,getPropagationPath:gc,getMousePosition:Ua,getWheelDelta:kd,isExternalTarget:yc,addListener:Pe,removeListener:st},_c=we.extend({run:function(s,c,f,p){this.stop(),this._el=s,this._inProgress=!0,this._duration=f||.25,this._easeOutPower=1/Math.max(p||.5,.2),this._startPos=fe(s),this._offset=c.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=O(this._animate,this),this._step()},_step:function(s){var c=+new Date-this._startTime,f=this._duration*1e3;c<f?this._runFrame(this._easeOut(c/f),s):(this._runFrame(1),this._complete())},_runFrame:function(s,c){var f=this._startPos.add(this._offset.multiplyBy(s));c&&f._round(),Q(this._el,f),this.fire("step")},_complete:function(){B(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(s){return 1-Math.pow(1-s,this._easeOutPower)}}),qe=we.extend({options:{crs:ht,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(s,c){c=P(this,c),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(s),this._initLayout(),this._onResize=a(this._onResize,this),this._initEvents(),c.maxBounds&&this.setMaxBounds(c.maxBounds),c.zoom!==void 0&&(this._zoom=this._limitZoom(c.zoom)),c.center&&c.zoom!==void 0&&this.setView(se(c.center),c.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Jr&&Te.any3d&&!Te.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Pe(this._proxy,Do,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(s,c,f){if(c=c===void 0?this._zoom:this._limitZoom(c),s=this._limitCenter(se(s),c,this.options.maxBounds),f=f||{},this._stop(),this._loaded&&!f.reset&&f!==!0){f.animate!==void 0&&(f.zoom=i({animate:f.animate},f.zoom),f.pan=i({animate:f.animate,duration:f.duration},f.pan));var p=this._zoom!==c?this._tryAnimatedZoom&&this._tryAnimatedZoom(s,c,f.zoom):this._tryAnimatedPan(s,f.pan);if(p)return clearTimeout(this._sizeTimer),this}return this._resetView(s,c,f.pan&&f.pan.noMoveStart),this},setZoom:function(s,c){return this._loaded?this.setView(this.getCenter(),s,{zoom:c}):(this._zoom=s,this)},zoomIn:function(s,c){return s=s||(Te.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+s,c)},zoomOut:function(s,c){return s=s||(Te.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-s,c)},setZoomAround:function(s,c,f){var p=this.getZoomScale(c),_=this.getSize().divideBy(2),k=s instanceof G?s:this.latLngToContainerPoint(s),V=k.subtract(_).multiplyBy(1-1/p),$=this.containerPointToLatLng(_.add(V));return this.setView($,c,{zoom:f})},_getBoundsCenterZoom:function(s,c){c=c||{},s=s.getBounds?s.getBounds():ve(s);var f=te(c.paddingTopLeft||c.padding||[0,0]),p=te(c.paddingBottomRight||c.padding||[0,0]),_=this.getBoundsZoom(s,!1,f.add(p));if(_=typeof c.maxZoom=="number"?Math.min(c.maxZoom,_):_,_===1/0)return{center:s.getCenter(),zoom:_};var k=p.subtract(f).divideBy(2),V=this.project(s.getSouthWest(),_),$=this.project(s.getNorthEast(),_),Y=this.unproject(V.add($).divideBy(2).add(k),_);return{center:Y,zoom:_}},fitBounds:function(s,c){if(s=ve(s),!s.isValid())throw new Error("Bounds are not valid.");var f=this._getBoundsCenterZoom(s,c);return this.setView(f.center,f.zoom,c)},fitWorld:function(s){return this.fitBounds([[-90,-180],[90,180]],s)},panTo:function(s,c){return this.setView(s,this._zoom,{pan:c})},panBy:function(s,c){if(s=te(s).round(),c=c||{},!s.x&&!s.y)return this.fire("moveend");if(c.animate!==!0&&!this.getSize().contains(s))return this._resetView(this.unproject(this.project(this.getCenter()).add(s)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new _c,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),c.noMoveStart||this.fire("movestart"),c.animate!==!1){je(this._mapPane,"leaflet-pan-anim");var f=this._getMapPanePos().subtract(s).round();this._panAnim.run(this._mapPane,f,c.duration||.25,c.easeLinearity)}else this._rawPanBy(s),this.fire("move").fire("moveend");return this},flyTo:function(s,c,f){if(f=f||{},f.animate===!1||!Te.any3d)return this.setView(s,c,f);this._stop();var p=this.project(this.getCenter()),_=this.project(s),k=this.getSize(),V=this._zoom;s=se(s),c=c===void 0?V:c;var $=Math.max(k.x,k.y),Y=$*this.getZoomScale(V,c),ne=_.distanceTo(p)||1,ge=1.42,Ce=ge*ge;function Fe(Bt){var Ud=Bt?-1:1,n2=Bt?Y:$,r2=Y*Y-$*$+Ud*Ce*Ce*ne*ne,i2=2*n2*Ce*ne,ep=r2/i2,kv=Math.sqrt(ep*ep+1)-ep,s2=kv<1e-9?-18:Math.log(kv);return s2}function Pn(Bt){return(Math.exp(Bt)-Math.exp(-Bt))/2}function Jt(Bt){return(Math.exp(Bt)+Math.exp(-Bt))/2}function xr(Bt){return Pn(Bt)/Jt(Bt)}var qn=Fe(0);function Xa(Bt){return $*(Jt(qn)/Jt(qn+ge*Bt))}function JN(Bt){return $*(Jt(qn)*xr(qn+ge*Bt)-Pn(qn))/Ce}function XN(Bt){return 1-Math.pow(1-Bt,1.5)}var e2=Date.now(),wv=(Fe(1)-qn)/ge,t2=f.duration?1e3*f.duration:1e3*wv*.8;function bv(){var Bt=(Date.now()-e2)/t2,Ud=XN(Bt)*wv;Bt<=1?(this._flyToFrame=O(bv,this),this._move(this.unproject(p.add(_.subtract(p).multiplyBy(JN(Ud)/ne)),V),this.getScaleZoom($/Xa(Ud),V),{flyTo:!0})):this._move(s,c)._moveEnd(!0)}return this._moveStart(!0,f.noMoveStart),bv.call(this),this},flyToBounds:function(s,c){var f=this._getBoundsCenterZoom(s,c);return this.flyTo(f.center,f.zoom,c)},setMaxBounds:function(s){return s=ve(s),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),s.isValid()?(this.options.maxBounds=s,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(s){var c=this.options.minZoom;return this.options.minZoom=s,this._loaded&&c!==s&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(s):this},setMaxZoom:function(s){var c=this.options.maxZoom;return this.options.maxZoom=s,this._loaded&&c!==s&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(s):this},panInsideBounds:function(s,c){this._enforcingBounds=!0;var f=this.getCenter(),p=this._limitCenter(f,this._zoom,ve(s));return f.equals(p)||this.panTo(p,c),this._enforcingBounds=!1,this},panInside:function(s,c){c=c||{};var f=te(c.paddingTopLeft||c.padding||[0,0]),p=te(c.paddingBottomRight||c.padding||[0,0]),_=this.project(this.getCenter()),k=this.project(s),V=this.getPixelBounds(),$=de([V.min.add(f),V.max.subtract(p)]),Y=$.getSize();if(!$.contains(k)){this._enforcingBounds=!0;var ne=k.subtract($.getCenter()),ge=$.extend(k).getSize().subtract(Y);_.x+=ne.x<0?-ge.x:ge.x,_.y+=ne.y<0?-ge.y:ge.y,this.panTo(this.unproject(_),c),this._enforcingBounds=!1}return this},invalidateSize:function(s){if(!this._loaded)return this;s=i({animate:!1,pan:!0},s===!0?{animate:!0}:s);var c=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var f=this.getSize(),p=c.divideBy(2).round(),_=f.divideBy(2).round(),k=p.subtract(_);return!k.x&&!k.y?this:(s.animate&&s.pan?this.panBy(k):(s.pan&&this._rawPanBy(k),this.fire("move"),s.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(a(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:c,newSize:f}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(s){if(s=this._locateOptions=i({timeout:1e4,watch:!1},s),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var c=a(this._handleGeolocationResponse,this),f=a(this._handleGeolocationError,this);return s.watch?this._locationWatchId=navigator.geolocation.watchPosition(c,f,s):navigator.geolocation.getCurrentPosition(c,f,s),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(s){if(this._container._leaflet_id){var c=s.code,f=s.message||(c===1?"permission denied":c===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:c,message:"Geolocation error: "+f+"."})}},_handleGeolocationResponse:function(s){if(this._container._leaflet_id){var c=s.coords.latitude,f=s.coords.longitude,p=new he(c,f),_=p.toBounds(s.coords.accuracy*2),k=this._locateOptions;if(k.setView){var V=this.getBoundsZoom(_);this.setView(p,k.maxZoom?Math.min(V,k.maxZoom):V)}var $={latlng:p,bounds:_,timestamp:s.timestamp};for(var Y in s.coords)typeof s.coords[Y]=="number"&&($[Y]=s.coords[Y]);this.fire("locationfound",$)}},addHandler:function(s,c){if(!c)return this;var f=this[s]=new c(this);return this._handlers.push(f),this.options[s]&&f.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),ye(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(B(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var s;for(s in this._layers)this._layers[s].remove();for(s in this._panes)ye(this._panes[s]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(s,c){var f="leaflet-pane"+(s?" leaflet-"+s.replace("Pane","")+"-pane":""),p=Le("div",f,c||this._mapPane);return s&&(this._panes[s]=p),p},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var s=this.getPixelBounds(),c=this.unproject(s.getBottomLeft()),f=this.unproject(s.getTopRight());return new pe(c,f)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(s,c,f){s=ve(s),f=te(f||[0,0]);var p=this.getZoom()||0,_=this.getMinZoom(),k=this.getMaxZoom(),V=s.getNorthWest(),$=s.getSouthEast(),Y=this.getSize().subtract(f),ne=de(this.project($,p),this.project(V,p)).getSize(),ge=Te.any3d?this.options.zoomSnap:1,Ce=Y.x/ne.x,Fe=Y.y/ne.y,Pn=c?Math.max(Ce,Fe):Math.min(Ce,Fe);return p=this.getScaleZoom(Pn,p),ge&&(p=Math.round(p/(ge/100))*(ge/100),p=c?Math.ceil(p/ge)*ge:Math.floor(p/ge)*ge),Math.max(_,Math.min(k,p))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new G(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(s,c){var f=this._getTopLeftPoint(s,c);return new ke(f,f.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(s){return this.options.crs.getProjectedBounds(s===void 0?this.getZoom():s)},getPane:function(s){return typeof s=="string"?this._panes[s]:s},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(s,c){var f=this.options.crs;return c=c===void 0?this._zoom:c,f.scale(s)/f.scale(c)},getScaleZoom:function(s,c){var f=this.options.crs;c=c===void 0?this._zoom:c;var p=f.zoom(s*f.scale(c));return isNaN(p)?1/0:p},project:function(s,c){return c=c===void 0?this._zoom:c,this.options.crs.latLngToPoint(se(s),c)},unproject:function(s,c){return c=c===void 0?this._zoom:c,this.options.crs.pointToLatLng(te(s),c)},layerPointToLatLng:function(s){var c=te(s).add(this.getPixelOrigin());return this.unproject(c)},latLngToLayerPoint:function(s){var c=this.project(se(s))._round();return c._subtract(this.getPixelOrigin())},wrapLatLng:function(s){return this.options.crs.wrapLatLng(se(s))},wrapLatLngBounds:function(s){return this.options.crs.wrapLatLngBounds(ve(s))},distance:function(s,c){return this.options.crs.distance(se(s),se(c))},containerPointToLayerPoint:function(s){return te(s).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(s){return te(s).add(this._getMapPanePos())},containerPointToLatLng:function(s){var c=this.containerPointToLayerPoint(te(s));return this.layerPointToLatLng(c)},latLngToContainerPoint:function(s){return this.layerPointToContainerPoint(this.latLngToLayerPoint(se(s)))},mouseEventToContainerPoint:function(s){return Ua(s,this._container)},mouseEventToLayerPoint:function(s){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(s))},mouseEventToLatLng:function(s){return this.layerPointToLatLng(this.mouseEventToLayerPoint(s))},_initContainer:function(s){var c=this._container=Mo(s);if(c){if(c._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Pe(c,"scroll",this._onScroll,this),this._containerId=d(c)},_initLayout:function(){var s=this._container;this._fadeAnimated=this.options.fadeAnimation&&Te.any3d,je(s,"leaflet-container"+(Te.touch?" leaflet-touch":"")+(Te.retina?" leaflet-retina":"")+(Te.ielt9?" leaflet-oldie":"")+(Te.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var c=Xr(s,"position");c!=="absolute"&&c!=="relative"&&c!=="fixed"&&c!=="sticky"&&(s.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var s=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Q(this._mapPane,new G(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(je(s.markerPane,"leaflet-zoom-hide"),je(s.shadowPane,"leaflet-zoom-hide"))},_resetView:function(s,c,f){Q(this._mapPane,new G(0,0));var p=!this._loaded;this._loaded=!0,c=this._limitZoom(c),this.fire("viewprereset");var _=this._zoom!==c;this._moveStart(_,f)._move(s,c)._moveEnd(_),this.fire("viewreset"),p&&this.fire("load")},_moveStart:function(s,c){return s&&this.fire("zoomstart"),c||this.fire("movestart"),this},_move:function(s,c,f,p){c===void 0&&(c=this._zoom);var _=this._zoom!==c;return this._zoom=c,this._lastCenter=s,this._pixelOrigin=this._getNewPixelOrigin(s),p?f&&f.pinch&&this.fire("zoom",f):((_||f&&f.pinch)&&this.fire("zoom",f),this.fire("move",f)),this},_moveEnd:function(s){return s&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return B(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(s){Q(this._mapPane,this._getMapPanePos().subtract(s))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(s){this._targets={},this._targets[d(this._container)]=this;var c=s?st:Pe;c(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&c(window,"resize",this._onResize,this),Te.any3d&&this.options.transform3DLimit&&(s?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){B(this._resizeRequest),this._resizeRequest=O(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var s=this._getMapPanePos();Math.max(Math.abs(s.x),Math.abs(s.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(s,c){for(var f=[],p,_=c==="mouseout"||c==="mouseover",k=s.target||s.srcElement,V=!1;k;){if(p=this._targets[d(k)],p&&(c==="click"||c==="preclick")&&this._draggableMoved(p)){V=!0;break}if(p&&p.listens(c,!0)&&(_&&!yc(k,s)||(f.push(p),_))||k===this._container)break;k=k.parentNode}return!f.length&&!V&&!_&&this.listens(c,!0)&&(f=[this]),f},_isClickDisabled:function(s){for(;s&&s!==this._container;){if(s._leaflet_disable_click)return!0;s=s.parentNode}},_handleDOMEvent:function(s){var c=s.target||s.srcElement;if(!(!this._loaded||c._leaflet_disable_events||s.type==="click"&&this._isClickDisabled(c))){var f=s.type;f==="mousedown"&&Dr(c),this._fireDOMEvent(s,f)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(s,c,f){if(s.type==="click"){var p=i({},s);p.type="preclick",this._fireDOMEvent(p,p.type,f)}var _=this._findEventTargets(s,c);if(f){for(var k=[],V=0;V<f.length;V++)f[V].listens(c,!0)&&k.push(f[V]);_=k.concat(_)}if(_.length){c==="contextmenu"&&It(s);var $=_[0],Y={originalEvent:s};if(s.type!=="keypress"&&s.type!=="keydown"&&s.type!=="keyup"){var ne=$.getLatLng&&(!$._radius||$._radius<=10);Y.containerPoint=ne?this.latLngToContainerPoint($.getLatLng()):this.mouseEventToContainerPoint(s),Y.layerPoint=this.containerPointToLayerPoint(Y.containerPoint),Y.latlng=ne?$.getLatLng():this.layerPointToLatLng(Y.layerPoint)}for(V=0;V<_.length;V++)if(_[V].fire(c,Y,!0),Y.originalEvent._stopped||_[V].options.bubblingMouseEvents===!1&&z(this._mouseEvents,c)!==-1)return}},_draggableMoved:function(s){return s=s.dragging&&s.dragging.enabled()?s:this,s.dragging&&s.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var s=0,c=this._handlers.length;s<c;s++)this._handlers[s].disable()},whenReady:function(s,c){return this._loaded?s.call(c||this,{target:this}):this.on("load",s,c),this},_getMapPanePos:function(){return fe(this._mapPane)||new G(0,0)},_moved:function(){var s=this._getMapPanePos();return s&&!s.equals([0,0])},_getTopLeftPoint:function(s,c){var f=s&&c!==void 0?this._getNewPixelOrigin(s,c):this.getPixelOrigin();return f.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(s,c){var f=this.getSize()._divideBy(2);return this.project(s,c)._subtract(f)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(s,c,f){var p=this._getNewPixelOrigin(f,c);return this.project(s,c)._subtract(p)},_latLngBoundsToNewLayerBounds:function(s,c,f){var p=this._getNewPixelOrigin(f,c);return de([this.project(s.getSouthWest(),c)._subtract(p),this.project(s.getNorthWest(),c)._subtract(p),this.project(s.getSouthEast(),c)._subtract(p),this.project(s.getNorthEast(),c)._subtract(p)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(s){return this.latLngToLayerPoint(s).subtract(this._getCenterLayerPoint())},_limitCenter:function(s,c,f){if(!f)return s;var p=this.project(s,c),_=this.getSize().divideBy(2),k=new ke(p.subtract(_),p.add(_)),V=this._getBoundsOffset(k,f,c);return Math.abs(V.x)<=1&&Math.abs(V.y)<=1?s:this.unproject(p.add(V),c)},_limitOffset:function(s,c){if(!c)return s;var f=this.getPixelBounds(),p=new ke(f.min.add(s),f.max.add(s));return s.add(this._getBoundsOffset(p,c))},_getBoundsOffset:function(s,c,f){var p=de(this.project(c.getNorthEast(),f),this.project(c.getSouthWest(),f)),_=p.min.subtract(s.min),k=p.max.subtract(s.max),V=this._rebound(_.x,-k.x),$=this._rebound(_.y,-k.y);return new G(V,$)},_rebound:function(s,c){return s+c>0?Math.round(s-c)/2:Math.max(0,Math.ceil(s))-Math.max(0,Math.floor(c))},_limitZoom:function(s){var c=this.getMinZoom(),f=this.getMaxZoom(),p=Te.any3d?this.options.zoomSnap:1;return p&&(s=Math.round(s/p)*p),Math.max(c,Math.min(f,s))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){lt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(s,c){var f=this._getCenterOffset(s)._trunc();return(c&&c.animate)!==!0&&!this.getSize().contains(f)?!1:(this.panBy(f,c),!0)},_createAnimProxy:function(){var s=this._proxy=Le("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(s),this.on("zoomanim",function(c){var f=Ei,p=this._proxy.style[f];K(this._proxy,this.project(c.center,c.zoom),this.getZoomScale(c.zoom,1)),p===this._proxy.style[f]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){ye(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var s=this.getCenter(),c=this.getZoom();K(this._proxy,this.project(s,c),this.getZoomScale(c,1))},_catchTransitionEnd:function(s){this._animatingZoom&&s.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(s,c,f){if(this._animatingZoom)return!0;if(f=f||{},!this._zoomAnimated||f.animate===!1||this._nothingToAnimate()||Math.abs(c-this._zoom)>this.options.zoomAnimationThreshold)return!1;var p=this.getZoomScale(c),_=this._getCenterOffset(s)._divideBy(1-1/p);return f.animate!==!0&&!this.getSize().contains(_)?!1:(O(function(){this._moveStart(!0,f.noMoveStart||!1)._animateZoom(s,c,!0)},this),!0)},_animateZoom:function(s,c,f,p){this._mapPane&&(f&&(this._animatingZoom=!0,this._animateToCenter=s,this._animateToZoom=c,je(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:s,zoom:c,noUpdate:p}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(a(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&lt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Ba(s,c){return new qe(s,c)}var zn=ee.extend({options:{position:"topright"},initialize:function(s){P(this,s)},getPosition:function(){return this.options.position},setPosition:function(s){var c=this._map;return c&&c.removeControl(this),this.options.position=s,c&&c.addControl(this),this},getContainer:function(){return this._container},addTo:function(s){this.remove(),this._map=s;var c=this._container=this.onAdd(s),f=this.getPosition(),p=s._controlCorners[f];return je(c,"leaflet-control"),f.indexOf("bottom")!==-1?p.insertBefore(c,p.firstChild):p.appendChild(c),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(ye(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(s){this._map&&s&&s.screenX>0&&s.screenY>0&&this._map.getContainer().focus()}}),Nn=function(s){return new zn(s)};qe.include({addControl:function(s){return s.addTo(this),this},removeControl:function(s){return s.remove(),this},_initControlPos:function(){var s=this._controlCorners={},c="leaflet-",f=this._controlContainer=Le("div",c+"control-container",this._container);function p(_,k){var V=c+_+" "+c+k;s[_+k]=Le("div",V,f)}p("top","left"),p("top","right"),p("bottom","left"),p("bottom","right")},_clearControlPos:function(){for(var s in this._controlCorners)ye(this._controlCorners[s]);ye(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var vc=zn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(s,c,f,p){return f<p?-1:p<f?1:0}},initialize:function(s,c,f){P(this,f),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var p in s)this._addLayer(s[p],p);for(p in c)this._addLayer(c[p],p,!0)},onAdd:function(s){this._initLayout(),this._update(),this._map=s,s.on("zoomend",this._checkDisabledLayers,this);for(var c=0;c<this._layers.length;c++)this._layers[c].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(s){return zn.prototype.addTo.call(this,s),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var s=0;s<this._layers.length;s++)this._layers[s].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(s,c){return this._addLayer(s,c),this._map?this._update():this},addOverlay:function(s,c){return this._addLayer(s,c,!0),this._map?this._update():this},removeLayer:function(s){s.off("add remove",this._onLayerChange,this);var c=this._getLayer(d(s));return c&&this._layers.splice(this._layers.indexOf(c),1),this._map?this._update():this},expand:function(){je(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var s=this._map.getSize().y-(this._container.offsetTop+50);return s<this._section.clientHeight?(je(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=s+"px"):lt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return lt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var s="leaflet-control-layers",c=this._container=Le("div",s),f=this.options.collapsed;c.setAttribute("aria-haspopup",!0),Ts(c),Is(c);var p=this._section=Le("section",s+"-list");f&&(this._map.on("click",this.collapse,this),Pe(c,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var _=this._layersLink=Le("a",s+"-toggle",c);_.href="#",_.title="Layers",_.setAttribute("role","button"),Pe(_,{keydown:function(k){k.keyCode===13&&this._expandSafely()},click:function(k){It(k),this._expandSafely()}},this),f||this.expand(),this._baseLayersList=Le("div",s+"-base",p),this._separator=Le("div",s+"-separator",p),this._overlaysList=Le("div",s+"-overlays",p),c.appendChild(p)},_getLayer:function(s){for(var c=0;c<this._layers.length;c++)if(this._layers[c]&&d(this._layers[c].layer)===s)return this._layers[c]},_addLayer:function(s,c,f){this._map&&s.on("add remove",this._onLayerChange,this),this._layers.push({layer:s,name:c,overlay:f}),this.options.sortLayers&&this._layers.sort(a(function(p,_){return this.options.sortFunction(p.layer,_.layer,p.name,_.name)},this)),this.options.autoZIndex&&s.setZIndex&&(this._lastZIndex++,s.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;ei(this._baseLayersList),ei(this._overlaysList),this._layerControlInputs=[];var s,c,f,p,_=0;for(f=0;f<this._layers.length;f++)p=this._layers[f],this._addItem(p),c=c||p.overlay,s=s||!p.overlay,_+=p.overlay?0:1;return this.options.hideSingleBase&&(s=s&&_>1,this._baseLayersList.style.display=s?"":"none"),this._separator.style.display=c&&s?"":"none",this},_onLayerChange:function(s){this._handlingClick||this._update();var c=this._getLayer(d(s.target)),f=c.overlay?s.type==="add"?"overlayadd":"overlayremove":s.type==="add"?"baselayerchange":null;f&&this._map.fire(f,c)},_createRadioElement:function(s,c){var f='<input type="radio" class="leaflet-control-layers-selector" name="'+s+'"'+(c?' checked="checked"':"")+"/>",p=document.createElement("div");return p.innerHTML=f,p.firstChild},_addItem:function(s){var c=document.createElement("label"),f=this._map.hasLayer(s.layer),p;s.overlay?(p=document.createElement("input"),p.type="checkbox",p.className="leaflet-control-layers-selector",p.defaultChecked=f):p=this._createRadioElement("leaflet-base-layers_"+d(this),f),this._layerControlInputs.push(p),p.layerId=d(s.layer),Pe(p,"click",this._onInputClick,this);var _=document.createElement("span");_.innerHTML=" "+s.name;var k=document.createElement("span");c.appendChild(k),k.appendChild(p),k.appendChild(_);var V=s.overlay?this._overlaysList:this._baseLayersList;return V.appendChild(c),this._checkDisabledLayers(),c},_onInputClick:function(){if(!this._preventClick){var s=this._layerControlInputs,c,f,p=[],_=[];this._handlingClick=!0;for(var k=s.length-1;k>=0;k--)c=s[k],f=this._getLayer(c.layerId).layer,c.checked?p.push(f):c.checked||_.push(f);for(k=0;k<_.length;k++)this._map.hasLayer(_[k])&&this._map.removeLayer(_[k]);for(k=0;k<p.length;k++)this._map.hasLayer(p[k])||this._map.addLayer(p[k]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var s=this._layerControlInputs,c,f,p=this._map.getZoom(),_=s.length-1;_>=0;_--)c=s[_],f=this._getLayer(c.layerId).layer,c.disabled=f.options.minZoom!==void 0&&p<f.options.minZoom||f.options.maxZoom!==void 0&&p>f.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var s=this._section;this._preventClick=!0,Pe(s,"click",It),this.expand();var c=this;setTimeout(function(){st(s,"click",It),c._preventClick=!1})}}),Km=function(s,c,f){return new vc(s,c,f)},Ni=zn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(s){var c="leaflet-control-zoom",f=Le("div",c+" leaflet-bar"),p=this.options;return this._zoomInButton=this._createButton(p.zoomInText,p.zoomInTitle,c+"-in",f,this._zoomIn),this._zoomOutButton=this._createButton(p.zoomOutText,p.zoomOutTitle,c+"-out",f,this._zoomOut),this._updateDisabled(),s.on("zoomend zoomlevelschange",this._updateDisabled,this),f},onRemove:function(s){s.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(s){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(s.shiftKey?3:1))},_zoomOut:function(s){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(s.shiftKey?3:1))},_createButton:function(s,c,f,p,_){var k=Le("a",f,p);return k.innerHTML=s,k.href="#",k.title=c,k.setAttribute("role","button"),k.setAttribute("aria-label",c),Ts(k),Pe(k,"click",nr),Pe(k,"click",_,this),Pe(k,"click",this._refocusOnMap,this),k},_updateDisabled:function(){var s=this._map,c="leaflet-disabled";lt(this._zoomInButton,c),lt(this._zoomOutButton,c),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||s._zoom===s.getMinZoom())&&(je(this._zoomOutButton,c),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||s._zoom===s.getMaxZoom())&&(je(this._zoomInButton,c),this._zoomInButton.setAttribute("aria-disabled","true"))}});qe.mergeOptions({zoomControl:!0}),qe.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Ni,this.addControl(this.zoomControl))});var Td=function(s){return new Ni(s)},za=zn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(s){var c="leaflet-control-scale",f=Le("div",c),p=this.options;return this._addScales(p,c+"-line",f),s.on(p.updateWhenIdle?"moveend":"move",this._update,this),s.whenReady(this._update,this),f},onRemove:function(s){s.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(s,c,f){s.metric&&(this._mScale=Le("div",c,f)),s.imperial&&(this._iScale=Le("div",c,f))},_update:function(){var s=this._map,c=s.getSize().y/2,f=s.distance(s.containerPointToLatLng([0,c]),s.containerPointToLatLng([this.options.maxWidth,c]));this._updateScales(f)},_updateScales:function(s){this.options.metric&&s&&this._updateMetric(s),this.options.imperial&&s&&this._updateImperial(s)},_updateMetric:function(s){var c=this._getRoundNum(s),f=c<1e3?c+" m":c/1e3+" km";this._updateScale(this._mScale,f,c/s)},_updateImperial:function(s){var c=s*3.2808399,f,p,_;c>5280?(f=c/5280,p=this._getRoundNum(f),this._updateScale(this._iScale,p+" mi",p/f)):(_=this._getRoundNum(c),this._updateScale(this._iScale,_+" ft",_/c))},_updateScale:function(s,c,f){s.style.width=Math.round(this.options.maxWidth*f)+"px",s.innerHTML=c},_getRoundNum:function(s){var c=Math.pow(10,(Math.floor(s)+"").length-1),f=s/c;return f=f>=10?10:f>=5?5:f>=3?3:f>=2?2:1,c*f}}),qa=function(s){return new za(s)},Ed='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Es=zn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Te.inlineSvg?Ed+" ":"")+"Leaflet</a>"},initialize:function(s){P(this,s),this._attributions={}},onAdd:function(s){s.attributionControl=this,this._container=Le("div","leaflet-control-attribution"),Ts(this._container);for(var c in s._layers)s._layers[c].getAttribution&&this.addAttribution(s._layers[c].getAttribution());return this._update(),s.on("layeradd",this._addAttribution,this),this._container},onRemove:function(s){s.off("layeradd",this._addAttribution,this)},_addAttribution:function(s){s.layer.getAttribution&&(this.addAttribution(s.layer.getAttribution()),s.layer.once("remove",function(){this.removeAttribution(s.layer.getAttribution())},this))},setPrefix:function(s){return this.options.prefix=s,this._update(),this},addAttribution:function(s){return s?(this._attributions[s]||(this._attributions[s]=0),this._attributions[s]++,this._update(),this):this},removeAttribution:function(s){return s?(this._attributions[s]&&(this._attributions[s]--,this._update()),this):this},_update:function(){if(this._map){var s=[];for(var c in this._attributions)this._attributions[c]&&s.push(c);var f=[];this.options.prefix&&f.push(this.options.prefix),s.length&&f.push(s.join(", ")),this._container.innerHTML=f.join(' <span aria-hidden="true">|</span> ')}}});qe.mergeOptions({attributionControl:!0}),qe.addInitHook(function(){this.options.attributionControl&&new Es().addTo(this)});var Zm=function(s){return new Es(s)};zn.Layers=vc,zn.Zoom=Ni,zn.Scale=za,zn.Attribution=Es,Nn.layers=Km,Nn.zoom=Td,Nn.scale=qa,Nn.attribution=Zm;var rr=ee.extend({initialize:function(s){this._map=s},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});rr.addTo=function(s,c){return s.addHandler(c,this),this};var Vo={Events:me},xc=Te.touch?"touchstart mousedown":"mousedown",Mr=we.extend({options:{clickTolerance:3},initialize:function(s,c,f,p){P(this,p),this._element=s,this._dragStartTarget=c||s,this._preventOutline=f},enable:function(){this._enabled||(Pe(this._dragStartTarget,xc,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Mr._dragging===this&&this.finishDrag(!0),st(this._dragStartTarget,xc,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(s){if(this._enabled&&(this._moved=!1,!xs(this._element,"leaflet-zoom-anim"))){if(s.touches&&s.touches.length!==1){Mr._dragging===this&&this.finishDrag();return}if(!(Mr._dragging||s.shiftKey||s.which!==1&&s.button!==1&&!s.touches)&&(Mr._dragging=this,this._preventOutline&&Dr(this._element),Qt(),Ae(),!this._moving)){this.fire("down");var c=s.touches?s.touches[0]:s,f=fc(this._element);this._startPoint=new G(c.clientX,c.clientY),this._startPos=fe(this._element),this._parentScale=Fa(f);var p=s.type==="mousedown";Pe(document,p?"mousemove":"touchmove",this._onMove,this),Pe(document,p?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(s){if(this._enabled){if(s.touches&&s.touches.length>1){this._moved=!0;return}var c=s.touches&&s.touches.length===1?s.touches[0]:s,f=new G(c.clientX,c.clientY)._subtract(this._startPoint);!f.x&&!f.y||Math.abs(f.x)+Math.abs(f.y)<this.options.clickTolerance||(f.x/=this._parentScale.x,f.y/=this._parentScale.y,It(s),this._moved||(this.fire("dragstart"),this._moved=!0,je(document.body,"leaflet-dragging"),this._lastTarget=s.target||s.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),je(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(f),this._moving=!0,this._lastEvent=s,this._updatePosition())}},_updatePosition:function(){var s={originalEvent:this._lastEvent};this.fire("predrag",s),Q(this._element,this._newPos),this.fire("drag",s)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(s){lt(document.body,"leaflet-dragging"),this._lastTarget&&(lt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),st(document,"mousemove touchmove",this._onMove,this),st(document,"mouseup touchend touchcancel",this._onUp,this),bs(),ze();var c=this._moved&&this._moving;this._moving=!1,Mr._dragging=!1,c&&this.fire("dragend",{noInertia:s,distance:this._newPos.distanceTo(this._startPos)})}});function $a(s,c,f){var p,_=[1,4,2,8],k,V,$,Y,ne,ge,Ce,Fe;for(k=0,ge=s.length;k<ge;k++)s[k]._code=ti(s[k],c);for($=0;$<4;$++){for(Ce=_[$],p=[],k=0,ge=s.length,V=ge-1;k<ge;V=k++)Y=s[k],ne=s[V],Y._code&Ce?ne._code&Ce||(Fe=Yt(ne,Y,Ce,c,f),Fe._code=ti(Fe,c),p.push(Fe)):(ne._code&Ce&&(Fe=Yt(ne,Y,Ce,c,f),Fe._code=ti(Fe,c),p.push(Fe)),p.push(Y));s=p}return s}function Ha(s,c){var f,p,_,k,V,$,Y,ne,ge;if(!s||s.length===0)throw new Error("latlngs not passed");h(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var Ce=se([0,0]),Fe=ve(s),Pn=Fe.getNorthWest().distanceTo(Fe.getSouthWest())*Fe.getNorthEast().distanceTo(Fe.getNorthWest());Pn<1700&&(Ce=Wa(s));var Jt=s.length,xr=[];for(f=0;f<Jt;f++){var qn=se(s[f]);xr.push(c.project(se([qn.lat-Ce.lat,qn.lng-Ce.lng])))}for($=Y=ne=0,f=0,p=Jt-1;f<Jt;p=f++)_=xr[f],k=xr[p],V=_.y*k.x-k.y*_.x,Y+=(_.x+k.x)*V,ne+=(_.y+k.y)*V,$+=V*3;$===0?ge=xr[0]:ge=[Y/$,ne/$];var Xa=c.unproject(te(ge));return se([Xa.lat+Ce.lat,Xa.lng+Ce.lng])}function Wa(s){for(var c=0,f=0,p=0,_=0;_<s.length;_++){var k=se(s[_]);c+=k.lat,f+=k.lng,p++}return se([c/p,f/p])}var Ga={__proto__:null,clipPolygon:$a,polygonCenter:Ha,centroid:Wa};function wc(s,c){if(!c||!s.length)return s.slice();var f=c*c;return s=Nd(s,f),s=Sd(s,f),s}function bc(s,c,f){return Math.sqrt(vr(s,c,f,!0))}function Pi(s,c,f){return vr(s,c,f)}function Sd(s,c){var f=s.length,p=typeof Uint8Array<"u"?Uint8Array:Array,_=new p(f);_[0]=_[f-1]=1,Ka(s,_,c,0,f-1);var k,V=[];for(k=0;k<f;k++)_[k]&&V.push(s[k]);return V}function Ka(s,c,f,p,_){var k=0,V,$,Y;for($=p+1;$<=_-1;$++)Y=vr(s[$],s[p],s[_],!0),Y>k&&(V=$,k=Y);k>f&&(c[V]=1,Ka(s,c,f,p,V),Ka(s,c,f,V,_))}function Nd(s,c){for(var f=[s[0]],p=1,_=0,k=s.length;p<k;p++)Pd(s[p],s[_])>c&&(f.push(s[p]),_=p);return _<k-1&&f.push(s[k-1]),f}var kc;function Fo(s,c,f,p,_){var k=p?kc:ti(s,f),V=ti(c,f),$,Y,ne;for(kc=V;;){if(!(k|V))return[s,c];if(k&V)return!1;$=k||V,Y=Yt(s,c,$,f,_),ne=ti(Y,f),$===k?(s=Y,k=ne):(c=Y,V=ne)}}function Yt(s,c,f,p,_){var k=c.x-s.x,V=c.y-s.y,$=p.min,Y=p.max,ne,ge;return f&8?(ne=s.x+k*(Y.y-s.y)/V,ge=Y.y):f&4?(ne=s.x+k*($.y-s.y)/V,ge=$.y):f&2?(ne=Y.x,ge=s.y+V*(Y.x-s.x)/k):f&1&&(ne=$.x,ge=s.y+V*($.x-s.x)/k),new G(ne,ge,_)}function ti(s,c){var f=0;return s.x<c.min.x?f|=1:s.x>c.max.x&&(f|=2),s.y<c.min.y?f|=4:s.y>c.max.y&&(f|=8),f}function Pd(s,c){var f=c.x-s.x,p=c.y-s.y;return f*f+p*p}function vr(s,c,f,p){var _=c.x,k=c.y,V=f.x-_,$=f.y-k,Y=V*V+$*$,ne;return Y>0&&(ne=((s.x-_)*V+(s.y-k)*$)/Y,ne>1?(_=f.x,k=f.y):ne>0&&(_+=V*ne,k+=$*ne)),V=s.x-_,$=s.y-k,p?V*V+$*$:new G(_,k)}function h(s){return!A(s[0])||typeof s[0][0]!="object"&&typeof s[0][0]<"u"}function y(s){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),h(s)}function x(s,c){var f,p,_,k,V,$,Y,ne;if(!s||s.length===0)throw new Error("latlngs not passed");h(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var ge=se([0,0]),Ce=ve(s),Fe=Ce.getNorthWest().distanceTo(Ce.getSouthWest())*Ce.getNorthEast().distanceTo(Ce.getNorthWest());Fe<1700&&(ge=Wa(s));var Pn=s.length,Jt=[];for(f=0;f<Pn;f++){var xr=se(s[f]);Jt.push(c.project(se([xr.lat-ge.lat,xr.lng-ge.lng])))}for(f=0,p=0;f<Pn-1;f++)p+=Jt[f].distanceTo(Jt[f+1])/2;if(p===0)ne=Jt[0];else for(f=0,k=0;f<Pn-1;f++)if(V=Jt[f],$=Jt[f+1],_=V.distanceTo($),k+=_,k>p){Y=(k-p)/_,ne=[$.x-Y*($.x-V.x),$.y-Y*($.y-V.y)];break}var qn=c.unproject(te(ne));return se([qn.lat+ge.lat,qn.lng+ge.lng])}var S={__proto__:null,simplify:wc,pointToSegmentDistance:bc,closestPointOnSegment:Pi,clipSegment:Fo,_getEdgeIntersection:Yt,_getBitCode:ti,_sqClosestPointOnSegment:vr,isFlat:h,_flat:y,polylineCenter:x},q={project:function(s){return new G(s.lng,s.lat)},unproject:function(s){return new he(s.y,s.x)},bounds:new ke([-180,-90],[180,90])},J={R:6378137,R_MINOR:6356752314245179e-9,bounds:new ke([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(s){var c=Math.PI/180,f=this.R,p=s.lat*c,_=this.R_MINOR/f,k=Math.sqrt(1-_*_),V=k*Math.sin(p),$=Math.tan(Math.PI/4-p/2)/Math.pow((1-V)/(1+V),k/2);return p=-f*Math.log(Math.max($,1e-10)),new G(s.lng*c*f,p)},unproject:function(s){for(var c=180/Math.PI,f=this.R,p=this.R_MINOR/f,_=Math.sqrt(1-p*p),k=Math.exp(-s.y/f),V=Math.PI/2-2*Math.atan(k),$=0,Y=.1,ne;$<15&&Math.abs(Y)>1e-7;$++)ne=_*Math.sin(V),ne=Math.pow((1-ne)/(1+ne),_/2),Y=Math.PI/2-2*Math.atan(k*ne)-V,V+=Y;return new he(V*c,s.x*c/f)}},oe={__proto__:null,LonLat:q,Mercator:J,SphericalMercator:Pt},nt=i({},Ye,{code:"EPSG:3395",projection:J,transformation:function(){var s=.5/(Math.PI*J.R);return cn(s,.5,-s,.5)}()}),Ut=i({},Ye,{code:"EPSG:4326",projection:q,transformation:cn(1/180,1,-1/180,.5)}),Ze=i({},Me,{projection:q,transformation:cn(1,0,-1,0),scale:function(s){return Math.pow(2,s)},zoom:function(s){return Math.log(s)/Math.LN2},distance:function(s,c){var f=c.lng-s.lng,p=c.lat-s.lat;return Math.sqrt(f*f+p*p)},infinite:!0});Me.Earth=Ye,Me.EPSG3395=nt,Me.EPSG3857=ht,Me.EPSG900913=ft,Me.EPSG4326=Ut,Me.Simple=Ze;var ot=we.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(s){return s.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(s){return s&&s.removeLayer(this),this},getPane:function(s){return this._map.getPane(s?this.options[s]||s:this.options.pane)},addInteractiveTarget:function(s){return this._map._targets[d(s)]=this,this},removeInteractiveTarget:function(s){return delete this._map._targets[d(s)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(s){var c=s.target;if(c.hasLayer(this)){if(this._map=c,this._zoomAnimated=c._zoomAnimated,this.getEvents){var f=this.getEvents();c.on(f,this),this.once("remove",function(){c.off(f,this)},this)}this.onAdd(c),this.fire("add"),c.fire("layeradd",{layer:this})}}});qe.include({addLayer:function(s){if(!s._layerAdd)throw new Error("The provided object is not a Layer.");var c=d(s);return this._layers[c]?this:(this._layers[c]=s,s._mapToAdd=this,s.beforeAdd&&s.beforeAdd(this),this.whenReady(s._layerAdd,s),this)},removeLayer:function(s){var c=d(s);return this._layers[c]?(this._loaded&&s.onRemove(this),delete this._layers[c],this._loaded&&(this.fire("layerremove",{layer:s}),s.fire("remove")),s._map=s._mapToAdd=null,this):this},hasLayer:function(s){return d(s)in this._layers},eachLayer:function(s,c){for(var f in this._layers)s.call(c,this._layers[f]);return this},_addLayers:function(s){s=s?A(s)?s:[s]:[];for(var c=0,f=s.length;c<f;c++)this.addLayer(s[c])},_addZoomLimit:function(s){(!isNaN(s.options.maxZoom)||!isNaN(s.options.minZoom))&&(this._zoomBoundLayers[d(s)]=s,this._updateZoomLevels())},_removeZoomLimit:function(s){var c=d(s);this._zoomBoundLayers[c]&&(delete this._zoomBoundLayers[c],this._updateZoomLevels())},_updateZoomLevels:function(){var s=1/0,c=-1/0,f=this._getZoomSpan();for(var p in this._zoomBoundLayers){var _=this._zoomBoundLayers[p].options;s=_.minZoom===void 0?s:Math.min(s,_.minZoom),c=_.maxZoom===void 0?c:Math.max(c,_.maxZoom)}this._layersMaxZoom=c===-1/0?void 0:c,this._layersMinZoom=s===1/0?void 0:s,f!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Tt=ot.extend({initialize:function(s,c){P(this,c),this._layers={};var f,p;if(s)for(f=0,p=s.length;f<p;f++)this.addLayer(s[f])},addLayer:function(s){var c=this.getLayerId(s);return this._layers[c]=s,this._map&&this._map.addLayer(s),this},removeLayer:function(s){var c=s in this._layers?s:this.getLayerId(s);return this._map&&this._layers[c]&&this._map.removeLayer(this._layers[c]),delete this._layers[c],this},hasLayer:function(s){var c=typeof s=="number"?s:this.getLayerId(s);return c in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(s){var c=Array.prototype.slice.call(arguments,1),f,p;for(f in this._layers)p=this._layers[f],p[s]&&p[s].apply(p,c);return this},onAdd:function(s){this.eachLayer(s.addLayer,s)},onRemove:function(s){this.eachLayer(s.removeLayer,s)},eachLayer:function(s,c){for(var f in this._layers)s.call(c,this._layers[f]);return this},getLayer:function(s){return this._layers[s]},getLayers:function(){var s=[];return this.eachLayer(s.push,s),s},setZIndex:function(s){return this.invoke("setZIndex",s)},getLayerId:function(s){return d(s)}}),Ss=function(s,c){return new Tt(s,c)},Mt=Tt.extend({addLayer:function(s){return this.hasLayer(s)?this:(s.addEventParent(this),Tt.prototype.addLayer.call(this,s),this.fire("layeradd",{layer:s}))},removeLayer:function(s){return this.hasLayer(s)?(s in this._layers&&(s=this._layers[s]),s.removeEventParent(this),Tt.prototype.removeLayer.call(this,s),this.fire("layerremove",{layer:s})):this},setStyle:function(s){return this.invoke("setStyle",s)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var s=new pe;for(var c in this._layers){var f=this._layers[c];s.extend(f.getBounds?f.getBounds():f.getLatLng())}return s}}),Za=function(s,c){return new Mt(s,c)},ni=ee.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(s){P(this,s)},createIcon:function(s){return this._createIcon("icon",s)},createShadow:function(s){return this._createIcon("shadow",s)},_createIcon:function(s,c){var f=this._getIconUrl(s);if(!f){if(s==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var p=this._createImg(f,c&&c.tagName==="IMG"?c:null);return this._setIconStyles(p,s),(this.options.crossOrigin||this.options.crossOrigin==="")&&(p.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),p},_setIconStyles:function(s,c){var f=this.options,p=f[c+"Size"];typeof p=="number"&&(p=[p,p]);var _=te(p),k=te(c==="shadow"&&f.shadowAnchor||f.iconAnchor||_&&_.divideBy(2,!0));s.className="leaflet-marker-"+c+" "+(f.className||""),k&&(s.style.marginLeft=-k.x+"px",s.style.marginTop=-k.y+"px"),_&&(s.style.width=_.x+"px",s.style.height=_.y+"px")},_createImg:function(s,c){return c=c||document.createElement("img"),c.src=s,c},_getIconUrl:function(s){return Te.retina&&this.options[s+"RetinaUrl"]||this.options[s+"Url"]}});function jN(s){return new ni(s)}var Ic=ni.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(s){return typeof Ic.imagePath!="string"&&(Ic.imagePath=this._detectIconPath()),(this.options.imagePath||Ic.imagePath)+ni.prototype._getIconUrl.call(this,s)},_stripUrl:function(s){var c=function(f,p,_){var k=p.exec(f);return k&&k[_]};return s=c(s,/^url\((['"])?(.+)\1\)$/,2),s&&c(s,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var s=Le("div","leaflet-default-icon-path",document.body),c=Xr(s,"background-image")||Xr(s,"backgroundImage");if(document.body.removeChild(s),c=this._stripUrl(c),c)return c;var f=document.querySelector('link[href$="leaflet.css"]');return f?f.href.substring(0,f.href.length-11-1):""}}),nv=rr.extend({initialize:function(s){this._marker=s},addHooks:function(){var s=this._marker._icon;this._draggable||(this._draggable=new Mr(s,s,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),je(s,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&lt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(s){var c=this._marker,f=c._map,p=this._marker.options.autoPanSpeed,_=this._marker.options.autoPanPadding,k=fe(c._icon),V=f.getPixelBounds(),$=f.getPixelOrigin(),Y=de(V.min._subtract($).add(_),V.max._subtract($).subtract(_));if(!Y.contains(k)){var ne=te((Math.max(Y.max.x,k.x)-Y.max.x)/(V.max.x-Y.max.x)-(Math.min(Y.min.x,k.x)-Y.min.x)/(V.min.x-Y.min.x),(Math.max(Y.max.y,k.y)-Y.max.y)/(V.max.y-Y.max.y)-(Math.min(Y.min.y,k.y)-Y.min.y)/(V.min.y-Y.min.y)).multiplyBy(p);f.panBy(ne,{animate:!1}),this._draggable._newPos._add(ne),this._draggable._startPos._add(ne),Q(c._icon,this._draggable._newPos),this._onDrag(s),this._panRequest=O(this._adjustPan.bind(this,s))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(s){this._marker.options.autoPan&&(B(this._panRequest),this._panRequest=O(this._adjustPan.bind(this,s)))},_onDrag:function(s){var c=this._marker,f=c._shadow,p=fe(c._icon),_=c._map.layerPointToLatLng(p);f&&Q(f,p),c._latlng=_,s.latlng=_,s.oldLatLng=this._oldLatLng,c.fire("move",s).fire("drag",s)},_onDragEnd:function(s){B(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",s)}}),Cd=ot.extend({options:{icon:new Ic,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(s,c){P(this,c),this._latlng=se(s)},onAdd:function(s){this._zoomAnimated=this._zoomAnimated&&s.options.markerZoomAnimation,this._zoomAnimated&&s.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(s){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&s.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(s){var c=this._latlng;return this._latlng=se(s),this.update(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},setZIndexOffset:function(s){return this.options.zIndexOffset=s,this.update()},getIcon:function(){return this.options.icon},setIcon:function(s){return this.options.icon=s,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var s=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(s)}return this},_initIcon:function(){var s=this.options,c="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),f=s.icon.createIcon(this._icon),p=!1;f!==this._icon&&(this._icon&&this._removeIcon(),p=!0,s.title&&(f.title=s.title),f.tagName==="IMG"&&(f.alt=s.alt||"")),je(f,c),s.keyboard&&(f.tabIndex="0",f.setAttribute("role","button")),this._icon=f,s.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Pe(f,"focus",this._panOnFocus,this);var _=s.icon.createShadow(this._shadow),k=!1;_!==this._shadow&&(this._removeShadow(),k=!0),_&&(je(_,c),_.alt=""),this._shadow=_,s.opacity<1&&this._updateOpacity(),p&&this.getPane().appendChild(this._icon),this._initInteraction(),_&&k&&this.getPane(s.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&st(this._icon,"focus",this._panOnFocus,this),ye(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&ye(this._shadow),this._shadow=null},_setPos:function(s){this._icon&&Q(this._icon,s),this._shadow&&Q(this._shadow,s),this._zIndex=s.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(s){this._icon&&(this._icon.style.zIndex=this._zIndex+s)},_animateZoom:function(s){var c=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center).round();this._setPos(c)},_initInteraction:function(){if(this.options.interactive&&(je(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),nv)){var s=this.options.draggable;this.dragging&&(s=this.dragging.enabled(),this.dragging.disable()),this.dragging=new nv(this),s&&this.dragging.enable()}},setOpacity:function(s){return this.options.opacity=s,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var s=this.options.opacity;this._icon&&pt(this._icon,s),this._shadow&&pt(this._shadow,s)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var s=this._map;if(s){var c=this.options.icon.options,f=c.iconSize?te(c.iconSize):te(0,0),p=c.iconAnchor?te(c.iconAnchor):te(0,0);s.panInside(this._latlng,{paddingTopLeft:p,paddingBottomRight:f.subtract(p)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function LN(s,c){return new Cd(s,c)}var Ns=ot.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(s){this._renderer=s.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(s){return P(this,s),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&s&&Object.prototype.hasOwnProperty.call(s,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Ad=Ns.extend({options:{fill:!0,radius:10},initialize:function(s,c){P(this,c),this._latlng=se(s),this._radius=this.options.radius},setLatLng:function(s){var c=this._latlng;return this._latlng=se(s),this.redraw(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(s){return this.options.radius=this._radius=s,this.redraw()},getRadius:function(){return this._radius},setStyle:function(s){var c=s&&s.radius||this._radius;return Ns.prototype.setStyle.call(this,s),this.setRadius(c),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var s=this._radius,c=this._radiusY||s,f=this._clickTolerance(),p=[s+f,c+f];this._pxBounds=new ke(this._point.subtract(p),this._point.add(p))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(s){return s.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function DN(s,c){return new Ad(s,c)}var Qm=Ad.extend({initialize:function(s,c,f){if(typeof c=="number"&&(c=i({},f,{radius:c})),P(this,c),this._latlng=se(s),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(s){return this._mRadius=s,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var s=[this._radius,this._radiusY||this._radius];return new pe(this._map.layerPointToLatLng(this._point.subtract(s)),this._map.layerPointToLatLng(this._point.add(s)))},setStyle:Ns.prototype.setStyle,_project:function(){var s=this._latlng.lng,c=this._latlng.lat,f=this._map,p=f.options.crs;if(p.distance===Ye.distance){var _=Math.PI/180,k=this._mRadius/Ye.R/_,V=f.project([c+k,s]),$=f.project([c-k,s]),Y=V.add($).divideBy(2),ne=f.unproject(Y).lat,ge=Math.acos((Math.cos(k*_)-Math.sin(c*_)*Math.sin(ne*_))/(Math.cos(c*_)*Math.cos(ne*_)))/_;(isNaN(ge)||ge===0)&&(ge=k/Math.cos(Math.PI/180*c)),this._point=Y.subtract(f.getPixelOrigin()),this._radius=isNaN(ge)?0:Y.x-f.project([ne,s-ge]).x,this._radiusY=Y.y-V.y}else{var Ce=p.unproject(p.project(this._latlng).subtract([this._mRadius,0]));this._point=f.latLngToLayerPoint(this._latlng),this._radius=this._point.x-f.latLngToLayerPoint(Ce).x}this._updateBounds()}});function MN(s,c,f){return new Qm(s,c,f)}var Ci=Ns.extend({options:{smoothFactor:1,noClip:!1},initialize:function(s,c){P(this,c),this._setLatLngs(s)},getLatLngs:function(){return this._latlngs},setLatLngs:function(s){return this._setLatLngs(s),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(s){for(var c=1/0,f=null,p=vr,_,k,V=0,$=this._parts.length;V<$;V++)for(var Y=this._parts[V],ne=1,ge=Y.length;ne<ge;ne++){_=Y[ne-1],k=Y[ne];var Ce=p(s,_,k,!0);Ce<c&&(c=Ce,f=p(s,_,k))}return f&&(f.distance=Math.sqrt(c)),f},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return x(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(s,c){return c=c||this._defaultShape(),s=se(s),c.push(s),this._bounds.extend(s),this.redraw()},_setLatLngs:function(s){this._bounds=new pe,this._latlngs=this._convertLatLngs(s)},_defaultShape:function(){return h(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(s){for(var c=[],f=h(s),p=0,_=s.length;p<_;p++)f?(c[p]=se(s[p]),this._bounds.extend(c[p])):c[p]=this._convertLatLngs(s[p]);return c},_project:function(){var s=new ke;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,s),this._bounds.isValid()&&s.isValid()&&(this._rawPxBounds=s,this._updateBounds())},_updateBounds:function(){var s=this._clickTolerance(),c=new G(s,s);this._rawPxBounds&&(this._pxBounds=new ke([this._rawPxBounds.min.subtract(c),this._rawPxBounds.max.add(c)]))},_projectLatlngs:function(s,c,f){var p=s[0]instanceof he,_=s.length,k,V;if(p){for(V=[],k=0;k<_;k++)V[k]=this._map.latLngToLayerPoint(s[k]),f.extend(V[k]);c.push(V)}else for(k=0;k<_;k++)this._projectLatlngs(s[k],c,f)},_clipPoints:function(){var s=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}var c=this._parts,f,p,_,k,V,$,Y;for(f=0,_=0,k=this._rings.length;f<k;f++)for(Y=this._rings[f],p=0,V=Y.length;p<V-1;p++)$=Fo(Y[p],Y[p+1],s,p,!0),$&&(c[_]=c[_]||[],c[_].push($[0]),($[1]!==Y[p+1]||p===V-2)&&(c[_].push($[1]),_++))}},_simplifyPoints:function(){for(var s=this._parts,c=this.options.smoothFactor,f=0,p=s.length;f<p;f++)s[f]=wc(s[f],c)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(s,c){var f,p,_,k,V,$,Y=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(f=0,k=this._parts.length;f<k;f++)for($=this._parts[f],p=0,V=$.length,_=V-1;p<V;_=p++)if(!(!c&&p===0)&&bc(s,$[_],$[p])<=Y)return!0;return!1}});function ON(s,c){return new Ci(s,c)}Ci._flat=y;var Qa=Ci.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ha(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(s){var c=Ci.prototype._convertLatLngs.call(this,s),f=c.length;return f>=2&&c[0]instanceof he&&c[0].equals(c[f-1])&&c.pop(),c},_setLatLngs:function(s){Ci.prototype._setLatLngs.call(this,s),h(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return h(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var s=this._renderer._bounds,c=this.options.weight,f=new G(c,c);if(s=new ke(s.min.subtract(f),s.max.add(f)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}for(var p=0,_=this._rings.length,k;p<_;p++)k=$a(this._rings[p],s,!0),k.length&&this._parts.push(k)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(s){var c=!1,f,p,_,k,V,$,Y,ne;if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(k=0,Y=this._parts.length;k<Y;k++)for(f=this._parts[k],V=0,ne=f.length,$=ne-1;V<ne;$=V++)p=f[V],_=f[$],p.y>s.y!=_.y>s.y&&s.x<(_.x-p.x)*(s.y-p.y)/(_.y-p.y)+p.x&&(c=!c);return c||Ci.prototype._containsPoint.call(this,s,!0)}});function VN(s,c){return new Qa(s,c)}var Ai=Mt.extend({initialize:function(s,c){P(this,c),this._layers={},s&&this.addData(s)},addData:function(s){var c=A(s)?s:s.features,f,p,_;if(c){for(f=0,p=c.length;f<p;f++)_=c[f],(_.geometries||_.geometry||_.features||_.coordinates)&&this.addData(_);return this}var k=this.options;if(k.filter&&!k.filter(s))return this;var V=Rd(s,k);return V?(V.feature=Dd(s),V.defaultOptions=V.options,this.resetStyle(V),k.onEachFeature&&k.onEachFeature(s,V),this.addLayer(V)):this},resetStyle:function(s){return s===void 0?this.eachLayer(this.resetStyle,this):(s.options=i({},s.defaultOptions),this._setLayerStyle(s,this.options.style),this)},setStyle:function(s){return this.eachLayer(function(c){this._setLayerStyle(c,s)},this)},_setLayerStyle:function(s,c){s.setStyle&&(typeof c=="function"&&(c=c(s.feature)),s.setStyle(c))}});function Rd(s,c){var f=s.type==="Feature"?s.geometry:s,p=f?f.coordinates:null,_=[],k=c&&c.pointToLayer,V=c&&c.coordsToLatLng||Ym,$,Y,ne,ge;if(!p&&!f)return null;switch(f.type){case"Point":return $=V(p),rv(k,s,$,c);case"MultiPoint":for(ne=0,ge=p.length;ne<ge;ne++)$=V(p[ne]),_.push(rv(k,s,$,c));return new Mt(_);case"LineString":case"MultiLineString":return Y=jd(p,f.type==="LineString"?0:1,V),new Ci(Y,c);case"Polygon":case"MultiPolygon":return Y=jd(p,f.type==="Polygon"?1:2,V),new Qa(Y,c);case"GeometryCollection":for(ne=0,ge=f.geometries.length;ne<ge;ne++){var Ce=Rd({geometry:f.geometries[ne],type:"Feature",properties:s.properties},c);Ce&&_.push(Ce)}return new Mt(_);case"FeatureCollection":for(ne=0,ge=f.features.length;ne<ge;ne++){var Fe=Rd(f.features[ne],c);Fe&&_.push(Fe)}return new Mt(_);default:throw new Error("Invalid GeoJSON object.")}}function rv(s,c,f,p){return s?s(c,f):new Cd(f,p&&p.markersInheritOptions&&p)}function Ym(s){return new he(s[1],s[0],s[2])}function jd(s,c,f){for(var p=[],_=0,k=s.length,V;_<k;_++)V=c?jd(s[_],c-1,f):(f||Ym)(s[_]),p.push(V);return p}function Jm(s,c){return s=se(s),s.alt!==void 0?[w(s.lng,c),w(s.lat,c),w(s.alt,c)]:[w(s.lng,c),w(s.lat,c)]}function Ld(s,c,f,p){for(var _=[],k=0,V=s.length;k<V;k++)_.push(c?Ld(s[k],h(s[k])?0:c-1,f,p):Jm(s[k],p));return!c&&f&&_.length>0&&_.push(_[0].slice()),_}function Ya(s,c){return s.feature?i({},s.feature,{geometry:c}):Dd(c)}function Dd(s){return s.type==="Feature"||s.type==="FeatureCollection"?s:{type:"Feature",properties:{},geometry:s}}var Xm={toGeoJSON:function(s){return Ya(this,{type:"Point",coordinates:Jm(this.getLatLng(),s)})}};Cd.include(Xm),Qm.include(Xm),Ad.include(Xm),Ci.include({toGeoJSON:function(s){var c=!h(this._latlngs),f=Ld(this._latlngs,c?1:0,!1,s);return Ya(this,{type:(c?"Multi":"")+"LineString",coordinates:f})}}),Qa.include({toGeoJSON:function(s){var c=!h(this._latlngs),f=c&&!h(this._latlngs[0]),p=Ld(this._latlngs,f?2:c?1:0,!0,s);return c||(p=[p]),Ya(this,{type:(f?"Multi":"")+"Polygon",coordinates:p})}}),Tt.include({toMultiPoint:function(s){var c=[];return this.eachLayer(function(f){c.push(f.toGeoJSON(s).geometry.coordinates)}),Ya(this,{type:"MultiPoint",coordinates:c})},toGeoJSON:function(s){var c=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(c==="MultiPoint")return this.toMultiPoint(s);var f=c==="GeometryCollection",p=[];return this.eachLayer(function(_){if(_.toGeoJSON){var k=_.toGeoJSON(s);if(f)p.push(k.geometry);else{var V=Dd(k);V.type==="FeatureCollection"?p.push.apply(p,V.features):p.push(V)}}}),f?Ya(this,{geometries:p,type:"GeometryCollection"}):{type:"FeatureCollection",features:p}}});function iv(s,c){return new Ai(s,c)}var FN=iv,Md=ot.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(s,c,f){this._url=s,this._bounds=ve(c),P(this,f)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(je(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){ye(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(s){return this.options.opacity=s,this._image&&this._updateOpacity(),this},setStyle:function(s){return s.opacity&&this.setOpacity(s.opacity),this},bringToFront:function(){return this._map&&pr(this._image),this},bringToBack:function(){return this._map&&Lr(this._image),this},setUrl:function(s){return this._url=s,this._image&&(this._image.src=s),this},setBounds:function(s){return this._bounds=ve(s),this._map&&this._reset(),this},getEvents:function(){var s={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var s=this._url.tagName==="IMG",c=this._image=s?this._url:Le("img");if(je(c,"leaflet-image-layer"),this._zoomAnimated&&je(c,"leaflet-zoom-animated"),this.options.className&&je(c,this.options.className),c.onselectstart=v,c.onmousemove=v,c.onload=a(this.fire,this,"load"),c.onerror=a(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(c.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),s){this._url=c.src;return}c.src=this._url,c.alt=this.options.alt},_animateZoom:function(s){var c=this._map.getZoomScale(s.zoom),f=this._map._latLngBoundsToNewLayerBounds(this._bounds,s.zoom,s.center).min;K(this._image,f,c)},_reset:function(){var s=this._image,c=new ke(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),f=c.getSize();Q(s,c.min),s.style.width=f.x+"px",s.style.height=f.y+"px"},_updateOpacity:function(){pt(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var s=this.options.errorOverlayUrl;s&&this._url!==s&&(this._url=s,this._image.src=s)},getCenter:function(){return this._bounds.getCenter()}}),UN=function(s,c,f){return new Md(s,c,f)},sv=Md.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var s=this._url.tagName==="VIDEO",c=this._image=s?this._url:Le("video");if(je(c,"leaflet-image-layer"),this._zoomAnimated&&je(c,"leaflet-zoom-animated"),this.options.className&&je(c,this.options.className),c.onselectstart=v,c.onmousemove=v,c.onloadeddata=a(this.fire,this,"load"),s){for(var f=c.getElementsByTagName("source"),p=[],_=0;_<f.length;_++)p.push(f[_].src);this._url=f.length>0?p:[c.src];return}A(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(c.style,"objectFit")&&(c.style.objectFit="fill"),c.autoplay=!!this.options.autoplay,c.loop=!!this.options.loop,c.muted=!!this.options.muted,c.playsInline=!!this.options.playsInline;for(var k=0;k<this._url.length;k++){var V=Le("source");V.src=this._url[k],c.appendChild(V)}}});function BN(s,c,f){return new sv(s,c,f)}var ov=Md.extend({_initImage:function(){var s=this._image=this._url;je(s,"leaflet-image-layer"),this._zoomAnimated&&je(s,"leaflet-zoom-animated"),this.options.className&&je(s,this.options.className),s.onselectstart=v,s.onmousemove=v}});function zN(s,c,f){return new ov(s,c,f)}var ri=ot.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(s,c){s&&(s instanceof he||A(s))?(this._latlng=se(s),P(this,c)):(P(this,s),this._source=c),this.options.content&&(this._content=this.options.content)},openOn:function(s){return s=arguments.length?s:this._source._map,s.hasLayer(this)||s.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(s){return this._map?this.close():(arguments.length?this._source=s:s=this._source,this._prepareOpen(),this.openOn(s._map)),this},onAdd:function(s){this._zoomAnimated=s._zoomAnimated,this._container||this._initLayout(),s._fadeAnimated&&pt(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),s._fadeAnimated&&pt(this._container,1),this.bringToFront(),this.options.interactive&&(je(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(s){s._fadeAnimated?(pt(this._container,0),this._removeTimeout=setTimeout(a(ye,void 0,this._container),200)):ye(this._container),this.options.interactive&&(lt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(s){return this._latlng=se(s),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(s){return this._content=s,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var s={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&pr(this._container),this},bringToBack:function(){return this._map&&Lr(this._container),this},_prepareOpen:function(s){var c=this._source;if(!c._map)return!1;if(c instanceof Mt){c=null;var f=this._source._layers;for(var p in f)if(f[p]._map){c=f[p];break}if(!c)return!1;this._source=c}if(!s)if(c.getCenter)s=c.getCenter();else if(c.getLatLng)s=c.getLatLng();else if(c.getBounds)s=c.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(s),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var s=this._contentNode,c=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof c=="string")s.innerHTML=c;else{for(;s.hasChildNodes();)s.removeChild(s.firstChild);s.appendChild(c)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var s=this._map.latLngToLayerPoint(this._latlng),c=te(this.options.offset),f=this._getAnchor();this._zoomAnimated?Q(this._container,s.add(f)):c=c.add(s).add(f);var p=this._containerBottom=-c.y,_=this._containerLeft=-Math.round(this._containerWidth/2)+c.x;this._container.style.bottom=p+"px",this._container.style.left=_+"px"}},_getAnchor:function(){return[0,0]}});qe.include({_initOverlay:function(s,c,f,p){var _=c;return _ instanceof s||(_=new s(p).setContent(c)),f&&_.setLatLng(f),_}}),ot.include({_initOverlay:function(s,c,f,p){var _=f;return _ instanceof s?(P(_,p),_._source=this):(_=c&&!p?c:new s(p,this),_.setContent(f)),_}});var Od=ri.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(s){return s=arguments.length?s:this._source._map,!s.hasLayer(this)&&s._popup&&s._popup.options.autoClose&&s.removeLayer(s._popup),s._popup=this,ri.prototype.openOn.call(this,s)},onAdd:function(s){ri.prototype.onAdd.call(this,s),s.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Ns||this._source.on("preclick",_r))},onRemove:function(s){ri.prototype.onRemove.call(this,s),s.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Ns||this._source.off("preclick",_r))},getEvents:function(){var s=ri.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(s.preclick=this.close),this.options.keepInView&&(s.moveend=this._adjustPan),s},_initLayout:function(){var s="leaflet-popup",c=this._container=Le("div",s+" "+(this.options.className||"")+" leaflet-zoom-animated"),f=this._wrapper=Le("div",s+"-content-wrapper",c);if(this._contentNode=Le("div",s+"-content",f),Ts(c),Is(this._contentNode),Pe(c,"contextmenu",_r),this._tipContainer=Le("div",s+"-tip-container",c),this._tip=Le("div",s+"-tip",this._tipContainer),this.options.closeButton){var p=this._closeButton=Le("a",s+"-close-button",c);p.setAttribute("role","button"),p.setAttribute("aria-label","Close popup"),p.href="#close",p.innerHTML='<span aria-hidden="true">&#215;</span>',Pe(p,"click",function(_){It(_),this.close()},this)}},_updateLayout:function(){var s=this._contentNode,c=s.style;c.width="",c.whiteSpace="nowrap";var f=s.offsetWidth;f=Math.min(f,this.options.maxWidth),f=Math.max(f,this.options.minWidth),c.width=f+1+"px",c.whiteSpace="",c.height="";var p=s.offsetHeight,_=this.options.maxHeight,k="leaflet-popup-scrolled";_&&p>_?(c.height=_+"px",je(s,k)):lt(s,k),this._containerWidth=this._container.offsetWidth},_animateZoom:function(s){var c=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center),f=this._getAnchor();Q(this._container,c.add(f))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var s=this._map,c=parseInt(Xr(this._container,"marginBottom"),10)||0,f=this._container.offsetHeight+c,p=this._containerWidth,_=new G(this._containerLeft,-f-this._containerBottom);_._add(fe(this._container));var k=s.layerPointToContainerPoint(_),V=te(this.options.autoPanPadding),$=te(this.options.autoPanPaddingTopLeft||V),Y=te(this.options.autoPanPaddingBottomRight||V),ne=s.getSize(),ge=0,Ce=0;k.x+p+Y.x>ne.x&&(ge=k.x+p-ne.x+Y.x),k.x-ge-$.x<0&&(ge=k.x-$.x),k.y+f+Y.y>ne.y&&(Ce=k.y+f-ne.y+Y.y),k.y-Ce-$.y<0&&(Ce=k.y-$.y),(ge||Ce)&&(this.options.keepInView&&(this._autopanning=!0),s.fire("autopanstart").panBy([ge,Ce]))}},_getAnchor:function(){return te(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),qN=function(s,c){return new Od(s,c)};qe.mergeOptions({closePopupOnClick:!0}),qe.include({openPopup:function(s,c,f){return this._initOverlay(Od,s,c,f).openOn(this),this},closePopup:function(s){return s=arguments.length?s:this._popup,s&&s.close(),this}}),ot.include({bindPopup:function(s,c){return this._popup=this._initOverlay(Od,this._popup,s,c),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(s){return this._popup&&(this instanceof Mt||(this._popup._source=this),this._popup._prepareOpen(s||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(s){return this._popup&&this._popup.setContent(s),this},getPopup:function(){return this._popup},_openPopup:function(s){if(!(!this._popup||!this._map)){nr(s);var c=s.layer||s.target;if(this._popup._source===c&&!(c instanceof Ns)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(s.latlng);return}this._popup._source=c,this.openPopup(s.latlng)}},_movePopup:function(s){this._popup.setLatLng(s.latlng)},_onKeyPress:function(s){s.originalEvent.keyCode===13&&this._openPopup(s)}});var Vd=ri.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(s){ri.prototype.onAdd.call(this,s),this.setOpacity(this.options.opacity),s.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(s){ri.prototype.onRemove.call(this,s),s.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var s=ri.prototype.getEvents.call(this);return this.options.permanent||(s.preclick=this.close),s},_initLayout:function(){var s="leaflet-tooltip",c=s+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Le("div",c),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+d(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(s){var c,f,p=this._map,_=this._container,k=p.latLngToContainerPoint(p.getCenter()),V=p.layerPointToContainerPoint(s),$=this.options.direction,Y=_.offsetWidth,ne=_.offsetHeight,ge=te(this.options.offset),Ce=this._getAnchor();$==="top"?(c=Y/2,f=ne):$==="bottom"?(c=Y/2,f=0):$==="center"?(c=Y/2,f=ne/2):$==="right"?(c=0,f=ne/2):$==="left"?(c=Y,f=ne/2):V.x<k.x?($="right",c=0,f=ne/2):($="left",c=Y+(ge.x+Ce.x)*2,f=ne/2),s=s.subtract(te(c,f,!0)).add(ge).add(Ce),lt(_,"leaflet-tooltip-right"),lt(_,"leaflet-tooltip-left"),lt(_,"leaflet-tooltip-top"),lt(_,"leaflet-tooltip-bottom"),je(_,"leaflet-tooltip-"+$),Q(_,s)},_updatePosition:function(){var s=this._map.latLngToLayerPoint(this._latlng);this._setPosition(s)},setOpacity:function(s){this.options.opacity=s,this._container&&pt(this._container,s)},_animateZoom:function(s){var c=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center);this._setPosition(c)},_getAnchor:function(){return te(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),$N=function(s,c){return new Vd(s,c)};qe.include({openTooltip:function(s,c,f){return this._initOverlay(Vd,s,c,f).openOn(this),this},closeTooltip:function(s){return s.close(),this}}),ot.include({bindTooltip:function(s,c){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Vd,this._tooltip,s,c),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(s){if(!(!s&&this._tooltipHandlersAdded)){var c=s?"off":"on",f={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?f.add=this._openTooltip:(f.mouseover=this._openTooltip,f.mouseout=this.closeTooltip,f.click=this._openTooltip,this._map?this._addFocusListeners():f.add=this._addFocusListeners),this._tooltip.options.sticky&&(f.mousemove=this._moveTooltip),this[c](f),this._tooltipHandlersAdded=!s}},openTooltip:function(s){return this._tooltip&&(this instanceof Mt||(this._tooltip._source=this),this._tooltip._prepareOpen(s)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(s){return this._tooltip&&this._tooltip.setContent(s),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(s){var c=typeof s.getElement=="function"&&s.getElement();c&&(Pe(c,"focus",function(){this._tooltip._source=s,this.openTooltip()},this),Pe(c,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(s){var c=typeof s.getElement=="function"&&s.getElement();c&&c.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(s){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var c=this;this._map.once("moveend",function(){c._openOnceFlag=!1,c._openTooltip(s)});return}this._tooltip._source=s.layer||s.target,this.openTooltip(this._tooltip.options.sticky?s.latlng:void 0)}},_moveTooltip:function(s){var c=s.latlng,f,p;this._tooltip.options.sticky&&s.originalEvent&&(f=this._map.mouseEventToContainerPoint(s.originalEvent),p=this._map.containerPointToLayerPoint(f),c=this._map.layerPointToLatLng(p)),this._tooltip.setLatLng(c)}});var av=ni.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(s){var c=s&&s.tagName==="DIV"?s:document.createElement("div"),f=this.options;if(f.html instanceof Element?(ei(c),c.appendChild(f.html)):c.innerHTML=f.html!==!1?f.html:"",f.bgPos){var p=te(f.bgPos);c.style.backgroundPosition=-p.x+"px "+-p.y+"px"}return this._setIconStyles(c,"icon"),c},createShadow:function(){return null}});function HN(s){return new av(s)}ni.Default=Ic;var Tc=ot.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Te.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(s){P(this,s)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(s){s._addZoomLimit(this)},onRemove:function(s){this._removeAllTiles(),ye(this._container),s._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(pr(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Lr(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(s){return this.options.opacity=s,this._updateOpacity(),this},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var s=this._clampZoom(this._map.getZoom());s!==this._tileZoom&&(this._tileZoom=s,this._updateLevels()),this._update()}return this},getEvents:function(){var s={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=m(this._onMoveEnd,this.options.updateInterval,this)),s.move=this._onMove),this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},createTile:function(){return document.createElement("div")},getTileSize:function(){var s=this.options.tileSize;return s instanceof G?s:new G(s,s)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(s){for(var c=this.getPane().children,f=-s(-1/0,1/0),p=0,_=c.length,k;p<_;p++)k=c[p].style.zIndex,c[p]!==this._container&&k&&(f=s(f,+k));isFinite(f)&&(this.options.zIndex=f+s(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Te.ielt9){pt(this._container,this.options.opacity);var s=+new Date,c=!1,f=!1;for(var p in this._tiles){var _=this._tiles[p];if(!(!_.current||!_.loaded)){var k=Math.min(1,(s-_.loaded)/200);pt(_.el,k),k<1?c=!0:(_.active?f=!0:this._onOpaqueTile(_),_.active=!0)}}f&&!this._noPrune&&this._pruneTiles(),c&&(B(this._fadeFrame),this._fadeFrame=O(this._updateOpacity,this))}},_onOpaqueTile:v,_initContainer:function(){this._container||(this._container=Le("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var s=this._tileZoom,c=this.options.maxZoom;if(s!==void 0){for(var f in this._levels)f=Number(f),this._levels[f].el.children.length||f===s?(this._levels[f].el.style.zIndex=c-Math.abs(s-f),this._onUpdateLevel(f)):(ye(this._levels[f].el),this._removeTilesAtZoom(f),this._onRemoveLevel(f),delete this._levels[f]);var p=this._levels[s],_=this._map;return p||(p=this._levels[s]={},p.el=Le("div","leaflet-tile-container leaflet-zoom-animated",this._container),p.el.style.zIndex=c,p.origin=_.project(_.unproject(_.getPixelOrigin()),s).round(),p.zoom=s,this._setZoomTransform(p,_.getCenter(),_.getZoom()),v(p.el.offsetWidth),this._onCreateLevel(p)),this._level=p,p}},_onUpdateLevel:v,_onRemoveLevel:v,_onCreateLevel:v,_pruneTiles:function(){if(this._map){var s,c,f=this._map.getZoom();if(f>this.options.maxZoom||f<this.options.minZoom){this._removeAllTiles();return}for(s in this._tiles)c=this._tiles[s],c.retain=c.current;for(s in this._tiles)if(c=this._tiles[s],c.current&&!c.active){var p=c.coords;this._retainParent(p.x,p.y,p.z,p.z-5)||this._retainChildren(p.x,p.y,p.z,p.z+2)}for(s in this._tiles)this._tiles[s].retain||this._removeTile(s)}},_removeTilesAtZoom:function(s){for(var c in this._tiles)this._tiles[c].coords.z===s&&this._removeTile(c)},_removeAllTiles:function(){for(var s in this._tiles)this._removeTile(s)},_invalidateAll:function(){for(var s in this._levels)ye(this._levels[s].el),this._onRemoveLevel(Number(s)),delete this._levels[s];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(s,c,f,p){var _=Math.floor(s/2),k=Math.floor(c/2),V=f-1,$=new G(+_,+k);$.z=+V;var Y=this._tileCoordsToKey($),ne=this._tiles[Y];return ne&&ne.active?(ne.retain=!0,!0):(ne&&ne.loaded&&(ne.retain=!0),V>p?this._retainParent(_,k,V,p):!1)},_retainChildren:function(s,c,f,p){for(var _=2*s;_<2*s+2;_++)for(var k=2*c;k<2*c+2;k++){var V=new G(_,k);V.z=f+1;var $=this._tileCoordsToKey(V),Y=this._tiles[$];if(Y&&Y.active){Y.retain=!0;continue}else Y&&Y.loaded&&(Y.retain=!0);f+1<p&&this._retainChildren(_,k,f+1,p)}},_resetView:function(s){var c=s&&(s.pinch||s.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),c,c)},_animateZoom:function(s){this._setView(s.center,s.zoom,!0,s.noUpdate)},_clampZoom:function(s){var c=this.options;return c.minNativeZoom!==void 0&&s<c.minNativeZoom?c.minNativeZoom:c.maxNativeZoom!==void 0&&c.maxNativeZoom<s?c.maxNativeZoom:s},_setView:function(s,c,f,p){var _=Math.round(c);this.options.maxZoom!==void 0&&_>this.options.maxZoom||this.options.minZoom!==void 0&&_<this.options.minZoom?_=void 0:_=this._clampZoom(_);var k=this.options.updateWhenZooming&&_!==this._tileZoom;(!p||k)&&(this._tileZoom=_,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),_!==void 0&&this._update(s),f||this._pruneTiles(),this._noPrune=!!f),this._setZoomTransforms(s,c)},_setZoomTransforms:function(s,c){for(var f in this._levels)this._setZoomTransform(this._levels[f],s,c)},_setZoomTransform:function(s,c,f){var p=this._map.getZoomScale(f,s.zoom),_=s.origin.multiplyBy(p).subtract(this._map._getNewPixelOrigin(c,f)).round();Te.any3d?K(s.el,_,p):Q(s.el,_)},_resetGrid:function(){var s=this._map,c=s.options.crs,f=this._tileSize=this.getTileSize(),p=this._tileZoom,_=this._map.getPixelWorldBounds(this._tileZoom);_&&(this._globalTileRange=this._pxBoundsToTileRange(_)),this._wrapX=c.wrapLng&&!this.options.noWrap&&[Math.floor(s.project([0,c.wrapLng[0]],p).x/f.x),Math.ceil(s.project([0,c.wrapLng[1]],p).x/f.y)],this._wrapY=c.wrapLat&&!this.options.noWrap&&[Math.floor(s.project([c.wrapLat[0],0],p).y/f.x),Math.ceil(s.project([c.wrapLat[1],0],p).y/f.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(s){var c=this._map,f=c._animatingZoom?Math.max(c._animateToZoom,c.getZoom()):c.getZoom(),p=c.getZoomScale(f,this._tileZoom),_=c.project(s,this._tileZoom).floor(),k=c.getSize().divideBy(p*2);return new ke(_.subtract(k),_.add(k))},_update:function(s){var c=this._map;if(c){var f=this._clampZoom(c.getZoom());if(s===void 0&&(s=c.getCenter()),this._tileZoom!==void 0){var p=this._getTiledPixelBounds(s),_=this._pxBoundsToTileRange(p),k=_.getCenter(),V=[],$=this.options.keepBuffer,Y=new ke(_.getBottomLeft().subtract([$,-$]),_.getTopRight().add([$,-$]));if(!(isFinite(_.min.x)&&isFinite(_.min.y)&&isFinite(_.max.x)&&isFinite(_.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var ne in this._tiles){var ge=this._tiles[ne].coords;(ge.z!==this._tileZoom||!Y.contains(new G(ge.x,ge.y)))&&(this._tiles[ne].current=!1)}if(Math.abs(f-this._tileZoom)>1){this._setView(s,f);return}for(var Ce=_.min.y;Ce<=_.max.y;Ce++)for(var Fe=_.min.x;Fe<=_.max.x;Fe++){var Pn=new G(Fe,Ce);if(Pn.z=this._tileZoom,!!this._isValidTile(Pn)){var Jt=this._tiles[this._tileCoordsToKey(Pn)];Jt?Jt.current=!0:V.push(Pn)}}if(V.sort(function(qn,Xa){return qn.distanceTo(k)-Xa.distanceTo(k)}),V.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var xr=document.createDocumentFragment();for(Fe=0;Fe<V.length;Fe++)this._addTile(V[Fe],xr);this._level.el.appendChild(xr)}}}},_isValidTile:function(s){var c=this._map.options.crs;if(!c.infinite){var f=this._globalTileRange;if(!c.wrapLng&&(s.x<f.min.x||s.x>f.max.x)||!c.wrapLat&&(s.y<f.min.y||s.y>f.max.y))return!1}if(!this.options.bounds)return!0;var p=this._tileCoordsToBounds(s);return ve(this.options.bounds).overlaps(p)},_keyToBounds:function(s){return this._tileCoordsToBounds(this._keyToTileCoords(s))},_tileCoordsToNwSe:function(s){var c=this._map,f=this.getTileSize(),p=s.scaleBy(f),_=p.add(f),k=c.unproject(p,s.z),V=c.unproject(_,s.z);return[k,V]},_tileCoordsToBounds:function(s){var c=this._tileCoordsToNwSe(s),f=new pe(c[0],c[1]);return this.options.noWrap||(f=this._map.wrapLatLngBounds(f)),f},_tileCoordsToKey:function(s){return s.x+":"+s.y+":"+s.z},_keyToTileCoords:function(s){var c=s.split(":"),f=new G(+c[0],+c[1]);return f.z=+c[2],f},_removeTile:function(s){var c=this._tiles[s];c&&(ye(c.el),delete this._tiles[s],this.fire("tileunload",{tile:c.el,coords:this._keyToTileCoords(s)}))},_initTile:function(s){je(s,"leaflet-tile");var c=this.getTileSize();s.style.width=c.x+"px",s.style.height=c.y+"px",s.onselectstart=v,s.onmousemove=v,Te.ielt9&&this.options.opacity<1&&pt(s,this.options.opacity)},_addTile:function(s,c){var f=this._getTilePos(s),p=this._tileCoordsToKey(s),_=this.createTile(this._wrapCoords(s),a(this._tileReady,this,s));this._initTile(_),this.createTile.length<2&&O(a(this._tileReady,this,s,null,_)),Q(_,f),this._tiles[p]={el:_,coords:s,current:!0},c.appendChild(_),this.fire("tileloadstart",{tile:_,coords:s})},_tileReady:function(s,c,f){c&&this.fire("tileerror",{error:c,tile:f,coords:s});var p=this._tileCoordsToKey(s);f=this._tiles[p],f&&(f.loaded=+new Date,this._map._fadeAnimated?(pt(f.el,0),B(this._fadeFrame),this._fadeFrame=O(this._updateOpacity,this)):(f.active=!0,this._pruneTiles()),c||(je(f.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:f.el,coords:s})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Te.ielt9||!this._map._fadeAnimated?O(this._pruneTiles,this):setTimeout(a(this._pruneTiles,this),250)))},_getTilePos:function(s){return s.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(s){var c=new G(this._wrapX?g(s.x,this._wrapX):s.x,this._wrapY?g(s.y,this._wrapY):s.y);return c.z=s.z,c},_pxBoundsToTileRange:function(s){var c=this.getTileSize();return new ke(s.min.unscaleBy(c).floor(),s.max.unscaleBy(c).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var s in this._tiles)if(!this._tiles[s].loaded)return!1;return!0}});function WN(s){return new Tc(s)}var Ja=Tc.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(s,c){this._url=s,c=P(this,c),c.detectRetina&&Te.retina&&c.maxZoom>0?(c.tileSize=Math.floor(c.tileSize/2),c.zoomReverse?(c.zoomOffset--,c.minZoom=Math.min(c.maxZoom,c.minZoom+1)):(c.zoomOffset++,c.maxZoom=Math.max(c.minZoom,c.maxZoom-1)),c.minZoom=Math.max(0,c.minZoom)):c.zoomReverse?c.minZoom=Math.min(c.maxZoom,c.minZoom):c.maxZoom=Math.max(c.minZoom,c.maxZoom),typeof c.subdomains=="string"&&(c.subdomains=c.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(s,c){return this._url===s&&c===void 0&&(c=!0),this._url=s,c||this.redraw(),this},createTile:function(s,c){var f=document.createElement("img");return Pe(f,"load",a(this._tileOnLoad,this,c,f)),Pe(f,"error",a(this._tileOnError,this,c,f)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(f.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(f.referrerPolicy=this.options.referrerPolicy),f.alt="",f.src=this.getTileUrl(s),f},getTileUrl:function(s){var c={r:Te.retina?"@2x":"",s:this._getSubdomain(s),x:s.x,y:s.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var f=this._globalTileRange.max.y-s.y;this.options.tms&&(c.y=f),c["-y"]=f}return T(this._url,i(c,this.options))},_tileOnLoad:function(s,c){Te.ielt9?setTimeout(a(s,this,null,c),0):s(null,c)},_tileOnError:function(s,c,f){var p=this.options.errorTileUrl;p&&c.getAttribute("src")!==p&&(c.src=p),s(f,c)},_onTileRemove:function(s){s.tile.onload=null},_getZoomForUrl:function(){var s=this._tileZoom,c=this.options.maxZoom,f=this.options.zoomReverse,p=this.options.zoomOffset;return f&&(s=c-s),s+p},_getSubdomain:function(s){var c=Math.abs(s.x+s.y)%this.options.subdomains.length;return this.options.subdomains[c]},_abortLoading:function(){var s,c;for(s in this._tiles)if(this._tiles[s].coords.z!==this._tileZoom&&(c=this._tiles[s].el,c.onload=v,c.onerror=v,!c.complete)){c.src=Z;var f=this._tiles[s].coords;ye(c),delete this._tiles[s],this.fire("tileabort",{tile:c,coords:f})}},_removeTile:function(s){var c=this._tiles[s];if(c)return c.el.setAttribute("src",Z),Tc.prototype._removeTile.call(this,s)},_tileReady:function(s,c,f){if(!(!this._map||f&&f.getAttribute("src")===Z))return Tc.prototype._tileReady.call(this,s,c,f)}});function lv(s,c){return new Ja(s,c)}var cv=Ja.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(s,c){this._url=s;var f=i({},this.defaultWmsParams);for(var p in c)p in this.options||(f[p]=c[p]);c=P(this,c);var _=c.detectRetina&&Te.retina?2:1,k=this.getTileSize();f.width=k.x*_,f.height=k.y*_,this.wmsParams=f},onAdd:function(s){this._crs=this.options.crs||s.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var c=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[c]=this._crs.code,Ja.prototype.onAdd.call(this,s)},getTileUrl:function(s){var c=this._tileCoordsToNwSe(s),f=this._crs,p=de(f.project(c[0]),f.project(c[1])),_=p.min,k=p.max,V=(this._wmsVersion>=1.3&&this._crs===Ut?[_.y,_.x,k.y,k.x]:[_.x,_.y,k.x,k.y]).join(","),$=Ja.prototype.getTileUrl.call(this,s);return $+F(this.wmsParams,$,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+V},setParams:function(s,c){return i(this.wmsParams,s),c||this.redraw(),this}});function GN(s,c){return new cv(s,c)}Ja.WMS=cv,lv.wms=GN;var Ri=ot.extend({options:{padding:.1},initialize:function(s){P(this,s),d(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),je(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var s={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(s.zoomanim=this._onAnimZoom),s},_onAnimZoom:function(s){this._updateTransform(s.center,s.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(s,c){var f=this._map.getZoomScale(c,this._zoom),p=this._map.getSize().multiplyBy(.5+this.options.padding),_=this._map.project(this._center,c),k=p.multiplyBy(-f).add(_).subtract(this._map._getNewPixelOrigin(s,c));Te.any3d?K(this._container,k,f):Q(this._container,k)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var s in this._layers)this._layers[s]._reset()},_onZoomEnd:function(){for(var s in this._layers)this._layers[s]._project()},_updatePaths:function(){for(var s in this._layers)this._layers[s]._update()},_update:function(){var s=this.options.padding,c=this._map.getSize(),f=this._map.containerPointToLayerPoint(c.multiplyBy(-s)).round();this._bounds=new ke(f,f.add(c.multiplyBy(1+s*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),uv=Ri.extend({options:{tolerance:0},getEvents:function(){var s=Ri.prototype.getEvents.call(this);return s.viewprereset=this._onViewPreReset,s},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Ri.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var s=this._container=document.createElement("canvas");Pe(s,"mousemove",this._onMouseMove,this),Pe(s,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Pe(s,"mouseout",this._handleMouseOut,this),s._leaflet_disable_events=!0,this._ctx=s.getContext("2d")},_destroyContainer:function(){B(this._redrawRequest),delete this._ctx,ye(this._container),st(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var s;this._redrawBounds=null;for(var c in this._layers)s=this._layers[c],s._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Ri.prototype._update.call(this);var s=this._bounds,c=this._container,f=s.getSize(),p=Te.retina?2:1;Q(c,s.min),c.width=p*f.x,c.height=p*f.y,c.style.width=f.x+"px",c.style.height=f.y+"px",Te.retina&&this._ctx.scale(2,2),this._ctx.translate(-s.min.x,-s.min.y),this.fire("update")}},_reset:function(){Ri.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(s){this._updateDashArray(s),this._layers[d(s)]=s;var c=s._order={layer:s,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=c),this._drawLast=c,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(s){this._requestRedraw(s)},_removePath:function(s){var c=s._order,f=c.next,p=c.prev;f?f.prev=p:this._drawLast=p,p?p.next=f:this._drawFirst=f,delete s._order,delete this._layers[d(s)],this._requestRedraw(s)},_updatePath:function(s){this._extendRedrawBounds(s),s._project(),s._update(),this._requestRedraw(s)},_updateStyle:function(s){this._updateDashArray(s),this._requestRedraw(s)},_updateDashArray:function(s){if(typeof s.options.dashArray=="string"){var c=s.options.dashArray.split(/[, ]+/),f=[],p,_;for(_=0;_<c.length;_++){if(p=Number(c[_]),isNaN(p))return;f.push(p)}s.options._dashArray=f}else s.options._dashArray=s.options.dashArray},_requestRedraw:function(s){this._map&&(this._extendRedrawBounds(s),this._redrawRequest=this._redrawRequest||O(this._redraw,this))},_extendRedrawBounds:function(s){if(s._pxBounds){var c=(s.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new ke,this._redrawBounds.extend(s._pxBounds.min.subtract([c,c])),this._redrawBounds.extend(s._pxBounds.max.add([c,c]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var s=this._redrawBounds;if(s){var c=s.getSize();this._ctx.clearRect(s.min.x,s.min.y,c.x,c.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var s,c=this._redrawBounds;if(this._ctx.save(),c){var f=c.getSize();this._ctx.beginPath(),this._ctx.rect(c.min.x,c.min.y,f.x,f.y),this._ctx.clip()}this._drawing=!0;for(var p=this._drawFirst;p;p=p.next)s=p.layer,(!c||s._pxBounds&&s._pxBounds.intersects(c))&&s._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(s,c){if(this._drawing){var f,p,_,k,V=s._parts,$=V.length,Y=this._ctx;if($){for(Y.beginPath(),f=0;f<$;f++){for(p=0,_=V[f].length;p<_;p++)k=V[f][p],Y[p?"lineTo":"moveTo"](k.x,k.y);c&&Y.closePath()}this._fillStroke(Y,s)}}},_updateCircle:function(s){if(!(!this._drawing||s._empty())){var c=s._point,f=this._ctx,p=Math.max(Math.round(s._radius),1),_=(Math.max(Math.round(s._radiusY),1)||p)/p;_!==1&&(f.save(),f.scale(1,_)),f.beginPath(),f.arc(c.x,c.y/_,p,0,Math.PI*2,!1),_!==1&&f.restore(),this._fillStroke(f,s)}},_fillStroke:function(s,c){var f=c.options;f.fill&&(s.globalAlpha=f.fillOpacity,s.fillStyle=f.fillColor||f.color,s.fill(f.fillRule||"evenodd")),f.stroke&&f.weight!==0&&(s.setLineDash&&s.setLineDash(c.options&&c.options._dashArray||[]),s.globalAlpha=f.opacity,s.lineWidth=f.weight,s.strokeStyle=f.color,s.lineCap=f.lineCap,s.lineJoin=f.lineJoin,s.stroke())},_onClick:function(s){for(var c=this._map.mouseEventToLayerPoint(s),f,p,_=this._drawFirst;_;_=_.next)f=_.layer,f.options.interactive&&f._containsPoint(c)&&(!(s.type==="click"||s.type==="preclick")||!this._map._draggableMoved(f))&&(p=f);this._fireEvent(p?[p]:!1,s)},_onMouseMove:function(s){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var c=this._map.mouseEventToLayerPoint(s);this._handleMouseHover(s,c)}},_handleMouseOut:function(s){var c=this._hoveredLayer;c&&(lt(this._container,"leaflet-interactive"),this._fireEvent([c],s,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(s,c){if(!this._mouseHoverThrottled){for(var f,p,_=this._drawFirst;_;_=_.next)f=_.layer,f.options.interactive&&f._containsPoint(c)&&(p=f);p!==this._hoveredLayer&&(this._handleMouseOut(s),p&&(je(this._container,"leaflet-interactive"),this._fireEvent([p],s,"mouseover"),this._hoveredLayer=p)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,s),this._mouseHoverThrottled=!0,setTimeout(a(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(s,c,f){this._map._fireDOMEvent(c,f||c.type,s)},_bringToFront:function(s){var c=s._order;if(c){var f=c.next,p=c.prev;if(f)f.prev=p;else return;p?p.next=f:f&&(this._drawFirst=f),c.prev=this._drawLast,this._drawLast.next=c,c.next=null,this._drawLast=c,this._requestRedraw(s)}},_bringToBack:function(s){var c=s._order;if(c){var f=c.next,p=c.prev;if(p)p.next=f;else return;f?f.prev=p:p&&(this._drawLast=p),c.prev=null,c.next=this._drawFirst,this._drawFirst.prev=c,this._drawFirst=c,this._requestRedraw(s)}}});function dv(s){return Te.canvas?new uv(s):null}var Ec=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(s){return document.createElement("<lvml:"+s+' class="lvml">')}}catch{}return function(s){return document.createElement("<"+s+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),KN={_initContainer:function(){this._container=Le("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Ri.prototype._update.call(this),this.fire("update"))},_initPath:function(s){var c=s._container=Ec("shape");je(c,"leaflet-vml-shape "+(this.options.className||"")),c.coordsize="1 1",s._path=Ec("path"),c.appendChild(s._path),this._updateStyle(s),this._layers[d(s)]=s},_addPath:function(s){var c=s._container;this._container.appendChild(c),s.options.interactive&&s.addInteractiveTarget(c)},_removePath:function(s){var c=s._container;ye(c),s.removeInteractiveTarget(c),delete this._layers[d(s)]},_updateStyle:function(s){var c=s._stroke,f=s._fill,p=s.options,_=s._container;_.stroked=!!p.stroke,_.filled=!!p.fill,p.stroke?(c||(c=s._stroke=Ec("stroke")),_.appendChild(c),c.weight=p.weight+"px",c.color=p.color,c.opacity=p.opacity,p.dashArray?c.dashStyle=A(p.dashArray)?p.dashArray.join(" "):p.dashArray.replace(/( *, *)/g," "):c.dashStyle="",c.endcap=p.lineCap.replace("butt","flat"),c.joinstyle=p.lineJoin):c&&(_.removeChild(c),s._stroke=null),p.fill?(f||(f=s._fill=Ec("fill")),_.appendChild(f),f.color=p.fillColor||p.color,f.opacity=p.fillOpacity):f&&(_.removeChild(f),s._fill=null)},_updateCircle:function(s){var c=s._point.round(),f=Math.round(s._radius),p=Math.round(s._radiusY||f);this._setPath(s,s._empty()?"M0 0":"AL "+c.x+","+c.y+" "+f+","+p+" 0,"+65535*360)},_setPath:function(s,c){s._path.v=c},_bringToFront:function(s){pr(s._container)},_bringToBack:function(s){Lr(s._container)}},Fd=Te.vml?Ec:Ke,Sc=Ri.extend({_initContainer:function(){this._container=Fd("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Fd("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){ye(this._container),st(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Ri.prototype._update.call(this);var s=this._bounds,c=s.getSize(),f=this._container;(!this._svgSize||!this._svgSize.equals(c))&&(this._svgSize=c,f.setAttribute("width",c.x),f.setAttribute("height",c.y)),Q(f,s.min),f.setAttribute("viewBox",[s.min.x,s.min.y,c.x,c.y].join(" ")),this.fire("update")}},_initPath:function(s){var c=s._path=Fd("path");s.options.className&&je(c,s.options.className),s.options.interactive&&je(c,"leaflet-interactive"),this._updateStyle(s),this._layers[d(s)]=s},_addPath:function(s){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(s._path),s.addInteractiveTarget(s._path)},_removePath:function(s){ye(s._path),s.removeInteractiveTarget(s._path),delete this._layers[d(s)]},_updatePath:function(s){s._project(),s._update()},_updateStyle:function(s){var c=s._path,f=s.options;c&&(f.stroke?(c.setAttribute("stroke",f.color),c.setAttribute("stroke-opacity",f.opacity),c.setAttribute("stroke-width",f.weight),c.setAttribute("stroke-linecap",f.lineCap),c.setAttribute("stroke-linejoin",f.lineJoin),f.dashArray?c.setAttribute("stroke-dasharray",f.dashArray):c.removeAttribute("stroke-dasharray"),f.dashOffset?c.setAttribute("stroke-dashoffset",f.dashOffset):c.removeAttribute("stroke-dashoffset")):c.setAttribute("stroke","none"),f.fill?(c.setAttribute("fill",f.fillColor||f.color),c.setAttribute("fill-opacity",f.fillOpacity),c.setAttribute("fill-rule",f.fillRule||"evenodd")):c.setAttribute("fill","none"))},_updatePoly:function(s,c){this._setPath(s,$t(s._parts,c))},_updateCircle:function(s){var c=s._point,f=Math.max(Math.round(s._radius),1),p=Math.max(Math.round(s._radiusY),1)||f,_="a"+f+","+p+" 0 1,0 ",k=s._empty()?"M0 0":"M"+(c.x-f)+","+c.y+_+f*2+",0 "+_+-f*2+",0 ";this._setPath(s,k)},_setPath:function(s,c){s._path.setAttribute("d",c)},_bringToFront:function(s){pr(s._path)},_bringToBack:function(s){Lr(s._path)}});Te.vml&&Sc.include(KN);function hv(s){return Te.svg||Te.vml?new Sc(s):null}qe.include({getRenderer:function(s){var c=s.options.renderer||this._getPaneRenderer(s.options.pane)||this.options.renderer||this._renderer;return c||(c=this._renderer=this._createRenderer()),this.hasLayer(c)||this.addLayer(c),c},_getPaneRenderer:function(s){if(s==="overlayPane"||s===void 0)return!1;var c=this._paneRenderers[s];return c===void 0&&(c=this._createRenderer({pane:s}),this._paneRenderers[s]=c),c},_createRenderer:function(s){return this.options.preferCanvas&&dv(s)||hv(s)}});var fv=Qa.extend({initialize:function(s,c){Qa.prototype.initialize.call(this,this._boundsToLatLngs(s),c)},setBounds:function(s){return this.setLatLngs(this._boundsToLatLngs(s))},_boundsToLatLngs:function(s){return s=ve(s),[s.getSouthWest(),s.getNorthWest(),s.getNorthEast(),s.getSouthEast()]}});function ZN(s,c){return new fv(s,c)}Sc.create=Fd,Sc.pointsToPath=$t,Ai.geometryToLayer=Rd,Ai.coordsToLatLng=Ym,Ai.coordsToLatLngs=jd,Ai.latLngToCoords=Jm,Ai.latLngsToCoords=Ld,Ai.getFeature=Ya,Ai.asFeature=Dd,qe.mergeOptions({boxZoom:!0});var mv=rr.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane,this._resetStateTimeout=0,s.on("unload",this._destroy,this)},addHooks:function(){Pe(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){st(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){ye(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(s){if(!s.shiftKey||s.which!==1&&s.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Ae(),Qt(),this._startPoint=this._map.mouseEventToContainerPoint(s),Pe(document,{contextmenu:nr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(s){this._moved||(this._moved=!0,this._box=Le("div","leaflet-zoom-box",this._container),je(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(s);var c=new ke(this._point,this._startPoint),f=c.getSize();Q(this._box,c.min),this._box.style.width=f.x+"px",this._box.style.height=f.y+"px"},_finish:function(){this._moved&&(ye(this._box),lt(this._container,"leaflet-crosshair")),ze(),bs(),st(document,{contextmenu:nr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(s){if(!(s.which!==1&&s.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(a(this._resetState,this),0);var c=new pe(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(c).fire("boxzoomend",{boxZoomBounds:c})}},_onKeyDown:function(s){s.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});qe.addInitHook("addHandler","boxZoom",mv),qe.mergeOptions({doubleClickZoom:!0});var pv=rr.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(s){var c=this._map,f=c.getZoom(),p=c.options.zoomDelta,_=s.originalEvent.shiftKey?f-p:f+p;c.options.doubleClickZoom==="center"?c.setZoom(_):c.setZoomAround(s.containerPoint,_)}});qe.addInitHook("addHandler","doubleClickZoom",pv),qe.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var gv=rr.extend({addHooks:function(){if(!this._draggable){var s=this._map;this._draggable=new Mr(s._mapPane,s._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),s.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),s.on("zoomend",this._onZoomEnd,this),s.whenReady(this._onZoomEnd,this))}je(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){lt(this._map._container,"leaflet-grab"),lt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var s=this._map;if(s._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var c=ve(this._map.options.maxBounds);this._offsetLimit=de(this._map.latLngToContainerPoint(c.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(c.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;s.fire("movestart").fire("dragstart"),s.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(s){if(this._map.options.inertia){var c=this._lastTime=+new Date,f=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(f),this._times.push(c),this._prunePositions(c)}this._map.fire("move",s).fire("drag",s)},_prunePositions:function(s){for(;this._positions.length>1&&s-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var s=this._map.getSize().divideBy(2),c=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=c.subtract(s).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(s,c){return s-(s-c)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var s=this._draggable._newPos.subtract(this._draggable._startPos),c=this._offsetLimit;s.x<c.min.x&&(s.x=this._viscousLimit(s.x,c.min.x)),s.y<c.min.y&&(s.y=this._viscousLimit(s.y,c.min.y)),s.x>c.max.x&&(s.x=this._viscousLimit(s.x,c.max.x)),s.y>c.max.y&&(s.y=this._viscousLimit(s.y,c.max.y)),this._draggable._newPos=this._draggable._startPos.add(s)}},_onPreDragWrap:function(){var s=this._worldWidth,c=Math.round(s/2),f=this._initialWorldOffset,p=this._draggable._newPos.x,_=(p-c+f)%s+c-f,k=(p+c+f)%s-c-f,V=Math.abs(_+f)<Math.abs(k+f)?_:k;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=V},_onDragEnd:function(s){var c=this._map,f=c.options,p=!f.inertia||s.noInertia||this._times.length<2;if(c.fire("dragend",s),p)c.fire("moveend");else{this._prunePositions(+new Date);var _=this._lastPos.subtract(this._positions[0]),k=(this._lastTime-this._times[0])/1e3,V=f.easeLinearity,$=_.multiplyBy(V/k),Y=$.distanceTo([0,0]),ne=Math.min(f.inertiaMaxSpeed,Y),ge=$.multiplyBy(ne/Y),Ce=ne/(f.inertiaDeceleration*V),Fe=ge.multiplyBy(-Ce/2).round();!Fe.x&&!Fe.y?c.fire("moveend"):(Fe=c._limitOffset(Fe,c.options.maxBounds),O(function(){c.panBy(Fe,{duration:Ce,easeLinearity:V,noMoveStart:!0,animate:!0})}))}}});qe.addInitHook("addHandler","dragging",gv),qe.mergeOptions({keyboard:!0,keyboardPanDelta:80});var yv=rr.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(s){this._map=s,this._setPanDelta(s.options.keyboardPanDelta),this._setZoomDelta(s.options.zoomDelta)},addHooks:function(){var s=this._map._container;s.tabIndex<=0&&(s.tabIndex="0"),Pe(s,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),st(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var s=document.body,c=document.documentElement,f=s.scrollTop||c.scrollTop,p=s.scrollLeft||c.scrollLeft;this._map._container.focus(),window.scrollTo(p,f)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(s){var c=this._panKeys={},f=this.keyCodes,p,_;for(p=0,_=f.left.length;p<_;p++)c[f.left[p]]=[-1*s,0];for(p=0,_=f.right.length;p<_;p++)c[f.right[p]]=[s,0];for(p=0,_=f.down.length;p<_;p++)c[f.down[p]]=[0,s];for(p=0,_=f.up.length;p<_;p++)c[f.up[p]]=[0,-1*s]},_setZoomDelta:function(s){var c=this._zoomKeys={},f=this.keyCodes,p,_;for(p=0,_=f.zoomIn.length;p<_;p++)c[f.zoomIn[p]]=s;for(p=0,_=f.zoomOut.length;p<_;p++)c[f.zoomOut[p]]=-s},_addHooks:function(){Pe(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){st(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(s){if(!(s.altKey||s.ctrlKey||s.metaKey)){var c=s.keyCode,f=this._map,p;if(c in this._panKeys){if(!f._panAnim||!f._panAnim._inProgress)if(p=this._panKeys[c],s.shiftKey&&(p=te(p).multiplyBy(3)),f.options.maxBounds&&(p=f._limitOffset(te(p),f.options.maxBounds)),f.options.worldCopyJump){var _=f.wrapLatLng(f.unproject(f.project(f.getCenter()).add(p)));f.panTo(_)}else f.panBy(p)}else if(c in this._zoomKeys)f.setZoom(f.getZoom()+(s.shiftKey?3:1)*this._zoomKeys[c]);else if(c===27&&f._popup&&f._popup.options.closeOnEscapeKey)f.closePopup();else return;nr(s)}}});qe.addInitHook("addHandler","keyboard",yv),qe.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var _v=rr.extend({addHooks:function(){Pe(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){st(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(s){var c=kd(s),f=this._map.options.wheelDebounceTime;this._delta+=c,this._lastMousePos=this._map.mouseEventToContainerPoint(s),this._startTime||(this._startTime=+new Date);var p=Math.max(f-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(a(this._performZoom,this),p),nr(s)},_performZoom:function(){var s=this._map,c=s.getZoom(),f=this._map.options.zoomSnap||0;s._stop();var p=this._delta/(this._map.options.wheelPxPerZoomLevel*4),_=4*Math.log(2/(1+Math.exp(-Math.abs(p))))/Math.LN2,k=f?Math.ceil(_/f)*f:_,V=s._limitZoom(c+(this._delta>0?k:-k))-c;this._delta=0,this._startTime=null,V&&(s.options.scrollWheelZoom==="center"?s.setZoom(c+V):s.setZoomAround(this._lastMousePos,c+V))}});qe.addInitHook("addHandler","scrollWheelZoom",_v);var QN=600;qe.mergeOptions({tapHold:Te.touchNative&&Te.safari&&Te.mobile,tapTolerance:15});var vv=rr.extend({addHooks:function(){Pe(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){st(this._map._container,"touchstart",this._onDown,this)},_onDown:function(s){if(clearTimeout(this._holdTimeout),s.touches.length===1){var c=s.touches[0];this._startPos=this._newPos=new G(c.clientX,c.clientY),this._holdTimeout=setTimeout(a(function(){this._cancel(),this._isTapValid()&&(Pe(document,"touchend",It),Pe(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",c))},this),QN),Pe(document,"touchend touchcancel contextmenu",this._cancel,this),Pe(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function s(){st(document,"touchend",It),st(document,"touchend touchcancel",s)},_cancel:function(){clearTimeout(this._holdTimeout),st(document,"touchend touchcancel contextmenu",this._cancel,this),st(document,"touchmove",this._onMove,this)},_onMove:function(s){var c=s.touches[0];this._newPos=new G(c.clientX,c.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(s,c){var f=new MouseEvent(s,{bubbles:!0,cancelable:!0,view:window,screenX:c.screenX,screenY:c.screenY,clientX:c.clientX,clientY:c.clientY});f._simulated=!0,c.target.dispatchEvent(f)}});qe.addInitHook("addHandler","tapHold",vv),qe.mergeOptions({touchZoom:Te.touch,bounceAtZoomLimits:!0});var xv=rr.extend({addHooks:function(){je(this._map._container,"leaflet-touch-zoom"),Pe(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){lt(this._map._container,"leaflet-touch-zoom"),st(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(s){var c=this._map;if(!(!s.touches||s.touches.length!==2||c._animatingZoom||this._zooming)){var f=c.mouseEventToContainerPoint(s.touches[0]),p=c.mouseEventToContainerPoint(s.touches[1]);this._centerPoint=c.getSize()._divideBy(2),this._startLatLng=c.containerPointToLatLng(this._centerPoint),c.options.touchZoom!=="center"&&(this._pinchStartLatLng=c.containerPointToLatLng(f.add(p)._divideBy(2))),this._startDist=f.distanceTo(p),this._startZoom=c.getZoom(),this._moved=!1,this._zooming=!0,c._stop(),Pe(document,"touchmove",this._onTouchMove,this),Pe(document,"touchend touchcancel",this._onTouchEnd,this),It(s)}},_onTouchMove:function(s){if(!(!s.touches||s.touches.length!==2||!this._zooming)){var c=this._map,f=c.mouseEventToContainerPoint(s.touches[0]),p=c.mouseEventToContainerPoint(s.touches[1]),_=f.distanceTo(p)/this._startDist;if(this._zoom=c.getScaleZoom(_,this._startZoom),!c.options.bounceAtZoomLimits&&(this._zoom<c.getMinZoom()&&_<1||this._zoom>c.getMaxZoom()&&_>1)&&(this._zoom=c._limitZoom(this._zoom)),c.options.touchZoom==="center"){if(this._center=this._startLatLng,_===1)return}else{var k=f._add(p)._divideBy(2)._subtract(this._centerPoint);if(_===1&&k.x===0&&k.y===0)return;this._center=c.unproject(c.project(this._pinchStartLatLng,this._zoom).subtract(k),this._zoom)}this._moved||(c._moveStart(!0,!1),this._moved=!0),B(this._animRequest);var V=a(c._move,c,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=O(V,this,!0),It(s)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,B(this._animRequest),st(document,"touchmove",this._onTouchMove,this),st(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});qe.addInitHook("addHandler","touchZoom",xv),qe.BoxZoom=mv,qe.DoubleClickZoom=pv,qe.Drag=gv,qe.Keyboard=yv,qe.ScrollWheelZoom=_v,qe.TapHold=vv,qe.TouchZoom=xv,n.Bounds=ke,n.Browser=Te,n.CRS=Me,n.Canvas=uv,n.Circle=Qm,n.CircleMarker=Ad,n.Class=ee,n.Control=zn,n.DivIcon=av,n.DivOverlay=ri,n.DomEvent=Id,n.DomUtil=wd,n.Draggable=Mr,n.Evented=we,n.FeatureGroup=Mt,n.GeoJSON=Ai,n.GridLayer=Tc,n.Handler=rr,n.Icon=ni,n.ImageOverlay=Md,n.LatLng=he,n.LatLngBounds=pe,n.Layer=ot,n.LayerGroup=Tt,n.LineUtil=S,n.Map=qe,n.Marker=Cd,n.Mixin=Vo,n.Path=Ns,n.Point=G,n.PolyUtil=Ga,n.Polygon=Qa,n.Polyline=Ci,n.Popup=Od,n.PosAnimation=_c,n.Projection=oe,n.Rectangle=fv,n.Renderer=Ri,n.SVG=Sc,n.SVGOverlay=ov,n.TileLayer=Ja,n.Tooltip=Vd,n.Transformation=In,n.Util=M,n.VideoOverlay=sv,n.bind=a,n.bounds=de,n.canvas=dv,n.circle=MN,n.circleMarker=DN,n.control=Nn,n.divIcon=HN,n.extend=i,n.featureGroup=Za,n.geoJSON=iv,n.geoJson=FN,n.gridLayer=WN,n.icon=jN,n.imageOverlay=UN,n.latLng=se,n.latLngBounds=ve,n.layerGroup=Ss,n.map=Ba,n.marker=LN,n.point=te,n.polygon=VN,n.polyline=ON,n.popup=qN,n.rectangle=ZN,n.setOptions=P,n.stamp=d,n.svg=hv,n.svgOverlay=zN,n.tileLayer=lv,n.tooltip=$N,n.transformation=cn,n.version=r,n.videoOverlay=BN;var YN=window.L;n.noConflict=function(){return window.L=YN,this},window.L=n})})(ky,ky.exports);var vd=ky.exports;const W_=Xb(vd);function G_(t,e,n){return Object.freeze({instance:t,context:e,container:n})}function K_(t,e){return e==null?function(r,i){const o=U.useRef();return o.current||(o.current=t(r,i)),o}:function(r,i){const o=U.useRef();o.current||(o.current=t(r,i));const a=U.useRef(r),{instance:u}=o.current;return U.useEffect(function(){a.current!==r&&(e(u,r,a.current),a.current=r)},[u,r,i]),o}}function G5(t,e){U.useEffect(function(){return(e.layerContainer??e.map).addLayer(t.instance),function(){var o;(o=e.layerContainer)==null||o.removeLayer(t.instance),e.map.removeLayer(t.instance)}},[e,t])}function pN(t){return function(n){const r=$_(),i=t(H_(n,r),r);return dN(r.map,n.attribution),mN(i.current,n.eventHandlers),G5(i.current,r),i}}function K5(t,e){const n=K_(t,e),r=pN(n);return q5(r)}function Z5(t,e){const n=K_(t),r=W5(n,e);return $5(r)}function Q5(t,e){const n=K_(t,e),r=pN(n);return H5(r)}function Y5(t,e,n){const{opacity:r,zIndex:i}=e;r!=null&&r!==n.opacity&&t.setOpacity(r),i!=null&&i!==n.zIndex&&t.setZIndex(i)}function J5(){return $_().map}function Iy(){return Iy=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Iy.apply(this,arguments)}function X5({bounds:t,boundsOptions:e,center:n,children:r,className:i,id:o,placeholder:a,style:u,whenReady:d,zoom:m,...g},v){const[w]=U.useState({className:i,id:o,style:u}),[E,C]=U.useState(null);U.useImperativeHandle(v,()=>(E==null?void 0:E.map)??null,[E]);const P=U.useCallback(N=>{if(N!==null&&E===null){const T=new vd.Map(N,g);n!=null&&m!=null?T.setView(n,m):t!=null&&T.fitBounds(t,e),d!=null&&T.whenReady(d),C(B5(T))}},[]);U.useEffect(()=>()=>{E==null||E.map.remove()},[E]);const F=E?Hh.createElement(fN,{value:E},r):a??null;return Hh.createElement("div",Iy({},w,{ref:P}),F)}const e3=U.forwardRef(X5),Ob=K5(function({position:e,...n},r){const i=new vd.Marker(e,n);return G_(i,z5(r,{overlayContainer:i}))},function(e,n,r){n.position!==r.position&&e.setLatLng(n.position),n.icon!=null&&n.icon!==r.icon&&e.setIcon(n.icon),n.zIndexOffset!=null&&n.zIndexOffset!==r.zIndexOffset&&e.setZIndexOffset(n.zIndexOffset),n.opacity!=null&&n.opacity!==r.opacity&&e.setOpacity(n.opacity),e.dragging!=null&&n.draggable!==r.draggable&&(n.draggable===!0?e.dragging.enable():e.dragging.disable())}),Vb=Z5(function(e,n){const r=new vd.Popup(e,n.overlayContainer);return G_(r,n)},function(e,n,{position:r},i){U.useEffect(function(){const{instance:a}=e;function u(m){m.popup===a&&(a.update(),i(!0))}function d(m){m.popup===a&&i(!1)}return n.map.on({popupopen:u,popupclose:d}),n.overlayContainer==null?(r!=null&&a.setLatLng(r),a.openOn(n.map)):n.overlayContainer.bindPopup(a),function(){var g;n.map.off({popupopen:u,popupclose:d}),(g=n.overlayContainer)==null||g.unbindPopup(),n.map.removeLayer(a)}},[e,n,i,r])}),t3=Q5(function({url:e,...n},r){const i=new vd.TileLayer(e,H_(n,r));return G_(i,r)},function(e,n,r){Y5(e,n,r);const{url:i}=n;i!=null&&i!==r.url&&e.setUrl(i)});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var n3={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r3=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),_e=(t,e)=>{const n=U.forwardRef(({color:r="currentColor",size:i=24,strokeWidth:o=2,absoluteStrokeWidth:a,className:u="",children:d,...m},g)=>U.createElement("svg",{ref:g,...n3,width:i,height:i,stroke:r,strokeWidth:a?Number(o)*24/Number(i):o,className:["lucide",`lucide-${r3(t)}`,u].join(" "),...m},[...e.map(([v,w])=>U.createElement(v,w)),...Array.isArray(d)?d:[d]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ty=_e("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gN=_e("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z_=_e("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zh=_e("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fb=_e("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q_=_e("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tc=_e("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i3=_e("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qf=_e("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s3=_e("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o3=_e("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a3=_e("Cookie",[["path",{d:"M12 2a10 10 0 1 0 10 10 4 4 0 0 1-5-5 4 4 0 0 1-5-5",key:"laymnq"}],["path",{d:"M8.5 8.5v.01",key:"ue8clq"}],["path",{d:"M16 15.5v.01",key:"14dtrp"}],["path",{d:"M12 12v.01",key:"u5ubse"}],["path",{d:"M11 17v.01",key:"1hyl5a"}],["path",{d:"M7 14v.01",key:"uct60s"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ub=_e("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y_=_e("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bb=_e("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zm=_e("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xd=_e("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l3=_e("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J_=_e("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zb=_e("Feather",[["path",{d:"M20.24 12.24a6 6 0 0 0-8.49-8.49L5 10.5V19h8.5z",key:"u4sw5n"}],["line",{x1:"16",x2:"2",y1:"8",y2:"22",key:"1c47m2"}],["line",{x1:"17.5",x2:"9",y1:"15",y2:"15",key:"2fj3pr"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c3=_e("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qm=_e("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u3=_e("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yN=_e("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qh=_e("ImagePlus",[["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7",key:"31hg93"}],["line",{x1:"16",x2:"22",y1:"5",y2:"5",key:"ez7e4s"}],["line",{x1:"19",x2:"19",y1:"2",y2:"8",key:"1gkr8c"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $h=_e("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d3=_e("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _N=_e("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qb=_e("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bn=_e("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $b=_e("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X_=_e("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=_e("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h3=_e("Map",[["polygon",{points:"3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21",key:"ok2ie8"}],["line",{x1:"9",x2:"9",y1:"3",y2:"18",key:"w34qz5"}],["line",{x1:"15",x2:"15",y1:"6",y2:"21",key:"volv9a"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f3=_e("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vN=_e("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m3=_e("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xN=_e("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p3=_e("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g3=_e("MousePointer",[["path",{d:"m3 3 7.07 16.97 2.51-7.39 7.39-2.51L3 3z",key:"y2ucgo"}],["path",{d:"m13 13 6 6",key:"1nhxnf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mo=_e("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y3=_e("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wN=_e("PartyPopper",[["path",{d:"M5.8 11.3 2 22l10.7-3.79",key:"gwxi1d"}],["path",{d:"M4 3h.01",key:"1vcuye"}],["path",{d:"M22 8h.01",key:"1mrtc2"}],["path",{d:"M15 2h.01",key:"1cjtqr"}],["path",{d:"M22 20h.01",key:"1mrys2"}],["path",{d:"m22 2-2.24.75a2.9 2.9 0 0 0-1.96 3.12v0c.1.86-.57 1.63-1.45 1.63h-.38c-.86 0-1.6.6-1.76 1.44L14 10",key:"bpx1uq"}],["path",{d:"m22 13-.82-.33c-.86-.34-1.82.2-1.98 1.11v0c-.11.7-.72 1.22-1.43 1.22H17",key:"1pd0s7"}],["path",{d:"m11 2 .33.82c.34.86-.2 1.82-1.11 1.98v0C9.52 4.9 9 5.52 9 6.23V7",key:"zq5xbz"}],["path",{d:"M11 13c1.93 1.93 2.83 4.17 2 5-.83.83-3.07-.07-5-2-1.93-1.93-2.83-4.17-2-5 .83-.83 3.07.07 5 2Z",key:"4kbmks"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bN=_e("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _3=_e("Plane",[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kN=_e("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v3=_e("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x3=_e("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IN=_e("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TN=_e("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EN=_e("ShieldAlert",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SN=_e("ShieldCheck",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $m=_e("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w3=_e("Shirt",[["path",{d:"M20.38 3.46 16 2a4 4 0 0 1-8 0L3.62 3.46a2 2 0 0 0-1.34 2.23l.58 3.47a1 1 0 0 0 .99.84H6v10c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2V10h2.15a1 1 0 0 0 .99-.84l.58-3.47a2 2 0 0 0-1.34-2.23z",key:"1wgbhj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b3=_e("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eu=_e("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ev=_e("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NN=_e("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PN=_e("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=_e("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hb=_e("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CN=_e("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k3=_e("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nc=_e("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gn=_e("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I3=_e("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hm=_e("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _i=_e("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tv=_e("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);delete W_.Icon.Default.prototype._getIconUrl;W_.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-shadow.png"});const Wb=t=>W_.divIcon({className:"custom-marker",html:`<div style="background-color: ${t}; width: 24px; height: 24px; border-radius: 50% 50% 50% 0; transform: rotate(-45deg); border: 2px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.3);"></div>`,iconSize:[24,24],iconAnchor:[12,24],popupAnchor:[0,-24]}),zc={accommodation:{label:"Accommodation",color:"#3B82F6",icon:yN},costume:{label:"Costume Pickup",color:"#F59E0B",icon:w3},fete:{label:"Fete Location",color:"#EC4899",icon:wN},meetup:{label:"Meetup Spot",color:"#10B981",icon:Gn},scraped:{label:"Live Events",color:"#8B5CF6",icon:ns}};function T3({center:t,zoom:e}){const n=J5();return U.useEffect(()=>{t&&n.setView(t,e||13)},[t,e,n]),null}function E3(t,e,n,r){const o=(n-t)*Math.PI/180,a=(r-e)*Math.PI/180,u=Math.sin(o/2)*Math.sin(o/2)+Math.cos(t*Math.PI/180)*Math.cos(n*Math.PI/180)*Math.sin(a/2)*Math.sin(a/2);return 6371*(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)))}const Gb={trinidad:{center:[10.6918,-61.2225],zoom:11,country:"Trinidad & Tobago"},"stkitts-sugar-mas":{center:[17.3026,-62.7177],zoom:12,country:"St. Kitts"},stcroix:{center:[17.7246,-64.8348],zoom:11,country:"St. Croix, USVI"},dominica:{center:[15.415,-61.371],zoom:11,country:"Dominica"},aruba:{center:[12.5211,-69.9683],zoom:12,country:"Aruba"},"guyana-mashramani":{center:[6.8013,-58.1551],zoom:12,country:"Guyana"},guyana:{center:[6.8013,-58.1551],zoom:12,country:"Guyana"},"guyana-independence":{center:[6.8013,-58.1551],zoom:12,country:"Guyana"},jamaica:{center:[18.0179,-76.8099],zoom:11,country:"Jamaica"},stmaarten:{center:[18.0425,-63.0548],zoom:12,country:"St. Maarten"},bahamas:{center:[25.0343,-77.3963],zoom:12,country:"Bahamas"},bermuda:{center:[32.3078,-64.7505],zoom:13,country:"Bermuda"},vincymas:{center:[13.1587,-61.2248],zoom:12,country:"St. Vincent"},antigua:{center:[17.1274,-61.8468],zoom:12,country:"Antigua"},stlucia:{center:[14.0101,-60.987],zoom:11,country:"St. Lucia"},tobago:{center:[11.1889,-60.732],zoom:11,country:"Tobago"},nottinghill:{center:[51.5156,-.205],zoom:14,country:"London, UK"},miami:{center:[25.7617,-80.1918],zoom:11,country:"Miami, FL"},tampa:{center:[27.9506,-82.4572],zoom:12,country:"Tampa, FL"},"cayman-batabano":{center:[19.2869,-81.3674],zoom:13,country:"Cayman Islands"},stthomas:{center:[18.3358,-64.8963],zoom:13,country:"St. Thomas, USVI"},atlanta:{center:[33.749,-84.388],zoom:12,country:"Atlanta, GA"},hollywood:{center:[34.0928,-118.3287],zoom:13,country:"Hollywood, CA"},caymas:{center:[19.2869,-81.3674],zoom:13,country:"Cayman Islands"},toronto:{center:[43.65107,-79.347015],zoom:12,country:"Toronto, Canada"},barbados:{center:[13.1939,-59.5432],zoom:12,country:"Barbados"},nevis:{center:[17.15,-62.58],zoom:12,country:"Nevis"},grenada:{center:[12.0529,-61.7523],zoom:12,country:"Grenada"},"ny-labor-day":{center:[40.6782,-73.9442],zoom:13,country:"Brooklyn, NY"},japan:{center:[35.6762,139.6503],zoom:10,country:"Tokyo, Japan"}};function S3({locations:t=[],scrapedEvents:e=[],onLocationsChange:n,carnivalName:r,carnivalId:i}){const[o,a]=U.useState(!1),[u,d]=U.useState({name:"",type:"fete",lat:"",lng:""}),[m,g]=U.useState(""),[v,w]=U.useState([]),[E,C]=U.useState(!1),P=t.find(I=>I.type==="accommodation"),F=Gb[i]||Gb.trinidad,N=U.useMemo(()=>{if(P)return[P.lat,P.lng];if(t.length>0)return[t[0].lat,t[0].lng];const I=e.find(b=>b.lat&&b.lng);return I?[I.lat,I.lng]:F.center},[t,P,F,e]),T=async()=>{if(m.trim()){C(!0);try{const b=await(await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(m)}`)).json();w(b.slice(0,5))}catch(I){console.error("Search error:",I)}C(!1)}},A=I=>{d({...u,lat:parseFloat(I.lat),lng:parseFloat(I.lon),name:u.name||I.display_name.split(",")[0]}),w([]),g("")},z=()=>{if(!u.name||!u.lat||!u.lng)return;const I={id:Date.now().toString(),name:u.name,type:u.type,lat:parseFloat(u.lat),lng:parseFloat(u.lng)};n([...t,I]),d({name:"",type:"fete",lat:"",lng:""}),a(!1)},Z=I=>{n(t.filter(b=>b.id!==I))},H=I=>{if(!P||I.type==="accommodation")return null;const b=E3(P.lat,P.lng,I.lat,I.lng);return b<1?`${Math.round(b*1e3)}m`:`${b.toFixed(1)}km`};return l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsxs("h3",{className:"text-lg font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[l.jsx(ns,{className:"w-5 h-5 text-purple-500"}),"Fete Map - ",r]}),l.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 ml-7",children:[" ",F.country]})]}),l.jsxs("button",{onClick:()=>a(!o),className:"flex items-center gap-1 px-3 py-1.5 bg-purple-600 text-white text-sm rounded-lg hover:bg-purple-700 transition",children:[l.jsx(kN,{className:"w-4 h-4"}),"Add Pin"]})]}),o&&l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 space-y-3",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsx("input",{type:"text",placeholder:"Location name",value:u.name,onChange:I=>d({...u,name:I.target.value}),className:"px-3 py-2 border rounded-lg dark:bg-gray-600 dark:border-gray-500 dark:text-white"}),l.jsx("select",{value:u.type,onChange:I=>d({...u,type:I.target.value}),className:"px-3 py-2 border rounded-lg dark:bg-gray-600 dark:border-gray-500 dark:text-white",children:Object.entries(zc).map(([I,{label:b}])=>l.jsx("option",{value:I,children:b},I))})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{type:"text",placeholder:"Search for a place...",value:m,onChange:I=>g(I.target.value),onKeyPress:I=>I.key==="Enter"&&T(),className:"flex-1 px-3 py-2 border rounded-lg dark:bg-gray-600 dark:border-gray-500 dark:text-white"}),l.jsx("button",{onClick:T,disabled:E,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:E?"...":"Search"})]}),v.length>0&&l.jsx("ul",{className:"bg-white dark:bg-gray-600 border dark:border-gray-500 rounded-lg max-h-40 overflow-y-auto",children:v.map((I,b)=>l.jsx("li",{onClick:()=>A(I),className:"px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-500 cursor-pointer text-sm truncate dark:text-white",children:I.display_name},b))}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsx("input",{type:"number",step:"any",placeholder:"Latitude",value:u.lat,onChange:I=>d({...u,lat:I.target.value}),className:"px-3 py-2 border rounded-lg dark:bg-gray-600 dark:border-gray-500 dark:text-white"}),l.jsx("input",{type:"number",step:"any",placeholder:"Longitude",value:u.lng,onChange:I=>d({...u,lng:I.target.value}),className:"px-3 py-2 border rounded-lg dark:bg-gray-600 dark:border-gray-500 dark:text-white"})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:z,disabled:!u.name||!u.lat||!u.lng,className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Add Location"}),l.jsx("button",{onClick:()=>a(!1),className:"px-4 py-2 bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-white rounded-lg hover:bg-gray-400",children:"Cancel"})]})]}),l.jsx("div",{className:"h-[400px] rounded-xl overflow-hidden border-2 border-gray-200 dark:border-gray-600",children:l.jsxs(e3,{center:N,zoom:F.zoom,style:{height:"100%",width:"100%"},children:[l.jsx(t3,{attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),l.jsx(T3,{center:N,zoom:F.zoom}),t.map(I=>{var b,R;return l.jsx(Ob,{position:[I.lat,I.lng],icon:Wb(((b=zc[I.type])==null?void 0:b.color)||"#6B7280"),children:l.jsxs(Vb,{children:[l.jsx("div",{className:"font-medium",children:I.name}),l.jsx("div",{className:"text-xs text-gray-500",children:(R=zc[I.type])==null?void 0:R.label}),H(I)&&l.jsxs("div",{className:"text-xs text-blue-600 flex items-center gap-1 mt-1",children:[l.jsx(y3,{className:"w-3 h-3"}),H(I)," from accommodation"]})]})},I.id)}),e.filter(I=>I.lat&&I.lng).map(I=>l.jsx(Ob,{position:[I.lat,I.lng],icon:Wb(zc.scraped.color),children:l.jsxs(Vb,{children:[l.jsx("div",{className:"font-medium",children:I.title}),l.jsx("div",{className:"text-xs text-purple-600 font-bold mb-1",children:"Live Event"}),I.venue&&l.jsx("div",{className:"text-xs text-gray-500 mb-2",children:I.venue}),l.jsx("a",{href:I.url,target:"_blank",rel:"noopener noreferrer",className:"block text-center px-2 py-1 bg-purple-100 text-purple-700 text-[10px] font-bold rounded uppercase hover:bg-purple-200 transition",children:"Find Tickets"})]})},I.id))]})}),t.length>0&&l.jsxs("div",{className:"space-y-2",children:[l.jsx("h4",{className:"text-sm font-semibold text-gray-600 dark:text-gray-300",children:"Saved Locations"}),l.jsx("div",{className:"grid gap-2",children:t.map(I=>{const b=zc[I.type],R=(b==null?void 0:b.icon)||ns,D=H(I);return l.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{backgroundColor:(b==null?void 0:b.color)||"#6B7280"},children:l.jsx(R,{className:"w-4 h-4 text-white"})}),l.jsxs("div",{children:[l.jsx("div",{className:"font-medium text-gray-800 dark:text-white",children:I.name}),l.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[b==null?void 0:b.label,D&&`  ${D} from stay`]})]})]}),l.jsx("button",{onClick:()=>Z(I.id),className:"p-2 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition",children:l.jsx(rs,{className:"w-4 h-4"})})]},I.id)})})]}),!P&&t.length===0&&l.jsxs("div",{className:"text-center py-6 text-gray-500 dark:text-gray-400",children:[l.jsx(yN,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),l.jsx("p",{children:"Start by adding your accommodation location"}),l.jsx("p",{className:"text-sm",children:"Then add fetes, costume pickup, and meetup spots"})]})]})}let Ho=[{id:"1",text:"Who's ready for the road?! ",senderId:"2",senderName:"Soca Junkie",createdAt:new Date(Date.now()-864e5).toISOString(),isBot:!1},{id:"2",text:"My costume is ready! The Monarch section looks fire ",senderId:"3",senderName:"Fete King",createdAt:new Date(Date.now()-8e7).toISOString(),isBot:!1},{id:"3",text:"Just waiting on my flight confirmation.",senderId:"4",senderName:"Carnival Baby",createdAt:new Date(Date.now()-7e7).toISOString(),isBot:!1},{id:"4",text:"Welcome to Trinidad! I'm your Carnival Concierge. Ask me anything about fete locations, transport, or safety tips!",senderId:"bot",senderName:"Carnival Concierge",createdAt:new Date(Date.now()-6e4).toISOString(),isBot:!0}];const N3=(t,e,n)=>{if(e)return n(Ho),()=>{};if(!t)return console.warn("subscribeToMessages aborted: No squadId provided."),()=>{};console.log("Subscribing to messages for squad:",t);const r=sn(Ne,"squads",t,"messages"),i=gd(r,T_("createdAt","asc"),h1(50));return qi(i,a=>{const u=a.docs.map(d=>{var m;return{id:d.id,...d.data(),createdAt:(m=d.data().createdAt)!=null&&m.toDate?d.data().createdAt.toDate().toISOString():new Date().toISOString()}});n(u)},a=>{console.error(" Chat subscription error:",a)})},P3=async(t,e,n,r,i,o)=>{let a=null;if(r)if(i)a=URL.createObjectURL(r);else try{const d=ho(fo,`squads/${t}/${Date.now()}_${r.name}`),m=await Xl(d,r);a=await ec(m.ref)}catch(d){console.error("Image upload failed:",d)}const u={text:n,imageUrl:a,expiresAt:new Date(Date.now()+24*60*60*1e3).toISOString(),senderId:e.uid||"demo-user",senderName:e.displayName||"Me",senderPhoto:e.photoURL||null,createdAt:i?new Date().toISOString():Uf(),isBot:!1};if(i){const d={id:Date.now().toString(),...u};Ho=[...Ho,d],o([...Ho]),setTimeout(()=>{const m=Kb(n||(r?"Nice photo! ":"...")),g={id:(Date.now()+1).toString(),text:m,senderId:"bot",senderName:"Carnival Concierge",senderPhoto:null,createdAt:new Date().toISOString(),isBot:!0};Ho=[...Ho,g],o([...Ho])},1500);return}if(!t){console.warn("sendMessage aborted: No squadId provided.");return}console.log("Sending message to Firestore...",{squadId:t,messageData:u}),await Jl(sn(Ne,"squads",t,"messages"),u),u.isBot||setTimeout(async()=>{const d=Kb(n||(r?"Nice photo! ":"...")),m={text:d,senderId:"bot",senderName:"Carnival Concierge",senderPhoto:null,createdAt:Uf(),isBot:!0,expiresAt:new Date(Date.now()+24*60*60*1e3).toISOString()};try{await Jl(sn(Ne,"squads",t,"messages"),m),console.log(" AI Concierge replied:",d)}catch(g){console.error("Failed to send AI reply:",g)}},2e3)},Kb=t=>{const e=t.toLowerCase();return e.includes("fete")||e.includes("party")?"Based on your schedule, I recommend 'Phuket' on Friday night. It's close to your Airbnb in Woodbrook and tickets are running low! ":e.includes("food")||e.includes("hungry")||e.includes("eat")?"You have to try 'Sauce Doubles' in Curepe! Or if you're near the Savannah, check out the corn soup vendor near the exit. ":e.includes("transport")||e.includes("taxi")||e.includes("uber")?"Rideshare apps like TT RideShare are reliable. For late nights, I recommend pre-booking a driver for your squad. Safety first! ":e.includes("costume")||e.includes("mas")?"Costume pickup for Tribe is at the Queen's Park Savannah. Don't forget your distribution slip and ID! ":"That sounds like a vibe! Remember to stay hydrated . Need help with transport or fete tickets?"};function C3({squadId:t,user:e,isDemoMode:n}){const[r,i]=U.useState([]),[o,a]=U.useState(""),[u,d]=U.useState(null),[m,g]=U.useState(null),v=U.useRef(null),w=U.useRef(null);console.log("SquadChat Rendered. squadId:",t,"User:",e==null?void 0:e.uid),U.useEffect(()=>{const F=N3(n?"demo-squad":t,n,N=>{i(N)});return()=>F()},[t,n]),U.useEffect(()=>{var P;(P=v.current)==null||P.scrollIntoView({behavior:"smooth"})},[r]),U.useEffect(()=>()=>{m&&URL.revokeObjectURL(m)},[m]);const E=P=>{if(P.target.files&&P.target.files[0]){const F=P.target.files[0];d(F),g(URL.createObjectURL(F))}},C=async P=>{if(P.preventDefault(),!o.trim()&&!u)return;const F=o,N=u;a(""),d(null),g(null);try{await P3(n?"demo-squad":t,e,F,N,n,i)}catch(T){console.error("Failed to send:",T),a(F)}};return t?l.jsxs("div",{className:"flex flex-col h-[65vh] sm:h-[600px] bg-white dark:bg-gray-800 rounded-2xl shadow-xl overflow-hidden border border-gray-100 dark:border-gray-700 relative",children:[l.jsxs("div",{className:"p-4 bg-gradient-to-r from-purple-600 to-indigo-600 text-white flex justify-between items-center shadow-md z-10",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-2 bg-white/20 rounded-full backdrop-blur-sm",children:l.jsx(Fb,{className:"w-5 h-5 text-white"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold text-lg",children:"Squad Chat"}),l.jsxs("p",{className:"text-xs text-purple-100 opacity-90 flex items-center gap-1",children:[l.jsx("span",{className:"w-2 h-2 bg-emerald-400 rounded-full animate-pulse"}),"Carnival Concierge Active"]})]})]}),n&&l.jsx("span",{className:"px-2 py-1 text-[10px] font-black tracking-widest bg-yellow-400 text-yellow-900 rounded uppercase",children:"Demo"})]}),l.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50 dark:bg-gray-900/50",children:[r.length===0?l.jsx("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 opacity-50",children:l.jsx("p",{children:"No messages yet. Say hi!"})}):r.map(P=>{const F=P.senderId===((e==null?void 0:e.uid)||"demo-user"),N=P.isBot;let T=!1,A=null;return P.expiresAt&&(A=new Date(P.expiresAt),new Date>A&&(T=!0)),l.jsx("div",{className:`flex w-full ${F?"justify-end":"justify-start"}`,children:l.jsxs("div",{className:`flex max-w-[85%] sm:max-w-[80%] gap-2 ${F?"flex-row-reverse":"flex-row"}`,children:[l.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center shadow-sm 
                    ${N?"bg-gradient-to-br from-pink-500 to-orange-400":"bg-gray-300 dark:bg-gray-700"}`,children:N?l.jsx(Fb,{className:"w-4 h-4 text-white"}):l.jsx(nc,{className:"w-4 h-4 text-white"})}),l.jsxs("div",{className:`flex flex-col ${F?"items-end":"items-start"}`,children:[l.jsx("span",{className:"text-[10px] text-gray-400 mb-1 ml-1",children:P.senderName}),l.jsxs("div",{className:`px-4 py-2 sm:py-3 rounded-2xl shadow-sm text-sm leading-relaxed relative break-words
                        ${F?"bg-blue-600 text-white rounded-tr-none":N?"bg-white dark:bg-gray-800 border-l-4 border-pink-500 text-gray-800 dark:text-gray-100 rounded-tl-none":"bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-100 rounded-tl-none"}
                    `,children:[P.imageUrl&&l.jsx("div",{className:"mb-2",children:T?l.jsxs("div",{className:"w-48 h-32 bg-gray-200 dark:bg-gray-700 rounded-lg flex flex-col items-center justify-center text-gray-500",children:[l.jsx($h,{className:"w-8 h-8 mb-1 opacity-50"}),l.jsx("span",{className:"text-xs italic",children:"Image expired"})]}):l.jsxs("div",{className:"relative group",children:[l.jsx("img",{src:P.imageUrl,alt:"Shared",className:"w-48 h-48 object-cover rounded-lg cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>window.open(P.imageUrl,"_blank")}),l.jsx("span",{className:"absolute top-2 right-2 bg-black/50 text-white text-[10px] px-1.5 py-0.5 rounded backdrop-blur-sm",children:" 24h"})]})}),P.text]}),l.jsx("span",{className:"text-[10px] text-gray-400 mt-1 opacity-50",children:new Date(P.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})},P.id)}),l.jsx("div",{ref:v})]}),l.jsxs("form",{onSubmit:C,className:"p-2 sm:p-4 bg-white dark:bg-gray-800 border-t border-gray-100 dark:border-gray-700",children:[m&&l.jsxs("div",{className:"mb-3 relative inline-block",children:[l.jsx("img",{src:m,alt:"Preview",className:"h-20 w-20 object-cover rounded-lg border border-purple-200"}),l.jsx("button",{type:"button",onClick:()=>{d(null),g(null)},className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 shadow-md hover:bg-red-600",children:l.jsx(_i,{className:"w-3 h-3"})})]}),l.jsxs("div",{className:"flex gap-2 items-center",children:[l.jsx("input",{type:"file",ref:w,onChange:E,accept:"image/*",className:"hidden"}),l.jsx("button",{type:"button",onClick:()=>{var P;return(P=w.current)==null?void 0:P.click()},className:"p-2 sm:p-3 flex-shrink-0 text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded-xl transition-colors",title:"Upload Image (Expires in 24h)",children:l.jsx(tc,{className:"w-5 h-5"})}),l.jsx("input",{type:"text",value:o,onChange:P=>a(P.target.value),placeholder:u?"Add caption...":"Message squad...",className:"flex-1 px-3 py-2 sm:px-4 sm:py-3 bg-gray-100 dark:bg-gray-900 border-0 rounded-xl focus:ring-2 focus:ring-purple-500 dark:text-white placeholder-gray-400 transition-all text-sm sm:text-base min-w-0"}),l.jsx("button",{type:"submit",disabled:!o.trim()&&!u,className:"p-2 sm:p-3 flex-shrink-0 bg-purple-600 text-white rounded-xl hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors shadow-lg shadow-purple-500/30",children:l.jsx(TN,{className:"w-5 h-5"})})]})]})]}):l.jsxs("div",{className:"flex flex-col h-[300px] items-center justify-center bg-gray-50 dark:bg-gray-800 rounded-2xl border border-dashed border-gray-300 dark:border-gray-700 p-8 text-center",children:[l.jsx("div",{className:"w-16 h-16 bg-gray-200 dark:bg-gray-700 rounded-full flex items-center justify-center mb-4",children:l.jsx(nc,{className:"w-8 h-8 text-gray-400"})}),l.jsx("h3",{className:"text-lg font-bold text-gray-700 dark:text-gray-200",children:"No Active Squad"}),l.jsx("p",{className:"text-gray-500 text-sm max-w-xs mx-auto",children:"Join or create a squad above to verify your Road Mode connection and start chatting!"})]})}const Ey={ticket:{label:"Ticket",icon:ev,color:"#F59E0B"},photo:{label:"Photo",icon:qh,color:"#3B82F6"}};function A3({files:t=[],onFilesChange:e,carnivalName:n,carnivalId:r,userId:i}){const[o,a]=U.useState(!1),[u,d]=U.useState(""),[m,g]=U.useState(null),[v,w]=U.useState("ticket"),[E,C]=U.useState(""),P=U.useRef(null),F=async Z=>{const H=Z.target.files[0];if(!H)return;const I=10*1024*1024;if(H.size>I){alert("File too large. Maximum size is 10MB.");return}if(!["image/jpeg","image/png","image/gif","image/webp","application/pdf"].includes(H.type)){alert("Invalid file type. Please upload an image (JPG, PNG, GIF, WebP) or PDF.");return}a(!0),d("Uploading...");try{const R=Date.now(),D=H.name.split(".").pop(),O=`users/${i}/carnivals/${r}/${R}.${D}`,B=ho(fo,O);await Xl(B,H);const M=await ec(B),ee={id:R.toString(),name:E||H.name.split(".")[0],type:v,url:M,storagePath:O,originalName:H.name,uploadedAt:new Date().toISOString(),fileType:H.type};e([...t,ee]),C(""),d(""),P.current&&(P.current.value="")}catch(R){console.error("Upload error:",R),alert("Failed to upload file. Please try again.")}a(!1)},N=async Z=>{if(confirm("Are you sure you want to delete this file?"))try{const H=ho(fo,Z.storagePath);await F1(H),e(t.filter(I=>I.id!==Z.id))}catch(H){console.error("Delete error:",H),e(t.filter(I=>I.id!==Z.id))}},T=Z=>{const H=document.createElement("a");H.href=Z.url,H.download=Z.originalName||Z.name,H.target="_blank",document.body.appendChild(H),H.click(),document.body.removeChild(H)},A=t.filter(Z=>Z.type==="ticket"),z=t.filter(Z=>Z.type==="photo");return l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{children:[l.jsxs("h3",{className:"text-xl font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[l.jsx(qh,{className:"w-5 h-5 text-purple-500"}),"Media Vault"]}),l.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Store your tickets, photos, and important documents for ",n]})]})}),l.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 rounded-xl p-4 border border-purple-100 dark:border-purple-800",children:[l.jsx("h4",{className:"font-semibold text-gray-800 dark:text-white mb-3",children:"Upload New File"}),l.jsxs("div",{className:"grid gap-3",children:[l.jsxs("div",{className:"flex gap-3",children:[l.jsx("input",{type:"text",placeholder:"File label (e.g., 'Tribe Costume Receipt')",value:E,onChange:Z=>C(Z.target.value),className:"flex-1 px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white"}),l.jsx("select",{value:v,onChange:Z=>w(Z.target.value),className:"px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white",children:Object.entries(Ey).map(([Z,{label:H}])=>l.jsx("option",{value:Z,children:H},Z))})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{ref:P,type:"file",accept:"image/*,.pdf",onChange:F,className:"hidden",id:"file-upload"}),l.jsx("label",{htmlFor:"file-upload",className:`flex-1 flex items-center justify-center gap-2 px-4 py-3 border-2 border-dashed rounded-lg cursor-pointer transition ${o?"border-gray-300 bg-gray-50 dark:bg-gray-800 cursor-not-allowed":"border-purple-300 hover:border-purple-500 hover:bg-purple-50 dark:hover:bg-purple-900/20"}`,children:o?l.jsxs(l.Fragment,{children:[l.jsx(bn,{className:"w-5 h-5 animate-spin text-purple-500"}),l.jsx("span",{className:"text-purple-600 dark:text-purple-400",children:u})]}):l.jsxs(l.Fragment,{children:[l.jsx(k3,{className:"w-5 h-5 text-purple-500"}),l.jsx("span",{className:"text-purple-600 dark:text-purple-400 font-medium",children:"Click to upload image or PDF (max 10MB)"})]})})]})]})]}),A.length>0&&l.jsxs("div",{children:[l.jsxs("h4",{className:"font-semibold text-gray-800 dark:text-white mb-3 flex items-center gap-2",children:[l.jsx(ev,{className:"w-4 h-4 text-yellow-500"}),"Tickets (",A.length,")"]}),l.jsx("div",{className:"grid gap-3",children:A.map(Z=>l.jsx(R3,{file:Z,onView:g,onDownload:T,onDelete:N},Z.id))})]}),z.length>0&&l.jsxs("div",{children:[l.jsxs("h4",{className:"font-semibold text-gray-800 dark:text-white mb-3 flex items-center gap-2",children:[l.jsx(qh,{className:"w-4 h-4 text-blue-500"}),"Photos (",z.length,")"]}),l.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:z.map(Z=>l.jsx(j3,{file:Z,onView:g,onDownload:T,onDelete:N},Z.id))})]}),t.length===0&&l.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[l.jsx(qh,{className:"w-16 h-16 mx-auto mb-3 opacity-30"}),l.jsx("p",{className:"font-medium",children:"No files uploaded yet"}),l.jsx("p",{className:"text-sm",children:"Upload your tickets, costume receipts, and travel photos"})]}),m&&l.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4",onClick:()=>g(null),children:l.jsxs("div",{className:"relative max-w-4xl max-h-[90vh] w-full",onClick:Z=>Z.stopPropagation(),children:[l.jsx("button",{onClick:()=>g(null),className:"absolute -top-12 right-0 text-white hover:text-gray-300",children:l.jsx(_i,{className:"w-8 h-8"})}),m.fileType==="application/pdf"?l.jsx("iframe",{src:m.url,className:"w-full h-[80vh] rounded-lg"}):l.jsx("img",{src:m.url,alt:m.name,className:"max-w-full max-h-[80vh] mx-auto rounded-lg"}),l.jsx("p",{className:"text-white text-center mt-4 font-medium",children:m.name})]})})]})}function R3({file:t,onView:e,onDownload:n,onDelete:r}){const i=Ey[t.type]||Ey.ticket,o=i.icon;return l.jsxs("div",{className:"flex items-center justify-between p-3 bg-white dark:bg-gray-700 rounded-lg border border-gray-100 dark:border-gray-600 shadow-sm",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:{backgroundColor:`${i.color}20`},children:l.jsx(o,{className:"w-5 h-5",style:{color:i.color}})}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-800 dark:text-white",children:t.name}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:new Date(t.uploadedAt).toLocaleDateString()})]})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("button",{onClick:()=>e(t),className:"p-2 text-gray-500 hover:text-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition",children:l.jsx(J_,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>n(t),className:"p-2 text-gray-500 hover:text-green-500 hover:bg-green-50 dark:hover:bg-green-900/20 rounded-lg transition",children:l.jsx(zm,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>r(t),className:"p-2 text-gray-500 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition",children:l.jsx(rs,{className:"w-4 h-4"})})]})]})}function j3({file:t,onView:e,onDownload:n,onDelete:r}){return l.jsxs("div",{className:"relative group rounded-lg overflow-hidden border border-gray-200 dark:border-gray-600",children:[l.jsx("img",{src:t.url,alt:t.name,className:"w-full h-32 object-cover cursor-pointer",onClick:()=>e(t)}),l.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2",children:[l.jsx("button",{onClick:()=>e(t),className:"p-2 bg-white/20 hover:bg-white/30 rounded-full text-white transition",children:l.jsx(J_,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>n(t),className:"p-2 bg-white/20 hover:bg-white/30 rounded-full text-white transition",children:l.jsx(zm,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>r(t),className:"p-2 bg-red-500/50 hover:bg-red-500/70 rounded-full text-white transition",children:l.jsx(rs,{className:"w-4 h-4"})})]}),l.jsx("p",{className:"absolute bottom-0 left-0 right-0 bg-black/60 text-white text-xs p-2 truncate",children:t.name})]})}const mh={trinidad:"https://open.spotify.com/embed/playlist/2H61cIhlAeFVmreSMqvui3",jamaica:"https://open.spotify.com/embed/playlist/37i9dQZF1DX82pCGH5USnM",miami:"https://open.spotify.com/embed/playlist/37i9dQZF1DXS1X4r7p38D5",stlucia:"https://open.spotify.com/embed/playlist/37i9dQZF1DX62XscWx9t6h",barbados:"https://open.spotify.com/embed/playlist/37i9dQZF1DX23V8kYg8jC2",stkitts:"https://open.spotify.com/embed/playlist/37i9dQZF1E4v6hGc9x5z4y",stcroix:"https://open.spotify.com/embed/playlist/37i9dQZF1E4v6hGc9x5z4y",stthomas:"https://open.spotify.com/embed/playlist/37i9dQZF1E4v6hGc9x5z4y",default:"https://open.spotify.com/embed/playlist/28bCuQ5IhyPbmvJx30ZMea"};function L3({activeCarnivalId:t,isPremium:e}){const[n,r]=U.useState(!1),[i,o]=U.useState(!1),[a,u]=U.useState(!1),d=()=>{if(!t)return{key:"default",url:mh.default};const v=Object.keys(mh).find(E=>t.toLowerCase().includes(E)),w=mh[v]||mh.default;return{key:v||"default (fallback)",url:w}},{key:m,url:g}=d();return n?l.jsxs("div",{className:`fixed z-40 transition-all duration-300 shadow-2xl overflow-hidden bg-black/90 backdrop-blur-md border border-white/20 rounded-t-2xl sm:rounded-2xl
      ${i?"bottom-24 right-4 w-64 h-16 rounded-full":"bottom-0 sm:bottom-24 right-0 sm:right-4 w-full sm:w-80 h-[400px]"}`,children:[l.jsxs("div",{className:`flex items-center justify-between p-3 bg-gradient-to-r from-pink-600 to-purple-700 text-white
        ${i?"h-full":""}`,children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(mo,{className:"w-5 h-5 animate-pulse"}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"font-bold text-sm",children:i?"Carnival Vibes":a?"Team Soca Live":"Soca Vibes Player"}),!i&&l.jsx("button",{onClick:()=>u(!a),className:"text-[10px] bg-white/20 px-2 py-0.5 rounded-full hover:bg-white/30 transition text-left w-fit",children:a?"Switch to Playlist":"Switch to Live Radio"})]})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[i?l.jsx("button",{onClick:()=>o(!1),className:"p-1 hover:bg-white/20 rounded",children:l.jsx(f3,{className:"w-4 h-4"})}):l.jsx("button",{onClick:()=>o(!0),className:"p-1 hover:bg-white/20 rounded",children:l.jsx(p3,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>r(!1),className:"p-1 hover:bg-white/20 rounded",children:l.jsx(_i,{className:"w-4 h-4"})})]})]}),!i&&l.jsxs("div",{className:"h-[calc(100%-48px)] bg-black relative",children:[!e&&!a&&l.jsx("div",{className:"absolute top-0 left-0 right-0 z-10 bg-yellow-500/90 text-black text-xs font-bold px-2 py-1 text-center",children:"Upgrade directly in Spotify for ad-free listening"}),a?l.jsx("iframe",{src:"https://ice23.securenetsystems.net/TSDC",width:"100%",height:"100%",frameBorder:"0",allow:"autoplay; encrypted-media;",title:"Team Soca Live"}):l.jsx("iframe",{style:{borderRadius:"12px"},src:g,width:"100%",height:"100%",frameBorder:"0",allowFullScreen:"",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Soca Playlist"})]})]}):l.jsx("button",{onClick:()=>r(!0),className:"fixed bottom-24 right-4 z-40 bg-gradient-to-r from-pink-500 to-purple-600 text-white p-3 rounded-full shadow-lg hover:scale-110 transition-transform animate-bounce-slow","aria-label":"Open Vibes Player",children:l.jsx(mo,{className:"w-6 h-6"})})}function D3({users:t,onDeleteUser:e,onDeleteAll:n,onClose:r}){const[i,o]=U.useState(new Set),[a,u]=U.useState(!1),d=U.useMemo(()=>t.filter(w=>{var P,F;const E=((P=w.profile)==null?void 0:P.email)&&w.profile.email.trim()!=="",C=((F=w.profile)==null?void 0:F.displayName)&&w.profile.displayName.trim()!==""&&w.profile.displayName!=="User";return!E&&!C}),[t]),m=w=>{const E=new Set(i);E.has(w)?E.delete(w):E.add(w),o(E)},g=()=>{i.size===d.length?o(new Set):o(new Set(d.map(w=>w.id)))},v=()=>{a?(n(Array.from(i)),u(!1),o(new Set)):u(!0)};return l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 shadow-xl overflow-hidden animate-fadeIn",children:[l.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center bg-red-50 dark:bg-red-900/10",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-2 bg-red-100 dark:bg-red-900/30 rounded-lg text-red-600 dark:text-red-400",children:l.jsx(EN,{className:"w-5 h-5"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-100",children:"Database Cleanup"}),l.jsxs("p",{className:"text-xs text-red-600 dark:text-red-400 font-medium",children:["Found ",d.length," incomplete records"]})]})]}),l.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-lg transition",children:l.jsx(_i,{className:"w-5 h-5 text-gray-500"})})]}),l.jsx("div",{className:"p-4",children:d.length===0?l.jsxs("div",{className:"text-center py-12 text-gray-500",children:[l.jsx(qf,{className:"w-12 h-12 mx-auto mb-3 text-green-500 opacity-50"}),l.jsx("p",{children:"Database is clean! No incomplete users found."})]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("input",{type:"checkbox",checked:i.size>0&&i.size===d.length,onChange:g,className:"rounded border-gray-300 text-red-600 focus:ring-red-500"}),l.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Select All (",d.length,")"]})]}),i.size>0&&l.jsxs("button",{onClick:v,className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold transition ${a?"bg-red-600 text-white hover:bg-red-700":"bg-red-100 text-red-700 hover:bg-red-200 dark:bg-red-900/30 dark:text-red-300"}`,children:[l.jsx(rs,{className:"w-4 h-4"}),a?"CONFIRM DELETION":`Delete (${i.size})`]})]}),l.jsx("div",{className:"max-h-[300px] overflow-y-auto border border-gray-200 dark:border-gray-700 rounded-lg",children:l.jsxs("table",{className:"w-full text-sm text-left",children:[l.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50 text-xs uppercase text-gray-500 font-medium sticky top-0 backdrop-blur-sm",children:l.jsxs("tr",{children:[l.jsx("th",{className:"p-3 w-10"}),l.jsx("th",{className:"p-3",children:"User ID"}),l.jsx("th",{className:"p-3",children:"Created"}),l.jsx("th",{className:"p-3 text-right",children:"Actions"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:d.map(w=>{var E;return l.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/30 transition",children:[l.jsx("td",{className:"p-3",children:l.jsx("input",{type:"checkbox",checked:i.has(w.id),onChange:()=>m(w.id),className:"rounded border-gray-300 text-red-600 focus:ring-red-500"})}),l.jsx("td",{className:"p-3 font-mono text-xs text-gray-500",children:w.id}),l.jsx("td",{className:"p-3 text-gray-600 dark:text-gray-300",children:(E=w.createdAt)!=null&&E.toDate?w.createdAt.toDate().toLocaleDateString():"Unknown"}),l.jsx("td",{className:"p-3 text-right",children:l.jsx("button",{onClick:()=>e(w.id),className:"text-gray-400 hover:text-red-500 transition",title:"Delete single user",children:l.jsx(rs,{className:"w-4 h-4"})})})]},w.id)})})]})})]})}),d.length>0&&l.jsxs("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900/10 border-t border-yellow-100 dark:border-yellow-900/20 flex items-start gap-3 text-xs text-yellow-800 dark:text-yellow-200",children:[l.jsx(gN,{className:"w-4 h-4 shrink-0 mt-0.5"}),l.jsxs("p",{children:[l.jsx("strong",{children:"Warning:"})," Deleting users is permanent. This will remove their record from the 'users' collection. If they sign in again, a new record will be created."]})]})]})}const M3=({onScheduleDetected:t})=>{const[e,n]=U.useState(!1),[r,i]=U.useState(""),[o,a]=U.useState(""),u=window.SpeechRecognition||window.webkitSpeechRecognition;if(!u)return null;const d=new u;d.continuous=!1,d.lang="en-US",d.interimResults=!1;const m=()=>{n(!0),a('Listening... Say "Add [Event] for [Day] at [Time]"'),d.start()},g=()=>{n(!1),d.stop()};d.onresult=w=>{const E=w.results[0][0].transcript;i(E),a("Processing..."),v(E),n(!1)},d.onerror=w=>{console.error("Voice Error:",w.error),n(!1),a("Error listening. Try again.")};const v=w=>{let E=w,C="",P="";const F=w.toLowerCase();(F.startsWith("add")||F.startsWith("schedule")||F.startsWith("remind me to"))&&(E=w.replace(/^(Add|Schedule|Remind me to)\s+/i,""));const N=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];for(const A of N)F.includes(A.toLowerCase())&&(C=A,E=E.replace(new RegExp(`(on|for)?\\s*${A}`,"i"),""));const T=E.match(/(\d{1,2}(?::\d{2})?\s?(?:am|pm)?)/i);T&&(T[0].toLowerCase().includes("am")||T[0].toLowerCase().includes("pm")||T[0].includes(":"))&&(P=T[0],E=E.replace(T[0],"")),E=E.replace(/\s+(at|for|on)\s*$/i,"").trim(),E=E.replace(/^\s+(at|for|on)\s+/i,"").trim(),E?(a(`Found: ${E} (${C||"No Day"} @ ${P||"No Time"})`),t({name:E,day:C||"Friday",time:P||"12:00 PM",note:`Voice: "${w}"`})):a("Could not understand event name.")};return l.jsxs("div",{className:"flex flex-col items-center justify-center p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-dashed border-gray-300 dark:border-gray-700 mt-4",children:[l.jsxs("button",{onClick:e?g:m,className:`
            flex items-center gap-2 px-6 py-3 rounded-full font-bold transition-all transform hover:scale-105
            ${e?"bg-red-500 text-white animate-pulse shadow-red-500/50 shadow-lg":"bg-gradient-to-r from-blue-500 to-purple-600 text-white shadow-lg"}
        `,children:[e?l.jsx(m3,{className:"w-5 h-5"}):l.jsx(xN,{className:"w-5 h-5"}),e?"Stop Listening":"Voice Add Event (Free)"]}),(r||o)&&l.jsxs("div",{className:"mt-3 text-center",children:[l.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:r&&`"${r}"`}),l.jsx("p",{className:"text-xs text-blue-500 mt-1 font-mono",children:o})]})]})},ph=[{id:"default-fete-map-banner",title:"Unlock Interactive Fete Map",imageUrl:"/images/promo/premium_fete_map_promo_banner.png",placement:"banner",mediaType:"image",linkUrl:null,isDefault:!0},{id:"default-media-vault-banner",title:"Store Your Tickets & Photos",imageUrl:"/images/promo/premium_media_vault_promo_banner.png",placement:"banner",mediaType:"image",linkUrl:null,isDefault:!0},{id:"default-offline-banner",title:"Plan Offline, Anywhere",imageUrl:"/images/promo/premium_offline_mode_promo_banner.png",placement:"banner",mediaType:"image",linkUrl:null,isDefault:!0},{id:"default-premium-banner",title:"Go Premium - Ad Free Experience",imageUrl:"/images/promo/premium_subscription_promo_banner.png",placement:"banner",mediaType:"image",linkUrl:null,isDefault:!0},{id:"default-fete-map-inline",title:"Unlock Interactive Fete Map",imageUrl:"/images/promo/premium_fete_map_promo_banner.png",placement:"inline",mediaType:"image",linkUrl:null,isDefault:!0},{id:"default-media-vault-inline",title:"Store Your Tickets & Photos",imageUrl:"/images/promo/premium_media_vault_promo_banner.png",placement:"inline",mediaType:"image",linkUrl:null,isDefault:!0},{id:"default-offline-inline",title:"Plan Offline, Anywhere",imageUrl:"/images/promo/premium_offline_mode_promo_banner.png",placement:"inline",mediaType:"image",linkUrl:null,isDefault:!0},{id:"default-premium-inline",title:"Go Premium - Ad Free Experience",imageUrl:"/images/promo/premium_subscription_promo_banner.png",placement:"inline",mediaType:"image",linkUrl:null,isDefault:!0},{id:"madd-colors-banner-v2",title:"Madd Colors Carnival - Atlanta",imageUrl:"https://www.atlanta-carnival.com/uploads/2/6/6/0/26602334/madd-logo26.jpg",placement:"banner",mediaType:"image",linkUrl:"https://maddcolorscarnival.com/",isDefault:!1},{id:"madd-colors-inline-v2",title:"Madd Colors Carnival - Atlanta",imageUrl:"https://www.atlanta-carnival.com/uploads/2/6/6/0/26602334/madd-logo26.jpg",placement:"inline",mediaType:"image",linkUrl:"https://maddcolorscarnival.com/",isDefault:!1}];function gh({placement:t="banner",className:e="",onUpgradeClick:n}){const[r,i]=U.useState([]),[o,a]=U.useState(0),[u,d]=U.useState(!1),[m,g]=U.useState(!0),[v,w]=U.useState(null);if(U.useEffect(()=>{g(!0),w(null);const T=sn(Ne,"promoAds"),A=gd(T,I_("active","==",!0)),z=qi(A,Z=>{const H=[];Z.forEach(D=>{H.push({id:D.id,...D.data()})});const I=H.filter(D=>D.placement===t),b=ph.find(D=>D.id.includes("madd-colors")&&D.placement===t);let R=I;if(I.length===0?R=ph.filter(D=>D.placement===t):b&&(I.some(O=>O.id.includes("madd-colors"))||(R=[...I,{...b,isDefault:!1}])),R.length>0)i(R);else{const D=ph.filter(O=>O.placement===t);i(D)}g(!1)},Z=>{console.error(`PromoAd [${t}] error:`,Z);const H=ph.filter(I=>I.placement===t);i(H),w(null),g(!1)});return()=>z()},[t]),U.useEffect(()=>{if(r.length<=1)return;const T=setInterval(()=>{a(A=>(A+1)%r.length)},8e3);return()=>clearInterval(T)},[r.length]),m||u||r.length===0)return null;const E=Math.min(o,r.length-1),C=r[E];if(!C||!C.imageUrl)return null;const P=C.mediaType==="video",F=C.id.includes("madd-colors")?!1:C.isDefault;C.id.includes("madd-colors")||C.linkUrl;const N=()=>{F&&n?n():C.linkUrl&&window.open(C.linkUrl,"_blank","noopener,noreferrer")};return l.jsx("div",{className:`p-4 relative ${e}`,children:l.jsxs("div",{onClick:N,className:`relative overflow-hidden rounded-lg shadow-md ${C.linkUrl||F?"cursor-pointer hover:shadow-lg transition-shadow":""}`,children:[P?l.jsx("video",{src:C.imageUrl,className:"w-full h-auto object-cover",style:{maxHeight:t==="banner"?"120px":"250px"},autoPlay:!0,muted:!0,loop:!0,playsInline:!0,onError:T=>console.error("Video load error:",T)}):l.jsx("img",{src:C.imageUrl,alt:C.title||"Promotion",className:"w-full h-auto object-cover",style:{maxHeight:t==="banner"?"120px":"250px"},onError:T=>{console.error("Image load error:",C.imageUrl),T.target.style.display="none"}}),C.title&&l.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/70 to-transparent p-3",children:[l.jsx("p",{className:"text-white text-sm font-bold truncate",children:C.title}),F&&l.jsx("p",{className:"text-yellow-300 text-xs font-medium",children:"Tap to upgrade to Premium"})]}),l.jsx("div",{className:"absolute top-1 left-1 bg-black/50 text-white text-[10px] px-1.5 py-0.5 rounded",children:F?"PREMIUM":"AD"}),l.jsx("button",{onClick:T=>{T.stopPropagation(),d(!0)},className:"absolute top-1 right-1 p-1 bg-black/50 hover:bg-black/70 text-white rounded-full transition",children:l.jsx(_i,{className:"w-3 h-3"})}),r.length>1&&l.jsx("div",{className:"absolute bottom-2 right-2 flex gap-1",children:r.map((T,A)=>l.jsx("div",{className:`w-1.5 h-1.5 rounded-full transition ${A===o?"bg-white":"bg-white/50"}`},A))})]})})}const Zb=[{id:"banner",label:"Top Banner"},{id:"sidebar",label:"Sidebar"},{id:"inline",label:"Inline (Between Sections)"}];function O3(){const[t,e]=U.useState([]),[n,r]=U.useState(!1),[i,o]=U.useState(""),[a,u]=U.useState(!1),[d,m]=U.useState({title:"",linkUrl:"",placement:"banner"}),g=U.useRef(null);U.useEffect(()=>{const C=sn(Ne,"promoAds"),P=qi(C,F=>{const N=[];F.forEach(T=>{N.push({id:T.id,...T.data()})}),N.sort((T,A)=>(A.createdAt||0)-(T.createdAt||0)),e(N)});return()=>P()},[]);const v=async C=>{const P=C.target.files[0];if(!P)return;const F=P.type.startsWith("video/"),N=F?10*1024*1024:5*1024*1024;if(P.size>N){alert(`File too large. Maximum size is ${F?"10MB for videos":"5MB for images"}.`);return}const T=["image/jpeg","image/png","image/gif","image/webp"],A=["video/mp4","video/webm"];if(![...T,...A].includes(P.type)){alert("Invalid file type. Please upload JPG, PNG, GIF, WebP, MP4, or WebM.");return}r(!0),o("Preparing upload...");const Z=setTimeout(()=>{r(!1),o(""),alert("Upload timed out after 60 seconds. Please check your connection and try again."),g.current&&(g.current.value="")},6e4);try{const H=Date.now(),I=P.name.split(".").pop(),b=`promoAds/${H}.${I}`,R=ho(fo,b);o("Uploading to storage..."),console.log("Uploading file to Storage...",b),await Xl(R,P),o("Getting download URL...");const D=await ec(R);console.log("File uploaded, URL:",D);const O=P.type.startsWith("video/"),B={title:d.title||"",linkUrl:d.linkUrl||"",placement:d.placement,imageUrl:D,mediaType:O?"video":"image",storagePath:b,active:!0,createdAt:H};o("Saving ad data..."),console.log("Saving ad metadata to Firestore...",B);const M=await Jl(sn(Ne,"promoAds"),B);console.log("Ad saved to Firestore successfully, ID:",M.id),clearTimeout(Z),alert("Ad uploaded successfully!"),m({title:"",linkUrl:"",placement:"banner"}),u(!1),g.current&&(g.current.value="")}catch(H){clearTimeout(Z),console.error("Upload error:",H),console.error("Error code:",H.code),console.error("Error message:",H.message),console.error("Full error:",JSON.stringify(H,null,2)),H.code==="storage/unauthorized"?alert("Upload failed: You do not have permission to upload ads. Make sure you are logged in with the admin account (djkrss1@gmail.com)."):H.code==="storage/canceled"?alert("Upload was cancelled."):H.code==="permission-denied"?alert("Firestore permission denied: You do not have permission to save ad metadata. Make sure you are logged in with the admin account (djkrss1@gmail.com)."):alert(`Failed to upload ad: ${H.code||"Unknown error"} - ${H.message||"Please try again."}`)}r(!1),o("")},w=async C=>{try{await Ia(We(Ne,"promoAds",C.id),{active:!C.active})}catch(P){console.error("Toggle error:",P)}},E=async C=>{if(confirm("Delete this ad?"))try{if(C.storagePath){const P=ho(fo,C.storagePath);await F1(P).catch(()=>{})}await Vm(We(Ne,"promoAds",C.id))}catch(P){console.error("Delete error:",P)}};return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsxs("h3",{className:"text-xl font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[l.jsx($h,{className:"w-5 h-5 text-orange-500"}),"Ad Manager"]}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Upload promotional ads and flyers for free users"})]}),l.jsxs("button",{onClick:()=>u(!a),className:"flex items-center gap-1 px-3 py-1.5 bg-orange-600 text-white text-sm rounded-lg hover:bg-orange-700 transition",children:[l.jsx(kN,{className:"w-4 h-4"}),"New Ad"]})]}),a&&l.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/20 rounded-xl p-4 border border-orange-200 dark:border-orange-800 space-y-3",children:[l.jsxs("div",{className:"grid gap-3",children:[l.jsx("input",{type:"text",placeholder:"Ad title (optional)",value:d.title,onChange:C=>m({...d,title:C.target.value}),className:"px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white"}),l.jsx("input",{type:"url",placeholder:"Link URL (optional) - where to go when clicked",value:d.linkUrl,onChange:C=>m({...d,linkUrl:C.target.value}),className:"px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white"}),l.jsx("select",{value:d.placement,onChange:C=>m({...d,placement:C.target.value}),className:"px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white",children:Zb.map(C=>l.jsx("option",{value:C.id,children:C.label},C.id))})]}),l.jsx("input",{ref:g,type:"file",accept:"image/*,video/mp4,video/webm",onChange:v,className:"hidden",id:"ad-upload"}),l.jsx("label",{htmlFor:"ad-upload",className:`flex flex-col items-center justify-center gap-2 px-4 py-4 border-2 border-dashed rounded-lg cursor-pointer transition ${n?"border-gray-300 bg-gray-50 cursor-not-allowed":"border-orange-300 hover:border-orange-500 hover:bg-orange-50 dark:hover:bg-orange-900/30"}`,children:n?l.jsxs(l.Fragment,{children:[l.jsx(bn,{className:"w-5 h-5 animate-spin text-orange-500"}),l.jsx("span",{className:"text-orange-600",children:i||"Uploading..."})]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx($h,{className:"w-5 h-5 text-orange-500"}),l.jsx(I3,{className:"w-5 h-5 text-orange-500"})]}),l.jsx("span",{className:"text-orange-600 font-medium",children:"Click to upload image or video"}),l.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Images: max 5MB (1200x300 recommended) | Videos: max 10MB (MP4, WebM)"})]})})]}),t.length>0?l.jsx("div",{className:"space-y-3",children:t.map(C=>{var P;return l.jsxs("div",{className:`flex items-center gap-4 p-3 rounded-lg border transition ${C.active?"bg-white dark:bg-gray-700 border-gray-200 dark:border-gray-600":"bg-gray-100 dark:bg-gray-800 border-gray-200 dark:border-gray-700 opacity-60"}`,children:[C.mediaType==="video"?l.jsx("video",{src:C.imageUrl,className:"w-20 h-14 object-cover rounded",muted:!0}):l.jsx("img",{src:C.imageUrl,alt:C.title||"Ad",className:"w-20 h-14 object-cover rounded"}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("p",{className:"font-medium text-gray-800 dark:text-white truncate",children:C.title||"Untitled Ad"}),l.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[((P=Zb.find(F=>F.id===C.placement))==null?void 0:P.label)||C.placement,C.linkUrl&&"  Has link"]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>w(C),className:`p-2 rounded-lg transition ${C.active?"text-green-600 hover:bg-green-50":"text-gray-400 hover:bg-gray-100"}`,title:C.active?"Active - Click to disable":"Inactive - Click to enable",children:C.active?l.jsx(PN,{className:"w-5 h-5"}):l.jsx(NN,{className:"w-5 h-5"})}),C.linkUrl&&l.jsx("a",{href:C.linkUrl,target:"_blank",rel:"noopener noreferrer",className:"p-2 text-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition",children:l.jsx(xd,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>E(C),className:"p-2 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition",children:l.jsx(rs,{className:"w-4 h-4"})})]})]},C.id)})}):l.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[l.jsx($h,{className:"w-16 h-16 mx-auto mb-3 opacity-30"}),l.jsx("p",{className:"font-medium",children:"No ads uploaded yet"}),l.jsx("p",{className:"text-sm",children:"Upload flyers and promotions to show to free users"})]})]})}const qc="carnival-planner-v1",V3=["djkrss1@gmail.com"],F3=Ds(kr);function U3(){const[t,e]=U.useState([]),[n,r]=U.useState(!0),[i,o]=U.useState(null),[a,u]=U.useState(""),[d,m]=U.useState(null),[g,v]=U.useState({total:0,premium:0,free:0}),[w,E]=U.useState(!1),[C,P]=U.useState(!1),[F,N]=U.useState(null),[T,A]=U.useState(!1),[z,Z]=U.useState(!1),H=async ee=>{if(confirm("Are you sure you want to delete this user? This cannot be undone."))try{await zg(async()=>{const{deleteDoc:ce}=await Promise.resolve().then(()=>vb);return{deleteDoc:ce}},void 0).then(({deleteDoc:ce})=>{ce(We(Ne,"users",ee))}),e(ce=>ce.filter(me=>me.id!==ee)),v(ce=>({...ce,total:ce.total-1,free:ce.free-1}))}catch(ce){console.error("Delete error:",ce),alert("Failed to delete user: "+ce.message)}},I=async ee=>{try{const{deleteDoc:ce}=await zg(async()=>{const{deleteDoc:we}=await Promise.resolve().then(()=>vb);return{deleteDoc:we}},void 0);let me=0;for(const we of ee)await ce(We(Ne,"users",we)),me++;e(we=>we.filter(G=>!ee.includes(G.id))),v(we=>({...we,total:we.total-me,free:we.free-me})),alert(`Successfully deleted ${me} users.`)}catch(ce){console.error("Batch delete error:",ce),alert("Batch delete failed partially: "+ce.message)}},b=async()=>{A(!0),N("Migrating users from Firebase Auth...");try{const ce=await Ms(F3,"migrateAuthUsers")({});N(ce.data.message),await D()}catch(ee){console.error("Auth migration error:",ee),N(`Auth migration failed: ${ee.message}`)}A(!1)},R=async()=>{var ee,ce,me,we,G,le,te,ke,de,pe,ve,he,se,Me,Ye,tr;P(!0),N("Starting migration...");try{const Pt=new Map;let In=[];try{const ht=await Qo(sn(Ne,"user-activity"));console.log("[Migration] Found",ht.size,"user-activity records"),In.push(`${ht.size} activity records`);for(const ft of ht.docs){const Ke=ft.data(),$t=Ke.uid;if($t)if(!Pt.has($t))Pt.set($t,{createdAt:Ke.loginAt,lastLoginAt:Ke.loginAt,email:Ke.email||null,displayName:Ke.displayName||null});else{const mt=Pt.get($t);((ce=(ee=Ke.loginAt)==null?void 0:ee.toMillis)==null?void 0:ce.call(ee))<((we=(me=mt.createdAt)==null?void 0:me.toMillis)==null?void 0:we.call(me))&&(mt.createdAt=Ke.loginAt),((le=(G=Ke.loginAt)==null?void 0:G.toMillis)==null?void 0:le.call(G))>((ke=(te=mt.lastLoginAt)==null?void 0:te.toMillis)==null?void 0:ke.call(te))&&(mt.lastLoginAt=Ke.loginAt),!mt.email&&Ke.email&&(mt.email=Ke.email),!mt.displayName&&Ke.displayName&&(mt.displayName=Ke.displayName)}}}catch(ht){console.log("[Migration] Could not fetch user-activity:",ht.message)}try{const ht=await Qo(sn(Ne,"artifacts",qc,"users"));console.log("[Migration] Found",ht.size,"artifact users"),In.push(`${ht.size} artifact users`);for(const ft of ht.docs){const Ke=ft.id,$t=ft.data();Pt.has(Ke)||Pt.set(Ke,{createdAt:$t.createdAt||Be.now(),lastLoginAt:$t.lastLoginAt||Be.now(),email:null,displayName:null})}}catch(ht){console.log("[Migration] Could not fetch artifacts:",ht.message)}N(`Found ${Pt.size} unique users (${In.join(", ")})...`);let cn=0;for(const[ht,ft]of Pt)try{const Ke=We(Ne,"users",ht),$t=await zr(Ke);if(!$t.exists())await Rn(Ke,ft),cn++;else{const mt=$t.data(),un={};ft.createdAt&&(!mt.createdAt||((pe=(de=ft.createdAt).toMillis)==null?void 0:pe.call(de))<((he=(ve=mt.createdAt)==null?void 0:ve.toMillis)==null?void 0:he.call(ve)))&&(un.createdAt=ft.createdAt),ft.lastLoginAt&&(!mt.lastLoginAt||((Me=(se=ft.lastLoginAt).toMillis)==null?void 0:Me.call(se))>((tr=(Ye=mt.lastLoginAt)==null?void 0:Ye.toMillis)==null?void 0:tr.call(Ye)))&&(un.lastLoginAt=ft.lastLoginAt),!mt.email&&ft.email&&(un.email=ft.email),!mt.displayName&&ft.displayName&&(un.displayName=ft.displayName),Object.keys(un).length>0&&(await Rn(Ke,un,{merge:!0}),cn++)}}catch(Ke){console.error(`Failed to migrate user ${ht}:`,Ke)}N(`Migration complete! Migrated ${cn} users.`),await D()}catch(Pt){console.error("Migration error:",Pt),N(`Migration failed: ${Pt.message}`)}P(!1)},D=async()=>{var ee,ce,me,we,G;r(!0),o(null);try{console.log("[AdminAnalytics] Fetching users...");const le=new Map;try{console.log("[AdminAnalytics] Attempting to fetch users collection...");const de=await Qo(sn(Ne,"users"));console.log("[AdminAnalytics] SUCCESS: Found",de.size,"user documents in users collection"),de.docs.forEach(pe=>console.log("[AdminAnalytics] User doc:",pe.id,pe.data()));for(const pe of de.docs){const ve=pe.id,he=pe.data();le.set(ve,{id:ve,createdAt:he.createdAt,lastLoginAt:he.lastLoginAt,profile:{email:he.email||null,displayName:he.displayName||null},source:"users"})}}catch(de){console.log("[AdminAnalytics] Could not fetch users collection:",de.message)}try{console.log("[AdminAnalytics] Attempting to fetch user-activity collection...");const de=await Qo(sn(Ne,"user-activity"));console.log("[AdminAnalytics] SUCCESS: Found",de.size,"activity records");for(const pe of de.docs){const ve=pe.data(),he=ve.uid;if(he&&!le.has(he))le.set(he,{id:he,createdAt:ve.loginAt||null,lastLoginAt:ve.loginAt||null,profile:{email:ve.email||null,displayName:ve.displayName||null},source:"user-activity"});else if(he&&le.has(he)){const se=le.get(he);ve.loginAt&&(!se.lastLoginAt||((ce=(ee=ve.loginAt).toMillis)==null?void 0:ce.call(ee))>((we=(me=se.lastLoginAt).toMillis)==null?void 0:we.call(me)))&&(se.lastLoginAt=ve.loginAt),!se.profile.email&&ve.email&&(se.profile.email=ve.email)}}}catch(de){console.log("[AdminAnalytics] Could not fetch user-activity collection:",de.message)}try{console.log("[AdminAnalytics] Attempting to fetch artifacts collection...");const de=await Qo(sn(Ne,"artifacts",qc,"users"));console.log("[AdminAnalytics] SUCCESS: Found",de.size,"users in artifacts collection");for(const pe of de.docs){const ve=pe.id;if(!le.has(ve)){const he=pe.data();le.set(ve,{id:ve,createdAt:he.createdAt||null,lastLoginAt:he.lastLoginAt||null,profile:{email:null,displayName:null},source:"artifacts"})}}}catch(de){console.log("[AdminAnalytics] Could not fetch artifacts collection:",de.message)}const te=[];for(const[de,pe]of le){try{const he=We(Ne,"users",de,"profile","info"),se=await zr(he);if(se.exists()){const Me=se.data();pe.profile={...pe.profile,...Me,email:Me.email||pe.profile.email,displayName:Me.displayName||pe.profile.displayName}}}catch{}pe.isPremium=!1,pe.carnivalCount=0;try{const he=We(Ne,"users",de,"apps",qc),se=await zr(he);if(se.exists()){const Me=se.data();pe.isPremium=!!Me.premiumActive,Me.selectedCarnivals&&(pe.carnivalCount=Object.keys(Me.selectedCarnivals).length)}}catch{try{const se=We(Ne,"artifacts",qc,"users",de),Me=await zr(se);if(Me.exists()){const Ye=Me.data();pe.isPremium=!!Ye.premiumActive,Ye.selectedCarnivals&&(pe.carnivalCount=Object.keys(Ye.selectedCarnivals).length)}}catch{}}const ve=((G=pe.profile)==null?void 0:G.email)||"";ve&&V3.includes(ve.toLowerCase())&&(pe.isPremium=!0,pe.premiumOverride=!0),te.push(pe)}console.log("[AdminAnalytics] Total unique users found:",te.length),te.sort((de,pe)=>{var se,Me,Ye,tr;const ve=((Me=(se=de.createdAt)==null?void 0:se.toDate)==null?void 0:Me.call(se))||new Date(0);return(((tr=(Ye=pe.createdAt)==null?void 0:Ye.toDate)==null?void 0:tr.call(Ye))||new Date(0))-ve}),e(te);const ke=te.filter(de=>de.isPremium).length;v({total:te.length,premium:ke,free:te.length-ke})}catch(le){console.error("Error fetching users:",le),o(le.message||"Failed to fetch users")}r(!1)};U.useEffect(()=>{D()},[]);const O=async()=>{E(!0),await D(),E(!1)},B=async(ee,ce,me)=>{if(me){alert("This user has premium via email override. Cannot toggle manually.");return}try{const we=We(Ne,"users",ee,"apps",qc);await Rn(we,{premiumActive:!ce,premiumUpdatedAt:Be.now(),premiumUpdatedBy:"admin-manual"},{merge:!0}),e(G=>G.map(le=>le.id===ee?{...le,isPremium:!ce}:le)),v(G=>({...G,premium:ce?G.premium-1:G.premium+1,free:ce?G.free+1:G.free-1})),alert(`Premium ${ce?"disabled":"enabled"} for user.`)}catch(we){console.error("Error toggling premium:",we),alert("Failed to update premium status: "+we.message)}},M=t.filter(ee=>{var G,le;const ce=((G=ee.profile)==null?void 0:G.email)||ee.id,me=((le=ee.profile)==null?void 0:le.displayName)||"",we=a.toLowerCase();return ce.toLowerCase().includes(we)||me.toLowerCase().includes(we)});return n?l.jsxs("div",{className:"flex items-center justify-center py-12",children:[l.jsx(bn,{className:"w-8 h-8 animate-spin text-blue-500"}),l.jsx("span",{className:"ml-2 text-gray-500 dark:text-gray-400",children:"Loading user data..."})]}):i?l.jsxs("div",{className:"text-center py-12",children:[l.jsx("p",{className:"text-red-500 mb-4",children:i}),l.jsx("button",{onClick:O,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Try Again"})]}):l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsxs("h3",{className:"text-xl font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[l.jsx(Gn,{className:"w-5 h-5 text-blue-500"}),"User Analytics"]}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"View and manage registered users"})]}),l.jsxs("div",{className:"flex gap-2 flex-wrap",children:[l.jsxs("button",{onClick:b,disabled:T,className:"flex items-center gap-1 px-3 py-1.5 bg-purple-600 text-white text-sm rounded-lg hover:bg-purple-700 transition disabled:opacity-50",children:[T?l.jsx(bn,{className:"w-4 h-4 animate-spin"}):l.jsx(zm,{className:"w-4 h-4"}),"Migrate Auth Users"]}),l.jsxs("button",{onClick:R,disabled:C,className:"flex items-center gap-1 px-3 py-1.5 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700 transition disabled:opacity-50",children:[C?l.jsx(bn,{className:"w-4 h-4 animate-spin"}):l.jsx(Gn,{className:"w-4 h-4"}),"Migrate Data"]}),l.jsxs("button",{onClick:()=>Z(!z),className:`flex items-center gap-1 px-3 py-1.5 text-sm rounded-lg transition ${z?"bg-red-600 text-white hover:bg-red-700":"bg-white border border-gray-200 text-gray-700 hover:bg-gray-50 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200"}`,children:[l.jsx(EN,{className:"w-4 h-4"}),z?"Close Cleanup":"Cleanup Tool"]}),l.jsxs("button",{onClick:O,disabled:w,className:"flex items-center gap-1 px-3 py-1.5 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 transition disabled:opacity-50",children:[l.jsx(v3,{className:`w-4 h-4 ${w?"animate-spin":""}`}),"Refresh"]})]})]}),z&&l.jsx(D3,{users:t,onDeleteUser:H,onDeleteAll:I,onClose:()=>Z(!1)}),F&&l.jsx("div",{className:`p-3 rounded-lg text-sm ${F.includes("failed")?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400"}`,children:F}),l.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[l.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl p-4 text-white",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx(Gn,{className:"w-5 h-5 opacity-80"}),l.jsx("span",{className:"text-sm font-medium opacity-80",children:"Total Users"})]}),l.jsx("p",{className:"text-3xl font-bold",children:g.total})]}),l.jsxs("div",{className:"bg-gradient-to-br from-yellow-500 to-orange-500 rounded-xl p-4 text-white",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx(Bb,{className:"w-5 h-5 opacity-80"}),l.jsx("span",{className:"text-sm font-medium opacity-80",children:"Premium"})]}),l.jsx("p",{className:"text-3xl font-bold",children:g.premium})]}),l.jsxs("div",{className:"bg-gradient-to-br from-gray-500 to-gray-600 rounded-xl p-4 text-white",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx(Gn,{className:"w-5 h-5 opacity-80"}),l.jsx("span",{className:"text-sm font-medium opacity-80",children:"Free"})]}),l.jsx("p",{className:"text-3xl font-bold",children:g.free})]})]}),l.jsxs("div",{className:"relative",children:[l.jsx(IN,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"Search by email or name...",value:a,onChange:ee=>u(ee.target.value),className:"w-full pl-10 pr-4 py-3 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white"})]}),l.jsx("div",{className:"space-y-2",children:M.length===0?l.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:a?"No users match your search":"No users found"}):M.map(ee=>{var ce,me,we,G;return l.jsxs("div",{className:"bg-white dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600 overflow-hidden",children:[l.jsxs("div",{className:"flex items-center gap-3 p-3 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-600",onClick:()=>m(d===ee.id?null:ee.id),children:[(ce=ee.profile)!=null&&ce.avatarUrl?l.jsx("img",{src:ee.profile.avatarUrl,alt:"",className:"w-10 h-10 rounded-full object-cover"}):l.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-200 dark:bg-gray-500 flex items-center justify-center",children:l.jsx(Gn,{className:"w-5 h-5 text-gray-400 dark:text-gray-300"})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("p",{className:"font-medium text-gray-800 dark:text-white truncate",children:((me=ee.profile)==null?void 0:me.displayName)||"No name"}),ee.isPremium&&l.jsxs("span",{className:`px-1.5 py-0.5 text-xs rounded-full flex items-center gap-1 ${ee.premiumOverride?"bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-400":"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400"}`,children:[l.jsx(Bb,{className:"w-3 h-3"}),ee.premiumOverride?"Admin":"Premium"]})]}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate",children:((we=ee.profile)==null?void 0:we.email)||ee.id})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[ee.carnivalCount>0&&l.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400 flex items-center gap-1",children:[l.jsx(ns,{className:"w-4 h-4"}),ee.carnivalCount," carnival",ee.carnivalCount!==1?"s":""]}),d===ee.id?l.jsx(o3,{className:"w-5 h-5 text-gray-400"}):l.jsx(s3,{className:"w-5 h-5 text-gray-400"})]})]}),d===ee.id&&l.jsxs("div",{className:"px-4 pb-4 pt-2 border-t border-gray-100 dark:border-gray-600 bg-gray-50 dark:bg-gray-800",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"User ID"}),l.jsx("p",{className:"text-sm font-mono text-gray-700 dark:text-gray-300 truncate",children:ee.id})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Bio"}),l.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:((G=ee.profile)==null?void 0:G.bio)||"No bio"})]})]}),l.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-gray-200 dark:border-gray-600",children:[l.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Premium Status"}),l.jsx("button",{onClick:le=>{le.stopPropagation(),B(ee.id,ee.isPremium,ee.premiumOverride)},className:`flex items-center gap-2 px-3 py-1.5 rounded-lg transition ${ee.isPremium?"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"}`,children:ee.isPremium?l.jsxs(l.Fragment,{children:[l.jsx(PN,{className:"w-5 h-5"}),l.jsx("span",{children:"Premium Active"})]}):l.jsxs(l.Fragment,{children:[l.jsx(NN,{className:"w-5 h-5"}),l.jsx("span",{children:"Free User"})]})})]})]})]},ee.id)})}),l.jsxs("p",{className:"text-xs text-gray-400 dark:text-gray-500 text-center",children:["Showing ",M.length," of ",t.length," users"]})]})}const AN=[{name:"TRIBE Carnival",carnivalId:"trinidad",type:"mas",website:"https://tribecarnival.com",tags:["Premium","High Energy","Popular"]},{name:"The Lost Tribe",carnivalId:"trinidad",type:"mas",website:"https://losttribecarnival.com",tags:["Creative","Thematic","Premium"]},{name:"Bliss Carnival",carnivalId:"trinidad",type:"mas",website:"https://blisscarnival.com",tags:["Premium","Exclusive"]},{name:"YUMA Vibe",carnivalId:"trinidad",type:"mas",website:"https://yumavibe.com",tags:["Young","Energetic","Party"]},{name:"Harts Carnival",carnivalId:"trinidad",type:"mas",website:"https://hartscarnival.com",tags:["Traditional","Family","Fun"]},{name:"Pure Carnival",carnivalId:"trinidad",type:"mas",website:"https://pure.carnival-tribe.com",tags:["Fun","All Inclusive"]},{name:"Paparazzi Carnival",carnivalId:"trinidad",type:"mas",website:"https://paparazzicarnival.com",tags:["Thematic","Design"]},{name:"Ronnie and Caro",carnivalId:"trinidad",type:"mas",website:"https://ronnieandcaro.com",tags:["Big Band","Winner"]},{name:"K2K Alliance",carnivalId:"trinidad",type:"mas",website:"https://k2k-alliance.com",tags:["Artistic","Couture"]},{name:"Resonate Carnival",carnivalId:"trinidad",type:"mas",tags:["New","Vibes"]},{name:"Showtime Carnival",carnivalId:"trinidad",type:"mas",tags:["Affordable","Fun"]},{name:"Spirit Mas",carnivalId:"trinidad",type:"mas",tags:["Inaugural","Exciting"]},{name:"Exousia Mas",carnivalId:"trinidad",type:"mas",tags:["Small Band","Detailed"]},{name:"Just Wee and Friends",carnivalId:"trinidad",type:"mas",tags:["J'ouvert","Fun"]},{name:"Xodus Carnival",carnivalId:"jamaica",type:"mas",website:"https://xoduscarnival.com",tags:["Premium","Big Band"]},{name:"Bacchanal Jamaica",carnivalId:"jamaica",type:"mas",website:"https://bacchanaljamaica.com",tags:["Legacy","Big Band"]},{name:"Xaymaca International",carnivalId:"jamaica",type:"mas",website:"https://xaymacainternational.com",tags:["Premium","Vibes"]},{name:"Yardmas Carnival",carnivalId:"jamaica",type:"mas",website:"https://yardmas.com",tags:["New","Local"]},{name:"GenX Jamaica",carnivalId:"jamaica",type:"mas",website:"https://genxcarnival.com",tags:["Miami Link","Fun"]},{name:"Ocho Rios Carnival",carnivalId:"jamaica",type:"mas",tags:["North Coast","Holiday"]},{name:"GenX Carnival",carnivalId:"miami",type:"mas",website:"https://genx.carnival-tribe.com",tags:["Big Band","Winner"]},{name:"Ramajay Mas",carnivalId:"miami",type:"mas",website:"https://ramajaymas.com",tags:["Vibes","Party"]},{name:"Revel Nation",carnivalId:"miami",type:"mas",tags:["Premium","Service"]},{name:"One Island Band",carnivalId:"miami",type:"mas",website:"https://oneislandband.com",tags:["Big Band","Fun"]},{name:"Freaks Mas",carnivalId:"miami",type:"mas",website:"https://freaksmas.com",tags:["Energy","New York Link"]},{name:"Dingolay Mas",carnivalId:"miami",type:"mas",tags:["Vibrant","Fun"]},{name:"K-Paya",carnivalId:"miami",type:"mas",tags:["Party","Vibes"]},{name:"Savage Mas",carnivalId:"miami",type:"mas",tags:["Sexy","Fun"]},{name:"Euphoria Mas",carnivalId:"miami",type:"mas",tags:["Service","Quality"]},{name:"UCOM (United Colours of Mas)",carnivalId:"nottinghill",type:"mas",website:"https://unitedcoloursofmas.com",tags:["Modern","Premium"]},{name:"Chocolate Nation",carnivalId:"nottinghill",type:"mas",website:"https://chocolatenationmas.com",tags:["Vibes","Service"]},{name:"Mangrove Carnival",carnivalId:"nottinghill",type:"mas",tags:["Traditional","Community"]},{name:"Gemz Mas",carnivalId:"nottinghill",type:"mas",tags:["Sexy","Fun"]},{name:"Caribbean Sessions",carnivalId:"nottinghill",type:"mas",tags:["Party","Inclusive"]},{name:"Colours Carnival",carnivalId:"nottinghill",type:"mas",tags:["Colourful","Fun"]},{name:"Saldenah Carnival",carnivalId:"toronto",type:"mas",website:"https://saldenahcarnival.com",tags:["Legendary","Big Band","Winner"]},{name:"Carnival Nationz",carnivalId:"toronto",type:"mas",website:"https://carnivalnationz.com",tags:["Big Band","Vibes"]},{name:"Toronto Revellers",carnivalId:"toronto",type:"mas",website:"https://torontorevellers.com",tags:["Community","Fun"]},{name:"Tribal Carnival",carnivalId:"toronto",type:"mas",tags:["Culture","Mas"]},{name:"Venom Mas",carnivalId:"toronto",type:"mas",tags:["Sexy","Party"]},{name:"Fantazia",carnivalId:"toronto",type:"mas",tags:["Fun","Service"]},{name:"Krave The Band",carnivalId:"barbados",type:"mas",website:"https://kravetheband.com",tags:["Premium","Luxury"]},{name:"Aura Experience",carnivalId:"barbados",type:"mas",website:"https://auraexperience.com",tags:["Rihanna","Vibes"]},{name:"Zulu International",carnivalId:"barbados",type:"mas",tags:["Fun","Party"]},{name:"Baje International",carnivalId:"barbados",type:"mas",tags:["Legacy","Service"]},{name:"Erup The Band",carnivalId:"barbados",type:"mas",tags:["Energy","Soca"]},{name:"Oro Luxury Carnival",carnivalId:"grenada",type:"mas",tags:["Premium","Luxury"]},{name:"Xtravo",carnivalId:"grenada",type:"mas",tags:["Party","Vibes"]},{name:"Lavish The Band",carnivalId:"grenada",type:"mas",tags:["Service","Costumes"]},{name:"Legends Carnival",carnivalId:"stlucia",type:"mas",tags:["Big Band","Fun"]},{name:"Xuovo",carnivalId:"stlucia",type:"mas",tags:["Vibes","Party"]},{name:"Fuzion Mas",carnivalId:"stlucia",type:"mas",tags:["Premium","Service"]},{name:"Insane Carnival",carnivalId:"antigua",type:"mas",tags:["Fun","Party"]},{name:"Myst Carnival",carnivalId:"antigua",type:"mas",tags:["Sexy","Vibes"]},{name:"Seaduced",carnivalId:"antigua",type:"mas",tags:["Luxury","Premium"]},{name:"Madd Colors Carnival",carnivalId:"atlanta",type:"mas",website:"https://maddcolorscarnival.com/",tags:["Premium","#1 Band"]},{name:"We Kinda Ting",carnivalId:"atlanta",type:"mas",tags:["Fun","Local"]},{name:"Savage Mas",carnivalId:"atlanta",type:"mas",tags:["Sexy","Vibes"]},{name:"Panache",carnivalId:"atlanta",type:"mas",tags:["Service","Costumes"]}];function B3({carnivalId:t}){const[e,n]=U.useState(""),[r,i]=U.useState("all"),o=U.useMemo(()=>AN.filter(u=>{if(t&&u.carnivalId!==t)return!1;const d=e.toLowerCase(),m=u.name.toLowerCase().includes(d)||u.tags.some(v=>v.toLowerCase().includes(d)),g=r==="all"||u.type===r;return m&&g}),[t,e,r]),a=u=>{switch(u){case"trinidad":return"Trinidad";case"jamaica":return"Jamaica";case"miami":return"Miami";case"nottinghill":return"London";case"toronto":return"Toronto";case"barbados":return"Barbados";case"grenada":return"Grenada";case"antigua":return"Antigua";case"stlucia":return"St. Lucia";case"atlanta":return"Atlanta";default:return u}};return l.jsxs("div",{className:"space-y-6 animate-fadeIn",children:[l.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:l.jsxs("div",{className:"flex flex-col md:flex-row gap-4 justify-between items-center",children:[l.jsxs("div",{children:[l.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 text-gray-800 dark:text-white",children:[l.jsx(zb,{className:"w-5 h-5 text-purple-500"}),"Costume Bands"]}),l.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Find your perfect fit for ",t?a(t):"Carnival"]})]}),l.jsxs("div",{className:"relative w-full md:w-64",children:[l.jsx(IN,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"Search bands...",value:e,onChange:u=>n(u.target.value),className:"w-full pl-9 pr-4 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-sm focus:ring-2 focus:ring-purple-500 transition"})]})]})}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o.map((u,d)=>l.jsxs("div",{className:"group bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-5 hover:shadow-lg transition-all duration-300 hover:border-purple-300 dark:hover:border-purple-700",children:[l.jsxs("div",{className:"flex justify-between items-start mb-3",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold text-lg text-gray-900 dark:text-white group-hover:text-purple-600 dark:group-hover:text-purple-400 transition-colors",children:u.name}),!t&&l.jsxs("span",{className:"text-xs font-medium text-gray-500 flex items-center gap-1 mt-1",children:[l.jsx(ns,{className:"w-3 h-3"}),a(u.carnivalId)]})]}),u.website&&l.jsx("a",{href:u.website,target:"_blank",rel:"noopener noreferrer",className:"p-2 bg-gray-50 dark:bg-gray-700 rounded-full hover:bg-purple-100 hover:text-purple-600 dark:hover:bg-purple-900/40 dark:hover:text-purple-400 transition",children:l.jsx(xd,{className:"w-4 h-4"})})]}),l.jsx("div",{className:"flex flex-wrap gap-2 mt-4",children:u.tags.map((m,g)=>l.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-purple-50 text-purple-600 dark:bg-purple-900/20 dark:text-purple-300 rounded-md",children:m},g))})]},d))}),o.length===0&&l.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[l.jsx(zb,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),l.jsx("p",{children:"No bands found matching your search."})]})]})}function z3({onGetStarted:t,logo:e,onTryDemo:n}){const[r,i]=U.useState(0),[o,a]=U.useState({x:0,y:0});return U.useEffect(()=>{const u=()=>i(window.scrollY),d=m=>a({x:m.clientX,y:m.clientY});return window.addEventListener("scroll",u),window.addEventListener("mousemove",d),()=>{window.removeEventListener("scroll",u),window.removeEventListener("mousemove",d)}},[]),l.jsxs("div",{className:"min-h-screen bg-black text-white overflow-x-hidden selection:bg-pink-500 selection:text-white font-sans",children:[l.jsxs("div",{className:"fixed inset-0 pointer-events-none z-0",children:[l.jsx("div",{className:"absolute w-[800px] h-[800px] bg-indigo-600/20 rounded-full blur-[120px] mix-blend-screen transition-transform duration-100 ease-out",style:{top:-200,left:-200,transform:`translate(${o.x*.02}px, ${o.y*.02}px)`}}),l.jsx("div",{className:"absolute w-[600px] h-[600px] bg-pink-600/20 rounded-full blur-[100px] mix-blend-screen transition-transform duration-100 ease-out",style:{bottom:-100,right:-100,transform:`translate(${o.x*-.03}px, ${o.y*-.03}px)`}})]}),l.jsx("nav",{className:"fixed top-0 w-full z-50 px-6 py-4 backdrop-blur-md border-b border-white/5 bg-black/50",children:l.jsxs("div",{className:"max-w-7xl mx-auto flex justify-between items-center",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-pink-500 to-indigo-600 flex items-center justify-center font-bold text-sm",children:"CP"}),l.jsx("span",{className:"font-bold tracking-tight text-white/90",children:"Carnival Planner"})]}),l.jsx("button",{onClick:t,className:"px-4 py-2 bg-white/10 hover:bg-white/20 border border-white/10 rounded-full text-sm font-semibold transition-all",children:"Log In"})]})}),l.jsxs("section",{className:"relative z-10 pt-40 pb-20 px-6 max-w-7xl mx-auto flex flex-col items-center text-center",children:[l.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/5 border border-white/10 backdrop-blur-sm mb-8 animate-fadeIn",children:[l.jsxs("span",{className:"relative flex h-2 w-2",children:[l.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"}),l.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-green-500"})]}),l.jsx("span",{className:"text-xs font-medium text-gray-400 tracking-wide uppercase",children:"V2.0 Now Live"})]}),l.jsxs("h1",{className:"text-6xl md:text-8xl font-black tracking-tighter mb-8 bg-clip-text text-transparent bg-gradient-to-b from-white via-white to-gray-500 leading-tight",children:["The Operating System",l.jsx("br",{}),l.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-pink-500 via-purple-500 to-indigo-500",children:"For Carnival."})]}),l.jsx("p",{className:"text-xl text-gray-400 max-w-2xl mb-12 leading-relaxed",children:"The all-in-one workspace for your next carnival. Budget, schedule, squad sync, and ticketing  seamlessly integrated."}),l.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[l.jsxs("button",{onClick:t,className:"group relative px-8 py-4 bg-white text-black rounded-full font-bold text-lg shadow-[0_0_40px_-10px_rgba(255,255,255,0.3)] hover:shadow-[0_0_60px_-10px_rgba(255,255,255,0.5)] transition-all transform hover:scale-105",children:["Start Planning For Free",l.jsx(zh,{className:"inline-block ml-2 w-5 h-5 group-hover:translate-x-1 transition-transform"})]}),l.jsx("button",{onClick:n,className:"px-8 py-4 bg-white/10 hover:bg-white/20 border border-white/10 text-white rounded-full font-bold text-lg backdrop-blur-sm transition-all transform hover:scale-105",children:"Try Live Demo"})]}),l.jsxs("div",{className:"mt-20 relative w-full max-w-5xl aspect-[16/9] bg-gray-900/50 rounded-xl border border-white/10 backdrop-blur-sm overflow-hidden shadow-2xl group",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-white/5 to-transparent pointer-events-none"}),l.jsxs("div",{className:"absolute top-4 left-4 right-4 h-4 flex gap-2",children:[l.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500/50"}),l.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-500/50"}),l.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500/50"})]}),l.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:l.jsxs("div",{className:"text-center space-y-4",children:[l.jsx("div",{className:"inline-block p-4 rounded-2xl bg-gradient-to-br from-purple-600 to-pink-600 shadow-xl mb-4 group-hover:scale-110 transition-transform duration-500",children:l.jsx(tv,{className:"w-12 h-12 text-white"})}),l.jsx("div",{className:"text-2xl font-bold text-white/50",children:"Mission Control"})]})})]})]}),l.jsx("div",{className:"w-full bg-white/5 border-y border-white/5 py-4 overflow-hidden relative z-10 backdrop-blur-sm",children:l.jsxs("div",{className:"flex animate-marquee whitespace-nowrap gap-12 text-sm font-medium text-gray-400 uppercase tracking-widest",children:[l.jsx("span",{children:"  350+ Live Squads"}),l.jsx("span",{children:"  Trinidad 2026 Ready"}),l.jsx("span",{children:"  Expense Tracking"}),l.jsx("span",{children:"  Soca Included"}),l.jsx("span",{children:"  Passport Sync Active"}),l.jsx("span",{children:"  Global Carnival Database"}),l.jsx("span",{children:"  350+ Live Squads"}),l.jsx("span",{children:"  Trinidad 2026 Ready"}),l.jsx("span",{children:"  Expense Tracking"}),l.jsx("span",{children:"  Soca Included"}),l.jsx("span",{children:"  Passport Sync Active"}),l.jsx("span",{children:"  Global Carnival Database"})]})}),l.jsxs("section",{className:"relative z-10 py-32 px-6 max-w-7xl mx-auto",children:[l.jsx("div",{className:"mb-16",children:l.jsxs("h2",{className:"text-4xl md:text-5xl font-black mb-6",children:["Everything you need.",l.jsx("br",{}),"Nothing you don't."]})}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 auto-rows-[300px]",children:[l.jsxs("div",{className:"md:col-span-2 relative group overflow-hidden rounded-3xl bg-gray-900 border border-white/10 hover:border-white/20 transition-all p-8 flex flex-col justify-between",children:[l.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-20 group-hover:opacity-40 transition-opacity",children:l.jsx(Gn,{className:"w-48 h-48 text-indigo-500 transform rotate-12 translate-x-12 -translate-y-12"})}),l.jsxs("div",{children:[l.jsx("div",{className:"w-12 h-12 rounded-xl bg-indigo-500/20 flex items-center justify-center mb-4 text-indigo-400",children:l.jsx(Gn,{})}),l.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Squad Sync"}),l.jsx("p",{className:"text-gray-400 max-w-sm",children:"Real-time collaboration. See when your friends add events, update budgets, or get road ready."})]}),l.jsxs("div",{className:"flex -space-x-4 mt-8",children:[[1,2,3,4].map(u=>l.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-800 border-4 border-gray-900 flex items-center justify-center text-xs font-bold text-gray-500 transform transition-transform group-hover:translate-x-2",style:{transitionDelay:`${u*50}ms`},children:"User"},u)),l.jsx("div",{className:"w-12 h-12 rounded-full bg-indigo-600 border-4 border-gray-900 flex items-center justify-center text-xs font-bold text-white z-10",children:"+3"})]})]}),l.jsxs("div",{className:"md:row-span-2 relative group overflow-hidden rounded-3xl bg-gray-900 border border-white/10 hover:border-white/20 transition-all p-8 flex flex-col",children:[l.jsx("div",{className:"w-12 h-12 rounded-xl bg-green-500/20 flex items-center justify-center mb-4 text-green-400",children:l.jsx(Hm,{})}),l.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Smart Budget"}),l.jsx("p",{className:"text-gray-400 mb-8",children:"Track every costume payment, fete ticket, and flight."}),l.jsxs("div",{className:"mt-auto space-y-4",children:[l.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 group-hover:bg-gray-750 transition-colors",children:[l.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[l.jsx("span",{children:"Costume Deposit"}),l.jsx("span",{className:"font-mono text-green-400",children:"-$300"})]}),l.jsx("div",{className:"w-full bg-gray-700 h-1.5 rounded-full overflow-hidden",children:l.jsx("div",{className:"bg-green-500 w-3/4 h-full rounded-full"})})]}),l.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 group-hover:bg-gray-750 transition-colors",children:[l.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[l.jsx("span",{children:"Flight (MIA  POS)"}),l.jsx("span",{className:"font-mono text-green-400",children:"-$850"})]}),l.jsx("div",{className:"w-full bg-gray-700 h-1.5 rounded-full overflow-hidden",children:l.jsx("div",{className:"bg-green-500 w-full h-full rounded-full"})})]})]})]}),l.jsxs("div",{className:"relative group overflow-hidden rounded-3xl bg-gray-900 border border-white/10 hover:border-white/20 transition-all p-8",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-transparent to-black/80 z-10"}),l.jsx("div",{className:"absolute inset-0 opacity-30 grayscale group-hover:grayscale-0 transition-all duration-700",style:{backgroundImage:"radial-gradient(circle at 2px 2px, rgba(255,255,255,0.15) 1px, transparent 0)",backgroundSize:"24px 24px"}}),l.jsxs("div",{className:"relative z-20 h-full flex flex-col justify-end",children:[l.jsx("div",{className:"w-12 h-12 rounded-xl bg-purple-500/20 flex items-center justify-center mb-4 text-purple-400",children:l.jsx(h3,{})}),l.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Live Map"}),l.jsx("p",{className:"text-gray-400",children:"Discover events near your AirBnb."})]})]}),l.jsxs("div",{className:"col-span-1 md:col-span-2 relative group overflow-hidden rounded-3xl bg-gradient-to-br from-teal-900 to-gray-900 border border-white/10 hover:border-teal-500/30 transition-all p-8 flex items-center justify-between",children:[l.jsxs("div",{className:"max-w-xs",children:[l.jsx("div",{className:"w-12 h-12 rounded-xl bg-teal-500/20 flex items-center justify-center mb-4 text-teal-400",children:l.jsx(Y_,{})}),l.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Soca Passport"}),l.jsx("p",{className:"text-gray-400",children:"Your digital carnival identity. Syncs seamlessly with the Soca Passport app."})]}),l.jsxs("div",{className:"hidden sm:block relative w-64 h-40 bg-white/10 backdrop-blur-md rounded-xl border border-white/20 shadow-2xl transform rotate-3 group-hover:rotate-0 transition-transform duration-500",children:[l.jsx("div",{className:"absolute top-4 left-4 w-8 h-8 rounded-full bg-teal-500"}),l.jsx("div",{className:"absolute top-4 right-4 text-[10px] font-mono opacity-50",children:"9438-2910"}),l.jsx("div",{className:"absolute bottom-4 left-4 text-xs font-bold",children:"FEBUARY 2026"})]})]})]})]}),l.jsxs("section",{className:"relative z-10 py-32 text-center px-6",children:[l.jsx("h2",{className:"text-5xl md:text-7xl font-black mb-8",children:"Ready to jump?"}),l.jsx("button",{onClick:t,className:"px-10 py-5 bg-white text-black rounded-full font-bold text-xl hover:scale-105 transition-transform shadow-2xl",children:"Get Started Now"}),l.jsxs("div",{className:"mt-16 text-sm text-gray-500 flex flex-col md:flex-row items-center justify-center gap-8",children:[l.jsxs("span",{className:"flex items-center gap-2",children:[l.jsx(qm,{className:"w-4 h-4"})," Global Support"]}),l.jsxs("span",{className:"flex items-center gap-2",children:[l.jsx($m,{className:"w-4 h-4"})," Secure Data"]}),l.jsxs("span",{className:"flex items-center gap-2",children:[l.jsx(mo,{className:"w-4 h-4"})," Vibes Included"]})]})]}),l.jsx("div",{className:"w-full border-t border-white/10 p-8 text-center text-gray-600 text-sm",children:" 2026 Carnival Planner. Built for the culture."})]})}const $s="Carnival Planner",Wn="support@carnival-planner.com",Wm="December 12, 2025";function q3({onBack:t,logo:e}){return l.jsxs(Gm,{title:"Privacy Policy",icon:$m,onBack:t,logo:e,children:[l.jsxs("p",{className:"text-gray-400 mb-6",children:["Last Updated: ",Wm]}),l.jsx(Ue,{title:"1. Introduction",children:l.jsxs("p",{children:[$s,' ("we," "our," or "us") is committed to protecting your privacy. This Privacy Policy explains how we collect, use, disclose, and safeguard your information when you use our mobile application and website (collectively, the "Service").']})}),l.jsxs(Ue,{title:"2. Information We Collect",children:[l.jsx("h4",{className:"font-semibold text-white mb-2",children:"2.1 Personal Information"}),l.jsx("p",{className:"mb-4",children:"When you sign in with Google, we collect:"}),l.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[l.jsx("li",{children:"Email address"}),l.jsx("li",{children:"Display name"}),l.jsx("li",{children:"Profile picture URL"}),l.jsx("li",{children:"Google account unique identifier"})]}),l.jsx("h4",{className:"font-semibold text-white mb-2",children:"2.2 User-Generated Content"}),l.jsx("p",{className:"mb-4",children:"Information you voluntarily provide includes:"}),l.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[l.jsx("li",{children:"Carnival planning data (budgets, schedules, packing lists)"}),l.jsx("li",{children:"Costume and band information"}),l.jsx("li",{children:"Squad member names and coordination data"}),l.jsx("li",{children:"Uploaded media files (tickets, photos, documents)"}),l.jsx("li",{children:"Map pins and location notes"})]}),l.jsx("h4",{className:"font-semibold text-white mb-2",children:"2.3 Payment Information"}),l.jsx("p",{children:"For premium subscriptions, payment processing is handled securely by Stripe. We do not store your credit card numbers. We receive only transaction confirmation, subscription status, and billing email from Stripe."})]}),l.jsx(Ue,{title:"3. How We Use Your Information",children:l.jsxs("ul",{className:"list-disc list-inside space-y-2",children:[l.jsx("li",{children:"To provide and maintain the Service"}),l.jsx("li",{children:"To authenticate your identity via Google Sign-In"}),l.jsx("li",{children:"To process premium subscription payments via Stripe"}),l.jsx("li",{children:"To sync your carnival planning data across devices"}),l.jsx("li",{children:"To send push notifications for squad alerts (if enabled)"}),l.jsx("li",{children:"To improve and optimize our Service"}),l.jsx("li",{children:"To respond to your inquiries and support requests"})]})}),l.jsxs(Ue,{title:"4. Data Storage and Security",children:[l.jsx("p",{className:"mb-4",children:"Your data is stored using Firebase services provided by Google:"}),l.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Firebase Authentication:"})," Manages secure sign-in"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Cloud Firestore:"})," Stores your planning data"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Firebase Storage:"})," Stores uploaded media files"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Firebase Cloud Messaging:"})," Delivers push notifications"]})]}),l.jsx("p",{children:"We implement industry-standard security measures including encryption in transit (TLS) and at rest. Firebase services are SOC 2 and ISO 27001 certified."})]}),l.jsxs(Ue,{title:"5. Third-Party Services",children:[l.jsx("p",{className:"mb-4",children:"We use the following third-party services:"}),l.jsxs("ul",{className:"list-disc list-inside space-y-2",children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Google (Firebase):"})," Authentication, database, storage, and hosting. ",l.jsx("a",{href:"https://firebase.google.com/support/privacy",className:"text-pink-400 hover:underline",target:"_blank",rel:"noopener noreferrer",children:"Firebase Privacy Policy"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Stripe:"})," Payment processing. ",l.jsx("a",{href:"https://stripe.com/privacy",className:"text-pink-400 hover:underline",target:"_blank",rel:"noopener noreferrer",children:"Stripe Privacy Policy"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"OpenStreetMap:"})," Map tiles for the Fete Map feature. ",l.jsx("a",{href:"https://wiki.osmfoundation.org/wiki/Privacy_Policy",className:"text-pink-400 hover:underline",target:"_blank",rel:"noopener noreferrer",children:"OSM Privacy Policy"})]})]})]}),l.jsxs(Ue,{title:"6. Your Rights (GDPR/CCPA)",children:[l.jsx("p",{className:"mb-4",children:"Depending on your location, you may have the following rights:"}),l.jsxs("ul",{className:"list-disc list-inside space-y-2",children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Access:"})," Request a copy of your personal data"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Rectification:"})," Correct inaccurate personal data"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Erasure:"})," Request deletion of your personal data"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Portability:"})," Receive your data in a portable format"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Opt-out:"})," Opt out of certain data processing"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Non-discrimination:"})," We will not discriminate against you for exercising your rights"]})]}),l.jsxs("p",{className:"mt-4",children:["To exercise these rights, contact us at ",l.jsx("a",{href:`mailto:${Wn}`,className:"text-pink-400 hover:underline",children:Wn}),"."]})]}),l.jsx(Ue,{title:"7. Data Retention",children:l.jsx("p",{children:"We retain your personal data for as long as your account is active. If you delete your account, we will delete your data within 30 days, except where we are legally required to retain it."})}),l.jsx(Ue,{title:"8. Children's Privacy",children:l.jsx("p",{children:"Our Service is not intended for children under 13. We do not knowingly collect personal information from children under 13. If you believe we have collected such information, please contact us immediately."})}),l.jsx(Ue,{title:"9. Changes to This Policy",children:l.jsx("p",{children:'We may update this Privacy Policy from time to time. We will notify you of any changes by posting the new Privacy Policy on this page and updating the "Last Updated" date.'})}),l.jsxs(Ue,{title:"10. Contact Us",children:[l.jsx("p",{children:"If you have questions about this Privacy Policy, please contact us at:"}),l.jsx("p",{className:"mt-2",children:l.jsx("a",{href:`mailto:${Wn}`,className:"text-pink-400 hover:underline",children:Wn})})]})]})}function $3({onBack:t,logo:e}){return l.jsxs(Gm,{title:"Terms of Service",icon:c3,onBack:t,logo:e,children:[l.jsxs("p",{className:"text-gray-400 mb-6",children:["Last Updated: ",Wm]}),l.jsx(Ue,{title:"1. Acceptance of Terms",children:l.jsxs("p",{children:["By accessing or using ",$s,' ("the Service"), you agree to be bound by these Terms of Service. If you do not agree to these terms, please do not use the Service.']})}),l.jsx(Ue,{title:"2. Description of Service",children:l.jsxs("p",{children:[$s," is a Progressive Web App that helps users plan and organize Caribbean carnival events. The Service includes free features (budget planning, scheduling, squad coordination) and premium subscription features (interactive maps, media vault, offline mode)."]})}),l.jsxs(Ue,{title:"3. User Accounts",children:[l.jsx("h4",{className:"font-semibold text-white mb-2",children:"3.1 Registration"}),l.jsx("p",{className:"mb-4",children:"You must sign in with a valid Google account to use the Service. You are responsible for maintaining the security of your account."}),l.jsx("h4",{className:"font-semibold text-white mb-2",children:"3.2 Account Responsibilities"}),l.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[l.jsx("li",{children:"You must provide accurate information"}),l.jsx("li",{children:"You are responsible for all activities under your account"}),l.jsx("li",{children:"You must notify us immediately of any unauthorized use"})]})]}),l.jsxs(Ue,{title:"4. Premium Subscriptions",children:[l.jsx("h4",{className:"font-semibold text-white mb-2",children:"4.1 Subscription Plans"}),l.jsx("p",{className:"mb-4",children:"We offer monthly ($4.99/month) and yearly ($39.99/year) subscription plans. Prices are subject to change with reasonable notice."}),l.jsx("h4",{className:"font-semibold text-white mb-2",children:"4.2 Billing"}),l.jsx("p",{className:"mb-4",children:"Subscriptions are billed in advance on a recurring basis. Payment is processed through Stripe. Your subscription will automatically renew unless you cancel before the renewal date."}),l.jsx("h4",{className:"font-semibold text-white mb-2",children:"4.3 Cancellation"}),l.jsx("p",{children:"You may cancel your subscription at any time. You will continue to have access to premium features until the end of your current billing period. See our Refund Policy for details."})]}),l.jsxs(Ue,{title:"5. User Content",children:[l.jsx("h4",{className:"font-semibold text-white mb-2",children:"5.1 Your Content"}),l.jsx("p",{className:"mb-4",children:"You retain ownership of all content you upload to the Service (schedules, media, notes). By uploading content, you grant us a limited license to store, display, and process it to provide the Service."}),l.jsx("h4",{className:"font-semibold text-white mb-2",children:"5.2 Content Restrictions"}),l.jsx("p",{className:"mb-2",children:"You agree not to upload content that:"}),l.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[l.jsx("li",{children:"Is illegal, harmful, or offensive"}),l.jsx("li",{children:"Infringes on intellectual property rights"}),l.jsx("li",{children:"Contains malware or malicious code"}),l.jsx("li",{children:"Violates others' privacy"})]})]}),l.jsxs(Ue,{title:"6. Acceptable Use",children:[l.jsx("p",{className:"mb-2",children:"You agree not to:"}),l.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[l.jsx("li",{children:"Use the Service for any unlawful purpose"}),l.jsx("li",{children:"Attempt to gain unauthorized access to our systems"}),l.jsx("li",{children:"Interfere with or disrupt the Service"}),l.jsx("li",{children:"Reverse engineer or decompile the Service"}),l.jsx("li",{children:"Use automated systems to access the Service without permission"})]})]}),l.jsx(Ue,{title:"7. Intellectual Property",children:l.jsxs("p",{children:["The Service, including its design, features, and content (excluding user content), is owned by ",$s," and protected by intellectual property laws. You may not copy, modify, or distribute our intellectual property without permission."]})}),l.jsx(Ue,{title:"8. Disclaimer of Warranties",children:l.jsx("p",{children:'THE SERVICE IS PROVIDED "AS IS" WITHOUT WARRANTIES OF ANY KIND, EXPRESS OR IMPLIED. WE DO NOT GUARANTEE THAT THE SERVICE WILL BE UNINTERRUPTED, ERROR-FREE, OR SECURE. YOUR USE OF THE SERVICE IS AT YOUR OWN RISK.'})}),l.jsx(Ue,{title:"9. Limitation of Liability",children:l.jsxs("p",{children:["TO THE MAXIMUM EXTENT PERMITTED BY LAW, ",$s.toUpperCase()," SHALL NOT BE LIABLE FOR ANY INDIRECT, INCIDENTAL, SPECIAL, CONSEQUENTIAL, OR PUNITIVE DAMAGES ARISING FROM YOUR USE OF THE SERVICE, EVEN IF WE HAVE BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES."]})}),l.jsx(Ue,{title:"10. Termination",children:l.jsx("p",{children:"We may terminate or suspend your account at any time for violation of these Terms. You may delete your account at any time. Upon termination, your right to use the Service will immediately cease."})}),l.jsx(Ue,{title:"11. Governing Law",children:l.jsxs("p",{children:["These Terms shall be governed by the laws of the jurisdiction in which ",$s," operates, without regard to conflict of law principles."]})}),l.jsx(Ue,{title:"12. Changes to Terms",children:l.jsx("p",{children:"We may modify these Terms at any time. We will notify you of significant changes via email or in-app notification. Continued use of the Service after changes constitutes acceptance of the new Terms."})}),l.jsx(Ue,{title:"13. Contact",children:l.jsxs("p",{children:["For questions about these Terms, contact us at ",l.jsx("a",{href:`mailto:${Wn}`,className:"text-pink-400 hover:underline",children:Wn}),"."]})})]})}function H3({onBack:t,logo:e}){return l.jsxs(Gm,{title:"Cookie Policy",icon:a3,onBack:t,logo:e,children:[l.jsxs("p",{className:"text-gray-400 mb-6",children:["Last Updated: ",Wm]}),l.jsx(Ue,{title:"1. What Are Cookies",children:l.jsx("p",{children:"Cookies are small text files stored on your device when you visit a website. They help websites remember your preferences and improve your experience."})}),l.jsxs(Ue,{title:"2. How We Use Cookies",children:[l.jsxs("p",{className:"mb-4",children:[$s," uses cookies and similar technologies for the following purposes:"]}),l.jsx("h4",{className:"font-semibold text-white mb-2",children:"2.1 Essential Cookies (Required)"}),l.jsx("p",{className:"mb-4",children:"These cookies are necessary for the Service to function and cannot be disabled:"}),l.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Firebase Authentication:"})," Maintains your signed-in session securely"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Session Management:"})," Remembers your authentication state"]})]}),l.jsx("h4",{className:"font-semibold text-white mb-2",children:"2.2 Functional Cookies"}),l.jsx("p",{className:"mb-4",children:"These cookies enhance your experience:"}),l.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Preferences:"})," Remembers your dark mode setting"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Local Storage:"})," Caches carnival data for offline access (Premium feature)"]})]}),l.jsx("h4",{className:"font-semibold text-white mb-2",children:"2.3 Third-Party Cookies"}),l.jsx("p",{className:"mb-2",children:"Our third-party services may set their own cookies:"}),l.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Firebase/Google:"})," Authentication and analytics"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Stripe:"})," Payment processing security"]})]})]}),l.jsx(Ue,{title:"3. Cookie Details",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-left text-sm mb-4",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"border-b border-gray-700",children:[l.jsx("th",{className:"py-2 pr-4",children:"Cookie Name"}),l.jsx("th",{className:"py-2 pr-4",children:"Purpose"}),l.jsx("th",{className:"py-2 pr-4",children:"Duration"}),l.jsx("th",{className:"py-2",children:"Type"})]})}),l.jsxs("tbody",{className:"text-gray-400",children:[l.jsxs("tr",{className:"border-b border-gray-800",children:[l.jsx("td",{className:"py-2 pr-4",children:"firebase-auth"}),l.jsx("td",{className:"py-2 pr-4",children:"User authentication"}),l.jsx("td",{className:"py-2 pr-4",children:"Session"}),l.jsx("td",{className:"py-2",children:"Essential"})]}),l.jsxs("tr",{className:"border-b border-gray-800",children:[l.jsx("td",{className:"py-2 pr-4",children:"__stripe_mid"}),l.jsx("td",{className:"py-2 pr-4",children:"Fraud prevention"}),l.jsx("td",{className:"py-2 pr-4",children:"1 year"}),l.jsx("td",{className:"py-2",children:"Essential"})]}),l.jsxs("tr",{className:"border-b border-gray-800",children:[l.jsx("td",{className:"py-2 pr-4",children:"darkMode"}),l.jsx("td",{className:"py-2 pr-4",children:"Theme preference"}),l.jsx("td",{className:"py-2 pr-4",children:"Persistent"}),l.jsx("td",{className:"py-2",children:"Functional"})]})]})]})})}),l.jsxs(Ue,{title:"4. Local Storage",children:[l.jsx("p",{className:"mb-4",children:"In addition to cookies, we use browser local storage for:"}),l.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[l.jsx("li",{children:"Caching carnival data for offline access (Premium)"}),l.jsx("li",{children:"Storing FCM tokens for push notifications"}),l.jsx("li",{children:"Temporary UI state"})]})]}),l.jsxs(Ue,{title:"5. Managing Cookies",children:[l.jsx("p",{className:"mb-4",children:"You can manage cookies through your browser settings:"}),l.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Chrome:"})," Settings  Privacy and security  Cookies"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Firefox:"})," Settings  Privacy & Security  Cookies"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Safari:"})," Preferences  Privacy  Cookies"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Edge:"})," Settings  Cookies and site permissions"]})]}),l.jsx("p",{className:"mt-4 text-yellow-400",children:"Note: Disabling essential cookies may prevent you from using the Service."})]}),l.jsx(Ue,{title:"6. Updates to This Policy",children:l.jsx("p",{children:"We may update this Cookie Policy to reflect changes in our practices or for legal reasons. Check this page periodically for updates."})}),l.jsx(Ue,{title:"7. Contact",children:l.jsxs("p",{children:["For questions about our use of cookies, contact us at ",l.jsx("a",{href:`mailto:${Wn}`,className:"text-pink-400 hover:underline",children:Wn}),"."]})})]})}function W3({onBack:t,logo:e}){return l.jsxs(Gm,{title:"Refund Policy",icon:Y_,onBack:t,logo:e,children:[l.jsxs("p",{className:"text-gray-400 mb-6",children:["Last Updated: ",Wm]}),l.jsx(Ue,{title:"1. Premium Subscription",children:l.jsxs("p",{children:[$s," offers premium subscriptions at $4.99/month or $39.99/year. This policy explains our refund terms for these subscriptions."]})}),l.jsxs(Ue,{title:"2. Subscription Cancellation",children:[l.jsx("h4",{className:"font-semibold text-white mb-2",children:"2.1 How to Cancel"}),l.jsx("p",{className:"mb-4",children:"You can cancel your subscription at any time by:"}),l.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[l.jsxs("li",{children:["Contacting us at ",l.jsx("a",{href:`mailto:${Wn}`,className:"text-pink-400 hover:underline",children:Wn})]}),l.jsx("li",{children:"Managing your subscription through Stripe's customer portal (link provided in your confirmation email)"})]}),l.jsx("h4",{className:"font-semibold text-white mb-2",children:"2.2 Effect of Cancellation"}),l.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[l.jsx("li",{children:"Your premium access continues until the end of your current billing period"}),l.jsx("li",{children:"You will not be charged again after cancellation"}),l.jsx("li",{children:"No partial refunds are provided for unused time in the current billing period"})]})]}),l.jsxs(Ue,{title:"3. Refund Eligibility",children:[l.jsx("h4",{className:"font-semibold text-white mb-2",children:"3.1 Eligible for Refund"}),l.jsx("p",{className:"mb-2",children:"We offer refunds in the following situations:"}),l.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Technical Issues:"})," If the Service was unavailable or significantly impaired for an extended period"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Accidental Purchase:"})," If you accidentally subscribed and request a refund within 48 hours, without using premium features"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Duplicate Charges:"})," If you were charged multiple times for the same subscription period"]})]}),l.jsx("h4",{className:"font-semibold text-white mb-2",children:"3.2 Not Eligible for Refund"}),l.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[l.jsx("li",{children:"Change of mind after using premium features"}),l.jsx("li",{children:"Requests made after 30 days from the charge date"}),l.jsx("li",{children:"Failure to cancel before renewal (you must cancel before renewal to avoid charges)"}),l.jsx("li",{children:"Issues caused by your device, browser, or internet connection"})]})]}),l.jsxs(Ue,{title:"4. How to Request a Refund",children:[l.jsx("p",{className:"mb-4",children:"To request a refund:"}),l.jsxs("ol",{className:"list-decimal list-inside space-y-2",children:[l.jsxs("li",{children:["Email us at ",l.jsx("a",{href:`mailto:${Wn}`,className:"text-pink-400 hover:underline",children:Wn})]}),l.jsx("li",{children:"Include your account email and the date of the charge"}),l.jsx("li",{children:"Explain the reason for your refund request"})]}),l.jsx("p",{className:"mt-4",children:"We will review your request and respond within 5 business days."})]}),l.jsxs(Ue,{title:"5. Refund Processing",children:[l.jsx("p",{className:"mb-4",children:"If your refund is approved:"}),l.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[l.jsx("li",{children:"Refunds are processed through Stripe to your original payment method"}),l.jsx("li",{children:"Allow 5-10 business days for the refund to appear on your statement"}),l.jsx("li",{children:"Your premium access will be revoked upon refund"})]})]}),l.jsx(Ue,{title:"6. Free Trial",children:l.jsx("p",{children:"We do not currently offer free trials. All core features are free to use. Premium features require a paid subscription."})}),l.jsx(Ue,{title:"7. Price Changes",children:l.jsx("p",{children:"If we increase subscription prices, existing subscribers will be notified at least 30 days in advance. You may cancel before the new price takes effect to avoid being charged at the higher rate."})}),l.jsx(Ue,{title:"8. Contact",children:l.jsxs("p",{children:["For refund requests or questions about this policy, contact us at ",l.jsx("a",{href:`mailto:${Wn}`,className:"text-pink-400 hover:underline",children:Wn}),"."]})})]})}function Gm({title:t,icon:e,onBack:n,logo:r,children:i}){return l.jsxs("div",{className:"min-h-screen bg-slate-950 text-white",children:[l.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[l.jsx("div",{className:"absolute w-[600px] h-[600px] bg-gradient-to-r from-pink-500/20 to-purple-500/20 rounded-full blur-3xl -top-48 -right-48"}),l.jsx("div",{className:"absolute w-[400px] h-[400px] bg-gradient-to-r from-blue-500/15 to-cyan-500/15 rounded-full blur-3xl bottom-0 left-0"})]}),l.jsxs("div",{className:"relative max-w-4xl mx-auto px-6 py-12",children:[l.jsxs("button",{onClick:n,className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors mb-8",children:[l.jsx(Z_,{className:"w-5 h-5"}),"Back"]}),l.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[r&&l.jsx("img",{src:r,alt:"Logo",className:"w-12 h-12 rounded-xl"}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-pink-500/30 to-purple-500/30 rounded-xl flex items-center justify-center",children:l.jsx(e,{className:"w-6 h-6 text-pink-400"})}),l.jsx("h1",{className:"text-3xl md:text-4xl font-bold",children:t})]})]}),l.jsx("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 rounded-2xl p-6 md:p-8",children:i}),l.jsx("footer",{className:"mt-12 text-center text-gray-500 text-sm",children:l.jsx("p",{children:"Carnival Planner - Plan your Mas. Track your Fetes. Coordinate your Squad."})})]})]})}function Ue({title:t,children:e}){return l.jsxs("div",{className:"mb-8",children:[l.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:t}),l.jsx("div",{className:"text-gray-300 leading-relaxed",children:e})]})}function G3(){const[t,e]=U.useState(null),[n,r]=U.useState(!1),[i,o]=U.useState(!1),[a,u]=U.useState(!1);U.useEffect(()=>{if(window.matchMedia("(display-mode: standalone)").matches){o(!0);return}const g=localStorage.getItem("pwa-install-dismissed");g&&(Date.now()-parseInt(g))/864e5<7&&u(!0);const v=E=>{E.preventDefault(),e(E),a||r(!0)},w=()=>{o(!0),r(!1),e(null)};return window.addEventListener("beforeinstallprompt",v),window.addEventListener("appinstalled",w),()=>{window.removeEventListener("beforeinstallprompt",v),window.removeEventListener("appinstalled",w)}},[a]);const d=async()=>{if(!t)return;t.prompt();const{outcome:g}=await t.userChoice;g==="accepted"&&o(!0),e(null),r(!1)},m=()=>{r(!1),u(!0),localStorage.setItem("pwa-install-dismissed",Date.now().toString())};return!n||i?null:l.jsx("div",{className:"fixed bottom-20 left-4 right-4 z-40 animate-slideUp md:left-auto md:right-4 md:max-w-sm safe-bottom",children:l.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 rounded-2xl shadow-2xl p-4 text-white",children:[l.jsx("button",{onClick:m,className:"absolute top-2 right-2 p-1 hover:bg-white/20 rounded-full transition-colors",children:l.jsx(_i,{className:"w-5 h-5"})}),l.jsxs("div",{className:"flex items-start gap-4",children:[l.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center flex-shrink-0",children:l.jsx(b3,{className:"w-6 h-6"})}),l.jsxs("div",{className:"flex-1 pr-6",children:[l.jsx("h3",{className:"font-bold text-lg mb-1",children:"Add to Home Screen"}),l.jsx("p",{className:"text-white/80 text-sm mb-3",children:"Install Carnival Planner for quick access and offline use!"}),l.jsxs("button",{onClick:d,className:"flex items-center gap-2 px-4 py-2 bg-white text-purple-600 font-bold rounded-lg hover:bg-gray-100 transition-colors",children:[l.jsx(zm,{className:"w-4 h-4"}),"Install App"]})]})]})]})})}function K3({onBack:t,logo:e,user:n}){const[r,i]=U.useState(""),[o,a]=U.useState(""),[u,d]=U.useState((n==null?void 0:n.email)||""),[m,g]=U.useState(!1),[v,w]=U.useState(!1),[E,C]=U.useState(""),P=async F=>{if(F.preventDefault(),!o.trim()||!u.trim()){C("Please fill in all required fields");return}g(!0),C("");try{await Jl(sn(Ne,"support-requests"),{email:u.trim(),subject:r.trim()||"General Inquiry",message:o.trim(),userId:(n==null?void 0:n.uid)||null,userName:(n==null?void 0:n.displayName)||null,status:"new",createdAt:Be.now()}),w(!0),i(""),a("")}catch(N){console.error("Error submitting support request:",N),C("Failed to send message. Please try again.")}finally{g(!1)}};return v?l.jsx("div",{className:"min-h-screen bg-slate-950 text-white flex items-center justify-center p-6",children:l.jsxs("div",{className:"text-center max-w-md",children:[l.jsx("div",{className:"w-20 h-20 bg-green-500/20 rounded-full flex items-center justify-center mx-auto mb-6",children:l.jsx(i3,{className:"w-10 h-10 text-green-400"})}),l.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Message Sent!"}),l.jsx("p",{className:"text-gray-400 mb-8",children:"Thank you for reaching out. We'll get back to you as soon as possible."}),l.jsx("button",{onClick:t,className:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-500 rounded-xl font-bold hover:opacity-90 transition-opacity",children:"Back to App"})]})}):l.jsxs("div",{className:"min-h-screen bg-slate-950 text-white",children:[l.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[l.jsx("div",{className:"absolute w-[600px] h-[600px] bg-gradient-to-r from-pink-500/20 to-purple-500/20 rounded-full blur-3xl -top-48 -right-48"}),l.jsx("div",{className:"absolute w-[400px] h-[400px] bg-gradient-to-r from-blue-500/15 to-cyan-500/15 rounded-full blur-3xl bottom-0 left-0"})]}),l.jsxs("div",{className:"relative max-w-2xl mx-auto px-6 py-12",children:[l.jsxs("button",{onClick:t,className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors mb-8",children:[l.jsx(Z_,{className:"w-5 h-5"}),"Back"]}),l.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e&&l.jsx("img",{src:e,alt:"Logo",className:"w-12 h-12 rounded-xl"}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-pink-500/30 to-purple-500/30 rounded-xl flex items-center justify-center",children:l.jsx(vN,{className:"w-6 h-6 text-pink-400"})}),l.jsx("h1",{className:"text-3xl md:text-4xl font-bold",children:"Contact Support"})]})]}),l.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 rounded-2xl p-6 md:p-8",children:[l.jsx("p",{className:"text-gray-400 mb-6",children:"Have a question, feedback, or need help? Send us a message and we'll get back to you as soon as possible."}),l.jsxs("form",{onSubmit:P,className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email Address *"}),l.jsxs("div",{className:"relative",children:[l.jsx(X_,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),l.jsx("input",{type:"email",value:u,onChange:F=>d(F.target.value),placeholder:"your@email.com",required:!0,className:"w-full pl-10 pr-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:border-pink-500 transition-colors"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Subject"}),l.jsxs("select",{value:r,onChange:F=>i(F.target.value),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white focus:outline-none focus:border-pink-500 transition-colors",children:[l.jsx("option",{value:"",className:"bg-gray-900",children:"Select a topic..."}),l.jsx("option",{value:"General Question",className:"bg-gray-900",children:"General Question"}),l.jsx("option",{value:"Premium Subscription",className:"bg-gray-900",children:"Premium Subscription"}),l.jsx("option",{value:"Technical Issue",className:"bg-gray-900",children:"Technical Issue"}),l.jsx("option",{value:"Feature Request",className:"bg-gray-900",children:"Feature Request"}),l.jsx("option",{value:"Refund Request",className:"bg-gray-900",children:"Refund Request"}),l.jsx("option",{value:"Account Issue",className:"bg-gray-900",children:"Account Issue"}),l.jsx("option",{value:"Other",className:"bg-gray-900",children:"Other"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Message *"}),l.jsx("textarea",{value:o,onChange:F=>a(F.target.value),placeholder:"How can we help you?",required:!0,rows:6,className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:border-pink-500 transition-colors resize-none"})]}),E&&l.jsx("p",{className:"text-red-400 text-sm",children:E}),l.jsx("button",{type:"submit",disabled:m,className:"w-full flex items-center justify-center gap-2 px-6 py-4 bg-gradient-to-r from-pink-500 to-purple-500 rounded-xl font-bold text-lg hover:opacity-90 transition-opacity disabled:opacity-50",children:m?l.jsxs(l.Fragment,{children:[l.jsx(bn,{className:"w-5 h-5 animate-spin"}),"Sending..."]}):l.jsxs(l.Fragment,{children:[l.jsx(TN,{className:"w-5 h-5"}),"Send Message"]})})]})]}),l.jsxs("p",{className:"text-gray-500 text-sm text-center mt-8",children:["You can also email us directly at"," ",l.jsx("a",{href:"mailto:support@carnival-planner.com",className:"text-pink-400 hover:underline",children:"support@carnival-planner.com"})]})]})]})}function Z3(){const[t,e]=U.useState([]),[n,r]=U.useState(!0);U.useEffect(()=>{const o=gd(sn(Ne,"support-requests"),T_("createdAt","desc")),a=qi(o,u=>{const d=u.docs.map(m=>({id:m.id,...m.data()}));e(d),r(!1)});return()=>a()},[]);const i=async o=>{confirm("Delete this support request?")&&await Vm(We(Ne,"support-requests",o))};return n?l.jsx("div",{className:"text-center py-8 text-gray-500",children:l.jsx(bn,{className:"w-6 h-6 animate-spin mx-auto"})}):l.jsxs("div",{className:"mt-6 border-t border-gray-200 dark:border-gray-700 pt-6",children:[l.jsxs("h3",{className:"font-bold text-lg mb-4 text-gray-800 dark:text-white flex items-center gap-2",children:[l.jsx(vN,{className:"w-5 h-5"}),"Support Requests (",t.length,")"]}),t.length===0?l.jsx("p",{className:"text-gray-500 text-center py-4",children:"No support requests yet"}):l.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:t.map(o=>{var a,u;return l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700",children:[l.jsxs("div",{className:"flex justify-between items-start mb-2",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-800 dark:text-white",children:o.email}),l.jsx("span",{className:"mx-2 text-gray-400",children:"|"}),l.jsx("span",{className:"text-sm text-gray-500",children:o.subject||"General"})]}),l.jsx("button",{onClick:()=>i(o.id),className:"p-1 text-gray-400 hover:text-red-500 transition-colors",children:l.jsx(rs,{className:"w-4 h-4"})})]}),l.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm whitespace-pre-wrap",children:o.message}),l.jsx("p",{className:"text-xs text-gray-400 mt-2",children:((u=(a=o.createdAt)==null?void 0:a.toDate)==null?void 0:u.call(a).toLocaleString())||"Unknown date"})]},o.id)})})]})}function Q3({user:t,onClose:e}){const[n,r]=U.useState(!1),[i,o]=U.useState(""),[a,u]=U.useState(!1),[d,m]=U.useState(""),[g,v]=U.useState({displayName:"",bio:"",avatarUrl:""}),[w,E]=U.useState(!1),[C,P]=U.useState(!1),[F,N]=U.useState(!1),[T,A]=U.useState(""),z=U.useRef(null);U.useEffect(()=>{if(!t)return;(async()=>{try{const R=We(Ne,"users",t.uid,"profile","info"),D=await zr(R);if(D.exists()){const O=D.data();v({displayName:O.displayName||t.displayName||"",bio:O.bio||"",avatarUrl:O.avatarUrl||t.photoURL||""})}else v({displayName:t.displayName||"",bio:"",avatarUrl:t.photoURL||""})}catch(R){console.log("Could not load profile:",R)}})()},[t]);const Z=async()=>{if(t){P(!0),m("");try{const b=We(Ne,"users",t.uid,"profile","info");await Rn(b,{displayName:g.displayName,bio:g.bio,avatarUrl:g.avatarUrl,updatedAt:Be.now()},{merge:!0}),E(!1),A("Profile saved!"),setTimeout(()=>A(""),3e3)}catch(b){console.error("Error saving profile:",b),m("Could not save profile. Please try again.")}finally{P(!1)}}},H=async b=>{const R=b.target.files[0];if(!R||!t)return;if(R.size>2*1024*1024){m("Image too large. Max 2MB.");return}if(!["image/jpeg","image/png","image/gif","image/webp"].includes(R.type)){m("Please upload a JPG, PNG, GIF, or WebP image.");return}N(!0),m("");try{const O=Date.now(),B=R.name.split(".").pop(),M=`avatars/${t.uid}/${O}.${B}`,ee=ho(fo,M);await Xl(ee,R);const ce=await ec(ee);v(we=>({...we,avatarUrl:ce}));const me=We(Ne,"users",t.uid,"profile","info");await Rn(me,{avatarUrl:ce,updatedAt:Be.now()},{merge:!0}),A("Avatar updated!"),setTimeout(()=>A(""),3e3)}catch(O){console.error("Avatar upload error:",O),m("Could not upload avatar. Please try again.")}finally{N(!1),z.current&&(z.current.value="")}},I=async()=>{if(i!=="DELETE"){m("Please type DELETE to confirm");return}u(!0),m("");try{const b=Ds(kr);await Ms(b,"deleteUserAccount")(),await YT(Ks),window.location.reload()}catch(b){console.error("Error deleting account:",b),m(b.message||"Failed to delete account. Please try again."),u(!1)}};return l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 border border-gray-200 dark:border-gray-700",children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsx("h3",{className:"text-lg font-bold text-gray-800 dark:text-white",children:"Account Settings"}),e&&l.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:l.jsx(_i,{className:"w-5 h-5"})})]}),T&&l.jsx("div",{className:"mb-4 p-3 bg-green-100 dark:bg-green-900/30 border border-green-200 dark:border-green-800 rounded-lg text-green-700 dark:text-green-400 text-sm",children:T}),d&&l.jsx("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg text-red-700 dark:text-red-400 text-sm",children:d}),l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-xl p-5",children:l.jsxs("div",{className:"flex items-start gap-4",children:[l.jsxs("div",{className:"relative",children:[l.jsx("div",{className:"w-20 h-20 rounded-full overflow-hidden bg-gray-200 dark:bg-gray-600 flex items-center justify-center",children:g.avatarUrl?l.jsx("img",{src:g.avatarUrl,alt:"Avatar",className:"w-full h-full object-cover"}):l.jsx(nc,{className:"w-10 h-10 text-gray-400"})}),l.jsx("input",{ref:z,type:"file",accept:"image/*",onChange:H,className:"hidden",id:"avatar-upload"}),l.jsx("label",{htmlFor:"avatar-upload",className:"absolute -bottom-1 -right-1 p-1.5 bg-blue-600 rounded-full text-white cursor-pointer hover:bg-blue-700 transition",children:F?l.jsx(bn,{className:"w-4 h-4 animate-spin"}):l.jsx(tc,{className:"w-4 h-4"})})]}),l.jsx("div",{className:"flex-1",children:w?l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Display Name"}),l.jsx("input",{type:"text",value:g.displayName,onChange:b=>v(R=>({...R,displayName:b.target.value})),placeholder:"Your name",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",maxLength:50})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Bio"}),l.jsx("textarea",{value:g.bio,onChange:b=>v(R=>({...R,bio:b.target.value})),placeholder:"Tell us about yourself...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm resize-none",rows:3,maxLength:200}),l.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[g.bio.length,"/200"]})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("button",{onClick:Z,disabled:C,className:"flex items-center gap-1.5 px-3 py-1.5 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[C?l.jsx(bn,{className:"w-4 h-4 animate-spin"}):l.jsx(x3,{className:"w-4 h-4"}),"Save"]}),l.jsx("button",{onClick:()=>E(!1),className:"px-3 py-1.5 bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300 text-sm rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500",children:"Cancel"})]})]}):l.jsxs("div",{children:[l.jsx("h4",{className:"font-bold text-gray-800 dark:text-white mb-1",children:g.displayName||"No name set"}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:t==null?void 0:t.email}),g.bio&&l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-3",children:g.bio}),l.jsxs("button",{onClick:()=>E(!0),className:"flex items-center gap-1.5 px-3 py-1.5 bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 text-sm rounded-lg hover:bg-blue-200 dark:hover:bg-blue-900/50 transition",children:[l.jsx(bN,{className:"w-4 h-4"}),"Edit Profile"]})]})})]})}),l.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-6",children:[l.jsxs("h4",{className:"text-red-600 dark:text-red-400 font-bold mb-2 flex items-center gap-2",children:[l.jsx(gN,{className:"w-5 h-5"}),"Danger Zone"]}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:"Permanently delete your account and all associated data. This action cannot be undone."}),n?l.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-4",children:[l.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mb-3",children:"This will permanently delete:"}),l.jsxs("ul",{className:"text-sm text-red-500 dark:text-red-400 list-disc list-inside mb-4 space-y-1",children:[l.jsx("li",{children:"All your carnival plans and data"}),l.jsx("li",{children:"Uploaded photos and documents"}),l.jsx("li",{children:"Squad memberships"}),l.jsx("li",{children:"Your account and login"})]}),l.jsxs("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Type ",l.jsx("span",{className:"font-mono bg-gray-200 dark:bg-gray-700 px-1 rounded",children:"DELETE"})," to confirm:"]}),l.jsx("input",{type:"text",value:i,onChange:b=>o(b.target.value),placeholder:"Type DELETE",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white mb-3"}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx("button",{onClick:()=>{r(!1),o(""),m("")},disabled:a,className:"flex-1 px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors disabled:opacity-50",children:"Cancel"}),l.jsx("button",{onClick:I,disabled:a||i!=="DELETE",className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50",children:a?l.jsxs(l.Fragment,{children:[l.jsx(bn,{className:"w-4 h-4 animate-spin"}),"Deleting..."]}):l.jsxs(l.Fragment,{children:[l.jsx(rs,{className:"w-4 h-4"}),"Delete Forever"]})})]})]}):l.jsxs("button",{onClick:()=>r(!0),className:"flex items-center gap-2 px-4 py-2 bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 rounded-lg hover:bg-red-200 dark:hover:bg-red-900/50 transition-colors",children:[l.jsx(rs,{className:"w-4 h-4"}),"Delete My Account"]})]})]})]})}function Y3({user:t,activeCarnivalId:e}){const n=`http://localhost:5001/socapassport?uid=${(t==null?void 0:t.uid)||""}&carnival=${e||""}`;return l.jsxs("div",{className:"flex flex-col min-h-[500px] bg-white dark:bg-gray-800 rounded-2xl overflow-hidden border border-gray-100 dark:border-gray-700 shadow-xl transition-all duration-300",children:[l.jsxs("div",{className:"p-8 bg-gradient-to-br from-teal-600 via-teal-500 to-emerald-500 text-white relative overflow-hidden",children:[l.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full -mr-20 -mt-20 blur-3xl"}),l.jsx("div",{className:"absolute bottom-0 left-0 w-32 h-32 bg-emerald-400/20 rounded-full -ml-10 -mb-10 blur-2xl"}),l.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row md:items-center justify-between gap-6",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:"p-3 bg-white/20 backdrop-blur-md rounded-2xl shadow-inner group transition-transform hover:scale-105",children:l.jsx(Y_,{className:"w-8 h-8"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-2xl font-black tracking-tight",children:"SOCA PASSPORT"}),l.jsx("p",{className:"text-teal-50 font-medium opacity-90",children:"Your Digital Carnival Identity"})]})]}),l.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-white/20 backdrop-blur-sm rounded-full text-[10px] font-bold uppercase tracking-widest border border-white/30",children:[l.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-300 animate-pulse"}),"Bridge Active"]})]})]}),l.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-8 text-center space-y-8",children:[l.jsxs("div",{className:"relative group cursor-pointer",onClick:()=>window.open(n,"_blank"),children:[l.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-teal-500 to-emerald-500 rounded-3xl blur opacity-25 group-hover:opacity-100 transition duration-1000 group-hover:duration-200"}),l.jsxs("div",{className:"relative p-10 bg-white dark:bg-gray-900 rounded-3xl border border-gray-100 dark:border-gray-800 shadow-sm flex flex-col items-center gap-4 transition-transform hover:scale-[1.02]",children:[l.jsx("div",{className:"w-20 h-20 bg-teal-50 dark:bg-teal-900/30 rounded-full flex items-center justify-center mb-2",children:l.jsx(tv,{className:"w-10 h-10 text-teal-500"})}),l.jsx("h4",{className:"text-xl font-bold text-gray-800 dark:text-white",children:"Ready to Sync?"}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 max-w-xs leading-relaxed",children:"Open your Soca Passport to view your digital credentials, collection, and vibes."}),l.jsxs("button",{onClick:r=>{r.stopPropagation(),window.open(n,"_blank")},className:"mt-4 group flex items-center gap-3 px-8 py-4 bg-teal-600 hover:bg-teal-700 text-white rounded-2xl font-bold shadow-lg shadow-teal-600/20 transition-all hover:-translate-y-1 active:scale-95",children:["LAUNCH PASSPORT",l.jsx(xd,{className:"w-5 h-5 group-hover:translate-x-1 group-hover:-translate-y-1 transition-transform"})]})]})]}),l.jsxs("div",{className:"max-w-md p-4 bg-gray-50 dark:bg-gray-700/50 rounded-2xl border border-gray-200 dark:border-gray-600 flex gap-4 text-left",children:[l.jsx("div",{className:"flex-shrink-0 mt-0.5",children:l.jsx(d3,{className:"w-5 h-5 text-gray-400"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs font-bold text-gray-700 dark:text-gray-300 mb-1",children:"Secure Bridge "}),l.jsx("p",{className:"text-[11px] leading-relaxed text-gray-500 dark:text-gray-400",children:`For your security, Soca Passport opens in a protected environment. We've automatically passed your credentials to ensure a seamless "hand-in-hand" experience.`})]})]})]}),l.jsxs("div",{className:"px-8 py-6 bg-gray-50 dark:bg-gray-900/80 border-t border-gray-100 dark:border-gray-800 flex flex-col sm:flex-row items-center justify-between gap-4 grayscale opacity-70 hover:grayscale-0 hover:opacity-100 transition-all",children:[l.jsxs("div",{className:"flex items-center gap-6",children:[l.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-black tracking-widest uppercase text-gray-400",children:[l.jsx(SN,{className:"w-3.5 h-3.5"}),"Encryption Active"]}),l.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-black tracking-widest uppercase text-gray-400",children:[l.jsx(mo,{className:"w-3.5 h-3.5 text-teal-500"}),"Sound Sync: ON"]})]}),l.jsx("p",{className:"text-[10px] font-bold text-gray-300 dark:text-gray-600 italic",children:"SOCA AUTHENTICATION SERVICE v2.4"})]})]})}function Qb({user:t,activeCarnivalId:e,carnivalData:n,scrapedEvents:r=[],squadMembers:i=[],budgetTotal:o=0,budgetSpent:a=0,isPremium:u,onAction:d}){var E;const m=U.useMemo(()=>{if(e){const N={"stkitts-sugar-mas":"Sugar Mas",stcroix:"St. Croix Carnival",trinidad:"Trinidad Carnival",dominica:"Mas Domnik",jamaica:"Jamaica Carnival",tampa:"Tampa Bay Carnival",stmaarten:"St. Maarten Carnival","cayman-batabano":"Cayman Carnival Batabano",stthomas:"St. Thomas Carnival",atlanta:"Atlanta Caribbean Carnival",guyana:"Guyana Independence",bahamas:"Bahamas Carnival",bermuda:"Bermuda Carnival",hollywood:"Hollywood Carnival",caymas:"Caymas Carnival",vincymas:"Vincy Mas",stlucia:"Saint Lucia Carnival",toronto:"Toronto Caribbean Carnival",barbados:"Crop Over",nevis:"Nevis Culturama",antigua:"Antigua Carnival",grenada:"Spice Mas","ny-labor-day":"New York Carnival",japan:"Japan Caribbean Carnival",miami:"Miami Carnival",tobago:"Tobago Carnival"}[e]||e.replace(/-/g," ");return n.find(A=>A.name.toLowerCase().includes(N.toLowerCase())||N.toLowerCase().includes(A.name.split("(")[0].trim().toLowerCase()))||n[0]}const C=new Date,P=[...n].sort((F,N)=>new Date(F.date)-new Date(N.date));return P.find(F=>new Date(F.date)>=C)||P[0]},[e,n]),[g,v]=U.useState({days:0,hours:0});U.useEffect(()=>{if(!m)return;const C=()=>{const T=new Date(m.date+"T00:00:00")-new Date;if(T>0){const A=Math.ceil(T/864e5),z=Math.floor(T/(1e3*60*60)%24);v({days:A,hours:z})}else v({days:0,hours:0})};C();const P=setInterval(C,6e4);return()=>clearInterval(P)},[m]);const w=U.useMemo(()=>r.length>0?r.slice(0,5):null,[r]);return l.jsxs("div",{className:"space-y-6 mb-8 animate-fadeIn",children:[l.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 shadow-2xl text-white",children:[l.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full blur-3xl -mr-16 -mt-16"}),l.jsx("div",{className:"absolute bottom-0 left-0 w-48 h-48 bg-pink-500/20 rounded-full blur-3xl -ml-10 -mb-10 animate-pulse"}),l.jsxs("div",{className:"relative z-10 p-6 sm:p-8",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx("span",{className:"px-2 py-1 rounded-full bg-white/20 backdrop-blur-sm text-[10px] font-bold uppercase tracking-widest border border-white/10",children:e?"CURRENT MISSION":"UP NEXT"}),u&&l.jsxs("span",{className:"flex items-center px-2 py-1 rounded-full bg-yellow-400/20 text-yellow-300 text-[10px] font-bold uppercase tracking-widest",children:[l.jsx(tv,{className:"w-3 h-3 mr-1"})," Premium"]})]}),l.jsx("h2",{className:"text-3xl sm:text-4xl font-black tracking-tight leading-none mb-1",children:((E=m==null?void 0:m.name)==null?void 0:E.split("(")[0].trim())||"Carnival"}),l.jsx("p",{className:"text-white/80 text-sm font-medium",children:"Get ready for the road."})]}),l.jsxs("div",{className:"flex items-center gap-3 bg-white/10 backdrop-blur-md rounded-2xl p-4 border border-white/10",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("span",{className:"block text-2xl sm:text-3xl font-black",children:g.days}),l.jsx("span",{className:"text-[10px] uppercase opacity-70",children:"Days"})]}),l.jsx("div",{className:"h-8 w-px bg-white/20"}),l.jsxs("div",{className:"text-center",children:[l.jsx("span",{className:"block text-2xl sm:text-3xl font-black",children:g.hours}),l.jsx("span",{className:"text-[10px] uppercase opacity-70",children:"Hrs"})]})]})]}),w&&l.jsxs("div",{className:"mt-8 flex items-center gap-3 bg-black/20 rounded-xl p-2.5 backdrop-blur-sm overflow-hidden",children:[l.jsxs("div",{className:"flex-shrink-0 flex items-center gap-1.5 px-2 py-0.5 bg-red-500 rounded text-[10px] font-bold uppercase animate-pulse",children:[l.jsx("div",{className:"w-1.5 h-1.5 bg-white rounded-full"}),"Live"]}),l.jsx("div",{className:"flex-1 overflow-hidden whitespace-nowrap",children:l.jsx("div",{className:"inline-block animate-marquee text-xs font-medium",children:w.map((C,P)=>l.jsxs("span",{className:"mr-8",children:[" ",l.jsx("span",{className:"font-bold text-pink-200",children:C.title}),C.venue&&l.jsxs("span",{className:"opacity-75",children:[" @ ",C.venue]}),C.price&&l.jsxs("span",{className:"text-green-300 ml-1",children:["($",C.price,")"]})]},C.id||P))})})]})]})]}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[l.jsxs("div",{onClick:()=>d("Budget"),className:"bg-white dark:bg-gray-800 p-4 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 cursor-pointer hover:shadow-md transition-all group",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/30 rounded-lg text-blue-600 dark:text-blue-400",children:l.jsx(Hm,{className:"w-5 h-5"})}),l.jsx(zh,{className:"w-4 h-4 text-gray-300 group-hover:text-blue-500 transition-colors"})]}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium",children:"Budget Spent"}),l.jsxs("p",{className:"text-lg font-bold text-gray-800 dark:text-white mt-0.5",children:["$",a.toLocaleString(),l.jsxs("span",{className:"text-xs text-gray-400 font-normal ml-1",children:["/ $",o.toLocaleString()]})]}),o>0&&l.jsx("div",{className:"w-full h-1.5 bg-gray-100 dark:bg-gray-700 rounded-full mt-2",children:l.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:`${Math.min(a/o*100,100)}%`}})})]}),l.jsxs("div",{onClick:()=>d("Squad"),className:"bg-white dark:bg-gray-800 p-4 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 cursor-pointer hover:shadow-md transition-all group",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/30 rounded-lg text-green-600 dark:text-green-400",children:l.jsx(Gn,{className:"w-5 h-5"})}),l.jsx(zh,{className:"w-4 h-4 text-gray-300 group-hover:text-green-500 transition-colors"})]}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium",children:"Squad Online"}),l.jsxs("p",{className:"text-lg font-bold text-gray-800 dark:text-white mt-0.5",children:[i.length+1,l.jsx("span",{className:"text-xs text-gray-400 font-normal ml-1",children:"members"})]}),l.jsx("div",{className:"flex -space-x-2 mt-2",children:[...Array(Math.min(i.length+1,4))].map((C,P)=>l.jsx("div",{className:"w-6 h-6 rounded-full bg-gray-200 dark:bg-gray-600 border-2 border-white dark:border-gray-800"},P))})]}),l.jsxs("div",{onClick:()=>d("Map"),className:"bg-white dark:bg-gray-800 p-4 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 cursor-pointer hover:shadow-md transition-all group",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-900/30 rounded-lg text-purple-600 dark:text-purple-400",children:l.jsx(ns,{className:"w-5 h-5"})}),l.jsx(zh,{className:"w-4 h-4 text-gray-300 group-hover:text-purple-500 transition-colors"})]}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium",children:"Live Events"}),l.jsx("p",{className:"text-lg font-bold text-gray-800 dark:text-white mt-0.5",children:r.length||"30+"}),l.jsx("p",{className:"text-[10px] text-purple-500 font-bold mt-1",children:" View Map"})]}),l.jsxs("div",{onClick:()=>d("Passport"),className:"bg-gradient-to-br from-teal-500 to-emerald-600 p-4 rounded-2xl shadow-sm shadow-teal-500/20 cursor-pointer hover:shadow-md hover:scale-[1.02] transition-all group",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("div",{className:"p-2 bg-white/20 rounded-lg text-white",children:l.jsx(ev,{className:"w-5 h-5"})}),l.jsx(xd,{className:"w-4 h-4 text-white/70 group-hover:text-white transition-colors"})]}),l.jsx("p",{className:"text-xs text-teal-100 font-medium",children:"Identity"}),l.jsx("p",{className:"text-lg font-bold text-white mt-0.5",children:"Passport"}),l.jsx("p",{className:"text-[10px] text-white/80 font-bold mt-1",children:"Launch App"})]})]})]})}function J3({onClose:t}){const e=[{icon:Q_,title:"Plan Your Schedule",desc:"Add fetes, mas, and events to your itinerary"},{icon:Hm,title:"Track Your Budget",desc:"Keep tabs on costume costs, accommodations, and more"},{icon:Gn,title:"Squad Up",desc:"Create or join a squad to share plans with friends"},{icon:ns,title:"Map Your Adventure",desc:"Pin venues and see event locations (Premium)"},{icon:tc,title:"Share Memories",desc:"Upload photos to your private media vault (Premium)"},{icon:mo,title:"Vibes Player",desc:"Stream soca playlists while you plan"}];return l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm",children:l.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl shadow-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[l.jsxs("div",{className:"relative bg-gradient-to-r from-purple-600 via-pink-500 to-orange-400 p-6 rounded-t-2xl text-white text-center",children:[l.jsx("button",{onClick:t,className:"absolute top-4 right-4 text-white/80 hover:text-white transition-colors",children:l.jsx(_i,{className:"w-6 h-6"})}),l.jsx("h2",{className:"text-2xl font-black mb-1",children:"Welcome to Carnival Planner! "}),l.jsx("p",{className:"text-white/90 text-sm",children:"Your all-in-one Caribbean carnival companion"})]}),l.jsxs("div",{className:"p-6 space-y-4",children:[l.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm text-center mb-4",children:"Here's what you can do:"}),l.jsx("div",{className:"grid gap-3",children:e.map((n,r)=>l.jsxs("div",{className:"flex items-start gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-xl",children:[l.jsx("div",{className:"p-2 bg-gradient-to-br from-purple-500 to-pink-500 rounded-lg text-white flex-shrink-0",children:l.jsx(n.icon,{className:"w-5 h-5"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold text-gray-800 dark:text-white text-sm",children:n.title}),l.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-xs",children:n.desc})]})]},r))})]}),l.jsxs("div",{className:"p-6 pt-0",children:[l.jsx("button",{onClick:t,className:"w-full py-3 bg-gradient-to-r from-purple-600 to-pink-500 text-white font-bold rounded-xl hover:opacity-90 transition-opacity shadow-lg shadow-purple-500/30",children:"Let's Go! "}),l.jsx("p",{className:"text-center text-xs text-gray-400 mt-3",children:'Tap "Help" in the footer anytime for guidance'})]})]})})}function X3({onClose:t}){const e=[{title:"Getting Started",items:[{icon:"",text:"Select your carnival from the dropdown at the top"},{icon:"",text:"Use the tabs to add budget items, schedule events, and more"},{icon:"",text:"Everything saves automatically to your account"}]},{title:"Free Features",items:[{icon:Q_,text:"Schedule  Add fetes, mas bands, and events"},{icon:Hm,text:"Budget  Track all your carnival expenses"},{icon:Gn,text:"Squad  Create/join a group and chat with friends"},{icon:xN,text:'Voice Add  Say "Add Tribe Friday 3pm" to quick-add events'},{icon:mo,text:"Vibes Player  Stream soca playlists while planning"}]},{title:"Premium Features",items:[{icon:ns,text:"Map  Pin venues and view event locations"},{icon:tc,text:"Media Vault  Store and share carnival photos"},{icon:"",text:"Live Events  Daily-updated fete listings from ticket sites"},{icon:"",text:"Road Mode  Offline mesh chat via Bitchat"}]},{title:"Squad Mode",items:[{icon:"",text:"Create a squad to get a 6-digit share code"},{icon:"",text:"Friends join with your code to sync plans"},{icon:"",text:"Chat with your squad and the AI Carnival Concierge"},{icon:"",text:"Leaders can remove members if needed"}]}];return l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm",children:l.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[l.jsxs("div",{className:"sticky top-0 bg-white dark:bg-gray-900 border-b border-gray-100 dark:border-gray-800 p-4 flex items-center justify-between rounded-t-2xl",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(u3,{className:"w-6 h-6 text-purple-500"}),l.jsx("h2",{className:"text-xl font-bold text-gray-800 dark:text-white",children:"How to Use Carnival Planner"})]}),l.jsx("button",{onClick:t,className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-white transition-colors rounded-full hover:bg-gray-100 dark:hover:bg-gray-800",children:l.jsx(_i,{className:"w-5 h-5"})})]}),l.jsxs("div",{className:"p-6 space-y-6",children:[e.map((n,r)=>l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold text-purple-600 dark:text-purple-400 text-sm uppercase tracking-wider mb-3",children:n.title}),l.jsx("div",{className:"space-y-2",children:n.items.map((i,o)=>l.jsxs("div",{className:"flex items-start gap-3 p-2",children:[l.jsx("span",{className:"text-lg flex-shrink-0",children:typeof i.icon=="string"?i.icon:l.jsx(i.icon,{className:"w-5 h-5 text-gray-500"})}),l.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-sm",children:i.text})]},o))})]},r)),l.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 border border-purple-200 dark:border-purple-800 rounded-xl p-4",children:[l.jsx("h3",{className:"font-bold text-purple-800 dark:text-purple-300 mb-2",children:" Pro Tips"}),l.jsxs("ul",{className:"text-sm text-purple-700 dark:text-purple-400 space-y-1",children:[l.jsx("li",{children:" Use Demo Mode to try all features without signing up"}),l.jsx("li",{children:" Export your itinerary from the Info tab as a backup"}),l.jsx("li",{children:" The AI Concierge in Squad Chat can answer carnival questions"})]})]})]}),l.jsx("div",{className:"sticky bottom-0 bg-white dark:bg-gray-900 border-t border-gray-100 dark:border-gray-800 p-4 rounded-b-2xl",children:l.jsx("button",{onClick:t,className:"w-full py-3 bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 font-medium rounded-xl hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",children:"Got it!"})})]})})}const Yb={trinidad:"",jamaica:"",barbados:"",grenada:"",stlucia:"",antigua:"",bahamas:"",bermuda:"",stmaarten:"","stkitts-sugar-mas":"",nevis:"",dominica:"",vincymas:"",stthomas:"",stcroix:"",guyana:"",miami:"",atlanta:"","ny-labor-day":"",hollywood:"",tampa:"",toronto:"",nottinghill:"",japan:"","cayman-batabano":"",tobago:"",caymas:""},eF={trinidad:"Trinidad",jamaica:"Jamaica",barbados:"Crop Over",grenada:"Spicemas",stlucia:"St. Lucia",antigua:"Antigua",miami:"Miami",toronto:"Caribana",nottinghill:"Notting Hill",vincymas:"Vincy Mas",stmaarten:"St. Maarten",atlanta:"Atlanta","ny-labor-day":"NY Labor Day",bahamas:"Bahamas",bermuda:"Bermuda"};function tF({profileData:t,isOwnProfile:e,onEdit:n,currentUser:r}){const[i,o]=U.useState(!1);if(!t)return l.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] text-gray-500 dark:text-gray-400",children:[l.jsx(nc,{className:"w-16 h-16 mb-4 opacity-50"}),l.jsx("p",{className:"text-lg font-medium",children:"Profile not found"}),l.jsx("p",{className:"text-sm",children:"This masquerader hasn't created a public profile yet."})]});const{displayName:a="Carnival Lover",username:u,bio:d="",profilePhoto:m,coverPhoto:g,isPublic:v,carnivalHistory:w=[],stats:E={},socialLinks:C={},isCreator:P}=t,F=[...new Set(w.map(N=>N.carnivalId))];return l.jsxs("div",{className:"max-w-4xl mx-auto animate-fadeIn",children:[l.jsxs("div",{className:"relative h-48 md:h-64 rounded-t-3xl overflow-hidden bg-gradient-to-br from-purple-600 via-pink-500 to-orange-400",children:[g&&l.jsx("img",{src:g,alt:"Cover",className:"w-full h-full object-cover"}),l.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"}),e&&l.jsx("button",{onClick:n,className:"absolute top-4 right-4 p-2 bg-white/20 backdrop-blur-md rounded-full hover:bg-white/30 transition-colors",children:l.jsx(bN,{className:"w-5 h-5 text-white"})}),l.jsxs("div",{className:"absolute top-4 left-4 flex items-center gap-2",children:[v?l.jsxs("span",{className:"flex items-center gap-1.5 px-3 py-1 bg-green-500/20 backdrop-blur-md rounded-full text-green-200 text-xs font-medium",children:[l.jsx(qm,{className:"w-3.5 h-3.5"})," Public"]}):l.jsxs("span",{className:"flex items-center gap-1.5 px-3 py-1 bg-gray-500/20 backdrop-blur-md rounded-full text-gray-200 text-xs font-medium",children:[l.jsx($m,{className:"w-3.5 h-3.5"})," Private"]}),P&&l.jsxs("span",{className:"flex items-center gap-1.5 px-3 py-1 bg-yellow-500/20 backdrop-blur-md rounded-full text-yellow-200 text-xs font-medium",children:[l.jsx(eu,{className:"w-3.5 h-3.5"})," Creator"]})]})]}),l.jsxs("div",{className:"relative px-6 pb-6 bg-white dark:bg-gray-800 rounded-b-3xl shadow-lg",children:[l.jsx("div",{className:"absolute -top-16 left-6",children:l.jsx("div",{className:"w-32 h-32 rounded-full border-4 border-white dark:border-gray-800 shadow-xl overflow-hidden bg-gradient-to-br from-purple-500 to-pink-500",children:m?l.jsx("img",{src:m,alt:a,className:"w-full h-full object-cover"}):l.jsx("div",{className:"w-full h-full flex items-center justify-center",children:l.jsx(nc,{className:"w-12 h-12 text-white"})})})}),l.jsxs("div",{className:"pt-20 md:pt-6 md:ml-40",children:[l.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[l.jsxs("div",{children:[l.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[a,P&&l.jsx(SN,{className:"w-5 h-5 text-yellow-500"})]}),u&&l.jsxs("p",{className:"text-gray-500 dark:text-gray-400",children:["@",u]})]}),l.jsxs("div",{className:"flex gap-3",children:[C.instagram&&l.jsx("a",{href:`https://instagram.com/${C.instagram}`,target:"_blank",rel:"noopener noreferrer",className:"p-2 bg-pink-100 dark:bg-pink-900/30 rounded-full text-pink-600 dark:text-pink-400 hover:scale-110 transition-transform",children:l.jsx(_N,{className:"w-5 h-5"})}),C.twitter&&l.jsx("a",{href:`https://twitter.com/${C.twitter}`,target:"_blank",rel:"noopener noreferrer",className:"p-2 bg-blue-100 dark:bg-blue-900/30 rounded-full text-blue-500 dark:text-blue-400 hover:scale-110 transition-transform",children:l.jsx(CN,{className:"w-5 h-5"})}),C.tiktok&&l.jsx("a",{href:`https://tiktok.com/@${C.tiktok}`,target:"_blank",rel:"noopener noreferrer",className:"p-2 bg-gray-100 dark:bg-gray-700 rounded-full text-gray-700 dark:text-gray-300 hover:scale-110 transition-transform",children:l.jsx(mo,{className:"w-5 h-5"})})]})]}),d&&l.jsx("p",{className:"mt-4 text-gray-600 dark:text-gray-300 max-w-2xl",children:d})]}),l.jsxs("div",{className:"mt-6 grid grid-cols-3 gap-4",children:[l.jsxs("div",{className:"text-center p-4 bg-gradient-to-br from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 rounded-2xl",children:[l.jsx(wN,{className:"w-6 h-6 mx-auto mb-2 text-purple-500"}),l.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:w.length}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Carnivals"})]}),l.jsxs("div",{className:"text-center p-4 bg-gradient-to-br from-blue-50 to-cyan-50 dark:from-blue-900/20 dark:to-cyan-900/20 rounded-2xl",children:[l.jsx(_3,{className:"w-6 h-6 mx-auto mb-2 text-blue-500"}),l.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:F.length}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Countries"})]}),l.jsxs("div",{className:"text-center p-4 bg-gradient-to-br from-orange-50 to-yellow-50 dark:from-orange-900/20 dark:to-yellow-900/20 rounded-2xl",children:[l.jsx(Gn,{className:"w-6 h-6 mx-auto mb-2 text-orange-500"}),l.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[...new Set(w.map(N=>N.band).filter(Boolean))].length}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Bands"})]})]})]}),w.length>0&&l.jsxs("div",{className:"mt-6",children:[l.jsxs("h2",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[l.jsx(Q_,{className:"w-5 h-5 text-purple-500"}),"Carnival History"]}),l.jsx("div",{className:"grid gap-3",children:w.sort((N,T)=>(T.year||0)-(N.year||0)).map((N,T)=>l.jsxs("div",{className:"flex items-center gap-4 p-4 bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 hover:shadow-md transition-shadow",children:[l.jsx("div",{className:"text-3xl",children:Yb[N.carnivalId]||""}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("p",{className:"font-semibold text-gray-900 dark:text-white",children:[eF[N.carnivalId]||N.carnivalId,N.year&&l.jsx("span",{className:"text-gray-400 font-normal ml-2",children:N.year})]}),N.band&&l.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[N.band,N.section&&l.jsxs("span",{className:"ml-1",children:[" ",N.section]})]})]})]},T))})]}),F.length>0&&l.jsxs("div",{className:"mt-6",children:[l.jsxs("h2",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[l.jsx(ns,{className:"w-5 h-5 text-pink-500"}),"Countries Visited"]}),l.jsx("div",{className:"flex flex-wrap gap-3",children:[...new Set(F.map(N=>Yb[N]||""))].map((N,T)=>l.jsx("span",{className:"text-4xl hover:scale-125 transition-transform cursor-default",children:N},T))})]})]})}function nF({user:t,currentProfile:e,onSave:n,onClose:r,carnivals:i}){const[o,a]=U.useState(!1),[u,d]=U.useState(!1),[m,g]=U.useState(""),[v,w]=U.useState(""),[E,C]=U.useState(!1),[P,F]=U.useState({displayName:"",username:"",bio:"",isPublic:!1,socialLinks:{instagram:"",twitter:"",tiktok:""}}),[N,T]=U.useState(null),[A,z]=U.useState(null),[Z,H]=U.useState(""),[I,b]=U.useState("");U.useEffect(()=>{var ee,ce,me;e?(F({displayName:e.displayName||(t==null?void 0:t.displayName)||"",username:e.username||"",bio:e.bio||"",isPublic:e.isPublic||!1,socialLinks:{instagram:((ee=e.socialLinks)==null?void 0:ee.instagram)||"",twitter:((ce=e.socialLinks)==null?void 0:ce.twitter)||"",tiktok:((me=e.socialLinks)==null?void 0:me.tiktok)||""}}),H(e.profilePhoto||""),b(e.coverPhoto||"")):F(we=>({...we,displayName:(t==null?void 0:t.displayName)||""}))},[e,t]);const R=async ee=>{if(!ee)return w(""),!0;if(!/^[a-z0-9_]{3,20}$/.test(ee))return w("3-20 chars, lowercase letters, numbers, underscores only"),!1;if((e==null?void 0:e.username)===ee)return w(""),!0;C(!0);try{return(await zr(We(Ne,"usernames",ee))).exists()?(w("This username is taken"),C(!1),!1):(w(""),C(!1),!0)}catch(me){return console.error("Error checking username:",me),C(!1),!0}},D=ee=>{const ce=ee.target.value.toLowerCase().replace(/[^a-z0-9_]/g,"");F(we=>({...we,username:ce}));const me=setTimeout(()=>R(ce),500);return()=>clearTimeout(me)},O=(ee,ce)=>{var G;const me=(G=ee.target.files)==null?void 0:G[0];if(!me)return;if(me.size>5*1024*1024){g("Image must be under 5MB");return}const we=new FileReader;we.onload=()=>{ce==="profile"?(T(me),H(we.result)):(z(me),b(we.result))},we.readAsDataURL(me)},B=()=>{if(!i)return[];const ee=[];return Object.entries(i).forEach(([ce,me])=>{var we;(we=me.costume)!=null&&we.band&&ee.push({carnivalId:ce,year:new Date().getFullYear(),band:me.costume.band,section:me.costume.section||null})}),ee},M=async()=>{if(t&&!(P.username&&!await R(P.username))){d(!0),g("");try{let ee=(e==null?void 0:e.profilePhoto)||"",ce=(e==null?void 0:e.coverPhoto)||"";if(N){const te=ho(fo,`profiles/${t.uid}/avatar_${Date.now()}`);await Xl(te,N),ee=await ec(te)}if(A){const te=ho(fo,`profiles/${t.uid}/cover_${Date.now()}`);await Xl(te,A),ce=await ec(te)}const me=e==null?void 0:e.username,we=P.username;me&&me!==we&&await Vm(We(Ne,"usernames",me)),we&&we!==me&&await Rn(We(Ne,"usernames",we),{userId:t.uid,claimedAt:Be.now()});const G=B(),le={userId:t.uid,displayName:P.displayName||t.displayName||"Carnival Lover",username:P.username||null,bio:P.bio||"",profilePhoto:ee,coverPhoto:ce,isPublic:P.isPublic,socialLinks:P.socialLinks,carnivalHistory:G,stats:{carnivalsAttended:G.length,countriesVisited:[...new Set(G.map(te=>te.carnivalId))].length,bandsPlayedWith:[...new Set(G.map(te=>te.band).filter(Boolean))]},updatedAt:Be.now(),...e?{}:{createdAt:Be.now()}};await Rn(We(Ne,"userProfiles",t.uid),le,{merge:!0}),n==null||n(le),r==null||r()}catch(ee){console.error("Error saving profile:",ee),g(ee.message||"Failed to save profile")}finally{d(!1)}}};return l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-fadeIn",children:l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-3xl shadow-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[l.jsxs("div",{className:"sticky top-0 z-10 flex items-center justify-between p-4 bg-white dark:bg-gray-800 border-b border-gray-100 dark:border-gray-700",children:[l.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Edit Profile"}),l.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors",children:l.jsx(_i,{className:"w-5 h-5 text-gray-500"})})]}),l.jsxs("div",{className:"p-6 space-y-6",children:[l.jsxs("div",{className:"relative",children:[l.jsx("div",{className:"h-32 rounded-2xl overflow-hidden bg-gradient-to-br from-purple-500 to-pink-500",children:I&&l.jsx("img",{src:I,alt:"Cover",className:"w-full h-full object-cover"})}),l.jsxs("label",{className:"absolute bottom-2 right-2 p-2 bg-white/90 dark:bg-gray-800/90 rounded-full cursor-pointer hover:scale-110 transition-transform shadow-lg",children:[l.jsx(tc,{className:"w-4 h-4 text-gray-700 dark:text-gray-300"}),l.jsx("input",{type:"file",accept:"image/*",onChange:ee=>O(ee,"cover"),className:"hidden"})]})]}),l.jsx("div",{className:"flex justify-center -mt-16 relative z-10",children:l.jsxs("div",{className:"relative",children:[l.jsx("div",{className:"w-24 h-24 rounded-full border-4 border-white dark:border-gray-800 shadow-xl overflow-hidden bg-gradient-to-br from-purple-500 to-pink-500",children:Z?l.jsx("img",{src:Z,alt:"Profile",className:"w-full h-full object-cover"}):l.jsx("div",{className:"w-full h-full flex items-center justify-center",children:l.jsx(nc,{className:"w-10 h-10 text-white"})})}),l.jsxs("label",{className:"absolute bottom-0 right-0 p-2 bg-purple-500 rounded-full cursor-pointer hover:bg-purple-600 transition-colors shadow-lg",children:[l.jsx(tc,{className:"w-4 h-4 text-white"}),l.jsx("input",{type:"file",accept:"image/*",onChange:ee=>O(ee,"profile"),className:"hidden"})]})]})}),m&&l.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-50 dark:bg-red-900/20 rounded-xl text-red-600 dark:text-red-400 text-sm",children:[l.jsx(Ty,{className:"w-4 h-4 flex-shrink-0"}),m]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Display Name"}),l.jsx("input",{type:"text",value:P.displayName,onChange:ee=>F(ce=>({...ce,displayName:ee.target.value})),className:"w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",placeholder:"Your carnival name",maxLength:50})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Username"}),l.jsxs("div",{className:"relative",children:[l.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400",children:"@"}),l.jsx("input",{type:"text",value:P.username,onChange:D,className:`w-full pl-8 pr-10 py-3 rounded-xl border ${v?"border-red-300 dark:border-red-500":"border-gray-200 dark:border-gray-600"} bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all`,placeholder:"your_username",maxLength:20}),E&&l.jsx(bn,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 animate-spin"})]}),v&&l.jsx("p",{className:"mt-1 text-xs text-red-500",children:v}),l.jsxs("p",{className:"mt-1 text-xs text-gray-400",children:["Your public profile URL: carnivalplanner.app/profile/",P.username||"username"]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Bio"}),l.jsx("textarea",{value:P.bio,onChange:ee=>F(ce=>({...ce,bio:ee.target.value})),className:"w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all resize-none",placeholder:"Tell the fete world about your carnival journey... ",rows:3,maxLength:200}),l.jsxs("p",{className:"text-xs text-gray-400 text-right",children:[P.bio.length,"/200"]})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Social Links"}),l.jsxs("div",{className:"relative",children:[l.jsx(_N,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-pink-500"}),l.jsx("input",{type:"text",value:P.socialLinks.instagram,onChange:ee=>F(ce=>({...ce,socialLinks:{...ce.socialLinks,instagram:ee.target.value.replace("@","")}})),className:"w-full pl-10 pr-4 py-2.5 rounded-xl border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",placeholder:"Instagram username"})]}),l.jsxs("div",{className:"relative",children:[l.jsx(CN,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-blue-400"}),l.jsx("input",{type:"text",value:P.socialLinks.twitter,onChange:ee=>F(ce=>({...ce,socialLinks:{...ce.socialLinks,twitter:ee.target.value.replace("@","")}})),className:"w-full pl-10 pr-4 py-2.5 rounded-xl border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",placeholder:"Twitter/X username"})]}),l.jsxs("div",{className:"relative",children:[l.jsx(mo,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-600"}),l.jsx("input",{type:"text",value:P.socialLinks.tiktok,onChange:ee=>F(ce=>({...ce,socialLinks:{...ce.socialLinks,tiktok:ee.target.value.replace("@","")}})),className:"w-full pl-10 pr-4 py-2.5 rounded-xl border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",placeholder:"TikTok username"})]})]}),l.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700/50 rounded-2xl",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[P.isPublic?l.jsx(qm,{className:"w-5 h-5 text-green-500"}):l.jsx($m,{className:"w-5 h-5 text-gray-400"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900 dark:text-white text-sm",children:"Public Profile"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Anyone can view your carnival history"})]})]}),l.jsx("button",{onClick:()=>F(ee=>({...ee,isPublic:!ee.isPublic})),className:`relative w-12 h-7 rounded-full transition-colors ${P.isPublic?"bg-green-500":"bg-gray-300 dark:bg-gray-600"}`,children:l.jsx("span",{className:`absolute top-1 left-1 w-5 h-5 bg-white rounded-full shadow transition-transform ${P.isPublic?"translate-x-5":""}`})})]}),l.jsx("button",{onClick:M,disabled:u||!!v,className:"w-full py-4 bg-gradient-to-r from-purple-600 to-pink-600 text-white font-bold rounded-2xl hover:from-purple-700 hover:to-pink-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:u?l.jsxs(l.Fragment,{children:[l.jsx(bn,{className:"w-5 h-5 animate-spin"}),"Saving..."]}):l.jsxs(l.Fragment,{children:[l.jsx(qf,{className:"w-5 h-5"}),"Save Profile"]})})]})]})})}const rF=(t,e)=>!t||!e?[]:e.filter(n=>n.website).slice(0,10).map(n=>({id:`${n.carnivalId}-${n.name.toLowerCase().replace(/\s+/g,"-")}`,name:n.name,carnival:n.carnivalId,originalUrl:n.website,affiliateUrl:`${n.website}${n.website.includes("?")?"&":"?"}ref=${t}`,tags:n.tags||[]}));function iF({user:t,isPremium:e}){var P,F;const[n,r]=U.useState(!0),[i,o]=U.useState(null),[a,u]=U.useState(!1),[d,m]=U.useState(null),[g,v]=U.useState("");U.useEffect(()=>{if(!t)return;(async()=>{r(!0);try{const T=We(Ne,"affiliates",t.uid),A=await zr(T);A.exists()&&o({id:A.id,...A.data()})}catch(T){console.error("Error loading affiliate data:",T)}finally{r(!1)}})()},[t]);const w=async()=>{var N;if(t){u(!0),v("");try{const A=`${(t.displayName||((N=t.email)==null?void 0:N.split("@")[0])||"creator").toUpperCase().replace(/[^A-Z0-9]/g,"").slice(0,8)}${Math.random().toString(36).substring(2,5).toUpperCase()}`,z={userId:t.uid,email:t.email,displayName:t.displayName,affiliateCode:A,status:"pending",stats:{totalClicks:0,totalConversions:0,earnings:0},partnerLinks:[],appliedAt:Be.now()};await Rn(We(Ne,"affiliates",t.uid),z),o({id:t.uid,...z})}catch(T){console.error("Error applying:",T),v("Failed to submit application. Please try again.")}finally{u(!1)}}},E=async(N,T)=>{try{await navigator.clipboard.writeText(N),m(T),setTimeout(()=>m(null),2e3)}catch(A){console.error("Failed to copy:",A)}};if(n)return l.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:l.jsx(bn,{className:"w-8 h-8 animate-spin text-purple-500"})});if(!i)return l.jsx("div",{className:"max-w-2xl mx-auto animate-fadeIn",children:l.jsxs("div",{className:"text-center p-8 bg-gradient-to-br from-purple-900 via-pink-900 to-orange-900 rounded-3xl shadow-2xl text-white",children:[l.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-white/20 backdrop-blur-md rounded-full mb-6",children:l.jsx(eu,{className:"w-10 h-10 text-yellow-300"})}),l.jsx("h2",{className:"text-3xl font-black mb-3",children:"Become a Creator"}),l.jsx("p",{className:"text-white/80 mb-8 max-w-md mx-auto",children:"Share your favorite carnival bands and fetes with your followers. Get unique tracking links and see how many people you're inspiring!"}),l.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-8",children:[l.jsxs("div",{className:"p-4 bg-white/10 backdrop-blur-sm rounded-2xl",children:[l.jsx(qb,{className:"w-6 h-6 mx-auto mb-2 text-purple-300"}),l.jsx("p",{className:"text-sm font-medium",children:"Unique Links"})]}),l.jsxs("div",{className:"p-4 bg-white/10 backdrop-blur-sm rounded-2xl",children:[l.jsx(Hb,{className:"w-6 h-6 mx-auto mb-2 text-green-300"}),l.jsx("p",{className:"text-sm font-medium",children:"Track Clicks"})]}),l.jsxs("div",{className:"p-4 bg-white/10 backdrop-blur-sm rounded-2xl",children:[l.jsx(Gn,{className:"w-6 h-6 mx-auto mb-2 text-blue-300"}),l.jsx("p",{className:"text-sm font-medium",children:"Grow Influence"})]})]}),g&&l.jsxs("div",{className:"flex items-center justify-center gap-2 p-3 mb-4 bg-red-500/20 rounded-xl text-red-200 text-sm",children:[l.jsx(Ty,{className:"w-4 h-4"}),g]}),l.jsx("button",{onClick:w,disabled:a,className:"px-8 py-4 bg-white text-purple-900 font-bold rounded-2xl hover:bg-gray-100 transition-colors disabled:opacity-50 flex items-center gap-2 mx-auto",children:a?l.jsxs(l.Fragment,{children:[l.jsx(bn,{className:"w-5 h-5 animate-spin"}),"Submitting..."]}):l.jsxs(l.Fragment,{children:[l.jsx(eu,{className:"w-5 h-5"}),"Apply to Join"]})})]})});if(i.status==="pending")return l.jsx("div",{className:"max-w-2xl mx-auto animate-fadeIn",children:l.jsxs("div",{className:"text-center p-8 bg-yellow-50 dark:bg-yellow-900/20 rounded-3xl border-2 border-yellow-200 dark:border-yellow-800",children:[l.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-yellow-100 dark:bg-yellow-900/30 rounded-full mb-4",children:l.jsx(bn,{className:"w-8 h-8 text-yellow-600 animate-spin"})}),l.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Application Pending"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Your creator application is under review. We'll notify you once approved!"}),l.jsxs("p",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:["Your affiliate code: ",l.jsx("span",{className:"font-mono font-bold",children:i.affiliateCode})]})]})});if(i.status==="rejected")return l.jsx("div",{className:"max-w-2xl mx-auto animate-fadeIn",children:l.jsxs("div",{className:"text-center p-8 bg-red-50 dark:bg-red-900/20 rounded-3xl border-2 border-red-200 dark:border-red-800",children:[l.jsx(Ty,{className:"w-12 h-12 mx-auto mb-4 text-red-500"}),l.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Application Not Approved"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Unfortunately, your application wasn't approved at this time. Please contact support for more information."})]})});const C=rF(i.affiliateCode,AN);return l.jsxs("div",{className:"max-w-4xl mx-auto space-y-6 animate-fadeIn",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsxs("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[l.jsx(eu,{className:"w-6 h-6 text-yellow-500"}),"Creator Dashboard"]}),l.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"Share your links and track your influence"})]}),l.jsx("div",{className:"px-4 py-2 bg-green-100 dark:bg-green-900/30 rounded-full",children:l.jsx("span",{className:"text-sm font-medium text-green-700 dark:text-green-400",children:" Approved Creator"})})]}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[l.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700",children:[l.jsx(g3,{className:"w-5 h-5 mb-2 text-purple-500"}),l.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:((P=i.stats)==null?void 0:P.totalClicks)||0}),l.jsx("p",{className:"text-xs text-gray-500",children:"Total Clicks"})]}),l.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700",children:[l.jsx(Gn,{className:"w-5 h-5 mb-2 text-blue-500"}),l.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:((F=i.stats)==null?void 0:F.totalConversions)||0}),l.jsx("p",{className:"text-xs text-gray-500",children:"Conversions"})]}),l.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700",children:[l.jsx(Hb,{className:"w-5 h-5 mb-2 text-green-500"}),l.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:C.length}),l.jsx("p",{className:"text-xs text-gray-500",children:"Partner Links"})]}),l.jsxs("div",{className:"p-4 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-2xl shadow-sm text-white",children:[l.jsx(eu,{className:"w-5 h-5 mb-2"}),l.jsx("p",{className:"text-sm font-mono font-bold",children:i.affiliateCode}),l.jsx("p",{className:"text-xs opacity-80",children:"Your Code"})]})]}),l.jsxs("div",{className:"p-6 bg-gradient-to-br from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 rounded-2xl",children:[l.jsx("div",{className:"flex items-center justify-between mb-4",children:l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold text-gray-900 dark:text-white",children:"Your Affiliate Code"}),l.jsx("p",{className:"text-sm text-gray-500",children:"Share this code or use the links below"})]})}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"flex-1 px-4 py-3 bg-white dark:bg-gray-800 rounded-xl font-mono text-lg font-bold text-gray-900 dark:text-white border border-gray-200 dark:border-gray-700",children:i.affiliateCode}),l.jsx("button",{onClick:()=>E(i.affiliateCode,"code"),className:"p-3 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors",children:d==="code"?l.jsx(qf,{className:"w-5 h-5"}):l.jsx(Ub,{className:"w-5 h-5"})})]})]}),l.jsxs("div",{children:[l.jsxs("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[l.jsx(qb,{className:"w-5 h-5 text-blue-500"}),"Partner Links"]}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:"Share these links with your followers. Clicks are automatically tracked!"}),l.jsx("div",{className:"space-y-3",children:C.map(N=>l.jsxs("div",{className:"flex items-center gap-4 p-4 bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 hover:shadow-md transition-shadow",children:[l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("p",{className:"font-medium text-gray-900 dark:text-white truncate",children:N.name}),l.jsx("p",{className:"text-xs text-gray-400 truncate font-mono",children:N.affiliateUrl})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>E(N.affiliateUrl,N.id),className:"p-2 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",title:"Copy link",children:d===N.id?l.jsx(qf,{className:"w-4 h-4 text-green-500"}):l.jsx(Ub,{className:"w-4 h-4 text-gray-500"})}),l.jsx("a",{href:N.affiliateUrl,target:"_blank",rel:"noopener noreferrer",className:"p-2 bg-purple-100 dark:bg-purple-900/30 rounded-lg hover:bg-purple-200 dark:hover:bg-purple-900/50 transition-colors",title:"Open link",children:l.jsx(xd,{className:"w-4 h-4 text-purple-600 dark:text-purple-400"})})]})]},N.id))}),C.length===0&&l.jsxs("div",{className:"text-center p-8 bg-gray-50 dark:bg-gray-800/50 rounded-2xl",children:[l.jsx(qm,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),l.jsx("p",{className:"text-gray-500",children:"No partner links available yet"})]})]})]})}function sF({onBack:t,onSuccess:e}){const[n,r]=U.useState("login"),[i,o]=U.useState(""),[a,u]=U.useState(""),[d,m]=U.useState(""),[g,v]=U.useState(!1),[w,E]=U.useState(!1),[C,P]=U.useState(""),[F,N]=U.useState(""),T=I=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(I),A=I=>{switch(I){case"auth/email-already-in-use":return"This email is already registered. Try logging in instead.";case"auth/invalid-email":return"Please enter a valid email address.";case"auth/weak-password":return"Password should be at least 6 characters.";case"auth/user-not-found":return"No account found with this email.";case"auth/wrong-password":return"Incorrect password. Please try again.";case"auth/invalid-credential":return"Invalid email or password. Please check and try again.";case"auth/too-many-requests":return"Too many attempts. Please try again later.";default:return"Something went wrong. Please try again."}},z=async I=>{if(I.preventDefault(),P(""),N(""),!T(i)){P("Please enter a valid email address.");return}if(a.length<6){P("Password must be at least 6 characters.");return}if(a!==d){P("Passwords do not match.");return}E(!0);try{const b=await lj(Ks,i,a);await QT(b.user),N("Account created! Please check your email to verify your account."),e&&e(b.user)}catch(b){console.error("Sign up error:",b),P(A(b.code))}finally{E(!1)}},Z=async I=>{if(I.preventDefault(),P(""),N(""),!T(i)){P("Please enter a valid email address.");return}if(!a){P("Please enter your password.");return}E(!0);try{const b=await cj(Ks,i,a);e&&e(b.user)}catch(b){console.error("Login error:",b),P(A(b.code))}finally{E(!1)}},H=async()=>{if(P(""),N(""),!T(i)){P("Please enter your email address first.");return}E(!0);try{await aj(Ks,i),N("Password reset email sent! Check your inbox.")}catch(I){console.error("Password reset error:",I),P(A(I.code))}finally{E(!1)}};return l.jsxs("div",{className:"w-full max-w-md mx-auto",children:[l.jsxs("button",{onClick:t,className:"flex items-center gap-2 text-gray-400 hover:text-white mb-6 transition-colors",children:[l.jsx(Z_,{className:"w-4 h-4"}),"Back"]}),l.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 rounded-2xl p-6",children:[l.jsx("h2",{className:"text-2xl font-bold text-white mb-6 text-center",children:n==="login"?"Welcome Back":"Create Account"}),C&&l.jsx("div",{className:"mb-4 p-3 bg-red-500/20 border border-red-500/30 rounded-lg text-red-300 text-sm",children:C}),F&&l.jsx("div",{className:"mb-4 p-3 bg-green-500/20 border border-green-500/30 rounded-lg text-green-300 text-sm",children:F}),l.jsxs("form",{onSubmit:n==="login"?Z:z,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Email"}),l.jsxs("div",{className:"relative",children:[l.jsx(X_,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),l.jsx("input",{type:"email",value:i,onChange:I=>o(I.target.value),placeholder:"your@email.com",className:"w-full pl-10 pr-4 py-3 bg-gray-900/80 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:border-pink-500 focus:ring-2 focus:ring-pink-500/20 transition-colors",disabled:w})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Password"}),l.jsxs("div",{className:"relative",children:[l.jsx($b,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),l.jsx("input",{type:g?"text":"password",value:a,onChange:I=>u(I.target.value),placeholder:"Enter your password",className:"w-full pl-10 pr-12 py-3 bg-gray-900/80 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:border-pink-500 focus:ring-2 focus:ring-pink-500/20 transition-colors",disabled:w}),l.jsx("button",{type:"button",onClick:()=>v(!g),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-300",children:g?l.jsx(l3,{className:"w-5 h-5"}):l.jsx(J_,{className:"w-5 h-5"})})]})]}),n==="signup"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Confirm Password"}),l.jsxs("div",{className:"relative",children:[l.jsx($b,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),l.jsx("input",{type:g?"text":"password",value:d,onChange:I=>m(I.target.value),placeholder:"Confirm your password",className:"w-full pl-10 pr-4 py-3 bg-gray-900/80 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:border-pink-500 focus:ring-2 focus:ring-pink-500/20 transition-colors",disabled:w})]})]}),n==="login"&&l.jsx("div",{className:"text-right",children:l.jsx("button",{type:"button",onClick:H,className:"text-sm text-pink-400 hover:text-pink-300 transition-colors",disabled:w,children:"Forgot password?"})}),l.jsx("button",{type:"submit",disabled:w,className:"w-full py-3 bg-gradient-to-r from-pink-500 to-orange-500 rounded-xl font-bold text-white hover:opacity-90 transition-opacity disabled:opacity-50 flex items-center justify-center gap-2",children:w?l.jsxs(l.Fragment,{children:[l.jsx(bn,{className:"w-5 h-5 animate-spin"}),n==="login"?"Signing in...":"Creating account..."]}):n==="login"?"Sign In":"Create Account"})]}),l.jsx("div",{className:"mt-6 text-center",children:l.jsxs("p",{className:"text-gray-400 text-sm",children:[n==="login"?"Don't have an account?":"Already have an account?",l.jsx("button",{onClick:()=>{r(n==="login"?"signup":"login"),P(""),N("")},className:"ml-2 text-pink-400 hover:text-pink-300 font-semibold transition-colors",children:n==="login"?"Sign Up":"Sign In"})]})})]})]})}function oF({user:t,onResend:e}){const[n,r]=U.useState(!1),[i,o]=U.useState(!1);if(!t||t.emailVerified||!t.email)return null;const a=async()=>{r(!0);try{await QT(t),o(!0),setTimeout(()=>o(!1),5e3)}catch(u){console.error("Error sending verification:",u)}finally{r(!1)}};return l.jsxs("div",{className:"bg-yellow-500/20 border border-yellow-500/30 text-yellow-200 px-4 py-3 flex items-center justify-between gap-4 flex-wrap",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(X_,{className:"w-5 h-5"}),l.jsx("span",{className:"text-sm",children:"Please verify your email address to access all features."})]}),l.jsx("button",{onClick:a,disabled:n||i,className:"text-sm font-semibold bg-yellow-500/30 hover:bg-yellow-500/40 px-3 py-1 rounded-lg transition-colors disabled:opacity-50",children:i?"Email Sent!":n?"Sending...":"Resend Email"})]})}const RN=()=>Math.random().toString(36).substring(2,8).toUpperCase(),aF=async(t,e,n)=>{if(!t)throw new Error("User not authenticated");const r=RN(),i={name:e,leaderId:t.uid,leaderName:t.displayName||t.email,members:[t.uid],memberDetails:{[t.uid]:{name:t.displayName||t.email,role:"leader",photoURL:t.photoURL||null,joinedAt:new Date().toISOString()}},carnivalId:n,inviteCode:r,createdAt:Uf(),sharedItinerary:[]};console.log("Attempting to create squad doc...",i);const o=await Jl(sn(Ne,"squads"),i);console.log("Squad doc created with ID:",o.id);const a=We(Ne,"users",t.uid);return console.log("Updating user profile for squad:",t.uid),await Rn(a,{currentSquadId:o.id},{merge:!0}),console.log("User profile updated."),{id:o.id,...i}},lF=async(t,e)=>{if(console.log("joinSquadByCode started",{uid:t==null?void 0:t.uid,inviteCode:e}),!t)throw new Error("Must be logged in");const n=sn(Ne,"squads"),r=gd(n,I_("inviteCode","==",e.toUpperCase())),i=await Qo(r);if(i.empty)throw new Error("Invalid Squad Code");const o=i.docs[0],a=o.id,u=o.data();console.log("Squad found:",{squadId:a,squadData:u});const d=We(Ne,"squads",a),m=t.displayName||t.email||"Unknown User";console.log("Adding user to squad:",m),!u.members||!u.members.includes(t.uid)?(await Ia(d,{members:x1(t.uid),[`memberDetails.${t.uid}`]:{name:m,role:"member",photoURL:t.photoURL||null,joinedAt:new Date().toISOString()}}),console.log("Squad doc updated")):console.log("User already in squad (skipping array update)");const g=We(Ne,"users",t.uid);return await Rn(g,{currentSquadId:a},{merge:!0}),console.log("User profile updated with squadId:",a),{id:a,...u}},cF=async(t,e)=>{if(!t||!e)return;const n=We(Ne,"squads",e),r=We(Ne,"users",t.uid);await Ia(n,{members:w1(t.uid)}),await Ia(r,{currentSquadId:null})},uF=async(t,e)=>{if(!t||!e)throw new Error("Missing required parameters");const n=We(Ne,"squads",e),r=await zr(n);if(!r.exists())throw new Error("Squad not found");if(r.data().leaderId!==t)throw new Error("Only the squad leader can regenerate the invite code");const o=RN();return await Ia(n,{inviteCode:o}),console.log(`New invite code generated for squad ${e}: ${o}`),o},yh="carnival-planner-v1",dF="price_1SanHUJR9xpdRiXijLesRPVt",hF="price_1SanMhJR9xpdRiXinv2F9knM",Jb={trinidad:[{title:"Soca Brainwash",note:"The main event. Bring drinks."},{title:"AM Bush",note:"J'ouvert style. Wear old clothes."},{title:"Phuket",note:"All inclusive."},{title:"Soaka Street Festival",note:"Iron park."}],stlucia:[{title:"Remedy",note:"Beachside."},{title:"Mess",note:"Paint and Powder."},{title:"Indulgence",note:"Breakfast fete."}],default:[{title:"Catamaran Cruise",note:"Boat ride."},{title:"J'ouvert",note:"Paint and powder."},{title:"Monday Mas",note:"On the road."}]};function fF(){var xs,je,lt,ws,Sn,pt,Si;const[t,e]=U.useState(null),[n,r]=U.useState(!1),[i,o]=U.useState({}),[a,u]=U.useState(null),[d,m]=U.useState("Budget"),[g,v]=U.useState(!1),[w,E]=U.useState(!0),[C,P]=U.useState(!1),[F,N]=U.useState(!0),[T,A]=U.useState(!1),[z,Z]=U.useState(""),[H,I]=U.useState(""),[b,R]=U.useState(""),[D,O]=U.useState(""),[B,M]=U.useState(""),[ee,ce]=U.useState(""),[me,we]=U.useState(""),[G,le]=U.useState({band:"",section:"",total:"",paid:""}),[te,ke]=U.useState(""),[de,pe]=U.useState(""),[ve,he]=U.useState([]),[se,Me]=U.useState(null),[Ye,tr]=U.useState(null),[Pt,In]=U.useState(!1),[cn,ht]=U.useState(!1),[ft,Ke]=U.useState(""),[$t,mt]=U.useState(""),un=async()=>{const{DEMO_USER:j,DEMO_CARNIVALS:K,DEMO_SQUAD:Q}=await zg(async()=>{const{DEMO_USER:fe,DEMO_CARNIVALS:Ae,DEMO_SQUAD:ze}=await import("./demoData-59eL2sCn.js");return{DEMO_USER:fe,DEMO_CARNIVALS:Ae,DEMO_SQUAD:ze}},[]);r(!0),e(j),o(K),u("trinidad"),he(Q),v(!0),E(!1),ct(K.trinidad)},ls=()=>{r(!1),e(null),o({}),u(null),he([]),v(!1),E(!0),ct(null)};U.useEffect(()=>{new URLSearchParams(window.location.search).get("demo")==="true"&&un()},[]);const cs=async()=>{if(n){alert("This feature is simulated in Demo Mode.");return}if(t){In(!0),Ke("");try{const j=await aF(t,`${t.displayName||"User"}'s Squad`,a);Me(j),ke(j.inviteCode),Vn("Only Premium users can lead a squad!")}catch(j){console.error("Error creating squad:",j),Ke(`Failed: ${j.message}`)}finally{In(!1)}}},us=async()=>{if(n){alert("Joining squads is simulated in Demo Mode.");return}if(!t||!de)return;const j=de.trim().toUpperCase();ht(!0),Ke(""),console.log("HandleJoinSquad: Attempting to join with code:",j);try{const K=await lF(t,j);console.log("HandleJoinSquad: Join success. Squad result:",K),K||console.warn("HandleJoinSquad: No squad object returned, but execution did not throw. Assuming success via listener."),mt("Joined Squad!"),pe("")}catch(K){console.error("Error joining squad:",K),Ke(K.message||"Invalid code")}finally{ht(!1)}},Ma=async()=>{if(n){confirm("Exit Demo Mode?")&&ls();return}!t||!se||confirm("Are you sure you want to leave this squad?")&&(await cF(t,se.id),Me(null),he([]))},ds=async(j,K)=>{if(n){alert("Member removal is disabled in Demo Mode.");return}if(!(!t||!se)){if(se.leaderId!==t.uid){alert("Only the squad leader can remove members.");return}if(confirm(`Remove ${K} from your squad?`))try{if(await Jr(t.uid,se.id,j),Vn(`${K} has been removed from the squad.`),confirm(`${K} was removed.

Would you like to generate a new invite code?
(This prevents them from rejoining with the old code)`)){const Q=await uF(t.uid,se.id);ke(Q),Vn(`New invite code: ${Q}`)}}catch(Q){console.error("Error removing member:",Q),alert(`Failed to remove member: ${Q.message}`)}}},[vi,Vn]=U.useState(null),[bt,Ft]=U.useState(!0),[Gr,ko]=U.useState(!1),[xi,Io]=U.useState(navigator.onLine);U.useEffect(()=>{const j=()=>Io(!0),K=()=>Io(!1);return window.addEventListener("online",j),window.addEventListener("offline",K),()=>{window.removeEventListener("online",j),window.removeEventListener("offline",K)}},[]);const[Kr,Fn]=U.useState(null),[hs,fs]=U.useState(()=>!localStorage.getItem("carnival-planner-welcomed")),[hc,Zr]=U.useState(!1),[ms,ps]=U.useState(null),[To,Ar]=U.useState(!1),[gs,wi]=U.useState(!1),[Tn,bi]=U.useState([]),[ys,Eo]=U.useState(!1),[Qr,ki]=U.useState(null),Ht=[{id:"stkitts-sugar-mas",name:"St. Kitts (Sugar Mas)",monthIndex:0},{id:"stcroix",name:"St. Croix Carnival",monthIndex:0},{id:"trinidad",name:"Trinidad Carnival",monthIndex:1},{id:"dominica",name:"Dominica (Mas Domnik)",monthIndex:1},{id:"jamaica",name:"Jamaica Carnival",monthIndex:3},{id:"tampa",name:"Tampa Bay Carnival",monthIndex:3},{id:"stmaarten",name:"St. Maarten Carnival",monthIndex:3},{id:"cayman-batabano",name:"Cayman Batabano",monthIndex:4},{id:"stthomas",name:"St. Thomas Carnival",monthIndex:4},{id:"atlanta",name:"Atlanta Caribbean Carnival",monthIndex:4},{id:"guyana",name:"Guyana Independence",monthIndex:4},{id:"bahamas",name:"Bahamas Carnival",monthIndex:5},{id:"bermuda",name:"Bermuda Carnival",monthIndex:5},{id:"hollywood",name:"Hollywood Carnival",monthIndex:5},{id:"caymas",name:"Caymas Carnival",monthIndex:5},{id:"vincymas",name:"St. Vincent (Vincy Mas)",monthIndex:6},{id:"stlucia",name:"St. Lucia Carnival",monthIndex:6},{id:"toronto",name:"Toronto (Caribana)",monthIndex:7},{id:"barbados",name:"Barbados Crop Over",monthIndex:7},{id:"nevis",name:"Nevis Culturama",monthIndex:7},{id:"antigua",name:"Antigua Carnival",monthIndex:7},{id:"grenada",name:"Grenada Spicemas",monthIndex:7},{id:"ny-labor-day",name:"New York Carnival",monthIndex:8},{id:"japan",name:"Japan Caribbean",monthIndex:8},{id:"miami",name:"Miami Carnival",monthIndex:9},{id:"tobago",name:"Tobago Carnival",monthIndex:10}],So=["bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500","bg-gradient-to-r from-green-400 to-blue-500","bg-gradient-to-r from-yellow-400 via-red-500 to-pink-500","bg-gradient-to-r from-teal-400 to-cyan-500","bg-gradient-to-r from-red-500 via-orange-500 to-yellow-500","bg-gradient-to-r from-purple-600 to-indigo-600"],Yr=["January","February","March","April","May","June","July","August","September","October","November","December"];U.useEffect(()=>{F?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[F]),U.useEffect(()=>{if(!t||n)return;(async()=>{try{const K=We(Ne,"users",t.uid,"preferences","theme"),Q=await zr(K);if(Q.exists()){const fe=Q.data();typeof fe.darkMode=="boolean"&&N(fe.darkMode)}}catch(K){console.log("Could not load theme preference:",K)}})()},[t,n]);const Ii=async j=>{if(!(!t||n))try{const K=We(Ne,"users",t.uid,"preferences","theme");await Rn(K,{darkMode:j,updatedAt:Be.now()},{merge:!0})}catch(K){console.log("Could not save theme preference:",K)}},Un=()=>{const j=!F;N(j),Ii(j)};U.useEffect(()=>{if(n)return;const j=hj(Ks,async K=>{if(e(K),K){console.log("[Analytics] Creating/updating user doc for:",K.uid,K.email);try{const Q=We(Ne,"users",K.uid);await Rn(Q,{lastLoginAt:Be.now(),email:K.email||null,displayName:K.displayName||null},{merge:!0}),console.log("[Analytics] User document updated successfully"),navigator.geolocation&&navigator.geolocation.getCurrentPosition(fe=>{const{latitude:Ae,longitude:ze}=fe.coords;Rn(Q,{lastLocation:{lat:Ae,lng:ze},lastLocationAt:Be.now()},{merge:!0}).then(()=>console.log("Location saved")).catch(Ve=>console.error("Loc save error",Ve))},fe=>{console.log("Geolocation denied/error:",fe.message)})}catch(Q){console.error("[Analytics] Failed to update user doc:",Q.code,Q.message)}}});return()=>j()},[n]),U.useEffect(()=>{if(!t||n){tr(null);return}const j=qi(We(Ne,"users",t.uid),K=>{const Q=K.data(),fe=(Q==null?void 0:Q.currentSquadId)||null;fe!==Ye&&(console.log("App: User changed squad to:",fe),tr(fe))});return()=>j()},[t,n,Ye]),U.useEffect(()=>{if(!t||n)return;if(!Ye){console.log("App: No target squad, clearing state."),Me(null),he([]),ct(null);return}console.log("App: Subscribing to squad:",Ye);const j=qi(We(Ne,"squads",Ye),K=>{if(K.exists()){const Q=K.data();console.log("App: Squad loaded:",K.id),Me({id:K.id,...Q}),ct(Q);const fe=Object.values(Q.memberDetails||{});he(fe),ke(Q.inviteCode)}else console.warn("App: Target squad does not exist/deleted:",Ye),Me(null),ct(null),he([]),ke("")});return()=>{console.log("App: Unsubscribing from squad:",Ye),j(),ke("")}},[Ye,t,n]),U.useEffect(()=>{!se&&ve.length>0&&(console.warn("App: DETECTED GHOST MEMBERS! Self-healing state."),he([]),ke(""))},[se,ve]),U.useEffect(()=>{if(!t){n||v(!1);return}if(n){v(!0);return}const j=["djkrss1@gmail.com","maikacooke@gmail.com"];j.includes(t.email)&&v(!0);const K=We(Ne,"users",t.uid,"apps",yh),Q=qi(K,fe=>{if(j.includes(t.email)){v(!0);return}if(fe.exists()){const Ae=fe.data();v(!!Ae.premiumActive)}else v(!1)});return()=>Q()},[t,n]),U.useEffect(()=>{if(!t){n||(o({}),u(null));return}if(n)return;const j=sn(Ne,"users",t.uid,"apps",yh,"carnivals"),K=qi(j,Q=>{const fe={};Q.forEach(Ae=>{fe[Ae.id]=Ae.data()}),o(fe),!a&&Q.docs.length>0&&u(Q.docs[0].id)});return()=>K()},[t,n]),U.useEffect(()=>{if(!t||n){ps(null);return}(async()=>{try{const K=await zr(We(Ne,"userProfiles",t.uid));K.exists()&&ps({id:K.id,...K.data()})}catch(K){console.log("Could not load profile:",K)}})()},[t,n]),U.useEffect(()=>{n||Fj(Ks).catch(j=>console.error(j))},[n]),U.useEffect(()=>{if(!t||n)return;(async()=>{try{const Q=await V5("BLbW7EjHjQ9_YjKrRbJwgBgRqnkSmZsXMnEWTQZpqYwSRbVgYLmXW5RvXA2_aS3vH9XJpCxHu4VmXnZL2wQxMvI");if(Q){const fe=Ds(kr);await Ms(fe,"saveFcmToken")({fcmToken:Q}),console.log("FCM token saved")}}catch(K){console.log("Error setting up notifications:",K)}})(),F5(K=>{var Q,fe;console.log("Foreground message:",K),Vn({title:((Q=K.notification)==null?void 0:Q.title)||"Squad Alert",body:((fe=K.notification)==null?void 0:fe.body)||"Someone in your squad is Road Ready!"}),setTimeout(()=>Vn(null),5e3)})},[t,n]);const Te=async()=>{const j=new Mi;try{await Rj(Ks,j)}catch(K){console.error("Sign in error:",K)}},Rr=async()=>{if(n){ls();return}await YT(Ks),E(!0),P(!1),m("Budget"),N(!0)},No=async j=>{if(n){alert("Subscriptions are disabled in Demo Mode.");return}if(!t){alert("You must be signed in to subscribe.");return}const K=j==="yearly"?"yearly":"monthly",Q=K==="yearly"?hF:dF;A(!0);try{const fe=Ds(kr),Ae=Ms(fe,"createCheckoutSession");console.log(`Starting checkout... Interval: ${K}, PriceID: ${Q}`);const ze=await Ae({priceId:Q,success_url:window.location.origin,cancel_url:window.location.origin}),{data:Ve}=ze||{};Ve&&(Ve.url||Ve.checkoutUrl)?window.location.href=Ve.url||Ve.checkoutUrl:(console.error("No checkout URL returned:",Ve),alert("Unable to start checkout. Please try again."))}catch(fe){console.error("Error starting checkout:",fe),alert("There was a problem starting your checkout: "+fe.message)}finally{A(!1)}},Oa=async(j,K)=>{if(t){if(u(j),n){i[j]?j==="trinidad"&&i.trinidad?ct(i.trinidad):ct(null):(o(Q=>({...Q,[j]:{name:K,budget:[],schedule:[],packing:[],squad:[],costume:null,createdAt:new Date().toISOString()}})),ct(null));return}if(!i[j])try{const Q=We(Ne,"users",t.uid,"apps",yh,"carnivals",j);await Rn(Q,{name:K,budget:[],schedule:[],packing:[],squad:[],costume:null,createdAt:Be.now()},{merge:!0})}catch(Q){console.error(Q)}}},En=(xs=i[a])==null?void 0:xs.sharedPlanId,kt=!!En,[dn,ct]=U.useState(null),[Bn,Po]=U.useState(!1),Co=async()=>{if(!n){if(!En||!t){ct(null);return}Po(!0);try{const j=Ds(kr),Q=await Ms(j,"getSharedCarnivalData")({planId:En,uid:t.uid});ct(Q.data)}catch(j){console.log("Could not load shared carnival data:",j.message),ct(null)}finally{Po(!1)}}};U.useEffect(()=>{En&&!n?Co():n||ct(null)},[En,t,n]);const tt=async(j,K,Q="set")=>{var Ae;if(!t||!a)return;if(n){const ze=Ve=>{let Dt=K;return Q==="add"&&Array.isArray(Ve[j])?Dt=[...Ve[j]||[],...K]:Q==="remove"&&Array.isArray(Ve[j])?Dt=(Ve[j]||[]).filter(Qt=>Qt.id!==K.id):Q==="update"&&Array.isArray(Ve[j])&&K.id!==void 0&&(Dt=(Ve[j]||[]).map(Qt=>Qt.id===K.id?{...Qt,...K}:Qt)),Q==="set"&&(Dt=K),{...Ve,[j]:Dt}};kt?(ct(Ve=>ze(Ve)),o(Ve=>({...Ve,[a]:ze(Ve[a])}))):o(Ve=>({...Ve,[a]:ze(Ve[a])}));return}if(En&&["budget","schedule","packing","costume","squad"].includes(j))try{const ze=Ds(kr),Dt=await Ms(ze,"updateSharedCarnivalData")({planId:En,field:j,data:K,action:Q,uid:t.uid,userEmail:t.email});(Ae=Dt.data)!=null&&Ae.data&&ct(Dt.data.data);return}catch(ze){console.error("Error updating shared data:",ze)}const fe=We(Ne,"users",t.uid,"apps",yh,"carnivals",a);await Ia(fe,{[j]:K})};U.useEffect(()=>{if(!t||!a||!g){bi([]);return}(async()=>{var K;Eo(!0);try{const Q=Ds(kr),Ae=await Ms(Q,"getScrapedEvents")({carnivalId:a});(K=Ae.data)!=null&&K.success?(bi(Ae.data.events||[]),ki(Ae.data.lastScrapedAt)):(bi([]),ki(null))}catch(Q){console.log("Error fetching scraped events:",Q),bi([])}finally{Eo(!1)}})()},[t,a,g]);const Ao=async()=>{var j,K;if(P(!0),g&&bt&&ye){ko(!0);try{const Q=Ds(kr),Ae=await Ms(Q,"sendRoadReadyAlert")({carnivalId:a,carnivalName:ye.name,userName:(t==null?void 0:t.displayName)||((j=t==null?void 0:t.email)==null?void 0:j.split("@")[0])||"Squad Member"});((K=Ae.data)==null?void 0:K.notified)>0&&(Vn({title:"Squad Notified!",body:`${Ae.data.notified} squad member(s) alerted that you're Road Ready!`}),setTimeout(()=>Vn(null),5e3))}catch(Q){console.log("Error sending Road Ready alert:",Q)}finally{ko(!1)}}},Ro=()=>{var K;if(!z.trim()||!H)return;const j={id:Date.now().toString(),name:z.trim(),cost:parseFloat(H)};if(kt)tt("budget",[j],"add");else{const Q=((K=i[a])==null?void 0:K.budget)||[];tt("budget",[...Q,j])}Z(""),I("")},Va=j=>{var K;if(kt)tt("budget",{id:j},"remove");else{const Q=((K=i[a])==null?void 0:K.budget)||[];tt("budget",Q.filter(fe=>fe.id!==j))}},_s=()=>{var K;if(!b.trim()||!D)return;const j={id:Date.now().toString(),title:b.trim(),datetime:D,note:B.trim()};if(kt)tt("schedule",[j],"add");else{const Q=((K=i[a])==null?void 0:K.schedule)||[];tt("schedule",[...Q,j])}R(""),O(""),M("")},vs=j=>{var K;if(kt)tt("schedule",{id:j},"remove");else{const Q=((K=i[a])==null?void 0:K.schedule)||[];tt("schedule",Q.filter(fe=>fe.id!==j))}},jo=j=>{var Ae;const K=new Date;K.setDate(K.getDate()+1),K.setHours(12,0,0,0);const Q=K.toISOString().slice(0,16),fe={id:Date.now().toString(),title:j.title,datetime:Q,note:j.note||"Added from curated list"};if(kt)tt("schedule",[fe],"add");else{const ze=((Ae=i[a])==null?void 0:Ae.schedule)||[];tt("schedule",[...ze,fe])}},Lo=()=>{var K;if(!ee.trim())return;const j={id:Date.now().toString(),item:ee.trim(),checked:!1};if(kt)tt("packing",[j],"add");else{const Q=((K=i[a])==null?void 0:K.packing)||[];tt("packing",[...Q,j])}ce("")},Ti=j=>{var fe;const K=kt?(dn==null?void 0:dn.packing)||[]:((fe=i[a])==null?void 0:fe.packing)||[],Q=K.find(Ae=>Ae.id===j);Q&&(kt?tt("packing",{id:j,checked:!Q.checked},"update"):tt("packing",K.map(Ae=>Ae.id===j?{...Ae,checked:!Ae.checked}:Ae)))},jr=j=>{var K;if(kt)tt("packing",{id:j},"remove");else{const Q=((K=i[a])==null?void 0:K.packing)||[];tt("packing",Q.filter(fe=>fe.id!==j))}},Ei=()=>{var K;if(!me.trim())return;const j={id:Date.now().toString(),name:me.trim()};if(kt)tt("squad",[j],"add");else{const Q=((K=i[a])==null?void 0:K.squad)||[];tt("squad",[...Q,j])}we("")},Jr=j=>{var K;if(kt)tt("squad",{id:j},"remove");else{const Q=((K=i[a])==null?void 0:K.squad)||[];tt("squad",Q.filter(fe=>fe.id!==j))}};U.useEffect(()=>{const j=a?i[a]:null;j!=null&&j.shareCode?ke(j.shareCode):ke("")},[a,i]);const Do=()=>{te&&(navigator.clipboard.writeText(te),mt("Code copied to clipboard!"),setTimeout(()=>mt(""),2e3))},Mo=()=>{tt("costume",{...G,total:parseFloat(G.total)||0,paid:parseFloat(G.paid)||0,updatedAt:Date.now()}),alert("Costume details saved!")},Xr=()=>{if(!ye)return;const j=[];j.push(`CARNIVAL PLANNER: ${ye.name}`),j.push(`==========================================
`),j.push("-- SQUAD --"),(ye.squad||[]).forEach(ze=>j.push(`- ${ze.name}`)),j.push(`
`),j.push("-- COSTUME --"),ye.costume?(j.push(`Band: ${ye.costume.band}`),j.push(`Section: ${ye.costume.section}`),j.push(`Balance Due: $${((ye.costume.total||0)-(ye.costume.paid||0)).toFixed(2)}`)):j.push("No costume details."),j.push(`
`),j.push("-- SCHEDULE --"),(ye.schedule||[]).slice().sort((ze,Ve)=>new Date(ze.datetime)-new Date(Ve.datetime)).forEach(ze=>j.push(`${new Date(ze.datetime).toLocaleString()} | ${ze.title}`));const Q=new Blob([j.join(`
`)],{type:"text/plain"}),fe=URL.createObjectURL(Q),Ae=document.createElement("a");Ae.href=fe,Ae.download=`${ye.name.replace(/\s+/g,"_")}_Plan.txt`,Ae.click()},Le=a?i[a]:null,ye=Le?{...Le,...kt&&dn?{budget:dn.budget||Le.budget||[],schedule:dn.schedule||Le.schedule||[],packing:dn.packing||Le.packing||[],costume:dn.costume||Le.costume,squad:dn.squad||Le.squad||[]}:{}}:null,ei=((je=ye==null?void 0:ye.budget)==null?void 0:je.reduce((j,K)=>j+(K.cost||0),0))||0,pr=ye!=null&&ye.costume?ye.costume.total-ye.costume.paid:0,Lr=ye?Jb[a]||Jb.default:[];if(Kr){const j={onBack:()=>Fn(null),logo:fh};switch(Kr){case"privacy":return l.jsx(q3,{...j});case"terms":return l.jsx($3,{...j});case"cookies":return l.jsx(H3,{...j});case"refund":return l.jsx(W3,{...j});case"contact":return l.jsx(K3,{...j,user:t});default:Fn(null)}}if(w&&!t)return l.jsx(z3,{onGetStarted:()=>E(!1),logo:fh,onLegalPage:Fn,onTryDemo:un});if(t&&C&&ye){const j=(ye.schedule||[]).slice().sort((K,Q)=>new Date(K.datetime)-new Date(Q.datetime)).find(K=>new Date(K.datetime)>new Date);return l.jsxs("div",{className:"min-h-screen bg-gray-900 text-white p-6 flex flex-col",children:[l.jsxs("div",{className:"flex justify-between items-center mb-8",children:[l.jsx("h1",{className:"text-2xl font-bold italic",children:"ROAD MODE"}),l.jsx("button",{onClick:()=>P(!1),className:"text-sm bg-gray-800 px-3 py-1 rounded",children:"Exit"})]}),l.jsxs("div",{className:"flex-1 flex flex-col gap-6",children:[l.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-blue-600 p-6 rounded-2xl shadow-lg",children:[l.jsx("h2",{className:"text-sm font-bold opacity-75 uppercase tracking-wider mb-1",children:"Up Next"}),j?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"text-3xl font-black mb-1",children:j.title}),l.jsx("div",{className:"text-xl opacity-90",children:new Date(j.datetime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),l.jsx("div",{className:"mt-2 text-sm bg-white/20 inline-block px-2 py-1 rounded",children:j.note||"No notes"})]}):l.jsx("div",{className:"text-xl italic opacity-75",children:"No more fetes scheduled! Sleep time?"})]}),l.jsxs("div",{className:"bg-gray-800 p-6 rounded-2xl border border-gray-700",children:[l.jsx("h2",{className:"text-sm font-bold opacity-75 uppercase tracking-wider mb-2",children:"Costume Pickup"}),ye.costume?l.jsxs("div",{children:[l.jsx("div",{className:"text-xl font-bold text-yellow-400",children:ye.costume.band}),l.jsxs("div",{className:"text-gray-400",children:["Section: ",ye.costume.section]}),pr>0&&l.jsxs("div",{className:"text-red-400 font-bold mt-1",children:["Balance Due: $",pr]})]}):l.jsx("div",{className:"text-gray-500 italic",children:"No costume details saved."})]})]})]})}return l.jsxs("div",{className:"min-h-screen flex flex-col bg-gray-50 dark:bg-gray-900 transition-colors duration-200",children:[vi&&l.jsx("div",{className:"fixed top-4 right-4 z-50 animate-slideIn",children:l.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 text-white p-4 rounded-xl shadow-2xl max-w-sm",children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx("span",{className:"text-2xl",children:""}),l.jsxs("div",{children:[l.jsx("p",{className:"font-bold",children:vi.title}),l.jsx("p",{className:"text-sm opacity-90",children:vi.body})]}),l.jsx("button",{onClick:()=>Vn(null),className:"ml-2 text-white/70 hover:text-white",children:""})]})})}),l.jsx(G3,{}),l.jsxs("header",{className:"bg-white dark:bg-gray-800 shadow-sm py-4 px-4 flex justify-between items-center sticky top-0 z-20 transition-colors",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("img",{src:fh,alt:"Logo",className:"w-8 h-8"}),l.jsx("h1",{className:"text-lg font-bold text-gray-800 dark:text-white hidden sm:block",children:"Carnival Planner"})]}),t&&l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:Un,className:"p-2 rounded-full bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-yellow-300",children:F?"":""}),n&&l.jsx("button",{onClick:ls,className:"px-3 py-1 text-xs font-bold rounded-full bg-red-100 text-red-700 hover:bg-red-200 border border-red-200 transition-colors",children:"EXIT DEMO"}),ye&&l.jsx("button",{onClick:Ao,disabled:Gr,className:"px-3 py-1 text-xs font-bold rounded-full transition bg-purple-100 text-purple-700 hover:bg-purple-200 dark:bg-purple-900 dark:text-purple-200 disabled:opacity-50",children:Gr?"...":"GO ROAD READY"}),g?l.jsx("span",{className:"px-2 py-1 text-xs bg-yellow-100 text-yellow-800 rounded-full font-bold",children:"Premium"}):l.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500",children:"Free Plan"}),l.jsxs("div",{className:`flex items-center gap-1.5 px-2 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider ${xi?"bg-green-100 text-green-700 dark:bg-green-900/40 dark:text-green-300":"bg-orange-100 text-orange-700 dark:bg-orange-900/40 dark:text-orange-300"}`,children:[l.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${xi?"bg-green-500":"bg-orange-500 animate-pulse"}`}),xi?"Online":"Offline Mode"]}),l.jsx("button",{onClick:Rr,className:"text-sm font-medium text-gray-500 hover:text-red-500 dark:text-gray-400",children:"Sign Out"})]})]}),t&&l.jsx(oF,{user:t}),l.jsx("main",{className:"flex-1 p-4 max-w-4xl mx-auto w-full",children:t?l.jsxs("div",{children:[l.jsx("div",{className:"mb-8",children:l.jsx("div",{className:"flex gap-4 overflow-x-auto pb-4 snap-x",children:Ht.map((j,K)=>{const Q=a===j.id,fe=So[K%So.length],ze={"stkitts-sugar-mas":"Sugar Mas",stcroix:"St. Croix Carnival",trinidad:"Trinidad Carnival",dominica:"Mas Domnik",jamaica:"Jamaica Carnival",tampa:"Tampa Bay Carnival",stmaarten:"St. Maarten Carnival","cayman-batabano":"Cayman Carnival Batabano",stthomas:"St. Thomas Carnival",atlanta:"Atlanta Caribbean Carnival",guyana:"Guyana Independence",bahamas:"Bahamas Carnival",bermuda:"Bermuda Carnival",hollywood:"Hollywood Carnival",caymas:"Caymas Carnival",vincymas:"Vincy Mas",stlucia:"Saint Lucia Carnival",toronto:"Toronto Caribbean Carnival",barbados:"Crop Over",nevis:"Nevis Culturama",antigua:"Antigua Carnival",grenada:"Spice Mas","ny-labor-day":"New York Carnival",japan:"Japan Caribbean Carnival",miami:"Miami Carnival",tobago:"Tobago Carnival"}[j.id]||j.name,Ve=Kp.find(Qt=>Qt.name.toLowerCase().includes(ze.toLowerCase())||ze.toLowerCase().includes(Qt.name.split("(")[0].trim().toLowerCase()));let Dt=null;if(Ve){const Qt=new Date,bs=new Date(Qt.getFullYear(),Qt.getMonth(),Qt.getDate()),[ks,Oo,Dr]=Ve.date.split("-").map(Number),hn=new Date(ks,Oo-1,Dr);hn>=bs&&(Dt=Math.round((hn-bs)/(1e3*60*60*24)))}return l.jsx("div",{onClick:()=>Oa(j.id,`${j.name} - ${Yr[j.monthIndex]}`),className:`snap-center min-w-[200px] cursor-pointer rounded-2xl p-5 shadow-lg relative overflow-hidden transition-all duration-300 ${Q?"ring-4 ring-offset-2 ring-blue-400 scale-105":"hover:scale-105 opacity-90"} ${fe}`,children:l.jsxs("div",{className:"relative z-10 text-white",children:[l.jsx("h4",{className:"font-bold text-lg leading-tight mb-1",children:j.name}),l.jsx("p",{className:"text-xs font-medium uppercase tracking-wider opacity-90",children:Yr[j.monthIndex]}),Ve&&l.jsx("p",{className:"text-xs font-medium opacity-80 mt-1",children:new Date(Ve.date+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),Dt!==null&&l.jsxs("div",{className:"mt-2 bg-white/20 backdrop-blur-sm rounded-lg px-2 py-1 inline-block",children:[l.jsx("span",{className:"text-lg font-black",children:Dt}),l.jsx("span",{className:"text-xs ml-1 opacity-90",children:"days"})]})]})},j.id)})})}),ye?l.jsxs(l.Fragment,{children:[l.jsx(Qb,{user:t,activeCarnivalId:a,carnivalData:Kp,scrapedEvents:Tn,squadMembers:ve,budgetTotal:2e4,budgetSpent:ei,isPremium:g,onAction:m}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-100 dark:border-gray-700 overflow-hidden transition-colors",children:[!g&&l.jsxs("div",{className:"bg-gradient-to-r from-yellow-400 via-orange-500 to-pink-500 p-4 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:"text-2xl",children:""}),l.jsxs("div",{children:[l.jsx("p",{className:"text-white font-bold text-sm",children:"Unlock Premium Features"}),l.jsx("p",{className:"text-white/80 text-xs",children:"Go ad-free and get a Premium badge!"})]})]}),l.jsx("button",{onClick:()=>m("Info"),className:"px-4 py-2 bg-white text-orange-600 font-bold text-sm rounded-full hover:bg-gray-100 transition",children:"Upgrade"})]}),!g&&l.jsx("div",{className:"border-b border-gray-100 dark:border-gray-700",children:l.jsx(gh,{placement:"banner",onUpgradeClick:()=>m("Info")})}),l.jsx("div",{className:"flex border-b border-gray-100 dark:border-gray-700 overflow-x-auto scrollbar-hide",children:["Budget","Costume","Bands","Schedule","Squad","Passport","Packing","Map","Media","Profile","Creator","Info"].filter(j=>g||!["Map","Media","Passport","Creator"].includes(j)).map(j=>l.jsxs("button",{onClick:()=>{console.log("Switching to tab:",j,"isPremium:",g),m(j)},className:`flex-shrink-0 px-3 sm:px-4 py-3 sm:py-4 text-xs sm:text-sm font-medium transition-colors relative whitespace-nowrap ${d===j?"text-blue-600 dark:text-blue-400 bg-blue-50/50 dark:bg-blue-900/20":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"}`,children:[j,["Map","Media","Passport"].includes(j)&&l.jsx("span",{className:"ml-1 text-xs text-yellow-500",children:""}),d===j&&l.jsx("div",{className:"absolute bottom-0 left-0 w-full h-0.5 bg-blue-600 dark:bg-blue-400"})]},j))}),kt&&l.jsxs("div",{className:"bg-gradient-to-r from-green-500 to-teal-500 px-4 py-2 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-white text-lg",children:""}),l.jsxs("div",{children:[l.jsx("p",{className:"text-white font-medium text-sm",children:"Squad Mode Active"}),l.jsxs("p",{className:"text-white/80 text-xs",children:["Changes sync with ",ve.length," squad member(s)"]})]})]}),l.jsx("button",{onClick:Co,disabled:Bn,className:"px-3 py-1 bg-white/20 text-white text-xs font-medium rounded-full hover:bg-white/30 transition disabled:opacity-50",children:Bn?"Syncing...":"Refresh"})]}),l.jsxs("div",{className:"p-6",children:[d==="Budget"&&l.jsxs("div",{className:"animate-fadeIn",children:[l.jsxs("div",{className:"flex justify-between items-end mb-6",children:[l.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-white",children:"Budget"}),l.jsxs("div",{className:"text-right",children:[l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total Estimate"}),l.jsxs("p",{className:"text-2xl font-black text-green-600 dark:text-green-400",children:["$",ei.toFixed(2)]})]})]}),l.jsx("div",{className:"space-y-3 mb-6",children:(ye.budget||[]).map(j=>{var K;return l.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 dark:bg-gray-700 rounded-lg group hover:bg-gray-100 dark:hover:bg-gray-600",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-200",children:j.name}),j.addedBy&&kt&&l.jsxs("span",{className:"ml-2 text-xs text-gray-400 dark:text-gray-500",children:["by ",((K=j.addedBy.email)==null?void 0:K.split("@")[0])||"squad member"]})]}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("span",{className:"font-bold text-gray-900 dark:text-white",children:["$",j.cost.toFixed(2)]}),l.jsx("button",{onClick:()=>Va(j.id),className:"text-gray-400 hover:text-red-500",children:""})]})]},j.id)})}),l.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[l.jsxs("div",{className:"flex gap-2 flex-1",children:[l.jsx("input",{type:"text",placeholder:"Item",value:z,onChange:j=>Z(j.target.value),className:"flex-[2] p-3 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm"}),l.jsx("input",{type:"number",placeholder:"0.00",value:H,onChange:j=>I(j.target.value),className:"flex-1 p-3 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm"})]}),l.jsx("button",{onClick:Ro,className:"w-full sm:w-auto px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium",children:"Add"})]}),!g&&l.jsx("div",{className:"mt-6 pt-4 border-t border-gray-100 dark:border-gray-700",children:l.jsx(gh,{placement:"inline",onUpgradeClick:()=>m("Info")})})]}),d==="Bands"&&l.jsx("div",{className:"animate-fadeIn",children:l.jsx(B3,{carnivalId:a})}),d==="Costume"&&l.jsxs("div",{className:"animate-fadeIn",children:[l.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-white mb-4",children:"Mas Costume"}),l.jsxs("div",{className:"bg-pink-50 dark:bg-pink-900/20 p-6 rounded-xl border border-pink-100 dark:border-pink-900 mb-4",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-pink-800 dark:text-pink-300 uppercase mb-1",children:"Band Name"}),l.jsx("input",{type:"text",className:"w-full p-2 border border-pink-200 dark:border-pink-800 rounded dark:bg-gray-700 dark:text-white",value:G.band||((lt=ye.costume)==null?void 0:lt.band)||"",onChange:j=>le({...G,band:j.target.value}),placeholder:"e.g. Tribe, Bliss..."})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-pink-800 dark:text-pink-300 uppercase mb-1",children:"Section"}),l.jsx("input",{type:"text",className:"w-full p-2 border border-pink-200 dark:border-pink-800 rounded dark:bg-gray-700 dark:text-white",value:G.section||((ws=ye.costume)==null?void 0:ws.section)||"",onChange:j=>le({...G,section:j.target.value}),placeholder:"e.g. The Monarch"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-pink-800 dark:text-pink-300 uppercase mb-1",children:"Total Cost"}),l.jsx("input",{type:"number",className:"w-full p-2 border border-pink-200 dark:border-pink-800 rounded dark:bg-gray-700 dark:text-white",value:G.total||((Sn=ye.costume)==null?void 0:Sn.total)||"",onChange:j=>le({...G,total:j.target.value}),placeholder:"0.00"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-pink-800 dark:text-pink-300 uppercase mb-1",children:"Amount Paid"}),l.jsx("input",{type:"number",className:"w-full p-2 border border-pink-200 dark:border-pink-800 rounded dark:bg-gray-700 dark:text-white",value:G.paid||((pt=ye.costume)==null?void 0:pt.paid)||"",onChange:j=>le({...G,paid:j.target.value}),placeholder:"0.00"})]})]}),l.jsx("button",{onClick:Mo,className:"mt-4 w-full py-2 bg-pink-600 text-white font-bold rounded hover:bg-pink-700",children:"Save Details"})]})]}),d==="Schedule"&&l.jsxs("div",{className:"animate-fadeIn",children:[l.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-white mb-4",children:"Itinerary"}),Lr.length>0&&l.jsxs("div",{className:"mb-6",children:[l.jsx("p",{className:"text-xs font-bold text-gray-400 uppercase mb-2",children:"Popular Events (Click to Add)"}),l.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:Lr.map((j,K)=>l.jsxs("button",{onClick:()=>jo(j),className:"min-w-[140px] p-3 text-left rounded-lg border transition bg-blue-50 dark:bg-blue-900/30 border-blue-100 dark:border-blue-800 hover:bg-blue-100 dark:hover:bg-blue-800",children:[l.jsx("div",{className:"font-bold text-blue-900 dark:text-blue-300 text-sm",children:j.title}),l.jsx("div",{className:"text-xs text-blue-700 dark:text-blue-400 opacity-75 truncate",children:j.note})]},K))})]}),g?l.jsxs("div",{className:"mb-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsxs("p",{className:"text-xs font-bold text-emerald-600 dark:text-emerald-400 uppercase flex items-center gap-1",children:[l.jsx("span",{className:"inline-block w-2 h-2 bg-emerald-500 rounded-full animate-pulse"}),"Live Events from Fete Sites"]}),Qr&&l.jsxs("span",{className:"text-xs text-gray-400",children:["Updated: ",new Date(Qr).toLocaleDateString()]})]}),ys?l.jsxs("div",{className:"text-center py-4 text-gray-500 dark:text-gray-400",children:[l.jsx("div",{className:"animate-spin inline-block w-5 h-5 border-2 border-emerald-500 border-t-transparent rounded-full mb-2"}),l.jsx("p",{className:"text-sm",children:"Loading live events..."})]}):Tn.length>0?l.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:Tn.slice(0,10).map((j,K)=>l.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gradient-to-r from-emerald-50 to-teal-50 dark:from-emerald-900/20 dark:to-teal-900/20 border border-emerald-200 dark:border-emerald-800 rounded-lg hover:shadow-md transition",children:[j.image&&l.jsx("img",{src:j.image,alt:"",className:"w-12 h-12 rounded object-cover flex-shrink-0"}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("h5",{className:"font-bold text-emerald-900 dark:text-emerald-300 text-sm truncate",children:j.title}),j.date&&l.jsxs("p",{className:"text-xs text-emerald-700 dark:text-emerald-400",children:[new Date(j.date+"T00:00:00").toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"}),j.time&&` at ${j.time}`]}),j.venue&&l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:j.venue}),l.jsxs("p",{className:"text-xs text-gray-400",children:["via ",j.source]})]}),l.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[j.url&&l.jsx("a",{href:j.url,target:"_blank",rel:"noopener noreferrer",className:"px-2 py-1 text-xs bg-emerald-600 text-white rounded hover:bg-emerald-700",children:"Tickets"}),l.jsx("button",{onClick:()=>jo({title:j.title,note:j.venue||`via ${j.source}`}),className:"px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700",children:"+ Add"})]})]},j.id||K))}):l.jsxs("div",{className:"text-center py-4 bg-emerald-50 dark:bg-emerald-900/20 rounded-lg border border-emerald-200 dark:border-emerald-800",children:[l.jsx("p",{className:"text-sm text-emerald-700 dark:text-emerald-400",children:"No live events found for this carnival yet."}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Events are updated daily from fetelist.com & frontlineticketing.com"})]})]}):l.jsx("div",{className:"mb-6 p-4 bg-gradient-to-r from-amber-50 to-orange-50 dark:from-amber-900/20 dark:to-orange-900/20 border border-amber-200 dark:border-amber-800 rounded-xl",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:"text-2xl",children:""}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"font-bold text-amber-900 dark:text-amber-300",children:"Unlock Live Event Listings"}),l.jsx("p",{className:"text-xs text-amber-700 dark:text-amber-400",children:"Premium members get daily-updated fete listings from fetelist.com & frontlineticketing.com"})]}),l.jsx("button",{onClick:()=>m("Info"),className:"px-3 py-2 bg-gradient-to-r from-amber-500 to-orange-500 text-white text-sm font-bold rounded-lg hover:opacity-90 flex-shrink-0",children:"Upgrade"})]})}),l.jsx("div",{className:"space-y-4 mb-6",children:(ye.schedule||[]).map(j=>{var K;return l.jsxs("div",{className:"flex gap-4 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg border-l-4 border-blue-400 relative group",children:[l.jsxs("div",{className:"text-center min-w-[60px]",children:[l.jsx("span",{className:"block text-xs font-bold text-gray-500 dark:text-gray-400 uppercase",children:new Date(j.datetime).toLocaleDateString(void 0,{month:"short"})}),l.jsx("span",{className:"block text-xl font-black text-gray-800 dark:text-white",children:new Date(j.datetime).getDate()}),l.jsx("span",{className:"block text-xs text-gray-500 dark:text-gray-400",children:new Date(j.datetime).toLocaleTimeString(void 0,{hour:"numeric",minute:"2-digit"})})]}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h4",{className:"font-bold text-gray-800 dark:text-white",children:j.title}),j.note&&l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-1",children:j.note}),j.addedBy&&kt&&l.jsxs("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:["Added by ",((K=j.addedBy.email)==null?void 0:K.split("@")[0])||"squad member"]})]}),l.jsx("button",{onClick:()=>vs(j.id),className:"absolute top-2 right-2 text-gray-400 hover:text-red-500 opacity-0 group-hover:opacity-100",children:""})]},j.id)})}),l.jsx("div",{className:"mb-6",children:l.jsx(M3,{onScheduleDetected:async j=>{if(console.log("Voice Command:",j),!t)return;const K={name:j.name,date:j.day+" "+j.time,note:j.note,completed:!1};try{await createScheduleItem(t,a,K);const Q={...i},fe=Q[a];fe&&(fe.schedule=[...fe.schedule||[],{id:Date.now().toString(),...K}],o(Q)),alert(`Added: ${j.name}`)}catch(Q){console.error("Voice Add Failed",Q),alert("Could not add voice event.")}}})}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[l.jsx("input",{type:"text",placeholder:"Event Name (e.g. Scorch, Tribe)",value:b,onChange:j=>R(j.target.value),className:"p-3 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white"}),l.jsx("input",{type:"text",placeholder:"Date/Time (e.g. Fri 2PM)",value:D,onChange:j=>O(j.target.value),className:"p-3 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white"}),l.jsx("input",{type:"text",placeholder:"Type (Fete, Mas, transport...)",value:B,onChange:j=>M(j.target.value),className:"md:col-span-2 p-3 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white"}),l.jsx("button",{onClick:_s,className:"md:col-span-2 py-2 bg-blue-600 text-white rounded font-medium hover:bg-blue-700",children:"Add Event"})]})]}),d==="Squad"&&l.jsxs("div",{className:"animate-fadeIn",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-white",children:"Your Squad"}),l.jsxs("span",{className:"text-sm bg-purple-100 text-purple-800 px-2 py-1 rounded-full",children:[((Si=ye.squad)==null?void 0:Si.length)||0," members"]})]}),l.jsxs("div",{className:"bg-gradient-to-r from-gray-900 to-gray-800 text-white rounded-xl p-4 mb-6 shadow-lg border border-gray-700",children:[l.jsxs("div",{className:"flex justify-between items-start mb-4",children:[l.jsxs("div",{children:[l.jsxs("h4",{className:"font-bold text-lg flex items-center gap-2",children:[l.jsx("span",{children:""})," Road Mode: Offline Chat"]}),l.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Mesh chat for when cell service dies. Open Bitchat and join your squad channel."})]}),l.jsx("span",{className:"bg-blue-600 text-[10px] font-bold px-2 py-1 rounded uppercase tracking-wider",children:"No Data Needed"})]}),!a||!se?l.jsx("div",{className:"text-center py-4 bg-white/5 rounded-lg border border-white/10",children:l.jsx("p",{className:"text-sm text-gray-300",children:"Create or join a squad to enable offline comms."})}):l.jsxs("div",{className:"space-y-4",children:[(()=>{const K=`#CP-${se.id.slice(0,8).toUpperCase()}`;return l.jsxs("div",{className:"bg-black/30 p-4 rounded-lg border border-white/10",children:[l.jsx("p",{className:"text-[10px] uppercase text-gray-400 font-bold mb-2",children:"Join this channel in Bitchat"}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("p",{className:"font-mono text-2xl font-bold text-blue-400 tracking-wider select-all flex-1",children:K}),l.jsx("button",{onClick:()=>{navigator.clipboard.writeText(K),Vn("Channel name copied!")},className:"px-3 py-2 bg-blue-600 hover:bg-blue-500 text-white text-sm font-bold rounded-lg transition-colors",children:"Copy"})]})]})})(),l.jsxs("div",{className:"flex flex-wrap gap-2 justify-center",children:[l.jsxs("a",{href:"https://apps.apple.com/us/app/bitchat-mesh/id6748219622",target:"_blank",rel:"noopener noreferrer",className:"px-3 py-2 bg-white/10 hover:bg-white/20 text-white text-xs font-medium rounded-lg transition-colors flex items-center gap-2",children:[l.jsx("span",{children:""})," iOS App"]}),l.jsxs("a",{href:"https://play.google.com/store/apps/details?id=com.bitchat.droid",target:"_blank",rel:"noopener noreferrer",className:"px-3 py-2 bg-white/10 hover:bg-white/20 text-white text-xs font-medium rounded-lg transition-colors flex items-center gap-2",children:[l.jsx("span",{children:""})," Android App"]})]})]})]}),l.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 border border-purple-200 dark:border-purple-800 rounded-xl p-4 mb-4",children:[l.jsxs("h4",{className:"font-bold text-purple-800 dark:text-purple-300 mb-3 flex items-center gap-2",children:[l.jsx("span",{children:""})," Squad Sharing"]}),ft&&l.jsx("div",{className:"mb-3 p-2 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 rounded text-sm",children:ft}),$t&&l.jsx("div",{className:"mb-3 p-2 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 rounded text-sm",children:$t}),l.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-3",children:[l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Share your carnival plan with friends:"}),te?l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-2xl font-mono font-bold text-purple-600 dark:text-purple-400 tracking-wider",children:te}),l.jsx("button",{onClick:Do,className:"text-sm bg-purple-100 dark:bg-purple-900/50 text-purple-700 dark:text-purple-300 px-3 py-1 rounded hover:bg-purple-200",children:"Copy"})]}):l.jsx("button",{onClick:cs,disabled:Pt,className:"w-full py-2 bg-purple-600 text-white rounded font-medium hover:bg-purple-700 disabled:opacity-50",children:Pt?"Creating...":"Start a Squad"})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-3",children:[l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Join a friend's squad:"}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{type:"text",placeholder:"Enter 6-digit code",value:de,onChange:j=>pe(j.target.value.toUpperCase().slice(0,6)),className:"flex-1 p-2 border rounded font-mono text-center tracking-wider uppercase dark:bg-gray-700 dark:border-gray-600 dark:text-white",maxLength:6}),l.jsx("button",{onClick:us,disabled:cn||de.length!==6,className:"bg-pink-600 text-white px-4 rounded hover:bg-pink-700 disabled:opacity-50",children:cn?"...":"Join"})]})]})]}),se&&l.jsx("div",{className:"mt-4 text-center",children:l.jsx("button",{onClick:Ma,className:"text-sm text-red-500 hover:text-red-700 underline",children:"Leave Squad"})})]}),g&&l.jsx("div",{className:"mt-4 pt-4 border-t border-purple-200 dark:border-purple-700",children:l.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:bt,onChange:j=>Ft(j.target.checked),className:"w-5 h-5 text-purple-600 rounded"}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-purple-800 dark:text-purple-300",children:"Notify squad when I go Road Ready"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Send push notification to squad members"})]}),l.jsx("span",{className:"ml-auto text-xs bg-yellow-100 text-yellow-800 px-2 py-0.5 rounded-full",children:"Premium"})]})}),ve.length>0&&l.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-green-200 dark:border-green-800 rounded-xl p-4 mb-4",children:[l.jsx("div",{className:"flex items-center justify-between mb-3",children:l.jsxs("h4",{className:"font-medium text-green-700 dark:text-green-400 flex items-center gap-2",children:[l.jsx("span",{children:""})," Connected Squad Members"]})}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-3",children:'These users joined using your share code and can see this carnival plan. Click "Refresh" to check for new members.'}),l.jsx("div",{className:"flex flex-wrap gap-2",children:ve.map((j,K)=>{var Q;return l.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 rounded-full border ${j.role==="leader"?"bg-yellow-50 dark:bg-yellow-900/30 border-yellow-200 dark:border-yellow-800":"bg-green-50 dark:bg-green-900/30 border-green-200 dark:border-green-800"}`,children:[l.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-white text-sm font-bold",children:(j.name||j.email||j.uid||"?").charAt(0).toUpperCase()}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:`font-medium text-sm ${j.role==="leader"?"text-yellow-800 dark:text-yellow-300":"text-green-800 dark:text-green-300"}`,children:j.name||j.email||`User ${(Q=j.uid)==null?void 0:Q.slice(0,6)}...`}),l.jsx("span",{className:`text-xs ${j.role==="leader"?"text-yellow-600 dark:text-yellow-400":"text-green-600 dark:text-green-400"}`,children:j.role==="leader"?" Leader":" Member"})]}),(se==null?void 0:se.leaderId)===(t==null?void 0:t.uid)&&j.role!=="leader"&&j.uid&&l.jsx("button",{onClick:()=>ds(j.uid,j.name||j.email||"this member"),className:"ml-auto text-red-400 hover:text-red-600 hover:bg-red-100 dark:hover:bg-red-900/30 rounded-full p-1 transition-colors",title:"Remove from squad",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},j.uid||K)})})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl p-4 mb-4",children:[l.jsx("h4",{className:"font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Quick Add (Offline List)"}),l.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-4",children:[l.jsx("input",{type:"text",placeholder:"Add friend's name",value:me,onChange:j=>we(j.target.value),className:"flex-1 p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm"}),l.jsx("button",{onClick:Ei,className:"w-full sm:w-auto bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700 font-medium",children:"Add"})]}),l.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[ve.map(j=>l.jsxs("div",{className:"flex items-center gap-2 bg-purple-50 dark:bg-purple-900/30 px-3 py-1 rounded-full border border-purple-100 dark:border-purple-800",children:[l.jsx("span",{className:"text-purple-900 dark:text-purple-200 font-medium",children:j.name}),l.jsx("button",{onClick:()=>Jr(j.id),className:"text-purple-400 hover:text-red-500 text-xs font-bold",children:""})]},j.id)),(ye.squad||[]).length===0&&l.jsx("p",{className:"text-gray-400 italic text-sm",children:"No squad members added yet. Riding solo?"})]})]}),l.jsx("div",{className:"mt-8 mb-8",children:l.jsx(C3,{squadId:se==null?void 0:se.id,user:t,isDemoMode:n})}),!g&&l.jsx("div",{className:"mt-4",children:l.jsx(gh,{placement:"inline",onUpgradeClick:()=>m("Info")})})]}),d==="Packing"&&l.jsxs("div",{className:"animate-fadeIn",children:[l.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-white mb-4",children:"Packing List"}),l.jsx("div",{className:"space-y-2 mb-6",children:(ye.packing||[]).map(j=>l.jsxs("div",{className:"flex items-center justify-between p-3 bg-white dark:bg-gray-700 border border-gray-100 dark:border-gray-600 shadow-sm rounded-lg",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("input",{type:"checkbox",checked:j.checked,onChange:()=>Ti(j.id),className:"w-5 h-5 text-blue-600 rounded"}),l.jsx("span",{className:`text-gray-700 dark:text-gray-200 ${j.checked?"line-through opacity-50":""}`,children:j.item})]}),l.jsx("button",{onClick:()=>jr(j.id),className:"text-gray-400 hover:text-red-500",children:""})]},j.id))}),l.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[l.jsx("input",{type:"text",placeholder:"Item",value:ee,onChange:j=>ce(j.target.value),className:"flex-1 p-3 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm"}),l.jsx("button",{onClick:Lo,className:"w-full sm:w-auto px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium",children:"Add"})]}),!g&&l.jsx("div",{className:"mt-6 pt-4 border-t border-gray-100 dark:border-gray-700",children:l.jsx(gh,{placement:"inline",onUpgradeClick:()=>m("Info")})})]}),d==="Map"&&g&&l.jsx("div",{className:"animate-fadeIn",children:l.jsx(S3,{locations:ye.mapLocations||[],scrapedEvents:Tn,onLocationsChange:j=>tt("mapLocations",j),carnivalName:ye.name,carnivalId:a})}),d==="Passport"&&g&&l.jsx("div",{className:"animate-fadeIn",children:l.jsx(Y3,{user:t,activeCarnivalId:a})}),d==="Media"&&g&&l.jsx("div",{className:"animate-fadeIn",children:l.jsx(A3,{files:ye.mediaFiles||[],onFilesChange:j=>tt("mediaFiles",j),carnivalName:ye.name,carnivalId:a,userId:t.uid})}),d==="Profile"&&l.jsx("div",{className:"animate-fadeIn",children:l.jsx(tF,{profileData:ms||{displayName:(t==null?void 0:t.displayName)||"Carnival Lover",bio:"",isPublic:!1,carnivalHistory:Object.entries(i||{}).filter(([j,K])=>{var Q;return(Q=K==null?void 0:K.costume)==null?void 0:Q.band}).map(([j,K])=>{var Q,fe;return{carnivalId:j,year:new Date().getFullYear(),band:(Q=K.costume)==null?void 0:Q.band,section:(fe=K.costume)==null?void 0:fe.section}})},isOwnProfile:!0,onEdit:()=>Ar(!0),currentUser:t})}),d==="Creator"&&g&&l.jsx("div",{className:"animate-fadeIn",children:l.jsx(iF,{user:t,isPremium:g})}),d==="Info"&&l.jsxs("div",{className:"animate-fadeIn text-center",children:[l.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-gray-800 text-white rounded-2xl p-8 mb-6 shadow-xl",children:[l.jsx("img",{src:fh,alt:"Logo",className:"w-20 h-20 mx-auto mb-4"}),l.jsx("h2",{className:"text-2xl font-bold mb-2",children:g?"Premium Supporter":"Support the App"}),l.jsx("p",{className:"text-gray-400 mb-6",children:g?"Thank you for supporting Carnival Planner!":"All features are free! Premium removes ads and shows your support."}),l.jsxs("button",{onClick:Xr,className:"flex items-center justify-center gap-2 mx-auto px-6 py-3 rounded-full font-bold transition-colors bg-white text-gray-900 hover:bg-gray-100",children:[l.jsx("span",{children:""})," Export Itinerary"]})]}),!g&&l.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/10 border border-yellow-200 dark:border-yellow-800 rounded-xl p-6",children:[l.jsx("h3",{className:"font-bold text-yellow-800 dark:text-yellow-400 mb-2",children:"Become a Premium Supporter"}),l.jsx("p",{className:"text-yellow-700 dark:text-yellow-500 text-sm mb-4",children:"Get an ad-free experience and a Premium badge to show your support!"}),l.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[l.jsx("button",{onClick:()=>No("monthly"),disabled:T,className:"px-4 py-2 bg-blue-600 text-white font-bold rounded shadow hover:bg-blue-700 disabled:opacity-50",children:T?"Loading...":"Monthly - $4.99"}),l.jsx("button",{onClick:()=>No("yearly"),disabled:T,className:"px-4 py-2 bg-yellow-400 text-yellow-900 font-bold rounded shadow hover:bg-yellow-500 disabled:opacity-50",children:T?"Loading...":"Yearly - $39.99"})]})]}),l.jsx("div",{className:"mt-6",children:l.jsx(Q3,{user:t})}),(t==null?void 0:t.email)==="djkrss1@gmail.com"&&l.jsxs("div",{className:"mt-6 text-left space-y-8",children:[l.jsx(O3,{}),l.jsx(Z3,{}),l.jsx(U3,{})]})]})]})]})]}):l.jsx(Qb,{user:t,activeCarnivalId:null,carnivalData:Kp,scrapedEvents:Tn,squadMembers:[],budgetTotal:0,budgetSpent:0,isPremium:g,onAction:m})]}):l.jsx("div",{className:"flex flex-col items-center justify-center min-h-[60vh] text-center px-4",children:gs?l.jsx(sF,{onBack:()=>wi(!1),onSuccess:()=>wi(!1)}):l.jsxs(l.Fragment,{children:[l.jsx("h2",{className:"text-3xl font-bold mb-6 text-gray-800 dark:text-white",children:"Welcome Back"}),l.jsxs("div",{className:"space-y-3 w-full max-w-sm",children:[l.jsxs("button",{onClick:Te,className:"w-full flex items-center justify-center px-6 py-3 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-lg shadow-sm hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-800 dark:text-white transition-colors",children:[l.jsx("img",{src:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg",className:"w-5 h-5 mr-3",alt:"G"}),"Continue with Google"]}),l.jsxs("div",{className:"flex items-center gap-3 text-gray-400 dark:text-gray-500",children:[l.jsx("div",{className:"flex-1 h-px bg-gray-300 dark:bg-gray-600"}),l.jsx("span",{className:"text-sm",children:"or"}),l.jsx("div",{className:"flex-1 h-px bg-gray-300 dark:bg-gray-600"})]}),l.jsx("button",{onClick:()=>wi(!0),className:"w-full flex items-center justify-center px-6 py-3 bg-gradient-to-r from-pink-500 to-orange-500 rounded-lg shadow-sm hover:opacity-90 text-white font-semibold transition-opacity",children:"Continue with Email"})]}),l.jsx("button",{onClick:()=>E(!0),className:"mt-6 text-sm text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300",children:"Back to home"})]})})}),l.jsx("footer",{className:"bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 py-6 px-4 mt-auto",children:l.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[l.jsxs("div",{className:"flex flex-wrap justify-center gap-3 text-sm text-gray-500 dark:text-gray-400",children:[l.jsx("button",{onClick:()=>Fn("privacy"),className:"hover:text-gray-900 dark:hover:text-white transition-colors",children:"Privacy"}),l.jsx("span",{children:"|"}),l.jsx("button",{onClick:()=>Fn("terms"),className:"hover:text-gray-900 dark:hover:text-white transition-colors",children:"Terms"}),l.jsx("span",{children:"|"}),l.jsx("button",{onClick:()=>Fn("cookies"),className:"hover:text-gray-900 dark:hover:text-white transition-colors",children:"Cookies"}),l.jsx("span",{children:"|"}),l.jsx("button",{onClick:()=>Fn("refund"),className:"hover:text-gray-900 dark:hover:text-white transition-colors",children:"Refunds"}),l.jsx("span",{children:"|"}),l.jsx("button",{onClick:()=>Fn("contact"),className:"hover:text-gray-900 dark:hover:text-white transition-colors",children:"Contact"}),l.jsx("span",{children:"|"}),l.jsx("button",{onClick:()=>Zr(!0),className:"hover:text-gray-900 dark:hover:text-white transition-colors font-medium",children:"Help"})]}),l.jsxs("p",{className:"text-gray-400 dark:text-gray-500 text-xs mt-3",children:[" ",new Date().getFullYear()," Carnival Planner"]})]})}),t&&l.jsx(L3,{activeCarnivalId:a,isPremium:g}),hs&&l.jsx(J3,{onClose:()=>{fs(!1),localStorage.setItem("carnival-planner-welcomed","true")}}),hc&&l.jsx(X3,{onClose:()=>Zr(!1)}),To&&l.jsx(nF,{user:t,currentProfile:ms,carnivals:i,onSave:j=>ps(j),onClose:()=>Ar(!1)})]})}Zp.createRoot(document.getElementById("root")).render(l.jsx(Hh.StrictMode,{children:l.jsx(fF,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(t=>{console.log("SW registered:",t.scope)}).catch(t=>{console.log("SW registration failed:",t)})});
