(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var FP=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ob(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Vb={exports:{}},Lf={},Fb={exports:{}},ze={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hu=Symbol.for("react.element"),UP=Symbol.for("react.portal"),BP=Symbol.for("react.fragment"),zP=Symbol.for("react.strict_mode"),qP=Symbol.for("react.profiler"),$P=Symbol.for("react.provider"),HP=Symbol.for("react.context"),WP=Symbol.for("react.forward_ref"),GP=Symbol.for("react.suspense"),KP=Symbol.for("react.memo"),ZP=Symbol.for("react.lazy"),h0=Symbol.iterator;function QP(t){return t===null||typeof t!="object"?null:(t=h0&&t[h0]||t["@@iterator"],typeof t=="function"?t:null)}var Ub={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Bb=Object.assign,zb={};function Hl(t,e,n){this.props=t,this.context=e,this.refs=zb,this.updater=n||Ub}Hl.prototype.isReactComponent={};Hl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Hl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function qb(){}qb.prototype=Hl.prototype;function py(t,e,n){this.props=t,this.context=e,this.refs=zb,this.updater=n||Ub}var gy=py.prototype=new qb;gy.constructor=py;Bb(gy,Hl.prototype);gy.isPureReactComponent=!0;var f0=Array.isArray,$b=Object.prototype.hasOwnProperty,yy={current:null},Hb={key:!0,ref:!0,__self:!0,__source:!0};function Wb(t,e,n){var r,i={},o=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(o=""+e.key),e)$b.call(e,r)&&!Hb.hasOwnProperty(r)&&(i[r]=e[r]);var u=arguments.length-2;if(u===1)i.children=n;else if(1<u){for(var h=Array(u),m=0;m<u;m++)h[m]=arguments[m+2];i.children=h}if(t&&t.defaultProps)for(r in u=t.defaultProps,u)i[r]===void 0&&(i[r]=u[r]);return{$$typeof:Hu,type:t,key:o,ref:a,props:i,_owner:yy.current}}function YP(t,e){return{$$typeof:Hu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function _y(t){return typeof t=="object"&&t!==null&&t.$$typeof===Hu}function JP(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var m0=/\/+/g;function $m(t,e){return typeof t=="object"&&t!==null&&t.key!=null?JP(""+t.key):e.toString(36)}function ch(t,e,n,r,i){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(o){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Hu:case UP:a=!0}}if(a)return a=t,i=i(a),t=r===""?"."+$m(a,0):r,f0(i)?(n="",t!=null&&(n=t.replace(m0,"$&/")+"/"),ch(i,e,n,"",function(m){return m})):i!=null&&(_y(i)&&(i=YP(i,n+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(m0,"$&/")+"/")+t)),e.push(i)),1;if(a=0,r=r===""?".":r+":",f0(t))for(var u=0;u<t.length;u++){o=t[u];var h=r+$m(o,u);a+=ch(o,e,n,h,i)}else if(h=QP(t),typeof h=="function")for(t=h.call(t),u=0;!(o=t.next()).done;)o=o.value,h=r+$m(o,u++),a+=ch(o,e,n,h,i);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function jd(t,e,n){if(t==null)return t;var r=[],i=0;return ch(t,r,"","",function(o){return e.call(n,o,i++)}),r}function XP(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Nn={current:null},uh={transition:null},eN={ReactCurrentDispatcher:Nn,ReactCurrentBatchConfig:uh,ReactCurrentOwner:yy};function Gb(){throw Error("act(...) is not supported in production builds of React.")}ze.Children={map:jd,forEach:function(t,e,n){jd(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return jd(t,function(){e++}),e},toArray:function(t){return jd(t,function(e){return e})||[]},only:function(t){if(!_y(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ze.Component=Hl;ze.Fragment=BP;ze.Profiler=qP;ze.PureComponent=py;ze.StrictMode=zP;ze.Suspense=GP;ze.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eN;ze.act=Gb;ze.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Bb({},t.props),i=t.key,o=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,a=yy.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(h in e)$b.call(e,h)&&!Hb.hasOwnProperty(h)&&(r[h]=e[h]===void 0&&u!==void 0?u[h]:e[h])}var h=arguments.length-2;if(h===1)r.children=n;else if(1<h){u=Array(h);for(var m=0;m<h;m++)u[m]=arguments[m+2];r.children=u}return{$$typeof:Hu,type:t.type,key:i,ref:o,props:r,_owner:a}};ze.createContext=function(t){return t={$$typeof:HP,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:$P,_context:t},t.Consumer=t};ze.createElement=Wb;ze.createFactory=function(t){var e=Wb.bind(null,t);return e.type=t,e};ze.createRef=function(){return{current:null}};ze.forwardRef=function(t){return{$$typeof:WP,render:t}};ze.isValidElement=_y;ze.lazy=function(t){return{$$typeof:ZP,_payload:{_status:-1,_result:t},_init:XP}};ze.memo=function(t,e){return{$$typeof:KP,type:t,compare:e===void 0?null:e}};ze.startTransition=function(t){var e=uh.transition;uh.transition={};try{t()}finally{uh.transition=e}};ze.unstable_act=Gb;ze.useCallback=function(t,e){return Nn.current.useCallback(t,e)};ze.useContext=function(t){return Nn.current.useContext(t)};ze.useDebugValue=function(){};ze.useDeferredValue=function(t){return Nn.current.useDeferredValue(t)};ze.useEffect=function(t,e){return Nn.current.useEffect(t,e)};ze.useId=function(){return Nn.current.useId()};ze.useImperativeHandle=function(t,e,n){return Nn.current.useImperativeHandle(t,e,n)};ze.useInsertionEffect=function(t,e){return Nn.current.useInsertionEffect(t,e)};ze.useLayoutEffect=function(t,e){return Nn.current.useLayoutEffect(t,e)};ze.useMemo=function(t,e){return Nn.current.useMemo(t,e)};ze.useReducer=function(t,e,n){return Nn.current.useReducer(t,e,n)};ze.useRef=function(t){return Nn.current.useRef(t)};ze.useState=function(t){return Nn.current.useState(t)};ze.useSyncExternalStore=function(t,e,n){return Nn.current.useSyncExternalStore(t,e,n)};ze.useTransition=function(){return Nn.current.useTransition()};ze.version="18.3.1";Fb.exports=ze;var B=Fb.exports;const Mh=Ob(B);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tN=B,nN=Symbol.for("react.element"),rN=Symbol.for("react.fragment"),iN=Object.prototype.hasOwnProperty,sN=tN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,oN={key:!0,ref:!0,__self:!0,__source:!0};function Kb(t,e,n){var r,i={},o=null,a=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)iN.call(e,r)&&!oN.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:nN,type:t,key:o,ref:a,props:i,_owner:sN.current}}Lf.Fragment=rN;Lf.jsx=Kb;Lf.jsxs=Kb;Vb.exports=Lf;var c=Vb.exports,Vp={},Zb={exports:{}},lr={},Qb={exports:{}},Yb={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(K,ce){var X=K.length;K.push(ce);e:for(;0<X;){var we=X-1>>>1,ue=K[we];if(0<i(ue,ce))K[we]=ce,K[X]=ue,X=we;else break e}}function n(K){return K.length===0?null:K[0]}function r(K){if(K.length===0)return null;var ce=K[0],X=K.pop();if(X!==ce){K[0]=X;e:for(var we=0,ue=K.length,me=ue>>>1;we<me;){var _e=2*(we+1)-1,fe=K[_e],de=_e+1,De=K[de];if(0>i(fe,X))de<ue&&0>i(De,fe)?(K[we]=De,K[de]=X,we=de):(K[we]=fe,K[_e]=X,we=_e);else if(de<ue&&0>i(De,X))K[we]=De,K[de]=X,we=de;else break e}}return ce}function i(K,ce){var X=K.sortIndex-ce.sortIndex;return X!==0?X:K.id-ce.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,u=a.now();t.unstable_now=function(){return a.now()-u}}var h=[],m=[],y=1,v=null,w=3,S=!1,N=!1,P=!1,F=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function A(K){for(var ce=n(m);ce!==null;){if(ce.callback===null)r(m);else if(ce.startTime<=K)r(m),ce.sortIndex=ce.expirationTime,e(h,ce);else break;ce=n(m)}}function z(K){if(P=!1,A(K),!N)if(n(h)!==null)N=!0,Ce(G);else{var ce=n(m);ce!==null&&Re(z,ce.startTime-K)}}function G(K,ce){N=!1,P&&(P=!1,R(b),b=-1),S=!0;var X=w;try{for(A(ce),v=n(h);v!==null&&(!(v.expirationTime>ce)||K&&!V());){var we=v.callback;if(typeof we=="function"){v.callback=null,w=v.priorityLevel;var ue=we(v.expirationTime<=ce);ce=t.unstable_now(),typeof ue=="function"?v.callback=ue:v===n(h)&&r(h),A(ce)}else r(h);v=n(h)}if(v!==null)var me=!0;else{var _e=n(m);_e!==null&&Re(z,_e.startTime-ce),me=!1}return me}finally{v=null,w=X,S=!1}}var W=!1,T=null,b=-1,C=5,D=-1;function V(){return!(t.unstable_now()-D<C)}function U(){if(T!==null){var K=t.unstable_now();D=K;var ce=!0;try{ce=T(!0,K)}finally{ce?M():(W=!1,T=null)}}else W=!1}var M;if(typeof k=="function")M=function(){k(U)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,Ee=le.port2;le.port1.onmessage=U,M=function(){Ee.postMessage(null)}}else M=function(){F(U,0)};function Ce(K){T=K,W||(W=!0,M())}function Re(K,ce){b=F(function(){K(t.unstable_now())},ce)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(K){K.callback=null},t.unstable_continueExecution=function(){N||S||(N=!0,Ce(G))},t.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<K?Math.floor(1e3/K):5},t.unstable_getCurrentPriorityLevel=function(){return w},t.unstable_getFirstCallbackNode=function(){return n(h)},t.unstable_next=function(K){switch(w){case 1:case 2:case 3:var ce=3;break;default:ce=w}var X=w;w=ce;try{return K()}finally{w=X}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(K,ce){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var X=w;w=K;try{return ce()}finally{w=X}},t.unstable_scheduleCallback=function(K,ce,X){var we=t.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?we+X:we):X=we,K){case 1:var ue=-1;break;case 2:ue=250;break;case 5:ue=1073741823;break;case 4:ue=1e4;break;default:ue=5e3}return ue=X+ue,K={id:y++,callback:ce,priorityLevel:K,startTime:X,expirationTime:ue,sortIndex:-1},X>we?(K.sortIndex=X,e(m,K),n(h)===null&&K===n(m)&&(P?(R(b),b=-1):P=!0,Re(z,X-we))):(K.sortIndex=ue,e(h,K),N||S||(N=!0,Ce(G))),K},t.unstable_shouldYield=V,t.unstable_wrapCallback=function(K){var ce=w;return function(){var X=w;w=ce;try{return K.apply(this,arguments)}finally{w=X}}}})(Yb);Qb.exports=Yb;var aN=Qb.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lN=B,sr=aN;function ie(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Jb=new Set,du={};function aa(t,e){bl(t,e),bl(t+"Capture",e)}function bl(t,e){for(du[t]=e,t=0;t<e.length;t++)Jb.add(e[t])}var Qi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Fp=Object.prototype.hasOwnProperty,cN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p0={},g0={};function uN(t){return Fp.call(g0,t)?!0:Fp.call(p0,t)?!1:cN.test(t)?g0[t]=!0:(p0[t]=!0,!1)}function dN(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function hN(t,e,n,r){if(e===null||typeof e>"u"||dN(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function An(t,e,n,r,i,o,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=a}var on={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){on[t]=new An(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];on[e]=new An(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){on[t]=new An(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){on[t]=new An(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){on[t]=new An(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){on[t]=new An(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){on[t]=new An(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){on[t]=new An(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){on[t]=new An(t,5,!1,t.toLowerCase(),null,!1,!1)});var vy=/[\-:]([a-z])/g;function xy(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(vy,xy);on[e]=new An(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(vy,xy);on[e]=new An(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(vy,xy);on[e]=new An(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){on[t]=new An(t,1,!1,t.toLowerCase(),null,!1,!1)});on.xlinkHref=new An("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){on[t]=new An(t,1,!1,t.toLowerCase(),null,!0,!0)});function wy(t,e,n,r){var i=on.hasOwnProperty(e)?on[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(hN(e,n,i,r)&&(n=null),r||i===null?uN(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var is=lN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ld=Symbol.for("react.element"),Ja=Symbol.for("react.portal"),Xa=Symbol.for("react.fragment"),by=Symbol.for("react.strict_mode"),Up=Symbol.for("react.profiler"),Xb=Symbol.for("react.provider"),eI=Symbol.for("react.context"),Iy=Symbol.for("react.forward_ref"),Bp=Symbol.for("react.suspense"),zp=Symbol.for("react.suspense_list"),Ty=Symbol.for("react.memo"),Ns=Symbol.for("react.lazy"),tI=Symbol.for("react.offscreen"),y0=Symbol.iterator;function wc(t){return t===null||typeof t!="object"?null:(t=y0&&t[y0]||t["@@iterator"],typeof t=="function"?t:null)}var St=Object.assign,Hm;function Oc(t){if(Hm===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Hm=e&&e[1]||""}return`
`+Hm+t}var Wm=!1;function Gm(t,e){if(!t||Wm)return"";Wm=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(m){var r=m}Reflect.construct(t,[],e)}else{try{e.call()}catch(m){r=m}t.call(e.prototype)}else{try{throw Error()}catch(m){r=m}t()}}catch(m){if(m&&r&&typeof m.stack=="string"){for(var i=m.stack.split(`
`),o=r.stack.split(`
`),a=i.length-1,u=o.length-1;1<=a&&0<=u&&i[a]!==o[u];)u--;for(;1<=a&&0<=u;a--,u--)if(i[a]!==o[u]){if(a!==1||u!==1)do if(a--,u--,0>u||i[a]!==o[u]){var h=`
`+i[a].replace(" at new "," at ");return t.displayName&&h.includes("<anonymous>")&&(h=h.replace("<anonymous>",t.displayName)),h}while(1<=a&&0<=u);break}}}finally{Wm=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Oc(t):""}function fN(t){switch(t.tag){case 5:return Oc(t.type);case 16:return Oc("Lazy");case 13:return Oc("Suspense");case 19:return Oc("SuspenseList");case 0:case 2:case 15:return t=Gm(t.type,!1),t;case 11:return t=Gm(t.type.render,!1),t;case 1:return t=Gm(t.type,!0),t;default:return""}}function qp(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Xa:return"Fragment";case Ja:return"Portal";case Up:return"Profiler";case by:return"StrictMode";case Bp:return"Suspense";case zp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case eI:return(t.displayName||"Context")+".Consumer";case Xb:return(t._context.displayName||"Context")+".Provider";case Iy:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Ty:return e=t.displayName||null,e!==null?e:qp(t.type)||"Memo";case Ns:e=t._payload,t=t._init;try{return qp(t(e))}catch{}}return null}function mN(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return qp(e);case 8:return e===by?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Xs(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function nI(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function pN(t){var e=nI(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){r=""+a,o.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Dd(t){t._valueTracker||(t._valueTracker=pN(t))}function rI(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=nI(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Oh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function $p(t,e){var n=e.checked;return St({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function _0(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Xs(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function iI(t,e){e=e.checked,e!=null&&wy(t,"checked",e,!1)}function Hp(t,e){iI(t,e);var n=Xs(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Wp(t,e.type,n):e.hasOwnProperty("defaultValue")&&Wp(t,e.type,Xs(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function v0(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Wp(t,e,n){(e!=="number"||Oh(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Vc=Array.isArray;function dl(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Xs(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Gp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ie(91));return St({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function x0(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ie(92));if(Vc(n)){if(1<n.length)throw Error(ie(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Xs(n)}}function sI(t,e){var n=Xs(e.value),r=Xs(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function w0(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function oI(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Kp(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?oI(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Md,aI=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Md=Md||document.createElement("div"),Md.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Md.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function hu(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Gc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},gN=["Webkit","ms","Moz","O"];Object.keys(Gc).forEach(function(t){gN.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Gc[e]=Gc[t]})});function lI(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Gc.hasOwnProperty(t)&&Gc[t]?(""+e).trim():e+"px"}function cI(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=lI(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var yN=St({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Zp(t,e){if(e){if(yN[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ie(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ie(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ie(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ie(62))}}function Qp(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Yp=null;function Ey(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Jp=null,hl=null,fl=null;function b0(t){if(t=Ku(t)){if(typeof Jp!="function")throw Error(ie(280));var e=t.stateNode;e&&(e=Ff(e),Jp(t.stateNode,t.type,e))}}function uI(t){hl?fl?fl.push(t):fl=[t]:hl=t}function dI(){if(hl){var t=hl,e=fl;if(fl=hl=null,b0(t),e)for(t=0;t<e.length;t++)b0(e[t])}}function hI(t,e){return t(e)}function fI(){}var Km=!1;function mI(t,e,n){if(Km)return t(e,n);Km=!0;try{return hI(t,e,n)}finally{Km=!1,(hl!==null||fl!==null)&&(fI(),dI())}}function fu(t,e){var n=t.stateNode;if(n===null)return null;var r=Ff(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ie(231,e,typeof n));return n}var Xp=!1;if(Qi)try{var bc={};Object.defineProperty(bc,"passive",{get:function(){Xp=!0}}),window.addEventListener("test",bc,bc),window.removeEventListener("test",bc,bc)}catch{Xp=!1}function _N(t,e,n,r,i,o,a,u,h){var m=Array.prototype.slice.call(arguments,3);try{e.apply(n,m)}catch(y){this.onError(y)}}var Kc=!1,Vh=null,Fh=!1,eg=null,vN={onError:function(t){Kc=!0,Vh=t}};function xN(t,e,n,r,i,o,a,u,h){Kc=!1,Vh=null,_N.apply(vN,arguments)}function wN(t,e,n,r,i,o,a,u,h){if(xN.apply(this,arguments),Kc){if(Kc){var m=Vh;Kc=!1,Vh=null}else throw Error(ie(198));Fh||(Fh=!0,eg=m)}}function la(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function pI(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function I0(t){if(la(t)!==t)throw Error(ie(188))}function bN(t){var e=t.alternate;if(!e){if(e=la(t),e===null)throw Error(ie(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return I0(i),t;if(o===r)return I0(i),e;o=o.sibling}throw Error(ie(188))}if(n.return!==r.return)n=i,r=o;else{for(var a=!1,u=i.child;u;){if(u===n){a=!0,n=i,r=o;break}if(u===r){a=!0,r=i,n=o;break}u=u.sibling}if(!a){for(u=o.child;u;){if(u===n){a=!0,n=o,r=i;break}if(u===r){a=!0,r=o,n=i;break}u=u.sibling}if(!a)throw Error(ie(189))}}if(n.alternate!==r)throw Error(ie(190))}if(n.tag!==3)throw Error(ie(188));return n.stateNode.current===n?t:e}function gI(t){return t=bN(t),t!==null?yI(t):null}function yI(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=yI(t);if(e!==null)return e;t=t.sibling}return null}var _I=sr.unstable_scheduleCallback,T0=sr.unstable_cancelCallback,IN=sr.unstable_shouldYield,TN=sr.unstable_requestPaint,Mt=sr.unstable_now,EN=sr.unstable_getCurrentPriorityLevel,ky=sr.unstable_ImmediatePriority,vI=sr.unstable_UserBlockingPriority,Uh=sr.unstable_NormalPriority,kN=sr.unstable_LowPriority,xI=sr.unstable_IdlePriority,Df=null,pi=null;function SN(t){if(pi&&typeof pi.onCommitFiberRoot=="function")try{pi.onCommitFiberRoot(Df,t,void 0,(t.current.flags&128)===128)}catch{}}var $r=Math.clz32?Math.clz32:AN,PN=Math.log,NN=Math.LN2;function AN(t){return t>>>=0,t===0?32:31-(PN(t)/NN|0)|0}var Od=64,Vd=4194304;function Fc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Bh(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,o=t.pingedLanes,a=n&268435455;if(a!==0){var u=a&~i;u!==0?r=Fc(u):(o&=a,o!==0&&(r=Fc(o)))}else a=n&~i,a!==0?r=Fc(a):o!==0&&(r=Fc(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,o=e&-e,i>=o||i===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-$r(e),i=1<<n,r|=t[n],e&=~i;return r}function CN(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function RN(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,o=t.pendingLanes;0<o;){var a=31-$r(o),u=1<<a,h=i[a];h===-1?(!(u&n)||u&r)&&(i[a]=CN(u,e)):h<=e&&(t.expiredLanes|=u),o&=~u}}function tg(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function wI(){var t=Od;return Od<<=1,!(Od&4194240)&&(Od=64),t}function Zm(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Wu(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-$r(e),t[e]=n}function jN(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-$r(n),o=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~o}}function Sy(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-$r(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var it=0;function bI(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var II,Py,TI,EI,kI,ng=!1,Fd=[],qs=null,$s=null,Hs=null,mu=new Map,pu=new Map,Cs=[],LN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function E0(t,e){switch(t){case"focusin":case"focusout":qs=null;break;case"dragenter":case"dragleave":$s=null;break;case"mouseover":case"mouseout":Hs=null;break;case"pointerover":case"pointerout":mu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":pu.delete(e.pointerId)}}function Ic(t,e,n,r,i,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},e!==null&&(e=Ku(e),e!==null&&Py(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function DN(t,e,n,r,i){switch(e){case"focusin":return qs=Ic(qs,t,e,n,r,i),!0;case"dragenter":return $s=Ic($s,t,e,n,r,i),!0;case"mouseover":return Hs=Ic(Hs,t,e,n,r,i),!0;case"pointerover":var o=i.pointerId;return mu.set(o,Ic(mu.get(o)||null,t,e,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,pu.set(o,Ic(pu.get(o)||null,t,e,n,r,i)),!0}return!1}function SI(t){var e=Ro(t.target);if(e!==null){var n=la(e);if(n!==null){if(e=n.tag,e===13){if(e=pI(n),e!==null){t.blockedOn=e,kI(t.priority,function(){TI(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function dh(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=rg(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Yp=r,n.target.dispatchEvent(r),Yp=null}else return e=Ku(n),e!==null&&Py(e),t.blockedOn=n,!1;e.shift()}return!0}function k0(t,e,n){dh(t)&&n.delete(e)}function MN(){ng=!1,qs!==null&&dh(qs)&&(qs=null),$s!==null&&dh($s)&&($s=null),Hs!==null&&dh(Hs)&&(Hs=null),mu.forEach(k0),pu.forEach(k0)}function Tc(t,e){t.blockedOn===e&&(t.blockedOn=null,ng||(ng=!0,sr.unstable_scheduleCallback(sr.unstable_NormalPriority,MN)))}function gu(t){function e(i){return Tc(i,t)}if(0<Fd.length){Tc(Fd[0],t);for(var n=1;n<Fd.length;n++){var r=Fd[n];r.blockedOn===t&&(r.blockedOn=null)}}for(qs!==null&&Tc(qs,t),$s!==null&&Tc($s,t),Hs!==null&&Tc(Hs,t),mu.forEach(e),pu.forEach(e),n=0;n<Cs.length;n++)r=Cs[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Cs.length&&(n=Cs[0],n.blockedOn===null);)SI(n),n.blockedOn===null&&Cs.shift()}var ml=is.ReactCurrentBatchConfig,zh=!0;function ON(t,e,n,r){var i=it,o=ml.transition;ml.transition=null;try{it=1,Ny(t,e,n,r)}finally{it=i,ml.transition=o}}function VN(t,e,n,r){var i=it,o=ml.transition;ml.transition=null;try{it=4,Ny(t,e,n,r)}finally{it=i,ml.transition=o}}function Ny(t,e,n,r){if(zh){var i=rg(t,e,n,r);if(i===null)sp(t,e,r,qh,n),E0(t,r);else if(DN(i,t,e,n,r))r.stopPropagation();else if(E0(t,r),e&4&&-1<LN.indexOf(t)){for(;i!==null;){var o=Ku(i);if(o!==null&&II(o),o=rg(t,e,n,r),o===null&&sp(t,e,r,qh,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else sp(t,e,r,null,n)}}var qh=null;function rg(t,e,n,r){if(qh=null,t=Ey(r),t=Ro(t),t!==null)if(e=la(t),e===null)t=null;else if(n=e.tag,n===13){if(t=pI(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return qh=t,null}function PI(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(EN()){case ky:return 1;case vI:return 4;case Uh:case kN:return 16;case xI:return 536870912;default:return 16}default:return 16}}var Fs=null,Ay=null,hh=null;function NI(){if(hh)return hh;var t,e=Ay,n=e.length,r,i="value"in Fs?Fs.value:Fs.textContent,o=i.length;for(t=0;t<n&&e[t]===i[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===i[o-r];r++);return hh=i.slice(t,1<r?1-r:void 0)}function fh(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ud(){return!0}function S0(){return!1}function cr(t){function e(n,r,i,o,a){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=a,this.currentTarget=null;for(var u in t)t.hasOwnProperty(u)&&(n=t[u],this[u]=n?n(o):o[u]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Ud:S0,this.isPropagationStopped=S0,this}return St(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ud)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ud)},persist:function(){},isPersistent:Ud}),e}var Wl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Cy=cr(Wl),Gu=St({},Wl,{view:0,detail:0}),FN=cr(Gu),Qm,Ym,Ec,Mf=St({},Gu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ry,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ec&&(Ec&&t.type==="mousemove"?(Qm=t.screenX-Ec.screenX,Ym=t.screenY-Ec.screenY):Ym=Qm=0,Ec=t),Qm)},movementY:function(t){return"movementY"in t?t.movementY:Ym}}),P0=cr(Mf),UN=St({},Mf,{dataTransfer:0}),BN=cr(UN),zN=St({},Gu,{relatedTarget:0}),Jm=cr(zN),qN=St({},Wl,{animationName:0,elapsedTime:0,pseudoElement:0}),$N=cr(qN),HN=St({},Wl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),WN=cr(HN),GN=St({},Wl,{data:0}),N0=cr(GN),KN={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ZN={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},QN={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function YN(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=QN[t])?!!e[t]:!1}function Ry(){return YN}var JN=St({},Gu,{key:function(t){if(t.key){var e=KN[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=fh(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?ZN[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ry,charCode:function(t){return t.type==="keypress"?fh(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?fh(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),XN=cr(JN),eA=St({},Mf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),A0=cr(eA),tA=St({},Gu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ry}),nA=cr(tA),rA=St({},Wl,{propertyName:0,elapsedTime:0,pseudoElement:0}),iA=cr(rA),sA=St({},Mf,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),oA=cr(sA),aA=[9,13,27,32],jy=Qi&&"CompositionEvent"in window,Zc=null;Qi&&"documentMode"in document&&(Zc=document.documentMode);var lA=Qi&&"TextEvent"in window&&!Zc,AI=Qi&&(!jy||Zc&&8<Zc&&11>=Zc),C0=" ",R0=!1;function CI(t,e){switch(t){case"keyup":return aA.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function RI(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var el=!1;function cA(t,e){switch(t){case"compositionend":return RI(e);case"keypress":return e.which!==32?null:(R0=!0,C0);case"textInput":return t=e.data,t===C0&&R0?null:t;default:return null}}function uA(t,e){if(el)return t==="compositionend"||!jy&&CI(t,e)?(t=NI(),hh=Ay=Fs=null,el=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return AI&&e.locale!=="ko"?null:e.data;default:return null}}var dA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function j0(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!dA[t.type]:e==="textarea"}function jI(t,e,n,r){uI(r),e=$h(e,"onChange"),0<e.length&&(n=new Cy("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Qc=null,yu=null;function hA(t){$I(t,0)}function Of(t){var e=rl(t);if(rI(e))return t}function fA(t,e){if(t==="change")return e}var LI=!1;if(Qi){var Xm;if(Qi){var ep="oninput"in document;if(!ep){var L0=document.createElement("div");L0.setAttribute("oninput","return;"),ep=typeof L0.oninput=="function"}Xm=ep}else Xm=!1;LI=Xm&&(!document.documentMode||9<document.documentMode)}function D0(){Qc&&(Qc.detachEvent("onpropertychange",DI),yu=Qc=null)}function DI(t){if(t.propertyName==="value"&&Of(yu)){var e=[];jI(e,yu,t,Ey(t)),mI(hA,e)}}function mA(t,e,n){t==="focusin"?(D0(),Qc=e,yu=n,Qc.attachEvent("onpropertychange",DI)):t==="focusout"&&D0()}function pA(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Of(yu)}function gA(t,e){if(t==="click")return Of(e)}function yA(t,e){if(t==="input"||t==="change")return Of(e)}function _A(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Kr=typeof Object.is=="function"?Object.is:_A;function _u(t,e){if(Kr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Fp.call(e,i)||!Kr(t[i],e[i]))return!1}return!0}function M0(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function O0(t,e){var n=M0(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=M0(n)}}function MI(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?MI(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function OI(){for(var t=window,e=Oh();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Oh(t.document)}return e}function Ly(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function vA(t){var e=OI(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&MI(n.ownerDocument.documentElement,n)){if(r!==null&&Ly(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!t.extend&&o>r&&(i=r,r=o,o=i),i=O0(n,o);var a=O0(n,r);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var xA=Qi&&"documentMode"in document&&11>=document.documentMode,tl=null,ig=null,Yc=null,sg=!1;function V0(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;sg||tl==null||tl!==Oh(r)||(r=tl,"selectionStart"in r&&Ly(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Yc&&_u(Yc,r)||(Yc=r,r=$h(ig,"onSelect"),0<r.length&&(e=new Cy("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=tl)))}function Bd(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var nl={animationend:Bd("Animation","AnimationEnd"),animationiteration:Bd("Animation","AnimationIteration"),animationstart:Bd("Animation","AnimationStart"),transitionend:Bd("Transition","TransitionEnd")},tp={},VI={};Qi&&(VI=document.createElement("div").style,"AnimationEvent"in window||(delete nl.animationend.animation,delete nl.animationiteration.animation,delete nl.animationstart.animation),"TransitionEvent"in window||delete nl.transitionend.transition);function Vf(t){if(tp[t])return tp[t];if(!nl[t])return t;var e=nl[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in VI)return tp[t]=e[n];return t}var FI=Vf("animationend"),UI=Vf("animationiteration"),BI=Vf("animationstart"),zI=Vf("transitionend"),qI=new Map,F0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function so(t,e){qI.set(t,e),aa(e,[t])}for(var np=0;np<F0.length;np++){var rp=F0[np],wA=rp.toLowerCase(),bA=rp[0].toUpperCase()+rp.slice(1);so(wA,"on"+bA)}so(FI,"onAnimationEnd");so(UI,"onAnimationIteration");so(BI,"onAnimationStart");so("dblclick","onDoubleClick");so("focusin","onFocus");so("focusout","onBlur");so(zI,"onTransitionEnd");bl("onMouseEnter",["mouseout","mouseover"]);bl("onMouseLeave",["mouseout","mouseover"]);bl("onPointerEnter",["pointerout","pointerover"]);bl("onPointerLeave",["pointerout","pointerover"]);aa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));aa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));aa("onBeforeInput",["compositionend","keypress","textInput","paste"]);aa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));aa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));aa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Uc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),IA=new Set("cancel close invalid load scroll toggle".split(" ").concat(Uc));function U0(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,wN(r,e,void 0,t),t.currentTarget=null}function $I(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var a=r.length-1;0<=a;a--){var u=r[a],h=u.instance,m=u.currentTarget;if(u=u.listener,h!==o&&i.isPropagationStopped())break e;U0(i,u,m),o=h}else for(a=0;a<r.length;a++){if(u=r[a],h=u.instance,m=u.currentTarget,u=u.listener,h!==o&&i.isPropagationStopped())break e;U0(i,u,m),o=h}}}if(Fh)throw t=eg,Fh=!1,eg=null,t}function pt(t,e){var n=e[ug];n===void 0&&(n=e[ug]=new Set);var r=t+"__bubble";n.has(r)||(HI(e,t,2,!1),n.add(r))}function ip(t,e,n){var r=0;e&&(r|=4),HI(n,t,r,e)}var zd="_reactListening"+Math.random().toString(36).slice(2);function vu(t){if(!t[zd]){t[zd]=!0,Jb.forEach(function(n){n!=="selectionchange"&&(IA.has(n)||ip(n,!1,t),ip(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[zd]||(e[zd]=!0,ip("selectionchange",!1,e))}}function HI(t,e,n,r){switch(PI(e)){case 1:var i=ON;break;case 4:i=VN;break;default:i=Ny}n=i.bind(null,e,n,t),i=void 0,!Xp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function sp(t,e,n,r,i){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var u=r.stateNode.containerInfo;if(u===i||u.nodeType===8&&u.parentNode===i)break;if(a===4)for(a=r.return;a!==null;){var h=a.tag;if((h===3||h===4)&&(h=a.stateNode.containerInfo,h===i||h.nodeType===8&&h.parentNode===i))return;a=a.return}for(;u!==null;){if(a=Ro(u),a===null)return;if(h=a.tag,h===5||h===6){r=o=a;continue e}u=u.parentNode}}r=r.return}mI(function(){var m=o,y=Ey(n),v=[];e:{var w=qI.get(t);if(w!==void 0){var S=Cy,N=t;switch(t){case"keypress":if(fh(n)===0)break e;case"keydown":case"keyup":S=XN;break;case"focusin":N="focus",S=Jm;break;case"focusout":N="blur",S=Jm;break;case"beforeblur":case"afterblur":S=Jm;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":S=P0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":S=BN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":S=nA;break;case FI:case UI:case BI:S=$N;break;case zI:S=iA;break;case"scroll":S=FN;break;case"wheel":S=oA;break;case"copy":case"cut":case"paste":S=WN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":S=A0}var P=(e&4)!==0,F=!P&&t==="scroll",R=P?w!==null?w+"Capture":null:w;P=[];for(var k=m,A;k!==null;){A=k;var z=A.stateNode;if(A.tag===5&&z!==null&&(A=z,R!==null&&(z=fu(k,R),z!=null&&P.push(xu(k,z,A)))),F)break;k=k.return}0<P.length&&(w=new S(w,N,null,n,y),v.push({event:w,listeners:P}))}}if(!(e&7)){e:{if(w=t==="mouseover"||t==="pointerover",S=t==="mouseout"||t==="pointerout",w&&n!==Yp&&(N=n.relatedTarget||n.fromElement)&&(Ro(N)||N[Yi]))break e;if((S||w)&&(w=y.window===y?y:(w=y.ownerDocument)?w.defaultView||w.parentWindow:window,S?(N=n.relatedTarget||n.toElement,S=m,N=N?Ro(N):null,N!==null&&(F=la(N),N!==F||N.tag!==5&&N.tag!==6)&&(N=null)):(S=null,N=m),S!==N)){if(P=P0,z="onMouseLeave",R="onMouseEnter",k="mouse",(t==="pointerout"||t==="pointerover")&&(P=A0,z="onPointerLeave",R="onPointerEnter",k="pointer"),F=S==null?w:rl(S),A=N==null?w:rl(N),w=new P(z,k+"leave",S,n,y),w.target=F,w.relatedTarget=A,z=null,Ro(y)===m&&(P=new P(R,k+"enter",N,n,y),P.target=A,P.relatedTarget=F,z=P),F=z,S&&N)t:{for(P=S,R=N,k=0,A=P;A;A=Ba(A))k++;for(A=0,z=R;z;z=Ba(z))A++;for(;0<k-A;)P=Ba(P),k--;for(;0<A-k;)R=Ba(R),A--;for(;k--;){if(P===R||R!==null&&P===R.alternate)break t;P=Ba(P),R=Ba(R)}P=null}else P=null;S!==null&&B0(v,w,S,P,!1),N!==null&&F!==null&&B0(v,F,N,P,!0)}}e:{if(w=m?rl(m):window,S=w.nodeName&&w.nodeName.toLowerCase(),S==="select"||S==="input"&&w.type==="file")var G=fA;else if(j0(w))if(LI)G=yA;else{G=pA;var W=mA}else(S=w.nodeName)&&S.toLowerCase()==="input"&&(w.type==="checkbox"||w.type==="radio")&&(G=gA);if(G&&(G=G(t,m))){jI(v,G,n,y);break e}W&&W(t,w,m),t==="focusout"&&(W=w._wrapperState)&&W.controlled&&w.type==="number"&&Wp(w,"number",w.value)}switch(W=m?rl(m):window,t){case"focusin":(j0(W)||W.contentEditable==="true")&&(tl=W,ig=m,Yc=null);break;case"focusout":Yc=ig=tl=null;break;case"mousedown":sg=!0;break;case"contextmenu":case"mouseup":case"dragend":sg=!1,V0(v,n,y);break;case"selectionchange":if(xA)break;case"keydown":case"keyup":V0(v,n,y)}var T;if(jy)e:{switch(t){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else el?CI(t,n)&&(b="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(b="onCompositionStart");b&&(AI&&n.locale!=="ko"&&(el||b!=="onCompositionStart"?b==="onCompositionEnd"&&el&&(T=NI()):(Fs=y,Ay="value"in Fs?Fs.value:Fs.textContent,el=!0)),W=$h(m,b),0<W.length&&(b=new N0(b,t,null,n,y),v.push({event:b,listeners:W}),T?b.data=T:(T=RI(n),T!==null&&(b.data=T)))),(T=lA?cA(t,n):uA(t,n))&&(m=$h(m,"onBeforeInput"),0<m.length&&(y=new N0("onBeforeInput","beforeinput",null,n,y),v.push({event:y,listeners:m}),y.data=T))}$I(v,e)})}function xu(t,e,n){return{instance:t,listener:e,currentTarget:n}}function $h(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=fu(t,n),o!=null&&r.unshift(xu(t,o,i)),o=fu(t,e),o!=null&&r.push(xu(t,o,i))),t=t.return}return r}function Ba(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function B0(t,e,n,r,i){for(var o=e._reactName,a=[];n!==null&&n!==r;){var u=n,h=u.alternate,m=u.stateNode;if(h!==null&&h===r)break;u.tag===5&&m!==null&&(u=m,i?(h=fu(n,o),h!=null&&a.unshift(xu(n,h,u))):i||(h=fu(n,o),h!=null&&a.push(xu(n,h,u)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var TA=/\r\n?/g,EA=/\u0000|\uFFFD/g;function z0(t){return(typeof t=="string"?t:""+t).replace(TA,`
`).replace(EA,"")}function qd(t,e,n){if(e=z0(e),z0(t)!==e&&n)throw Error(ie(425))}function Hh(){}var og=null,ag=null;function lg(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var cg=typeof setTimeout=="function"?setTimeout:void 0,kA=typeof clearTimeout=="function"?clearTimeout:void 0,q0=typeof Promise=="function"?Promise:void 0,SA=typeof queueMicrotask=="function"?queueMicrotask:typeof q0<"u"?function(t){return q0.resolve(null).then(t).catch(PA)}:cg;function PA(t){setTimeout(function(){throw t})}function op(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),gu(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);gu(e)}function Ws(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function $0(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Gl=Math.random().toString(36).slice(2),di="__reactFiber$"+Gl,wu="__reactProps$"+Gl,Yi="__reactContainer$"+Gl,ug="__reactEvents$"+Gl,NA="__reactListeners$"+Gl,AA="__reactHandles$"+Gl;function Ro(t){var e=t[di];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Yi]||n[di]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=$0(t);t!==null;){if(n=t[di])return n;t=$0(t)}return e}t=n,n=t.parentNode}return null}function Ku(t){return t=t[di]||t[Yi],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function rl(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ie(33))}function Ff(t){return t[wu]||null}var dg=[],il=-1;function oo(t){return{current:t}}function gt(t){0>il||(t.current=dg[il],dg[il]=null,il--)}function dt(t,e){il++,dg[il]=t.current,t.current=e}var eo={},yn=oo(eo),qn=oo(!1),qo=eo;function Il(t,e){var n=t.type.contextTypes;if(!n)return eo;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in n)i[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function $n(t){return t=t.childContextTypes,t!=null}function Wh(){gt(qn),gt(yn)}function H0(t,e,n){if(yn.current!==eo)throw Error(ie(168));dt(yn,e),dt(qn,n)}function WI(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ie(108,mN(t)||"Unknown",i));return St({},n,r)}function Gh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||eo,qo=yn.current,dt(yn,t),dt(qn,qn.current),!0}function W0(t,e,n){var r=t.stateNode;if(!r)throw Error(ie(169));n?(t=WI(t,e,qo),r.__reactInternalMemoizedMergedChildContext=t,gt(qn),gt(yn),dt(yn,t)):gt(qn),dt(qn,n)}var Di=null,Uf=!1,ap=!1;function GI(t){Di===null?Di=[t]:Di.push(t)}function CA(t){Uf=!0,GI(t)}function ao(){if(!ap&&Di!==null){ap=!0;var t=0,e=it;try{var n=Di;for(it=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Di=null,Uf=!1}catch(i){throw Di!==null&&(Di=Di.slice(t+1)),_I(ky,ao),i}finally{it=e,ap=!1}}return null}var sl=[],ol=0,Kh=null,Zh=0,vr=[],xr=0,$o=null,Vi=1,Fi="";function Io(t,e){sl[ol++]=Zh,sl[ol++]=Kh,Kh=t,Zh=e}function KI(t,e,n){vr[xr++]=Vi,vr[xr++]=Fi,vr[xr++]=$o,$o=t;var r=Vi;t=Fi;var i=32-$r(r)-1;r&=~(1<<i),n+=1;var o=32-$r(e)+i;if(30<o){var a=i-i%5;o=(r&(1<<a)-1).toString(32),r>>=a,i-=a,Vi=1<<32-$r(e)+i|n<<i|r,Fi=o+t}else Vi=1<<o|n<<i|r,Fi=t}function Dy(t){t.return!==null&&(Io(t,1),KI(t,1,0))}function My(t){for(;t===Kh;)Kh=sl[--ol],sl[ol]=null,Zh=sl[--ol],sl[ol]=null;for(;t===$o;)$o=vr[--xr],vr[xr]=null,Fi=vr[--xr],vr[xr]=null,Vi=vr[--xr],vr[xr]=null}var rr=null,er=null,vt=!1,Br=null;function ZI(t,e){var n=wr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function G0(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,rr=t,er=Ws(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,rr=t,er=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=$o!==null?{id:Vi,overflow:Fi}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=wr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,rr=t,er=null,!0):!1;default:return!1}}function hg(t){return(t.mode&1)!==0&&(t.flags&128)===0}function fg(t){if(vt){var e=er;if(e){var n=e;if(!G0(t,e)){if(hg(t))throw Error(ie(418));e=Ws(n.nextSibling);var r=rr;e&&G0(t,e)?ZI(r,n):(t.flags=t.flags&-4097|2,vt=!1,rr=t)}}else{if(hg(t))throw Error(ie(418));t.flags=t.flags&-4097|2,vt=!1,rr=t}}}function K0(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;rr=t}function $d(t){if(t!==rr)return!1;if(!vt)return K0(t),vt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!lg(t.type,t.memoizedProps)),e&&(e=er)){if(hg(t))throw QI(),Error(ie(418));for(;e;)ZI(t,e),e=Ws(e.nextSibling)}if(K0(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ie(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){er=Ws(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}er=null}}else er=rr?Ws(t.stateNode.nextSibling):null;return!0}function QI(){for(var t=er;t;)t=Ws(t.nextSibling)}function Tl(){er=rr=null,vt=!1}function Oy(t){Br===null?Br=[t]:Br.push(t)}var RA=is.ReactCurrentBatchConfig;function kc(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ie(309));var r=n.stateNode}if(!r)throw Error(ie(147,t));var i=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(a){var u=i.refs;a===null?delete u[o]:u[o]=a},e._stringRef=o,e)}if(typeof t!="string")throw Error(ie(284));if(!n._owner)throw Error(ie(290,t))}return t}function Hd(t,e){throw t=Object.prototype.toString.call(e),Error(ie(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Z0(t){var e=t._init;return e(t._payload)}function YI(t){function e(R,k){if(t){var A=R.deletions;A===null?(R.deletions=[k],R.flags|=16):A.push(k)}}function n(R,k){if(!t)return null;for(;k!==null;)e(R,k),k=k.sibling;return null}function r(R,k){for(R=new Map;k!==null;)k.key!==null?R.set(k.key,k):R.set(k.index,k),k=k.sibling;return R}function i(R,k){return R=Qs(R,k),R.index=0,R.sibling=null,R}function o(R,k,A){return R.index=A,t?(A=R.alternate,A!==null?(A=A.index,A<k?(R.flags|=2,k):A):(R.flags|=2,k)):(R.flags|=1048576,k)}function a(R){return t&&R.alternate===null&&(R.flags|=2),R}function u(R,k,A,z){return k===null||k.tag!==6?(k=mp(A,R.mode,z),k.return=R,k):(k=i(k,A),k.return=R,k)}function h(R,k,A,z){var G=A.type;return G===Xa?y(R,k,A.props.children,z,A.key):k!==null&&(k.elementType===G||typeof G=="object"&&G!==null&&G.$$typeof===Ns&&Z0(G)===k.type)?(z=i(k,A.props),z.ref=kc(R,k,A),z.return=R,z):(z=xh(A.type,A.key,A.props,null,R.mode,z),z.ref=kc(R,k,A),z.return=R,z)}function m(R,k,A,z){return k===null||k.tag!==4||k.stateNode.containerInfo!==A.containerInfo||k.stateNode.implementation!==A.implementation?(k=pp(A,R.mode,z),k.return=R,k):(k=i(k,A.children||[]),k.return=R,k)}function y(R,k,A,z,G){return k===null||k.tag!==7?(k=Fo(A,R.mode,z,G),k.return=R,k):(k=i(k,A),k.return=R,k)}function v(R,k,A){if(typeof k=="string"&&k!==""||typeof k=="number")return k=mp(""+k,R.mode,A),k.return=R,k;if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Ld:return A=xh(k.type,k.key,k.props,null,R.mode,A),A.ref=kc(R,null,k),A.return=R,A;case Ja:return k=pp(k,R.mode,A),k.return=R,k;case Ns:var z=k._init;return v(R,z(k._payload),A)}if(Vc(k)||wc(k))return k=Fo(k,R.mode,A,null),k.return=R,k;Hd(R,k)}return null}function w(R,k,A,z){var G=k!==null?k.key:null;if(typeof A=="string"&&A!==""||typeof A=="number")return G!==null?null:u(R,k,""+A,z);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case Ld:return A.key===G?h(R,k,A,z):null;case Ja:return A.key===G?m(R,k,A,z):null;case Ns:return G=A._init,w(R,k,G(A._payload),z)}if(Vc(A)||wc(A))return G!==null?null:y(R,k,A,z,null);Hd(R,A)}return null}function S(R,k,A,z,G){if(typeof z=="string"&&z!==""||typeof z=="number")return R=R.get(A)||null,u(k,R,""+z,G);if(typeof z=="object"&&z!==null){switch(z.$$typeof){case Ld:return R=R.get(z.key===null?A:z.key)||null,h(k,R,z,G);case Ja:return R=R.get(z.key===null?A:z.key)||null,m(k,R,z,G);case Ns:var W=z._init;return S(R,k,A,W(z._payload),G)}if(Vc(z)||wc(z))return R=R.get(A)||null,y(k,R,z,G,null);Hd(k,z)}return null}function N(R,k,A,z){for(var G=null,W=null,T=k,b=k=0,C=null;T!==null&&b<A.length;b++){T.index>b?(C=T,T=null):C=T.sibling;var D=w(R,T,A[b],z);if(D===null){T===null&&(T=C);break}t&&T&&D.alternate===null&&e(R,T),k=o(D,k,b),W===null?G=D:W.sibling=D,W=D,T=C}if(b===A.length)return n(R,T),vt&&Io(R,b),G;if(T===null){for(;b<A.length;b++)T=v(R,A[b],z),T!==null&&(k=o(T,k,b),W===null?G=T:W.sibling=T,W=T);return vt&&Io(R,b),G}for(T=r(R,T);b<A.length;b++)C=S(T,R,b,A[b],z),C!==null&&(t&&C.alternate!==null&&T.delete(C.key===null?b:C.key),k=o(C,k,b),W===null?G=C:W.sibling=C,W=C);return t&&T.forEach(function(V){return e(R,V)}),vt&&Io(R,b),G}function P(R,k,A,z){var G=wc(A);if(typeof G!="function")throw Error(ie(150));if(A=G.call(A),A==null)throw Error(ie(151));for(var W=G=null,T=k,b=k=0,C=null,D=A.next();T!==null&&!D.done;b++,D=A.next()){T.index>b?(C=T,T=null):C=T.sibling;var V=w(R,T,D.value,z);if(V===null){T===null&&(T=C);break}t&&T&&V.alternate===null&&e(R,T),k=o(V,k,b),W===null?G=V:W.sibling=V,W=V,T=C}if(D.done)return n(R,T),vt&&Io(R,b),G;if(T===null){for(;!D.done;b++,D=A.next())D=v(R,D.value,z),D!==null&&(k=o(D,k,b),W===null?G=D:W.sibling=D,W=D);return vt&&Io(R,b),G}for(T=r(R,T);!D.done;b++,D=A.next())D=S(T,R,b,D.value,z),D!==null&&(t&&D.alternate!==null&&T.delete(D.key===null?b:D.key),k=o(D,k,b),W===null?G=D:W.sibling=D,W=D);return t&&T.forEach(function(U){return e(R,U)}),vt&&Io(R,b),G}function F(R,k,A,z){if(typeof A=="object"&&A!==null&&A.type===Xa&&A.key===null&&(A=A.props.children),typeof A=="object"&&A!==null){switch(A.$$typeof){case Ld:e:{for(var G=A.key,W=k;W!==null;){if(W.key===G){if(G=A.type,G===Xa){if(W.tag===7){n(R,W.sibling),k=i(W,A.props.children),k.return=R,R=k;break e}}else if(W.elementType===G||typeof G=="object"&&G!==null&&G.$$typeof===Ns&&Z0(G)===W.type){n(R,W.sibling),k=i(W,A.props),k.ref=kc(R,W,A),k.return=R,R=k;break e}n(R,W);break}else e(R,W);W=W.sibling}A.type===Xa?(k=Fo(A.props.children,R.mode,z,A.key),k.return=R,R=k):(z=xh(A.type,A.key,A.props,null,R.mode,z),z.ref=kc(R,k,A),z.return=R,R=z)}return a(R);case Ja:e:{for(W=A.key;k!==null;){if(k.key===W)if(k.tag===4&&k.stateNode.containerInfo===A.containerInfo&&k.stateNode.implementation===A.implementation){n(R,k.sibling),k=i(k,A.children||[]),k.return=R,R=k;break e}else{n(R,k);break}else e(R,k);k=k.sibling}k=pp(A,R.mode,z),k.return=R,R=k}return a(R);case Ns:return W=A._init,F(R,k,W(A._payload),z)}if(Vc(A))return N(R,k,A,z);if(wc(A))return P(R,k,A,z);Hd(R,A)}return typeof A=="string"&&A!==""||typeof A=="number"?(A=""+A,k!==null&&k.tag===6?(n(R,k.sibling),k=i(k,A),k.return=R,R=k):(n(R,k),k=mp(A,R.mode,z),k.return=R,R=k),a(R)):n(R,k)}return F}var El=YI(!0),JI=YI(!1),Qh=oo(null),Yh=null,al=null,Vy=null;function Fy(){Vy=al=Yh=null}function Uy(t){var e=Qh.current;gt(Qh),t._currentValue=e}function mg(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function pl(t,e){Yh=t,Vy=al=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Un=!0),t.firstContext=null)}function Ir(t){var e=t._currentValue;if(Vy!==t)if(t={context:t,memoizedValue:e,next:null},al===null){if(Yh===null)throw Error(ie(308));al=t,Yh.dependencies={lanes:0,firstContext:t}}else al=al.next=t;return e}var jo=null;function By(t){jo===null?jo=[t]:jo.push(t)}function XI(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,By(e)):(n.next=i.next,i.next=n),e.interleaved=n,Ji(t,r)}function Ji(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var As=!1;function zy(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function eT(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Wi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Gs(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ye&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Ji(t,n)}return i=r.interleaved,i===null?(e.next=e,By(r)):(e.next=i.next,i.next=e),r.interleaved=e,Ji(t,n)}function mh(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Sy(t,n)}}function Q0(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?i=o=a:o=o.next=a,n=n.next}while(n!==null);o===null?i=o=e:o=o.next=e}else i=o=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Jh(t,e,n,r){var i=t.updateQueue;As=!1;var o=i.firstBaseUpdate,a=i.lastBaseUpdate,u=i.shared.pending;if(u!==null){i.shared.pending=null;var h=u,m=h.next;h.next=null,a===null?o=m:a.next=m,a=h;var y=t.alternate;y!==null&&(y=y.updateQueue,u=y.lastBaseUpdate,u!==a&&(u===null?y.firstBaseUpdate=m:u.next=m,y.lastBaseUpdate=h))}if(o!==null){var v=i.baseState;a=0,y=m=h=null,u=o;do{var w=u.lane,S=u.eventTime;if((r&w)===w){y!==null&&(y=y.next={eventTime:S,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var N=t,P=u;switch(w=e,S=n,P.tag){case 1:if(N=P.payload,typeof N=="function"){v=N.call(S,v,w);break e}v=N;break e;case 3:N.flags=N.flags&-65537|128;case 0:if(N=P.payload,w=typeof N=="function"?N.call(S,v,w):N,w==null)break e;v=St({},v,w);break e;case 2:As=!0}}u.callback!==null&&u.lane!==0&&(t.flags|=64,w=i.effects,w===null?i.effects=[u]:w.push(u))}else S={eventTime:S,lane:w,tag:u.tag,payload:u.payload,callback:u.callback,next:null},y===null?(m=y=S,h=v):y=y.next=S,a|=w;if(u=u.next,u===null){if(u=i.shared.pending,u===null)break;w=u,u=w.next,w.next=null,i.lastBaseUpdate=w,i.shared.pending=null}}while(!0);if(y===null&&(h=v),i.baseState=h,i.firstBaseUpdate=m,i.lastBaseUpdate=y,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else o===null&&(i.shared.lanes=0);Wo|=a,t.lanes=a,t.memoizedState=v}}function Y0(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ie(191,i));i.call(r)}}}var Zu={},gi=oo(Zu),bu=oo(Zu),Iu=oo(Zu);function Lo(t){if(t===Zu)throw Error(ie(174));return t}function qy(t,e){switch(dt(Iu,e),dt(bu,t),dt(gi,Zu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Kp(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Kp(e,t)}gt(gi),dt(gi,e)}function kl(){gt(gi),gt(bu),gt(Iu)}function tT(t){Lo(Iu.current);var e=Lo(gi.current),n=Kp(e,t.type);e!==n&&(dt(bu,t),dt(gi,n))}function $y(t){bu.current===t&&(gt(gi),gt(bu))}var Et=oo(0);function Xh(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var lp=[];function Hy(){for(var t=0;t<lp.length;t++)lp[t]._workInProgressVersionPrimary=null;lp.length=0}var ph=is.ReactCurrentDispatcher,cp=is.ReactCurrentBatchConfig,Ho=0,kt=null,$t=null,Jt=null,ef=!1,Jc=!1,Tu=0,jA=0;function ln(){throw Error(ie(321))}function Wy(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Kr(t[n],e[n]))return!1;return!0}function Gy(t,e,n,r,i,o){if(Ho=o,kt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ph.current=t===null||t.memoizedState===null?OA:VA,t=n(r,i),Jc){o=0;do{if(Jc=!1,Tu=0,25<=o)throw Error(ie(301));o+=1,Jt=$t=null,e.updateQueue=null,ph.current=FA,t=n(r,i)}while(Jc)}if(ph.current=tf,e=$t!==null&&$t.next!==null,Ho=0,Jt=$t=kt=null,ef=!1,e)throw Error(ie(300));return t}function Ky(){var t=Tu!==0;return Tu=0,t}function li(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Jt===null?kt.memoizedState=Jt=t:Jt=Jt.next=t,Jt}function Tr(){if($t===null){var t=kt.alternate;t=t!==null?t.memoizedState:null}else t=$t.next;var e=Jt===null?kt.memoizedState:Jt.next;if(e!==null)Jt=e,$t=t;else{if(t===null)throw Error(ie(310));$t=t,t={memoizedState:$t.memoizedState,baseState:$t.baseState,baseQueue:$t.baseQueue,queue:$t.queue,next:null},Jt===null?kt.memoizedState=Jt=t:Jt=Jt.next=t}return Jt}function Eu(t,e){return typeof e=="function"?e(t):e}function up(t){var e=Tr(),n=e.queue;if(n===null)throw Error(ie(311));n.lastRenderedReducer=t;var r=$t,i=r.baseQueue,o=n.pending;if(o!==null){if(i!==null){var a=i.next;i.next=o.next,o.next=a}r.baseQueue=i=o,n.pending=null}if(i!==null){o=i.next,r=r.baseState;var u=a=null,h=null,m=o;do{var y=m.lane;if((Ho&y)===y)h!==null&&(h=h.next={lane:0,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null}),r=m.hasEagerState?m.eagerState:t(r,m.action);else{var v={lane:y,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null};h===null?(u=h=v,a=r):h=h.next=v,kt.lanes|=y,Wo|=y}m=m.next}while(m!==null&&m!==o);h===null?a=r:h.next=u,Kr(r,e.memoizedState)||(Un=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=h,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do o=i.lane,kt.lanes|=o,Wo|=o,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function dp(t){var e=Tr(),n=e.queue;if(n===null)throw Error(ie(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,o=e.memoizedState;if(i!==null){n.pending=null;var a=i=i.next;do o=t(o,a.action),a=a.next;while(a!==i);Kr(o,e.memoizedState)||(Un=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function nT(){}function rT(t,e){var n=kt,r=Tr(),i=e(),o=!Kr(r.memoizedState,i);if(o&&(r.memoizedState=i,Un=!0),r=r.queue,Zy(oT.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||Jt!==null&&Jt.memoizedState.tag&1){if(n.flags|=2048,ku(9,sT.bind(null,n,r,i,e),void 0,null),Xt===null)throw Error(ie(349));Ho&30||iT(n,e,i)}return i}function iT(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=kt.updateQueue,e===null?(e={lastEffect:null,stores:null},kt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function sT(t,e,n,r){e.value=n,e.getSnapshot=r,aT(e)&&lT(t)}function oT(t,e,n){return n(function(){aT(e)&&lT(t)})}function aT(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Kr(t,n)}catch{return!0}}function lT(t){var e=Ji(t,1);e!==null&&Hr(e,t,1,-1)}function J0(t){var e=li();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Eu,lastRenderedState:t},e.queue=t,t=t.dispatch=MA.bind(null,kt,t),[e.memoizedState,t]}function ku(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=kt.updateQueue,e===null?(e={lastEffect:null,stores:null},kt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function cT(){return Tr().memoizedState}function gh(t,e,n,r){var i=li();kt.flags|=t,i.memoizedState=ku(1|e,n,void 0,r===void 0?null:r)}function Bf(t,e,n,r){var i=Tr();r=r===void 0?null:r;var o=void 0;if($t!==null){var a=$t.memoizedState;if(o=a.destroy,r!==null&&Wy(r,a.deps)){i.memoizedState=ku(e,n,o,r);return}}kt.flags|=t,i.memoizedState=ku(1|e,n,o,r)}function X0(t,e){return gh(8390656,8,t,e)}function Zy(t,e){return Bf(2048,8,t,e)}function uT(t,e){return Bf(4,2,t,e)}function dT(t,e){return Bf(4,4,t,e)}function hT(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function fT(t,e,n){return n=n!=null?n.concat([t]):null,Bf(4,4,hT.bind(null,e,t),n)}function Qy(){}function mT(t,e){var n=Tr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Wy(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function pT(t,e){var n=Tr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Wy(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function gT(t,e,n){return Ho&21?(Kr(n,e)||(n=wI(),kt.lanes|=n,Wo|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Un=!0),t.memoizedState=n)}function LA(t,e){var n=it;it=n!==0&&4>n?n:4,t(!0);var r=cp.transition;cp.transition={};try{t(!1),e()}finally{it=n,cp.transition=r}}function yT(){return Tr().memoizedState}function DA(t,e,n){var r=Zs(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},_T(t))vT(e,n);else if(n=XI(t,e,n,r),n!==null){var i=kn();Hr(n,t,r,i),xT(n,e,r)}}function MA(t,e,n){var r=Zs(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(_T(t))vT(e,i);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var a=e.lastRenderedState,u=o(a,n);if(i.hasEagerState=!0,i.eagerState=u,Kr(u,a)){var h=e.interleaved;h===null?(i.next=i,By(e)):(i.next=h.next,h.next=i),e.interleaved=i;return}}catch{}finally{}n=XI(t,e,i,r),n!==null&&(i=kn(),Hr(n,t,r,i),xT(n,e,r))}}function _T(t){var e=t.alternate;return t===kt||e!==null&&e===kt}function vT(t,e){Jc=ef=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function xT(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Sy(t,n)}}var tf={readContext:Ir,useCallback:ln,useContext:ln,useEffect:ln,useImperativeHandle:ln,useInsertionEffect:ln,useLayoutEffect:ln,useMemo:ln,useReducer:ln,useRef:ln,useState:ln,useDebugValue:ln,useDeferredValue:ln,useTransition:ln,useMutableSource:ln,useSyncExternalStore:ln,useId:ln,unstable_isNewReconciler:!1},OA={readContext:Ir,useCallback:function(t,e){return li().memoizedState=[t,e===void 0?null:e],t},useContext:Ir,useEffect:X0,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,gh(4194308,4,hT.bind(null,e,t),n)},useLayoutEffect:function(t,e){return gh(4194308,4,t,e)},useInsertionEffect:function(t,e){return gh(4,2,t,e)},useMemo:function(t,e){var n=li();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=li();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=DA.bind(null,kt,t),[r.memoizedState,t]},useRef:function(t){var e=li();return t={current:t},e.memoizedState=t},useState:J0,useDebugValue:Qy,useDeferredValue:function(t){return li().memoizedState=t},useTransition:function(){var t=J0(!1),e=t[0];return t=LA.bind(null,t[1]),li().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=kt,i=li();if(vt){if(n===void 0)throw Error(ie(407));n=n()}else{if(n=e(),Xt===null)throw Error(ie(349));Ho&30||iT(r,e,n)}i.memoizedState=n;var o={value:n,getSnapshot:e};return i.queue=o,X0(oT.bind(null,r,o,t),[t]),r.flags|=2048,ku(9,sT.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=li(),e=Xt.identifierPrefix;if(vt){var n=Fi,r=Vi;n=(r&~(1<<32-$r(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Tu++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=jA++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},VA={readContext:Ir,useCallback:mT,useContext:Ir,useEffect:Zy,useImperativeHandle:fT,useInsertionEffect:uT,useLayoutEffect:dT,useMemo:pT,useReducer:up,useRef:cT,useState:function(){return up(Eu)},useDebugValue:Qy,useDeferredValue:function(t){var e=Tr();return gT(e,$t.memoizedState,t)},useTransition:function(){var t=up(Eu)[0],e=Tr().memoizedState;return[t,e]},useMutableSource:nT,useSyncExternalStore:rT,useId:yT,unstable_isNewReconciler:!1},FA={readContext:Ir,useCallback:mT,useContext:Ir,useEffect:Zy,useImperativeHandle:fT,useInsertionEffect:uT,useLayoutEffect:dT,useMemo:pT,useReducer:dp,useRef:cT,useState:function(){return dp(Eu)},useDebugValue:Qy,useDeferredValue:function(t){var e=Tr();return $t===null?e.memoizedState=t:gT(e,$t.memoizedState,t)},useTransition:function(){var t=dp(Eu)[0],e=Tr().memoizedState;return[t,e]},useMutableSource:nT,useSyncExternalStore:rT,useId:yT,unstable_isNewReconciler:!1};function Fr(t,e){if(t&&t.defaultProps){e=St({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function pg(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:St({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var zf={isMounted:function(t){return(t=t._reactInternals)?la(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=kn(),i=Zs(t),o=Wi(r,i);o.payload=e,n!=null&&(o.callback=n),e=Gs(t,o,i),e!==null&&(Hr(e,t,i,r),mh(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=kn(),i=Zs(t),o=Wi(r,i);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=Gs(t,o,i),e!==null&&(Hr(e,t,i,r),mh(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=kn(),r=Zs(t),i=Wi(n,r);i.tag=2,e!=null&&(i.callback=e),e=Gs(t,i,r),e!==null&&(Hr(e,t,r,n),mh(e,t,r))}};function ex(t,e,n,r,i,o,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,a):e.prototype&&e.prototype.isPureReactComponent?!_u(n,r)||!_u(i,o):!0}function wT(t,e,n){var r=!1,i=eo,o=e.contextType;return typeof o=="object"&&o!==null?o=Ir(o):(i=$n(e)?qo:yn.current,r=e.contextTypes,o=(r=r!=null)?Il(t,i):eo),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=zf,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function tx(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&zf.enqueueReplaceState(e,e.state,null)}function gg(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},zy(t);var o=e.contextType;typeof o=="object"&&o!==null?i.context=Ir(o):(o=$n(e)?qo:yn.current,i.context=Il(t,o)),i.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(pg(t,e,o,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&zf.enqueueReplaceState(i,i.state,null),Jh(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Sl(t,e){try{var n="",r=e;do n+=fN(r),r=r.return;while(r);var i=n}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:i,digest:null}}function hp(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function yg(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var UA=typeof WeakMap=="function"?WeakMap:Map;function bT(t,e,n){n=Wi(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){rf||(rf=!0,Sg=r),yg(t,e)},n}function IT(t,e,n){n=Wi(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){yg(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){yg(t,e),typeof r!="function"&&(Ks===null?Ks=new Set([this]):Ks.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function nx(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new UA;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=eC.bind(null,t,e,n),e.then(t,t))}function rx(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function ix(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Wi(-1,1),e.tag=2,Gs(n,e,1))),n.lanes|=1),t)}var BA=is.ReactCurrentOwner,Un=!1;function Tn(t,e,n,r){e.child=t===null?JI(e,null,n,r):El(e,t.child,n,r)}function sx(t,e,n,r,i){n=n.render;var o=e.ref;return pl(e,i),r=Gy(t,e,n,r,o,i),n=Ky(),t!==null&&!Un?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Xi(t,e,i)):(vt&&n&&Dy(e),e.flags|=1,Tn(t,e,r,i),e.child)}function ox(t,e,n,r,i){if(t===null){var o=n.type;return typeof o=="function"&&!i_(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,TT(t,e,o,r,i)):(t=xh(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&i)){var a=o.memoizedProps;if(n=n.compare,n=n!==null?n:_u,n(a,r)&&t.ref===e.ref)return Xi(t,e,i)}return e.flags|=1,t=Qs(o,r),t.ref=e.ref,t.return=e,e.child=t}function TT(t,e,n,r,i){if(t!==null){var o=t.memoizedProps;if(_u(o,r)&&t.ref===e.ref)if(Un=!1,e.pendingProps=r=o,(t.lanes&i)!==0)t.flags&131072&&(Un=!0);else return e.lanes=t.lanes,Xi(t,e,i)}return _g(t,e,n,r,i)}function ET(t,e,n){var r=e.pendingProps,i=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},dt(cl,Xn),Xn|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,dt(cl,Xn),Xn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,dt(cl,Xn),Xn|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,dt(cl,Xn),Xn|=r;return Tn(t,e,i,n),e.child}function kT(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function _g(t,e,n,r,i){var o=$n(n)?qo:yn.current;return o=Il(e,o),pl(e,i),n=Gy(t,e,n,r,o,i),r=Ky(),t!==null&&!Un?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Xi(t,e,i)):(vt&&r&&Dy(e),e.flags|=1,Tn(t,e,n,i),e.child)}function ax(t,e,n,r,i){if($n(n)){var o=!0;Gh(e)}else o=!1;if(pl(e,i),e.stateNode===null)yh(t,e),wT(e,n,r),gg(e,n,r,i),r=!0;else if(t===null){var a=e.stateNode,u=e.memoizedProps;a.props=u;var h=a.context,m=n.contextType;typeof m=="object"&&m!==null?m=Ir(m):(m=$n(n)?qo:yn.current,m=Il(e,m));var y=n.getDerivedStateFromProps,v=typeof y=="function"||typeof a.getSnapshotBeforeUpdate=="function";v||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(u!==r||h!==m)&&tx(e,a,r,m),As=!1;var w=e.memoizedState;a.state=w,Jh(e,r,a,i),h=e.memoizedState,u!==r||w!==h||qn.current||As?(typeof y=="function"&&(pg(e,n,y,r),h=e.memoizedState),(u=As||ex(e,n,u,r,w,h,m))?(v||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=h),a.props=r,a.state=h,a.context=m,r=u):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,eT(t,e),u=e.memoizedProps,m=e.type===e.elementType?u:Fr(e.type,u),a.props=m,v=e.pendingProps,w=a.context,h=n.contextType,typeof h=="object"&&h!==null?h=Ir(h):(h=$n(n)?qo:yn.current,h=Il(e,h));var S=n.getDerivedStateFromProps;(y=typeof S=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(u!==v||w!==h)&&tx(e,a,r,h),As=!1,w=e.memoizedState,a.state=w,Jh(e,r,a,i);var N=e.memoizedState;u!==v||w!==N||qn.current||As?(typeof S=="function"&&(pg(e,n,S,r),N=e.memoizedState),(m=As||ex(e,n,m,r,w,N,h)||!1)?(y||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,N,h),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,N,h)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||u===t.memoizedProps&&w===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&w===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=N),a.props=r,a.state=N,a.context=h,r=m):(typeof a.componentDidUpdate!="function"||u===t.memoizedProps&&w===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&w===t.memoizedState||(e.flags|=1024),r=!1)}return vg(t,e,n,r,o,i)}function vg(t,e,n,r,i,o){kT(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return i&&W0(e,n,!1),Xi(t,e,o);r=e.stateNode,BA.current=e;var u=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=El(e,t.child,null,o),e.child=El(e,null,u,o)):Tn(t,e,u,o),e.memoizedState=r.state,i&&W0(e,n,!0),e.child}function ST(t){var e=t.stateNode;e.pendingContext?H0(t,e.pendingContext,e.pendingContext!==e.context):e.context&&H0(t,e.context,!1),qy(t,e.containerInfo)}function lx(t,e,n,r,i){return Tl(),Oy(i),e.flags|=256,Tn(t,e,n,r),e.child}var xg={dehydrated:null,treeContext:null,retryLane:0};function wg(t){return{baseLanes:t,cachePool:null,transitions:null}}function PT(t,e,n){var r=e.pendingProps,i=Et.current,o=!1,a=(e.flags&128)!==0,u;if((u=a)||(u=t!==null&&t.memoizedState===null?!1:(i&2)!==0),u?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),dt(Et,i&1),t===null)return fg(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,o?(r=e.mode,o=e.child,a={mode:"hidden",children:a},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=a):o=Hf(a,r,0,null),t=Fo(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=wg(n),e.memoizedState=xg,t):Yy(e,a));if(i=t.memoizedState,i!==null&&(u=i.dehydrated,u!==null))return zA(t,e,a,r,u,i,n);if(o){o=r.fallback,a=e.mode,i=t.child,u=i.sibling;var h={mode:"hidden",children:r.children};return!(a&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=h,e.deletions=null):(r=Qs(i,h),r.subtreeFlags=i.subtreeFlags&14680064),u!==null?o=Qs(u,o):(o=Fo(o,a,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,a=t.child.memoizedState,a=a===null?wg(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},o.memoizedState=a,o.childLanes=t.childLanes&~n,e.memoizedState=xg,r}return o=t.child,t=o.sibling,r=Qs(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Yy(t,e){return e=Hf({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Wd(t,e,n,r){return r!==null&&Oy(r),El(e,t.child,null,n),t=Yy(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function zA(t,e,n,r,i,o,a){if(n)return e.flags&256?(e.flags&=-257,r=hp(Error(ie(422))),Wd(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,i=e.mode,r=Hf({mode:"visible",children:r.children},i,0,null),o=Fo(o,i,a,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&El(e,t.child,null,a),e.child.memoizedState=wg(a),e.memoizedState=xg,o);if(!(e.mode&1))return Wd(t,e,a,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var u=r.dgst;return r=u,o=Error(ie(419)),r=hp(o,r,void 0),Wd(t,e,a,r)}if(u=(a&t.childLanes)!==0,Un||u){if(r=Xt,r!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|a)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,Ji(t,i),Hr(r,t,i,-1))}return r_(),r=hp(Error(ie(421))),Wd(t,e,a,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=tC.bind(null,t),i._reactRetry=e,null):(t=o.treeContext,er=Ws(i.nextSibling),rr=e,vt=!0,Br=null,t!==null&&(vr[xr++]=Vi,vr[xr++]=Fi,vr[xr++]=$o,Vi=t.id,Fi=t.overflow,$o=e),e=Yy(e,r.children),e.flags|=4096,e)}function cx(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),mg(t.return,e,n)}function fp(t,e,n,r,i){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function NT(t,e,n){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(Tn(t,e,r.children,n),r=Et.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&cx(t,n,e);else if(t.tag===19)cx(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(dt(Et,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Xh(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),fp(e,!1,i,n,o);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Xh(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}fp(e,!0,n,null,o);break;case"together":fp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function yh(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Xi(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Wo|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ie(153));if(e.child!==null){for(t=e.child,n=Qs(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Qs(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function qA(t,e,n){switch(e.tag){case 3:ST(e),Tl();break;case 5:tT(e);break;case 1:$n(e.type)&&Gh(e);break;case 4:qy(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;dt(Qh,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(dt(Et,Et.current&1),e.flags|=128,null):n&e.child.childLanes?PT(t,e,n):(dt(Et,Et.current&1),t=Xi(t,e,n),t!==null?t.sibling:null);dt(Et,Et.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return NT(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),dt(Et,Et.current),r)break;return null;case 22:case 23:return e.lanes=0,ET(t,e,n)}return Xi(t,e,n)}var AT,bg,CT,RT;AT=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};bg=function(){};CT=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Lo(gi.current);var o=null;switch(n){case"input":i=$p(t,i),r=$p(t,r),o=[];break;case"select":i=St({},i,{value:void 0}),r=St({},r,{value:void 0}),o=[];break;case"textarea":i=Gp(t,i),r=Gp(t,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Hh)}Zp(n,r);var a;n=null;for(m in i)if(!r.hasOwnProperty(m)&&i.hasOwnProperty(m)&&i[m]!=null)if(m==="style"){var u=i[m];for(a in u)u.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else m!=="dangerouslySetInnerHTML"&&m!=="children"&&m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&m!=="autoFocus"&&(du.hasOwnProperty(m)?o||(o=[]):(o=o||[]).push(m,null));for(m in r){var h=r[m];if(u=i!=null?i[m]:void 0,r.hasOwnProperty(m)&&h!==u&&(h!=null||u!=null))if(m==="style")if(u){for(a in u)!u.hasOwnProperty(a)||h&&h.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in h)h.hasOwnProperty(a)&&u[a]!==h[a]&&(n||(n={}),n[a]=h[a])}else n||(o||(o=[]),o.push(m,n)),n=h;else m==="dangerouslySetInnerHTML"?(h=h?h.__html:void 0,u=u?u.__html:void 0,h!=null&&u!==h&&(o=o||[]).push(m,h)):m==="children"?typeof h!="string"&&typeof h!="number"||(o=o||[]).push(m,""+h):m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&(du.hasOwnProperty(m)?(h!=null&&m==="onScroll"&&pt("scroll",t),o||u===h||(o=[])):(o=o||[]).push(m,h))}n&&(o=o||[]).push("style",n);var m=o;(e.updateQueue=m)&&(e.flags|=4)}};RT=function(t,e,n,r){n!==r&&(e.flags|=4)};function Sc(t,e){if(!vt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function cn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function $A(t,e,n){var r=e.pendingProps;switch(My(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return cn(e),null;case 1:return $n(e.type)&&Wh(),cn(e),null;case 3:return r=e.stateNode,kl(),gt(qn),gt(yn),Hy(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&($d(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Br!==null&&(Ag(Br),Br=null))),bg(t,e),cn(e),null;case 5:$y(e);var i=Lo(Iu.current);if(n=e.type,t!==null&&e.stateNode!=null)CT(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ie(166));return cn(e),null}if(t=Lo(gi.current),$d(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[di]=e,r[wu]=o,t=(e.mode&1)!==0,n){case"dialog":pt("cancel",r),pt("close",r);break;case"iframe":case"object":case"embed":pt("load",r);break;case"video":case"audio":for(i=0;i<Uc.length;i++)pt(Uc[i],r);break;case"source":pt("error",r);break;case"img":case"image":case"link":pt("error",r),pt("load",r);break;case"details":pt("toggle",r);break;case"input":_0(r,o),pt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},pt("invalid",r);break;case"textarea":x0(r,o),pt("invalid",r)}Zp(n,o),i=null;for(var a in o)if(o.hasOwnProperty(a)){var u=o[a];a==="children"?typeof u=="string"?r.textContent!==u&&(o.suppressHydrationWarning!==!0&&qd(r.textContent,u,t),i=["children",u]):typeof u=="number"&&r.textContent!==""+u&&(o.suppressHydrationWarning!==!0&&qd(r.textContent,u,t),i=["children",""+u]):du.hasOwnProperty(a)&&u!=null&&a==="onScroll"&&pt("scroll",r)}switch(n){case"input":Dd(r),v0(r,o,!0);break;case"textarea":Dd(r),w0(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=Hh)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=oI(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[di]=e,t[wu]=r,AT(t,e,!1,!1),e.stateNode=t;e:{switch(a=Qp(n,r),n){case"dialog":pt("cancel",t),pt("close",t),i=r;break;case"iframe":case"object":case"embed":pt("load",t),i=r;break;case"video":case"audio":for(i=0;i<Uc.length;i++)pt(Uc[i],t);i=r;break;case"source":pt("error",t),i=r;break;case"img":case"image":case"link":pt("error",t),pt("load",t),i=r;break;case"details":pt("toggle",t),i=r;break;case"input":_0(t,r),i=$p(t,r),pt("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=St({},r,{value:void 0}),pt("invalid",t);break;case"textarea":x0(t,r),i=Gp(t,r),pt("invalid",t);break;default:i=r}Zp(n,i),u=i;for(o in u)if(u.hasOwnProperty(o)){var h=u[o];o==="style"?cI(t,h):o==="dangerouslySetInnerHTML"?(h=h?h.__html:void 0,h!=null&&aI(t,h)):o==="children"?typeof h=="string"?(n!=="textarea"||h!=="")&&hu(t,h):typeof h=="number"&&hu(t,""+h):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(du.hasOwnProperty(o)?h!=null&&o==="onScroll"&&pt("scroll",t):h!=null&&wy(t,o,h,a))}switch(n){case"input":Dd(t),v0(t,r,!1);break;case"textarea":Dd(t),w0(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Xs(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?dl(t,!!r.multiple,o,!1):r.defaultValue!=null&&dl(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Hh)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return cn(e),null;case 6:if(t&&e.stateNode!=null)RT(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ie(166));if(n=Lo(Iu.current),Lo(gi.current),$d(e)){if(r=e.stateNode,n=e.memoizedProps,r[di]=e,(o=r.nodeValue!==n)&&(t=rr,t!==null))switch(t.tag){case 3:qd(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&qd(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[di]=e,e.stateNode=r}return cn(e),null;case 13:if(gt(Et),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(vt&&er!==null&&e.mode&1&&!(e.flags&128))QI(),Tl(),e.flags|=98560,o=!1;else if(o=$d(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(ie(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(ie(317));o[di]=e}else Tl(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;cn(e),o=!1}else Br!==null&&(Ag(Br),Br=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Et.current&1?Ht===0&&(Ht=3):r_())),e.updateQueue!==null&&(e.flags|=4),cn(e),null);case 4:return kl(),bg(t,e),t===null&&vu(e.stateNode.containerInfo),cn(e),null;case 10:return Uy(e.type._context),cn(e),null;case 17:return $n(e.type)&&Wh(),cn(e),null;case 19:if(gt(Et),o=e.memoizedState,o===null)return cn(e),null;if(r=(e.flags&128)!==0,a=o.rendering,a===null)if(r)Sc(o,!1);else{if(Ht!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Xh(t),a!==null){for(e.flags|=128,Sc(o,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,a=o.alternate,a===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=a.childLanes,o.lanes=a.lanes,o.child=a.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=a.memoizedProps,o.memoizedState=a.memoizedState,o.updateQueue=a.updateQueue,o.type=a.type,t=a.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return dt(Et,Et.current&1|2),e.child}t=t.sibling}o.tail!==null&&Mt()>Pl&&(e.flags|=128,r=!0,Sc(o,!1),e.lanes=4194304)}else{if(!r)if(t=Xh(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Sc(o,!0),o.tail===null&&o.tailMode==="hidden"&&!a.alternate&&!vt)return cn(e),null}else 2*Mt()-o.renderingStartTime>Pl&&n!==1073741824&&(e.flags|=128,r=!0,Sc(o,!1),e.lanes=4194304);o.isBackwards?(a.sibling=e.child,e.child=a):(n=o.last,n!==null?n.sibling=a:e.child=a,o.last=a)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=Mt(),e.sibling=null,n=Et.current,dt(Et,r?n&1|2:n&1),e):(cn(e),null);case 22:case 23:return n_(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Xn&1073741824&&(cn(e),e.subtreeFlags&6&&(e.flags|=8192)):cn(e),null;case 24:return null;case 25:return null}throw Error(ie(156,e.tag))}function HA(t,e){switch(My(e),e.tag){case 1:return $n(e.type)&&Wh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return kl(),gt(qn),gt(yn),Hy(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return $y(e),null;case 13:if(gt(Et),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ie(340));Tl()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return gt(Et),null;case 4:return kl(),null;case 10:return Uy(e.type._context),null;case 22:case 23:return n_(),null;case 24:return null;default:return null}}var Gd=!1,hn=!1,WA=typeof WeakSet=="function"?WeakSet:Set,ye=null;function ll(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){At(t,e,r)}else n.current=null}function Ig(t,e,n){try{n()}catch(r){At(t,e,r)}}var ux=!1;function GA(t,e){if(og=zh,t=OI(),Ly(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var a=0,u=-1,h=-1,m=0,y=0,v=t,w=null;t:for(;;){for(var S;v!==n||i!==0&&v.nodeType!==3||(u=a+i),v!==o||r!==0&&v.nodeType!==3||(h=a+r),v.nodeType===3&&(a+=v.nodeValue.length),(S=v.firstChild)!==null;)w=v,v=S;for(;;){if(v===t)break t;if(w===n&&++m===i&&(u=a),w===o&&++y===r&&(h=a),(S=v.nextSibling)!==null)break;v=w,w=v.parentNode}v=S}n=u===-1||h===-1?null:{start:u,end:h}}else n=null}n=n||{start:0,end:0}}else n=null;for(ag={focusedElem:t,selectionRange:n},zh=!1,ye=e;ye!==null;)if(e=ye,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ye=t;else for(;ye!==null;){e=ye;try{var N=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(N!==null){var P=N.memoizedProps,F=N.memoizedState,R=e.stateNode,k=R.getSnapshotBeforeUpdate(e.elementType===e.type?P:Fr(e.type,P),F);R.__reactInternalSnapshotBeforeUpdate=k}break;case 3:var A=e.stateNode.containerInfo;A.nodeType===1?A.textContent="":A.nodeType===9&&A.documentElement&&A.removeChild(A.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ie(163))}}catch(z){At(e,e.return,z)}if(t=e.sibling,t!==null){t.return=e.return,ye=t;break}ye=e.return}return N=ux,ux=!1,N}function Xc(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var o=i.destroy;i.destroy=void 0,o!==void 0&&Ig(e,n,o)}i=i.next}while(i!==r)}}function qf(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Tg(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function jT(t){var e=t.alternate;e!==null&&(t.alternate=null,jT(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[di],delete e[wu],delete e[ug],delete e[NA],delete e[AA])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function LT(t){return t.tag===5||t.tag===3||t.tag===4}function dx(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||LT(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Eg(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Hh));else if(r!==4&&(t=t.child,t!==null))for(Eg(t,e,n),t=t.sibling;t!==null;)Eg(t,e,n),t=t.sibling}function kg(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(kg(t,e,n),t=t.sibling;t!==null;)kg(t,e,n),t=t.sibling}var tn=null,Ur=!1;function Es(t,e,n){for(n=n.child;n!==null;)DT(t,e,n),n=n.sibling}function DT(t,e,n){if(pi&&typeof pi.onCommitFiberUnmount=="function")try{pi.onCommitFiberUnmount(Df,n)}catch{}switch(n.tag){case 5:hn||ll(n,e);case 6:var r=tn,i=Ur;tn=null,Es(t,e,n),tn=r,Ur=i,tn!==null&&(Ur?(t=tn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):tn.removeChild(n.stateNode));break;case 18:tn!==null&&(Ur?(t=tn,n=n.stateNode,t.nodeType===8?op(t.parentNode,n):t.nodeType===1&&op(t,n),gu(t)):op(tn,n.stateNode));break;case 4:r=tn,i=Ur,tn=n.stateNode.containerInfo,Ur=!0,Es(t,e,n),tn=r,Ur=i;break;case 0:case 11:case 14:case 15:if(!hn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,a=o.destroy;o=o.tag,a!==void 0&&(o&2||o&4)&&Ig(n,e,a),i=i.next}while(i!==r)}Es(t,e,n);break;case 1:if(!hn&&(ll(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(u){At(n,e,u)}Es(t,e,n);break;case 21:Es(t,e,n);break;case 22:n.mode&1?(hn=(r=hn)||n.memoizedState!==null,Es(t,e,n),hn=r):Es(t,e,n);break;default:Es(t,e,n)}}function hx(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new WA),e.forEach(function(r){var i=nC.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Vr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var o=t,a=e,u=a;e:for(;u!==null;){switch(u.tag){case 5:tn=u.stateNode,Ur=!1;break e;case 3:tn=u.stateNode.containerInfo,Ur=!0;break e;case 4:tn=u.stateNode.containerInfo,Ur=!0;break e}u=u.return}if(tn===null)throw Error(ie(160));DT(o,a,i),tn=null,Ur=!1;var h=i.alternate;h!==null&&(h.return=null),i.return=null}catch(m){At(i,e,m)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)MT(e,t),e=e.sibling}function MT(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Vr(e,t),ai(t),r&4){try{Xc(3,t,t.return),qf(3,t)}catch(P){At(t,t.return,P)}try{Xc(5,t,t.return)}catch(P){At(t,t.return,P)}}break;case 1:Vr(e,t),ai(t),r&512&&n!==null&&ll(n,n.return);break;case 5:if(Vr(e,t),ai(t),r&512&&n!==null&&ll(n,n.return),t.flags&32){var i=t.stateNode;try{hu(i,"")}catch(P){At(t,t.return,P)}}if(r&4&&(i=t.stateNode,i!=null)){var o=t.memoizedProps,a=n!==null?n.memoizedProps:o,u=t.type,h=t.updateQueue;if(t.updateQueue=null,h!==null)try{u==="input"&&o.type==="radio"&&o.name!=null&&iI(i,o),Qp(u,a);var m=Qp(u,o);for(a=0;a<h.length;a+=2){var y=h[a],v=h[a+1];y==="style"?cI(i,v):y==="dangerouslySetInnerHTML"?aI(i,v):y==="children"?hu(i,v):wy(i,y,v,m)}switch(u){case"input":Hp(i,o);break;case"textarea":sI(i,o);break;case"select":var w=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var S=o.value;S!=null?dl(i,!!o.multiple,S,!1):w!==!!o.multiple&&(o.defaultValue!=null?dl(i,!!o.multiple,o.defaultValue,!0):dl(i,!!o.multiple,o.multiple?[]:"",!1))}i[wu]=o}catch(P){At(t,t.return,P)}}break;case 6:if(Vr(e,t),ai(t),r&4){if(t.stateNode===null)throw Error(ie(162));i=t.stateNode,o=t.memoizedProps;try{i.nodeValue=o}catch(P){At(t,t.return,P)}}break;case 3:if(Vr(e,t),ai(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{gu(e.containerInfo)}catch(P){At(t,t.return,P)}break;case 4:Vr(e,t),ai(t);break;case 13:Vr(e,t),ai(t),i=t.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(e_=Mt())),r&4&&hx(t);break;case 22:if(y=n!==null&&n.memoizedState!==null,t.mode&1?(hn=(m=hn)||y,Vr(e,t),hn=m):Vr(e,t),ai(t),r&8192){if(m=t.memoizedState!==null,(t.stateNode.isHidden=m)&&!y&&t.mode&1)for(ye=t,y=t.child;y!==null;){for(v=ye=y;ye!==null;){switch(w=ye,S=w.child,w.tag){case 0:case 11:case 14:case 15:Xc(4,w,w.return);break;case 1:ll(w,w.return);var N=w.stateNode;if(typeof N.componentWillUnmount=="function"){r=w,n=w.return;try{e=r,N.props=e.memoizedProps,N.state=e.memoizedState,N.componentWillUnmount()}catch(P){At(r,n,P)}}break;case 5:ll(w,w.return);break;case 22:if(w.memoizedState!==null){mx(v);continue}}S!==null?(S.return=w,ye=S):mx(v)}y=y.sibling}e:for(y=null,v=t;;){if(v.tag===5){if(y===null){y=v;try{i=v.stateNode,m?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(u=v.stateNode,h=v.memoizedProps.style,a=h!=null&&h.hasOwnProperty("display")?h.display:null,u.style.display=lI("display",a))}catch(P){At(t,t.return,P)}}}else if(v.tag===6){if(y===null)try{v.stateNode.nodeValue=m?"":v.memoizedProps}catch(P){At(t,t.return,P)}}else if((v.tag!==22&&v.tag!==23||v.memoizedState===null||v===t)&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===t)break e;for(;v.sibling===null;){if(v.return===null||v.return===t)break e;y===v&&(y=null),v=v.return}y===v&&(y=null),v.sibling.return=v.return,v=v.sibling}}break;case 19:Vr(e,t),ai(t),r&4&&hx(t);break;case 21:break;default:Vr(e,t),ai(t)}}function ai(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(LT(n)){var r=n;break e}n=n.return}throw Error(ie(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(hu(i,""),r.flags&=-33);var o=dx(t);kg(t,o,i);break;case 3:case 4:var a=r.stateNode.containerInfo,u=dx(t);Eg(t,u,a);break;default:throw Error(ie(161))}}catch(h){At(t,t.return,h)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function KA(t,e,n){ye=t,OT(t)}function OT(t,e,n){for(var r=(t.mode&1)!==0;ye!==null;){var i=ye,o=i.child;if(i.tag===22&&r){var a=i.memoizedState!==null||Gd;if(!a){var u=i.alternate,h=u!==null&&u.memoizedState!==null||hn;u=Gd;var m=hn;if(Gd=a,(hn=h)&&!m)for(ye=i;ye!==null;)a=ye,h=a.child,a.tag===22&&a.memoizedState!==null?px(i):h!==null?(h.return=a,ye=h):px(i);for(;o!==null;)ye=o,OT(o),o=o.sibling;ye=i,Gd=u,hn=m}fx(t)}else i.subtreeFlags&8772&&o!==null?(o.return=i,ye=o):fx(t)}}function fx(t){for(;ye!==null;){var e=ye;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:hn||qf(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!hn)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Fr(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&Y0(e,o,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Y0(e,a,n)}break;case 5:var u=e.stateNode;if(n===null&&e.flags&4){n=u;var h=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":h.autoFocus&&n.focus();break;case"img":h.src&&(n.src=h.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var m=e.alternate;if(m!==null){var y=m.memoizedState;if(y!==null){var v=y.dehydrated;v!==null&&gu(v)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ie(163))}hn||e.flags&512&&Tg(e)}catch(w){At(e,e.return,w)}}if(e===t){ye=null;break}if(n=e.sibling,n!==null){n.return=e.return,ye=n;break}ye=e.return}}function mx(t){for(;ye!==null;){var e=ye;if(e===t){ye=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ye=n;break}ye=e.return}}function px(t){for(;ye!==null;){var e=ye;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{qf(4,e)}catch(h){At(e,n,h)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(h){At(e,i,h)}}var o=e.return;try{Tg(e)}catch(h){At(e,o,h)}break;case 5:var a=e.return;try{Tg(e)}catch(h){At(e,a,h)}}}catch(h){At(e,e.return,h)}if(e===t){ye=null;break}var u=e.sibling;if(u!==null){u.return=e.return,ye=u;break}ye=e.return}}var ZA=Math.ceil,nf=is.ReactCurrentDispatcher,Jy=is.ReactCurrentOwner,br=is.ReactCurrentBatchConfig,Ye=0,Xt=null,Bt=null,rn=0,Xn=0,cl=oo(0),Ht=0,Su=null,Wo=0,$f=0,Xy=0,eu=null,Vn=null,e_=0,Pl=1/0,ji=null,rf=!1,Sg=null,Ks=null,Kd=!1,Us=null,sf=0,tu=0,Pg=null,_h=-1,vh=0;function kn(){return Ye&6?Mt():_h!==-1?_h:_h=Mt()}function Zs(t){return t.mode&1?Ye&2&&rn!==0?rn&-rn:RA.transition!==null?(vh===0&&(vh=wI()),vh):(t=it,t!==0||(t=window.event,t=t===void 0?16:PI(t.type)),t):1}function Hr(t,e,n,r){if(50<tu)throw tu=0,Pg=null,Error(ie(185));Wu(t,n,r),(!(Ye&2)||t!==Xt)&&(t===Xt&&(!(Ye&2)&&($f|=n),Ht===4&&Rs(t,rn)),Hn(t,r),n===1&&Ye===0&&!(e.mode&1)&&(Pl=Mt()+500,Uf&&ao()))}function Hn(t,e){var n=t.callbackNode;RN(t,e);var r=Bh(t,t===Xt?rn:0);if(r===0)n!==null&&T0(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&T0(n),e===1)t.tag===0?CA(gx.bind(null,t)):GI(gx.bind(null,t)),SA(function(){!(Ye&6)&&ao()}),n=null;else{switch(bI(r)){case 1:n=ky;break;case 4:n=vI;break;case 16:n=Uh;break;case 536870912:n=xI;break;default:n=Uh}n=HT(n,VT.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function VT(t,e){if(_h=-1,vh=0,Ye&6)throw Error(ie(327));var n=t.callbackNode;if(gl()&&t.callbackNode!==n)return null;var r=Bh(t,t===Xt?rn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=of(t,r);else{e=r;var i=Ye;Ye|=2;var o=UT();(Xt!==t||rn!==e)&&(ji=null,Pl=Mt()+500,Vo(t,e));do try{JA();break}catch(u){FT(t,u)}while(!0);Fy(),nf.current=o,Ye=i,Bt!==null?e=0:(Xt=null,rn=0,e=Ht)}if(e!==0){if(e===2&&(i=tg(t),i!==0&&(r=i,e=Ng(t,i))),e===1)throw n=Su,Vo(t,0),Rs(t,r),Hn(t,Mt()),n;if(e===6)Rs(t,r);else{if(i=t.current.alternate,!(r&30)&&!QA(i)&&(e=of(t,r),e===2&&(o=tg(t),o!==0&&(r=o,e=Ng(t,o))),e===1))throw n=Su,Vo(t,0),Rs(t,r),Hn(t,Mt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(ie(345));case 2:To(t,Vn,ji);break;case 3:if(Rs(t,r),(r&130023424)===r&&(e=e_+500-Mt(),10<e)){if(Bh(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){kn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=cg(To.bind(null,t,Vn,ji),e);break}To(t,Vn,ji);break;case 4:if(Rs(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var a=31-$r(r);o=1<<a,a=e[a],a>i&&(i=a),r&=~o}if(r=i,r=Mt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*ZA(r/1960))-r,10<r){t.timeoutHandle=cg(To.bind(null,t,Vn,ji),r);break}To(t,Vn,ji);break;case 5:To(t,Vn,ji);break;default:throw Error(ie(329))}}}return Hn(t,Mt()),t.callbackNode===n?VT.bind(null,t):null}function Ng(t,e){var n=eu;return t.current.memoizedState.isDehydrated&&(Vo(t,e).flags|=256),t=of(t,e),t!==2&&(e=Vn,Vn=n,e!==null&&Ag(e)),t}function Ag(t){Vn===null?Vn=t:Vn.push.apply(Vn,t)}function QA(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!Kr(o(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Rs(t,e){for(e&=~Xy,e&=~$f,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-$r(e),r=1<<n;t[n]=-1,e&=~r}}function gx(t){if(Ye&6)throw Error(ie(327));gl();var e=Bh(t,0);if(!(e&1))return Hn(t,Mt()),null;var n=of(t,e);if(t.tag!==0&&n===2){var r=tg(t);r!==0&&(e=r,n=Ng(t,r))}if(n===1)throw n=Su,Vo(t,0),Rs(t,e),Hn(t,Mt()),n;if(n===6)throw Error(ie(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,To(t,Vn,ji),Hn(t,Mt()),null}function t_(t,e){var n=Ye;Ye|=1;try{return t(e)}finally{Ye=n,Ye===0&&(Pl=Mt()+500,Uf&&ao())}}function Go(t){Us!==null&&Us.tag===0&&!(Ye&6)&&gl();var e=Ye;Ye|=1;var n=br.transition,r=it;try{if(br.transition=null,it=1,t)return t()}finally{it=r,br.transition=n,Ye=e,!(Ye&6)&&ao()}}function n_(){Xn=cl.current,gt(cl)}function Vo(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,kA(n)),Bt!==null)for(n=Bt.return;n!==null;){var r=n;switch(My(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Wh();break;case 3:kl(),gt(qn),gt(yn),Hy();break;case 5:$y(r);break;case 4:kl();break;case 13:gt(Et);break;case 19:gt(Et);break;case 10:Uy(r.type._context);break;case 22:case 23:n_()}n=n.return}if(Xt=t,Bt=t=Qs(t.current,null),rn=Xn=e,Ht=0,Su=null,Xy=$f=Wo=0,Vn=eu=null,jo!==null){for(e=0;e<jo.length;e++)if(n=jo[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,o=n.pending;if(o!==null){var a=o.next;o.next=i,r.next=a}n.pending=r}jo=null}return t}function FT(t,e){do{var n=Bt;try{if(Fy(),ph.current=tf,ef){for(var r=kt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}ef=!1}if(Ho=0,Jt=$t=kt=null,Jc=!1,Tu=0,Jy.current=null,n===null||n.return===null){Ht=1,Su=e,Bt=null;break}e:{var o=t,a=n.return,u=n,h=e;if(e=rn,u.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){var m=h,y=u,v=y.tag;if(!(y.mode&1)&&(v===0||v===11||v===15)){var w=y.alternate;w?(y.updateQueue=w.updateQueue,y.memoizedState=w.memoizedState,y.lanes=w.lanes):(y.updateQueue=null,y.memoizedState=null)}var S=rx(a);if(S!==null){S.flags&=-257,ix(S,a,u,o,e),S.mode&1&&nx(o,m,e),e=S,h=m;var N=e.updateQueue;if(N===null){var P=new Set;P.add(h),e.updateQueue=P}else N.add(h);break e}else{if(!(e&1)){nx(o,m,e),r_();break e}h=Error(ie(426))}}else if(vt&&u.mode&1){var F=rx(a);if(F!==null){!(F.flags&65536)&&(F.flags|=256),ix(F,a,u,o,e),Oy(Sl(h,u));break e}}o=h=Sl(h,u),Ht!==4&&(Ht=2),eu===null?eu=[o]:eu.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var R=bT(o,h,e);Q0(o,R);break e;case 1:u=h;var k=o.type,A=o.stateNode;if(!(o.flags&128)&&(typeof k.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(Ks===null||!Ks.has(A)))){o.flags|=65536,e&=-e,o.lanes|=e;var z=IT(o,u,e);Q0(o,z);break e}}o=o.return}while(o!==null)}zT(n)}catch(G){e=G,Bt===n&&n!==null&&(Bt=n=n.return);continue}break}while(!0)}function UT(){var t=nf.current;return nf.current=tf,t===null?tf:t}function r_(){(Ht===0||Ht===3||Ht===2)&&(Ht=4),Xt===null||!(Wo&268435455)&&!($f&268435455)||Rs(Xt,rn)}function of(t,e){var n=Ye;Ye|=2;var r=UT();(Xt!==t||rn!==e)&&(ji=null,Vo(t,e));do try{YA();break}catch(i){FT(t,i)}while(!0);if(Fy(),Ye=n,nf.current=r,Bt!==null)throw Error(ie(261));return Xt=null,rn=0,Ht}function YA(){for(;Bt!==null;)BT(Bt)}function JA(){for(;Bt!==null&&!IN();)BT(Bt)}function BT(t){var e=$T(t.alternate,t,Xn);t.memoizedProps=t.pendingProps,e===null?zT(t):Bt=e,Jy.current=null}function zT(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=HA(n,e),n!==null){n.flags&=32767,Bt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ht=6,Bt=null;return}}else if(n=$A(n,e,Xn),n!==null){Bt=n;return}if(e=e.sibling,e!==null){Bt=e;return}Bt=e=t}while(e!==null);Ht===0&&(Ht=5)}function To(t,e,n){var r=it,i=br.transition;try{br.transition=null,it=1,XA(t,e,n,r)}finally{br.transition=i,it=r}return null}function XA(t,e,n,r){do gl();while(Us!==null);if(Ye&6)throw Error(ie(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ie(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(jN(t,o),t===Xt&&(Bt=Xt=null,rn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Kd||(Kd=!0,HT(Uh,function(){return gl(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=br.transition,br.transition=null;var a=it;it=1;var u=Ye;Ye|=4,Jy.current=null,GA(t,n),MT(n,t),vA(ag),zh=!!og,ag=og=null,t.current=n,KA(n),TN(),Ye=u,it=a,br.transition=o}else t.current=n;if(Kd&&(Kd=!1,Us=t,sf=i),o=t.pendingLanes,o===0&&(Ks=null),SN(n.stateNode),Hn(t,Mt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(rf)throw rf=!1,t=Sg,Sg=null,t;return sf&1&&t.tag!==0&&gl(),o=t.pendingLanes,o&1?t===Pg?tu++:(tu=0,Pg=t):tu=0,ao(),null}function gl(){if(Us!==null){var t=bI(sf),e=br.transition,n=it;try{if(br.transition=null,it=16>t?16:t,Us===null)var r=!1;else{if(t=Us,Us=null,sf=0,Ye&6)throw Error(ie(331));var i=Ye;for(Ye|=4,ye=t.current;ye!==null;){var o=ye,a=o.child;if(ye.flags&16){var u=o.deletions;if(u!==null){for(var h=0;h<u.length;h++){var m=u[h];for(ye=m;ye!==null;){var y=ye;switch(y.tag){case 0:case 11:case 15:Xc(8,y,o)}var v=y.child;if(v!==null)v.return=y,ye=v;else for(;ye!==null;){y=ye;var w=y.sibling,S=y.return;if(jT(y),y===m){ye=null;break}if(w!==null){w.return=S,ye=w;break}ye=S}}}var N=o.alternate;if(N!==null){var P=N.child;if(P!==null){N.child=null;do{var F=P.sibling;P.sibling=null,P=F}while(P!==null)}}ye=o}}if(o.subtreeFlags&2064&&a!==null)a.return=o,ye=a;else e:for(;ye!==null;){if(o=ye,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Xc(9,o,o.return)}var R=o.sibling;if(R!==null){R.return=o.return,ye=R;break e}ye=o.return}}var k=t.current;for(ye=k;ye!==null;){a=ye;var A=a.child;if(a.subtreeFlags&2064&&A!==null)A.return=a,ye=A;else e:for(a=k;ye!==null;){if(u=ye,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:qf(9,u)}}catch(G){At(u,u.return,G)}if(u===a){ye=null;break e}var z=u.sibling;if(z!==null){z.return=u.return,ye=z;break e}ye=u.return}}if(Ye=i,ao(),pi&&typeof pi.onPostCommitFiberRoot=="function")try{pi.onPostCommitFiberRoot(Df,t)}catch{}r=!0}return r}finally{it=n,br.transition=e}}return!1}function yx(t,e,n){e=Sl(n,e),e=bT(t,e,1),t=Gs(t,e,1),e=kn(),t!==null&&(Wu(t,1,e),Hn(t,e))}function At(t,e,n){if(t.tag===3)yx(t,t,n);else for(;e!==null;){if(e.tag===3){yx(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ks===null||!Ks.has(r))){t=Sl(n,t),t=IT(e,t,1),e=Gs(e,t,1),t=kn(),e!==null&&(Wu(e,1,t),Hn(e,t));break}}e=e.return}}function eC(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=kn(),t.pingedLanes|=t.suspendedLanes&n,Xt===t&&(rn&n)===n&&(Ht===4||Ht===3&&(rn&130023424)===rn&&500>Mt()-e_?Vo(t,0):Xy|=n),Hn(t,e)}function qT(t,e){e===0&&(t.mode&1?(e=Vd,Vd<<=1,!(Vd&130023424)&&(Vd=4194304)):e=1);var n=kn();t=Ji(t,e),t!==null&&(Wu(t,e,n),Hn(t,n))}function tC(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),qT(t,n)}function nC(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ie(314))}r!==null&&r.delete(e),qT(t,n)}var $T;$T=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||qn.current)Un=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Un=!1,qA(t,e,n);Un=!!(t.flags&131072)}else Un=!1,vt&&e.flags&1048576&&KI(e,Zh,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;yh(t,e),t=e.pendingProps;var i=Il(e,yn.current);pl(e,n),i=Gy(null,e,r,t,i,n);var o=Ky();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,$n(r)?(o=!0,Gh(e)):o=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,zy(e),i.updater=zf,e.stateNode=i,i._reactInternals=e,gg(e,r,t,n),e=vg(null,e,r,!0,o,n)):(e.tag=0,vt&&o&&Dy(e),Tn(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(yh(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=iC(r),t=Fr(r,t),i){case 0:e=_g(null,e,r,t,n);break e;case 1:e=ax(null,e,r,t,n);break e;case 11:e=sx(null,e,r,t,n);break e;case 14:e=ox(null,e,r,Fr(r.type,t),n);break e}throw Error(ie(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Fr(r,i),_g(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Fr(r,i),ax(t,e,r,i,n);case 3:e:{if(ST(e),t===null)throw Error(ie(387));r=e.pendingProps,o=e.memoizedState,i=o.element,eT(t,e),Jh(e,r,null,n);var a=e.memoizedState;if(r=a.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){i=Sl(Error(ie(423)),e),e=lx(t,e,r,n,i);break e}else if(r!==i){i=Sl(Error(ie(424)),e),e=lx(t,e,r,n,i);break e}else for(er=Ws(e.stateNode.containerInfo.firstChild),rr=e,vt=!0,Br=null,n=JI(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Tl(),r===i){e=Xi(t,e,n);break e}Tn(t,e,r,n)}e=e.child}return e;case 5:return tT(e),t===null&&fg(e),r=e.type,i=e.pendingProps,o=t!==null?t.memoizedProps:null,a=i.children,lg(r,i)?a=null:o!==null&&lg(r,o)&&(e.flags|=32),kT(t,e),Tn(t,e,a,n),e.child;case 6:return t===null&&fg(e),null;case 13:return PT(t,e,n);case 4:return qy(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=El(e,null,r,n):Tn(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Fr(r,i),sx(t,e,r,i,n);case 7:return Tn(t,e,e.pendingProps,n),e.child;case 8:return Tn(t,e,e.pendingProps.children,n),e.child;case 12:return Tn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,o=e.memoizedProps,a=i.value,dt(Qh,r._currentValue),r._currentValue=a,o!==null)if(Kr(o.value,a)){if(o.children===i.children&&!qn.current){e=Xi(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var u=o.dependencies;if(u!==null){a=o.child;for(var h=u.firstContext;h!==null;){if(h.context===r){if(o.tag===1){h=Wi(-1,n&-n),h.tag=2;var m=o.updateQueue;if(m!==null){m=m.shared;var y=m.pending;y===null?h.next=h:(h.next=y.next,y.next=h),m.pending=h}}o.lanes|=n,h=o.alternate,h!==null&&(h.lanes|=n),mg(o.return,n,e),u.lanes|=n;break}h=h.next}}else if(o.tag===10)a=o.type===e.type?null:o.child;else if(o.tag===18){if(a=o.return,a===null)throw Error(ie(341));a.lanes|=n,u=a.alternate,u!==null&&(u.lanes|=n),mg(a,n,e),a=o.sibling}else a=o.child;if(a!==null)a.return=o;else for(a=o;a!==null;){if(a===e){a=null;break}if(o=a.sibling,o!==null){o.return=a.return,a=o;break}a=a.return}o=a}Tn(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,pl(e,n),i=Ir(i),r=r(i),e.flags|=1,Tn(t,e,r,n),e.child;case 14:return r=e.type,i=Fr(r,e.pendingProps),i=Fr(r.type,i),ox(t,e,r,i,n);case 15:return TT(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Fr(r,i),yh(t,e),e.tag=1,$n(r)?(t=!0,Gh(e)):t=!1,pl(e,n),wT(e,r,i),gg(e,r,i,n),vg(null,e,r,!0,t,n);case 19:return NT(t,e,n);case 22:return ET(t,e,n)}throw Error(ie(156,e.tag))};function HT(t,e){return _I(t,e)}function rC(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wr(t,e,n,r){return new rC(t,e,n,r)}function i_(t){return t=t.prototype,!(!t||!t.isReactComponent)}function iC(t){if(typeof t=="function")return i_(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Iy)return 11;if(t===Ty)return 14}return 2}function Qs(t,e){var n=t.alternate;return n===null?(n=wr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function xh(t,e,n,r,i,o){var a=2;if(r=t,typeof t=="function")i_(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Xa:return Fo(n.children,i,o,e);case by:a=8,i|=8;break;case Up:return t=wr(12,n,e,i|2),t.elementType=Up,t.lanes=o,t;case Bp:return t=wr(13,n,e,i),t.elementType=Bp,t.lanes=o,t;case zp:return t=wr(19,n,e,i),t.elementType=zp,t.lanes=o,t;case tI:return Hf(n,i,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Xb:a=10;break e;case eI:a=9;break e;case Iy:a=11;break e;case Ty:a=14;break e;case Ns:a=16,r=null;break e}throw Error(ie(130,t==null?t:typeof t,""))}return e=wr(a,n,e,i),e.elementType=t,e.type=r,e.lanes=o,e}function Fo(t,e,n,r){return t=wr(7,t,r,e),t.lanes=n,t}function Hf(t,e,n,r){return t=wr(22,t,r,e),t.elementType=tI,t.lanes=n,t.stateNode={isHidden:!1},t}function mp(t,e,n){return t=wr(6,t,null,e),t.lanes=n,t}function pp(t,e,n){return e=wr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function sC(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Zm(0),this.expirationTimes=Zm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Zm(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function s_(t,e,n,r,i,o,a,u,h){return t=new sC(t,e,n,u,h),e===1?(e=1,o===!0&&(e|=8)):e=0,o=wr(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},zy(o),t}function oC(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ja,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function WT(t){if(!t)return eo;t=t._reactInternals;e:{if(la(t)!==t||t.tag!==1)throw Error(ie(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if($n(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ie(171))}if(t.tag===1){var n=t.type;if($n(n))return WI(t,n,e)}return e}function GT(t,e,n,r,i,o,a,u,h){return t=s_(n,r,!0,t,i,o,a,u,h),t.context=WT(null),n=t.current,r=kn(),i=Zs(n),o=Wi(r,i),o.callback=e??null,Gs(n,o,i),t.current.lanes=i,Wu(t,i,r),Hn(t,r),t}function Wf(t,e,n,r){var i=e.current,o=kn(),a=Zs(i);return n=WT(n),e.context===null?e.context=n:e.pendingContext=n,e=Wi(o,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Gs(i,e,a),t!==null&&(Hr(t,i,a,o),mh(t,i,a)),a}function af(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function _x(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function o_(t,e){_x(t,e),(t=t.alternate)&&_x(t,e)}function aC(){return null}var KT=typeof reportError=="function"?reportError:function(t){console.error(t)};function a_(t){this._internalRoot=t}Gf.prototype.render=a_.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ie(409));Wf(t,e,null,null)};Gf.prototype.unmount=a_.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Go(function(){Wf(null,t,null,null)}),e[Yi]=null}};function Gf(t){this._internalRoot=t}Gf.prototype.unstable_scheduleHydration=function(t){if(t){var e=EI();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Cs.length&&e!==0&&e<Cs[n].priority;n++);Cs.splice(n,0,t),n===0&&SI(t)}};function l_(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Kf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function vx(){}function lC(t,e,n,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var m=af(a);o.call(m)}}var a=GT(e,r,t,0,null,!1,!1,"",vx);return t._reactRootContainer=a,t[Yi]=a.current,vu(t.nodeType===8?t.parentNode:t),Go(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var u=r;r=function(){var m=af(h);u.call(m)}}var h=s_(t,0,!1,null,null,!1,!1,"",vx);return t._reactRootContainer=h,t[Yi]=h.current,vu(t.nodeType===8?t.parentNode:t),Go(function(){Wf(e,h,n,r)}),h}function Zf(t,e,n,r,i){var o=n._reactRootContainer;if(o){var a=o;if(typeof i=="function"){var u=i;i=function(){var h=af(a);u.call(h)}}Wf(e,a,t,i)}else a=lC(n,e,t,i,r);return af(a)}II=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Fc(e.pendingLanes);n!==0&&(Sy(e,n|1),Hn(e,Mt()),!(Ye&6)&&(Pl=Mt()+500,ao()))}break;case 13:Go(function(){var r=Ji(t,1);if(r!==null){var i=kn();Hr(r,t,1,i)}}),o_(t,1)}};Py=function(t){if(t.tag===13){var e=Ji(t,134217728);if(e!==null){var n=kn();Hr(e,t,134217728,n)}o_(t,134217728)}};TI=function(t){if(t.tag===13){var e=Zs(t),n=Ji(t,e);if(n!==null){var r=kn();Hr(n,t,e,r)}o_(t,e)}};EI=function(){return it};kI=function(t,e){var n=it;try{return it=t,e()}finally{it=n}};Jp=function(t,e,n){switch(e){case"input":if(Hp(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Ff(r);if(!i)throw Error(ie(90));rI(r),Hp(r,i)}}}break;case"textarea":sI(t,n);break;case"select":e=n.value,e!=null&&dl(t,!!n.multiple,e,!1)}};hI=t_;fI=Go;var cC={usingClientEntryPoint:!1,Events:[Ku,rl,Ff,uI,dI,t_]},Pc={findFiberByHostInstance:Ro,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},uC={bundleType:Pc.bundleType,version:Pc.version,rendererPackageName:Pc.rendererPackageName,rendererConfig:Pc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:is.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=gI(t),t===null?null:t.stateNode},findFiberByHostInstance:Pc.findFiberByHostInstance||aC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Zd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Zd.isDisabled&&Zd.supportsFiber)try{Df=Zd.inject(uC),pi=Zd}catch{}}lr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cC;lr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!l_(e))throw Error(ie(200));return oC(t,e,null,n)};lr.createRoot=function(t,e){if(!l_(t))throw Error(ie(299));var n=!1,r="",i=KT;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=s_(t,1,!1,null,null,n,!1,r,i),t[Yi]=e.current,vu(t.nodeType===8?t.parentNode:t),new a_(e)};lr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ie(188)):(t=Object.keys(t).join(","),Error(ie(268,t)));return t=gI(e),t=t===null?null:t.stateNode,t};lr.flushSync=function(t){return Go(t)};lr.hydrate=function(t,e,n){if(!Kf(e))throw Error(ie(200));return Zf(null,t,e,!0,n)};lr.hydrateRoot=function(t,e,n){if(!l_(t))throw Error(ie(405));var r=n!=null&&n.hydratedSources||null,i=!1,o="",a=KT;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=GT(e,null,t,1,n??null,i,!1,o,a),t[Yi]=e.current,vu(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Gf(e)};lr.render=function(t,e,n){if(!Kf(e))throw Error(ie(200));return Zf(null,t,e,!1,n)};lr.unmountComponentAtNode=function(t){if(!Kf(t))throw Error(ie(40));return t._reactRootContainer?(Go(function(){Zf(null,null,t,!1,function(){t._reactRootContainer=null,t[Yi]=null})}),!0):!1};lr.unstable_batchedUpdates=t_;lr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Kf(n))throw Error(ie(200));if(t==null||t._reactInternals===void 0)throw Error(ie(38));return Zf(t,e,n,!1,r)};lr.version="18.3.1-next-f1338f8080-20240426";function ZT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(ZT)}catch(t){console.error(t)}}ZT(),Zb.exports=lr;var QT=Zb.exports,xx=QT;Vp.createRoot=xx.createRoot,Vp.hydrateRoot=xx.hydrateRoot;const dC="modulepreload",hC=function(t){return"/"+t},wx={},Cg=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),u=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(n.map(h=>{if(h=hC(h),h in wx)return;wx[h]=!0;const m=h.endsWith(".css"),y=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${y}`))return;const v=document.createElement("link");if(v.rel=m?"stylesheet":dC,m||(v.as="script"),v.crossOrigin="",v.href=h,u&&v.setAttribute("nonce",u),document.head.appendChild(v),m)return new Promise((w,S)=>{v.addEventListener("load",w),v.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${h}`)))})}))}function o(a){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=a,window.dispatchEvent(u),!u.defaultPrevented)throw a}return i.then(a=>{for(const u of a||[])u.status==="rejected"&&o(u.reason);return e().catch(o)})};var bx={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YT=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},fC=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const o=t[n++];e[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=t[n++],a=t[n++],u=t[n++],h=((i&7)<<18|(o&63)<<12|(a&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{const o=t[n++],a=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|a&63)}}return e.join("")},JT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const o=t[i],a=i+1<t.length,u=a?t[i+1]:0,h=i+2<t.length,m=h?t[i+2]:0,y=o>>2,v=(o&3)<<4|u>>4;let w=(u&15)<<2|m>>6,S=m&63;h||(S=64,a||(w=64)),r.push(n[y],n[v],n[w],n[S])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(YT(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):fC(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const o=n[t.charAt(i++)],u=i<t.length?n[t.charAt(i)]:0;++i;const m=i<t.length?n[t.charAt(i)]:64;++i;const v=i<t.length?n[t.charAt(i)]:64;if(++i,o==null||u==null||m==null||v==null)throw new mC;const w=o<<2|u>>4;if(r.push(w),m!==64){const S=u<<4&240|m>>2;if(r.push(S),v!==64){const N=m<<6&192|v;r.push(N)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class mC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const pC=function(t){const e=YT(t);return JT.encodeByteArray(e,!0)},lf=function(t){return pC(t).replace(/\./g,"")},XT=function(t){try{return JT.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yC=()=>gC().__FIREBASE_DEFAULTS__,_C=()=>{if(typeof process>"u"||typeof bx>"u")return;const t=bx.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},vC=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&XT(t[1]);return e&&JSON.parse(e)},Qf=()=>{try{return yC()||_C()||vC()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},eE=t=>{var e,n;return(n=(e=Qf())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},tE=t=>{const e=eE(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},nE=()=>{var t;return(t=Qf())===null||t===void 0?void 0:t.config},rE=t=>{var e;return(e=Qf())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wC(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},t);return[lf(JSON.stringify(n)),lf(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function bC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Wt())}function IC(){var t;const e=(t=Qf())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function TC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function EC(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function kC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function SC(){const t=Wt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function iE(){return!IC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function c_(){try{return typeof indexedDB=="object"}catch{return!1}}function sE(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var o;e(((o=i.error)===null||o===void 0?void 0:o.message)||"")}}catch(n){e(n)}})}function PC(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NC="FirebaseError";class Sr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=NC,Object.setPrototypeOf(this,Sr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ca.prototype.create)}}class ca{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,o=this.errors[e],a=o?AC(o,r):"Error",u=`${this.serviceName}: ${a} (${i}).`;return new Sr(i,u,r)}}function AC(t,e){return t.replace(CC,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const CC=/\{\$([^}]+)}/g;function RC(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Nl(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const o=t[i],a=e[i];if(Ix(o)&&Ix(a)){if(!Nl(o,a))return!1}else if(o!==a)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Ix(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qu(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Bc(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,o]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(o)}}),e}function zc(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function jC(t,e){const n=new LC(t,e);return n.subscribe.bind(n)}class LC{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");DC(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=gp),i.error===void 0&&(i.error=gp),i.complete===void 0&&(i.complete=gp);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function DC(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function gp(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Je(t){return t&&t._delegate?t._delegate:t}class or{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MC{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new xC;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(VC(e))try{this.getOrInitializeService({instanceIdentifier:Eo})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(e=Eo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Eo){return this.instances.has(e)}getOptions(e=Eo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[o,a]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(o);r===u&&a.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),o=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;o.add(e),this.onInitCallbacks.set(i,o);const a=this.instances.get(i);return a&&e(a,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:OC(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Eo){return this.component?this.component.multipleInstances?e:Eo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function OC(t){return t===Eo?void 0:t}function VC(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new MC(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var qe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(qe||(qe={}));const UC={debug:qe.DEBUG,verbose:qe.VERBOSE,info:qe.INFO,warn:qe.WARN,error:qe.ERROR,silent:qe.SILENT},BC=qe.INFO,zC={[qe.DEBUG]:"log",[qe.VERBOSE]:"log",[qe.INFO]:"info",[qe.WARN]:"warn",[qe.ERROR]:"error"},qC=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=zC[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class u_{constructor(e){this.name=e,this._logLevel=BC,this._logHandler=qC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in qe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?UC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,qe.DEBUG,...e),this._logHandler(this,qe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,qe.VERBOSE,...e),this._logHandler(this,qe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,qe.INFO,...e),this._logHandler(this,qe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,qe.WARN,...e),this._logHandler(this,qe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,qe.ERROR,...e),this._logHandler(this,qe.ERROR,...e)}}const $C=(t,e)=>e.some(n=>t instanceof n);let Tx,Ex;function HC(){return Tx||(Tx=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function WC(){return Ex||(Ex=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const oE=new WeakMap,Rg=new WeakMap,aE=new WeakMap,yp=new WeakMap,d_=new WeakMap;function GC(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",o),t.removeEventListener("error",a)},o=()=>{n(Gi(t.result)),i()},a=()=>{r(t.error),i()};t.addEventListener("success",o),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&oE.set(n,t)}).catch(()=>{}),d_.set(e,t),e}function KC(t){if(Rg.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",a),t.removeEventListener("abort",a)},o=()=>{n(),i()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",o),t.addEventListener("error",a),t.addEventListener("abort",a)});Rg.set(t,e)}let jg={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Rg.get(t);if(e==="objectStoreNames")return t.objectStoreNames||aE.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Gi(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function ZC(t){jg=t(jg)}function QC(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(_p(this),e,...n);return aE.set(r,e.sort?e.sort():[e]),Gi(r)}:WC().includes(t)?function(...e){return t.apply(_p(this),e),Gi(oE.get(this))}:function(...e){return Gi(t.apply(_p(this),e))}}function YC(t){return typeof t=="function"?QC(t):(t instanceof IDBTransaction&&KC(t),$C(t,HC())?new Proxy(t,jg):t)}function Gi(t){if(t instanceof IDBRequest)return GC(t);if(yp.has(t))return yp.get(t);const e=YC(t);return e!==t&&(yp.set(t,e),d_.set(e,t)),e}const _p=t=>d_.get(t);function Yf(t,e,{blocked:n,upgrade:r,blocking:i,terminated:o}={}){const a=indexedDB.open(t,e),u=Gi(a);return r&&a.addEventListener("upgradeneeded",h=>{r(Gi(a.result),h.oldVersion,h.newVersion,Gi(a.transaction),h)}),n&&a.addEventListener("blocked",h=>n(h.oldVersion,h.newVersion,h)),u.then(h=>{o&&h.addEventListener("close",()=>o()),i&&h.addEventListener("versionchange",m=>i(m.oldVersion,m.newVersion,m))}).catch(()=>{}),u}function vp(t,{blocked:e}={}){const n=indexedDB.deleteDatabase(t);return e&&n.addEventListener("blocked",r=>e(r.oldVersion,r)),Gi(n).then(()=>{})}const JC=["get","getKey","getAll","getAllKeys","count"],XC=["put","add","delete","clear"],xp=new Map;function kx(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(xp.get(e))return xp.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=XC.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||JC.includes(n)))return;const o=async function(a,...u){const h=this.transaction(a,i?"readwrite":"readonly");let m=h.store;return r&&(m=m.index(u.shift())),(await Promise.all([m[n](...u),i&&h.done]))[0]};return xp.set(e,o),o}ZC(t=>({...t,get:(e,n,r)=>kx(e,n)||t.get(e,n,r),has:(e,n)=>!!kx(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e2{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(t2(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function t2(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Lg="@firebase/app",Sx="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const es=new u_("@firebase/app"),n2="@firebase/app-compat",r2="@firebase/analytics-compat",i2="@firebase/analytics",s2="@firebase/app-check-compat",o2="@firebase/app-check",a2="@firebase/auth",l2="@firebase/auth-compat",c2="@firebase/database",u2="@firebase/data-connect",d2="@firebase/database-compat",h2="@firebase/functions",f2="@firebase/functions-compat",m2="@firebase/installations",p2="@firebase/installations-compat",g2="@firebase/messaging",y2="@firebase/messaging-compat",_2="@firebase/performance",v2="@firebase/performance-compat",x2="@firebase/remote-config",w2="@firebase/remote-config-compat",b2="@firebase/storage",I2="@firebase/storage-compat",T2="@firebase/firestore",E2="@firebase/vertexai-preview",k2="@firebase/firestore-compat",S2="firebase",P2="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dg="[DEFAULT]",N2={[Lg]:"fire-core",[n2]:"fire-core-compat",[i2]:"fire-analytics",[r2]:"fire-analytics-compat",[o2]:"fire-app-check",[s2]:"fire-app-check-compat",[a2]:"fire-auth",[l2]:"fire-auth-compat",[c2]:"fire-rtdb",[u2]:"fire-data-connect",[d2]:"fire-rtdb-compat",[h2]:"fire-fn",[f2]:"fire-fn-compat",[m2]:"fire-iid",[p2]:"fire-iid-compat",[g2]:"fire-fcm",[y2]:"fire-fcm-compat",[_2]:"fire-perf",[v2]:"fire-perf-compat",[x2]:"fire-rc",[w2]:"fire-rc-compat",[b2]:"fire-gcs",[I2]:"fire-gcs-compat",[T2]:"fire-fst",[k2]:"fire-fst-compat",[E2]:"fire-vertex","fire-js":"fire-js",[S2]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cf=new Map,A2=new Map,Mg=new Map;function Px(t,e){try{t.container.addComponent(e)}catch(n){es.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Er(t){const e=t.name;if(Mg.has(e))return es.debug(`There were multiple attempts to register component ${e}.`),!1;Mg.set(e,t);for(const n of cf.values())Px(n,t);for(const n of A2.values())Px(n,t);return!0}function lo(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function zr(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C2={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ys=new ca("app","Firebase",C2);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R2{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new or("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ys.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ua=P2;function lE(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Dg,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Ys.create("bad-app-name",{appName:String(i)});if(n||(n=nE()),!n)throw Ys.create("no-options");const o=cf.get(i);if(o){if(Nl(n,o.options)&&Nl(r,o.config))return o;throw Ys.create("duplicate-app",{appName:i})}const a=new FC(i);for(const h of Mg.values())a.addComponent(h);const u=new R2(n,r,a);return cf.set(i,u),u}function Jf(t=Dg){const e=cf.get(t);if(!e&&t===Dg&&nE())return lE();if(!e)throw Ys.create("no-app",{appName:t});return e}function pn(t,e,n){var r;let i=(r=N2[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const o=i.match(/\s|\//),a=e.match(/\s|\//);if(o||a){const u=[`Unable to register library "${i}" with version "${e}":`];o&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&a&&u.push("and"),a&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),es.warn(u.join(" "));return}Er(new or(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j2="firebase-heartbeat-database",L2=1,Pu="firebase-heartbeat-store";let wp=null;function cE(){return wp||(wp=Yf(j2,L2,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Pu)}catch(n){console.warn(n)}}}}).catch(t=>{throw Ys.create("idb-open",{originalErrorMessage:t.message})})),wp}async function D2(t){try{const n=(await cE()).transaction(Pu),r=await n.objectStore(Pu).get(uE(t));return await n.done,r}catch(e){if(e instanceof Sr)es.warn(e.message);else{const n=Ys.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});es.warn(n.message)}}}async function Nx(t,e){try{const r=(await cE()).transaction(Pu,"readwrite");await r.objectStore(Pu).put(e,uE(t)),await r.done}catch(n){if(n instanceof Sr)es.warn(n.message);else{const r=Ys.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});es.warn(r.message)}}}function uE(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M2=1024,O2=30*24*60*60*1e3;class V2{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new U2(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=Ax();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(a=>a.date===o)?void 0:(this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const u=new Date(a.date).valueOf();return Date.now()-u<=O2}),this._storage.overwrite(this._heartbeatsCache))}catch(r){es.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Ax(),{heartbeatsToSend:r,unsentEntries:i}=F2(this._heartbeatsCache.heartbeats),o=lf(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(n){return es.warn(n),""}}}function Ax(){return new Date().toISOString().substring(0,10)}function F2(t,e=M2){const n=[];let r=t.slice();for(const i of t){const o=n.find(a=>a.agent===i.agent);if(o){if(o.dates.push(i.date),Cx(n)>e){o.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Cx(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class U2{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return c_()?sE().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await D2(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Nx(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Nx(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Cx(t){return lf(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B2(t){Er(new or("platform-logger",e=>new e2(e),"PRIVATE")),Er(new or("heartbeat",e=>new V2(e),"PRIVATE")),pn(Lg,Sx,t),pn(Lg,Sx,"esm2017"),pn("fire-js","")}B2("");function h_(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function dE(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const z2=dE,hE=new ca("auth","Firebase",dE());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uf=new u_("@firebase/auth");function q2(t,...e){uf.logLevel<=qe.WARN&&uf.warn(`Auth (${ua}): ${t}`,...e)}function wh(t,...e){uf.logLevel<=qe.ERROR&&uf.error(`Auth (${ua}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kr(t,...e){throw m_(t,...e)}function Wr(t,...e){return m_(t,...e)}function f_(t,e,n){const r=Object.assign(Object.assign({},z2()),{[e]:n});return new ca("auth","Firebase",r).create(e,{appName:t.name})}function Ki(t){return f_(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function $2(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&kr(t,"argument-error"),f_(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function m_(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return hE.create(t,...e)}function Ae(t,e,...n){if(!t)throw m_(e,...n)}function Ui(t){const e="INTERNAL ASSERTION FAILED: "+t;throw wh(e),new Error(e)}function ts(t,e){t||Ui(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Og(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function H2(){return Rx()==="http:"||Rx()==="https:"}function Rx(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W2(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(H2()||EC()||"connection"in navigator)?navigator.onLine:!0}function G2(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yu{constructor(e,n){this.shortDelay=e,this.longDelay=n,ts(n>e,"Short delay should be less than long delay!"),this.isMobile=bC()||kC()}get(){return W2()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p_(t,e){ts(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fE{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ui("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ui("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ui("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K2={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z2=new Yu(3e4,6e4);function ss(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function os(t,e,n,r,i={}){return mE(t,i,async()=>{let o={},a={};r&&(e==="GET"?a=r:o={body:JSON.stringify(r)});const u=Qu(Object.assign({key:t.config.apiKey},a)).slice(1),h=await t._getAdditionalHeaders();h["Content-Type"]="application/json",t.languageCode&&(h["X-Firebase-Locale"]=t.languageCode);const m=Object.assign({method:e,headers:h},o);return TC()||(m.referrerPolicy="no-referrer"),fE.fetch()(pE(t,t.config.apiHost,n,u),m)})}async function mE(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},K2),e);try{const i=new Y2(t),o=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const a=await o.json();if("needConfirmation"in a)throw Qd(t,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{const u=o.ok?a.errorMessage:a.error.message,[h,m]=u.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw Qd(t,"credential-already-in-use",a);if(h==="EMAIL_EXISTS")throw Qd(t,"email-already-in-use",a);if(h==="USER_DISABLED")throw Qd(t,"user-disabled",a);const y=r[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw f_(t,y,m);kr(t,y)}}catch(i){if(i instanceof Sr)throw i;kr(t,"network-request-failed",{message:String(i)})}}async function Ju(t,e,n,r,i={}){const o=await os(t,e,n,r,i);return"mfaPendingCredential"in o&&kr(t,"multi-factor-auth-required",{_serverResponse:o}),o}function pE(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?p_(t.config,i):`${t.config.apiScheme}://${i}`}function Q2(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Y2{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Wr(this.auth,"network-request-failed")),Z2.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Qd(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Wr(t,e,r);return i.customData._tokenResponse=n,i}function jx(t){return t!==void 0&&t.enterprise!==void 0}class J2{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return Q2(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function X2(t,e){return os(t,"GET","/v2/recaptchaConfig",ss(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eR(t,e){return os(t,"POST","/v1/accounts:delete",e)}async function gE(t,e){return os(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nu(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function tR(t,e=!1){const n=Je(t),r=await n.getIdToken(e),i=g_(r);Ae(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const o=typeof i.firebase=="object"?i.firebase:void 0,a=o==null?void 0:o.sign_in_provider;return{claims:i,token:r,authTime:nu(bp(i.auth_time)),issuedAtTime:nu(bp(i.iat)),expirationTime:nu(bp(i.exp)),signInProvider:a||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function bp(t){return Number(t)*1e3}function g_(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return wh("JWT malformed, contained fewer than 3 sections"),null;try{const i=XT(n);return i?JSON.parse(i):(wh("Failed to decode base64 JWT payload"),null)}catch(i){return wh("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function Lx(t){const e=g_(t);return Ae(e,"internal-error"),Ae(typeof e.exp<"u","internal-error"),Ae(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nu(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Sr&&nR(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function nR({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rR{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vg{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=nu(this.lastLoginAt),this.creationTime=nu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function df(t){var e;const n=t.auth,r=await t.getIdToken(),i=await Nu(t,gE(n,{idToken:r}));Ae(i==null?void 0:i.users.length,n,"internal-error");const o=i.users[0];t._notifyReloadListener(o);const a=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?yE(o.providerUserInfo):[],u=sR(t.providerData,a),h=t.isAnonymous,m=!(t.email&&o.passwordHash)&&!(u!=null&&u.length),y=h?m:!1,v={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new Vg(o.createdAt,o.lastLoginAt),isAnonymous:y};Object.assign(t,v)}async function iR(t){const e=Je(t);await df(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function sR(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function yE(t){return t.map(e=>{var{providerId:n}=e,r=h_(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oR(t,e){const n=await mE(t,{},async()=>{const r=Qu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=t.config,a=pE(t,i,"/v1/token",`key=${o}`),u=await t._getAdditionalHeaders();return u["Content-Type"]="application/x-www-form-urlencoded",fE.fetch()(a,{method:"POST",headers:u,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function aR(t,e){return os(t,"POST","/v2/accounts:revokeToken",ss(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ae(e.idToken,"internal-error"),Ae(typeof e.idToken<"u","internal-error"),Ae(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Lx(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Ae(e.length!==0,"internal-error");const n=Lx(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Ae(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:o}=await oR(e,n);this.updateTokensAndExpiration(r,i,Number(o))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:o}=n,a=new yl;return r&&(Ae(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(Ae(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),o&&(Ae(typeof o=="number","internal-error",{appName:e}),a.expirationTime=o),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new yl,this.toJSON())}_performRefresh(){return Ui("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ks(t,e){Ae(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Bi{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,o=h_(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new rR(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new Vg(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const n=await Nu(this,this.stsTokenManager.getToken(this.auth,e));return Ae(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return tR(this,e)}reload(){return iR(this)}_assign(e){this!==e&&(Ae(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Bi(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){Ae(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await df(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(zr(this.auth.app))return Promise.reject(Ki(this.auth));const e=await this.getIdToken();return await Nu(this,eR(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,o,a,u,h,m,y;const v=(r=n.displayName)!==null&&r!==void 0?r:void 0,w=(i=n.email)!==null&&i!==void 0?i:void 0,S=(o=n.phoneNumber)!==null&&o!==void 0?o:void 0,N=(a=n.photoURL)!==null&&a!==void 0?a:void 0,P=(u=n.tenantId)!==null&&u!==void 0?u:void 0,F=(h=n._redirectEventId)!==null&&h!==void 0?h:void 0,R=(m=n.createdAt)!==null&&m!==void 0?m:void 0,k=(y=n.lastLoginAt)!==null&&y!==void 0?y:void 0,{uid:A,emailVerified:z,isAnonymous:G,providerData:W,stsTokenManager:T}=n;Ae(A&&T,e,"internal-error");const b=yl.fromJSON(this.name,T);Ae(typeof A=="string",e,"internal-error"),ks(v,e.name),ks(w,e.name),Ae(typeof z=="boolean",e,"internal-error"),Ae(typeof G=="boolean",e,"internal-error"),ks(S,e.name),ks(N,e.name),ks(P,e.name),ks(F,e.name),ks(R,e.name),ks(k,e.name);const C=new Bi({uid:A,auth:e,email:w,emailVerified:z,displayName:v,isAnonymous:G,photoURL:N,phoneNumber:S,tenantId:P,stsTokenManager:b,createdAt:R,lastLoginAt:k});return W&&Array.isArray(W)&&(C.providerData=W.map(D=>Object.assign({},D))),F&&(C._redirectEventId=F),C}static async _fromIdTokenResponse(e,n,r=!1){const i=new yl;i.updateFromServerResponse(n);const o=new Bi({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await df(o),o}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];Ae(i.localId!==void 0,"internal-error");const o=i.providerUserInfo!==void 0?yE(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(o!=null&&o.length),u=new yl;u.updateFromIdToken(r);const h=new Bi({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:a}),m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Vg(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(o!=null&&o.length)};return Object.assign(h,m),h}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dx=new Map;function zi(t){ts(t instanceof Function,"Expected a class definition");let e=Dx.get(t);return e?(ts(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Dx.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _E{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}_E.type="NONE";const Mx=_E;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bh(t,e,n){return`firebase:${t}:${e}:${n}`}class _l{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:o}=this.auth;this.fullUserKey=bh(this.userKey,i.apiKey,o),this.fullPersistenceKey=bh("persistence",i.apiKey,o),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Bi._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new _l(zi(Mx),e,r);const i=(await Promise.all(n.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let o=i[0]||zi(Mx);const a=bh(r,e.config.apiKey,e.name);let u=null;for(const m of n)try{const y=await m._get(a);if(y){const v=Bi._fromJSON(e,y);m!==o&&(u=v),o=m;break}}catch{}const h=i.filter(m=>m._shouldAllowMigration);return!o._shouldAllowMigration||!h.length?new _l(o,e,r):(o=h[0],u&&await o._set(a,u.toJSON()),await Promise.all(n.map(async m=>{if(m!==o)try{await m._remove(a)}catch{}})),new _l(o,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ox(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(bE(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(vE(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(TE(e))return"Blackberry";if(EE(e))return"Webos";if(xE(e))return"Safari";if((e.includes("chrome/")||wE(e))&&!e.includes("edge/"))return"Chrome";if(IE(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function vE(t=Wt()){return/firefox\//i.test(t)}function xE(t=Wt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function wE(t=Wt()){return/crios\//i.test(t)}function bE(t=Wt()){return/iemobile/i.test(t)}function IE(t=Wt()){return/android/i.test(t)}function TE(t=Wt()){return/blackberry/i.test(t)}function EE(t=Wt()){return/webos/i.test(t)}function y_(t=Wt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function lR(t=Wt()){var e;return y_(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function cR(){return SC()&&document.documentMode===10}function kE(t=Wt()){return y_(t)||IE(t)||EE(t)||TE(t)||/windows phone/i.test(t)||bE(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SE(t,e=[]){let n;switch(t){case"Browser":n=Ox(Wt());break;case"Worker":n=`${Ox(Wt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${ua}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uR{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=o=>new Promise((a,u)=>{try{const h=e(o);a(h)}catch(h){u(h)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dR(t,e={}){return os(t,"GET","/v2/passwordPolicy",ss(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hR=6;class fR{constructor(e){var n,r,i,o;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=a.minPasswordLength)!==null&&n!==void 0?n:hR,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,o,a,u;const h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(n=h.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),h.isValid&&(h.isValid=(r=h.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(i=h.containsLowercaseLetter)!==null&&i!==void 0?i:!0),h.isValid&&(h.isValid=(o=h.containsUppercaseLetter)!==null&&o!==void 0?o:!0),h.isValid&&(h.isValid=(a=h.containsNumericCharacter)!==null&&a!==void 0?a:!0),h.isValid&&(h.isValid=(u=h.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),h}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mR{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Vx(this),this.idTokenSubscription=new Vx(this),this.beforeStateQueue=new uR(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=hE,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=zi(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await _l.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await gE(this,{idToken:e}),r=await Bi._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(zr(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(u,u))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,u=i==null?void 0:i._redirectEventId,h=await this.tryRedirectSignIn(e);(!a||a===u)&&(h!=null&&h.user)&&(i=h.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Ae(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await df(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=G2()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(zr(this.app))return Promise.reject(Ki(this));const n=e?Je(e):null;return n&&Ae(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Ae(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return zr(this.app)?Promise.reject(Ki(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return zr(this.app)?Promise.reject(Ki(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(zi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await dR(this),n=new fR(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new ca("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await aR(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&zi(e)||this._popupRedirectResolver;Ae(n,this,"argument-error"),this.redirectPersistenceManager=await _l.create(this,[zi(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const o=typeof n=="function"?n:n.next.bind(n);let a=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ae(u,this,"internal-error"),u.then(()=>{a||o(this.currentUser)}),typeof n=="function"){const h=e.addObserver(n,r,i);return()=>{a=!0,h()}}else{const h=e.addObserver(n);return()=>{a=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ae(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=SE(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&q2(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function wi(t){return Je(t)}class Vx{constructor(e){this.auth=e,this.observer=null,this.addObserver=jC(n=>this.observer=n)}get next(){return Ae(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function pR(t){Xf=t}function PE(t){return Xf.loadJS(t)}function gR(){return Xf.recaptchaEnterpriseScript}function yR(){return Xf.gapiScript}function _R(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const vR="recaptcha-enterprise",xR="NO_RECAPTCHA";class wR{constructor(e){this.type=vR,this.auth=wi(e)}async verify(e="verify",n=!1){async function r(o){if(!n){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(a,u)=>{X2(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{const m=new J2(h);return o.tenantId==null?o._agentRecaptchaConfig=m:o._tenantRecaptchaConfigs[o.tenantId]=m,a(m.siteKey)}}).catch(h=>{u(h)})})}function i(o,a,u){const h=window.grecaptcha;jx(h)?h.enterprise.ready(()=>{h.enterprise.execute(o,{action:e}).then(m=>{a(m)}).catch(()=>{a(xR)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((o,a)=>{r(this.auth).then(u=>{if(!n&&jx(window.grecaptcha))i(u,o,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let h=gR();h.length!==0&&(h+=u),PE(h).then(()=>{i(u,o,a)}).catch(m=>{a(m)})}}).catch(u=>{a(u)})})}}async function Fx(t,e,n,r=!1){const i=new wR(t);let o;try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const a=Object.assign({},e);return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function hf(t,e,n,r){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await Fx(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await Fx(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bR(t,e){const n=lo(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),o=n.getOptions();if(Nl(o,e??{}))return i;kr(i,"already-initialized")}return n.initialize({options:e})}function IR(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(zi);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function TR(t,e,n){const r=wi(t);Ae(r._canInitEmulator,r,"emulator-config-failed"),Ae(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,o=NE(e),{host:a,port:u}=ER(e),h=u===null?"":`:${u}`;r.config.emulator={url:`${o}//${a}${h}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:u,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})}),kR()}function NE(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function ER(t){const e=NE(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const o=i[1];return{host:o,port:Ux(r.substr(o.length+1))}}else{const[o,a]=r.split(":");return{host:o,port:Ux(a)}}}function Ux(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function kR(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Ui("not implemented")}_getIdTokenResponse(e){return Ui("not implemented")}_linkToIdToken(e,n){return Ui("not implemented")}_getReauthenticationResolver(e){return Ui("not implemented")}}async function SR(t,e){return os(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PR(t,e){return Ju(t,"POST","/v1/accounts:signInWithPassword",ss(t,e))}async function AE(t,e){return os(t,"POST","/v1/accounts:sendOobCode",ss(t,e))}async function NR(t,e){return AE(t,e)}async function AR(t,e){return AE(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CR(t,e){return Ju(t,"POST","/v1/accounts:signInWithEmailLink",ss(t,e))}async function RR(t,e){return Ju(t,"POST","/v1/accounts:signInWithEmailLink",ss(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Au extends __{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new Au(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Au(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return hf(e,n,"signInWithPassword",PR);case"emailLink":return CR(e,{email:this._email,oobCode:this._password});default:kr(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return hf(e,r,"signUpPassword",SR);case"emailLink":return RR(e,{idToken:n,email:this._email,oobCode:this._password});default:kr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vl(t,e){return Ju(t,"POST","/v1/accounts:signInWithIdp",ss(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jR="http://localhost";class Ko extends __{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ko(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):kr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,o=h_(n,["providerId","signInMethod"]);if(!r||!i)return null;const a=new Ko(r,i);return a.idToken=o.idToken||void 0,a.accessToken=o.accessToken||void 0,a.secret=o.secret,a.nonce=o.nonce,a.pendingToken=o.pendingToken||null,a}_getIdTokenResponse(e){const n=this.buildRequest();return vl(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,vl(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,vl(e,n)}buildRequest(){const e={requestUri:jR,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Qu(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LR(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function DR(t){const e=Bc(zc(t)).link,n=e?Bc(zc(e)).deep_link_id:null,r=Bc(zc(t)).deep_link_id;return(r?Bc(zc(r)).link:null)||r||n||e||t}class v_{constructor(e){var n,r,i,o,a,u;const h=Bc(zc(e)),m=(n=h.apiKey)!==null&&n!==void 0?n:null,y=(r=h.oobCode)!==null&&r!==void 0?r:null,v=LR((i=h.mode)!==null&&i!==void 0?i:null);Ae(m&&y&&v,"argument-error"),this.apiKey=m,this.operation=v,this.code=y,this.continueUrl=(o=h.continueUrl)!==null&&o!==void 0?o:null,this.languageCode=(a=h.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(u=h.tenantId)!==null&&u!==void 0?u:null}static parseLink(e){const n=DR(e);try{return new v_(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kl{constructor(){this.providerId=Kl.PROVIDER_ID}static credential(e,n){return Au._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=v_.parseLink(n);return Ae(r,"argument-error"),Au._fromEmailAndCode(e,r.code,r.tenantId)}}Kl.PROVIDER_ID="password";Kl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Kl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x_{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xu extends x_{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class js extends Xu{constructor(){super("facebook.com")}static credential(e){return Ko._fromParams({providerId:js.PROVIDER_ID,signInMethod:js.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return js.credentialFromTaggedObject(e)}static credentialFromError(e){return js.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return js.credential(e.oauthAccessToken)}catch{return null}}}js.FACEBOOK_SIGN_IN_METHOD="facebook.com";js.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi extends Xu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ko._fromParams({providerId:Mi.PROVIDER_ID,signInMethod:Mi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Mi.credentialFromTaggedObject(e)}static credentialFromError(e){return Mi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Mi.credential(n,r)}catch{return null}}}Mi.GOOGLE_SIGN_IN_METHOD="google.com";Mi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ls extends Xu{constructor(){super("github.com")}static credential(e){return Ko._fromParams({providerId:Ls.PROVIDER_ID,signInMethod:Ls.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ls.credentialFromTaggedObject(e)}static credentialFromError(e){return Ls.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ls.credential(e.oauthAccessToken)}catch{return null}}}Ls.GITHUB_SIGN_IN_METHOD="github.com";Ls.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds extends Xu{constructor(){super("twitter.com")}static credential(e,n){return Ko._fromParams({providerId:Ds.PROVIDER_ID,signInMethod:Ds.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Ds.credentialFromTaggedObject(e)}static credentialFromError(e){return Ds.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Ds.credential(n,r)}catch{return null}}}Ds.TWITTER_SIGN_IN_METHOD="twitter.com";Ds.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MR(t,e){return Ju(t,"POST","/v1/accounts:signUp",ss(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const o=await Bi._fromIdTokenResponse(e,r,i),a=Bx(r);return new Zo({user:o,providerId:a,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=Bx(r);return new Zo({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function Bx(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ff extends Sr{constructor(e,n,r,i){var o;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,ff.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new ff(e,n,r,i)}}function CE(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?ff._fromErrorAndOperation(t,o,e,r):o})}async function OR(t,e,n=!1){const r=await Nu(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Zo._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VR(t,e,n=!1){const{auth:r}=t;if(zr(r.app))return Promise.reject(Ki(r));const i="reauthenticate";try{const o=await Nu(t,CE(r,i,e,t),n);Ae(o.idToken,r,"internal-error");const a=g_(o.idToken);Ae(a,r,"internal-error");const{sub:u}=a;return Ae(t.uid===u,r,"user-mismatch"),Zo._forOperation(t,i,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&kr(r,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RE(t,e,n=!1){if(zr(t.app))return Promise.reject(Ki(t));const r="signIn",i=await CE(t,r,e),o=await Zo._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(o.user),o}async function FR(t,e){return RE(wi(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jE(t){const e=wi(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function UR(t,e,n){const r=wi(t);await hf(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",AR)}async function BR(t,e,n){if(zr(t.app))return Promise.reject(Ki(t));const r=wi(t),a=await hf(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",MR).catch(h=>{throw h.code==="auth/password-does-not-meet-requirements"&&jE(t),h}),u=await Zo._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(u.user),u}function zR(t,e,n){return zr(t.app)?Promise.reject(Ki(t)):FR(Je(t),Kl.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&jE(t),r})}async function LE(t,e){const n=Je(t),i={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()},{email:o}=await NR(n.auth,i);o!==t.email&&await t.reload()}function qR(t,e,n,r){return Je(t).onIdTokenChanged(e,n,r)}function $R(t,e,n){return Je(t).beforeAuthStateChanged(e,n)}function HR(t,e,n,r){return Je(t).onAuthStateChanged(e,n,r)}function DE(t){return Je(t).signOut()}const mf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ME{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(mf,"1"),this.storage.removeItem(mf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WR=1e3,GR=10;class OE extends ME{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=kE(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((a,u,h)=>{this.notifyListeners(a,h)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(r);!n&&this.localCache[r]===a||this.notifyListeners(r,a)},o=this.storage.getItem(r);cR()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,GR):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},WR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}OE.type="LOCAL";const KR=OE;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VE extends ME{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}VE.type="SESSION";const FE=VE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZR(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class em{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new em(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:o}=n.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const u=Array.from(a).map(async m=>m(n.origin,o)),h=await ZR(u);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:h})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}em.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w_(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QR{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,a;return new Promise((u,h)=>{const m=w_("",20);i.port1.start();const y=setTimeout(()=>{h(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(v){const w=v;if(w.data.eventId===m)switch(w.data.status){case"ack":clearTimeout(y),o=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),u(w.data.response);break;default:clearTimeout(y),clearTimeout(o),h(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:m,data:n},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yi(){return window}function YR(t){yi().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UE(){return typeof yi().WorkerGlobalScope<"u"&&typeof yi().importScripts=="function"}async function JR(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function XR(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function ej(){return UE()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BE="firebaseLocalStorageDb",tj=1,pf="firebaseLocalStorage",zE="fbase_key";class ed{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function tm(t,e){return t.transaction([pf],e?"readwrite":"readonly").objectStore(pf)}function nj(){const t=indexedDB.deleteDatabase(BE);return new ed(t).toPromise()}function Fg(){const t=indexedDB.open(BE,tj);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(pf,{keyPath:zE})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(pf)?e(r):(r.close(),await nj(),e(await Fg()))})})}async function zx(t,e,n){const r=tm(t,!0).put({[zE]:e,value:n});return new ed(r).toPromise()}async function rj(t,e){const n=tm(t,!1).get(e),r=await new ed(n).toPromise();return r===void 0?null:r.value}function qx(t,e){const n=tm(t,!0).delete(e);return new ed(n).toPromise()}const ij=800,sj=3;class qE{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Fg(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>sj)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return UE()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=em._getInstance(ej()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await JR(),!this.activeServiceWorker)return;this.sender=new QR(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||XR()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Fg();return await zx(e,mf,"1"),await qx(e,mf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>zx(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>rj(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>qx(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const o=tm(i,!1).getAll();return new ed(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:o}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(o)&&(this.notifyListeners(i,o),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),ij)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}qE.type="LOCAL";const oj=qE;new Yu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $E(t,e){return e?zi(e):(Ae(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b_ extends __{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return vl(e,this._buildIdpRequest())}_linkToIdToken(e,n){return vl(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return vl(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function aj(t){return RE(t.auth,new b_(t),t.bypassAuthState)}function lj(t){const{auth:e,user:n}=t;return Ae(n,e,"internal-error"),VR(n,new b_(t),t.bypassAuthState)}async function cj(t){const{auth:e,user:n}=t;return Ae(n,e,"internal-error"),OR(n,new b_(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HE{constructor(e,n,r,i,o=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:o,error:a,type:u}=e;if(a){this.reject(a);return}const h={auth:this.auth,requestUri:n,sessionId:r,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(h))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return aj;case"linkViaPopup":case"linkViaRedirect":return cj;case"reauthViaPopup":case"reauthViaRedirect":return lj;default:kr(this.auth,"internal-error")}}resolve(e){ts(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ts(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uj=new Yu(2e3,1e4);async function dj(t,e,n){if(zr(t.app))return Promise.reject(Wr(t,"operation-not-supported-in-this-environment"));const r=wi(t);$2(t,e,x_);const i=$E(r,n);return new Do(r,"signInViaPopup",e,i).executeNotNull()}class Do extends HE{constructor(e,n,r,i,o){super(e,n,i,o),this.provider=r,this.authWindow=null,this.pollId=null,Do.currentPopupAction&&Do.currentPopupAction.cancel(),Do.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ae(e,this.auth,"internal-error"),e}async onExecution(){ts(this.filter.length===1,"Popup operations only handle one event");const e=w_();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Wr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Wr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Do.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Wr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,uj.get())};e()}}Do.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hj="pendingRedirect",Ih=new Map;class fj extends HE{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Ih.get(this.auth._key());if(!e){try{const r=await mj(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Ih.set(this.auth._key(),e)}return this.bypassAuthState||Ih.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function mj(t,e){const n=yj(e),r=gj(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function pj(t,e){Ih.set(t._key(),e)}function gj(t){return zi(t._redirectPersistence)}function yj(t){return bh(hj,t.config.apiKey,t.name)}async function _j(t,e){return await wi(t)._initializationPromise,WE(t,e,!1)}async function WE(t,e,n=!1){if(zr(t.app))return Promise.reject(Ki(t));const r=wi(t),i=$E(r,e),a=await new fj(r,i,n).execute();return a&&!n&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vj=10*60*1e3;class xj{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!wj(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!GE(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Wr(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=vj&&this.cachedEventUids.clear(),this.cachedEventUids.has($x(e))}saveEventToCache(e){this.cachedEventUids.add($x(e)),this.lastProcessedEventTime=Date.now()}}function $x(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function GE({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function wj(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return GE(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bj(t,e={}){return os(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ij=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Tj=/^https?/;async function Ej(t){if(t.config.emulator)return;const{authorizedDomains:e}=await bj(t);for(const n of e)try{if(kj(n))return}catch{}kr(t,"unauthorized-domain")}function kj(t){const e=Og(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&a.hostname===r}if(!Tj.test(n))return!1;if(Ij.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sj=new Yu(3e4,6e4);function Hx(){const t=yi().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function Pj(t){return new Promise((e,n)=>{var r,i,o;function a(){Hx(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Hx(),n(Wr(t,"network-request-failed"))},timeout:Sj.get()})}if(!((i=(r=yi().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((o=yi().gapi)===null||o===void 0)&&o.load)a();else{const u=_R("iframefcb");return yi()[u]=()=>{gapi.load?a():n(Wr(t,"network-request-failed"))},PE(`${yR()}?onload=${u}`).catch(h=>n(h))}}).catch(e=>{throw Th=null,e})}let Th=null;function Nj(t){return Th=Th||Pj(t),Th}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aj=new Yu(5e3,15e3),Cj="__/auth/iframe",Rj="emulator/auth/iframe",jj={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Lj=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Dj(t){const e=t.config;Ae(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?p_(e,Rj):`https://${t.config.authDomain}/${Cj}`,r={apiKey:e.apiKey,appName:t.name,v:ua},i=Lj.get(t.config.apiHost);i&&(r.eid=i);const o=t._getFrameworks();return o.length&&(r.fw=o.join(",")),`${n}?${Qu(r).slice(1)}`}async function Mj(t){const e=await Nj(t),n=yi().gapi;return Ae(n,t,"internal-error"),e.open({where:document.body,url:Dj(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:jj,dontclear:!0},r=>new Promise(async(i,o)=>{await r.restyle({setHideOnLeave:!1});const a=Wr(t,"network-request-failed"),u=yi().setTimeout(()=>{o(a)},Aj.get());function h(){yi().clearTimeout(u),i(r)}r.ping(h).then(h,()=>{o(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oj={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Vj=500,Fj=600,Uj="_blank",Bj="http://localhost";class Wx{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function zj(t,e,n,r=Vj,i=Fj){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let u="";const h=Object.assign(Object.assign({},Oj),{width:r.toString(),height:i.toString(),top:o,left:a}),m=Wt().toLowerCase();n&&(u=wE(m)?Uj:n),vE(m)&&(e=e||Bj,h.scrollbars="yes");const y=Object.entries(h).reduce((w,[S,N])=>`${w}${S}=${N},`,"");if(lR(m)&&u!=="_self")return qj(e||"",u),new Wx(null);const v=window.open(e||"",u,y);Ae(v,t,"popup-blocked");try{v.focus()}catch{}return new Wx(v)}function qj(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $j="__/auth/handler",Hj="emulator/auth/handler",Wj=encodeURIComponent("fac");async function Gx(t,e,n,r,i,o){Ae(t.config.authDomain,t,"auth-domain-config-required"),Ae(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:ua,eventId:i};if(e instanceof x_){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",RC(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[y,v]of Object.entries({}))a[y]=v}if(e instanceof Xu){const y=e.getScopes().filter(v=>v!=="");y.length>0&&(a.scopes=y.join(","))}t.tenantId&&(a.tid=t.tenantId);const u=a;for(const y of Object.keys(u))u[y]===void 0&&delete u[y];const h=await t._getAppCheckToken(),m=h?`#${Wj}=${encodeURIComponent(h)}`:"";return`${Gj(t)}?${Qu(u).slice(1)}${m}`}function Gj({config:t}){return t.emulator?p_(t,Hj):`https://${t.authDomain}/${$j}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ip="webStorageSupport";class Kj{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=FE,this._completeRedirectFn=WE,this._overrideRedirectResult=pj}async _openPopup(e,n,r,i){var o;ts((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");const a=await Gx(e,n,r,Og(),i);return zj(e,a,w_())}async _openRedirect(e,n,r,i){await this._originValidation(e);const o=await Gx(e,n,r,Og(),i);return YR(o),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:o}=this.eventManagers[n];return i?Promise.resolve(i):(ts(o,"If manager is not set, promise should be"),o)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await Mj(e),r=new xj(e);return n.register("authEvent",i=>(Ae(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Ip,{type:Ip},i=>{var o;const a=(o=i==null?void 0:i[0])===null||o===void 0?void 0:o[Ip];a!==void 0&&n(!!a),kr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=Ej(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return kE()||xE()||y_()}}const Zj=Kj;var Kx="@firebase/auth",Zx="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qj{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Ae(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yj(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Jj(t){Er(new or("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:a,authDomain:u}=r.options;Ae(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const h={apiKey:a,authDomain:u,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:SE(t)},m=new mR(r,i,o,h);return IR(m,n),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Er(new or("auth-internal",e=>{const n=wi(e.getProvider("auth").getImmediate());return(r=>new Qj(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),pn(Kx,Zx,Yj(t)),pn(Kx,Zx,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xj=5*60,eL=rE("authIdTokenMaxAge")||Xj;let Qx=null;const tL=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>eL)return;const i=n==null?void 0:n.token;Qx!==i&&(Qx=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function nL(t=Jf()){const e=lo(t,"auth");if(e.isInitialized())return e.getImmediate();const n=bR(t,{popupRedirectResolver:Zj,persistence:[oj,KR,FE]}),r=rE("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(r,location.origin);if(location.origin===o.origin){const a=tL(o.toString());$R(n,a,()=>a(n.currentUser)),qR(n,u=>a(u))}}const i=eE("auth");return i&&TR(n,`http://${i}`),n}function rL(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}pR({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const o=Wr("internal-error");o.customData=i,n(o)},r.type="text/javascript",r.charset="UTF-8",rL().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Jj("Browser");var Yx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Uo,KE;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(T,b){function C(){}C.prototype=b.prototype,T.D=b.prototype,T.prototype=new C,T.prototype.constructor=T,T.C=function(D,V,U){for(var M=Array(arguments.length-2),le=2;le<arguments.length;le++)M[le-2]=arguments[le];return b.prototype[V].apply(D,M)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(T,b,C){C||(C=0);var D=Array(16);if(typeof b=="string")for(var V=0;16>V;++V)D[V]=b.charCodeAt(C++)|b.charCodeAt(C++)<<8|b.charCodeAt(C++)<<16|b.charCodeAt(C++)<<24;else for(V=0;16>V;++V)D[V]=b[C++]|b[C++]<<8|b[C++]<<16|b[C++]<<24;b=T.g[0],C=T.g[1],V=T.g[2];var U=T.g[3],M=b+(U^C&(V^U))+D[0]+3614090360&4294967295;b=C+(M<<7&4294967295|M>>>25),M=U+(V^b&(C^V))+D[1]+3905402710&4294967295,U=b+(M<<12&4294967295|M>>>20),M=V+(C^U&(b^C))+D[2]+606105819&4294967295,V=U+(M<<17&4294967295|M>>>15),M=C+(b^V&(U^b))+D[3]+3250441966&4294967295,C=V+(M<<22&4294967295|M>>>10),M=b+(U^C&(V^U))+D[4]+4118548399&4294967295,b=C+(M<<7&4294967295|M>>>25),M=U+(V^b&(C^V))+D[5]+1200080426&4294967295,U=b+(M<<12&4294967295|M>>>20),M=V+(C^U&(b^C))+D[6]+2821735955&4294967295,V=U+(M<<17&4294967295|M>>>15),M=C+(b^V&(U^b))+D[7]+4249261313&4294967295,C=V+(M<<22&4294967295|M>>>10),M=b+(U^C&(V^U))+D[8]+1770035416&4294967295,b=C+(M<<7&4294967295|M>>>25),M=U+(V^b&(C^V))+D[9]+2336552879&4294967295,U=b+(M<<12&4294967295|M>>>20),M=V+(C^U&(b^C))+D[10]+4294925233&4294967295,V=U+(M<<17&4294967295|M>>>15),M=C+(b^V&(U^b))+D[11]+2304563134&4294967295,C=V+(M<<22&4294967295|M>>>10),M=b+(U^C&(V^U))+D[12]+1804603682&4294967295,b=C+(M<<7&4294967295|M>>>25),M=U+(V^b&(C^V))+D[13]+4254626195&4294967295,U=b+(M<<12&4294967295|M>>>20),M=V+(C^U&(b^C))+D[14]+2792965006&4294967295,V=U+(M<<17&4294967295|M>>>15),M=C+(b^V&(U^b))+D[15]+1236535329&4294967295,C=V+(M<<22&4294967295|M>>>10),M=b+(V^U&(C^V))+D[1]+4129170786&4294967295,b=C+(M<<5&4294967295|M>>>27),M=U+(C^V&(b^C))+D[6]+3225465664&4294967295,U=b+(M<<9&4294967295|M>>>23),M=V+(b^C&(U^b))+D[11]+643717713&4294967295,V=U+(M<<14&4294967295|M>>>18),M=C+(U^b&(V^U))+D[0]+3921069994&4294967295,C=V+(M<<20&4294967295|M>>>12),M=b+(V^U&(C^V))+D[5]+3593408605&4294967295,b=C+(M<<5&4294967295|M>>>27),M=U+(C^V&(b^C))+D[10]+38016083&4294967295,U=b+(M<<9&4294967295|M>>>23),M=V+(b^C&(U^b))+D[15]+3634488961&4294967295,V=U+(M<<14&4294967295|M>>>18),M=C+(U^b&(V^U))+D[4]+3889429448&4294967295,C=V+(M<<20&4294967295|M>>>12),M=b+(V^U&(C^V))+D[9]+568446438&4294967295,b=C+(M<<5&4294967295|M>>>27),M=U+(C^V&(b^C))+D[14]+3275163606&4294967295,U=b+(M<<9&4294967295|M>>>23),M=V+(b^C&(U^b))+D[3]+4107603335&4294967295,V=U+(M<<14&4294967295|M>>>18),M=C+(U^b&(V^U))+D[8]+1163531501&4294967295,C=V+(M<<20&4294967295|M>>>12),M=b+(V^U&(C^V))+D[13]+2850285829&4294967295,b=C+(M<<5&4294967295|M>>>27),M=U+(C^V&(b^C))+D[2]+4243563512&4294967295,U=b+(M<<9&4294967295|M>>>23),M=V+(b^C&(U^b))+D[7]+1735328473&4294967295,V=U+(M<<14&4294967295|M>>>18),M=C+(U^b&(V^U))+D[12]+2368359562&4294967295,C=V+(M<<20&4294967295|M>>>12),M=b+(C^V^U)+D[5]+4294588738&4294967295,b=C+(M<<4&4294967295|M>>>28),M=U+(b^C^V)+D[8]+2272392833&4294967295,U=b+(M<<11&4294967295|M>>>21),M=V+(U^b^C)+D[11]+1839030562&4294967295,V=U+(M<<16&4294967295|M>>>16),M=C+(V^U^b)+D[14]+4259657740&4294967295,C=V+(M<<23&4294967295|M>>>9),M=b+(C^V^U)+D[1]+2763975236&4294967295,b=C+(M<<4&4294967295|M>>>28),M=U+(b^C^V)+D[4]+1272893353&4294967295,U=b+(M<<11&4294967295|M>>>21),M=V+(U^b^C)+D[7]+4139469664&4294967295,V=U+(M<<16&4294967295|M>>>16),M=C+(V^U^b)+D[10]+3200236656&4294967295,C=V+(M<<23&4294967295|M>>>9),M=b+(C^V^U)+D[13]+681279174&4294967295,b=C+(M<<4&4294967295|M>>>28),M=U+(b^C^V)+D[0]+3936430074&4294967295,U=b+(M<<11&4294967295|M>>>21),M=V+(U^b^C)+D[3]+3572445317&4294967295,V=U+(M<<16&4294967295|M>>>16),M=C+(V^U^b)+D[6]+76029189&4294967295,C=V+(M<<23&4294967295|M>>>9),M=b+(C^V^U)+D[9]+3654602809&4294967295,b=C+(M<<4&4294967295|M>>>28),M=U+(b^C^V)+D[12]+3873151461&4294967295,U=b+(M<<11&4294967295|M>>>21),M=V+(U^b^C)+D[15]+530742520&4294967295,V=U+(M<<16&4294967295|M>>>16),M=C+(V^U^b)+D[2]+3299628645&4294967295,C=V+(M<<23&4294967295|M>>>9),M=b+(V^(C|~U))+D[0]+4096336452&4294967295,b=C+(M<<6&4294967295|M>>>26),M=U+(C^(b|~V))+D[7]+1126891415&4294967295,U=b+(M<<10&4294967295|M>>>22),M=V+(b^(U|~C))+D[14]+2878612391&4294967295,V=U+(M<<15&4294967295|M>>>17),M=C+(U^(V|~b))+D[5]+4237533241&4294967295,C=V+(M<<21&4294967295|M>>>11),M=b+(V^(C|~U))+D[12]+1700485571&4294967295,b=C+(M<<6&4294967295|M>>>26),M=U+(C^(b|~V))+D[3]+2399980690&4294967295,U=b+(M<<10&4294967295|M>>>22),M=V+(b^(U|~C))+D[10]+4293915773&4294967295,V=U+(M<<15&4294967295|M>>>17),M=C+(U^(V|~b))+D[1]+2240044497&4294967295,C=V+(M<<21&4294967295|M>>>11),M=b+(V^(C|~U))+D[8]+1873313359&4294967295,b=C+(M<<6&4294967295|M>>>26),M=U+(C^(b|~V))+D[15]+4264355552&4294967295,U=b+(M<<10&4294967295|M>>>22),M=V+(b^(U|~C))+D[6]+2734768916&4294967295,V=U+(M<<15&4294967295|M>>>17),M=C+(U^(V|~b))+D[13]+1309151649&4294967295,C=V+(M<<21&4294967295|M>>>11),M=b+(V^(C|~U))+D[4]+4149444226&4294967295,b=C+(M<<6&4294967295|M>>>26),M=U+(C^(b|~V))+D[11]+3174756917&4294967295,U=b+(M<<10&4294967295|M>>>22),M=V+(b^(U|~C))+D[2]+718787259&4294967295,V=U+(M<<15&4294967295|M>>>17),M=C+(U^(V|~b))+D[9]+3951481745&4294967295,T.g[0]=T.g[0]+b&4294967295,T.g[1]=T.g[1]+(V+(M<<21&4294967295|M>>>11))&4294967295,T.g[2]=T.g[2]+V&4294967295,T.g[3]=T.g[3]+U&4294967295}r.prototype.u=function(T,b){b===void 0&&(b=T.length);for(var C=b-this.blockSize,D=this.B,V=this.h,U=0;U<b;){if(V==0)for(;U<=C;)i(this,T,U),U+=this.blockSize;if(typeof T=="string"){for(;U<b;)if(D[V++]=T.charCodeAt(U++),V==this.blockSize){i(this,D),V=0;break}}else for(;U<b;)if(D[V++]=T[U++],V==this.blockSize){i(this,D),V=0;break}}this.h=V,this.o+=b},r.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var b=1;b<T.length-8;++b)T[b]=0;var C=8*this.o;for(b=T.length-8;b<T.length;++b)T[b]=C&255,C/=256;for(this.u(T),T=Array(16),b=C=0;4>b;++b)for(var D=0;32>D;D+=8)T[C++]=this.g[b]>>>D&255;return T};function o(T,b){var C=u;return Object.prototype.hasOwnProperty.call(C,T)?C[T]:C[T]=b(T)}function a(T,b){this.h=b;for(var C=[],D=!0,V=T.length-1;0<=V;V--){var U=T[V]|0;D&&U==b||(C[V]=U,D=!1)}this.g=C}var u={};function h(T){return-128<=T&&128>T?o(T,function(b){return new a([b|0],0>b?-1:0)}):new a([T|0],0>T?-1:0)}function m(T){if(isNaN(T)||!isFinite(T))return v;if(0>T)return F(m(-T));for(var b=[],C=1,D=0;T>=C;D++)b[D]=T/C|0,C*=4294967296;return new a(b,0)}function y(T,b){if(T.length==0)throw Error("number format error: empty string");if(b=b||10,2>b||36<b)throw Error("radix out of range: "+b);if(T.charAt(0)=="-")return F(y(T.substring(1),b));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var C=m(Math.pow(b,8)),D=v,V=0;V<T.length;V+=8){var U=Math.min(8,T.length-V),M=parseInt(T.substring(V,V+U),b);8>U?(U=m(Math.pow(b,U)),D=D.j(U).add(m(M))):(D=D.j(C),D=D.add(m(M)))}return D}var v=h(0),w=h(1),S=h(16777216);t=a.prototype,t.m=function(){if(P(this))return-F(this).m();for(var T=0,b=1,C=0;C<this.g.length;C++){var D=this.i(C);T+=(0<=D?D:4294967296+D)*b,b*=4294967296}return T},t.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(N(this))return"0";if(P(this))return"-"+F(this).toString(T);for(var b=m(Math.pow(T,6)),C=this,D="";;){var V=z(C,b).g;C=R(C,V.j(b));var U=((0<C.g.length?C.g[0]:C.h)>>>0).toString(T);if(C=V,N(C))return U+D;for(;6>U.length;)U="0"+U;D=U+D}},t.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function N(T){if(T.h!=0)return!1;for(var b=0;b<T.g.length;b++)if(T.g[b]!=0)return!1;return!0}function P(T){return T.h==-1}t.l=function(T){return T=R(this,T),P(T)?-1:N(T)?0:1};function F(T){for(var b=T.g.length,C=[],D=0;D<b;D++)C[D]=~T.g[D];return new a(C,~T.h).add(w)}t.abs=function(){return P(this)?F(this):this},t.add=function(T){for(var b=Math.max(this.g.length,T.g.length),C=[],D=0,V=0;V<=b;V++){var U=D+(this.i(V)&65535)+(T.i(V)&65535),M=(U>>>16)+(this.i(V)>>>16)+(T.i(V)>>>16);D=M>>>16,U&=65535,M&=65535,C[V]=M<<16|U}return new a(C,C[C.length-1]&-2147483648?-1:0)};function R(T,b){return T.add(F(b))}t.j=function(T){if(N(this)||N(T))return v;if(P(this))return P(T)?F(this).j(F(T)):F(F(this).j(T));if(P(T))return F(this.j(F(T)));if(0>this.l(S)&&0>T.l(S))return m(this.m()*T.m());for(var b=this.g.length+T.g.length,C=[],D=0;D<2*b;D++)C[D]=0;for(D=0;D<this.g.length;D++)for(var V=0;V<T.g.length;V++){var U=this.i(D)>>>16,M=this.i(D)&65535,le=T.i(V)>>>16,Ee=T.i(V)&65535;C[2*D+2*V]+=M*Ee,k(C,2*D+2*V),C[2*D+2*V+1]+=U*Ee,k(C,2*D+2*V+1),C[2*D+2*V+1]+=M*le,k(C,2*D+2*V+1),C[2*D+2*V+2]+=U*le,k(C,2*D+2*V+2)}for(D=0;D<b;D++)C[D]=C[2*D+1]<<16|C[2*D];for(D=b;D<2*b;D++)C[D]=0;return new a(C,0)};function k(T,b){for(;(T[b]&65535)!=T[b];)T[b+1]+=T[b]>>>16,T[b]&=65535,b++}function A(T,b){this.g=T,this.h=b}function z(T,b){if(N(b))throw Error("division by zero");if(N(T))return new A(v,v);if(P(T))return b=z(F(T),b),new A(F(b.g),F(b.h));if(P(b))return b=z(T,F(b)),new A(F(b.g),b.h);if(30<T.g.length){if(P(T)||P(b))throw Error("slowDivide_ only works with positive integers.");for(var C=w,D=b;0>=D.l(T);)C=G(C),D=G(D);var V=W(C,1),U=W(D,1);for(D=W(D,2),C=W(C,2);!N(D);){var M=U.add(D);0>=M.l(T)&&(V=V.add(C),U=M),D=W(D,1),C=W(C,1)}return b=R(T,V.j(b)),new A(V,b)}for(V=v;0<=T.l(b);){for(C=Math.max(1,Math.floor(T.m()/b.m())),D=Math.ceil(Math.log(C)/Math.LN2),D=48>=D?1:Math.pow(2,D-48),U=m(C),M=U.j(b);P(M)||0<M.l(T);)C-=D,U=m(C),M=U.j(b);N(U)&&(U=w),V=V.add(U),T=R(T,M)}return new A(V,T)}t.A=function(T){return z(this,T).h},t.and=function(T){for(var b=Math.max(this.g.length,T.g.length),C=[],D=0;D<b;D++)C[D]=this.i(D)&T.i(D);return new a(C,this.h&T.h)},t.or=function(T){for(var b=Math.max(this.g.length,T.g.length),C=[],D=0;D<b;D++)C[D]=this.i(D)|T.i(D);return new a(C,this.h|T.h)},t.xor=function(T){for(var b=Math.max(this.g.length,T.g.length),C=[],D=0;D<b;D++)C[D]=this.i(D)^T.i(D);return new a(C,this.h^T.h)};function G(T){for(var b=T.g.length+1,C=[],D=0;D<b;D++)C[D]=T.i(D)<<1|T.i(D-1)>>>31;return new a(C,T.h)}function W(T,b){var C=b>>5;b%=32;for(var D=T.g.length-C,V=[],U=0;U<D;U++)V[U]=0<b?T.i(U+C)>>>b|T.i(U+C+1)<<32-b:T.i(U+C);return new a(V,T.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,KE=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=m,a.fromString=y,Uo=a}).apply(typeof Yx<"u"?Yx:typeof self<"u"?self:typeof window<"u"?window:{});var Yd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ZE,qc,QE,Eh,Ug,YE,JE,XE;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(d,g,x){return d==Array.prototype||d==Object.prototype||(d[g]=x.value),d};function n(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof Yd=="object"&&Yd];for(var g=0;g<d.length;++g){var x=d[g];if(x&&x.Math==Math)return x}throw Error("Cannot find global object")}var r=n(this);function i(d,g){if(g)e:{var x=r;d=d.split(".");for(var E=0;E<d.length-1;E++){var q=d[E];if(!(q in x))break e;x=x[q]}d=d[d.length-1],E=x[d],g=g(E),g!=E&&g!=null&&e(x,d,{configurable:!0,writable:!0,value:g})}}function o(d,g){d instanceof String&&(d+="");var x=0,E=!1,q={next:function(){if(!E&&x<d.length){var Q=x++;return{value:g(Q,d[Q]),done:!1}}return E=!0,{done:!0,value:void 0}}};return q[Symbol.iterator]=function(){return q},q}i("Array.prototype.values",function(d){return d||function(){return o(this,function(g,x){return x})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},u=this||self;function h(d){var g=typeof d;return g=g!="object"?g:d?Array.isArray(d)?"array":g:"null",g=="array"||g=="object"&&typeof d.length=="number"}function m(d){var g=typeof d;return g=="object"&&d!=null||g=="function"}function y(d,g,x){return d.call.apply(d.bind,arguments)}function v(d,g,x){if(!d)throw Error();if(2<arguments.length){var E=Array.prototype.slice.call(arguments,2);return function(){var q=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(q,E),d.apply(g,q)}}return function(){return d.apply(g,arguments)}}function w(d,g,x){return w=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?y:v,w.apply(null,arguments)}function S(d,g){var x=Array.prototype.slice.call(arguments,1);return function(){var E=x.slice();return E.push.apply(E,arguments),d.apply(this,E)}}function N(d,g){function x(){}x.prototype=g.prototype,d.aa=g.prototype,d.prototype=new x,d.prototype.constructor=d,d.Qb=function(E,q,Q){for(var oe=Array(arguments.length-2),nt=2;nt<arguments.length;nt++)oe[nt-2]=arguments[nt];return g.prototype[q].apply(E,oe)}}function P(d){const g=d.length;if(0<g){const x=Array(g);for(let E=0;E<g;E++)x[E]=d[E];return x}return[]}function F(d,g){for(let x=1;x<arguments.length;x++){const E=arguments[x];if(h(E)){const q=d.length||0,Q=E.length||0;d.length=q+Q;for(let oe=0;oe<Q;oe++)d[q+oe]=E[oe]}else d.push(E)}}class R{constructor(g,x){this.i=g,this.j=x,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function k(d){return/^[\s\xa0]*$/.test(d)}function A(){var d=u.navigator;return d&&(d=d.userAgent)?d:""}function z(d){return z[" "](d),d}z[" "]=function(){};var G=A().indexOf("Gecko")!=-1&&!(A().toLowerCase().indexOf("webkit")!=-1&&A().indexOf("Edge")==-1)&&!(A().indexOf("Trident")!=-1||A().indexOf("MSIE")!=-1)&&A().indexOf("Edge")==-1;function W(d,g,x){for(const E in d)g.call(x,d[E],E,d)}function T(d,g){for(const x in d)g.call(void 0,d[x],x,d)}function b(d){const g={};for(const x in d)g[x]=d[x];return g}const C="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function D(d,g){let x,E;for(let q=1;q<arguments.length;q++){E=arguments[q];for(x in E)d[x]=E[x];for(let Q=0;Q<C.length;Q++)x=C[Q],Object.prototype.hasOwnProperty.call(E,x)&&(d[x]=E[x])}}function V(d){var g=1;d=d.split(":");const x=[];for(;0<g&&d.length;)x.push(d.shift()),g--;return d.length&&x.push(d.join(":")),x}function U(d){u.setTimeout(()=>{throw d},0)}function M(){var d=ce;let g=null;return d.g&&(g=d.g,d.g=d.g.next,d.g||(d.h=null),g.next=null),g}class le{constructor(){this.h=this.g=null}add(g,x){const E=Ee.get();E.set(g,x),this.h?this.h.next=E:this.g=E,this.h=E}}var Ee=new R(()=>new Ce,d=>d.reset());class Ce{constructor(){this.next=this.g=this.h=null}set(g,x){this.h=g,this.g=x,this.next=null}reset(){this.next=this.g=this.h=null}}let Re,K=!1,ce=new le,X=()=>{const d=u.Promise.resolve(void 0);Re=()=>{d.then(we)}};var we=()=>{for(var d;d=M();){try{d.h.call(d.g)}catch(x){U(x)}var g=Ee;g.j(d),100>g.h&&(g.h++,d.next=g.g,g.g=d)}K=!1};function ue(){this.s=this.s,this.C=this.C}ue.prototype.s=!1,ue.prototype.ma=function(){this.s||(this.s=!0,this.N())},ue.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function me(d,g){this.type=d,this.g=this.target=g,this.defaultPrevented=!1}me.prototype.h=function(){this.defaultPrevented=!0};var _e=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var d=!1,g=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const x=()=>{};u.addEventListener("test",x,g),u.removeEventListener("test",x,g)}catch{}return d}();function fe(d,g){if(me.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d){var x=this.type=d.type,E=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;if(this.target=d.target||d.srcElement,this.g=g,g=d.relatedTarget){if(G){e:{try{z(g.nodeName);var q=!0;break e}catch{}q=!1}q||(g=null)}}else x=="mouseover"?g=d.fromElement:x=="mouseout"&&(g=d.toElement);this.relatedTarget=g,E?(this.clientX=E.clientX!==void 0?E.clientX:E.pageX,this.clientY=E.clientY!==void 0?E.clientY:E.pageY,this.screenX=E.screenX||0,this.screenY=E.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=typeof d.pointerType=="string"?d.pointerType:de[d.pointerType]||"",this.state=d.state,this.i=d,d.defaultPrevented&&fe.aa.h.call(this)}}N(fe,me);var de={2:"touch",3:"pen",4:"mouse"};fe.prototype.h=function(){fe.aa.h.call(this);var d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var De="closure_listenable_"+(1e6*Math.random()|0),lt=0;function Gn(d,g,x,E,q){this.listener=d,this.proxy=null,this.src=g,this.type=x,this.capture=!!E,this.ha=q,this.key=++lt,this.da=this.fa=!1}function Pt(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function en(d){this.src=d,this.g={},this.h=0}en.prototype.add=function(d,g,x,E,q){var Q=d.toString();d=this.g[Q],d||(d=this.g[Q]=[],this.h++);var oe=Xe(d,g,E,q);return-1<oe?(g=d[oe],x||(g.fa=!1)):(g=new Gn(g,this.src,Q,!!E,q),g.fa=x,d.push(g)),g};function an(d,g){var x=g.type;if(x in d.g){var E=d.g[x],q=Array.prototype.indexOf.call(E,g,void 0),Q;(Q=0<=q)&&Array.prototype.splice.call(E,q,1),Q&&(Pt(g),d.g[x].length==0&&(delete d.g[x],d.h--))}}function Xe(d,g,x,E){for(var q=0;q<d.length;++q){var Q=d[q];if(!Q.da&&Q.listener==g&&Q.capture==!!x&&Q.ha==E)return q}return-1}var ft="closure_lm_"+(1e6*Math.random()|0),He={};function zt(d,g,x,E,q){if(Array.isArray(g)){for(var Q=0;Q<g.length;Q++)zt(d,g[Q],x,E,q);return null}return x=po(x),d&&d[De]?d.K(g,x,m(E)?!!E.capture:!1,q):mt(d,g,x,!1,E,q)}function mt(d,g,x,E,q,Q){if(!g)throw Error("Invalid event type");var oe=m(q)?!!q.capture:!!q,nt=Ii(d);if(nt||(d[ft]=nt=new en(d)),x=nt.add(g,x,E,oe,Q),x.proxy)return x;if(E=_n(),x.proxy=E,E.src=d,E.listener=x,d.addEventListener)_e||(q=oe),q===void 0&&(q=!1),d.addEventListener(g.toString(),E,q);else if(d.attachEvent)d.attachEvent(Zr(g.toString()),E);else if(d.addListener&&d.removeListener)d.addListener(E);else throw Error("addEventListener and attachEvent are unavailable.");return x}function _n(){function d(x){return g.call(d.src,d.listener,x)}const g=Pr;return d}function ma(d,g,x,E,q){if(Array.isArray(g))for(var Q=0;Q<g.length;Q++)ma(d,g[Q],x,E,q);else E=m(E)?!!E.capture:!!E,x=po(x),d&&d[De]?(d=d.i,g=String(g).toString(),g in d.g&&(Q=d.g[g],x=Xe(Q,x,E,q),-1<x&&(Pt(Q[x]),Array.prototype.splice.call(Q,x,1),Q.length==0&&(delete d.g[g],d.h--)))):d&&(d=Ii(d))&&(g=d.g[g.toString()],d=-1,g&&(d=Xe(g,x,E,q)),(x=-1<d?g[d]:null)&&ls(x))}function ls(d){if(typeof d!="number"&&d&&!d.da){var g=d.src;if(g&&g[De])an(g.i,d);else{var x=d.type,E=d.proxy;g.removeEventListener?g.removeEventListener(x,E,d.capture):g.detachEvent?g.detachEvent(Zr(x),E):g.addListener&&g.removeListener&&g.removeListener(E),(x=Ii(g))?(an(x,d),x.h==0&&(x.src=null,g[ft]=null)):Pt(d)}}}function Zr(d){return d in He?He[d]:He[d]="on"+d}function Pr(d,g){if(d.da)d=!0;else{g=new fe(g,this);var x=d.listener,E=d.ha||d.src;d.fa&&ls(d),d=x.call(E,g)}return d}function Ii(d){return d=d[ft],d instanceof en?d:null}var mo="__closure_events_fn_"+(1e9*Math.random()>>>0);function po(d){return typeof d=="function"?d:(d[mo]||(d[mo]=function(g){return d.handleEvent(g)}),d[mo])}function wt(){ue.call(this),this.i=new en(this),this.M=this,this.F=null}N(wt,ue),wt.prototype[De]=!0,wt.prototype.removeEventListener=function(d,g,x,E){ma(this,d,g,x,E)};function Nt(d,g){var x,E=d.F;if(E)for(x=[];E;E=E.F)x.push(E);if(d=d.M,E=g.type||g,typeof g=="string")g=new me(g,d);else if(g instanceof me)g.target=g.target||d;else{var q=g;g=new me(E,d),D(g,q)}if(q=!0,x)for(var Q=x.length-1;0<=Q;Q--){var oe=g.g=x[Q];q=Qr(oe,E,!0,g)&&q}if(oe=g.g=d,q=Qr(oe,E,!0,g)&&q,q=Qr(oe,E,!1,g)&&q,x)for(Q=0;Q<x.length;Q++)oe=g.g=x[Q],q=Qr(oe,E,!1,g)&&q}wt.prototype.N=function(){if(wt.aa.N.call(this),this.i){var d=this.i,g;for(g in d.g){for(var x=d.g[g],E=0;E<x.length;E++)Pt(x[E]);delete d.g[g],d.h--}}this.F=null},wt.prototype.K=function(d,g,x,E){return this.i.add(String(d),g,!1,x,E)},wt.prototype.L=function(d,g,x,E){return this.i.add(String(d),g,!0,x,E)};function Qr(d,g,x,E){if(g=d.i.g[String(g)],!g)return!0;g=g.concat();for(var q=!0,Q=0;Q<g.length;++Q){var oe=g[Q];if(oe&&!oe.da&&oe.capture==x){var nt=oe.listener,Vt=oe.ha||oe.src;oe.fa&&an(d.i,oe),q=nt.call(Vt,E)!==!1&&q}}return q&&!E.defaultPrevented}function go(d,g,x){if(typeof d=="function")x&&(d=w(d,x));else if(d&&typeof d.handleEvent=="function")d=w(d.handleEvent,d);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:u.setTimeout(d,g||0)}function Cn(d){d.g=go(()=>{d.g=null,d.i&&(d.i=!1,Cn(d))},d.l);const g=d.h;d.h=null,d.m.apply(null,g)}class pa extends ue{constructor(g,x){super(),this.m=g,this.l=x,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:Cn(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Nr(d){ue.call(this),this.h=d,this.g={}}N(Nr,ue);var Ar=[];function Cr(d){W(d.g,function(g,x){this.g.hasOwnProperty(x)&&ls(g)},d),d.g={}}Nr.prototype.N=function(){Nr.aa.N.call(this),Cr(this)},Nr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var cs=u.JSON.stringify,ga=u.JSON.parse,Yr=class{stringify(d){return u.JSON.stringify(d,void 0)}parse(d){return u.JSON.parse(d,void 0)}};function us(){}us.prototype.h=null;function ya(d){return d.h||(d.h=d.i())}function ds(){}var Rr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function hs(){me.call(this,"d")}N(hs,me);function yo(){me.call(this,"c")}N(yo,me);var jr={},_a=null;function Ti(){return _a=_a||new wt}jr.La="serverreachability";function va(d){me.call(this,jr.La,d)}N(va,me);function vn(d){const g=Ti();Nt(g,new va(g))}jr.STAT_EVENT="statevent";function bt(d,g){me.call(this,jr.STAT_EVENT,d),this.stat=g}N(bt,me);function ct(d){const g=Ti();Nt(g,new bt(g,d))}jr.Ma="timingevent";function Kt(d,g){me.call(this,jr.Ma,d),this.size=g}N(Kt,me);function Jr(d,g){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){d()},g)}function Xr(){this.g=!0}Xr.prototype.xa=function(){this.g=!1};function xn(d,g,x,E,q,Q){d.info(function(){if(d.g)if(Q)for(var oe="",nt=Q.split("&"),Vt=0;Vt<nt.length;Vt++){var Ge=nt[Vt].split("=");if(1<Ge.length){var ot=Ge[0];Ge=Ge[1];var Tt=ot.split("_");oe=2<=Tt.length&&Tt[1]=="type"?oe+(ot+"="+Ge+"&"):oe+(ot+"=redacted&")}}else oe=null;else oe=Q;return"XMLHTTP REQ ("+E+") [attempt "+q+"]: "+g+`
`+x+`
`+oe})}function se(d,g,x,E,q,Q,oe){d.info(function(){return"XMLHTTP RESP ("+E+") [ attempt "+q+"]: "+g+`
`+x+`
`+Q+" "+oe})}function Lr(d,g,x,E){d.info(function(){return"XMLHTTP TEXT ("+g+"): "+wa(d,x)+(E?" "+E:"")})}function xa(d,g){d.info(function(){return"TIMEOUT: "+g})}Xr.prototype.info=function(){};function wa(d,g){if(!d.g)return g;if(!g)return null;try{var x=JSON.parse(g);if(x){for(d=0;d<x.length;d++)if(Array.isArray(x[d])){var E=x[d];if(!(2>E.length)){var q=E[1];if(Array.isArray(q)&&!(1>q.length)){var Q=q[0];if(Q!="noop"&&Q!="stop"&&Q!="close")for(var oe=1;oe<q.length;oe++)q[oe]=""}}}}return cs(x)}catch{return g}}var Ei={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},fs={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ki;function Kn(){}N(Kn,us),Kn.prototype.g=function(){return new XMLHttpRequest},Kn.prototype.i=function(){return{}},ki=new Kn;function Zn(d,g,x,E){this.j=d,this.i=g,this.l=x,this.R=E||1,this.U=new Nr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ba}function ba(){this.i=null,this.g="",this.h=!1}var Ia={},_o={};function ms(d,g,x){d.L=1,d.v=Rn(We(g)),d.m=x,d.P=!0,vo(d,null)}function vo(d,g){d.F=Date.now(),gs(d),d.A=We(d.v);var x=d.A,E=d.R;Array.isArray(E)||(E=[String(E)]),fd(x.i,"t",E),d.C=0,x=d.j.J,d.h=new ba,d.g=xd(d.j,x?g:null,!d.m),0<d.O&&(d.M=new pa(w(d.Y,d,d.g),d.O)),g=d.U,x=d.g,E=d.ca;var q="readystatechange";Array.isArray(q)||(q&&(Ar[0]=q.toString()),q=Ar);for(var Q=0;Q<q.length;Q++){var oe=zt(x,q[Q],E||g.handleEvent,!1,g.h||g);if(!oe)break;g.g[oe.key]=oe}g=d.H?b(d.H):{},d.m?(d.u||(d.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.A,d.u,d.m,g)):(d.u="GET",d.g.ea(d.A,d.u,null,g)),vn(),xn(d.i,d.u,d.A,d.l,d.R,d.m)}Zn.prototype.ca=function(d){d=d.target;const g=this.M;g&&wn(d)==3?g.j():this.Y(d)},Zn.prototype.Y=function(d){try{if(d==this.g)e:{const Tt=wn(this.g);var g=this.g.Ba();const Is=this.g.Z();if(!(3>Tt)&&(Tt!=3||this.g&&(this.h.h||this.g.oa()||hc(this.g)))){this.J||Tt!=4||g==7||(g==8||0>=Is?vn(3):vn(2)),Pe(this);var x=this.g.Z();this.X=x;t:if(Ta(this)){var E=hc(this.g);d="";var q=E.length,Q=wn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){dr(this),ei(this);var oe="";break t}this.h.i=new u.TextDecoder}for(g=0;g<q;g++)this.h.h=!0,d+=this.h.i.decode(E[g],{stream:!(Q&&g==q-1)});E.length=0,this.h.g+=d,this.C=0,oe=this.h.g}else oe=this.g.oa();if(this.o=x==200,se(this.i,this.u,this.A,this.l,this.R,Tt,x),this.o){if(this.T&&!this.K){t:{if(this.g){var nt,Vt=this.g;if((nt=Vt.g?Vt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(nt)){var Ge=nt;break t}}Ge=null}if(x=Ge)Lr(this.i,this.l,x,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ti(this,x);else{this.o=!1,this.s=3,ct(12),dr(this),ei(this);break e}}if(this.P){x=!0;let Dt;for(;!this.J&&this.C<oe.length;)if(Dt=ps(this,oe),Dt==_o){Tt==4&&(this.s=4,ct(14),x=!1),Lr(this.i,this.l,null,"[Incomplete Response]");break}else if(Dt==Ia){this.s=4,ct(15),Lr(this.i,this.l,oe,"[Invalid Chunk]"),x=!1;break}else Lr(this.i,this.l,Dt,null),ti(this,Dt);if(Ta(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Tt!=4||oe.length!=0||this.h.h||(this.s=1,ct(16),x=!1),this.o=this.o&&x,!x)Lr(this.i,this.l,oe,"[Invalid Chunked Response]"),dr(this),ei(this);else if(0<oe.length&&!this.W){this.W=!0;var ot=this.j;ot.g==this&&ot.ba&&!ot.M&&(ot.j.info("Great, no buffering proxy detected. Bytes received: "+oe.length),Ra(ot),ot.M=!0,ct(11))}}else Lr(this.i,this.l,oe,null),ti(this,oe);Tt==4&&dr(this),this.o&&!this.J&&(Tt==4?mc(this.j,this):(this.o=!1,gs(this)))}else Om(this.g),x==400&&0<oe.indexOf("Unknown SID")?(this.s=3,ct(12)):(this.s=0,ct(13)),dr(this),ei(this)}}}catch{}finally{}};function Ta(d){return d.g?d.u=="GET"&&d.L!=2&&d.j.Ca:!1}function ps(d,g){var x=d.C,E=g.indexOf(`
`,x);return E==-1?_o:(x=Number(g.substring(x,E)),isNaN(x)?Ia:(E+=1,E+x>g.length?_o:(g=g.slice(E,E+x),d.C=E+x,g)))}Zn.prototype.cancel=function(){this.J=!0,dr(this)};function gs(d){d.S=Date.now()+d.I,ur(d,d.I)}function ur(d,g){if(d.B!=null)throw Error("WatchDog timer not null");d.B=Jr(w(d.ba,d),g)}function Pe(d){d.B&&(u.clearTimeout(d.B),d.B=null)}Zn.prototype.ba=function(){this.B=null;const d=Date.now();0<=d-this.S?(xa(this.i,this.A),this.L!=2&&(vn(),ct(17)),dr(this),this.s=2,ei(this)):ur(this,this.S-d)};function ei(d){d.j.G==0||d.J||mc(d.j,d)}function dr(d){Pe(d);var g=d.M;g&&typeof g.ma=="function"&&g.ma(),d.M=null,Cr(d.U),d.g&&(g=d.g,d.g=null,g.abort(),g.ma())}function ti(d,g){try{var x=d.j;if(x.G!=0&&(x.g==d||Me(x.h,d))){if(!d.K&&Me(x.h,d)&&x.G==3){try{var E=x.Da.g.parse(g)}catch{E=null}if(Array.isArray(E)&&E.length==3){var q=E;if(q[0]==0){e:if(!x.u){if(x.g)if(x.g.F+3e3<d.F)La(x),Aa(x);else break e;Ca(x),ct(18)}}else x.za=q[1],0<x.za-x.T&&37500>q[2]&&x.F&&x.v==0&&!x.C&&(x.C=Jr(w(x.Za,x),6e3));if(1>=Dr(x.h)&&x.ca){try{x.ca()}catch{}x.ca=void 0}}else Ni(x,11)}else if((d.K||x.g==d)&&La(x),!k(g))for(q=x.Da.g.parse(g),g=0;g<q.length;g++){let Ge=q[g];if(x.T=Ge[0],Ge=Ge[1],x.G==2)if(Ge[0]=="c"){x.K=Ge[1],x.ia=Ge[2];const ot=Ge[3];ot!=null&&(x.la=ot,x.j.info("VER="+x.la));const Tt=Ge[4];Tt!=null&&(x.Aa=Tt,x.j.info("SVER="+x.Aa));const Is=Ge[5];Is!=null&&typeof Is=="number"&&0<Is&&(E=1.5*Is,x.L=E,x.j.info("backChannelRequestTimeoutMs_="+E)),E=x;const Dt=d.g;if(Dt){const Ma=Dt.g?Dt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ma){var Q=E.h;Q.g||Ma.indexOf("spdy")==-1&&Ma.indexOf("quic")==-1&&Ma.indexOf("h2")==-1||(Q.j=Q.l,Q.g=new Set,Q.h&&(et(Q,Q.h),Q.h=null))}if(E.D){const si=Dt.g?Dt.g.getResponseHeader("X-HTTP-Session-Id"):null;si&&(E.ya=si,Ne(E.I,E.D,si))}}x.G=3,x.l&&x.l.ua(),x.ba&&(x.R=Date.now()-d.F,x.j.info("Handshake RTT: "+x.R+"ms")),E=x;var oe=d;if(E.qa=Da(E,E.J?E.ia:null,E.W),oe.K){ri(E.h,oe);var nt=oe,Vt=E.L;Vt&&(nt.I=Vt),nt.B&&(Pe(nt),gs(nt)),E.g=oe}else Or(E);0<x.i.length&&bs(x)}else Ge[0]!="stop"&&Ge[0]!="close"||Ni(x,7);else x.G==3&&(Ge[0]=="stop"||Ge[0]=="close"?Ge[0]=="stop"?Ni(x,7):Na(x):Ge[0]!="noop"&&x.l&&x.l.ta(Ge),x.v=0)}}vn(4)}catch{}}var ni=class{constructor(d,g){this.g=d,this.map=g}};function ys(d){this.l=d||10,u.PerformanceNavigationTiming?(d=u.performance.getEntriesByType("navigation"),d=0<d.length&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function _s(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function Dr(d){return d.h?1:d.g?d.g.size:0}function Me(d,g){return d.h?d.h==g:d.g?d.g.has(g):!1}function et(d,g){d.g?d.g.add(g):d.h=g}function ri(d,g){d.h&&d.h==g?d.h=null:d.g&&d.g.has(g)&&d.g.delete(g)}ys.prototype.cancel=function(){if(this.i=j(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function j(d){if(d.h!=null)return d.i.concat(d.h.D);if(d.g!=null&&d.g.size!==0){let g=d.i;for(const x of d.g.values())g=g.concat(x.D);return g}return P(d.i)}function Y(d){if(d.V&&typeof d.V=="function")return d.V();if(typeof Map<"u"&&d instanceof Map||typeof Set<"u"&&d instanceof Set)return Array.from(d.values());if(typeof d=="string")return d.split("");if(h(d)){for(var g=[],x=d.length,E=0;E<x;E++)g.push(d[E]);return g}g=[],x=0;for(E in d)g[x++]=d[E];return g}function ne(d){if(d.na&&typeof d.na=="function")return d.na();if(!d.V||typeof d.V!="function"){if(typeof Map<"u"&&d instanceof Map)return Array.from(d.keys());if(!(typeof Set<"u"&&d instanceof Set)){if(h(d)||typeof d=="string"){var g=[];d=d.length;for(var x=0;x<d;x++)g.push(x);return g}g=[],x=0;for(const E in d)g[x++]=E;return g}}}function re(d,g){if(d.forEach&&typeof d.forEach=="function")d.forEach(g,void 0);else if(h(d)||typeof d=="string")Array.prototype.forEach.call(d,g,void 0);else for(var x=ne(d),E=Y(d),q=E.length,Q=0;Q<q;Q++)g.call(void 0,E[Q],x&&x[Q],d)}var ge=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Qe(d,g){if(d){d=d.split("&");for(var x=0;x<d.length;x++){var E=d[x].indexOf("="),q=null;if(0<=E){var Q=d[x].substring(0,E);q=d[x].substring(E+1)}else Q=d[x];g(Q,q?decodeURIComponent(q.replace(/\+/g," ")):"")}}}function je(d){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,d instanceof je){this.h=d.h,qt(this,d.j),this.o=d.o,this.g=d.g,hr(this,d.s),this.l=d.l;var g=d.i,x=new Si;x.i=g.i,g.g&&(x.g=new Map(g.g),x.h=g.h),fr(this,x),this.m=d.m}else d&&(g=String(d).match(ge))?(this.h=!1,qt(this,g[1]||"",!0),this.o=jn(g[2]||""),this.g=jn(g[3]||"",!0),hr(this,g[4]),this.l=jn(g[5]||"",!0),fr(this,g[6]||"",!0),this.m=jn(g[7]||"")):(this.h=!1,this.i=new Si(null,this.h))}je.prototype.toString=function(){var d=[],g=this.j;g&&d.push(Mr(g,vs,!0),":");var x=this.g;return(x||g=="file")&&(d.push("//"),(g=this.o)&&d.push(Mr(g,vs,!0),"@"),d.push(encodeURIComponent(String(x)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),x=this.s,x!=null&&d.push(":",String(x))),(x=this.l)&&(this.g&&x.charAt(0)!="/"&&d.push("/"),d.push(Mr(x,x.charAt(0)=="/"?ic:rc,!0))),(x=this.i.toString())&&d.push("?",x),(x=this.m)&&d.push("#",Mr(x,sc)),d.join("")};function We(d){return new je(d)}function qt(d,g,x){d.j=x?jn(g,!0):g,d.j&&(d.j=d.j.replace(/:$/,""))}function hr(d,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);d.s=g}else d.s=null}function fr(d,g,x){g instanceof Si?(d.i=g,mr(d.i,d.h)):(x||(g=Mr(g,Ea)),d.i=new Si(g,d.h))}function Ne(d,g,x){d.i.set(g,x)}function Rn(d){return Ne(d,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),d}function jn(d,g){return d?g?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function Mr(d,g,x){return typeof d=="string"?(d=encodeURI(d).replace(g,nc),x&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function nc(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var vs=/[#\/\?@]/g,rc=/[#\?:]/g,ic=/[#\?]/g,Ea=/[#\?@]/g,sc=/#/g;function Si(d,g){this.h=this.g=null,this.i=d||null,this.j=!!g}function Qn(d){d.g||(d.g=new Map,d.h=0,d.i&&Qe(d.i,function(g,x){d.add(decodeURIComponent(g.replace(/\+/g," ")),x)}))}t=Si.prototype,t.add=function(d,g){Qn(this),this.i=null,d=ke(this,d);var x=this.g.get(d);return x||this.g.set(d,x=[]),x.push(g),this.h+=1,this};function oc(d,g){Qn(d),g=ke(d,g),d.g.has(g)&&(d.i=null,d.h-=d.g.get(g).length,d.g.delete(g))}function ka(d,g){return Qn(d),g=ke(d,g),d.g.has(g)}t.forEach=function(d,g){Qn(this),this.g.forEach(function(x,E){x.forEach(function(q){d.call(g,q,E,this)},this)},this)},t.na=function(){Qn(this);const d=Array.from(this.g.values()),g=Array.from(this.g.keys()),x=[];for(let E=0;E<g.length;E++){const q=d[E];for(let Q=0;Q<q.length;Q++)x.push(g[E])}return x},t.V=function(d){Qn(this);let g=[];if(typeof d=="string")ka(this,d)&&(g=g.concat(this.g.get(ke(this,d))));else{d=Array.from(this.g.values());for(let x=0;x<d.length;x++)g=g.concat(d[x])}return g},t.set=function(d,g){return Qn(this),this.i=null,d=ke(this,d),ka(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[g]),this.h+=1,this},t.get=function(d,g){return d?(d=this.V(d),0<d.length?String(d[0]):g):g};function fd(d,g,x){oc(d,g),0<x.length&&(d.i=null,d.g.set(ke(d,g),P(x)),d.h+=x.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],g=Array.from(this.g.keys());for(var x=0;x<g.length;x++){var E=g[x];const Q=encodeURIComponent(String(E)),oe=this.V(E);for(E=0;E<oe.length;E++){var q=Q;oe[E]!==""&&(q+="="+encodeURIComponent(String(oe[E]))),d.push(q)}}return this.i=d.join("&")};function ke(d,g){return g=String(g),d.j&&(g=g.toLowerCase()),g}function mr(d,g){g&&!d.j&&(Qn(d),d.i=null,d.g.forEach(function(x,E){var q=E.toLowerCase();E!=q&&(oc(this,E),fd(this,q,x))},d)),d.j=g}function st(d,g){const x=new Xr;if(u.Image){const E=new Image;E.onload=S(pr,x,"TestLoadImage: loaded",!0,g,E),E.onerror=S(pr,x,"TestLoadImage: error",!1,g,E),E.onabort=S(pr,x,"TestLoadImage: abort",!1,g,E),E.ontimeout=S(pr,x,"TestLoadImage: timeout",!1,g,E),u.setTimeout(function(){E.ontimeout&&E.ontimeout()},1e4),E.src=d}else g(!1)}function md(d,g){const x=new Xr,E=new AbortController,q=setTimeout(()=>{E.abort(),pr(x,"TestPingServer: timeout",!1,g)},1e4);fetch(d,{signal:E.signal}).then(Q=>{clearTimeout(q),Q.ok?pr(x,"TestPingServer: ok",!0,g):pr(x,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(q),pr(x,"TestPingServer: error",!1,g)})}function pr(d,g,x,E,q){try{q&&(q.onload=null,q.onerror=null,q.onabort=null,q.ontimeout=null),E(x)}catch{}}function ac(){this.g=new Yr}function lc(d,g,x){const E=x||"";try{re(d,function(q,Q){let oe=q;m(q)&&(oe=cs(q)),g.push(E+Q+"="+encodeURIComponent(oe))})}catch(q){throw g.push(E+"type="+encodeURIComponent("_badmap")),q}}function gr(d){this.l=d.Ub||null,this.j=d.eb||!1}N(gr,us),gr.prototype.g=function(){return new xs(this.l,this.j)},gr.prototype.i=function(d){return function(){return d}}({});function xs(d,g){wt.call(this),this.D=d,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}N(xs,wt),t=xs.prototype,t.open=function(d,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=d,this.A=g,this.readyState=1,Yn(this)},t.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};d&&(g.body=d),(this.D||u).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,It(this)),this.readyState=0},t.Sa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,Yn(this)),this.g&&(this.readyState=3,Yn(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ws(this)}else d.text().then(this.Ra.bind(this),this.ga.bind(this))};function ws(d){d.j.read().then(d.Pa.bind(d)).catch(d.ga.bind(d))}t.Pa=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var g=d.value?d.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!d.done}))&&(this.response=this.responseText+=g)}d.done?It(this):Yn(this),this.readyState==3&&ws(this)}},t.Ra=function(d){this.g&&(this.response=this.responseText=d,It(this))},t.Qa=function(d){this.g&&(this.response=d,It(this))},t.ga=function(){this.g&&It(this)};function It(d){d.readyState=4,d.l=null,d.j=null,d.v=null,Yn(d)}t.setRequestHeader=function(d,g){this.u.append(d,g)},t.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],g=this.h.entries();for(var x=g.next();!x.done;)x=x.value,d.push(x[0]+": "+x[1]),x=g.next();return d.join(`\r
`)};function Yn(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(xs.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function cc(d){let g="";return W(d,function(x,E){g+=E,g+=":",g+=x,g+=`\r
`}),g}function Sa(d,g,x){e:{for(E in x){var E=!1;break e}E=!0}E||(x=cc(x),typeof d=="string"?x!=null&&encodeURIComponent(String(x)):Ne(d,g,x))}function yt(d){wt.call(this),this.headers=new Map,this.o=d||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}N(yt,wt);var pd=/^https?$/i,uc=["POST","PUT"];t=yt.prototype,t.Ha=function(d){this.J=d},t.ea=function(d,g,x,E){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);g=g?g.toUpperCase():"GET",this.D=d,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ki.g(),this.v=this.o?ya(this.o):ya(ki),this.g.onreadystatechange=w(this.Ea,this);try{this.B=!0,this.g.open(g,String(d),!0),this.B=!1}catch(Q){gd(this,Q);return}if(d=x||"",x=new Map(this.headers),E)if(Object.getPrototypeOf(E)===Object.prototype)for(var q in E)x.set(q,E[q]);else if(typeof E.keys=="function"&&typeof E.get=="function")for(const Q of E.keys())x.set(Q,E.get(Q));else throw Error("Unknown input type for opt_headers: "+String(E));E=Array.from(x.keys()).find(Q=>Q.toLowerCase()=="content-type"),q=u.FormData&&d instanceof u.FormData,!(0<=Array.prototype.indexOf.call(uc,g,void 0))||E||q||x.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Q,oe]of x)this.g.setRequestHeader(Q,oe);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ln(this),this.u=!0,this.g.send(d),this.u=!1}catch(Q){gd(this,Q)}};function gd(d,g){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=g,d.m=5,dc(d),Pa(d)}function dc(d){d.A||(d.A=!0,Nt(d,"complete"),Nt(d,"error"))}t.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=d||7,Nt(this,"complete"),Nt(this,"abort"),Pa(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Pa(this,!0)),yt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Be(this):this.bb())},t.bb=function(){Be(this)};function Be(d){if(d.h&&typeof a<"u"&&(!d.v[1]||wn(d)!=4||d.Z()!=2)){if(d.u&&wn(d)==4)go(d.Ea,0,d);else if(Nt(d,"readystatechange"),wn(d)==4){d.h=!1;try{const oe=d.Z();e:switch(oe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var x;if(!(x=g)){var E;if(E=oe===0){var q=String(d.D).match(ge)[1]||null;!q&&u.self&&u.self.location&&(q=u.self.location.protocol.slice(0,-1)),E=!pd.test(q?q.toLowerCase():"")}x=E}if(x)Nt(d,"complete"),Nt(d,"success");else{d.m=6;try{var Q=2<wn(d)?d.g.statusText:""}catch{Q=""}d.l=Q+" ["+d.Z()+"]",dc(d)}}finally{Pa(d)}}}}function Pa(d,g){if(d.g){Ln(d);const x=d.g,E=d.v[0]?()=>{}:null;d.g=null,d.v=null,g||Nt(d,"ready");try{x.onreadystatechange=E}catch{}}}function Ln(d){d.I&&(u.clearTimeout(d.I),d.I=null)}t.isActive=function(){return!!this.g};function wn(d){return d.g?d.g.readyState:0}t.Z=function(){try{return 2<wn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(d){if(this.g){var g=this.g.responseText;return d&&g.indexOf(d)==0&&(g=g.substring(d.length)),ga(g)}};function hc(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.H){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function Om(d){const g={};d=(d.g&&2<=wn(d)&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let E=0;E<d.length;E++){if(k(d[E]))continue;var x=V(d[E]);const q=x[0];if(x=x[1],typeof x!="string")continue;x=x.trim();const Q=g[q]||[];g[q]=Q,Q.push(x)}T(g,function(E){return E.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Pi(d,g,x){return x&&x.internalChannelParams&&x.internalChannelParams[d]||g}function yd(d){this.Aa=0,this.i=[],this.j=new Xr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Pi("failFast",!1,d),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Pi("baseRetryDelayMs",5e3,d),this.cb=Pi("retryDelaySeedMs",1e4,d),this.Wa=Pi("forwardChannelMaxRetries",2,d),this.wa=Pi("forwardChannelRequestTimeoutMs",2e4,d),this.pa=d&&d.xmlHttpFactory||void 0,this.Xa=d&&d.Tb||void 0,this.Ca=d&&d.useFetchStreams||!1,this.L=void 0,this.J=d&&d.supportsCrossDomainXhr||!1,this.K="",this.h=new ys(d&&d.concurrentRequestLimit),this.Da=new ac,this.P=d&&d.fastHandshake||!1,this.O=d&&d.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=d&&d.Rb||!1,d&&d.xa&&this.j.xa(),d&&d.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&d&&d.detectBufferingProxy||!1,this.ja=void 0,d&&d.longPollingTimeout&&0<d.longPollingTimeout&&(this.ja=d.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=yd.prototype,t.la=8,t.G=1,t.connect=function(d,g,x,E){ct(0),this.W=d,this.H=g||{},x&&E!==void 0&&(this.H.OSID=x,this.H.OAID=E),this.F=this.X,this.I=Da(this,null,this.W),bs(this)};function Na(d){if(_d(d),d.G==3){var g=d.U++,x=We(d.I);if(Ne(x,"SID",d.K),Ne(x,"RID",g),Ne(x,"TYPE","terminate"),xo(d,x),g=new Zn(d,d.j,g),g.L=2,g.v=Rn(We(x)),x=!1,u.navigator&&u.navigator.sendBeacon)try{x=u.navigator.sendBeacon(g.v.toString(),"")}catch{}!x&&u.Image&&(new Image().src=g.v,x=!0),x||(g.g=xd(g.j,null),g.g.ea(g.v)),g.F=Date.now(),gs(g)}vd(d)}function Aa(d){d.g&&(Ra(d),d.g.cancel(),d.g=null)}function _d(d){Aa(d),d.u&&(u.clearTimeout(d.u),d.u=null),La(d),d.h.cancel(),d.s&&(typeof d.s=="number"&&u.clearTimeout(d.s),d.s=null)}function bs(d){if(!_s(d.h)&&!d.s){d.s=!0;var g=d.Ga;Re||X(),K||(Re(),K=!0),ce.add(g,d),d.B=0}}function Vm(d,g){return Dr(d.h)>=d.h.j-(d.s?1:0)?!1:d.s?(d.i=g.D.concat(d.i),!0):d.G==1||d.G==2||d.B>=(d.Va?0:d.Wa)?!1:(d.s=Jr(w(d.Ga,d,g),pc(d,d.B)),d.B++,!0)}t.Ga=function(d){if(this.s)if(this.s=null,this.G==1){if(!d){this.U=Math.floor(1e5*Math.random()),d=this.U++;const q=new Zn(this,this.j,d);let Q=this.o;if(this.S&&(Q?(Q=b(Q),D(Q,this.S)):Q=this.S),this.m!==null||this.O||(q.H=Q,Q=null),this.P)e:{for(var g=0,x=0;x<this.i.length;x++){t:{var E=this.i[x];if("__data__"in E.map&&(E=E.map.__data__,typeof E=="string")){E=E.length;break t}E=void 0}if(E===void 0)break;if(g+=E,4096<g){g=x;break e}if(g===4096||x===this.i.length-1){g=x+1;break e}}g=1e3}else g=1e3;g=fc(this,q,g),x=We(this.I),Ne(x,"RID",d),Ne(x,"CVER",22),this.D&&Ne(x,"X-HTTP-Session-Id",this.D),xo(this,x),Q&&(this.O?g="headers="+encodeURIComponent(String(cc(Q)))+"&"+g:this.m&&Sa(x,this.m,Q)),et(this.h,q),this.Ua&&Ne(x,"TYPE","init"),this.P?(Ne(x,"$req",g),Ne(x,"SID","null"),q.T=!0,ms(q,x,null)):ms(q,x,g),this.G=2}}else this.G==3&&(d?Jn(this,d):this.i.length==0||_s(this.h)||Jn(this))};function Jn(d,g){var x;g?x=g.l:x=d.U++;const E=We(d.I);Ne(E,"SID",d.K),Ne(E,"RID",x),Ne(E,"AID",d.T),xo(d,E),d.m&&d.o&&Sa(E,d.m,d.o),x=new Zn(d,d.j,x,d.B+1),d.m===null&&(x.H=d.o),g&&(d.i=g.D.concat(d.i)),g=fc(d,x,1e3),x.I=Math.round(.5*d.wa)+Math.round(.5*d.wa*Math.random()),et(d.h,x),ms(x,E,g)}function xo(d,g){d.H&&W(d.H,function(x,E){Ne(g,E,x)}),d.l&&re({},function(x,E){Ne(g,E,x)})}function fc(d,g,x){x=Math.min(d.i.length,x);var E=d.l?w(d.l.Na,d.l,d):null;e:{var q=d.i;let Q=-1;for(;;){const oe=["count="+x];Q==-1?0<x?(Q=q[0].g,oe.push("ofs="+Q)):Q=0:oe.push("ofs="+Q);let nt=!0;for(let Vt=0;Vt<x;Vt++){let Ge=q[Vt].g;const ot=q[Vt].map;if(Ge-=Q,0>Ge)Q=Math.max(0,q[Vt].g-100),nt=!1;else try{lc(ot,oe,"req"+Ge+"_")}catch{E&&E(ot)}}if(nt){E=oe.join("&");break e}}}return d=d.i.splice(0,x),g.D=d,E}function Or(d){if(!d.g&&!d.u){d.Y=1;var g=d.Fa;Re||X(),K||(Re(),K=!0),ce.add(g,d),d.v=0}}function Ca(d){return d.g||d.u||3<=d.v?!1:(d.Y++,d.u=Jr(w(d.Fa,d),pc(d,d.v)),d.v++,!0)}t.Fa=function(){if(this.u=null,ja(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var d=2*this.R;this.j.info("BP detection timer enabled: "+d),this.A=Jr(w(this.ab,this),d)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ct(10),Aa(this),ja(this))};function Ra(d){d.A!=null&&(u.clearTimeout(d.A),d.A=null)}function ja(d){d.g=new Zn(d,d.j,"rpc",d.Y),d.m===null&&(d.g.H=d.o),d.g.O=0;var g=We(d.qa);Ne(g,"RID","rpc"),Ne(g,"SID",d.K),Ne(g,"AID",d.T),Ne(g,"CI",d.F?"0":"1"),!d.F&&d.ja&&Ne(g,"TO",d.ja),Ne(g,"TYPE","xmlhttp"),xo(d,g),d.m&&d.o&&Sa(g,d.m,d.o),d.L&&(d.g.I=d.L);var x=d.g;d=d.ia,x.L=1,x.v=Rn(We(g)),x.m=null,x.P=!0,vo(x,d)}t.Za=function(){this.C!=null&&(this.C=null,Aa(this),Ca(this),ct(19))};function La(d){d.C!=null&&(u.clearTimeout(d.C),d.C=null)}function mc(d,g){var x=null;if(d.g==g){La(d),Ra(d),d.g=null;var E=2}else if(Me(d.h,g))x=g.D,ri(d.h,g),E=1;else return;if(d.G!=0){if(g.o)if(E==1){x=g.m?g.m.length:0,g=Date.now()-g.F;var q=d.B;E=Ti(),Nt(E,new Kt(E,x)),bs(d)}else Or(d);else if(q=g.s,q==3||q==0&&0<g.X||!(E==1&&Vm(d,g)||E==2&&Ca(d)))switch(x&&0<x.length&&(g=d.h,g.i=g.i.concat(x)),q){case 1:Ni(d,5);break;case 4:Ni(d,10);break;case 3:Ni(d,6);break;default:Ni(d,2)}}}function pc(d,g){let x=d.Ta+Math.floor(Math.random()*d.cb);return d.isActive()||(x*=2),x*g}function Ni(d,g){if(d.j.info("Error code "+g),g==2){var x=w(d.fb,d),E=d.Xa;const q=!E;E=new je(E||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||qt(E,"https"),Rn(E),q?st(E.toString(),x):md(E.toString(),x)}else ct(2);d.G=0,d.l&&d.l.sa(g),vd(d),_d(d)}t.fb=function(d){d?(this.j.info("Successfully pinged google.com"),ct(2)):(this.j.info("Failed to ping google.com"),ct(1))};function vd(d){if(d.G=0,d.ka=[],d.l){const g=j(d.h);(g.length!=0||d.i.length!=0)&&(F(d.ka,g),F(d.ka,d.i),d.h.i.length=0,P(d.i),d.i.length=0),d.l.ra()}}function Da(d,g,x){var E=x instanceof je?We(x):new je(x);if(E.g!="")g&&(E.g=g+"."+E.g),hr(E,E.s);else{var q=u.location;E=q.protocol,g=g?g+"."+q.hostname:q.hostname,q=+q.port;var Q=new je(null);E&&qt(Q,E),g&&(Q.g=g),q&&hr(Q,q),x&&(Q.l=x),E=Q}return x=d.D,g=d.ya,x&&g&&Ne(E,x,g),Ne(E,"VER",d.la),xo(d,E),E}function xd(d,g,x){if(g&&!d.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=d.Ca&&!d.pa?new yt(new gr({eb:x})):new yt(d.pa),g.Ha(d.J),g}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function gc(){}t=gc.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function wo(){}wo.prototype.g=function(d,g){return new Zt(d,g)};function Zt(d,g){wt.call(this),this.g=new yd(g),this.l=d,this.h=g&&g.messageUrlParams||null,d=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(d?d["X-WebChannel-Content-Type"]=g.messageContentType:d={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(d?d["X-WebChannel-Client-Profile"]=g.va:d={"X-WebChannel-Client-Profile":g.va}),this.g.S=d,(d=g&&g.Sb)&&!k(d)&&(this.g.m=d),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!k(g)&&(this.g.D=g,d=this.h,d!==null&&g in d&&(d=this.h,g in d&&delete d[g])),this.j=new yr(this)}N(Zt,wt),Zt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Zt.prototype.close=function(){Na(this.g)},Zt.prototype.o=function(d){var g=this.g;if(typeof d=="string"){var x={};x.__data__=d,d=x}else this.u&&(x={},x.__data__=cs(d),d=x);g.i.push(new ni(g.Ya++,d)),g.G==3&&bs(g)},Zt.prototype.N=function(){this.g.l=null,delete this.j,Na(this.g),delete this.g,Zt.aa.N.call(this)};function ii(d){hs.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var g=d.__sm__;if(g){e:{for(const x in g){d=x;break e}d=void 0}(this.i=d)&&(d=this.i,g=g!==null&&d in g?g[d]:void 0),this.data=g}else this.data=d}N(ii,hs);function wd(){yo.call(this),this.status=1}N(wd,yo);function yr(d){this.g=d}N(yr,gc),yr.prototype.ua=function(){Nt(this.g,"a")},yr.prototype.ta=function(d){Nt(this.g,new ii(d))},yr.prototype.sa=function(d){Nt(this.g,new wd)},yr.prototype.ra=function(){Nt(this.g,"b")},wo.prototype.createWebChannel=wo.prototype.g,Zt.prototype.send=Zt.prototype.o,Zt.prototype.open=Zt.prototype.m,Zt.prototype.close=Zt.prototype.close,XE=function(){return new wo},JE=function(){return Ti()},YE=jr,Ug={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ei.NO_ERROR=0,Ei.TIMEOUT=8,Ei.HTTP_ERROR=6,Eh=Ei,fs.COMPLETE="complete",QE=fs,ds.EventType=Rr,Rr.OPEN="a",Rr.CLOSE="b",Rr.ERROR="c",Rr.MESSAGE="d",wt.prototype.listen=wt.prototype.K,qc=ds,yt.prototype.listenOnce=yt.prototype.L,yt.prototype.getLastError=yt.prototype.Ka,yt.prototype.getLastErrorCode=yt.prototype.Ba,yt.prototype.getStatus=yt.prototype.Z,yt.prototype.getResponseJson=yt.prototype.Oa,yt.prototype.getResponseText=yt.prototype.oa,yt.prototype.send=yt.prototype.ea,yt.prototype.setWithCredentials=yt.prototype.Ha,ZE=yt}).apply(typeof Yd<"u"?Yd:typeof self<"u"?self:typeof window<"u"?window:{});const Jx="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};dn.UNAUTHENTICATED=new dn(null),dn.GOOGLE_CREDENTIALS=new dn("google-credentials-uid"),dn.FIRST_PARTY=new dn("first-party-uid"),dn.MOCK_USER=new dn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zl="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qo=new u_("@firebase/firestore");function Wa(){return Qo.logLevel}function te(t,...e){if(Qo.logLevel<=qe.DEBUG){const n=e.map(I_);Qo.debug(`Firestore (${Zl}): ${t}`,...n)}}function Ot(t,...e){if(Qo.logLevel<=qe.ERROR){const n=e.map(I_);Qo.error(`Firestore (${Zl}): ${t}`,...n)}}function Al(t,...e){if(Qo.logLevel<=qe.WARN){const n=e.map(I_);Qo.warn(`Firestore (${Zl}): ${t}`,...n)}}function I_(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ve(t="Unexpected state"){const e=`FIRESTORE (${Zl}) INTERNAL ASSERTION FAILED: `+t;throw Ot(e),new Error(e)}function be(t,e){t||ve()}function xe(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ae extends Sr{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iL{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class ek{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(dn.UNAUTHENTICATED))}shutdown(){}}class sL{constructor(e){this.t=e,this.currentUser=dn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){be(this.o===void 0);let r=this.i;const i=h=>this.i!==r?(r=this.i,n(h)):Promise.resolve();let o=new _i;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new _i,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const h=o;e.enqueueRetryable(async()=>{await h.promise,await i(this.currentUser)})},u=h=>{te("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(h=>u(h)),setTimeout(()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?u(h):(te("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new _i)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(te("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(be(typeof r.accessToken=="string"),new iL(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return be(e===null||typeof e=="string"),new dn(e)}}class oL{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=dn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class aL{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new oL(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(dn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class lL{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class cL{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){be(this.o===void 0);const r=o=>{o.error!=null&&te("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const a=o.token!==this.R;return this.R=o.token,te("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};const i=o=>{te("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){const o=this.A.getImmediate({optional:!0});o?i(o):te("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(be(typeof n.token=="string"),this.R=n.token,new lL(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uL(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T_{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=uL(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<n&&(r+=e.charAt(i[o]%e.length))}return r}}function Le(t,e){return t<e?-1:t>e?1:0}function Cl(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function tk(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ze{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new ae(J.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ae(J.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new ae(J.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ae(J.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ze.fromMillis(Date.now())}static fromDate(e){return Ze.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Ze(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Le(this.nanoseconds,e.nanoseconds):Le(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Te{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Te(e)}static min(){return new Te(new Ze(0,0))}static max(){return new Te(new Ze(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cu{constructor(e,n,r){n===void 0?n=0:n>e.length&&ve(),r===void 0?r=e.length-n:r>e.length-n&&ve(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Cu.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Cu?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const o=e.get(i),a=n.get(i);if(o<a)return-1;if(o>a)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class tt extends Cu{construct(e,n,r){return new tt(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new ae(J.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new tt(n)}static emptyPath(){return new tt([])}}const dL=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class xt extends Cu{construct(e,n,r){return new xt(e,n,r)}static isValidIdentifier(e){return dL.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),xt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new xt(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const o=()=>{if(r.length===0)throw new ae(J.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let a=!1;for(;i<e.length;){const u=e[i];if(u==="\\"){if(i+1===e.length)throw new ae(J.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new ae(J.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,i+=2}else u==="`"?(a=!a,i++):u!=="."||a?(r+=u,i++):(o(),i++)}if(o(),a)throw new ae(J.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new xt(n)}static emptyPath(){return new xt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class he{constructor(e){this.path=e}static fromPath(e){return new he(tt.fromString(e))}static fromName(e){return new he(tt.fromString(e).popFirst(5))}static empty(){return new he(tt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&tt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return tt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new he(new tt(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gf{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function Bg(t){return t.fields.find(e=>e.kind===2)}function ko(t){return t.fields.filter(e=>e.kind!==2)}gf.UNKNOWN_ID=-1;class kh{constructor(e,n){this.fieldPath=e,this.kind=n}}class Ru{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Ru(0,ar.min())}}function nk(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=Te.fromTimestamp(r===1e9?new Ze(n+1,0):new Ze(n,r));return new ar(i,he.empty(),e)}function rk(t){return new ar(t.readTime,t.key,-1)}class ar{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new ar(Te.min(),he.empty(),-1)}static max(){return new ar(Te.max(),he.empty(),-1)}}function E_(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=he.comparator(t.documentKey,e.documentKey),n!==0?n:Le(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ik="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class sk{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function co(t){if(t.code!==J.FAILED_PRECONDITION||t.message!==ik)throw t;te("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ve(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new H((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(n,o).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof H?n:H.resolve(n)}catch(n){return H.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):H.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):H.reject(n)}static resolve(e){return new H((n,r)=>{n(e)})}static reject(e){return new H((n,r)=>{r(e)})}static waitFor(e){return new H((n,r)=>{let i=0,o=0,a=!1;e.forEach(u=>{++i,u.next(()=>{++o,a&&o===i&&n()},h=>r(h))}),a=!0,o===i&&n()})}static or(e){let n=H.resolve(!1);for(const r of e)n=n.next(i=>i?H.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,o)=>{r.push(n.call(this,i,o))}),this.waitFor(r)}static mapArray(e,n){return new H((r,i)=>{const o=e.length,a=new Array(o);let u=0;for(let h=0;h<o;h++){const m=h;n(e[m]).next(y=>{a[m]=y,++u,u===o&&r(a)},y=>i(y))}})}static doWhile(e,n){return new H((r,i)=>{const o=()=>{e()===!0?n().next(()=>{o()},i):r()};o()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nm{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new _i,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new ru(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=k_(r.target.error);this.V.reject(new ru(e,i))}}static open(e,n,r,i){try{return new nm(n,e.transaction(i,r))}catch(o){throw new ru(n,o)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(te("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new fL(n)}}class Js{constructor(e,n,r){this.name=e,this.version=n,this.p=r,Js.S(Wt())===12.2&&Ot("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return te("SimpleDb","Removing database:",e),Po(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!c_())return!1;if(Js.v())return!0;const e=Wt(),n=Js.S(e),r=0<n&&n<10,i=ok(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(te("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=o=>{const a=o.target.result;n(a)},i.onblocked=()=>{r(new ru(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=o=>{const a=o.target.error;a.name==="VersionError"?r(new ae(J.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):a.name==="InvalidStateError"?r(new ae(J.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a)):r(new ru(e,a))},i.onupgradeneeded=o=>{te("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);const a=o.target.result;this.p.O(a,i.transaction,o.oldVersion,this.version).next(()=>{te("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=n=>this.N(n)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const o=n==="readonly";let a=0;for(;;){++a;try{this.db=await this.M(e);const u=nm.open(this.db,e,o?"readonly":"readwrite",r),h=i(u).next(m=>(u.g(),m)).catch(m=>(u.abort(m),H.reject(m))).toPromise();return h.catch(()=>{}),await u.m,h}catch(u){const h=u,m=h.name!=="FirebaseError"&&a<3;if(te("SimpleDb","Transaction failed with error:",h.message,"Retrying:",m),this.close(),!m)return Promise.reject(h)}}}close(){this.db&&this.db.close(),this.db=void 0}}function ok(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class hL{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Po(this.B.delete())}}class ru extends ae{constructor(e,n){super(J.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function uo(t){return t.name==="IndexedDbTransactionError"}class fL{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(te("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(te("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Po(r)}add(e){return te("SimpleDb","ADD",this.store.name,e,e),Po(this.store.add(e))}get(e){return Po(this.store.get(e)).next(n=>(n===void 0&&(n=null),te("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return te("SimpleDb","DELETE",this.store.name,e),Po(this.store.delete(e))}count(){return te("SimpleDb","COUNT",this.store.name),Po(this.store.count())}U(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const o=i.getAll(r.range);return new H((a,u)=>{o.onerror=h=>{u(h.target.error)},o.onsuccess=h=>{a(h.target.result)}})}{const o=this.cursor(r),a=[];return this.W(o,(u,h)=>{a.push(h)}).next(()=>a)}}G(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new H((i,o)=>{r.onerror=a=>{o(a.target.error)},r.onsuccess=a=>{i(a.target.result)}})}j(e,n){te("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.H=!1;const i=this.cursor(r);return this.W(i,(o,a,u)=>u.delete())}J(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.W(i,n)}Y(e){const n=this.cursor({});return new H((r,i)=>{n.onerror=o=>{const a=k_(o.target.error);i(a)},n.onsuccess=o=>{const a=o.target.result;a?e(a.primaryKey,a.value).next(u=>{u?a.continue():r()}):r()}})}W(e,n){const r=[];return new H((i,o)=>{e.onerror=a=>{o(a.target.error)},e.onsuccess=a=>{const u=a.target.result;if(!u)return void i();const h=new hL(u),m=n(u.primaryKey,u.value,h);if(m instanceof H){const y=m.catch(v=>(h.done(),H.reject(v)));r.push(y)}h.isDone?i():h.K===null?u.continue():u.continue(h.K)}}).next(()=>H.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Po(t){return new H((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=k_(r.target.error);n(i)}})}let Xx=!1;function k_(t){const e=Js.S(Wt());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new ae("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Xx||(Xx=!0,setTimeout(()=>{throw r},0)),r}}return t}class mL{constructor(e,n){this.asyncQueue=e,this.Z=n,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){te("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{te("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(n){uo(n)?te("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):await co(n)}await this.X(6e4)})}}class pL{constructor(e,n){this.localStore=e,this.persistence=n}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.te(n,e))}te(e,n){const r=new Set;let i=n,o=!0;return H.doWhile(()=>o===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(a=>{if(a!==null&&!r.has(a))return te("IndexBackfiller",`Processing collection: ${a}`),this.ne(e,a,i).next(u=>{i-=u,r.add(a)});o=!1})).next(()=>n-i)}ne(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(o=>{const a=o.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next(()=>this.re(i,o)).next(u=>(te("IndexBackfiller",`Updating offset: ${u}`),this.localStore.indexManager.updateCollectionGroup(e,n,u))).next(()=>a.size)}))}re(e,n){let r=e;return n.changes.forEach((i,o)=>{const a=rk(o);E_(a,r)>0&&(r=a)}),new ar(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bn{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Bn.oe=-1;function rm(t){return t==null}function ju(t){return t===0&&1/t==-1/0}function ak(t){return typeof t=="number"&&Number.isInteger(t)&&!ju(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sn(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=ew(e)),e=gL(t.get(n),e);return ew(e)}function gL(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function ew(t){return t+""}function hi(t){const e=t.length;if(be(e>=2),e===2)return be(t.charAt(0)===""&&t.charAt(1)===""),tt.emptyPath();const n=e-2,r=[];let i="";for(let o=0;o<e;){const a=t.indexOf("",o);switch((a<0||a>n)&&ve(),t.charAt(a+1)){case"":const u=t.substring(o,a);let h;i.length===0?h=u:(i+=u,h=i,i=""),r.push(h);break;case"":i+=t.substring(o,a),i+="\0";break;case"":i+=t.substring(o,a+1);break;default:ve()}o=a+2}return new tt(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tw=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sh(t,e){return[t,Sn(e)]}function lk(t,e,n){return[t,Sn(e),n]}const yL={},_L=["prefixPath","collectionGroup","readTime","documentId"],vL=["prefixPath","collectionGroup","documentId"],xL=["collectionGroup","readTime","prefixPath","documentId"],wL=["canonicalId","targetId"],bL=["targetId","path"],IL=["path","targetId"],TL=["collectionId","parent"],EL=["indexId","uid"],kL=["uid","sequenceNumber"],SL=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],PL=["indexId","uid","orderedDocumentKey"],NL=["userId","collectionPath","documentId"],AL=["userId","collectionPath","largestBatchId"],CL=["userId","collectionGroup","largestBatchId"],ck=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],RL=[...ck,"documentOverlays"],uk=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],dk=uk,S_=[...dk,"indexConfiguration","indexState","indexEntries"],jL=S_,LL=[...S_,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zg extends sk{constructor(e,n){super(),this._e=e,this.currentSequenceNumber=n}}function Gt(t,e){const n=xe(t);return Js.F(n._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nw(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function da(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function hk(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e,n){this.comparator=e,this.root=n||nn.EMPTY}insert(e,n){return new ht(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,nn.BLACK,null,null))}remove(e){return new ht(this.comparator,this.root.remove(e,this.comparator).copy(null,null,nn.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Jd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Jd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Jd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Jd(this.root,e,this.comparator,!0)}}class Jd{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=n?r(e.key,n):1,n&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class nn{constructor(e,n,r,i,o){this.key=e,this.value=n,this.color=r??nn.RED,this.left=i??nn.EMPTY,this.right=o??nn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,o){return new nn(e??this.key,n??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,n,r),null):o===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return nn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return nn.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,nn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,nn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ve();const e=this.left.check();if(e!==this.right.check())throw ve();return e+(this.isRed()?0:1)}}nn.EMPTY=null,nn.RED=!0,nn.BLACK=!1;nn.EMPTY=new class{constructor(){this.size=0}get key(){throw ve()}get value(){throw ve()}get color(){throw ve()}get left(){throw ve()}get right(){throw ve()}copy(e,n,r,i,o){return this}insert(e,n,r){return new nn(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{constructor(e){this.comparator=e,this.data=new ht(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new rw(this.data.getIterator())}getIteratorFrom(e){return new rw(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof at)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new at(this.comparator);return n.data=e,n}}class rw{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function za(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e){this.fields=e,e.sort(xt.comparator)}static empty(){return new zn([])}unionWith(e){let n=new at(xt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new zn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Cl(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fk extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new fk("Invalid base64 string: "+o):o}}(e);return new Rt(n)}static fromUint8Array(e){const n=function(i){let o="";for(let a=0;a<i.length;++a)o+=String.fromCharCode(i[a]);return o}(e);return new Rt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Le(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Rt.EMPTY_BYTE_STRING=new Rt("");const DL=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ns(t){if(be(!!t),typeof t=="string"){let e=0;const n=DL.exec(t);if(be(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:_t(t.seconds),nanos:_t(t.nanos)}}function _t(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function to(t){return typeof t=="string"?Rt.fromBase64String(t):Rt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P_(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function N_(t){const e=t.mapValue.fields.__previous_value__;return P_(e)?N_(e):e}function Lu(t){const e=ns(t.mapValue.fields.__local_write_time__.timestampValue);return new Ze(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ML{constructor(e,n,r,i,o,a,u,h,m){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=h,this.useFetchStreams=m}}class no{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new no("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof no&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bs={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Ph={nullValue:"NULL_VALUE"};function Yo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?P_(t)?4:mk(t)?9007199254740991:im(t)?10:11:ve()}function vi(t,e){if(t===e)return!0;const n=Yo(t);if(n!==Yo(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Lu(t).isEqual(Lu(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const a=ns(i.timestampValue),u=ns(o.timestampValue);return a.seconds===u.seconds&&a.nanos===u.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,o){return to(i.bytesValue).isEqual(to(o.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,o){return _t(i.geoPointValue.latitude)===_t(o.geoPointValue.latitude)&&_t(i.geoPointValue.longitude)===_t(o.geoPointValue.longitude)}(t,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return _t(i.integerValue)===_t(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const a=_t(i.doubleValue),u=_t(o.doubleValue);return a===u?ju(a)===ju(u):isNaN(a)&&isNaN(u)}return!1}(t,e);case 9:return Cl(t.arrayValue.values||[],e.arrayValue.values||[],vi);case 10:case 11:return function(i,o){const a=i.mapValue.fields||{},u=o.mapValue.fields||{};if(nw(a)!==nw(u))return!1;for(const h in a)if(a.hasOwnProperty(h)&&(u[h]===void 0||!vi(a[h],u[h])))return!1;return!0}(t,e);default:return ve()}}function Du(t,e){return(t.values||[]).find(n=>vi(n,e))!==void 0}function ro(t,e){if(t===e)return 0;const n=Yo(t),r=Yo(e);if(n!==r)return Le(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Le(t.booleanValue,e.booleanValue);case 2:return function(o,a){const u=_t(o.integerValue||o.doubleValue),h=_t(a.integerValue||a.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1}(t,e);case 3:return iw(t.timestampValue,e.timestampValue);case 4:return iw(Lu(t),Lu(e));case 5:return Le(t.stringValue,e.stringValue);case 6:return function(o,a){const u=to(o),h=to(a);return u.compareTo(h)}(t.bytesValue,e.bytesValue);case 7:return function(o,a){const u=o.split("/"),h=a.split("/");for(let m=0;m<u.length&&m<h.length;m++){const y=Le(u[m],h[m]);if(y!==0)return y}return Le(u.length,h.length)}(t.referenceValue,e.referenceValue);case 8:return function(o,a){const u=Le(_t(o.latitude),_t(a.latitude));return u!==0?u:Le(_t(o.longitude),_t(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return sw(t.arrayValue,e.arrayValue);case 10:return function(o,a){var u,h,m,y;const v=o.fields||{},w=a.fields||{},S=(u=v.value)===null||u===void 0?void 0:u.arrayValue,N=(h=w.value)===null||h===void 0?void 0:h.arrayValue,P=Le(((m=S==null?void 0:S.values)===null||m===void 0?void 0:m.length)||0,((y=N==null?void 0:N.values)===null||y===void 0?void 0:y.length)||0);return P!==0?P:sw(S,N)}(t.mapValue,e.mapValue);case 11:return function(o,a){if(o===Bs.mapValue&&a===Bs.mapValue)return 0;if(o===Bs.mapValue)return 1;if(a===Bs.mapValue)return-1;const u=o.fields||{},h=Object.keys(u),m=a.fields||{},y=Object.keys(m);h.sort(),y.sort();for(let v=0;v<h.length&&v<y.length;++v){const w=Le(h[v],y[v]);if(w!==0)return w;const S=ro(u[h[v]],m[y[v]]);if(S!==0)return S}return Le(h.length,y.length)}(t.mapValue,e.mapValue);default:throw ve()}}function iw(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Le(t,e);const n=ns(t),r=ns(e),i=Le(n.seconds,r.seconds);return i!==0?i:Le(n.nanos,r.nanos)}function sw(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const o=ro(n[i],r[i]);if(o)return o}return Le(n.length,r.length)}function Rl(t){return qg(t)}function qg(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=ns(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return to(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return he.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const o of n.values||[])i?i=!1:r+=",",r+=qg(o);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",o=!0;for(const a of r)o?o=!1:i+=",",i+=`${a}:${qg(n.fields[a])}`;return i+"}"}(t.mapValue):ve()}function Mu(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function $g(t){return!!t&&"integerValue"in t}function Ou(t){return!!t&&"arrayValue"in t}function ow(t){return!!t&&"nullValue"in t}function aw(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Nh(t){return!!t&&"mapValue"in t}function im(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function iu(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return da(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=iu(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=iu(t.arrayValue.values[n]);return e}return Object.assign({},t)}function mk(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const pk={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function OL(t){return"nullValue"in t?Ph:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Mu(no.empty(),he.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?im(t)?pk:{mapValue:{}}:ve()}function VL(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Mu(no.empty(),he.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?pk:"mapValue"in t?im(t)?{mapValue:{}}:Bs:ve()}function lw(t,e){const n=ro(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function cw(t,e){const n=ro(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(e){this.value=e}static empty(){return new fn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Nh(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=iu(n)}setAll(e){let n=xt.emptyPath(),r={},i=[];e.forEach((a,u)=>{if(!n.isImmediateParentOf(u)){const h=this.getFieldsMap(n);this.applyChanges(h,r,i),r={},i=[],n=u.popLast()}a?r[u.lastSegment()]=iu(a):i.push(u.lastSegment())});const o=this.getFieldsMap(n);this.applyChanges(o,r,i)}delete(e){const n=this.field(e.popLast());Nh(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return vi(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Nh(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){da(n,(i,o)=>e[i]=o);for(const i of r)delete e[i]}clone(){return new fn(iu(this.value))}}function gk(t){const e=[];return da(t.fields,(n,r)=>{const i=new xt([n]);if(Nh(r)){const o=gk(r.mapValue).fields;if(o.length===0)e.push(i);else for(const a of o)e.push(i.child(a))}else e.push(i)}),new zn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ct{constructor(e,n,r,i,o,a,u){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=o,this.data=a,this.documentState=u}static newInvalidDocument(e){return new Ct(e,0,Te.min(),Te.min(),Te.min(),fn.empty(),0)}static newFoundDocument(e,n,r,i){return new Ct(e,1,n,Te.min(),r,i,0)}static newNoDocument(e,n){return new Ct(e,2,n,Te.min(),Te.min(),fn.empty(),0)}static newUnknownDocument(e,n){return new Ct(e,3,n,Te.min(),Te.min(),fn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Te.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=fn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=fn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Te.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ct&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ct(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jl{constructor(e,n){this.position=e,this.inclusive=n}}function uw(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const o=e[i],a=t.position[i];if(o.field.isKeyField()?r=he.comparator(he.fromName(a.referenceValue),n.key):r=ro(a,n.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function dw(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!vi(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu{constructor(e,n="asc"){this.field=e,this.dir=n}}function FL(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yk{}class $e extends yk{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new UL(e,n,r):n==="array-contains"?new qL(e,r):n==="in"?new Ik(e,r):n==="not-in"?new $L(e,r):n==="array-contains-any"?new HL(e,r):new $e(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new BL(e,r):new zL(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(ro(n,this.value)):n!==null&&Yo(this.value)===Yo(n)&&this.matchesComparison(ro(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ve()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class rt extends yk{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new rt(e,n)}matches(e){return Ll(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Ll(t){return t.op==="and"}function Hg(t){return t.op==="or"}function A_(t){return _k(t)&&Ll(t)}function _k(t){for(const e of t.filters)if(e instanceof rt)return!1;return!0}function Wg(t){if(t instanceof $e)return t.field.canonicalString()+t.op.toString()+Rl(t.value);if(A_(t))return t.filters.map(e=>Wg(e)).join(",");{const e=t.filters.map(n=>Wg(n)).join(",");return`${t.op}(${e})`}}function vk(t,e){return t instanceof $e?function(r,i){return i instanceof $e&&r.op===i.op&&r.field.isEqual(i.field)&&vi(r.value,i.value)}(t,e):t instanceof rt?function(r,i){return i instanceof rt&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,a,u)=>o&&vk(a,i.filters[u]),!0):!1}(t,e):void ve()}function xk(t,e){const n=t.filters.concat(e);return rt.create(n,t.op)}function wk(t){return t instanceof $e?function(n){return`${n.field.canonicalString()} ${n.op} ${Rl(n.value)}`}(t):t instanceof rt?function(n){return n.op.toString()+" {"+n.getFilters().map(wk).join(" ,")+"}"}(t):"Filter"}class UL extends $e{constructor(e,n,r){super(e,n,r),this.key=he.fromName(r.referenceValue)}matches(e){const n=he.comparator(e.key,this.key);return this.matchesComparison(n)}}class BL extends $e{constructor(e,n){super(e,"in",n),this.keys=bk("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class zL extends $e{constructor(e,n){super(e,"not-in",n),this.keys=bk("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function bk(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>he.fromName(r.referenceValue))}class qL extends $e{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Ou(n)&&Du(n.arrayValue,this.value)}}class Ik extends $e{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Du(this.value.arrayValue,n)}}class $L extends $e{constructor(e,n){super(e,"not-in",n)}matches(e){if(Du(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Du(this.value.arrayValue,n)}}class HL extends $e{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Ou(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Du(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WL{constructor(e,n=null,r=[],i=[],o=null,a=null,u=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=a,this.endAt=u,this.ue=null}}function Gg(t,e=null,n=[],r=[],i=null,o=null,a=null){return new WL(t,e,n,r,i,o,a)}function Jo(t){const e=xe(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Wg(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),rm(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Rl(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Rl(r)).join(",")),e.ue=n}return e.ue}function td(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!FL(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!vk(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!dw(t.startAt,e.startAt)&&dw(t.endAt,e.endAt)}function yf(t){return he.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function _f(t,e){return t.filters.filter(n=>n instanceof $e&&n.field.isEqual(e))}function hw(t,e,n){let r=Ph,i=!0;for(const o of _f(t,e)){let a=Ph,u=!0;switch(o.op){case"<":case"<=":a=OL(o.value);break;case"==":case"in":case">=":a=o.value;break;case">":a=o.value,u=!1;break;case"!=":case"not-in":a=Ph}lw({value:r,inclusive:i},{value:a,inclusive:u})<0&&(r=a,i=u)}if(n!==null){for(let o=0;o<t.orderBy.length;++o)if(t.orderBy[o].field.isEqual(e)){const a=n.position[o];lw({value:r,inclusive:i},{value:a,inclusive:n.inclusive})<0&&(r=a,i=n.inclusive);break}}return{value:r,inclusive:i}}function fw(t,e,n){let r=Bs,i=!0;for(const o of _f(t,e)){let a=Bs,u=!0;switch(o.op){case">=":case">":a=VL(o.value),u=!1;break;case"==":case"in":case"<=":a=o.value;break;case"<":a=o.value,u=!1;break;case"!=":case"not-in":a=Bs}cw({value:r,inclusive:i},{value:a,inclusive:u})>0&&(r=a,i=u)}if(n!==null){for(let o=0;o<t.orderBy.length;++o)if(t.orderBy[o].field.isEqual(e)){const a=n.position[o];cw({value:r,inclusive:i},{value:a,inclusive:n.inclusive})>0&&(r=a,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ql{constructor(e,n=null,r=[],i=[],o=null,a="F",u=null,h=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=a,this.startAt=u,this.endAt=h,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function Tk(t,e,n,r,i,o,a,u){return new Ql(t,e,n,r,i,o,a,u)}function nd(t){return new Ql(t)}function mw(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Ek(t){return t.collectionGroup!==null}function su(t){const e=xe(t);if(e.ce===null){e.ce=[];const n=new Set;for(const o of e.explicitOrderBy)e.ce.push(o),n.add(o.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let u=new at(xt.comparator);return a.filters.forEach(h=>{h.getFlattenedFilters().forEach(m=>{m.isInequality()&&(u=u.add(m.field))})}),u})(e).forEach(o=>{n.has(o.canonicalString())||o.isKeyField()||e.ce.push(new Vu(o,r))}),n.has(xt.keyField().canonicalString())||e.ce.push(new Vu(xt.keyField(),r))}return e.ce}function ir(t){const e=xe(t);return e.le||(e.le=GL(e,su(t))),e.le}function GL(t,e){if(t.limitType==="F")return Gg(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const o=i.dir==="desc"?"asc":"desc";return new Vu(i.field,o)});const n=t.endAt?new jl(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new jl(t.startAt.position,t.startAt.inclusive):null;return Gg(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Kg(t,e){const n=t.filters.concat([e]);return new Ql(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function vf(t,e,n){return new Ql(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function sm(t,e){return td(ir(t),ir(e))&&t.limitType===e.limitType}function kk(t){return`${Jo(ir(t))}|lt:${t.limitType}`}function Ga(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>wk(i)).join(", ")}]`),rm(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Rl(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Rl(i)).join(",")),`Target(${r})`}(ir(t))}; limitType=${t.limitType})`}function rd(t,e){return e.isFoundDocument()&&function(r,i){const o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):he.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(t,e)&&function(r,i){for(const o of su(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const o of r.filters)if(!o.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(a,u,h){const m=uw(a,u,h);return a.inclusive?m<=0:m<0}(r.startAt,su(r),i)||r.endAt&&!function(a,u,h){const m=uw(a,u,h);return a.inclusive?m>=0:m>0}(r.endAt,su(r),i))}(t,e)}function Sk(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Pk(t){return(e,n)=>{let r=!1;for(const i of su(t)){const o=KL(i,e,n);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function KL(t,e,n){const r=t.field.isKeyField()?he.comparator(e.key,n.key):function(o,a,u){const h=a.data.field(o),m=u.data.field(o);return h!==null&&m!==null?ro(h,m):ve()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ho{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){da(this.inner,(n,r)=>{for(const[i,o]of r)e(i,o)})}isEmpty(){return hk(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZL=new ht(he.comparator);function tr(){return ZL}const Nk=new ht(he.comparator);function $c(...t){let e=Nk;for(const n of t)e=e.insert(n.key,n);return e}function Ak(t){let e=Nk;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function fi(){return ou()}function Ck(){return ou()}function ou(){return new ho(t=>t.toString(),(t,e)=>t.isEqual(e))}const QL=new ht(he.comparator),YL=new at(he.comparator);function Oe(...t){let e=YL;for(const n of t)e=e.add(n);return e}const JL=new at(Le);function C_(){return JL}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R_(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ju(e)?"-0":e}}function Rk(t){return{integerValue:""+t}}function XL(t,e){return ak(e)?Rk(e):R_(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class om{constructor(){this._=void 0}}function eD(t,e,n){return t instanceof Dl?function(i,o){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&P_(o)&&(o=N_(o)),o&&(a.fields.__previous_value__=o),{mapValue:a}}(n,e):t instanceof Ml?Lk(t,e):t instanceof Xo?Dk(t,e):function(i,o){const a=jk(i,o),u=pw(a)+pw(i.Pe);return $g(a)&&$g(i.Pe)?Rk(u):R_(i.serializer,u)}(t,e)}function tD(t,e,n){return t instanceof Ml?Lk(t,e):t instanceof Xo?Dk(t,e):n}function jk(t,e){return t instanceof Fu?function(r){return $g(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}class Dl extends om{}class Ml extends om{constructor(e){super(),this.elements=e}}function Lk(t,e){const n=Mk(e);for(const r of t.elements)n.some(i=>vi(i,r))||n.push(r);return{arrayValue:{values:n}}}class Xo extends om{constructor(e){super(),this.elements=e}}function Dk(t,e){let n=Mk(e);for(const r of t.elements)n=n.filter(i=>!vi(i,r));return{arrayValue:{values:n}}}class Fu extends om{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function pw(t){return _t(t.integerValue||t.doubleValue)}function Mk(t){return Ou(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j_{constructor(e,n){this.field=e,this.transform=n}}function nD(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Ml&&i instanceof Ml||r instanceof Xo&&i instanceof Xo?Cl(r.elements,i.elements,vi):r instanceof Fu&&i instanceof Fu?vi(r.Pe,i.Pe):r instanceof Dl&&i instanceof Dl}(t.transform,e.transform)}class rD{constructor(e,n){this.version=e,this.transformResults=n}}class mn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new mn}static exists(e){return new mn(void 0,e)}static updateTime(e){return new mn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ah(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class am{}function Ok(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new lm(t.key,mn.none()):new Yl(t.key,t.data,mn.none());{const n=t.data,r=fn.empty();let i=new at(xt.comparator);for(let o of e.fields)if(!i.has(o)){let a=n.field(o);a===null&&o.length>1&&(o=o.popLast(),a=n.field(o)),a===null?r.delete(o):r.set(o,a),i=i.add(o)}return new as(t.key,r,new zn(i.toArray()),mn.none())}}function iD(t,e,n){t instanceof Yl?function(i,o,a){const u=i.value.clone(),h=yw(i.fieldTransforms,o,a.transformResults);u.setAll(h),o.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(t,e,n):t instanceof as?function(i,o,a){if(!Ah(i.precondition,o))return void o.convertToUnknownDocument(a.version);const u=yw(i.fieldTransforms,o,a.transformResults),h=o.data;h.setAll(Vk(i)),h.setAll(u),o.convertToFoundDocument(a.version,h).setHasCommittedMutations()}(t,e,n):function(i,o,a){o.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function au(t,e,n,r){return t instanceof Yl?function(o,a,u,h){if(!Ah(o.precondition,a))return u;const m=o.value.clone(),y=_w(o.fieldTransforms,h,a);return m.setAll(y),a.convertToFoundDocument(a.version,m).setHasLocalMutations(),null}(t,e,n,r):t instanceof as?function(o,a,u,h){if(!Ah(o.precondition,a))return u;const m=_w(o.fieldTransforms,h,a),y=a.data;return y.setAll(Vk(o)),y.setAll(m),a.convertToFoundDocument(a.version,y).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(v=>v.field))}(t,e,n,r):function(o,a,u){return Ah(o.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):u}(t,e,n)}function sD(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),o=jk(r.transform,i||null);o!=null&&(n===null&&(n=fn.empty()),n.set(r.field,o))}return n||null}function gw(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Cl(r,i,(o,a)=>nD(o,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Yl extends am{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class as extends am{constructor(e,n,r,i,o=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function Vk(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function yw(t,e,n){const r=new Map;be(t.length===n.length);for(let i=0;i<n.length;i++){const o=t[i],a=o.transform,u=e.data.field(o.field);r.set(o.field,tD(a,u,n[i]))}return r}function _w(t,e,n){const r=new Map;for(const i of t){const o=i.transform,a=n.data.field(i.field);r.set(i.field,eD(o,a,e))}return r}class lm extends am{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Fk extends am{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L_{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&iD(o,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=au(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=au(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=Ck();return this.mutations.forEach(i=>{const o=e.get(i.key),a=o.overlayedDocument;let u=this.applyToLocalView(a,o.mutatedFields);u=n.has(i.key)?null:u;const h=Ok(a,u);h!==null&&r.set(i.key,h),a.isValidDocument()||a.convertToNoDocument(Te.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Oe())}isEqual(e){return this.batchId===e.batchId&&Cl(this.mutations,e.mutations,(n,r)=>gw(n,r))&&Cl(this.baseMutations,e.baseMutations,(n,r)=>gw(n,r))}}class D_{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){be(e.mutations.length===r.length);let i=function(){return QL}();const o=e.mutations;for(let a=0;a<o.length;a++)i=i.insert(o[a].key,r[a].version);return new D_(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M_{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oD{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ut,Ke;function aD(t){switch(t){default:return ve();case J.CANCELLED:case J.UNKNOWN:case J.DEADLINE_EXCEEDED:case J.RESOURCE_EXHAUSTED:case J.INTERNAL:case J.UNAVAILABLE:case J.UNAUTHENTICATED:return!1;case J.INVALID_ARGUMENT:case J.NOT_FOUND:case J.ALREADY_EXISTS:case J.PERMISSION_DENIED:case J.FAILED_PRECONDITION:case J.ABORTED:case J.OUT_OF_RANGE:case J.UNIMPLEMENTED:case J.DATA_LOSS:return!0}}function Uk(t){if(t===void 0)return Ot("GRPC error has no .code"),J.UNKNOWN;switch(t){case Ut.OK:return J.OK;case Ut.CANCELLED:return J.CANCELLED;case Ut.UNKNOWN:return J.UNKNOWN;case Ut.DEADLINE_EXCEEDED:return J.DEADLINE_EXCEEDED;case Ut.RESOURCE_EXHAUSTED:return J.RESOURCE_EXHAUSTED;case Ut.INTERNAL:return J.INTERNAL;case Ut.UNAVAILABLE:return J.UNAVAILABLE;case Ut.UNAUTHENTICATED:return J.UNAUTHENTICATED;case Ut.INVALID_ARGUMENT:return J.INVALID_ARGUMENT;case Ut.NOT_FOUND:return J.NOT_FOUND;case Ut.ALREADY_EXISTS:return J.ALREADY_EXISTS;case Ut.PERMISSION_DENIED:return J.PERMISSION_DENIED;case Ut.FAILED_PRECONDITION:return J.FAILED_PRECONDITION;case Ut.ABORTED:return J.ABORTED;case Ut.OUT_OF_RANGE:return J.OUT_OF_RANGE;case Ut.UNIMPLEMENTED:return J.UNIMPLEMENTED;case Ut.DATA_LOSS:return J.DATA_LOSS;default:return ve()}}(Ke=Ut||(Ut={}))[Ke.OK=0]="OK",Ke[Ke.CANCELLED=1]="CANCELLED",Ke[Ke.UNKNOWN=2]="UNKNOWN",Ke[Ke.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ke[Ke.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ke[Ke.NOT_FOUND=5]="NOT_FOUND",Ke[Ke.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ke[Ke.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ke[Ke.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ke[Ke.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ke[Ke.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ke[Ke.ABORTED=10]="ABORTED",Ke[Ke.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ke[Ke.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ke[Ke.INTERNAL=13]="INTERNAL",Ke[Ke.UNAVAILABLE=14]="UNAVAILABLE",Ke[Ke.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lD(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cD=new Uo([4294967295,4294967295],0);function vw(t){const e=lD().encode(t),n=new KE;return n.update(e),new Uint8Array(n.digest())}function xw(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Uo([n,r],0),new Uo([i,o],0)]}class O_{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Hc(`Invalid padding: ${n}`);if(r<0)throw new Hc(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Hc(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Hc(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Uo.fromNumber(this.Ie)}Ee(e,n,r){let i=e.add(n.multiply(Uo.fromNumber(r)));return i.compare(cD)===1&&(i=new Uo([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=vw(e),[r,i]=xw(n);for(let o=0;o<this.hashCount;o++){const a=this.Ee(r,i,o);if(!this.de(a))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),a=new O_(o,i,n);return r.forEach(u=>a.insert(u)),a}insert(e){if(this.Ie===0)return;const n=vw(e),[r,i]=xw(n);for(let o=0;o<this.hashCount;o++){const a=this.Ee(r,i,o);this.Ae(a)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Hc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class id{constructor(e,n,r,i,o){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,sd.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new id(Te.min(),i,new ht(Le),tr(),Oe())}}class sd{constructor(e,n,r,i,o){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new sd(r,n,Oe(),Oe(),Oe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ch{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}}class Bk{constructor(e,n){this.targetId=e,this.me=n}}class zk{constructor(e,n,r=Rt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class ww{constructor(){this.fe=0,this.ge=Iw(),this.pe=Rt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Oe(),n=Oe(),r=Oe();return this.ge.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:ve()}}),new sd(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=Iw()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,be(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class uD{constructor(e){this.Le=e,this.Be=new Map,this.ke=tr(),this.qe=bw(),this.Qe=new ht(Le)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:ve()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.ze(i)&&n(i)})}He(e){const n=e.targetId,r=e.me.count,i=this.Je(n);if(i){const o=i.target;if(yf(o))if(r===0){const a=new he(o.path);this.Ue(n,a,Ct.newNoDocument(a,Te.min()))}else be(r===1);else{const a=this.Ye(n);if(a!==r){const u=this.Ze(e),h=u?this.Xe(u,e,a):1;if(h!==0){this.je(n);const m=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,m)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=n;let a,u;try{a=to(r).toUint8Array()}catch(h){if(h instanceof fk)return Al("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{u=new O_(a,i,o)}catch(h){return Al(h instanceof Hc?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return u.Ie===0?null:u}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(o=>{const a=this.Le.tt(),u=`projects/${a.projectId}/databases/${a.database}/documents/${o.path.canonicalString()}`;e.mightContain(u)||(this.Ue(n,o,null),i++)}),i}rt(e){const n=new Map;this.Be.forEach((o,a)=>{const u=this.Je(a);if(u){if(o.current&&yf(u.target)){const h=new he(u.target.path);this.ke.get(h)!==null||this.it(a,h)||this.Ue(a,h,Ct.newNoDocument(h,e))}o.be&&(n.set(a,o.ve()),o.Ce())}});let r=Oe();this.qe.forEach((o,a)=>{let u=!0;a.forEachWhile(h=>{const m=this.Je(h);return!m||m.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(o))}),this.ke.forEach((o,a)=>a.setReadTime(e));const i=new id(e,n,this.Qe,this.ke,r);return this.ke=tr(),this.qe=bw(),this.Qe=new ht(Le),i}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,n)?i.Fe(n,1):i.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new ww,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new at(Le),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||te("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new ww),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function bw(){return new ht(he.comparator)}function Iw(){return new ht(he.comparator)}const dD={asc:"ASCENDING",desc:"DESCENDING"},hD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},fD={and:"AND",or:"OR"};class mD{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Zg(t,e){return t.useProto3Json||rm(e)?e:{value:e}}function Ol(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function qk(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function pD(t,e){return Ol(t,e.toTimestamp())}function Pn(t){return be(!!t),Te.fromTimestamp(function(n){const r=ns(n);return new Ze(r.seconds,r.nanos)}(t))}function V_(t,e){return Qg(t,e).canonicalString()}function Qg(t,e){const n=function(i){return new tt(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function $k(t){const e=tt.fromString(t);return be(Xk(e)),e}function xf(t,e){return V_(t.databaseId,e.path)}function Bo(t,e){const n=$k(e);if(n.get(1)!==t.databaseId.projectId)throw new ae(J.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ae(J.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new he(Gk(n))}function Hk(t,e){return V_(t.databaseId,e)}function Wk(t){const e=$k(t);return e.length===4?tt.emptyPath():Gk(e)}function Yg(t){return new tt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Gk(t){return be(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Tw(t,e,n){return{name:xf(t,e),fields:n.value.mapValue.fields}}function gD(t,e,n){const r=Bo(t,e.name),i=Pn(e.updateTime),o=e.createTime?Pn(e.createTime):Te.min(),a=new fn({mapValue:{fields:e.fields}}),u=Ct.newFoundDocument(r,i,o,a);return n&&u.setHasCommittedMutations(),n?u.setHasCommittedMutations():u}function yD(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:ve()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(m,y){return m.useProto3Json?(be(y===void 0||typeof y=="string"),Rt.fromBase64String(y||"")):(be(y===void 0||y instanceof Buffer||y instanceof Uint8Array),Rt.fromUint8Array(y||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,u=a&&function(m){const y=m.code===void 0?J.UNKNOWN:Uk(m.code);return new ae(y,m.message||"")}(a);n=new zk(r,i,o,u||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Bo(t,r.document.name),o=Pn(r.document.updateTime),a=r.document.createTime?Pn(r.document.createTime):Te.min(),u=new fn({mapValue:{fields:r.document.fields}}),h=Ct.newFoundDocument(i,o,a,u),m=r.targetIds||[],y=r.removedTargetIds||[];n=new Ch(m,y,h.key,h)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Bo(t,r.document),o=r.readTime?Pn(r.readTime):Te.min(),a=Ct.newNoDocument(i,o),u=r.removedTargetIds||[];n=new Ch([],u,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Bo(t,r.document),o=r.removedTargetIds||[];n=new Ch([],o,i,null)}else{if(!("filter"in e))return ve();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:o}=r,a=new oD(i,o),u=r.targetId;n=new Bk(u,a)}}return n}function wf(t,e){let n;if(e instanceof Yl)n={update:Tw(t,e.key,e.value)};else if(e instanceof lm)n={delete:xf(t,e.key)};else if(e instanceof as)n={update:Tw(t,e.key,e.data),updateMask:ID(e.fieldMask)};else{if(!(e instanceof Fk))return ve();n={verify:xf(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(o,a){const u=a.transform;if(u instanceof Dl)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof Ml)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof Xo)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Fu)return{fieldPath:a.field.canonicalString(),increment:u.Pe};throw ve()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:pD(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:ve()}(t,e.precondition)),n}function Jg(t,e){const n=e.currentDocument?function(o){return o.updateTime!==void 0?mn.updateTime(Pn(o.updateTime)):o.exists!==void 0?mn.exists(o.exists):mn.none()}(e.currentDocument):mn.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(a,u){let h=null;if("setToServerValue"in u)be(u.setToServerValue==="REQUEST_TIME"),h=new Dl;else if("appendMissingElements"in u){const y=u.appendMissingElements.values||[];h=new Ml(y)}else if("removeAllFromArray"in u){const y=u.removeAllFromArray.values||[];h=new Xo(y)}else"increment"in u?h=new Fu(a,u.increment):ve();const m=xt.fromServerFormat(u.fieldPath);return new j_(m,h)}(t,i)):[];if(e.update){e.update.name;const i=Bo(t,e.update.name),o=new fn({mapValue:{fields:e.update.fields}});if(e.updateMask){const a=function(h){const m=h.fieldPaths||[];return new zn(m.map(y=>xt.fromServerFormat(y)))}(e.updateMask);return new as(i,o,a,n,r)}return new Yl(i,o,n,r)}if(e.delete){const i=Bo(t,e.delete);return new lm(i,n)}if(e.verify){const i=Bo(t,e.verify);return new Fk(i,n)}return ve()}function _D(t,e){return t&&t.length>0?(be(e!==void 0),t.map(n=>function(i,o){let a=i.updateTime?Pn(i.updateTime):Pn(o);return a.isEqual(Te.min())&&(a=Pn(o)),new rD(a,i.transformResults||[])}(n,e))):[]}function Kk(t,e){return{documents:[Hk(t,e.path)]}}function Zk(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Hk(t,i);const o=function(m){if(m.length!==0)return Jk(rt.create(m,"and"))}(e.filters);o&&(n.structuredQuery.where=o);const a=function(m){if(m.length!==0)return m.map(y=>function(w){return{field:Ka(w.field),direction:xD(w.dir)}}(y))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);const u=Zg(t,e.limit);return u!==null&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=function(m){return{before:m.inclusive,values:m.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(m){return{before:!m.inclusive,values:m.position}}(e.endAt)),{_t:n,parent:i}}function Qk(t){let e=Wk(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){be(r===1);const y=n.from[0];y.allDescendants?i=y.collectionId:e=e.child(y.collectionId)}let o=[];n.where&&(o=function(v){const w=Yk(v);return w instanceof rt&&A_(w)?w.getFilters():[w]}(n.where));let a=[];n.orderBy&&(a=function(v){return v.map(w=>function(N){return new Vu(Za(N.field),function(F){switch(F){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(N.direction))}(w))}(n.orderBy));let u=null;n.limit&&(u=function(v){let w;return w=typeof v=="object"?v.value:v,rm(w)?null:w}(n.limit));let h=null;n.startAt&&(h=function(v){const w=!!v.before,S=v.values||[];return new jl(S,w)}(n.startAt));let m=null;return n.endAt&&(m=function(v){const w=!v.before,S=v.values||[];return new jl(S,w)}(n.endAt)),Tk(e,i,a,o,u,"F",h,m)}function vD(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ve()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Yk(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Za(n.unaryFilter.field);return $e.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Za(n.unaryFilter.field);return $e.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Za(n.unaryFilter.field);return $e.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Za(n.unaryFilter.field);return $e.create(a,"!=",{nullValue:"NULL_VALUE"});default:return ve()}}(t):t.fieldFilter!==void 0?function(n){return $e.create(Za(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ve()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return rt.create(n.compositeFilter.filters.map(r=>Yk(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ve()}}(n.compositeFilter.op))}(t):ve()}function xD(t){return dD[t]}function wD(t){return hD[t]}function bD(t){return fD[t]}function Ka(t){return{fieldPath:t.canonicalString()}}function Za(t){return xt.fromServerFormat(t.fieldPath)}function Jk(t){return t instanceof $e?function(n){if(n.op==="=="){if(aw(n.value))return{unaryFilter:{field:Ka(n.field),op:"IS_NAN"}};if(ow(n.value))return{unaryFilter:{field:Ka(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(aw(n.value))return{unaryFilter:{field:Ka(n.field),op:"IS_NOT_NAN"}};if(ow(n.value))return{unaryFilter:{field:Ka(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ka(n.field),op:wD(n.op),value:n.value}}}(t):t instanceof rt?function(n){const r=n.getFilters().map(i=>Jk(i));return r.length===1?r[0]:{compositeFilter:{op:bD(n.op),filters:r}}}(t):ve()}function ID(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Xk(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi{constructor(e,n,r,i,o=Te.min(),a=Te.min(),u=Rt.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=u,this.expectedCount=h}withSequenceNumber(e){return new qi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new qi(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new qi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new qi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eS{constructor(e){this.ct=e}}function TD(t,e){let n;if(e.document)n=gD(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=he.fromSegments(e.noDocument.path),i=ta(e.noDocument.readTime);n=Ct.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return ve();{const r=he.fromSegments(e.unknownDocument.path),i=ta(e.unknownDocument.version);n=Ct.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const o=new Ze(i[0],i[1]);return Te.fromTimestamp(o)}(e.readTime)),n}function Ew(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:bf(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(o,a){return{name:xf(o,a.key),fields:a.data.value.mapValue.fields,updateTime:Ol(o,a.version.toTimestamp()),createTime:Ol(o,a.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:ea(e.version)};else{if(!e.isUnknownDocument())return ve();r.unknownDocument={path:n.path.toArray(),version:ea(e.version)}}return r}function bf(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function ea(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ta(t){const e=new Ze(t.seconds,t.nanoseconds);return Te.fromTimestamp(e)}function No(t,e){const n=(e.baseMutations||[]).map(o=>Jg(t.ct,o));for(let o=0;o<e.mutations.length-1;++o){const a=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){const u=e.mutations[o+1];a.updateTransforms=u.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}const r=e.mutations.map(o=>Jg(t.ct,o)),i=Ze.fromMillis(e.localWriteTimeMs);return new L_(e.batchId,i,n,r)}function Wc(t){const e=ta(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?ta(t.lastLimboFreeSnapshotVersion):Te.min();let r;return r=function(o){return o.documents!==void 0}(t.query)?function(o){return be(o.documents.length===1),ir(nd(Wk(o.documents[0])))}(t.query):function(o){return ir(Qk(o))}(t.query),new qi(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Rt.fromBase64String(t.resumeToken))}function tS(t,e){const n=ea(e.snapshotVersion),r=ea(e.lastLimboFreeSnapshotVersion);let i;i=yf(e.target)?Kk(t.ct,e.target):Zk(t.ct,e.target)._t;const o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Jo(e.target),readTime:n,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function nS(t){const e=Qk({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?vf(e,e.limit,"L"):e}function Tp(t,e){return new M_(e.largestBatchId,Jg(t.ct,e.overlayMutation))}function kw(t,e){const n=e.path.lastSegment();return[t,Sn(e.path.popLast()),n]}function Sw(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:ea(r.readTime),documentKey:Sn(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ED{getBundleMetadata(e,n){return Pw(e).get(n).next(r=>{if(r)return function(o){return{id:o.bundleId,createTime:ta(o.createTime),version:o.version}}(r)})}saveBundleMetadata(e,n){return Pw(e).put(function(i){return{bundleId:i.id,createTime:ea(Pn(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return Nw(e).get(n).next(r=>{if(r)return function(o){return{name:o.name,query:nS(o.bundledQuery),readTime:ta(o.readTime)}}(r)})}saveNamedQuery(e,n){return Nw(e).put(function(i){return{name:i.name,readTime:ea(Pn(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function Pw(t){return Gt(t,"bundles")}function Nw(t){return Gt(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cm{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){const r=n.uid||"";return new cm(e,r)}getOverlay(e,n){return Nc(e).get(kw(this.userId,n)).next(r=>r?Tp(this.serializer,r):null)}getOverlays(e,n){const r=fi();return H.forEach(n,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((o,a)=>{const u=new M_(n,a);i.push(this.ht(e,u))}),H.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(a=>i.add(Sn(a.getCollectionPath())));const o=[];return i.forEach(a=>{const u=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,r+1],!1,!0);o.push(Nc(e).j("collectionPathOverlayIndex",u))}),H.waitFor(o)}getOverlaysForCollection(e,n,r){const i=fi(),o=Sn(n),a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,Number.POSITIVE_INFINITY],!0);return Nc(e).U("collectionPathOverlayIndex",a).next(u=>{for(const h of u){const m=Tp(this.serializer,h);i.set(m.getKey(),m)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const o=fi();let a;const u=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Nc(e).J({index:"collectionGroupOverlayIndex",range:u},(h,m,y)=>{const v=Tp(this.serializer,m);o.size()<i||v.largestBatchId===a?(o.set(v.getKey(),v),a=v.largestBatchId):y.done()}).next(()=>o)}ht(e,n){return Nc(e).put(function(i,o,a){const[u,h,m]=kw(o,a.mutation.key);return{userId:o,collectionPath:h,documentId:m,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:wf(i.ct,a.mutation)}}(this.serializer,this.userId,n))}}function Nc(t){return Gt(t,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kD{Pt(e){return Gt(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?Rt.fromUint8Array(r):Rt.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.Pt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao{constructor(){}It(e,n){this.Tt(e,n),n.Et()}Tt(e,n){if("nullValue"in e)this.dt(n,5);else if("booleanValue"in e)this.dt(n,10),n.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(n,15),n.At(_t(e.integerValue));else if("doubleValue"in e){const r=_t(e.doubleValue);isNaN(r)?this.dt(n,13):(this.dt(n,15),ju(r)?n.At(0):n.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(n,20),typeof r=="string"&&(r=ns(r)),n.Rt(`${r.seconds||""}`),n.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,n),this.ft(n);else if("bytesValue"in e)this.dt(n,30),n.gt(to(e.bytesValue)),this.ft(n);else if("referenceValue"in e)this.yt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(n,45),n.At(r.latitude||0),n.At(r.longitude||0)}else"mapValue"in e?mk(e)?this.dt(n,Number.MAX_SAFE_INTEGER):im(e)?this.wt(e.mapValue,n):(this.St(e.mapValue,n),this.ft(n)):"arrayValue"in e?(this.bt(e.arrayValue,n),this.ft(n)):ve()}Vt(e,n){this.dt(n,25),this.Dt(e,n)}Dt(e,n){n.Rt(e)}St(e,n){const r=e.fields||{};this.dt(n,55);for(const i of Object.keys(r))this.Vt(i,n),this.Tt(r[i],n)}wt(e,n){var r,i;const o=e.fields||{};this.dt(n,53);const a="value",u=((i=(r=o[a].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(n,15),n.At(_t(u)),this.Vt(a,n),this.Tt(o[a],n)}bt(e,n){const r=e.values||[];this.dt(n,50);for(const i of r)this.Tt(i,n)}yt(e,n){this.dt(n,37),he.fromName(e).path.forEach(r=>{this.dt(n,60),this.Dt(r,n)})}dt(e,n){e.At(n)}ft(e){e.At(2)}}Ao.vt=new Ao;function SD(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function Aw(t){const e=64-function(r){let i=0;for(let o=0;o<8;++o){const a=SD(255&r[o]);if(i+=a,a!==8)break}return i}(t);return Math.ceil(e/8)}class PD{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ft(r.value),r=n.next();this.Mt()}xt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ot(r.value),r=n.next();this.Nt()}Lt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=n.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const i=n.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){const n=this.qt(e),r=Aw(n);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}Kt(e){const n=this.qt(e),r=Aw(n);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const n=function(o){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,o,!1),new Uint8Array(a.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Ft(e){const n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(n)}Ot(e){const n=255&e;n===0?(this.Gt(0),this.Gt(255)):n===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class ND{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class AD{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class Ac{constructor(){this.jt=new PD,this.Ht=new ND(this.jt),this.Jt=new AD(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Zt(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Co(this.indexId,this.documentKey,this.arrayValue,r)}}function Ss(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=Cw(t.arrayValue,e.arrayValue),n!==0?n:(n=Cw(t.directionalValue,e.directionalValue),n!==0?n:he.comparator(t.documentKey,e.documentKey)))}function Cw(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rw{constructor(e){this.Xt=new at((n,r)=>xt.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const n of e.filters){const r=n;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(be(e.collectionGroup===this.collectionId),this.nn)return!1;const n=Bg(e);if(n!==void 0&&!this.sn(n))return!1;const r=ko(e);let i=new Set,o=0,a=0;for(;o<r.length&&this.sn(r[o]);++o)i=i.add(r[o].fieldPath.canonicalString());if(o===r.length)return!0;if(this.Xt.size>0){const u=this.Xt.getIterator().getNext();if(!i.has(u.field.canonicalString())){const h=r[o];if(!this.on(u,h)||!this._n(this.en[a++],h))return!1}++o}for(;o<r.length;++o){const u=r[o];if(a>=this.en.length||!this._n(this.en[a++],u))return!1}return!0}an(){if(this.nn)return null;let e=new at(xt.comparator);const n=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new kh(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new kh(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new kh(r.field,r.dir==="asc"?0:1)));return new gf(gf.UNKNOWN_ID,this.collectionId,n,Ru.empty())}sn(e){for(const n of this.tn)if(this.on(n,e))return!0;return!1}on(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}_n(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rS(t){var e,n;if(be(t instanceof $e||t instanceof rt),t instanceof $e){if(t instanceof Ik){const i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(o=>$e.create(t.field,"==",o)))||[];return rt.create(i,"or")}return t}const r=t.filters.map(i=>rS(i));return rt.create(r,t.op)}function CD(t){if(t.getFilters().length===0)return[];const e=ty(rS(t));return be(iS(e)),Xg(e)||ey(e)?[e]:e.getFilters()}function Xg(t){return t instanceof $e}function ey(t){return t instanceof rt&&A_(t)}function iS(t){return Xg(t)||ey(t)||function(n){if(n instanceof rt&&Hg(n)){for(const r of n.getFilters())if(!Xg(r)&&!ey(r))return!1;return!0}return!1}(t)}function ty(t){if(be(t instanceof $e||t instanceof rt),t instanceof $e)return t;if(t.filters.length===1)return ty(t.filters[0]);const e=t.filters.map(r=>ty(r));let n=rt.create(e,t.op);return n=If(n),iS(n)?n:(be(n instanceof rt),be(Ll(n)),be(n.filters.length>1),n.filters.reduce((r,i)=>F_(r,i)))}function F_(t,e){let n;return be(t instanceof $e||t instanceof rt),be(e instanceof $e||e instanceof rt),n=t instanceof $e?e instanceof $e?function(i,o){return rt.create([i,o],"and")}(t,e):jw(t,e):e instanceof $e?jw(e,t):function(i,o){if(be(i.filters.length>0&&o.filters.length>0),Ll(i)&&Ll(o))return xk(i,o.getFilters());const a=Hg(i)?i:o,u=Hg(i)?o:i,h=a.filters.map(m=>F_(m,u));return rt.create(h,"or")}(t,e),If(n)}function jw(t,e){if(Ll(e))return xk(e,t.getFilters());{const n=e.filters.map(r=>F_(t,r));return rt.create(n,"or")}}function If(t){if(be(t instanceof $e||t instanceof rt),t instanceof $e)return t;const e=t.getFilters();if(e.length===1)return If(e[0]);if(_k(t))return t;const n=e.map(i=>If(i)),r=[];return n.forEach(i=>{i instanceof $e?r.push(i):i instanceof rt&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:rt.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RD{constructor(){this.un=new U_}addToCollectionParentIndex(e,n){return this.un.add(n),H.resolve()}getCollectionParents(e,n){return H.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return H.resolve()}deleteFieldIndex(e,n){return H.resolve()}deleteAllFieldIndexes(e){return H.resolve()}createTargetIndexes(e,n){return H.resolve()}getDocumentsMatchingTarget(e,n){return H.resolve(null)}getIndexType(e,n){return H.resolve(0)}getFieldIndexes(e,n){return H.resolve([])}getNextCollectionGroupToUpdate(e){return H.resolve(null)}getMinOffset(e,n){return H.resolve(ar.min())}getMinOffsetFromCollectionGroup(e,n){return H.resolve(ar.min())}updateCollectionGroup(e,n,r){return H.resolve()}updateIndexEntries(e,n){return H.resolve()}}class U_{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new at(tt.comparator),o=!i.has(r);return this.index[n]=i.add(r),o}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new at(tt.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xd=new Uint8Array(0);class jD{constructor(e,n){this.databaseId=n,this.cn=new U_,this.ln=new ho(r=>Jo(r),(r,i)=>td(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.cn.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.cn.add(n)});const o={collectionId:r,parent:Sn(i)};return Lw(e).put(o)}return H.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[tk(n),""],!1,!0);return Lw(e).U(i).next(o=>{for(const a of o){if(a.collectionId!==n)break;r.push(hi(a.parent))}return r})}addFieldIndex(e,n){const r=Cc(e),i=function(u){return{indexId:u.indexId,collectionGroup:u.collectionGroup,fields:u.fields.map(h=>[h.fieldPath.canonicalString(),h.kind])}}(n);delete i.indexId;const o=r.add(i);if(n.indexState){const a=$a(e);return o.next(u=>{a.put(Sw(u,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return o.next()}deleteFieldIndex(e,n){const r=Cc(e),i=$a(e),o=qa(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>o.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=Cc(e),r=qa(e),i=$a(e);return n.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,n){return H.forEach(this.hn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const o=new Rw(r).an();if(o!=null)return this.addFieldIndex(e,o)}}))}getDocumentsMatchingTarget(e,n){const r=qa(e);let i=!0;const o=new Map;return H.forEach(this.hn(n),a=>this.Pn(e,a).next(u=>{i&&(i=!!u),o.set(a,u)})).next(()=>{if(i){let a=Oe();const u=[];return H.forEach(o,(h,m)=>{te("IndexedDbIndexManager",`Using index ${function(A){return`id=${A.indexId}|cg=${A.collectionGroup}|f=${A.fields.map(z=>`${z.fieldPath}:${z.kind}`).join(",")}`}(h)} to execute ${Jo(n)}`);const y=function(A,z){const G=Bg(z);if(G===void 0)return null;for(const W of _f(A,G.fieldPath))switch(W.op){case"array-contains-any":return W.value.arrayValue.values||[];case"array-contains":return[W.value]}return null}(m,h),v=function(A,z){const G=new Map;for(const W of ko(z))for(const T of _f(A,W.fieldPath))switch(T.op){case"==":case"in":G.set(W.fieldPath.canonicalString(),T.value);break;case"not-in":case"!=":return G.set(W.fieldPath.canonicalString(),T.value),Array.from(G.values())}return null}(m,h),w=function(A,z){const G=[];let W=!0;for(const T of ko(z)){const b=T.kind===0?hw(A,T.fieldPath,A.startAt):fw(A,T.fieldPath,A.startAt);G.push(b.value),W&&(W=b.inclusive)}return new jl(G,W)}(m,h),S=function(A,z){const G=[];let W=!0;for(const T of ko(z)){const b=T.kind===0?fw(A,T.fieldPath,A.endAt):hw(A,T.fieldPath,A.endAt);G.push(b.value),W&&(W=b.inclusive)}return new jl(G,W)}(m,h),N=this.In(h,m,w),P=this.In(h,m,S),F=this.Tn(h,m,v),R=this.En(h.indexId,y,N,w.inclusive,P,S.inclusive,F);return H.forEach(R,k=>r.G(k,n.limit).next(A=>{A.forEach(z=>{const G=he.fromSegments(z.documentKey);a.has(G)||(a=a.add(G),u.push(G))})}))}).next(()=>u)}return H.resolve(null)})}hn(e){let n=this.ln.get(e);return n||(e.filters.length===0?n=[e]:n=CD(rt.create(e.filters,"and")).map(r=>Gg(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,n),n)}En(e,n,r,i,o,a,u){const h=(n!=null?n.length:1)*Math.max(r.length,o.length),m=h/(n!=null?n.length:1),y=[];for(let v=0;v<h;++v){const w=n?this.dn(n[v/m]):Xd,S=this.An(e,w,r[v%m],i),N=this.Rn(e,w,o[v%m],a),P=u.map(F=>this.An(e,w,F,!0));y.push(...this.createRange(S,N,P))}return y}An(e,n,r,i){const o=new Co(e,he.empty(),n,r);return i?o:o.Zt()}Rn(e,n,r,i){const o=new Co(e,he.empty(),n,r);return i?o.Zt():o}Pn(e,n){const r=new Rw(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(o=>{let a=null;for(const u of o)r.rn(u)&&(!a||u.fields.length>a.fields.length)&&(a=u);return a})}getIndexType(e,n){let r=2;const i=this.hn(n);return H.forEach(i,o=>this.Pn(e,o).next(a=>{a?r!==0&&a.fields.length<function(h){let m=new at(xt.comparator),y=!1;for(const v of h.filters)for(const w of v.getFlattenedFilters())w.field.isKeyField()||(w.op==="array-contains"||w.op==="array-contains-any"?y=!0:m=m.add(w.field));for(const v of h.orderBy)v.field.isKeyField()||(m=m.add(v.field));return m.size+(y?1:0)}(o)&&(r=1):r=0})).next(()=>function(a){return a.limit!==null}(n)&&i.length>1&&r===2?1:r)}Vn(e,n){const r=new Ac;for(const i of ko(e)){const o=n.data.field(i.fieldPath);if(o==null)return null;const a=r.Yt(i.kind);Ao.vt.It(o,a)}return r.zt()}dn(e){const n=new Ac;return Ao.vt.It(e,n.Yt(0)),n.zt()}mn(e,n){const r=new Ac;return Ao.vt.It(Mu(this.databaseId,n),r.Yt(function(o){const a=ko(o);return a.length===0?0:a[a.length-1].kind}(e))),r.zt()}Tn(e,n,r){if(r===null)return[];let i=[];i.push(new Ac);let o=0;for(const a of ko(e)){const u=r[o++];for(const h of i)if(this.fn(n,a.fieldPath)&&Ou(u))i=this.gn(i,a,u);else{const m=h.Yt(a.kind);Ao.vt.It(u,m)}}return this.pn(i)}In(e,n,r){return this.Tn(e,n,r.position)}pn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].zt();return n}gn(e,n,r){const i=[...e],o=[];for(const a of r.arrayValue.values||[])for(const u of i){const h=new Ac;h.seed(u.zt()),Ao.vt.It(a,h.Yt(n.kind)),o.push(h)}return o}fn(e,n){return!!e.filters.find(r=>r instanceof $e&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=Cc(e),i=$a(e);return(n?r.U("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.U()).next(o=>{const a=[];return H.forEach(o,u=>i.get([u.indexId,this.uid]).next(h=>{a.push(function(y,v){const w=v?new Ru(v.sequenceNumber,new ar(ta(v.readTime),new he(hi(v.documentKey)),v.largestBatchId)):Ru.empty(),S=y.fields.map(([N,P])=>new kh(xt.fromServerFormat(N),P));return new gf(y.indexId,y.collectionGroup,S,w)}(u,h))})).next(()=>a)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const o=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return o!==0?o:Le(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=Cc(e),o=$a(e);return this.yn(e).next(a=>i.U("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(u=>H.forEach(u,h=>o.put(Sw(h.indexId,this.uid,a,r)))))}updateIndexEntries(e,n){const r=new Map;return H.forEach(n,(i,o)=>{const a=r.get(i.collectionGroup);return(a?H.resolve(a):this.getFieldIndexes(e,i.collectionGroup)).next(u=>(r.set(i.collectionGroup,u),H.forEach(u,h=>this.wn(e,i,h).next(m=>{const y=this.Sn(o,h);return m.isEqual(y)?H.resolve():this.bn(e,o,h,m,y)}))))})}Dn(e,n,r,i){return qa(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(r,n.key),documentKey:n.key.path.toArray()})}vn(e,n,r,i){return qa(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(r,n.key),n.key.path.toArray()])}wn(e,n,r){const i=qa(e);let o=new at(Ss);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,n)])},(a,u)=>{o=o.add(new Co(r.indexId,n,u.arrayValue,u.directionalValue))}).next(()=>o)}Sn(e,n){let r=new at(Ss);const i=this.Vn(n,e);if(i==null)return r;const o=Bg(n);if(o!=null){const a=e.data.field(o.fieldPath);if(Ou(a))for(const u of a.arrayValue.values||[])r=r.add(new Co(n.indexId,e.key,this.dn(u),i))}else r=r.add(new Co(n.indexId,e.key,Xd,i));return r}bn(e,n,r,i,o){te("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const a=[];return function(h,m,y,v,w){const S=h.getIterator(),N=m.getIterator();let P=za(S),F=za(N);for(;P||F;){let R=!1,k=!1;if(P&&F){const A=y(P,F);A<0?k=!0:A>0&&(R=!0)}else P!=null?k=!0:R=!0;R?(v(F),F=za(N)):k?(w(P),P=za(S)):(P=za(S),F=za(N))}}(i,o,Ss,u=>{a.push(this.Dn(e,n,r,u))},u=>{a.push(this.vn(e,n,r,u))}),H.waitFor(a)}yn(e){let n=1;return $a(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,o)=>{o.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((a,u)=>Ss(a,u)).filter((a,u,h)=>!u||Ss(a,h[u-1])!==0);const i=[];i.push(e);for(const a of r){const u=Ss(a,e),h=Ss(a,n);if(u===0)i[0]=e.Zt();else if(u>0&&h<0)i.push(a),i.push(a.Zt());else if(h>0)break}i.push(n);const o=[];for(let a=0;a<i.length;a+=2){if(this.Cn(i[a],i[a+1]))return[];const u=[i[a].indexId,this.uid,i[a].arrayValue,i[a].directionalValue,Xd,[]],h=[i[a+1].indexId,this.uid,i[a+1].arrayValue,i[a+1].directionalValue,Xd,[]];o.push(IDBKeyRange.bound(u,h))}return o}Cn(e,n){return Ss(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(Dw)}getMinOffset(e,n){return H.mapArray(this.hn(n),r=>this.Pn(e,r).next(i=>i||ve())).next(Dw)}}function Lw(t){return Gt(t,"collectionParents")}function qa(t){return Gt(t,"indexEntries")}function Cc(t){return Gt(t,"indexConfiguration")}function $a(t){return Gt(t,"indexState")}function Dw(t){be(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;E_(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new ar(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Mn{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Mn(e,Mn.DEFAULT_COLLECTION_PERCENTILE,Mn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sS(t,e,n){const r=t.store("mutations"),i=t.store("documentMutations"),o=[],a=IDBKeyRange.only(n.batchId);let u=0;const h=r.J({range:a},(y,v,w)=>(u++,w.delete()));o.push(h.next(()=>{be(u===1)}));const m=[];for(const y of n.mutations){const v=lk(e,y.key.path,n.batchId);o.push(i.delete(v)),m.push(y.key)}return H.waitFor(o).next(()=>m)}function Tf(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw ve();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Mn.DEFAULT_COLLECTION_PERCENTILE=10,Mn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Mn.DEFAULT=new Mn(41943040,Mn.DEFAULT_COLLECTION_PERCENTILE,Mn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Mn.DISABLED=new Mn(-1,0,0);class um{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Fn={}}static lt(e,n,r,i){be(e.uid!=="");const o=e.isAuthenticated()?e.uid:"";return new um(o,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ps(e).J({index:"userMutationsIndex",range:r},(i,o,a)=>{n=!1,a.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const o=Qa(e),a=Ps(e);return a.add({}).next(u=>{be(typeof u=="number");const h=new L_(u,n,r,i),m=function(S,N,P){const F=P.baseMutations.map(k=>wf(S.ct,k)),R=P.mutations.map(k=>wf(S.ct,k));return{userId:N,batchId:P.batchId,localWriteTimeMs:P.localWriteTime.toMillis(),baseMutations:F,mutations:R}}(this.serializer,this.userId,h),y=[];let v=new at((w,S)=>Le(w.canonicalString(),S.canonicalString()));for(const w of i){const S=lk(this.userId,w.key.path,u);v=v.add(w.key.path.popLast()),y.push(a.put(m)),y.push(o.put(S,yL))}return v.forEach(w=>{y.push(this.indexManager.addToCollectionParentIndex(e,w))}),e.addOnCommittedListener(()=>{this.Fn[u]=h.keys()}),H.waitFor(y).next(()=>h)})}lookupMutationBatch(e,n){return Ps(e).get(n).next(r=>r?(be(r.userId===this.userId),No(this.serializer,r)):null)}Mn(e,n){return this.Fn[n]?H.resolve(this.Fn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Fn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let o=null;return Ps(e).J({index:"userMutationsIndex",range:i},(a,u,h)=>{u.userId===this.userId&&(be(u.batchId>=r),o=No(this.serializer,u)),h.done()}).next(()=>o)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Ps(e).J({index:"userMutationsIndex",range:n,reverse:!0},(i,o,a)=>{r=o.batchId,a.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ps(e).U("userMutationsIndex",n).next(r=>r.map(i=>No(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Sh(this.userId,n.path),i=IDBKeyRange.lowerBound(r),o=[];return Qa(e).J({range:i},(a,u,h)=>{const[m,y,v]=a,w=hi(y);if(m===this.userId&&n.path.isEqual(w))return Ps(e).get(v).next(S=>{if(!S)throw ve();be(S.userId===this.userId),o.push(No(this.serializer,S))});h.done()}).next(()=>o)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new at(Le);const i=[];return n.forEach(o=>{const a=Sh(this.userId,o.path),u=IDBKeyRange.lowerBound(a),h=Qa(e).J({range:u},(m,y,v)=>{const[w,S,N]=m,P=hi(S);w===this.userId&&o.path.isEqual(P)?r=r.add(N):v.done()});i.push(h)}),H.waitFor(i).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,o=Sh(this.userId,r),a=IDBKeyRange.lowerBound(o);let u=new at(Le);return Qa(e).J({range:a},(h,m,y)=>{const[v,w,S]=h,N=hi(w);v===this.userId&&r.isPrefixOf(N)?N.length===i&&(u=u.add(S)):y.done()}).next(()=>this.xn(e,u))}xn(e,n){const r=[],i=[];return n.forEach(o=>{i.push(Ps(e).get(o).next(a=>{if(a===null)throw ve();be(a.userId===this.userId),r.push(No(this.serializer,a))}))}),H.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return sS(e._e,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.On(n.batchId)}),H.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return H.resolve();const r=IDBKeyRange.lowerBound(function(a){return[a]}(this.userId)),i=[];return Qa(e).J({range:r},(o,a,u)=>{if(o[0]===this.userId){const h=hi(o[1]);i.push(h)}else u.done()}).next(()=>{be(i.length===0)})})}containsKey(e,n){return oS(e,this.userId,n)}Nn(e){return aS(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function oS(t,e,n){const r=Sh(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r);let a=!1;return Qa(t).J({range:o,H:!0},(u,h,m)=>{const[y,v,w]=u;y===e&&v===i&&(a=!0),m.done()}).next(()=>a)}function Ps(t){return Gt(t,"mutations")}function Qa(t){return Gt(t,"documentMutations")}function aS(t){return Gt(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class na{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new na(0)}static kn(){return new na(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LD{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.qn(e).next(n=>{const r=new na(n.highestTargetId);return n.highestTargetId=r.next(),this.Qn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(n=>Te.fromTimestamp(new Ze(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.qn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.Qn(e,i)))}addTargetData(e,n){return this.Kn(e,n).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(n,r),this.Qn(e,r))))}updateTargetData(e,n){return this.Kn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Ha(e).delete(n.targetId)).next(()=>this.qn(e)).next(r=>(be(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,n,r){let i=0;const o=[];return Ha(e).J((a,u)=>{const h=Wc(u);h.sequenceNumber<=n&&r.get(h.targetId)===null&&(i++,o.push(this.removeTargetData(e,h)))}).next(()=>H.waitFor(o)).next(()=>i)}forEachTarget(e,n){return Ha(e).J((r,i)=>{const o=Wc(i);n(o)})}qn(e){return Ow(e).get("targetGlobalKey").next(n=>(be(n!==null),n))}Qn(e,n){return Ow(e).put("targetGlobalKey",n)}Kn(e,n){return Ha(e).put(tS(this.serializer,n))}$n(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=Jo(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let o=null;return Ha(e).J({range:i,index:"queryTargetsIndex"},(a,u,h)=>{const m=Wc(u);td(n,m.target)&&(o=m,h.done())}).next(()=>o)}addMatchingKeys(e,n,r){const i=[],o=Ms(e);return n.forEach(a=>{const u=Sn(a.path);i.push(o.put({targetId:r,path:u})),i.push(this.referenceDelegate.addReference(e,r,a))}),H.waitFor(i)}removeMatchingKeys(e,n,r){const i=Ms(e);return H.forEach(n,o=>{const a=Sn(o.path);return H.waitFor([i.delete([r,a]),this.referenceDelegate.removeReference(e,r,o)])})}removeMatchingKeysForTargetId(e,n){const r=Ms(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Ms(e);let o=Oe();return i.J({range:r,H:!0},(a,u,h)=>{const m=hi(a[1]),y=new he(m);o=o.add(y)}).next(()=>o)}containsKey(e,n){const r=Sn(n.path),i=IDBKeyRange.bound([r],[tk(r)],!1,!0);let o=0;return Ms(e).J({index:"documentTargetsIndex",H:!0,range:i},([a,u],h,m)=>{a!==0&&(o++,m.done())}).next(()=>o>0)}ot(e,n){return Ha(e).get(n).next(r=>r?Wc(r):null)}}function Ha(t){return Gt(t,"targets")}function Ow(t){return Gt(t,"targetGlobal")}function Ms(t){return Gt(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vw([t,e],[n,r]){const i=Le(t,n);return i===0?Le(e,r):i}class DD{constructor(e){this.Un=e,this.buffer=new at(Vw),this.Wn=0}Gn(){return++this.Wn}zn(e){const n=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Vw(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class MD{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){te("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){uo(n)?te("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await co(n)}await this.Hn(3e5)})}}class OD{constructor(e,n){this.Jn=e,this.params=n}calculateTargetCount(e,n){return this.Jn.Yn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return H.resolve(Bn.oe);const r=new DD(n);return this.Jn.forEachTarget(e,i=>r.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>r.zn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(te("LruGarbageCollector","Garbage collection skipped; disabled"),H.resolve(Mw)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(te("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Mw):this.Xn(e,n))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,n){let r,i,o,a,u,h,m;const y=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(v=>(v>this.params.maximumSequenceNumbersToCollect?(te("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),i=this.params.maximumSequenceNumbersToCollect):i=v,a=Date.now(),this.nthSequenceNumber(e,i))).next(v=>(r=v,u=Date.now(),this.removeTargets(e,r,n))).next(v=>(o=v,h=Date.now(),this.removeOrphanedDocuments(e,r))).next(v=>(m=Date.now(),Wa()<=qe.DEBUG&&te("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-y}ms
	Determined least recently used ${i} in `+(u-a)+`ms
	Removed ${o} targets in `+(h-u)+`ms
	Removed ${v} documents in `+(m-h)+`ms
Total Duration: ${m-y}ms`),H.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:v})))}}function VD(t,e){return new OD(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FD{constructor(e,n){this.db=e,this.garbageCollector=VD(this,n)}Yn(e){const n=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}er(e){let n=0;return this.Zn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Zn(e,n){return this.tr(e,(r,i)=>n(i))}addReference(e,n,r){return eh(e,r)}removeReference(e,n,r){return eh(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return eh(e,n)}nr(e,n){return function(i,o){let a=!1;return aS(i).Y(u=>oS(i,u,o).next(h=>(h&&(a=!0),H.resolve(!h)))).next(()=>a)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let o=0;return this.tr(e,(a,u)=>{if(u<=n){const h=this.nr(e,a).next(m=>{if(!m)return o++,r.getEntry(e,a).next(()=>(r.removeEntry(a,Te.min()),Ms(e).delete(function(v){return[0,Sn(v.path)]}(a))))});i.push(h)}}).next(()=>H.waitFor(i)).next(()=>r.apply(e)).next(()=>o)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return eh(e,n)}tr(e,n){const r=Ms(e);let i,o=Bn.oe;return r.J({index:"documentTargetsIndex"},([a,u],{path:h,sequenceNumber:m})=>{a===0?(o!==Bn.oe&&n(new he(hi(i)),o),o=m,i=h):o=Bn.oe}).next(()=>{o!==Bn.oe&&n(new he(hi(i)),o)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function eh(t,e){return Ms(t).put(function(r,i){return{targetId:0,path:Sn(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lS{constructor(){this.changes=new ho(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Ct.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?H.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UD{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return bo(e).put(r)}removeEntry(e,n,r){return bo(e).delete(function(o,a){const u=o.path.toArray();return[u.slice(0,u.length-2),u[u.length-2],bf(a),u[u.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.rr(e,r)))}getEntry(e,n){let r=Ct.newInvalidDocument(n);return bo(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Rc(n))},(i,o)=>{r=this.ir(n,o)}).next(()=>r)}sr(e,n){let r={size:0,document:Ct.newInvalidDocument(n)};return bo(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Rc(n))},(i,o)=>{r={document:this.ir(n,o),size:Tf(o)}}).next(()=>r)}getEntries(e,n){let r=tr();return this._r(e,n,(i,o)=>{const a=this.ir(i,o);r=r.insert(i,a)}).next(()=>r)}ar(e,n){let r=tr(),i=new ht(he.comparator);return this._r(e,n,(o,a)=>{const u=this.ir(o,a);r=r.insert(o,u),i=i.insert(o,Tf(a))}).next(()=>({documents:r,ur:i}))}_r(e,n,r){if(n.isEmpty())return H.resolve();let i=new at(Bw);n.forEach(h=>i=i.add(h));const o=IDBKeyRange.bound(Rc(i.first()),Rc(i.last())),a=i.getIterator();let u=a.getNext();return bo(e).J({index:"documentKeyIndex",range:o},(h,m,y)=>{const v=he.fromSegments([...m.prefixPath,m.collectionGroup,m.documentId]);for(;u&&Bw(u,v)<0;)r(u,null),u=a.getNext();u&&u.isEqual(v)&&(r(u,m),u=a.hasNext()?a.getNext():null),u?y.$(Rc(u)):y.done()}).next(()=>{for(;u;)r(u,null),u=a.hasNext()?a.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,o){const a=n.path,u=[a.popLast().toArray(),a.lastSegment(),bf(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],h=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return bo(e).U(IDBKeyRange.bound(u,h,!0)).next(m=>{o==null||o.incrementDocumentReadCount(m.length);let y=tr();for(const v of m){const w=this.ir(he.fromSegments(v.prefixPath.concat(v.collectionGroup,v.documentId)),v);w.isFoundDocument()&&(rd(n,w)||i.has(w.key))&&(y=y.insert(w.key,w))}return y})}getAllFromCollectionGroup(e,n,r,i){let o=tr();const a=Uw(n,r),u=Uw(n,ar.max());return bo(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(a,u,!0)},(h,m,y)=>{const v=this.ir(he.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);o=o.insert(v.key,v),o.size===i&&y.done()}).next(()=>o)}newChangeBuffer(e){return new BD(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return Fw(e).get("remoteDocumentGlobalKey").next(n=>(be(!!n),n))}rr(e,n){return Fw(e).put("remoteDocumentGlobalKey",n)}ir(e,n){if(n){const r=TD(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(Te.min())))return r}return Ct.newInvalidDocument(e)}}function cS(t){return new UD(t)}class BD extends lS{constructor(e,n){super(),this.cr=e,this.trackRemovals=n,this.lr=new ho(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new at((o,a)=>Le(o.canonicalString(),a.canonicalString()));return this.changes.forEach((o,a)=>{const u=this.lr.get(o);if(n.push(this.cr.removeEntry(e,o,u.readTime)),a.isValidDocument()){const h=Ew(this.cr.serializer,a);i=i.add(o.path.popLast());const m=Tf(h);r+=m-u.size,n.push(this.cr.addEntry(e,o,h))}else if(r-=u.size,this.trackRemovals){const h=Ew(this.cr.serializer,a.convertToNoDocument(Te.min()));n.push(this.cr.addEntry(e,o,h))}}),i.forEach(o=>{n.push(this.cr.indexManager.addToCollectionParentIndex(e,o))}),n.push(this.cr.updateMetadata(e,r)),H.waitFor(n)}getFromCache(e,n){return this.cr.sr(e,n).next(r=>(this.lr.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.cr.ar(e,n).next(({documents:r,ur:i})=>(i.forEach((o,a)=>{this.lr.set(o,{size:a,readTime:r.get(o).readTime})}),r))}}function Fw(t){return Gt(t,"remoteDocumentGlobal")}function bo(t){return Gt(t,"remoteDocumentsV14")}function Rc(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Uw(t,e){const n=e.documentKey.path.toArray();return[t,bf(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function Bw(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let o=0;o<n.length-2&&o<r.length-2;++o)if(i=Le(n[o],r[o]),i)return i;return i=Le(n.length,r.length),i||(i=Le(n[n.length-2],r[r.length-2]),i||Le(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zD{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uS{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&au(r.mutation,i,zn.empty(),Ze.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Oe()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Oe()){const i=fi();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(o=>{let a=$c();return o.forEach((u,h)=>{a=a.insert(u,h.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const r=fi();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Oe()))}populateOverlays(e,n,r){const i=[];return r.forEach(o=>{n.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((a,u)=>{n.set(a,u)})})}computeViews(e,n,r,i){let o=tr();const a=ou(),u=function(){return ou()}();return n.forEach((h,m)=>{const y=r.get(m.key);i.has(m.key)&&(y===void 0||y.mutation instanceof as)?o=o.insert(m.key,m):y!==void 0?(a.set(m.key,y.mutation.getFieldMask()),au(y.mutation,m,y.mutation.getFieldMask(),Ze.now())):a.set(m.key,zn.empty())}),this.recalculateAndSaveOverlays(e,o).next(h=>(h.forEach((m,y)=>a.set(m,y)),n.forEach((m,y)=>{var v;return u.set(m,new zD(y,(v=a.get(m))!==null&&v!==void 0?v:null))}),u))}recalculateAndSaveOverlays(e,n){const r=ou();let i=new ht((a,u)=>a-u),o=Oe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const u of a)u.keys().forEach(h=>{const m=n.get(h);if(m===null)return;let y=r.get(h)||zn.empty();y=u.applyToLocalView(m,y),r.set(h,y);const v=(i.get(u.batchId)||Oe()).add(h);i=i.insert(u.batchId,v)})}).next(()=>{const a=[],u=i.getReverseIterator();for(;u.hasNext();){const h=u.getNext(),m=h.key,y=h.value,v=Ck();y.forEach(w=>{if(!o.has(w)){const S=Ok(n.get(w),r.get(w));S!==null&&v.set(w,S),o=o.add(w)}}),a.push(this.documentOverlayCache.saveOverlays(e,m,v))}return H.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(a){return he.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Ek(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(o=>{const a=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-o.size):H.resolve(fi());let u=-1,h=o;return a.next(m=>H.forEach(m,(y,v)=>(u<v.largestBatchId&&(u=v.largestBatchId),o.get(y)?H.resolve():this.remoteDocumentCache.getEntry(e,y).next(w=>{h=h.insert(y,w)}))).next(()=>this.populateOverlays(e,m,o)).next(()=>this.computeViews(e,h,m,Oe())).next(y=>({batchId:u,changes:Ak(y)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new he(n)).next(r=>{let i=$c();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const o=n.collectionGroup;let a=$c();return this.indexManager.getCollectionParents(e,o).next(u=>H.forEach(u,h=>{const m=function(v,w){return new Ql(w,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)}(n,h.child(o));return this.getDocumentsMatchingCollectionQuery(e,m,r,i).next(y=>{y.forEach((v,w)=>{a=a.insert(v,w)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,o,i))).next(a=>{o.forEach((h,m)=>{const y=m.getKey();a.get(y)===null&&(a=a.insert(y,Ct.newInvalidDocument(y)))});let u=$c();return a.forEach((h,m)=>{const y=o.get(h);y!==void 0&&au(y.mutation,m,zn.empty(),Ze.now()),rd(n,m)&&(u=u.insert(h,m))}),u})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qD{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return H.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Pn(i.createTime)}}(n)),H.resolve()}getNamedQuery(e,n){return H.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(i){return{name:i.name,query:nS(i.bundledQuery),readTime:Pn(i.readTime)}}(n)),H.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $D{constructor(){this.overlays=new ht(he.comparator),this.Ir=new Map}getOverlay(e,n){return H.resolve(this.overlays.get(n))}getOverlays(e,n){const r=fi();return H.forEach(n,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,o)=>{this.ht(e,n,o)}),H.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.Ir.delete(r)),H.resolve()}getOverlaysForCollection(e,n,r){const i=fi(),o=n.length+1,a=new he(n.child("")),u=this.overlays.getIteratorFrom(a);for(;u.hasNext();){const h=u.getNext().value,m=h.getKey();if(!n.isPrefixOf(m.path))break;m.path.length===o&&h.largestBatchId>r&&i.set(h.getKey(),h)}return H.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let o=new ht((m,y)=>m-y);const a=this.overlays.getIterator();for(;a.hasNext();){const m=a.getNext().value;if(m.getKey().getCollectionGroup()===n&&m.largestBatchId>r){let y=o.get(m.largestBatchId);y===null&&(y=fi(),o=o.insert(m.largestBatchId,y)),y.set(m.getKey(),m)}}const u=fi(),h=o.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((m,y)=>u.set(m,y)),!(u.size()>=i)););return H.resolve(u)}ht(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const a=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new M_(n,r));let o=this.Ir.get(n);o===void 0&&(o=Oe(),this.Ir.set(n,o)),this.Ir.set(n,o.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HD{constructor(){this.sessionToken=Rt.EMPTY_BYTE_STRING}getSessionToken(e){return H.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,H.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B_{constructor(){this.Tr=new at(Yt.Er),this.dr=new at(Yt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new Yt(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new Yt(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new he(new tt([])),r=new Yt(n,e),i=new Yt(n,e+1),o=[];return this.dr.forEachInRange([r,i],a=>{this.Vr(a),o.push(a.key)}),o}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new he(new tt([])),r=new Yt(n,e),i=new Yt(n,e+1);let o=Oe();return this.dr.forEachInRange([r,i],a=>{o=o.add(a.key)}),o}containsKey(e){const n=new Yt(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Yt{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return he.comparator(e.key,n.key)||Le(e.wr,n.wr)}static Ar(e,n){return Le(e.wr,n.wr)||he.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WD{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new at(Yt.Er)}checkEmpty(e){return H.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const o=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new L_(o,n,r,i);this.mutationQueue.push(a);for(const u of i)this.br=this.br.add(new Yt(u.key,o)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return H.resolve(a)}lookupMutationBatch(e,n){return H.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.vr(r),o=i<0?0:i;return H.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return H.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return H.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Yt(n,0),i=new Yt(n,Number.POSITIVE_INFINITY),o=[];return this.br.forEachInRange([r,i],a=>{const u=this.Dr(a.wr);o.push(u)}),H.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new at(Le);return n.forEach(i=>{const o=new Yt(i,0),a=new Yt(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([o,a],u=>{r=r.add(u.wr)})}),H.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let o=r;he.isDocumentKey(o)||(o=o.child(""));const a=new Yt(new he(o),0);let u=new at(Le);return this.br.forEachWhile(h=>{const m=h.key.path;return!!r.isPrefixOf(m)&&(m.length===i&&(u=u.add(h.wr)),!0)},a),H.resolve(this.Cr(u))}Cr(e){const n=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){be(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return H.forEach(n.mutations,i=>{const o=new Yt(i.key,n.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new Yt(n,0),i=this.br.firstAfterOrEqual(r);return H.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,H.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GD{constructor(e){this.Mr=e,this.docs=function(){return new ht(he.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),o=i?i.size:0,a=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return H.resolve(r?r.document.mutableCopy():Ct.newInvalidDocument(n))}getEntries(e,n){let r=tr();return n.forEach(i=>{const o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():Ct.newInvalidDocument(i))}),H.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let o=tr();const a=n.path,u=new he(a.child("")),h=this.docs.getIteratorFrom(u);for(;h.hasNext();){const{key:m,value:{document:y}}=h.getNext();if(!a.isPrefixOf(m.path))break;m.path.length>a.length+1||E_(rk(y),r)<=0||(i.has(y.key)||rd(n,y))&&(o=o.insert(y.key,y.mutableCopy()))}return H.resolve(o)}getAllFromCollectionGroup(e,n,r,i){ve()}Or(e,n){return H.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new KD(this)}getSize(e){return H.resolve(this.size)}}class KD extends lS{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),H.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZD{constructor(e){this.persistence=e,this.Nr=new ho(n=>Jo(n),td),this.lastRemoteSnapshotVersion=Te.min(),this.highestTargetId=0,this.Lr=0,this.Br=new B_,this.targetCount=0,this.kr=na.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,i)=>n(i)),H.resolve()}getLastRemoteSnapshotVersion(e){return H.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return H.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),H.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),H.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new na(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,H.resolve()}updateTargetData(e,n){return this.Kn(n),H.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,H.resolve()}removeTargets(e,n,r){let i=0;const o=[];return this.Nr.forEach((a,u)=>{u.sequenceNumber<=n&&r.get(u.targetId)===null&&(this.Nr.delete(a),o.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),H.waitFor(o).next(()=>i)}getTargetCount(e){return H.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return H.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),H.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const i=this.persistence.referenceDelegate,o=[];return i&&n.forEach(a=>{o.push(i.markPotentiallyOrphaned(e,a))}),H.waitFor(o)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),H.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return H.resolve(r)}containsKey(e,n){return H.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dS{constructor(e,n){this.qr={},this.overlays={},this.Qr=new Bn(0),this.Kr=!1,this.Kr=!0,this.$r=new HD,this.referenceDelegate=e(this),this.Ur=new ZD(this),this.indexManager=new RD,this.remoteDocumentCache=function(i){return new GD(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new eS(n),this.Gr=new qD(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new $D,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new WD(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){te("MemoryPersistence","Starting transaction:",e);const i=new QD(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(o=>this.referenceDelegate.jr(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Hr(e,n){return H.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class QD extends sk{constructor(e){super(),this.currentSequenceNumber=e}}class dm{constructor(e){this.persistence=e,this.Jr=new B_,this.Yr=null}static Zr(e){return new dm(e)}get Xr(){if(this.Yr)return this.Yr;throw ve()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),H.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),H.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),H.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(o=>this.Xr.add(o.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return H.forEach(this.Xr,r=>{const i=he.fromPath(r);return this.ei(e,i).next(o=>{o||n.removeEntry(i,Te.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return H.or([()=>H.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YD{constructor(e){this.serializer=e}O(e,n,r,i){const o=new nm("createOrUpgrade",n);r<1&&i>=1&&(function(h){h.createObjectStore("owner")}(e),function(h){h.createObjectStore("mutationQueues",{keyPath:"userId"}),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",tw,{unique:!0}),h.createObjectStore("documentMutations")}(e),zw(e),function(h){h.createObjectStore("remoteDocuments")}(e));let a=H.resolve();return r<3&&i>=3&&(r!==0&&(function(h){h.deleteObjectStore("targetDocuments"),h.deleteObjectStore("targets"),h.deleteObjectStore("targetGlobal")}(e),zw(e)),a=a.next(()=>function(h){const m=h.store("targetGlobal"),y={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Te.min().toTimestamp(),targetCount:0};return m.put("targetGlobalKey",y)}(o))),r<4&&i>=4&&(r!==0&&(a=a.next(()=>function(h,m){return m.store("mutations").U().next(y=>{h.deleteObjectStore("mutations"),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",tw,{unique:!0});const v=m.store("mutations"),w=y.map(S=>v.put(S));return H.waitFor(w)})}(e,o))),a=a.next(()=>{(function(h){h.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(a=a.next(()=>this.ni(o))),r<6&&i>=6&&(a=a.next(()=>(function(h){h.createObjectStore("remoteDocumentGlobal")}(e),this.ri(o)))),r<7&&i>=7&&(a=a.next(()=>this.ii(o))),r<8&&i>=8&&(a=a.next(()=>this.si(e,o))),r<9&&i>=9&&(a=a.next(()=>{(function(h){h.objectStoreNames.contains("remoteDocumentChanges")&&h.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(a=a.next(()=>this.oi(o))),r<11&&i>=11&&(a=a.next(()=>{(function(h){h.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(h){h.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(a=a.next(()=>{(function(h){const m=h.createObjectStore("documentOverlays",{keyPath:NL});m.createIndex("collectionPathOverlayIndex",AL,{unique:!1}),m.createIndex("collectionGroupOverlayIndex",CL,{unique:!1})})(e)})),r<13&&i>=13&&(a=a.next(()=>function(h){const m=h.createObjectStore("remoteDocumentsV14",{keyPath:_L});m.createIndex("documentKeyIndex",vL),m.createIndex("collectionGroupIndex",xL)}(e)).next(()=>this._i(e,o)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(a=a.next(()=>this.ai(e,o))),r<15&&i>=15&&(a=a.next(()=>function(h){h.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),h.createObjectStore("indexState",{keyPath:EL}).createIndex("sequenceNumberIndex",kL,{unique:!1}),h.createObjectStore("indexEntries",{keyPath:SL}).createIndex("documentKeyIndex",PL,{unique:!1})}(e))),r<16&&i>=16&&(a=a.next(()=>{n.objectStore("indexState").clear()}).next(()=>{n.objectStore("indexEntries").clear()})),r<17&&i>=17&&(a=a.next(()=>{(function(h){h.createObjectStore("globals",{keyPath:"name"})})(e)})),a}ri(e){let n=0;return e.store("remoteDocuments").J((r,i)=>{n+=Tf(i)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.U().next(i=>H.forEach(i,o=>{const a=IDBKeyRange.bound([o.userId,-1],[o.userId,o.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",a).next(u=>H.forEach(u,h=>{be(h.userId===o.userId);const m=No(this.serializer,h);return sS(e,o.userId,m).next(()=>{})}))}))}ii(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const o=[];return r.J((a,u)=>{const h=new tt(a),m=function(v){return[0,Sn(v)]}(h);o.push(n.get(m).next(y=>y?H.resolve():(v=>n.put({targetId:0,path:Sn(v),sequenceNumber:i.highestListenSequenceNumber}))(h)))}).next(()=>H.waitFor(o))})}si(e,n){e.createObjectStore("collectionParents",{keyPath:TL});const r=n.store("collectionParents"),i=new U_,o=a=>{if(i.add(a)){const u=a.lastSegment(),h=a.popLast();return r.put({collectionId:u,parent:Sn(h)})}};return n.store("remoteDocuments").J({H:!0},(a,u)=>{const h=new tt(a);return o(h.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([a,u,h],m)=>{const y=hi(u);return o(y.popLast())}))}oi(e){const n=e.store("targets");return n.J((r,i)=>{const o=Wc(i),a=tS(this.serializer,o);return n.put(a)})}_i(e,n){const r=n.store("remoteDocuments"),i=[];return r.J((o,a)=>{const u=n.store("remoteDocumentsV14"),h=function(v){return v.document?new he(tt.fromString(v.document.name).popFirst(5)):v.noDocument?he.fromSegments(v.noDocument.path):v.unknownDocument?he.fromSegments(v.unknownDocument.path):ve()}(a).path.toArray(),m={prefixPath:h.slice(0,h.length-2),collectionGroup:h[h.length-2],documentId:h[h.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};i.push(u.put(m))}).next(()=>H.waitFor(i))}ai(e,n){const r=n.store("mutations"),i=cS(this.serializer),o=new dS(dm.Zr,this.serializer.ct);return r.U().next(a=>{const u=new Map;return a.forEach(h=>{var m;let y=(m=u.get(h.userId))!==null&&m!==void 0?m:Oe();No(this.serializer,h).keys().forEach(v=>y=y.add(v)),u.set(h.userId,y)}),H.forEach(u,(h,m)=>{const y=new dn(m),v=cm.lt(this.serializer,y),w=o.getIndexManager(y),S=um.lt(y,this.serializer,w,o.referenceDelegate);return new uS(i,S,v,w).recalculateAndSaveOverlaysForDocumentKeys(new zg(n,Bn.oe),h).next()})})}}function zw(t){t.createObjectStore("targetDocuments",{keyPath:bL}).createIndex("documentTargetsIndex",IL,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",wL,{unique:!0}),t.createObjectStore("targetGlobal")}const Ep="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class z_{constructor(e,n,r,i,o,a,u,h,m,y,v=17){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.ui=o,this.window=a,this.document=u,this.ci=m,this.li=y,this.hi=v,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=w=>Promise.resolve(),!z_.D())throw new ae(J.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new FD(this,i),this.Ai=n+"main",this.serializer=new eS(h),this.Ri=new Js(this.Ai,this.hi,new YD(this.serializer)),this.$r=new kD,this.Ur=new LD(this.referenceDelegate,this.serializer),this.remoteDocumentCache=cS(this.serializer),this.Gr=new ED,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,y===!1&&Ot("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ae(J.FAILED_PRECONDITION,Ep);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new Bn(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>th(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(n=>{n||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(n=>this.isPrimary&&!n?this.bi(e).next(()=>!1):!!n&&this.Di(e).next(()=>!0))).catch(e=>{if(uo(e))return te("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return te("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return jc(e).get("owner").next(n=>H.resolve(this.vi(n)))}Ci(e){return th(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Gt(n,"clientMetadata");return r.U().next(i=>{const o=this.xi(i,18e5),a=i.filter(u=>o.indexOf(u)===-1);return H.forEach(a,u=>r.delete(u.clientId)).next(()=>a)})}).catch(()=>[]);if(this.Vi)for(const n of e)this.Vi.removeItem(this.Oi(n.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?H.resolve(!0):jc(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)){if(this.vi(n)&&this.networkEnabled)return!0;if(!this.vi(n)){if(!n.allowTabSynchronization)throw new ae(J.FAILED_PRECONDITION,Ep);return!1}}return!(!this.networkEnabled||!this.inForeground)||th(e).U().next(r=>this.xi(r,5e3).find(i=>{if(this.clientId!==i.clientId){const o=!this.networkEnabled&&i.networkEnabled,a=!this.inForeground&&i.inForeground,u=this.networkEnabled===i.networkEnabled;if(o||a&&u)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&te("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new zg(e,Bn.oe);return this.bi(n).next(()=>this.Ci(n))}),this.Ri.close(),this.qi()}xi(e,n){return e.filter(r=>this.Mi(r.updateTimeMs,n)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>th(e).U().next(n=>this.xi(n,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,n){return um.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new jD(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return cm.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,n,r){te("IndexedDbPersistence","Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",o=function(h){return h===17?LL:h===16?jL:h===15?S_:h===14?dk:h===13?uk:h===12?RL:h===11?ck:void ve()}(this.hi);let a;return this.Ri.runTransaction(e,i,o,u=>(a=new zg(u,this.Qr?this.Qr.next():Bn.oe),n==="readwrite-primary"?this.wi(a).next(h=>!!h||this.Si(a)).next(h=>{if(!h)throw Ot(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new ae(J.FAILED_PRECONDITION,ik);return r(a)}).next(h=>this.Di(a).next(()=>h)):this.Ki(a).next(()=>r(a)))).then(u=>(a.raiseOnCommittedEvent(),u))}Ki(e){return jc(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)&&!this.vi(n)&&!(this.li||this.allowTabSynchronization&&n.allowTabSynchronization))throw new ae(J.FAILED_PRECONDITION,Ep)})}Di(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return jc(e).put("owner",n)}static D(){return Js.D()}bi(e){const n=jc(e);return n.get("owner").next(r=>this.vi(r)?(te("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):H.resolve())}Mi(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(Ot(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const n=/(?:Version|Mobile)\/1[456]/;iE()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var n;try{const r=((n=this.Vi)===null||n===void 0?void 0:n.getItem(this.Oi(e)))!==null;return te("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Ot("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){Ot("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function jc(t){return Gt(t,"owner")}function th(t){return Gt(t,"clientMetadata")}function hS(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q_{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=i}static Wi(e,n){let r=Oe(),i=Oe();for(const o of n.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new q_(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JD{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fS{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return iE()?8:ok(Wt())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,i){const o={result:null};return this.Yi(e,n).next(a=>{o.result=a}).next(()=>{if(!o.result)return this.Zi(e,n,i,r).next(a=>{o.result=a})}).next(()=>{if(o.result)return;const a=new JD;return this.Xi(e,n,a).next(u=>{if(o.result=u,this.zi)return this.es(e,n,a,u.size)})}).next(()=>o.result)}es(e,n,r,i){return r.documentReadCount<this.ji?(Wa()<=qe.DEBUG&&te("QueryEngine","SDK will not create cache indexes for query:",Ga(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),H.resolve()):(Wa()<=qe.DEBUG&&te("QueryEngine","Query:",Ga(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(Wa()<=qe.DEBUG&&te("QueryEngine","The SDK decides to create cache indexes for query:",Ga(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ir(n))):H.resolve())}Yi(e,n){if(mw(n))return H.resolve(null);let r=ir(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=vf(n,null,"F"),r=ir(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{const a=Oe(...o);return this.Ji.getDocuments(e,a).next(u=>this.indexManager.getMinOffset(e,r).next(h=>{const m=this.ts(n,u);return this.ns(n,m,a,h.readTime)?this.Yi(e,vf(n,null,"F")):this.rs(e,m,n,h)}))})))}Zi(e,n,r,i){return mw(n)||i.isEqual(Te.min())?H.resolve(null):this.Ji.getDocuments(e,r).next(o=>{const a=this.ts(n,o);return this.ns(n,a,r,i)?H.resolve(null):(Wa()<=qe.DEBUG&&te("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ga(n)),this.rs(e,a,n,nk(i,-1)).next(u=>u))})}ts(e,n){let r=new at(Pk(e));return n.forEach((i,o)=>{rd(e,o)&&(r=r.add(o))}),r}ns(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const o=e.limitType==="F"?n.last():n.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Xi(e,n,r){return Wa()<=qe.DEBUG&&te("QueryEngine","Using full collection scan to execute query:",Ga(n)),this.Ji.getDocumentsMatchingQuery(e,n,ar.min(),r)}rs(e,n,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(o=>(n.forEach(a=>{o=o.insert(a.key,a)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XD{constructor(e,n,r,i){this.persistence=e,this.ss=n,this.serializer=i,this.os=new ht(Le),this._s=new ho(o=>Jo(o),td),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new uS(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function mS(t,e,n,r){return new XD(t,e,n,r)}async function pS(t,e){const n=xe(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(o=>{const a=[],u=[];let h=Oe();for(const m of i){a.push(m.batchId);for(const y of m.mutations)h=h.add(y.key)}for(const m of o){u.push(m.batchId);for(const y of m.mutations)h=h.add(y.key)}return n.localDocuments.getDocuments(r,h).next(m=>({hs:m,removedBatchIds:a,addedBatchIds:u}))})})}function eM(t,e){const n=xe(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),o=n.cs.newChangeBuffer({trackRemovals:!0});return function(u,h,m,y){const v=m.batch,w=v.keys();let S=H.resolve();return w.forEach(N=>{S=S.next(()=>y.getEntry(h,N)).next(P=>{const F=m.docVersions.get(N);be(F!==null),P.version.compareTo(F)<0&&(v.applyToRemoteDocument(P,m),P.isValidDocument()&&(P.setReadTime(m.commitVersion),y.addEntry(P)))})}),S.next(()=>u.mutationQueue.removeMutationBatch(h,v))}(n,r,e,o).next(()=>o.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let h=Oe();for(let m=0;m<u.mutationResults.length;++m)u.mutationResults[m].transformResults.length>0&&(h=h.add(u.batch.mutations[m].key));return h}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function gS(t){const e=xe(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function tM(t,e){const n=xe(t),r=e.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const a=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const u=[];e.targetChanges.forEach((y,v)=>{const w=i.get(v);if(!w)return;u.push(n.Ur.removeMatchingKeys(o,y.removedDocuments,v).next(()=>n.Ur.addMatchingKeys(o,y.addedDocuments,v)));let S=w.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(v)!==null?S=S.withResumeToken(Rt.EMPTY_BYTE_STRING,Te.min()).withLastLimboFreeSnapshotVersion(Te.min()):y.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(y.resumeToken,r)),i=i.insert(v,S),function(P,F,R){return P.resumeToken.approximateByteSize()===0||F.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=3e8?!0:R.addedDocuments.size+R.modifiedDocuments.size+R.removedDocuments.size>0}(w,S,y)&&u.push(n.Ur.updateTargetData(o,S))});let h=tr(),m=Oe();if(e.documentUpdates.forEach(y=>{e.resolvedLimboDocuments.has(y)&&u.push(n.persistence.referenceDelegate.updateLimboDocument(o,y))}),u.push(nM(o,a,e.documentUpdates).next(y=>{h=y.Ps,m=y.Is})),!r.isEqual(Te.min())){const y=n.Ur.getLastRemoteSnapshotVersion(o).next(v=>n.Ur.setTargetsMetadata(o,o.currentSequenceNumber,r));u.push(y)}return H.waitFor(u).next(()=>a.apply(o)).next(()=>n.localDocuments.getLocalViewOfDocuments(o,h,m)).next(()=>h)}).then(o=>(n.os=i,o))}function nM(t,e,n){let r=Oe(),i=Oe();return n.forEach(o=>r=r.add(o)),e.getEntries(t,r).next(o=>{let a=tr();return n.forEach((u,h)=>{const m=o.get(u);h.isFoundDocument()!==m.isFoundDocument()&&(i=i.add(u)),h.isNoDocument()&&h.version.isEqual(Te.min())?(e.removeEntry(u,h.readTime),a=a.insert(u,h)):!m.isValidDocument()||h.version.compareTo(m.version)>0||h.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(h),a=a.insert(u,h)):te("LocalStore","Ignoring outdated watch update for ",u,". Current version:",m.version," Watch version:",h.version)}),{Ps:a,Is:i}})}function rM(t,e){const n=xe(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Ef(t,e){const n=xe(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Ur.getTargetData(r,e).next(o=>o?(i=o,H.resolve(i)):n.Ur.allocateTargetId(r).next(a=>(i=new qi(e,a,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Vl(t,e,n){const r=xe(t),i=r.os.get(e),o=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",o,a=>r.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!uo(a))throw a;te("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function ny(t,e,n){const r=xe(t);let i=Te.min(),o=Oe();return r.persistence.runTransaction("Execute query","readwrite",a=>function(h,m,y){const v=xe(h),w=v._s.get(y);return w!==void 0?H.resolve(v.os.get(w)):v.Ur.getTargetData(m,y)}(r,a,ir(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(a,u.targetId).next(h=>{o=h})}).next(()=>r.ss.getDocumentsMatchingQuery(a,e,n?i:Te.min(),n?o:Oe())).next(u=>(vS(r,Sk(e),u),{documents:u,Ts:o})))}function yS(t,e){const n=xe(t),r=xe(n.Ur),i=n.os.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",o=>r.ot(o,e).next(a=>a?a.target:null))}function _S(t,e){const n=xe(t),r=n.us.get(e)||Te.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.cs.getAllFromCollectionGroup(i,e,nk(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(vS(n,e,i),i))}function vS(t,e,n){let r=t.us.get(e)||Te.min();n.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),t.us.set(e,r)}function qw(t,e){return`firestore_clients_${t}_${e}`}function $w(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function kp(t,e){return`firestore_targets_${t}_${e}`}class kf{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Rs(e,n,r){const i=JSON.parse(r);let o,a=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return a&&i.error&&(a=typeof i.error.message=="string"&&typeof i.error.code=="string",a&&(o=new ae(i.error.code,i.error.message))),a?new kf(e,n,i.state,o):(Ot("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class lu{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Rs(e,n){const r=JSON.parse(n);let i,o=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return o&&r.error&&(o=typeof r.error.message=="string"&&typeof r.error.code=="string",o&&(i=new ae(r.error.code,r.error.message))),o?new lu(e,r.state,i):(Ot("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Sf{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Rs(e,n){const r=JSON.parse(n);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,o=C_();for(let a=0;i&&a<r.activeTargetIds.length;++a)i=ak(r.activeTargetIds[a]),o=o.add(r.activeTargetIds[a]);return i?new Sf(e,o):(Ot("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class $_{constructor(e,n){this.clientId=e,this.onlineState=n}static Rs(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new $_(n.clientId,n.onlineState):(Ot("SharedClientState",`Failed to parse online state: ${e}`),null)}}class ry{constructor(){this.activeTargetIds=C_()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Sp{constructor(e,n,r,i,o){this.window=e,this.ui=n,this.persistenceKey=r,this.ps=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new ht(Le),this.started=!1,this.bs=[];const a=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.Ds=qw(this.persistenceKey,this.ps),this.vs=function(h){return`firestore_sequence_number_${h}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new ry),this.Cs=new RegExp(`^firestore_clients_${a}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${a}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${a}_(\\d+)$`),this.xs=function(h){return`firestore_online_state_${h}`}(this.persistenceKey),this.Os=function(h){return`firestore_bundle_loaded_v2_${h}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const r of e){if(r===this.ps)continue;const i=this.getItem(qw(this.persistenceKey,r));if(i){const o=Sf.Rs(r,i);o&&(this.Ss=this.Ss.insert(o.clientId,o))}}this.Ns();const n=this.storage.getItem(this.xs);if(n){const r=this.Ls(n);r&&this.Bs(r)}for(const r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let n=!1;return this.Ss.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,n,r){this.qs(e,n,r),this.Qs(e)}addLocalQueryTarget(e,n=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(kp(this.persistenceKey,e));if(i){const o=lu.Rs(e,i);o&&(r=o.state)}}return n&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(kp(this.persistenceKey,e))}updateQueryState(e,n,r){this.$s(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Qs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return te("SharedClientState","READ",e,n),n}setItem(e,n){te("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){te("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const n=e;if(n.storageArea===this.storage){if(te("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Ds)return void Ot("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.Cs.test(n.key)){if(n.newValue==null){const r=this.Gs(n.key);return this.zs(r,null)}{const r=this.js(n.key,n.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(n.key)){if(n.newValue!==null){const r=this.Hs(n.key,n.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(n.key)){if(n.newValue!==null){const r=this.Ys(n.key,n.newValue);if(r)return this.Zs(r)}}else if(n.key===this.xs){if(n.newValue!==null){const r=this.Ls(n.newValue);if(r)return this.Bs(r)}}else if(n.key===this.vs){const r=function(o){let a=Bn.oe;if(o!=null)try{const u=JSON.parse(o);be(typeof u=="number"),a=u}catch(u){Ot("SharedClientState","Failed to read sequence number from WebStorage",u)}return a}(n.newValue);r!==Bn.oe&&this.sequenceNumberHandler(r)}else if(n.key===this.Os){const r=this.Xs(n.newValue);await Promise.all(r.map(i=>this.syncEngine.eo(i)))}}}else this.bs.push(n)})}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,n,r){const i=new kf(this.currentUser,e,n,r),o=$w(this.persistenceKey,this.currentUser,e);this.setItem(o,i.Vs())}Qs(e){const n=$w(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Us(e){const n={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(n))}$s(e,n,r){const i=kp(this.persistenceKey,e),o=new lu(e,n,r);this.setItem(i,o.Vs())}Ws(e){const n=JSON.stringify(Array.from(e));this.setItem(this.Os,n)}Gs(e){const n=this.Cs.exec(e);return n?n[1]:null}js(e,n){const r=this.Gs(e);return Sf.Rs(r,n)}Hs(e,n){const r=this.Fs.exec(e),i=Number(r[1]),o=r[2]!==void 0?r[2]:null;return kf.Rs(new dn(o),i,n)}Ys(e,n){const r=this.Ms.exec(e),i=Number(r[1]);return lu.Rs(i,n)}Ls(e){return $_.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);te("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,n){const r=n?this.Ss.insert(e,n):this.Ss.remove(e),i=this.ks(this.Ss),o=this.ks(r),a=[],u=[];return o.forEach(h=>{i.has(h)||a.push(h)}),i.forEach(h=>{o.has(h)||u.push(h)}),this.syncEngine.io(a,u).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let n=C_();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}}class xS{constructor(){this.so=new ry,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new ry,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iM{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hw{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){te("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){te("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nh=null;function Pp(){return nh===null?nh=function(){return 268435456+Math.round(2147483648*Math.random())}():nh++,"0x"+nh.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sM={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oM{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const un="WebChannelConnection";class aM extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${i}/databases/${o}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${o}`}get Fo(){return!1}Mo(n,r,i,o,a){const u=Pp(),h=this.xo(n,r.toUriEncodedString());te("RestConnection",`Sending RPC '${n}' ${u}:`,h,i);const m={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(m,o,a),this.No(n,h,m,i).then(y=>(te("RestConnection",`Received RPC '${n}' ${u}: `,y),y),y=>{throw Al("RestConnection",`RPC '${n}' ${u} failed with error: `,y,"url: ",h,"request:",i),y})}Lo(n,r,i,o,a,u){return this.Mo(n,r,i,o,a)}Oo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Zl}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((o,a)=>n[a]=o),i&&i.headers.forEach((o,a)=>n[a]=o)}xo(n,r){const i=sM[n];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,i){const o=Pp();return new Promise((a,u)=>{const h=new ZE;h.setWithCredentials(!0),h.listenOnce(QE.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case Eh.NO_ERROR:const y=h.getResponseJson();te(un,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(y)),a(y);break;case Eh.TIMEOUT:te(un,`RPC '${e}' ${o} timed out`),u(new ae(J.DEADLINE_EXCEEDED,"Request time out"));break;case Eh.HTTP_ERROR:const v=h.getStatus();if(te(un,`RPC '${e}' ${o} failed with status:`,v,"response text:",h.getResponseText()),v>0){let w=h.getResponseJson();Array.isArray(w)&&(w=w[0]);const S=w==null?void 0:w.error;if(S&&S.status&&S.message){const N=function(F){const R=F.toLowerCase().replace(/_/g,"-");return Object.values(J).indexOf(R)>=0?R:J.UNKNOWN}(S.status);u(new ae(N,S.message))}else u(new ae(J.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new ae(J.UNAVAILABLE,"Connection failed."));break;default:ve()}}finally{te(un,`RPC '${e}' ${o} completed.`)}});const m=JSON.stringify(i);te(un,`RPC '${e}' ${o} sending request:`,i),h.send(n,"POST",m,r,15)})}Bo(e,n,r){const i=Pp(),o=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=XE(),u=JE(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(h.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(h.useFetchStreams=!0),this.Oo(h.initMessageHeaders,n,r),h.encodeInitMessageHeaders=!0;const y=o.join("");te(un,`Creating RPC '${e}' stream ${i}: ${y}`,h);const v=a.createWebChannel(y,h);let w=!1,S=!1;const N=new oM({Io:F=>{S?te(un,`Not sending because RPC '${e}' stream ${i} is closed:`,F):(w||(te(un,`Opening RPC '${e}' stream ${i} transport.`),v.open(),w=!0),te(un,`RPC '${e}' stream ${i} sending:`,F),v.send(F))},To:()=>v.close()}),P=(F,R,k)=>{F.listen(R,A=>{try{k(A)}catch(z){setTimeout(()=>{throw z},0)}})};return P(v,qc.EventType.OPEN,()=>{S||(te(un,`RPC '${e}' stream ${i} transport opened.`),N.yo())}),P(v,qc.EventType.CLOSE,()=>{S||(S=!0,te(un,`RPC '${e}' stream ${i} transport closed`),N.So())}),P(v,qc.EventType.ERROR,F=>{S||(S=!0,Al(un,`RPC '${e}' stream ${i} transport errored:`,F),N.So(new ae(J.UNAVAILABLE,"The operation could not be completed")))}),P(v,qc.EventType.MESSAGE,F=>{var R;if(!S){const k=F.data[0];be(!!k);const A=k,z=A.error||((R=A[0])===null||R===void 0?void 0:R.error);if(z){te(un,`RPC '${e}' stream ${i} received error:`,z);const G=z.status;let W=function(C){const D=Ut[C];if(D!==void 0)return Uk(D)}(G),T=z.message;W===void 0&&(W=J.INTERNAL,T="Unknown error status: "+G+" with message "+z.message),S=!0,N.So(new ae(W,T)),v.close()}else te(un,`RPC '${e}' stream ${i} received:`,k),N.bo(k)}}),P(u,YE.STAT_EVENT,F=>{F.stat===Ug.PROXY?te(un,`RPC '${e}' stream ${i} detected buffering proxy`):F.stat===Ug.NOPROXY&&te(un,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{N.wo()},0),N}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wS(){return typeof window<"u"?window:null}function Rh(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hm(t){return new mD(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bS{constructor(e,n,r=1e3,i=1.5,o=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=i,this.Qo=o,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,n-r);i>0&&te("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IS{constructor(e,n,r,i,o,a,u,h){this.ui=e,this.Ho=r,this.Jo=i,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=h,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new bS(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===J.RESOURCE_EXHAUSTED?(Ot(n.toString()),Ot("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===J.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===n&&this.P_(r,i)},r=>{e(()=>{const i=new ae(J.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return te("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(te("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class lM extends IS{constructor(e,n,r,i,o,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,a),this.serializer=o}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=yD(this.serializer,e),r=function(o){if(!("targetChange"in o))return Te.min();const a=o.targetChange;return a.targetIds&&a.targetIds.length?Te.min():a.readTime?Pn(a.readTime):Te.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=Yg(this.serializer),n.addTarget=function(o,a){let u;const h=a.target;if(u=yf(h)?{documents:Kk(o,h)}:{query:Zk(o,h)._t},u.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){u.resumeToken=qk(o,a.resumeToken);const m=Zg(o,a.expectedCount);m!==null&&(u.expectedCount=m)}else if(a.snapshotVersion.compareTo(Te.min())>0){u.readTime=Ol(o,a.snapshotVersion.toTimestamp());const m=Zg(o,a.expectedCount);m!==null&&(u.expectedCount=m)}return u}(this.serializer,e);const r=vD(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=Yg(this.serializer),n.removeTarget=e,this.a_(n)}}class cM extends IS{constructor(e,n,r,i,o,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,a),this.serializer=o}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return be(!!e.streamToken),this.lastStreamToken=e.streamToken,be(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){be(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=_D(e.writeResults,e.commitTime),r=Pn(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=Yg(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>wf(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uM extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new ae(J.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Mo(e,Qg(n,r),i,o,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===J.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ae(J.UNKNOWN,o.toString())})}Lo(e,n,r,i,o){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,u])=>this.connection.Lo(e,Qg(n,r),i,a,u,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===J.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new ae(J.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class dM{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Ot(n),this.D_=!1):te("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hM{constructor(e,n,r,i,o){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=o,this.k_._o(a=>{r.enqueueAndForget(async()=>{ha(this)&&(te("RemoteStore","Restarting streams for network reachability change."),await async function(h){const m=xe(h);m.L_.add(4),await od(m),m.q_.set("Unknown"),m.L_.delete(4),await fm(m)}(this))})}),this.q_=new dM(r,i)}}async function fm(t){if(ha(t))for(const e of t.B_)await e(!0)}async function od(t){for(const e of t.B_)await e(!1)}function mm(t,e){const n=xe(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),G_(n)?W_(n):Xl(n).r_()&&H_(n,e))}function Fl(t,e){const n=xe(t),r=Xl(n);n.N_.delete(e),r.r_()&&TS(n,e),n.N_.size===0&&(r.r_()?r.o_():ha(n)&&n.q_.set("Unknown"))}function H_(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Te.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Xl(t).A_(e)}function TS(t,e){t.Q_.xe(e),Xl(t).R_(e)}function W_(t){t.Q_=new uD({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Xl(t).start(),t.q_.v_()}function G_(t){return ha(t)&&!Xl(t).n_()&&t.N_.size>0}function ha(t){return xe(t).L_.size===0}function ES(t){t.Q_=void 0}async function fM(t){t.q_.set("Online")}async function mM(t){t.N_.forEach((e,n)=>{H_(t,e)})}async function pM(t,e){ES(t),G_(t)?(t.q_.M_(e),W_(t)):t.q_.set("Unknown")}async function gM(t,e,n){if(t.q_.set("Online"),e instanceof zk&&e.state===2&&e.cause)try{await async function(i,o){const a=o.cause;for(const u of o.targetIds)i.N_.has(u)&&(await i.remoteSyncer.rejectListen(u,a),i.N_.delete(u),i.Q_.removeTarget(u))}(t,e)}catch(r){te("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Pf(t,r)}else if(e instanceof Ch?t.Q_.Ke(e):e instanceof Bk?t.Q_.He(e):t.Q_.We(e),!n.isEqual(Te.min()))try{const r=await gS(t.localStore);n.compareTo(r)>=0&&await function(o,a){const u=o.Q_.rt(a);return u.targetChanges.forEach((h,m)=>{if(h.resumeToken.approximateByteSize()>0){const y=o.N_.get(m);y&&o.N_.set(m,y.withResumeToken(h.resumeToken,a))}}),u.targetMismatches.forEach((h,m)=>{const y=o.N_.get(h);if(!y)return;o.N_.set(h,y.withResumeToken(Rt.EMPTY_BYTE_STRING,y.snapshotVersion)),TS(o,h);const v=new qi(y.target,h,m,y.sequenceNumber);H_(o,v)}),o.remoteSyncer.applyRemoteEvent(u)}(t,n)}catch(r){te("RemoteStore","Failed to raise snapshot:",r),await Pf(t,r)}}async function Pf(t,e,n){if(!uo(e))throw e;t.L_.add(1),await od(t),t.q_.set("Offline"),n||(n=()=>gS(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{te("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await fm(t)})}function kS(t,e){return e().catch(n=>Pf(t,n,e))}async function Jl(t){const e=xe(t),n=io(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;yM(e);)try{const i=await rM(e.localStore,r);if(i===null){e.O_.length===0&&n.o_();break}r=i.batchId,_M(e,i)}catch(i){await Pf(e,i)}SS(e)&&PS(e)}function yM(t){return ha(t)&&t.O_.length<10}function _M(t,e){t.O_.push(e);const n=io(t);n.r_()&&n.V_&&n.m_(e.mutations)}function SS(t){return ha(t)&&!io(t).n_()&&t.O_.length>0}function PS(t){io(t).start()}async function vM(t){io(t).p_()}async function xM(t){const e=io(t);for(const n of t.O_)e.m_(n.mutations)}async function wM(t,e,n){const r=t.O_.shift(),i=D_.from(r,e,n);await kS(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Jl(t)}async function bM(t,e){e&&io(t).V_&&await async function(r,i){if(function(a){return aD(a)&&a!==J.ABORTED}(i.code)){const o=r.O_.shift();io(r).s_(),await kS(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),await Jl(r)}}(t,e),SS(t)&&PS(t)}async function Ww(t,e){const n=xe(t);n.asyncQueue.verifyOperationInProgress(),te("RemoteStore","RemoteStore received new credentials");const r=ha(n);n.L_.add(3),await od(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await fm(n)}async function iy(t,e){const n=xe(t);e?(n.L_.delete(2),await fm(n)):e||(n.L_.add(2),await od(n),n.q_.set("Unknown"))}function Xl(t){return t.K_||(t.K_=function(n,r,i){const o=xe(n);return o.w_(),new lM(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Eo:fM.bind(null,t),Ro:mM.bind(null,t),mo:pM.bind(null,t),d_:gM.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),G_(t)?W_(t):t.q_.set("Unknown")):(await t.K_.stop(),ES(t))})),t.K_}function io(t){return t.U_||(t.U_=function(n,r,i){const o=xe(n);return o.w_(),new cM(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:vM.bind(null,t),mo:bM.bind(null,t),f_:xM.bind(null,t),g_:wM.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Jl(t)):(await t.U_.stop(),t.O_.length>0&&(te("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K_{constructor(e,n,r,i,o){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new _i,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,o){const a=Date.now()+r,u=new K_(e,n,a,i,o);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ae(J.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Z_(t,e){if(Ot("AsyncQueue",`${e}: ${t}`),uo(t))return new ae(J.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xl{constructor(e){this.comparator=e?(n,r)=>e(n,r)||he.comparator(n.key,r.key):(n,r)=>he.comparator(n.key,r.key),this.keyedMap=$c(),this.sortedSet=new ht(this.comparator)}static emptySet(e){return new xl(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof xl)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new xl;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gw{constructor(){this.W_=new ht(he.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):ve():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Ul{constructor(e,n,r,i,o,a,u,h,m){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=a,this.syncStateChanged=u,this.excludesMetadataChanges=h,this.hasCachedResults=m}static fromInitialDocuments(e,n,r,i,o){const a=[];return n.forEach(u=>{a.push({type:0,doc:u})}),new Ul(e,n,xl.emptySet(n),a,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&sm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IM{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class TM{constructor(){this.queries=Kw(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const i=xe(n),o=i.queries;i.queries=Kw(),o.forEach((a,u)=>{for(const h of u.j_)h.onError(r)})})(this,new ae(J.ABORTED,"Firestore shutting down"))}}function Kw(){return new ho(t=>kk(t),sm)}async function Q_(t,e){const n=xe(t);let r=3;const i=e.query;let o=n.queries.get(i);o?!o.H_()&&e.J_()&&(r=2):(o=new IM,r=e.J_()?0:1);try{switch(r){case 0:o.z_=await n.onListen(i,!0);break;case 1:o.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(a){const u=Z_(a,`Initialization of query '${Ga(e.query)}' failed`);return void e.onError(u)}n.queries.set(i,o),o.j_.push(e),e.Z_(n.onlineState),o.z_&&e.X_(o.z_)&&J_(n)}async function Y_(t,e){const n=xe(t),r=e.query;let i=3;const o=n.queries.get(r);if(o){const a=o.j_.indexOf(e);a>=0&&(o.j_.splice(a,1),o.j_.length===0?i=e.J_()?0:1:!o.H_()&&e.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function EM(t,e){const n=xe(t);let r=!1;for(const i of e){const o=i.query,a=n.queries.get(o);if(a){for(const u of a.j_)u.X_(i)&&(r=!0);a.z_=i}}r&&J_(n)}function kM(t,e,n){const r=xe(t),i=r.queries.get(e);if(i)for(const o of i.j_)o.onError(n);r.queries.delete(e)}function J_(t){t.Y_.forEach(e=>{e.next()})}var sy,Zw;(Zw=sy||(sy={})).ea="default",Zw.Cache="cache";class X_{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Ul(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=Ul.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==sy.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NS{constructor(e){this.key=e}}class AS{constructor(e){this.key=e}}class SM{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Oe(),this.mutatedKeys=Oe(),this.Aa=Pk(e),this.Ra=new xl(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new Gw,i=n?n.Ra:this.Ra;let o=n?n.mutatedKeys:this.mutatedKeys,a=i,u=!1;const h=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,m=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((y,v)=>{const w=i.get(y),S=rd(this.query,v)?v:null,N=!!w&&this.mutatedKeys.has(w.key),P=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations);let F=!1;w&&S?w.data.isEqual(S.data)?N!==P&&(r.track({type:3,doc:S}),F=!0):this.ga(w,S)||(r.track({type:2,doc:S}),F=!0,(h&&this.Aa(S,h)>0||m&&this.Aa(S,m)<0)&&(u=!0)):!w&&S?(r.track({type:0,doc:S}),F=!0):w&&!S&&(r.track({type:1,doc:w}),F=!0,(h||m)&&(u=!0)),F&&(S?(a=a.add(S),o=P?o.add(y):o.delete(y)):(a=a.delete(y),o=o.delete(y)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const y=this.query.limitType==="F"?a.last():a.first();a=a.delete(y.key),o=o.delete(y.key),r.track({type:1,doc:y})}return{Ra:a,fa:r,ns:u,mutatedKeys:o}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const o=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((y,v)=>function(S,N){const P=F=>{switch(F){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ve()}};return P(S)-P(N)}(y.type,v.type)||this.Aa(y.doc,v.doc)),this.pa(r),i=i!=null&&i;const u=n&&!i?this.ya():[],h=this.da.size===0&&this.current&&!i?1:0,m=h!==this.Ea;return this.Ea=h,a.length!==0||m?{snapshot:new Ul(this.query,e.Ra,o,a,e.mutatedKeys,h===0,m,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:u}:{wa:u}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Gw,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Oe(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new AS(r))}),this.da.forEach(r=>{e.has(r)||n.push(new NS(r))}),n}ba(e){this.Ta=e.Ts,this.da=Oe();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return Ul.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class PM{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class NM{constructor(e){this.key=e,this.va=!1}}class AM{constructor(e,n,r,i,o,a){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new ho(u=>kk(u),sm),this.Ma=new Map,this.xa=new Set,this.Oa=new ht(he.comparator),this.Na=new Map,this.La=new B_,this.Ba={},this.ka=new Map,this.qa=na.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function CM(t,e,n=!0){const r=pm(t);let i;const o=r.Fa.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.Da()):i=await CS(r,e,n,!0),i}async function RM(t,e){const n=pm(t);await CS(n,e,!0,!1)}async function CS(t,e,n,r){const i=await Ef(t.localStore,ir(e)),o=i.targetId,a=t.sharedClientState.addLocalQueryTarget(o,n);let u;return r&&(u=await ev(t,e,o,a==="current",i.resumeToken)),t.isPrimaryClient&&n&&mm(t.remoteStore,i),u}async function ev(t,e,n,r,i){t.Ka=(v,w,S)=>async function(P,F,R,k){let A=F.view.ma(R);A.ns&&(A=await ny(P.localStore,F.query,!1).then(({documents:T})=>F.view.ma(T,A)));const z=k&&k.targetChanges.get(F.targetId),G=k&&k.targetMismatches.get(F.targetId)!=null,W=F.view.applyChanges(A,P.isPrimaryClient,z,G);return oy(P,F.targetId,W.wa),W.snapshot}(t,v,w,S);const o=await ny(t.localStore,e,!0),a=new SM(e,o.Ts),u=a.ma(o.documents),h=sd.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),m=a.applyChanges(u,t.isPrimaryClient,h);oy(t,n,m.wa);const y=new PM(e,n,a);return t.Fa.set(e,y),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),m.snapshot}async function jM(t,e,n){const r=xe(t),i=r.Fa.get(e),o=r.Ma.get(i.targetId);if(o.length>1)return r.Ma.set(i.targetId,o.filter(a=>!sm(a,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Vl(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Fl(r.remoteStore,i.targetId),Bl(r,i.targetId)}).catch(co)):(Bl(r,i.targetId),await Vl(r.localStore,i.targetId,!0))}async function LM(t,e){const n=xe(t),r=n.Fa.get(e),i=n.Ma.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Fl(n.remoteStore,r.targetId))}async function DM(t,e,n){const r=iv(t);try{const i=await function(a,u){const h=xe(a),m=Ze.now(),y=u.reduce((S,N)=>S.add(N.key),Oe());let v,w;return h.persistence.runTransaction("Locally write mutations","readwrite",S=>{let N=tr(),P=Oe();return h.cs.getEntries(S,y).next(F=>{N=F,N.forEach((R,k)=>{k.isValidDocument()||(P=P.add(R))})}).next(()=>h.localDocuments.getOverlayedDocuments(S,N)).next(F=>{v=F;const R=[];for(const k of u){const A=sD(k,v.get(k.key).overlayedDocument);A!=null&&R.push(new as(k.key,A,gk(A.value.mapValue),mn.exists(!0)))}return h.mutationQueue.addMutationBatch(S,m,R,u)}).next(F=>{w=F;const R=F.applyToLocalDocumentSet(v,P);return h.documentOverlayCache.saveOverlays(S,F.batchId,R)})}).then(()=>({batchId:w.batchId,changes:Ak(v)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,u,h){let m=a.Ba[a.currentUser.toKey()];m||(m=new ht(Le)),m=m.insert(u,h),a.Ba[a.currentUser.toKey()]=m}(r,i.batchId,n),await fo(r,i.changes),await Jl(r.remoteStore)}catch(i){const o=Z_(i,"Failed to persist write");n.reject(o)}}async function RS(t,e){const n=xe(t);try{const r=await tM(n.localStore,e);e.targetChanges.forEach((i,o)=>{const a=n.Na.get(o);a&&(be(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?be(a.va):i.removedDocuments.size>0&&(be(a.va),a.va=!1))}),await fo(n,r,e)}catch(r){await co(r)}}function Qw(t,e,n){const r=xe(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Fa.forEach((o,a)=>{const u=a.view.Z_(e);u.snapshot&&i.push(u.snapshot)}),function(a,u){const h=xe(a);h.onlineState=u;let m=!1;h.queries.forEach((y,v)=>{for(const w of v.j_)w.Z_(u)&&(m=!0)}),m&&J_(h)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function MM(t,e,n){const r=xe(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Na.get(e),o=i&&i.key;if(o){let a=new ht(he.comparator);a=a.insert(o,Ct.newNoDocument(o,Te.min()));const u=Oe().add(o),h=new id(Te.min(),new Map,new ht(Le),a,u);await RS(r,h),r.Oa=r.Oa.remove(o),r.Na.delete(e),rv(r)}else await Vl(r.localStore,e,!1).then(()=>Bl(r,e,n)).catch(co)}async function OM(t,e){const n=xe(t),r=e.batch.batchId;try{const i=await eM(n.localStore,e);nv(n,r,null),tv(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await fo(n,i)}catch(i){await co(i)}}async function VM(t,e,n){const r=xe(t);try{const i=await function(a,u){const h=xe(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",m=>{let y;return h.mutationQueue.lookupMutationBatch(m,u).next(v=>(be(v!==null),y=v.keys(),h.mutationQueue.removeMutationBatch(m,v))).next(()=>h.mutationQueue.performConsistencyCheck(m)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(m,y,u)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,y)).next(()=>h.localDocuments.getDocuments(m,y))})}(r.localStore,e);nv(r,e,n),tv(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await fo(r,i)}catch(i){await co(i)}}function tv(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function nv(t,e,n){const r=xe(t);let i=r.Ba[r.currentUser.toKey()];if(i){const o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function Bl(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||jS(t,r)})}function jS(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(Fl(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),rv(t))}function oy(t,e,n){for(const r of n)r instanceof NS?(t.La.addReference(r.key,e),FM(t,r)):r instanceof AS?(te("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||jS(t,r.key)):ve()}function FM(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(te("SyncEngine","New document in limbo: "+n),t.xa.add(r),rv(t))}function rv(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new he(tt.fromString(e)),r=t.qa.next();t.Na.set(r,new NM(n)),t.Oa=t.Oa.insert(n,r),mm(t.remoteStore,new qi(ir(nd(n.path)),r,"TargetPurposeLimboResolution",Bn.oe))}}async function fo(t,e,n){const r=xe(t),i=[],o=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((u,h)=>{a.push(r.Ka(h,e,n).then(m=>{var y;if((m||n)&&r.isPrimaryClient){const v=m?!m.fromCache:(y=n==null?void 0:n.targetChanges.get(h.targetId))===null||y===void 0?void 0:y.current;r.sharedClientState.updateQueryState(h.targetId,v?"current":"not-current")}if(m){i.push(m);const v=q_.Wi(h.targetId,m);o.push(v)}}))}),await Promise.all(a),r.Ca.d_(i),await async function(h,m){const y=xe(h);try{await y.persistence.runTransaction("notifyLocalViewChanges","readwrite",v=>H.forEach(m,w=>H.forEach(w.$i,S=>y.persistence.referenceDelegate.addReference(v,w.targetId,S)).next(()=>H.forEach(w.Ui,S=>y.persistence.referenceDelegate.removeReference(v,w.targetId,S)))))}catch(v){if(!uo(v))throw v;te("LocalStore","Failed to update sequence numbers: "+v)}for(const v of m){const w=v.targetId;if(!v.fromCache){const S=y.os.get(w),N=S.snapshotVersion,P=S.withLastLimboFreeSnapshotVersion(N);y.os=y.os.insert(w,P)}}}(r.localStore,o))}async function UM(t,e){const n=xe(t);if(!n.currentUser.isEqual(e)){te("SyncEngine","User change. New user:",e.toKey());const r=await pS(n.localStore,e);n.currentUser=e,function(o,a){o.ka.forEach(u=>{u.forEach(h=>{h.reject(new ae(J.CANCELLED,a))})}),o.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await fo(n,r.hs)}}function BM(t,e){const n=xe(t),r=n.Na.get(e);if(r&&r.va)return Oe().add(r.key);{let i=Oe();const o=n.Ma.get(e);if(!o)return i;for(const a of o){const u=n.Fa.get(a);i=i.unionWith(u.view.Va)}return i}}async function zM(t,e){const n=xe(t),r=await ny(n.localStore,e.query,!0),i=e.view.ba(r);return n.isPrimaryClient&&oy(n,e.targetId,i.wa),i}async function qM(t,e){const n=xe(t);return _S(n.localStore,e).then(r=>fo(n,r))}async function $M(t,e,n,r){const i=xe(t),o=await function(u,h){const m=xe(u),y=xe(m.mutationQueue);return m.persistence.runTransaction("Lookup mutation documents","readonly",v=>y.Mn(v,h).next(w=>w?m.localDocuments.getDocuments(v,w):H.resolve(null)))}(i.localStore,e);o!==null?(n==="pending"?await Jl(i.remoteStore):n==="acknowledged"||n==="rejected"?(nv(i,e,r||null),tv(i,e),function(u,h){xe(xe(u).mutationQueue).On(h)}(i.localStore,e)):ve(),await fo(i,o)):te("SyncEngine","Cannot apply mutation batch with id: "+e)}async function HM(t,e){const n=xe(t);if(pm(n),iv(n),e===!0&&n.Qa!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),i=await Yw(n,r.toArray());n.Qa=!0,await iy(n.remoteStore,!0);for(const o of i)mm(n.remoteStore,o)}else if(e===!1&&n.Qa!==!1){const r=[];let i=Promise.resolve();n.Ma.forEach((o,a)=>{n.sharedClientState.isLocalQueryTarget(a)?r.push(a):i=i.then(()=>(Bl(n,a),Vl(n.localStore,a,!0))),Fl(n.remoteStore,a)}),await i,await Yw(n,r),function(a){const u=xe(a);u.Na.forEach((h,m)=>{Fl(u.remoteStore,m)}),u.La.pr(),u.Na=new Map,u.Oa=new ht(he.comparator)}(n),n.Qa=!1,await iy(n.remoteStore,!1)}}async function Yw(t,e,n){const r=xe(t),i=[],o=[];for(const a of e){let u;const h=r.Ma.get(a);if(h&&h.length!==0){u=await Ef(r.localStore,ir(h[0]));for(const m of h){const y=r.Fa.get(m),v=await zM(r,y);v.snapshot&&o.push(v.snapshot)}}else{const m=await yS(r.localStore,a);u=await Ef(r.localStore,m),await ev(r,LS(m),a,!1,u.resumeToken)}i.push(u)}return r.Ca.d_(o),i}function LS(t){return Tk(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function WM(t){return function(n){return xe(xe(n).persistence).Qi()}(xe(t).localStore)}async function GM(t,e,n,r){const i=xe(t);if(i.Qa)return void te("SyncEngine","Ignoring unexpected query state notification.");const o=i.Ma.get(e);if(o&&o.length>0)switch(n){case"current":case"not-current":{const a=await _S(i.localStore,Sk(o[0])),u=id.createSynthesizedRemoteEventForCurrentChange(e,n==="current",Rt.EMPTY_BYTE_STRING);await fo(i,a,u);break}case"rejected":await Vl(i.localStore,e,!0),Bl(i,e,r);break;default:ve()}}async function KM(t,e,n){const r=pm(t);if(r.Qa){for(const i of e){if(r.Ma.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){te("SyncEngine","Adding an already active target "+i);continue}const o=await yS(r.localStore,i),a=await Ef(r.localStore,o);await ev(r,LS(o),a.targetId,!1,a.resumeToken),mm(r.remoteStore,a)}for(const i of n)r.Ma.has(i)&&await Vl(r.localStore,i,!1).then(()=>{Fl(r.remoteStore,i),Bl(r,i)}).catch(co)}}function pm(t){const e=xe(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=RS.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=BM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=MM.bind(null,e),e.Ca.d_=EM.bind(null,e.eventManager),e.Ca.$a=kM.bind(null,e.eventManager),e}function iv(t){const e=xe(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=OM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=VM.bind(null,e),e}class Uu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=hm(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return mS(this.persistence,new fS,e.initialUser,this.serializer)}Ga(e){return new dS(dm.Zr,this.serializer)}Wa(e){return new xS}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Uu.provider={build:()=>new Uu};class DS extends Uu{constructor(e,n,r){super(),this.Ja=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await iv(this.Ja.syncEngine),await Jl(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return mS(this.persistence,new fS,e.initialUser,this.serializer)}ja(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new MD(r,e.asyncQueue,n)}Ha(e,n){const r=new pL(n,this.persistence);return new mL(e.asyncQueue,r)}Ga(e){const n=hS(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Mn.withCacheSize(this.cacheSizeBytes):Mn.DEFAULT;return new z_(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,wS(),Rh(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new xS}}class ZM extends DS{constructor(e,n){super(e,n,!1),this.Ja=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.Ja.syncEngine;this.sharedClientState instanceof Sp&&(this.sharedClientState.syncEngine={no:$M.bind(null,n),ro:GM.bind(null,n),io:KM.bind(null,n),Qi:WM.bind(null,n),eo:qM.bind(null,n)},await this.sharedClientState.start()),await this.persistence.yi(async r=>{await HM(this.Ja.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Wa(e){const n=wS();if(!Sp.D(n))throw new ae(J.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=hS(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Sp(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class Bu{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Qw(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=UM.bind(null,this.syncEngine),await iy(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new TM}()}createDatastore(e){const n=hm(e.databaseInfo.databaseId),r=function(o){return new aM(o)}(e.databaseInfo);return function(o,a,u,h){return new uM(o,a,u,h)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,o,a,u){return new hM(r,i,o,a,u)}(this.localStore,this.datastore,e.asyncQueue,n=>Qw(this.syncEngine,n,0),function(){return Hw.D()?new Hw:new iM}())}createSyncEngine(e,n){return function(i,o,a,u,h,m,y){const v=new AM(i,o,a,u,h,m);return y&&(v.Qa=!0),v}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const o=xe(i);te("RemoteStore","RemoteStore shutting down."),o.L_.add(5),await od(o),o.k_.shutdown(),o.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Bu.provider={build:()=>new Bu};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Ot("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QM{constructor(e,n,r,i,o){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=dn.UNAUTHENTICATED,this.clientId=T_.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,async a=>{te("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(te("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new _i;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Z_(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Np(t,e){t.asyncQueue.verifyOperationInProgress(),te("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await pS(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Jw(t,e){t.asyncQueue.verifyOperationInProgress();const n=await YM(t);te("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Ww(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>Ww(e.remoteStore,i)),t._onlineComponents=e}async function YM(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){te("FirestoreClient","Using user provided OfflineComponentProvider");try{await Np(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===J.FAILED_PRECONDITION||i.code===J.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;Al("Error using user provided cache. Falling back to memory cache: "+n),await Np(t,new Uu)}}else te("FirestoreClient","Using default OfflineComponentProvider"),await Np(t,new Uu);return t._offlineComponents}async function MS(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(te("FirestoreClient","Using user provided OnlineComponentProvider"),await Jw(t,t._uninitializedComponentsProvider._online)):(te("FirestoreClient","Using default OnlineComponentProvider"),await Jw(t,new Bu))),t._onlineComponents}function JM(t){return MS(t).then(e=>e.syncEngine)}async function Nf(t){const e=await MS(t),n=e.eventManager;return n.onListen=CM.bind(null,e.syncEngine),n.onUnlisten=jM.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=RM.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=LM.bind(null,e.syncEngine),n}function XM(t,e,n={}){const r=new _i;return t.asyncQueue.enqueueAndForget(async()=>function(o,a,u,h,m){const y=new sv({next:w=>{y.Za(),a.enqueueAndForget(()=>Y_(o,v));const S=w.docs.has(u);!S&&w.fromCache?m.reject(new ae(J.UNAVAILABLE,"Failed to get document because the client is offline.")):S&&w.fromCache&&h&&h.source==="server"?m.reject(new ae(J.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(w)},error:w=>m.reject(w)}),v=new X_(nd(u.path),y,{includeMetadataChanges:!0,_a:!0});return Q_(o,v)}(await Nf(t),t.asyncQueue,e,n,r)),r.promise}function eO(t,e,n={}){const r=new _i;return t.asyncQueue.enqueueAndForget(async()=>function(o,a,u,h,m){const y=new sv({next:w=>{y.Za(),a.enqueueAndForget(()=>Y_(o,v)),w.fromCache&&h.source==="server"?m.reject(new ae(J.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(w)},error:w=>m.reject(w)}),v=new X_(u,y,{includeMetadataChanges:!0,_a:!0});return Q_(o,v)}(await Nf(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OS(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xw=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VS(t,e,n){if(!n)throw new ae(J.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function FS(t,e,n,r){if(e===!0&&r===!0)throw new ae(J.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function eb(t){if(!he.isDocumentKey(t))throw new ae(J.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function tb(t){if(he.isDocumentKey(t))throw new ae(J.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function gm(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ve()}function Wn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ae(J.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=gm(t);throw new ae(J.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nb{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new ae(J.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ae(J.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}FS("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=OS((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new ae(J.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new ae(J.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new ae(J.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ov{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new nb({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ae(J.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ae(J.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new nb(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new ek;switch(r.type){case"firstParty":return new aL(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ae(J.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Xw.get(n);r&&(te("ComponentProvider","Removing Datastore"),Xw.delete(n),r.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new bi(this.firestore,e,this._query)}}class sn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Zi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new sn(this.firestore,e,this._key)}}class Zi extends bi{constructor(e,n,r){super(e,n,nd(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new sn(this.firestore,null,new he(e))}withConverter(e){return new Zi(this.firestore,e,this._path)}}function En(t,e,...n){if(t=Je(t),VS("collection","path",e),t instanceof ov){const r=tt.fromString(e,...n);return tb(r),new Zi(t,null,r)}{if(!(t instanceof sn||t instanceof Zi))throw new ae(J.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(tt.fromString(e,...n));return tb(r),new Zi(t.firestore,null,r)}}function ut(t,e,...n){if(t=Je(t),arguments.length===1&&(e=T_.newId()),VS("doc","path",e),t instanceof ov){const r=tt.fromString(e,...n);return eb(r),new sn(t,null,new he(r))}{if(!(t instanceof sn||t instanceof Zi))throw new ae(J.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(tt.fromString(e,...n));return eb(r),new sn(t.firestore,t instanceof Zi?t.converter:null,new he(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rb{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new bS(this,"async_queue_retry"),this.Vu=()=>{const r=Rh();r&&te("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=Rh();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=Rh();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new _i;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!uo(e))throw e;te("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(a){let u=a.message||"";return a.stack&&(u=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),u}(r);throw Ot("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const i=K_.createAndSchedule(this,e,n,r,o=>this.yu(o));return this.Tu.push(i),i}fu(){this.Eu&&ve()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function ib(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const o of r)if(o in i&&typeof i[o]=="function")return!0;return!1}(t,["next","error","complete"])}class xi extends ov{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new rb,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new rb(e),this._firestoreClient=void 0,await e}}}function US(t,e,n){const r=lo(t,"firestore");if(r.isInitialized(n)){const i=r.getImmediate({identifier:n}),o=r.getOptions(n);if(Nl(o,e))return i;throw new ae(J.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new ae(J.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ae(J.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:n})}function ad(t){if(t._terminated)throw new ae(J.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||tO(t),t._firestoreClient}function tO(t){var e,n,r;const i=t._freezeSettings(),o=function(u,h,m,y){return new ML(u,h,m,y.host,y.ssl,y.experimentalForceLongPolling,y.experimentalAutoDetectLongPolling,OS(y.experimentalLongPollingOptions),y.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new QM(t._authCredentials,t._appCheckCredentials,t._queue,o,t._componentsProvider&&function(u){const h=u==null?void 0:u._online.build();return{_offline:u==null?void 0:u._offline.build(h),_online:h}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ra{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ra(Rt.fromBase64String(e))}catch(n){throw new ae(J.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new ra(Rt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ld{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new ae(J.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new xt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ec{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ym{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new ae(J.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new ae(J.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Le(this._lat,e._lat)||Le(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _m{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nO=/^__.*__$/;class rO{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new as(e,this.data,this.fieldMask,n,this.fieldTransforms):new Yl(e,this.data,n,this.fieldTransforms)}}class BS{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new as(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function zS(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ve()}}class vm{constructor(e,n,r,i,o,a){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.vu(),this.fieldTransforms=o||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new vm(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Af(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(zS(this.Cu)&&nO.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class iO{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||hm(e)}Qu(e,n,r,i=!1){return new vm({Cu:e,methodName:n,qu:r,path:xt.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function xm(t){const e=t._freezeSettings(),n=hm(t._databaseId);return new iO(t._databaseId,!!e.ignoreUndefinedProperties,n)}function qS(t,e,n,r,i,o={}){const a=t.Qu(o.merge||o.mergeFields?2:0,e,n,i);cv("Data must be an object, but it was:",a,r);const u=$S(r,a);let h,m;if(o.merge)h=new zn(a.fieldMask),m=a.fieldTransforms;else if(o.mergeFields){const y=[];for(const v of o.mergeFields){const w=ay(e,v,n);if(!a.contains(w))throw new ae(J.INVALID_ARGUMENT,`Field '${w}' is specified in your field mask but missing from your input data.`);WS(y,w)||y.push(w)}h=new zn(y),m=a.fieldTransforms.filter(v=>h.covers(v.field))}else h=null,m=a.fieldTransforms;return new rO(new fn(u),h,m)}class wm extends ec{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof wm}}function sO(t,e,n){return new vm({Cu:3,qu:e.settings.qu,methodName:t._methodName,xu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class av extends ec{_toFieldTransform(e){return new j_(e.path,new Dl)}isEqual(e){return e instanceof av}}class lv extends ec{constructor(e,n){super(e),this.Ku=n}_toFieldTransform(e){const n=sO(this,e,!0),r=this.Ku.map(o=>tc(o,n)),i=new Xo(r);return new j_(e.path,i)}isEqual(e){return e instanceof lv&&Nl(this.Ku,e.Ku)}}function oO(t,e,n,r){const i=t.Qu(1,e,n);cv("Data must be an object, but it was:",i,r);const o=[],a=fn.empty();da(r,(h,m)=>{const y=uv(e,h,n);m=Je(m);const v=i.Nu(y);if(m instanceof wm)o.push(y);else{const w=tc(m,v);w!=null&&(o.push(y),a.set(y,w))}});const u=new zn(o);return new BS(a,u,i.fieldTransforms)}function aO(t,e,n,r,i,o){const a=t.Qu(1,e,n),u=[ay(e,r,n)],h=[i];if(o.length%2!=0)throw new ae(J.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let w=0;w<o.length;w+=2)u.push(ay(e,o[w])),h.push(o[w+1]);const m=[],y=fn.empty();for(let w=u.length-1;w>=0;--w)if(!WS(m,u[w])){const S=u[w];let N=h[w];N=Je(N);const P=a.Nu(S);if(N instanceof wm)m.push(S);else{const F=tc(N,P);F!=null&&(m.push(S),y.set(S,F))}}const v=new zn(m);return new BS(y,v,a.fieldTransforms)}function lO(t,e,n,r=!1){return tc(n,t.Qu(r?4:3,e))}function tc(t,e){if(HS(t=Je(t)))return cv("Unsupported field value:",e,t),$S(t,e);if(t instanceof ec)return function(r,i){if(!zS(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const o=[];let a=0;for(const u of r){let h=tc(u,i.Lu(a));h==null&&(h={nullValue:"NULL_VALUE"}),o.push(h),a++}return{arrayValue:{values:o}}}(t,e)}return function(r,i){if((r=Je(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return XL(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const o=Ze.fromDate(r);return{timestampValue:Ol(i.serializer,o)}}if(r instanceof Ze){const o=new Ze(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ol(i.serializer,o)}}if(r instanceof ym)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ra)return{bytesValue:qk(i.serializer,r._byteString)};if(r instanceof sn){const o=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(o))throw i.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:V_(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof _m)return function(a,u){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(h=>{if(typeof h!="number")throw u.Bu("VectorValues must only contain numeric values.");return R_(u.serializer,h)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${gm(r)}`)}(t,e)}function $S(t,e){const n={};return hk(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):da(t,(r,i)=>{const o=tc(i,e.Mu(r));o!=null&&(n[r]=o)}),{mapValue:{fields:n}}}function HS(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ze||t instanceof ym||t instanceof ra||t instanceof sn||t instanceof ec||t instanceof _m)}function cv(t,e,n){if(!HS(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=gm(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function ay(t,e,n){if((e=Je(e))instanceof ld)return e._internalPath;if(typeof e=="string")return uv(t,e);throw Af("Field path arguments must be of type string or ",t,!1,void 0,n)}const cO=new RegExp("[~\\*/\\[\\]]");function uv(t,e,n){if(e.search(cO)>=0)throw Af(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new ld(...e.split("."))._internalPath}catch{throw Af(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Af(t,e,n,r,i){const o=r&&!r.isEmpty(),a=i!==void 0;let u=`Function ${e}() called with invalid data`;n&&(u+=" (via `toFirestore()`)"),u+=". ";let h="";return(o||a)&&(h+=" (found",o&&(h+=` in field ${r}`),a&&(h+=` in document ${i}`),h+=")"),new ae(J.INVALID_ARGUMENT,u+t+h)}function WS(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GS{constructor(e,n,r,i,o){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new sn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new uO(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(bm("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class uO extends GS{data(){return super.data()}}function bm(t,e){return typeof e=="string"?uv(t,e):e instanceof ld?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KS(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ae(J.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class dv{}class Im extends dv{}function Tm(t,e,...n){let r=[];e instanceof dv&&r.push(e),r=r.concat(n),function(o){const a=o.filter(h=>h instanceof Em).length,u=o.filter(h=>h instanceof cd).length;if(a>1||a>0&&u>0)throw new ae(J.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class cd extends Im{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new cd(e,n,r)}_apply(e){const n=this._parse(e);return YS(e._query,n),new bi(e.firestore,e.converter,Kg(e._query,n))}_parse(e){const n=xm(e.firestore);return function(o,a,u,h,m,y,v){let w;if(m.isKeyField()){if(y==="array-contains"||y==="array-contains-any")throw new ae(J.INVALID_ARGUMENT,`Invalid Query. You can't perform '${y}' queries on documentId().`);if(y==="in"||y==="not-in"){ob(v,y);const S=[];for(const N of v)S.push(sb(h,o,N));w={arrayValue:{values:S}}}else w=sb(h,o,v)}else y!=="in"&&y!=="not-in"&&y!=="array-contains-any"||ob(v,y),w=lO(u,a,v,y==="in"||y==="not-in");return $e.create(m,y,w)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function ZS(t,e,n){const r=e,i=bm("where",t);return cd._create(i,r,n)}class Em extends dv{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Em(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:rt.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,o){let a=i;const u=o.getFlattenedFilters();for(const h of u)YS(a,h),a=Kg(a,h)}(e._query,n),new bi(e.firestore,e.converter,Kg(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class km extends Im{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new km(e,n)}_apply(e){const n=function(i,o,a){if(i.startAt!==null)throw new ae(J.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new ae(J.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Vu(o,a)}(e._query,this._field,this._direction);return new bi(e.firestore,e.converter,function(i,o){const a=i.explicitOrderBy.concat([o]);return new Ql(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}function hv(t,e="asc"){const n=e,r=bm("orderBy",t);return km._create(r,n)}class Sm extends Im{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new Sm(e,n,r)}_apply(e){return new bi(e.firestore,e.converter,vf(e._query,this._limit,this._limitType))}}function QS(t){return Sm._create("limit",t,"F")}function sb(t,e,n){if(typeof(n=Je(n))=="string"){if(n==="")throw new ae(J.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ek(e)&&n.indexOf("/")!==-1)throw new ae(J.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(tt.fromString(n));if(!he.isDocumentKey(r))throw new ae(J.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Mu(t,new he(r))}if(n instanceof sn)return Mu(t,n._key);throw new ae(J.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${gm(n)}.`)}function ob(t,e){if(!Array.isArray(t)||t.length===0)throw new ae(J.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function YS(t,e){const n=function(i,o){for(const a of i)for(const u of a.getFlattenedFilters())if(o.indexOf(u.op)>=0)return u.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new ae(J.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ae(J.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class JS{convertValue(e,n="none"){switch(Yo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return _t(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(to(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ve()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return da(e,(i,o)=>{r[i]=this.convertValue(o,n)}),r}convertVectorValue(e){var n,r,i;const o=(i=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(a=>_t(a.doubleValue));return new _m(o)}convertGeoPoint(e){return new ym(_t(e.latitude),_t(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=N_(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Lu(e));default:return null}}convertTimestamp(e){const n=ns(e);return new Ze(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=tt.fromString(e);be(Xk(r));const i=new no(r.get(1),r.get(3)),o=new he(r.popFirst(5));return i.isEqual(n)||Ot(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XS(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ul{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class fv extends GS{constructor(e,n,r,i,o,a){super(e,n,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new cu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(bm("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class cu extends fv{data(e={}){return super.data(e)}}class mv{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new ul(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new cu(this._firestore,this._userDataWriter,r.key,r,new ul(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new ae(J.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(u=>{const h=new cu(i._firestore,i._userDataWriter,u.doc.key,u.doc,new ul(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:h,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>o||u.type!==3).map(u=>{const h=new cu(i._firestore,i._userDataWriter,u.doc.key,u.doc,new ul(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);let m=-1,y=-1;return u.type!==0&&(m=a.indexOf(u.doc.key),a=a.delete(u.doc.key)),u.type!==1&&(a=a.add(u.doc),y=a.indexOf(u.doc.key)),{type:dO(u.type),doc:h,oldIndex:m,newIndex:y}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function dO(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mo(t){t=Wn(t,sn);const e=Wn(t.firestore,xi);return XM(ad(e),t._key).then(n=>e1(e,t,n))}class pv extends JS{constructor(e){super(),this.firestore=e}convertBytes(e){return new ra(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new sn(this.firestore,null,n)}}function Ya(t){t=Wn(t,bi);const e=Wn(t.firestore,xi),n=ad(e),r=new pv(e);return KS(t._query),eO(n,t._query).then(i=>new mv(e,r,t,i))}function qr(t,e,n){t=Wn(t,sn);const r=Wn(t.firestore,xi),i=XS(t.converter,e,n);return dd(r,[qS(xm(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,mn.none())])}function zu(t,e,n,...r){t=Wn(t,sn);const i=Wn(t.firestore,xi),o=xm(i);let a;return a=typeof(e=Je(e))=="string"||e instanceof ld?aO(o,"updateDoc",t._key,e,n,r):oO(o,"updateDoc",t._key,e),dd(i,[a.toMutation(t._key,mn.exists(!0))])}function gv(t){return dd(Wn(t.firestore,xi),[new lm(t._key,mn.none())])}function ud(t,e){const n=Wn(t.firestore,xi),r=ut(t),i=XS(t.converter,e);return dd(n,[qS(xm(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,mn.exists(!1))]).then(()=>r)}function $i(t,...e){var n,r,i;t=Je(t);let o={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||ib(e[a])||(o=e[a],a++);const u={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(ib(e[a])){const v=e[a];e[a]=(n=v.next)===null||n===void 0?void 0:n.bind(v),e[a+1]=(r=v.error)===null||r===void 0?void 0:r.bind(v),e[a+2]=(i=v.complete)===null||i===void 0?void 0:i.bind(v)}let h,m,y;if(t instanceof sn)m=Wn(t.firestore,xi),y=nd(t._key.path),h={next:v=>{e[a]&&e[a](e1(m,t,v))},error:e[a+1],complete:e[a+2]};else{const v=Wn(t,bi);m=Wn(v.firestore,xi),y=v._query;const w=new pv(m);h={next:S=>{e[a]&&e[a](new mv(m,w,v,S))},error:e[a+1],complete:e[a+2]},KS(t._query)}return function(w,S,N,P){const F=new sv(P),R=new X_(S,F,N);return w.asyncQueue.enqueueAndForget(async()=>Q_(await Nf(w),R)),()=>{F.Za(),w.asyncQueue.enqueueAndForget(async()=>Y_(await Nf(w),R))}}(ad(m),y,u,h)}function dd(t,e){return function(r,i){const o=new _i;return r.asyncQueue.enqueueAndForget(async()=>DM(await JM(r),i,o)),o.promise}(ad(t),e)}function e1(t,e,n){const r=n.docs.get(e._key),i=new pv(t);return new fv(t,i,e._key,r,new ul(n.hasPendingWrites,n.fromCache),e.converter)}class hO{constructor(e){let n;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),n=e.tabManager):(n=n1(),n._initialize(e)),this._onlineComponentProvider=n._onlineComponentProvider,this._offlineComponentProvider=n._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function t1(t){return new hO(t)}class fO{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Bu.provider,this._offlineComponentProvider={build:n=>new DS(n,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class mO{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Bu.provider,this._offlineComponentProvider={build:n=>new ZM(n,e==null?void 0:e.cacheSizeBytes)}}}function n1(t){return new fO(void 0)}function r1(){return new mO}function yv(){return new av("serverTimestamp")}function i1(...t){return new lv("arrayRemove",t)}(function(e,n=!0){(function(i){Zl=i})(ua),Er(new or("firestore",(r,{instanceIdentifier:i,options:o})=>{const a=r.getProvider("app").getImmediate(),u=new xi(new sL(r.getProvider("auth-internal")),new cL(r.getProvider("app-check-internal")),function(m,y){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new ae(J.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new no(m.options.projectId,y)}(a,i),a);return o=Object.assign({useFetchStreams:n},o),u._setSettings(o),u},"PUBLIC").setMultipleInstances(!0)),pn(Jx,"4.7.3",e),pn(Jx,"4.7.3","esm2017")})();const ab=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:JS,Bytes:ra,CollectionReference:Zi,DocumentReference:sn,DocumentSnapshot:fv,FieldPath:ld,FieldValue:ec,Firestore:xi,FirestoreError:ae,GeoPoint:ym,Query:bi,QueryCompositeFilterConstraint:Em,QueryConstraint:Im,QueryDocumentSnapshot:cu,QueryFieldFilterConstraint:cd,QueryLimitConstraint:Sm,QueryOrderByConstraint:km,QuerySnapshot:mv,SnapshotMetadata:ul,Timestamp:Ze,VectorValue:_m,_AutoId:T_,_ByteString:Rt,_DatabaseId:no,_DocumentKey:he,_EmptyAuthCredentialsProvider:ek,_FieldPath:xt,_cast:Wn,_logWarn:Al,_validateIsNotUsedTogether:FS,addDoc:ud,arrayRemove:i1,collection:En,deleteDoc:gv,doc:ut,ensureFirestoreConfigured:ad,executeWrite:dd,getDoc:Mo,getDocs:Ya,initializeFirestore:US,limit:QS,onSnapshot:$i,orderBy:hv,persistentLocalCache:t1,persistentMultipleTabManager:r1,persistentSingleTabManager:n1,query:Tm,serverTimestamp:yv,setDoc:qr,updateDoc:zu,where:ZS},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pO="type.googleapis.com/google.protobuf.Int64Value",gO="type.googleapis.com/google.protobuf.UInt64Value";function s1(t,e){const n={};for(const r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}function ly(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>ly(e));if(typeof t=="function"||typeof t=="object")return s1(t,e=>ly(e));throw new Error("Data cannot be encoded in JSON: "+t)}function Cf(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case pO:case gO:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>Cf(e)):typeof t=="function"||typeof t=="object"?s1(t,e=>Cf(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _v="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lb={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class wl extends Sr{constructor(e,n,r){super(`${_v}/${e}`,n||""),this.details=r}}function yO(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function _O(t,e){let n=yO(t),r=n,i;try{const o=e&&e.error;if(o){const a=o.status;if(typeof a=="string"){if(!lb[a])return new wl("internal","internal");n=lb[a],r=a}const u=o.message;typeof u=="string"&&(r=u),i=o.details,i!==void 0&&(i=Cf(i))}}catch{}return n==="ok"?null:new wl(n,r,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vO{constructor(e,n,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(i=>this.auth=i,()=>{}),this.messaging||n.get().then(i=>this.messaging=i,()=>{}),this.appCheck||r.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),i=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:i}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cy="us-central1";function xO(t){let e=null;return{promise:new Promise((n,r)=>{e=setTimeout(()=>{r(new wl("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class wO{constructor(e,n,r,i,o=cy,a){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new vO(n,r,i),this.cancelAllRequests=new Promise(u=>{this.deleteService=()=>Promise.resolve(u())});try{const u=new URL(o);this.customDomain=u.origin+(u.pathname==="/"?"":u.pathname),this.region=cy}catch{this.customDomain=null,this.region=o}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function bO(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}function IO(t,e,n){return r=>EO(t,e,r,{})}async function TO(t,e,n,r){n["Content-Type"]="application/json";let i;try{i=await r(t,{method:"POST",body:JSON.stringify(e),headers:n})}catch{return{status:0,json:null}}let o=null;try{o=await i.json()}catch{}return{status:i.status,json:o}}function EO(t,e,n,r){const i=t._url(e);return kO(t,i,n,r)}async function kO(t,e,n,r){n=ly(n);const i={data:n},o={},a=await t.contextProvider.getContext(r.limitedUseAppCheckTokens);a.authToken&&(o.Authorization="Bearer "+a.authToken),a.messagingToken&&(o["Firebase-Instance-ID-Token"]=a.messagingToken),a.appCheckToken!==null&&(o["X-Firebase-AppCheck"]=a.appCheckToken);const u=r.timeout||7e4,h=xO(u),m=await Promise.race([TO(e,i,o,t.fetchImpl),h.promise,t.cancelAllRequests]);if(h.cancel(),!m)throw new wl("cancelled","Firebase Functions instance was deleted.");const y=_O(m.status,m.json);if(y)throw y;if(!m.json)throw new wl("internal","Response is not valid JSON object.");let v=m.json.data;if(typeof v>"u"&&(v=m.json.result),typeof v>"u")throw new wl("internal","Response is missing data field.");return{data:Cf(v)}}const cb="@firebase/functions",ub="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SO="auth-internal",PO="app-check-internal",NO="messaging-internal";function AO(t,e){const n=(r,{instanceIdentifier:i})=>{const o=r.getProvider("app").getImmediate(),a=r.getProvider(SO),u=r.getProvider(NO),h=r.getProvider(PO);return new wO(o,a,u,h,i,t)};Er(new or(_v,n,"PUBLIC").setMultipleInstances(!0)),pn(cb,ub,e),pn(cb,ub,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ci(t=Jf(),e=cy){const r=lo(Je(t),_v).getImmediate({identifier:e}),i=tE("functions");return i&&CO(r,...i),r}function CO(t,e,n){bO(Je(t),e,n)}function ui(t,e,n){return IO(Je(t),e)}AO(fetch.bind(self));var RO="firebase",jO="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */pn(RO,jO,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o1="firebasestorage.googleapis.com",a1="storageBucket",LO=2*60*1e3,DO=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt extends Sr{constructor(e,n,r=0){super(Ap(e),`Firebase Storage: ${n} (${Ap(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Lt.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Ap(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var jt;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(jt||(jt={}));function Ap(t){return"storage/"+t}function vv(){const t="An unknown error occurred, please check the error payload for server response.";return new Lt(jt.UNKNOWN,t)}function MO(t){return new Lt(jt.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function OO(t){return new Lt(jt.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function VO(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Lt(jt.UNAUTHENTICATED,t)}function FO(){return new Lt(jt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function UO(t){return new Lt(jt.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function BO(){return new Lt(jt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function zO(){return new Lt(jt.CANCELED,"User canceled the upload/download.")}function qO(t){return new Lt(jt.INVALID_URL,"Invalid URL '"+t+"'.")}function $O(t){return new Lt(jt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function HO(){return new Lt(jt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+a1+"' property when initializing the app?")}function WO(){return new Lt(jt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function GO(){return new Lt(jt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function KO(t){return new Lt(jt.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function uy(t){return new Lt(jt.INVALID_ARGUMENT,t)}function l1(){return new Lt(jt.APP_DELETED,"The Firebase app was deleted.")}function ZO(t){return new Lt(jt.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function uu(t,e){return new Lt(jt.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function Lc(t){throw new Lt(jt.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nr{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=nr.makeFromUrl(e,n)}catch{return new nr(e,"")}if(r.path==="")return r;throw $O(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)";function o(z){z.path.charAt(z.path.length-1)==="/"&&(z.path_=z.path_.slice(0,-1))}const a="(/(.*))?$",u=new RegExp("^gs://"+i+a,"i"),h={bucket:1,path:3};function m(z){z.path_=decodeURIComponent(z.path)}const y="v[A-Za-z0-9_]+",v=n.replace(/[.]/g,"\\."),w="(/([^?#]*).*)?$",S=new RegExp(`^https?://${v}/${y}/b/${i}/o${w}`,"i"),N={bucket:1,path:3},P=n===o1?"(?:storage.googleapis.com|storage.cloud.google.com)":n,F="([^?#]*)",R=new RegExp(`^https?://${P}/${i}/${F}`,"i"),A=[{regex:u,indices:h,postModify:o},{regex:S,indices:N,postModify:m},{regex:R,indices:{bucket:1,path:2},postModify:m}];for(let z=0;z<A.length;z++){const G=A[z],W=G.regex.exec(e);if(W){const T=W[G.indices.bucket];let b=W[G.indices.path];b||(b=""),r=new nr(T,b),G.postModify(r);break}}if(r==null)throw qO(e);return r}}class QO{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YO(t,e,n){let r=1,i=null,o=null,a=!1,u=0;function h(){return u===2}let m=!1;function y(...F){m||(m=!0,e.apply(null,F))}function v(F){i=setTimeout(()=>{i=null,t(S,h())},F)}function w(){o&&clearTimeout(o)}function S(F,...R){if(m){w();return}if(F){w(),y.call(null,F,...R);return}if(h()||a){w(),y.call(null,F,...R);return}r<64&&(r*=2);let A;u===1?(u=2,A=0):A=(r+Math.random())*1e3,v(A)}let N=!1;function P(F){N||(N=!0,w(),!m&&(i!==null?(F||(u=2),clearTimeout(i),v(0)):F||(u=1)))}return v(0),o=setTimeout(()=>{a=!0,P(!0)},n),P}function JO(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XO(t){return t!==void 0}function e4(t){return typeof t=="object"&&!Array.isArray(t)}function xv(t){return typeof t=="string"||t instanceof String}function db(t){return wv()&&t instanceof Blob}function wv(){return typeof Blob<"u"}function hb(t,e,n,r){if(r<e)throw uy(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw uy(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pm(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function c1(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var zo;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(zo||(zo={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t4(t,e){const n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,o=e.indexOf(t)!==-1;return n||i||o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n4{constructor(e,n,r,i,o,a,u,h,m,y,v,w=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=o,this.additionalRetryCodes_=a,this.callback_=u,this.errorCallback_=h,this.timeout_=m,this.progressCallback_=y,this.connectionFactory_=v,this.retry=w,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((S,N)=>{this.resolve_=S,this.reject_=N,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new rh(!1,null,!0));return}const o=this.connectionFactory_();this.pendingConnection_=o;const a=u=>{const h=u.loaded,m=u.lengthComputable?u.total:-1;this.progressCallback_!==null&&this.progressCallback_(h,m)};this.progressCallback_!==null&&o.addUploadProgressListener(a),o.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&o.removeUploadProgressListener(a),this.pendingConnection_=null;const u=o.getErrorCode()===zo.NO_ERROR,h=o.getStatus();if(!u||t4(h,this.additionalRetryCodes_)&&this.retry){const y=o.getErrorCode()===zo.ABORT;r(!1,new rh(!1,null,y));return}const m=this.successCodes_.indexOf(h)!==-1;r(!0,new rh(m,o))})},n=(r,i)=>{const o=this.resolve_,a=this.reject_,u=i.connection;if(i.wasSuccessCode)try{const h=this.callback_(u,u.getResponse());XO(h)?o(h):o()}catch(h){a(h)}else if(u!==null){const h=vv();h.serverResponse=u.getErrorText(),this.errorCallback_?a(this.errorCallback_(u,h)):a(h)}else if(i.canceled){const h=this.appDelete_?l1():zO();a(h)}else{const h=BO();a(h)}};this.canceled_?n(!1,new rh(!1,null,!0)):this.backoffId_=YO(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&JO(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class rh{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function r4(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function i4(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function s4(t,e){e&&(t["X-Firebase-GMPID"]=e)}function o4(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function a4(t,e,n,r,i,o,a=!0){const u=c1(t.urlParams),h=t.url+u,m=Object.assign({},t.headers);return s4(m,e),r4(m,n),i4(m,o),o4(m,r),new n4(h,t.method,m,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l4(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function c4(...t){const e=l4();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(wv())return new Blob(t);throw new Lt(jt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function u4(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d4(t){if(typeof atob>"u")throw KO("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mi={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Cp{constructor(e,n){this.data=e,this.contentType=n||null}}function h4(t,e){switch(t){case mi.RAW:return new Cp(u1(e));case mi.BASE64:case mi.BASE64URL:return new Cp(d1(t,e));case mi.DATA_URL:return new Cp(m4(e),p4(e))}throw vv()}function u1(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const o=r,a=t.charCodeAt(++n);r=65536|(o&1023)<<10|a&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function f4(t){let e;try{e=decodeURIComponent(t)}catch{throw uu(mi.DATA_URL,"Malformed data URL.")}return u1(e)}function d1(t,e){switch(t){case mi.BASE64:{const i=e.indexOf("-")!==-1,o=e.indexOf("_")!==-1;if(i||o)throw uu(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case mi.BASE64URL:{const i=e.indexOf("+")!==-1,o=e.indexOf("/")!==-1;if(i||o)throw uu(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=d4(e)}catch(i){throw i.message.includes("polyfill")?i:uu(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}class h1{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw uu(mi.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=g4(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function m4(t){const e=new h1(t);return e.base64?d1(mi.BASE64,e.rest):f4(e.rest)}function p4(t){return new h1(t).contentType}function g4(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Os{constructor(e,n){let r=0,i="";db(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,n){if(db(this.data_)){const r=this.data_,i=u4(r,e,n);return i===null?null:new Os(i)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Os(r,!0)}}static getBlob(...e){if(wv()){const n=e.map(r=>r instanceof Os?r.data_:r);return new Os(c4.apply(null,n))}else{const n=e.map(a=>xv(a)?h4(mi.RAW,a).data:a.data_);let r=0;n.forEach(a=>{r+=a.byteLength});const i=new Uint8Array(r);let o=0;return n.forEach(a=>{for(let u=0;u<a.length;u++)i[o++]=a[u]}),new Os(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f1(t){let e;try{e=JSON.parse(t)}catch{return null}return e4(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y4(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function _4(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function m1(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v4(t,e){return e}class In{constructor(e,n,r,i){this.server=e,this.local=n||e,this.writable=!!r,this.xform=i||v4}}let ih=null;function x4(t){return!xv(t)||t.length<2?t:m1(t)}function p1(){if(ih)return ih;const t=[];t.push(new In("bucket")),t.push(new In("generation")),t.push(new In("metageneration")),t.push(new In("name","fullPath",!0));function e(o,a){return x4(a)}const n=new In("name");n.xform=e,t.push(n);function r(o,a){return a!==void 0?Number(a):a}const i=new In("size");return i.xform=r,t.push(i),t.push(new In("timeCreated")),t.push(new In("updated")),t.push(new In("md5Hash",null,!0)),t.push(new In("cacheControl",null,!0)),t.push(new In("contentDisposition",null,!0)),t.push(new In("contentEncoding",null,!0)),t.push(new In("contentLanguage",null,!0)),t.push(new In("contentType",null,!0)),t.push(new In("metadata","customMetadata",!0)),ih=t,ih}function w4(t,e){function n(){const r=t.bucket,i=t.fullPath,o=new nr(r,i);return e._makeStorageReference(o)}Object.defineProperty(t,"ref",{get:n})}function b4(t,e,n){const r={};r.type="file";const i=n.length;for(let o=0;o<i;o++){const a=n[o];r[a.local]=a.xform(r,e[a.server])}return w4(r,t),r}function g1(t,e,n){const r=f1(e);return r===null?null:b4(t,r,n)}function I4(t,e,n,r){const i=f1(e);if(i===null||!xv(i.downloadTokens))return null;const o=i.downloadTokens;if(o.length===0)return null;const a=encodeURIComponent;return o.split(",").map(m=>{const y=t.bucket,v=t.fullPath,w="/b/"+a(y)+"/o/"+a(v),S=Pm(w,n,r),N=c1({alt:"media",token:m});return S+N})[0]}function T4(t,e){const n={},r=e.length;for(let i=0;i<r;i++){const o=e[i];o.writable&&(n[o.server]=t[o.local])}return JSON.stringify(n)}class bv{constructor(e,n,r,i){this.url=e,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y1(t){if(!t)throw vv()}function E4(t,e){function n(r,i){const o=g1(t,i,e);return y1(o!==null),o}return n}function k4(t,e){function n(r,i){const o=g1(t,i,e);return y1(o!==null),I4(o,i,t.host,t._protocol)}return n}function _1(t){function e(n,r){let i;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?i=FO():i=VO():n.getStatus()===402?i=OO(t.bucket):n.getStatus()===403?i=UO(t.path):i=r,i.status=n.getStatus(),i.serverResponse=r.serverResponse,i}return e}function v1(t){const e=_1(t);function n(r,i){let o=e(r,i);return r.getStatus()===404&&(o=MO(t.path)),o.serverResponse=i.serverResponse,o}return n}function S4(t,e,n){const r=e.fullServerUrl(),i=Pm(r,t.host,t._protocol),o="GET",a=t.maxOperationRetryTime,u=new bv(i,o,k4(t,n),a);return u.errorHandler=v1(e),u}function P4(t,e){const n=e.fullServerUrl(),r=Pm(n,t.host,t._protocol),i="DELETE",o=t.maxOperationRetryTime;function a(h,m){}const u=new bv(r,i,a,o);return u.successCodes=[200,204],u.errorHandler=v1(e),u}function N4(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function A4(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=N4(null,e)),r}function C4(t,e,n,r,i){const o=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};function u(){let A="";for(let z=0;z<2;z++)A=A+Math.random().toString().slice(2);return A}const h=u();a["Content-Type"]="multipart/related; boundary="+h;const m=A4(e,r,i),y=T4(m,n),v="--"+h+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+y+`\r
--`+h+`\r
Content-Type: `+m.contentType+`\r
\r
`,w=`\r
--`+h+"--",S=Os.getBlob(v,r,w);if(S===null)throw WO();const N={name:m.fullPath},P=Pm(o,t.host,t._protocol),F="POST",R=t.maxUploadRetryTime,k=new bv(P,F,E4(t,n),R);return k.urlParams=N,k.headers=a,k.body=S.uploadData(),k.errorHandler=_1(e),k}class R4{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=zo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=zo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=zo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,i){if(this.sent_)throw Lc("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Lc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Lc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Lc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Lc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class j4 extends R4{initXhr(){this.xhr_.responseType="text"}}function Iv(){return new j4}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ia{constructor(e,n){this._service=e,n instanceof nr?this._location=n:this._location=nr.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new ia(e,n)}get root(){const e=new nr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return m1(this._location.path)}get storage(){return this._service}get parent(){const e=y4(this._location.path);if(e===null)return null;const n=new nr(this._location.bucket,e);return new ia(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw ZO(e)}}function L4(t,e,n){t._throwIfRoot("uploadBytes");const r=C4(t.storage,t._location,p1(),new Os(e,!0),n);return t.storage.makeRequestWithTokens(r,Iv).then(i=>({metadata:i,ref:t}))}function D4(t){t._throwIfRoot("getDownloadURL");const e=S4(t.storage,t._location,p1());return t.storage.makeRequestWithTokens(e,Iv).then(n=>{if(n===null)throw GO();return n})}function M4(t){t._throwIfRoot("deleteObject");const e=P4(t.storage,t._location);return t.storage.makeRequestWithTokens(e,Iv)}function O4(t,e){const n=_4(t._location.path,e),r=new nr(t._location.bucket,n);return new ia(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V4(t){return/^[A-Za-z]+:\/\//.test(t)}function F4(t,e){return new ia(t,e)}function x1(t,e){if(t instanceof Tv){const n=t;if(n._bucket==null)throw HO();const r=new ia(n,n._bucket);return e!=null?x1(r,e):r}else return e!==void 0?O4(t,e):t}function U4(t,e){if(e&&V4(e)){if(t instanceof Tv)return F4(t,e);throw uy("To use ref(service, url), the first argument must be a Storage instance.")}else return x1(t,e)}function fb(t,e){const n=e==null?void 0:e[a1];return n==null?null:nr.makeFromBucketSpec(n,t)}function B4(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:wC(i,t.app.options.projectId))}class Tv{constructor(e,n,r,i,o){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=o,this._bucket=null,this._host=o1,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=LO,this._maxUploadRetryTime=DO,this._requests=new Set,i!=null?this._bucket=nr.makeFromBucketSpec(i,this._host):this._bucket=fb(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=nr.makeFromBucketSpec(this._url,e):this._bucket=fb(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){hb("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){hb("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ia(this,e)}_makeRequest(e,n,r,i,o=!0){if(this._deleted)return new QO(l1());{const a=a4(e,this._appId,r,i,n,this._firebaseVersion,o);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,n){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()}}const mb="@firebase/storage",pb="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w1="storage";function Nm(t,e,n){return t=Je(t),L4(t,e,n)}function Am(t){return t=Je(t),D4(t)}function b1(t){return t=Je(t),M4(t)}function zl(t,e){return t=Je(t),U4(t,e)}function z4(t=Jf(),e){t=Je(t);const r=lo(t,w1).getImmediate({identifier:e}),i=tE("storage");return i&&q4(r,...i),r}function q4(t,e,n,r={}){B4(t,e,n,r)}function $4(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new Tv(n,r,i,e,ua)}function H4(){Er(new or(w1,$4,"PUBLIC").setMultipleInstances(!0)),pn(mb,pb,""),pn(mb,pb,"esm2017")}H4();const I1="@firebase/installations",Ev="0.6.9";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T1=1e4,E1=`w:${Ev}`,k1="FIS_v2",W4="https://firebaseinstallations.googleapis.com/v1",G4=60*60*1e3,K4="installations",Z4="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q4={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},sa=new ca(K4,Z4,Q4);function S1(t){return t instanceof Sr&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P1({projectId:t}){return`${W4}/projects/${t}/installations`}function N1(t){return{token:t.token,requestStatus:2,expiresIn:J4(t.expiresIn),creationTime:Date.now()}}async function A1(t,e){const r=(await e.json()).error;return sa.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function C1({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function Y4(t,{refreshToken:e}){const n=C1(t);return n.append("Authorization",X4(e)),n}async function R1(t){const e=await t();return e.status>=500&&e.status<600?t():e}function J4(t){return Number(t.replace("s","000"))}function X4(t){return`${k1} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eV({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=P1(t),i=C1(t),o=e.getImmediate({optional:!0});if(o){const m=await o.getHeartbeatsHeader();m&&i.append("x-firebase-client",m)}const a={fid:n,authVersion:k1,appId:t.appId,sdkVersion:E1},u={method:"POST",headers:i,body:JSON.stringify(a)},h=await R1(()=>fetch(r,u));if(h.ok){const m=await h.json();return{fid:m.fid||n,registrationStatus:2,refreshToken:m.refreshToken,authToken:N1(m.authToken)}}else throw await A1("Create Installation",h)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j1(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tV(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nV=/^[cdef][\w-]{21}$/,dy="";function rV(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=iV(t);return nV.test(n)?n:dy}catch{return dy}}function iV(t){return tV(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cm(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L1=new Map;function D1(t,e){const n=Cm(t);M1(n,e),sV(n,e)}function M1(t,e){const n=L1.get(t);if(n)for(const r of n)r(e)}function sV(t,e){const n=oV();n&&n.postMessage({key:t,fid:e}),aV()}let Oo=null;function oV(){return!Oo&&"BroadcastChannel"in self&&(Oo=new BroadcastChannel("[Firebase] FID Change"),Oo.onmessage=t=>{M1(t.data.key,t.data.fid)}),Oo}function aV(){L1.size===0&&Oo&&(Oo.close(),Oo=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lV="firebase-installations-database",cV=1,oa="firebase-installations-store";let Rp=null;function kv(){return Rp||(Rp=Yf(lV,cV,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(oa)}}})),Rp}async function Rf(t,e){const n=Cm(t),i=(await kv()).transaction(oa,"readwrite"),o=i.objectStore(oa),a=await o.get(n);return await o.put(e,n),await i.done,(!a||a.fid!==e.fid)&&D1(t,e.fid),e}async function O1(t){const e=Cm(t),r=(await kv()).transaction(oa,"readwrite");await r.objectStore(oa).delete(e),await r.done}async function Rm(t,e){const n=Cm(t),i=(await kv()).transaction(oa,"readwrite"),o=i.objectStore(oa),a=await o.get(n),u=e(a);return u===void 0?await o.delete(n):await o.put(u,n),await i.done,u&&(!a||a.fid!==u.fid)&&D1(t,u.fid),u}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sv(t){let e;const n=await Rm(t.appConfig,r=>{const i=uV(r),o=dV(t,i);return e=o.registrationPromise,o.installationEntry});return n.fid===dy?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function uV(t){const e=t||{fid:rV(),registrationStatus:0};return V1(e)}function dV(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(sa.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=hV(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:fV(t)}:{installationEntry:e}}async function hV(t,e){try{const n=await eV(t,e);return Rf(t.appConfig,n)}catch(n){throw S1(n)&&n.customData.serverCode===409?await O1(t.appConfig):await Rf(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function fV(t){let e=await gb(t.appConfig);for(;e.registrationStatus===1;)await j1(100),e=await gb(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await Sv(t);return r||n}return e}function gb(t){return Rm(t,e=>{if(!e)throw sa.create("installation-not-found");return V1(e)})}function V1(t){return mV(t)?{fid:t.fid,registrationStatus:0}:t}function mV(t){return t.registrationStatus===1&&t.registrationTime+T1<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pV({appConfig:t,heartbeatServiceProvider:e},n){const r=gV(t,n),i=Y4(t,n),o=e.getImmediate({optional:!0});if(o){const m=await o.getHeartbeatsHeader();m&&i.append("x-firebase-client",m)}const a={installation:{sdkVersion:E1,appId:t.appId}},u={method:"POST",headers:i,body:JSON.stringify(a)},h=await R1(()=>fetch(r,u));if(h.ok){const m=await h.json();return N1(m)}else throw await A1("Generate Auth Token",h)}function gV(t,{fid:e}){return`${P1(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pv(t,e=!1){let n;const r=await Rm(t.appConfig,o=>{if(!F1(o))throw sa.create("not-registered");const a=o.authToken;if(!e&&vV(a))return o;if(a.requestStatus===1)return n=yV(t,e),o;{if(!navigator.onLine)throw sa.create("app-offline");const u=wV(o);return n=_V(t,u),u}});return n?await n:r.authToken}async function yV(t,e){let n=await yb(t.appConfig);for(;n.authToken.requestStatus===1;)await j1(100),n=await yb(t.appConfig);const r=n.authToken;return r.requestStatus===0?Pv(t,e):r}function yb(t){return Rm(t,e=>{if(!F1(e))throw sa.create("not-registered");const n=e.authToken;return bV(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function _V(t,e){try{const n=await pV(t,e),r=Object.assign(Object.assign({},e),{authToken:n});return await Rf(t.appConfig,r),n}catch(n){if(S1(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await O1(t.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Rf(t.appConfig,r)}throw n}}function F1(t){return t!==void 0&&t.registrationStatus===2}function vV(t){return t.requestStatus===2&&!xV(t)}function xV(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+G4}function wV(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function bV(t){return t.requestStatus===1&&t.requestTime+T1<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IV(t){const e=t,{installationEntry:n,registrationPromise:r}=await Sv(e);return r?r.catch(console.error):Pv(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TV(t,e=!1){const n=t;return await EV(n),(await Pv(n,e)).token}async function EV(t){const{registrationPromise:e}=await Sv(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kV(t){if(!t||!t.options)throw jp("App Configuration");if(!t.name)throw jp("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw jp(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function jp(t){return sa.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U1="installations",SV="installations-internal",PV=t=>{const e=t.getProvider("app").getImmediate(),n=kV(e),r=lo(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},NV=t=>{const e=t.getProvider("app").getImmediate(),n=lo(e,U1).getImmediate();return{getId:()=>IV(n),getToken:i=>TV(n,i)}};function AV(){Er(new or(U1,PV,"PUBLIC")),Er(new or(SV,NV,"PRIVATE"))}AV();pn(I1,Ev);pn(I1,Ev,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CV="/firebase-messaging-sw.js",RV="/firebase-cloud-messaging-push-scope",B1="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",jV="https://fcmregistrations.googleapis.com/v1",z1="google.c.a.c_id",LV="google.c.a.c_l",DV="google.c.a.ts",MV="google.c.a.e";var _b;(function(t){t[t.DATA_MESSAGE=1]="DATA_MESSAGE",t[t.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(_b||(_b={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var qu;(function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"})(qu||(qu={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Li(t){const e=new Uint8Array(t);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function OV(t){const e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(n),i=new Uint8Array(r.length);for(let o=0;o<r.length;++o)i[o]=r.charCodeAt(o);return i}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lp="fcm_token_details_db",VV=5,vb="fcm_token_object_Store";async function FV(t){if("databases"in indexedDB&&!(await indexedDB.databases()).map(o=>o.name).includes(Lp))return null;let e=null;return(await Yf(Lp,VV,{upgrade:async(r,i,o,a)=>{var u;if(i<2||!r.objectStoreNames.contains(vb))return;const h=a.objectStore(vb),m=await h.index("fcmSenderId").get(t);if(await h.clear(),!!m){if(i===2){const y=m;if(!y.auth||!y.p256dh||!y.endpoint)return;e={token:y.fcmToken,createTime:(u=y.createTime)!==null&&u!==void 0?u:Date.now(),subscriptionOptions:{auth:y.auth,p256dh:y.p256dh,endpoint:y.endpoint,swScope:y.swScope,vapidKey:typeof y.vapidKey=="string"?y.vapidKey:Li(y.vapidKey)}}}else if(i===3){const y=m;e={token:y.fcmToken,createTime:y.createTime,subscriptionOptions:{auth:Li(y.auth),p256dh:Li(y.p256dh),endpoint:y.endpoint,swScope:y.swScope,vapidKey:Li(y.vapidKey)}}}else if(i===4){const y=m;e={token:y.fcmToken,createTime:y.createTime,subscriptionOptions:{auth:Li(y.auth),p256dh:Li(y.p256dh),endpoint:y.endpoint,swScope:y.swScope,vapidKey:Li(y.vapidKey)}}}}}})).close(),await vp(Lp),await vp("fcm_vapid_details_db"),await vp("undefined"),UV(e)?e:null}function UV(t){if(!t||!t.subscriptionOptions)return!1;const{subscriptionOptions:e}=t;return typeof t.createTime=="number"&&t.createTime>0&&typeof t.token=="string"&&t.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BV="firebase-messaging-database",zV=1,$u="firebase-messaging-store";let Dp=null;function q1(){return Dp||(Dp=Yf(BV,zV,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore($u)}}})),Dp}async function qV(t){const e=$1(t),r=await(await q1()).transaction($u).objectStore($u).get(e);if(r)return r;{const i=await FV(t.appConfig.senderId);if(i)return await Nv(t,i),i}}async function Nv(t,e){const n=$1(t),i=(await q1()).transaction($u,"readwrite");return await i.objectStore($u).put(e,n),await i.done,e}function $1({appConfig:t}){return t.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $V={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},gn=new ca("messaging","Messaging",$V);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HV(t,e){const n=await Cv(t),r=H1(e),i={method:"POST",headers:n,body:JSON.stringify(r)};let o;try{o=await(await fetch(Av(t.appConfig),i)).json()}catch(a){throw gn.create("token-subscribe-failed",{errorInfo:a==null?void 0:a.toString()})}if(o.error){const a=o.error.message;throw gn.create("token-subscribe-failed",{errorInfo:a})}if(!o.token)throw gn.create("token-subscribe-no-token");return o.token}async function WV(t,e){const n=await Cv(t),r=H1(e.subscriptionOptions),i={method:"PATCH",headers:n,body:JSON.stringify(r)};let o;try{o=await(await fetch(`${Av(t.appConfig)}/${e.token}`,i)).json()}catch(a){throw gn.create("token-update-failed",{errorInfo:a==null?void 0:a.toString()})}if(o.error){const a=o.error.message;throw gn.create("token-update-failed",{errorInfo:a})}if(!o.token)throw gn.create("token-update-no-token");return o.token}async function GV(t,e){const r={method:"DELETE",headers:await Cv(t)};try{const o=await(await fetch(`${Av(t.appConfig)}/${e}`,r)).json();if(o.error){const a=o.error.message;throw gn.create("token-unsubscribe-failed",{errorInfo:a})}}catch(i){throw gn.create("token-unsubscribe-failed",{errorInfo:i==null?void 0:i.toString()})}}function Av({projectId:t}){return`${jV}/projects/${t}/registrations`}async function Cv({appConfig:t,installations:e}){const n=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function H1({p256dh:t,auth:e,endpoint:n,vapidKey:r}){const i={web:{endpoint:n,auth:e,p256dh:t}};return r!==B1&&(i.web.applicationPubKey=r),i}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KV=7*24*60*60*1e3;async function ZV(t){const e=await YV(t.swRegistration,t.vapidKey),n={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:e.endpoint,auth:Li(e.getKey("auth")),p256dh:Li(e.getKey("p256dh"))},r=await qV(t.firebaseDependencies);if(r){if(JV(r.subscriptionOptions,n))return Date.now()>=r.createTime+KV?QV(t,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await GV(t.firebaseDependencies,r.token)}catch(i){console.warn(i)}return xb(t.firebaseDependencies,n)}else return xb(t.firebaseDependencies,n)}async function QV(t,e){try{const n=await WV(t.firebaseDependencies,e),r=Object.assign(Object.assign({},e),{token:n,createTime:Date.now()});return await Nv(t.firebaseDependencies,r),n}catch(n){throw n}}async function xb(t,e){const r={token:await HV(t,e),createTime:Date.now(),subscriptionOptions:e};return await Nv(t,r),r.token}async function YV(t,e){const n=await t.pushManager.getSubscription();return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:OV(e)})}function JV(t,e){const n=e.vapidKey===t.vapidKey,r=e.endpoint===t.endpoint,i=e.auth===t.auth,o=e.p256dh===t.p256dh;return n&&r&&i&&o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wb(t){const e={from:t.from,collapseKey:t.collapse_key,messageId:t.fcmMessageId};return XV(e,t),e5(e,t),t5(e,t),e}function XV(t,e){if(!e.notification)return;t.notification={};const n=e.notification.title;n&&(t.notification.title=n);const r=e.notification.body;r&&(t.notification.body=r);const i=e.notification.image;i&&(t.notification.image=i);const o=e.notification.icon;o&&(t.notification.icon=o)}function e5(t,e){e.data&&(t.data=e.data)}function t5(t,e){var n,r,i,o,a;if(!e.fcmOptions&&!(!((n=e.notification)===null||n===void 0)&&n.click_action))return;t.fcmOptions={};const u=(i=(r=e.fcmOptions)===null||r===void 0?void 0:r.link)!==null&&i!==void 0?i:(o=e.notification)===null||o===void 0?void 0:o.click_action;u&&(t.fcmOptions.link=u);const h=(a=e.fcmOptions)===null||a===void 0?void 0:a.analytics_label;h&&(t.fcmOptions.analyticsLabel=h)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n5(t){return typeof t=="object"&&!!t&&z1 in t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r5(t){if(!t||!t.options)throw Mp("App Configuration Object");if(!t.name)throw Mp("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:n}=t;for(const r of e)if(!n[r])throw Mp(r);return{appName:t.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}function Mp(t){return gn.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i5{constructor(e,n,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const i=r5(e);this.firebaseDependencies={app:e,appConfig:i,installations:n,analyticsProvider:r}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function s5(t){try{t.swRegistration=await navigator.serviceWorker.register(CV,{scope:RV}),t.swRegistration.update().catch(()=>{})}catch(e){throw gn.create("failed-service-worker-registration",{browserErrorMessage:e==null?void 0:e.message})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function o5(t,e){if(!e&&!t.swRegistration&&await s5(t),!(!e&&t.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw gn.create("invalid-sw-registration");t.swRegistration=e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function a5(t,e){e?t.vapidKey=e:t.vapidKey||(t.vapidKey=B1)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function W1(t,e){if(!navigator)throw gn.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw gn.create("permission-blocked");return await a5(t,e==null?void 0:e.vapidKey),await o5(t,e==null?void 0:e.serviceWorkerRegistration),ZV(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function l5(t,e,n){const r=c5(e);(await t.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:n[z1],message_name:n[LV],message_time:n[DV],message_device_time:Math.floor(Date.now()/1e3)})}function c5(t){switch(t){case qu.NOTIFICATION_CLICKED:return"notification_open";case qu.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u5(t,e){const n=e.data;if(!n.isFirebaseMessaging)return;t.onMessageHandler&&n.messageType===qu.PUSH_RECEIVED&&(typeof t.onMessageHandler=="function"?t.onMessageHandler(wb(n)):t.onMessageHandler.next(wb(n)));const r=n.data;n5(r)&&r[MV]==="1"&&await l5(t,n.messageType,r)}const bb="@firebase/messaging",Ib="0.12.12";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d5=t=>{const e=new i5(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),t.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",n=>u5(e,n)),e},h5=t=>{const e=t.getProvider("messaging").getImmediate();return{getToken:r=>W1(e,r)}};function f5(){Er(new or("messaging",d5,"PUBLIC")),Er(new or("messaging-internal",h5,"PRIVATE")),pn(bb,Ib),pn(bb,Ib,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function G1(){try{await sE()}catch{return!1}return typeof window<"u"&&c_()&&PC()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m5(t,e){if(!navigator)throw gn.create("only-available-in-window");return t.onMessageHandler=e,()=>{t.onMessageHandler=null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p5(t=Jf()){return G1().then(e=>{if(!e)throw gn.create("unsupported-browser")},e=>{throw gn.create("indexed-db-unsupported")}),lo(Je(t),"messaging").getImmediate()}async function g5(t,e){return t=Je(t),W1(t,e)}function Tb(t,e){return t=Je(t),m5(t,e)}f5();const y5={apiKey:"AIzaSyCWp0X6bLJBsyYKTjUaVsXBSuVD8KeeEqY",authDomain:"carnival-planner.firebaseapp.com",projectId:"carnival-planner",storageBucket:"carnival-planner.firebasestorage.app",messagingSenderId:"1036340118282",appId:"1:1036340118282:web:809dc12c298ff1b8f2f0f3",measurementId:"G-XC1K69PSVC"},On=lE(y5),zs=nL(On),Ue=US(On,{localCache:t1({tabManager:r1()})},"squad-db"),ql=z4(On);Promise.resolve(!0);console.log("Firestore initialized");let Hi=null;const Rv=async()=>{try{return await G1()?(Hi=p5(On),console.log("Firebase Messaging initialized"),Hi):(console.log("Firebase Messaging not supported in this browser"),null)}catch(t){return console.log("Error initializing Firebase Messaging:",t),null}},_5=async t=>{try{if(await Notification.requestPermission()!=="granted")return console.log("Notification permission denied"),null;if(Hi||await Rv(),!Hi)return null;const n=await g5(Hi,{vapidKey:t});return console.log("FCM Token:",n),n}catch(e){return console.log("Error getting FCM token:",e),null}},v5=t=>{Hi?Tb(Hi,t):Rv().then(()=>{Hi&&Tb(Hi,t)})};Rv();const sh="/assets/carnival-logo-CBA9n7vt.png",Op=[{name:"Sugar Mas (St. Kitts)",date:"2026-01-01"},{name:"St. Croix Carnival",date:"2026-01-03"},{name:"Carnaval Ponceno (Puerto Rico)",date:"2026-02-12"},{name:"Aruba Carnival",date:"2026-02-14"},{name:"Barranquilla Carnival (Colombia)",date:"2026-02-14"},{name:"Martinique Carnival",date:"2026-02-15"},{name:"Rio Carnival (Brazil)",date:"2026-02-15"},{name:"Carnaval De Saint-Martin",date:"2026-02-15"},{name:"Mas Domnik (Dominica)",date:"2026-02-16"},{name:"Carriacou & Petite Martinique",date:"2026-02-16"},{name:"Venezuela Carnival",date:"2026-02-16"},{name:"Trinidad Carnival",date:"2026-02-16"},{name:"Guyana Mashramani",date:"2026-02-23"},{name:"Carnaval De San Pedro (Belize)",date:"2026-02-23"},{name:"Cape Town Carnival (South Africa)",date:"2026-03-21"},{name:"Virgin Gorda Easter Festival",date:"2026-04-05"},{name:"Jamaica Carnival",date:"2026-04-12"},{name:"Tampa Bay Carnival (USA)",date:"2026-04-18"},{name:"St. Maarten Carnival",date:"2026-04-30"},{name:"St. Thomas Carnival (USVI)",date:"2026-05-02"},{name:"Cayman Carnival Batabano",date:"2026-05-09"},{name:"Braccanal (Cayman Islands)",date:"2026-05-13"},{name:"Berlin Carnival (Germany)",date:"2026-05-22"},{name:"Atlanta Caribbean Carnival",date:"2026-05-23"},{name:"Aalborg Karneval (Denmark)",date:"2026-05-23"},{name:"Orlando Carnival",date:"2026-05-24"},{name:"Luton International Carnival (UK)",date:"2026-05-24"},{name:"Guyana Independence",date:"2026-05-26"},{name:"Munich Carnival (Germany)",date:"2026-06-04"},{name:"Bahamas Carnival",date:"2026-06-06"},{name:"South Carolina Carnival",date:"2026-06-11"},{name:"Bermuda Carnival",date:"2026-06-15"},{name:"Hollywood Carnival (USA)",date:"2026-06-20"},{name:"Caymas Carnival (Cayman Islands)",date:"2026-06-20"},{name:"Philadelphia Carnival",date:"2026-06-20"},{name:"Vienna Carnival (Austria)",date:"2026-06-26"},{name:"Vincy Mas (St. Vincent)",date:"2026-07-06"},{name:"Saint Lucia Carnival",date:"2026-07-20"},{name:"Anguilla Summer Festival",date:"2026-07-24"},{name:"Zomercarnaval (Rotterdam)",date:"2026-07-25"},{name:"Toronto Caribbean Carnival (Caribana)",date:"2026-08-01"},{name:"Crop Over (Barbados)",date:"2026-08-03"},{name:"Antigua Carnival",date:"2026-08-03"},{name:"Nevis Culturama Festival",date:"2026-08-04"},{name:"Cariwest (Canada)",date:"2026-08-07"},{name:"Spice Mas (Grenada)",date:"2026-08-10"},{name:"Notting Hill Carnival (London)",date:"2026-08-31"},{name:"New York Carnival (Labor Day)",date:"2026-09-07"},{name:"Japan Caribbean Carnival",date:"2026-09-23"},{name:"Miami Carnival",date:"2026-10-11"},{name:"Tobago Carnival",date:"2026-11-01"}];function K1(t,e){const n=B.useRef(e);B.useEffect(function(){e!==n.current&&t.attributionControl!=null&&(n.current!=null&&t.attributionControl.removeAttribution(n.current),e!=null&&t.attributionControl.addAttribution(e)),n.current=e},[t,e])}const x5=1;function w5(t){return Object.freeze({__version:x5,map:t})}function b5(t,e){return Object.freeze({...t,...e})}const Z1=B.createContext(null),Q1=Z1.Provider;function jv(){const t=B.useContext(Z1);if(t==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return t}function I5(t){function e(n,r){const{instance:i,context:o}=t(n).current;return B.useImperativeHandle(r,()=>i),n.children==null?null:Mh.createElement(Q1,{value:o},n.children)}return B.forwardRef(e)}function T5(t){function e(n,r){const[i,o]=B.useState(!1),{instance:a}=t(n,o).current;B.useImperativeHandle(r,()=>a),B.useEffect(function(){i&&a.update()},[a,i,n.children]);const u=a._contentNode;return u?QT.createPortal(n.children,u):null}return B.forwardRef(e)}function E5(t){function e(n,r){const{instance:i}=t(n).current;return B.useImperativeHandle(r,()=>i),null}return B.forwardRef(e)}function Y1(t,e){const n=B.useRef();B.useEffect(function(){return e!=null&&t.instance.on(e),n.current=e,function(){n.current!=null&&t.instance.off(n.current),n.current=null}},[t,e])}function Lv(t,e){const n=t.pane??e.pane;return n?{...t,pane:n}:t}function k5(t,e){return function(r,i){const o=jv(),a=t(Lv(r,o),o);return K1(o.map,r.attribution),Y1(a.current,r.eventHandlers),e(a.current,o,r,i),a}}var hy={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(t,e){(function(n,r){r(e)})(FP,function(n){var r="1.9.4";function i(s){var l,f,p,_;for(f=1,p=arguments.length;f<p;f++){_=arguments[f];for(l in _)s[l]=_[l]}return s}var o=Object.create||function(){function s(){}return function(l){return s.prototype=l,new s}}();function a(s,l){var f=Array.prototype.slice;if(s.bind)return s.bind.apply(s,f.call(arguments,1));var p=f.call(arguments,2);return function(){return s.apply(l,p.length?p.concat(f.call(arguments)):arguments)}}var u=0;function h(s){return"_leaflet_id"in s||(s._leaflet_id=++u),s._leaflet_id}function m(s,l,f){var p,_,I,O;return O=function(){p=!1,_&&(I.apply(f,_),_=!1)},I=function(){p?_=arguments:(s.apply(f,arguments),setTimeout(O,l),p=!0)},I}function y(s,l,f){var p=l[1],_=l[0],I=p-_;return s===p&&f?s:((s-_)%I+I)%I+_}function v(){return!1}function w(s,l){if(l===!1)return s;var f=Math.pow(10,l===void 0?6:l);return Math.round(s*f)/f}function S(s){return s.trim?s.trim():s.replace(/^\s+|\s+$/g,"")}function N(s){return S(s).split(/\s+/)}function P(s,l){Object.prototype.hasOwnProperty.call(s,"options")||(s.options=s.options?o(s.options):{});for(var f in l)s.options[f]=l[f];return s.options}function F(s,l,f){var p=[];for(var _ in s)p.push(encodeURIComponent(f?_.toUpperCase():_)+"="+encodeURIComponent(s[_]));return(!l||l.indexOf("?")===-1?"?":"&")+p.join("&")}var R=/\{ *([\w_ -]+) *\}/g;function k(s,l){return s.replace(R,function(f,p){var _=l[p];if(_===void 0)throw new Error("No value provided for variable "+f);return typeof _=="function"&&(_=_(l)),_})}var A=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"};function z(s,l){for(var f=0;f<s.length;f++)if(s[f]===l)return f;return-1}var G="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function W(s){return window["webkit"+s]||window["moz"+s]||window["ms"+s]}var T=0;function b(s){var l=+new Date,f=Math.max(0,16-(l-T));return T=l+f,window.setTimeout(s,f)}var C=window.requestAnimationFrame||W("RequestAnimationFrame")||b,D=window.cancelAnimationFrame||W("CancelAnimationFrame")||W("CancelRequestAnimationFrame")||function(s){window.clearTimeout(s)};function V(s,l,f){if(f&&C===b)s.call(l);else return C.call(window,a(s,l))}function U(s){s&&D.call(window,s)}var M={__proto__:null,extend:i,create:o,bind:a,get lastId(){return u},stamp:h,throttle:m,wrapNum:y,falseFn:v,formatNum:w,trim:S,splitWords:N,setOptions:P,getParamString:F,template:k,isArray:A,indexOf:z,emptyImageUrl:G,requestFn:C,cancelFn:D,requestAnimFrame:V,cancelAnimFrame:U};function le(){}le.extend=function(s){var l=function(){P(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},f=l.__super__=this.prototype,p=o(f);p.constructor=l,l.prototype=p;for(var _ in this)Object.prototype.hasOwnProperty.call(this,_)&&_!=="prototype"&&_!=="__super__"&&(l[_]=this[_]);return s.statics&&i(l,s.statics),s.includes&&(Ee(s.includes),i.apply(null,[p].concat(s.includes))),i(p,s),delete p.statics,delete p.includes,p.options&&(p.options=f.options?o(f.options):{},i(p.options,s.options)),p._initHooks=[],p.callInitHooks=function(){if(!this._initHooksCalled){f.callInitHooks&&f.callInitHooks.call(this),this._initHooksCalled=!0;for(var I=0,O=p._initHooks.length;I<O;I++)p._initHooks[I].call(this)}},l},le.include=function(s){var l=this.prototype.options;return i(this.prototype,s),s.options&&(this.prototype.options=l,this.mergeOptions(s.options)),this},le.mergeOptions=function(s){return i(this.prototype.options,s),this},le.addInitHook=function(s){var l=Array.prototype.slice.call(arguments,1),f=typeof s=="function"?s:function(){this[s].apply(this,l)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(f),this};function Ee(s){if(!(typeof L>"u"||!L||!L.Mixin)){s=A(s)?s:[s];for(var l=0;l<s.length;l++)s[l]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Ce={on:function(s,l,f){if(typeof s=="object")for(var p in s)this._on(p,s[p],l);else{s=N(s);for(var _=0,I=s.length;_<I;_++)this._on(s[_],l,f)}return this},off:function(s,l,f){if(!arguments.length)delete this._events;else if(typeof s=="object")for(var p in s)this._off(p,s[p],l);else{s=N(s);for(var _=arguments.length===1,I=0,O=s.length;I<O;I++)_?this._off(s[I]):this._off(s[I],l,f)}return this},_on:function(s,l,f,p){if(typeof l!="function"){console.warn("wrong listener type: "+typeof l);return}if(this._listens(s,l,f)===!1){f===this&&(f=void 0);var _={fn:l,ctx:f};p&&(_.once=!0),this._events=this._events||{},this._events[s]=this._events[s]||[],this._events[s].push(_)}},_off:function(s,l,f){var p,_,I;if(this._events&&(p=this._events[s],!!p)){if(arguments.length===1){if(this._firingCount)for(_=0,I=p.length;_<I;_++)p[_].fn=v;delete this._events[s];return}if(typeof l!="function"){console.warn("wrong listener type: "+typeof l);return}var O=this._listens(s,l,f);if(O!==!1){var $=p[O];this._firingCount&&($.fn=v,this._events[s]=p=p.slice()),p.splice(O,1)}}},fire:function(s,l,f){if(!this.listens(s,f))return this;var p=i({},l,{type:s,target:this,sourceTarget:l&&l.sourceTarget||this});if(this._events){var _=this._events[s];if(_){this._firingCount=this._firingCount+1||1;for(var I=0,O=_.length;I<O;I++){var $=_[I],Z=$.fn;$.once&&this.off(s,Z,$.ctx),Z.call($.ctx||this,p)}this._firingCount--}}return f&&this._propagateEvent(p),this},listens:function(s,l,f,p){typeof s!="string"&&console.warn('"string" type argument expected');var _=l;typeof l!="function"&&(p=!!l,_=void 0,f=void 0);var I=this._events&&this._events[s];if(I&&I.length&&this._listens(s,_,f)!==!1)return!0;if(p){for(var O in this._eventParents)if(this._eventParents[O].listens(s,l,f,p))return!0}return!1},_listens:function(s,l,f){if(!this._events)return!1;var p=this._events[s]||[];if(!l)return!!p.length;f===this&&(f=void 0);for(var _=0,I=p.length;_<I;_++)if(p[_].fn===l&&p[_].ctx===f)return _;return!1},once:function(s,l,f){if(typeof s=="object")for(var p in s)this._on(p,s[p],l,!0);else{s=N(s);for(var _=0,I=s.length;_<I;_++)this._on(s[_],l,f,!0)}return this},addEventParent:function(s){return this._eventParents=this._eventParents||{},this._eventParents[h(s)]=s,this},removeEventParent:function(s){return this._eventParents&&delete this._eventParents[h(s)],this},_propagateEvent:function(s){for(var l in this._eventParents)this._eventParents[l].fire(s.type,i({layer:s.target,propagatedFrom:s.target},s),!0)}};Ce.addEventListener=Ce.on,Ce.removeEventListener=Ce.clearAllEventListeners=Ce.off,Ce.addOneTimeEventListener=Ce.once,Ce.fireEvent=Ce.fire,Ce.hasEventListeners=Ce.listens;var Re=le.extend(Ce);function K(s,l,f){this.x=f?Math.round(s):s,this.y=f?Math.round(l):l}var ce=Math.trunc||function(s){return s>0?Math.floor(s):Math.ceil(s)};K.prototype={clone:function(){return new K(this.x,this.y)},add:function(s){return this.clone()._add(X(s))},_add:function(s){return this.x+=s.x,this.y+=s.y,this},subtract:function(s){return this.clone()._subtract(X(s))},_subtract:function(s){return this.x-=s.x,this.y-=s.y,this},divideBy:function(s){return this.clone()._divideBy(s)},_divideBy:function(s){return this.x/=s,this.y/=s,this},multiplyBy:function(s){return this.clone()._multiplyBy(s)},_multiplyBy:function(s){return this.x*=s,this.y*=s,this},scaleBy:function(s){return new K(this.x*s.x,this.y*s.y)},unscaleBy:function(s){return new K(this.x/s.x,this.y/s.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=ce(this.x),this.y=ce(this.y),this},distanceTo:function(s){s=X(s);var l=s.x-this.x,f=s.y-this.y;return Math.sqrt(l*l+f*f)},equals:function(s){return s=X(s),s.x===this.x&&s.y===this.y},contains:function(s){return s=X(s),Math.abs(s.x)<=Math.abs(this.x)&&Math.abs(s.y)<=Math.abs(this.y)},toString:function(){return"Point("+w(this.x)+", "+w(this.y)+")"}};function X(s,l,f){return s instanceof K?s:A(s)?new K(s[0],s[1]):s==null?s:typeof s=="object"&&"x"in s&&"y"in s?new K(s.x,s.y):new K(s,l,f)}function we(s,l){if(s)for(var f=l?[s,l]:s,p=0,_=f.length;p<_;p++)this.extend(f[p])}we.prototype={extend:function(s){var l,f;if(!s)return this;if(s instanceof K||typeof s[0]=="number"||"x"in s)l=f=X(s);else if(s=ue(s),l=s.min,f=s.max,!l||!f)return this;return!this.min&&!this.max?(this.min=l.clone(),this.max=f.clone()):(this.min.x=Math.min(l.x,this.min.x),this.max.x=Math.max(f.x,this.max.x),this.min.y=Math.min(l.y,this.min.y),this.max.y=Math.max(f.y,this.max.y)),this},getCenter:function(s){return X((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,s)},getBottomLeft:function(){return X(this.min.x,this.max.y)},getTopRight:function(){return X(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(s){var l,f;return typeof s[0]=="number"||s instanceof K?s=X(s):s=ue(s),s instanceof we?(l=s.min,f=s.max):l=f=s,l.x>=this.min.x&&f.x<=this.max.x&&l.y>=this.min.y&&f.y<=this.max.y},intersects:function(s){s=ue(s);var l=this.min,f=this.max,p=s.min,_=s.max,I=_.x>=l.x&&p.x<=f.x,O=_.y>=l.y&&p.y<=f.y;return I&&O},overlaps:function(s){s=ue(s);var l=this.min,f=this.max,p=s.min,_=s.max,I=_.x>l.x&&p.x<f.x,O=_.y>l.y&&p.y<f.y;return I&&O},isValid:function(){return!!(this.min&&this.max)},pad:function(s){var l=this.min,f=this.max,p=Math.abs(l.x-f.x)*s,_=Math.abs(l.y-f.y)*s;return ue(X(l.x-p,l.y-_),X(f.x+p,f.y+_))},equals:function(s){return s?(s=ue(s),this.min.equals(s.getTopLeft())&&this.max.equals(s.getBottomRight())):!1}};function ue(s,l){return!s||s instanceof we?s:new we(s,l)}function me(s,l){if(s)for(var f=l?[s,l]:s,p=0,_=f.length;p<_;p++)this.extend(f[p])}me.prototype={extend:function(s){var l=this._southWest,f=this._northEast,p,_;if(s instanceof fe)p=s,_=s;else if(s instanceof me){if(p=s._southWest,_=s._northEast,!p||!_)return this}else return s?this.extend(de(s)||_e(s)):this;return!l&&!f?(this._southWest=new fe(p.lat,p.lng),this._northEast=new fe(_.lat,_.lng)):(l.lat=Math.min(p.lat,l.lat),l.lng=Math.min(p.lng,l.lng),f.lat=Math.max(_.lat,f.lat),f.lng=Math.max(_.lng,f.lng)),this},pad:function(s){var l=this._southWest,f=this._northEast,p=Math.abs(l.lat-f.lat)*s,_=Math.abs(l.lng-f.lng)*s;return new me(new fe(l.lat-p,l.lng-_),new fe(f.lat+p,f.lng+_))},getCenter:function(){return new fe((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new fe(this.getNorth(),this.getWest())},getSouthEast:function(){return new fe(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(s){typeof s[0]=="number"||s instanceof fe||"lat"in s?s=de(s):s=_e(s);var l=this._southWest,f=this._northEast,p,_;return s instanceof me?(p=s.getSouthWest(),_=s.getNorthEast()):p=_=s,p.lat>=l.lat&&_.lat<=f.lat&&p.lng>=l.lng&&_.lng<=f.lng},intersects:function(s){s=_e(s);var l=this._southWest,f=this._northEast,p=s.getSouthWest(),_=s.getNorthEast(),I=_.lat>=l.lat&&p.lat<=f.lat,O=_.lng>=l.lng&&p.lng<=f.lng;return I&&O},overlaps:function(s){s=_e(s);var l=this._southWest,f=this._northEast,p=s.getSouthWest(),_=s.getNorthEast(),I=_.lat>l.lat&&p.lat<f.lat,O=_.lng>l.lng&&p.lng<f.lng;return I&&O},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(s,l){return s?(s=_e(s),this._southWest.equals(s.getSouthWest(),l)&&this._northEast.equals(s.getNorthEast(),l)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function _e(s,l){return s instanceof me?s:new me(s,l)}function fe(s,l,f){if(isNaN(s)||isNaN(l))throw new Error("Invalid LatLng object: ("+s+", "+l+")");this.lat=+s,this.lng=+l,f!==void 0&&(this.alt=+f)}fe.prototype={equals:function(s,l){if(!s)return!1;s=de(s);var f=Math.max(Math.abs(this.lat-s.lat),Math.abs(this.lng-s.lng));return f<=(l===void 0?1e-9:l)},toString:function(s){return"LatLng("+w(this.lat,s)+", "+w(this.lng,s)+")"},distanceTo:function(s){return lt.distance(this,de(s))},wrap:function(){return lt.wrapLatLng(this)},toBounds:function(s){var l=180*s/40075017,f=l/Math.cos(Math.PI/180*this.lat);return _e([this.lat-l,this.lng-f],[this.lat+l,this.lng+f])},clone:function(){return new fe(this.lat,this.lng,this.alt)}};function de(s,l,f){return s instanceof fe?s:A(s)&&typeof s[0]!="object"?s.length===3?new fe(s[0],s[1],s[2]):s.length===2?new fe(s[0],s[1]):null:s==null?s:typeof s=="object"&&"lat"in s?new fe(s.lat,"lng"in s?s.lng:s.lon,s.alt):l===void 0?null:new fe(s,l,f)}var De={latLngToPoint:function(s,l){var f=this.projection.project(s),p=this.scale(l);return this.transformation._transform(f,p)},pointToLatLng:function(s,l){var f=this.scale(l),p=this.transformation.untransform(s,f);return this.projection.unproject(p)},project:function(s){return this.projection.project(s)},unproject:function(s){return this.projection.unproject(s)},scale:function(s){return 256*Math.pow(2,s)},zoom:function(s){return Math.log(s/256)/Math.LN2},getProjectedBounds:function(s){if(this.infinite)return null;var l=this.projection.bounds,f=this.scale(s),p=this.transformation.transform(l.min,f),_=this.transformation.transform(l.max,f);return new we(p,_)},infinite:!1,wrapLatLng:function(s){var l=this.wrapLng?y(s.lng,this.wrapLng,!0):s.lng,f=this.wrapLat?y(s.lat,this.wrapLat,!0):s.lat,p=s.alt;return new fe(f,l,p)},wrapLatLngBounds:function(s){var l=s.getCenter(),f=this.wrapLatLng(l),p=l.lat-f.lat,_=l.lng-f.lng;if(p===0&&_===0)return s;var I=s.getSouthWest(),O=s.getNorthEast(),$=new fe(I.lat-p,I.lng-_),Z=new fe(O.lat-p,O.lng-_);return new me($,Z)}},lt=i({},De,{wrapLng:[-180,180],R:6371e3,distance:function(s,l){var f=Math.PI/180,p=s.lat*f,_=l.lat*f,I=Math.sin((l.lat-s.lat)*f/2),O=Math.sin((l.lng-s.lng)*f/2),$=I*I+Math.cos(p)*Math.cos(_)*O*O,Z=2*Math.atan2(Math.sqrt($),Math.sqrt(1-$));return this.R*Z}}),Gn=6378137,Pt={R:Gn,MAX_LATITUDE:85.0511287798,project:function(s){var l=Math.PI/180,f=this.MAX_LATITUDE,p=Math.max(Math.min(f,s.lat),-f),_=Math.sin(p*l);return new K(this.R*s.lng*l,this.R*Math.log((1+_)/(1-_))/2)},unproject:function(s){var l=180/Math.PI;return new fe((2*Math.atan(Math.exp(s.y/this.R))-Math.PI/2)*l,s.x*l/this.R)},bounds:function(){var s=Gn*Math.PI;return new we([-s,-s],[s,s])}()};function en(s,l,f,p){if(A(s)){this._a=s[0],this._b=s[1],this._c=s[2],this._d=s[3];return}this._a=s,this._b=l,this._c=f,this._d=p}en.prototype={transform:function(s,l){return this._transform(s.clone(),l)},_transform:function(s,l){return l=l||1,s.x=l*(this._a*s.x+this._b),s.y=l*(this._c*s.y+this._d),s},untransform:function(s,l){return l=l||1,new K((s.x/l-this._b)/this._a,(s.y/l-this._d)/this._c)}};function an(s,l,f,p){return new en(s,l,f,p)}var Xe=i({},lt,{code:"EPSG:3857",projection:Pt,transformation:function(){var s=.5/(Math.PI*Pt.R);return an(s,.5,-s,.5)}()}),ft=i({},Xe,{code:"EPSG:900913"});function He(s){return document.createElementNS("http://www.w3.org/2000/svg",s)}function zt(s,l){var f="",p,_,I,O,$,Z;for(p=0,I=s.length;p<I;p++){for($=s[p],_=0,O=$.length;_<O;_++)Z=$[_],f+=(_?"L":"M")+Z.x+" "+Z.y;f+=l?se.svg?"z":"x":""}return f||"M0 0"}var mt=document.documentElement.style,_n="ActiveXObject"in window,ma=_n&&!document.addEventListener,ls="msLaunchUri"in navigator&&!("documentMode"in document),Zr=xn("webkit"),Pr=xn("android"),Ii=xn("android 2")||xn("android 3"),mo=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),po=Pr&&xn("Google")&&mo<537&&!("AudioNode"in window),wt=!!window.opera,Nt=!ls&&xn("chrome"),Qr=xn("gecko")&&!Zr&&!wt&&!_n,go=!Nt&&xn("safari"),Cn=xn("phantom"),pa="OTransition"in mt,Nr=navigator.platform.indexOf("Win")===0,Ar=_n&&"transition"in mt,Cr="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Ii,cs="MozPerspective"in mt,ga=!window.L_DISABLE_3D&&(Ar||Cr||cs)&&!pa&&!Cn,Yr=typeof orientation<"u"||xn("mobile"),us=Yr&&Zr,ya=Yr&&Cr,ds=!window.PointerEvent&&window.MSPointerEvent,Rr=!!(window.PointerEvent||ds),hs="ontouchstart"in window||!!window.TouchEvent,yo=!window.L_NO_TOUCH&&(hs||Rr),jr=Yr&&wt,_a=Yr&&Qr,Ti=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,va=function(){var s=!1;try{var l=Object.defineProperty({},"passive",{get:function(){s=!0}});window.addEventListener("testPassiveEventSupport",v,l),window.removeEventListener("testPassiveEventSupport",v,l)}catch{}return s}(),vn=function(){return!!document.createElement("canvas").getContext}(),bt=!!(document.createElementNS&&He("svg").createSVGRect),ct=!!bt&&function(){var s=document.createElement("div");return s.innerHTML="<svg/>",(s.firstChild&&s.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Kt=!bt&&function(){try{var s=document.createElement("div");s.innerHTML='<v:shape adj="1"/>';var l=s.firstChild;return l.style.behavior="url(#default#VML)",l&&typeof l.adj=="object"}catch{return!1}}(),Jr=navigator.platform.indexOf("Mac")===0,Xr=navigator.platform.indexOf("Linux")===0;function xn(s){return navigator.userAgent.toLowerCase().indexOf(s)>=0}var se={ie:_n,ielt9:ma,edge:ls,webkit:Zr,android:Pr,android23:Ii,androidStock:po,opera:wt,chrome:Nt,gecko:Qr,safari:go,phantom:Cn,opera12:pa,win:Nr,ie3d:Ar,webkit3d:Cr,gecko3d:cs,any3d:ga,mobile:Yr,mobileWebkit:us,mobileWebkit3d:ya,msPointer:ds,pointer:Rr,touch:yo,touchNative:hs,mobileOpera:jr,mobileGecko:_a,retina:Ti,passiveEvents:va,canvas:vn,svg:bt,vml:Kt,inlineSvg:ct,mac:Jr,linux:Xr},Lr=se.msPointer?"MSPointerDown":"pointerdown",xa=se.msPointer?"MSPointerMove":"pointermove",wa=se.msPointer?"MSPointerUp":"pointerup",Ei=se.msPointer?"MSPointerCancel":"pointercancel",fs={touchstart:Lr,touchmove:xa,touchend:wa,touchcancel:Ei},ki={touchstart:gs,touchmove:ps,touchend:ps,touchcancel:ps},Kn={},Zn=!1;function ba(s,l,f){return l==="touchstart"&&Ta(),ki[l]?(f=ki[l].bind(this,f),s.addEventListener(fs[l],f,!1),f):(console.warn("wrong event specified:",l),v)}function Ia(s,l,f){if(!fs[l]){console.warn("wrong event specified:",l);return}s.removeEventListener(fs[l],f,!1)}function _o(s){Kn[s.pointerId]=s}function ms(s){Kn[s.pointerId]&&(Kn[s.pointerId]=s)}function vo(s){delete Kn[s.pointerId]}function Ta(){Zn||(document.addEventListener(Lr,_o,!0),document.addEventListener(xa,ms,!0),document.addEventListener(wa,vo,!0),document.addEventListener(Ei,vo,!0),Zn=!0)}function ps(s,l){if(l.pointerType!==(l.MSPOINTER_TYPE_MOUSE||"mouse")){l.touches=[];for(var f in Kn)l.touches.push(Kn[f]);l.changedTouches=[l],s(l)}}function gs(s,l){l.MSPOINTER_TYPE_TOUCH&&l.pointerType===l.MSPOINTER_TYPE_TOUCH&&It(l),ps(s,l)}function ur(s){var l={},f,p;for(p in s)f=s[p],l[p]=f&&f.bind?f.bind(s):f;return s=l,l.type="dblclick",l.detail=2,l.isTrusted=!1,l._simulated=!0,l}var Pe=200;function ei(s,l){s.addEventListener("dblclick",l);var f=0,p;function _(I){if(I.detail!==1){p=I.detail;return}if(!(I.pointerType==="mouse"||I.sourceCapabilities&&!I.sourceCapabilities.firesTouchEvents)){var O=cc(I);if(!(O.some(function(Z){return Z instanceof HTMLLabelElement&&Z.attributes.for})&&!O.some(function(Z){return Z instanceof HTMLInputElement||Z instanceof HTMLSelectElement}))){var $=Date.now();$-f<=Pe?(p++,p===2&&l(ur(I))):p=1,f=$}}}return s.addEventListener("click",_),{dblclick:l,simDblclick:_}}function dr(s,l){s.removeEventListener("dblclick",l.dblclick),s.removeEventListener("click",l.simDblclick)}var ti=hr(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),ni=hr(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),ys=ni==="webkitTransition"||ni==="OTransition"?ni+"End":"transitionend";function _s(s){return typeof s=="string"?document.getElementById(s):s}function Dr(s,l){var f=s.style[l]||s.currentStyle&&s.currentStyle[l];if((!f||f==="auto")&&document.defaultView){var p=document.defaultView.getComputedStyle(s,null);f=p?p[l]:null}return f==="auto"?null:f}function Me(s,l,f){var p=document.createElement(s);return p.className=l||"",f&&f.appendChild(p),p}function et(s){var l=s.parentNode;l&&l.removeChild(s)}function ri(s){for(;s.firstChild;)s.removeChild(s.firstChild)}function j(s){var l=s.parentNode;l&&l.lastChild!==s&&l.appendChild(s)}function Y(s){var l=s.parentNode;l&&l.firstChild!==s&&l.insertBefore(s,l.firstChild)}function ne(s,l){if(s.classList!==void 0)return s.classList.contains(l);var f=je(s);return f.length>0&&new RegExp("(^|\\s)"+l+"(\\s|$)").test(f)}function re(s,l){if(s.classList!==void 0)for(var f=N(l),p=0,_=f.length;p<_;p++)s.classList.add(f[p]);else if(!ne(s,l)){var I=je(s);Qe(s,(I?I+" ":"")+l)}}function ge(s,l){s.classList!==void 0?s.classList.remove(l):Qe(s,S((" "+je(s)+" ").replace(" "+l+" "," ")))}function Qe(s,l){s.className.baseVal===void 0?s.className=l:s.className.baseVal=l}function je(s){return s.correspondingElement&&(s=s.correspondingElement),s.className.baseVal===void 0?s.className:s.className.baseVal}function We(s,l){"opacity"in s.style?s.style.opacity=l:"filter"in s.style&&qt(s,l)}function qt(s,l){var f=!1,p="DXImageTransform.Microsoft.Alpha";try{f=s.filters.item(p)}catch{if(l===1)return}l=Math.round(l*100),f?(f.Enabled=l!==100,f.Opacity=l):s.style.filter+=" progid:"+p+"(opacity="+l+")"}function hr(s){for(var l=document.documentElement.style,f=0;f<s.length;f++)if(s[f]in l)return s[f];return!1}function fr(s,l,f){var p=l||new K(0,0);s.style[ti]=(se.ie3d?"translate("+p.x+"px,"+p.y+"px)":"translate3d("+p.x+"px,"+p.y+"px,0)")+(f?" scale("+f+")":"")}function Ne(s,l){s._leaflet_pos=l,se.any3d?fr(s,l):(s.style.left=l.x+"px",s.style.top=l.y+"px")}function Rn(s){return s._leaflet_pos||new K(0,0)}var jn,Mr,nc;if("onselectstart"in document)jn=function(){ke(window,"selectstart",It)},Mr=function(){st(window,"selectstart",It)};else{var vs=hr(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);jn=function(){if(vs){var s=document.documentElement.style;nc=s[vs],s[vs]="none"}},Mr=function(){vs&&(document.documentElement.style[vs]=nc,nc=void 0)}}function rc(){ke(window,"dragstart",It)}function ic(){st(window,"dragstart",It)}var Ea,sc;function Si(s){for(;s.tabIndex===-1;)s=s.parentNode;s.style&&(Qn(),Ea=s,sc=s.style.outlineStyle,s.style.outlineStyle="none",ke(window,"keydown",Qn))}function Qn(){Ea&&(Ea.style.outlineStyle=sc,Ea=void 0,sc=void 0,st(window,"keydown",Qn))}function oc(s){do s=s.parentNode;while((!s.offsetWidth||!s.offsetHeight)&&s!==document.body);return s}function ka(s){var l=s.getBoundingClientRect();return{x:l.width/s.offsetWidth||1,y:l.height/s.offsetHeight||1,boundingClientRect:l}}var fd={__proto__:null,TRANSFORM:ti,TRANSITION:ni,TRANSITION_END:ys,get:_s,getStyle:Dr,create:Me,remove:et,empty:ri,toFront:j,toBack:Y,hasClass:ne,addClass:re,removeClass:ge,setClass:Qe,getClass:je,setOpacity:We,testProp:hr,setTransform:fr,setPosition:Ne,getPosition:Rn,get disableTextSelection(){return jn},get enableTextSelection(){return Mr},disableImageDrag:rc,enableImageDrag:ic,preventOutline:Si,restoreOutline:Qn,getSizedParentNode:oc,getScale:ka};function ke(s,l,f,p){if(l&&typeof l=="object")for(var _ in l)ac(s,_,l[_],f);else{l=N(l);for(var I=0,O=l.length;I<O;I++)ac(s,l[I],f,p)}return this}var mr="_leaflet_events";function st(s,l,f,p){if(arguments.length===1)md(s),delete s[mr];else if(l&&typeof l=="object")for(var _ in l)lc(s,_,l[_],f);else if(l=N(l),arguments.length===2)md(s,function($){return z(l,$)!==-1});else for(var I=0,O=l.length;I<O;I++)lc(s,l[I],f,p);return this}function md(s,l){for(var f in s[mr]){var p=f.split(/\d/)[0];(!l||l(p))&&lc(s,p,null,null,f)}}var pr={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function ac(s,l,f,p){var _=l+h(f)+(p?"_"+h(p):"");if(s[mr]&&s[mr][_])return this;var I=function($){return f.call(p||s,$||window.event)},O=I;!se.touchNative&&se.pointer&&l.indexOf("touch")===0?I=ba(s,l,I):se.touch&&l==="dblclick"?I=ei(s,I):"addEventListener"in s?l==="touchstart"||l==="touchmove"||l==="wheel"||l==="mousewheel"?s.addEventListener(pr[l]||l,I,se.passiveEvents?{passive:!1}:!1):l==="mouseenter"||l==="mouseleave"?(I=function($){$=$||window.event,uc(s,$)&&O($)},s.addEventListener(pr[l],I,!1)):s.addEventListener(l,O,!1):s.attachEvent("on"+l,I),s[mr]=s[mr]||{},s[mr][_]=I}function lc(s,l,f,p,_){_=_||l+h(f)+(p?"_"+h(p):"");var I=s[mr]&&s[mr][_];if(!I)return this;!se.touchNative&&se.pointer&&l.indexOf("touch")===0?Ia(s,l,I):se.touch&&l==="dblclick"?dr(s,I):"removeEventListener"in s?s.removeEventListener(pr[l]||l,I,!1):s.detachEvent("on"+l,I),s[mr][_]=null}function gr(s){return s.stopPropagation?s.stopPropagation():s.originalEvent?s.originalEvent._stopped=!0:s.cancelBubble=!0,this}function xs(s){return ac(s,"wheel",gr),this}function ws(s){return ke(s,"mousedown touchstart dblclick contextmenu",gr),s._leaflet_disable_click=!0,this}function It(s){return s.preventDefault?s.preventDefault():s.returnValue=!1,this}function Yn(s){return It(s),gr(s),this}function cc(s){if(s.composedPath)return s.composedPath();for(var l=[],f=s.target;f;)l.push(f),f=f.parentNode;return l}function Sa(s,l){if(!l)return new K(s.clientX,s.clientY);var f=ka(l),p=f.boundingClientRect;return new K((s.clientX-p.left)/f.x-l.clientLeft,(s.clientY-p.top)/f.y-l.clientTop)}var yt=se.linux&&se.chrome?window.devicePixelRatio:se.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function pd(s){return se.edge?s.wheelDeltaY/2:s.deltaY&&s.deltaMode===0?-s.deltaY/yt:s.deltaY&&s.deltaMode===1?-s.deltaY*20:s.deltaY&&s.deltaMode===2?-s.deltaY*60:s.deltaX||s.deltaZ?0:s.wheelDelta?(s.wheelDeltaY||s.wheelDelta)/2:s.detail&&Math.abs(s.detail)<32765?-s.detail*20:s.detail?s.detail/-32765*60:0}function uc(s,l){var f=l.relatedTarget;if(!f)return!0;try{for(;f&&f!==s;)f=f.parentNode}catch{return!1}return f!==s}var gd={__proto__:null,on:ke,off:st,stopPropagation:gr,disableScrollPropagation:xs,disableClickPropagation:ws,preventDefault:It,stop:Yn,getPropagationPath:cc,getMousePosition:Sa,getWheelDelta:pd,isExternalTarget:uc,addListener:ke,removeListener:st},dc=Re.extend({run:function(s,l,f,p){this.stop(),this._el=s,this._inProgress=!0,this._duration=f||.25,this._easeOutPower=1/Math.max(p||.5,.2),this._startPos=Rn(s),this._offset=l.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=V(this._animate,this),this._step()},_step:function(s){var l=+new Date-this._startTime,f=this._duration*1e3;l<f?this._runFrame(this._easeOut(l/f),s):(this._runFrame(1),this._complete())},_runFrame:function(s,l){var f=this._startPos.add(this._offset.multiplyBy(s));l&&f._round(),Ne(this._el,f),this.fire("step")},_complete:function(){U(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(s){return 1-Math.pow(1-s,this._easeOutPower)}}),Be=Re.extend({options:{crs:Xe,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(s,l){l=P(this,l),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(s),this._initLayout(),this._onResize=a(this._onResize,this),this._initEvents(),l.maxBounds&&this.setMaxBounds(l.maxBounds),l.zoom!==void 0&&(this._zoom=this._limitZoom(l.zoom)),l.center&&l.zoom!==void 0&&this.setView(de(l.center),l.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=ni&&se.any3d&&!se.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),ke(this._proxy,ys,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(s,l,f){if(l=l===void 0?this._zoom:this._limitZoom(l),s=this._limitCenter(de(s),l,this.options.maxBounds),f=f||{},this._stop(),this._loaded&&!f.reset&&f!==!0){f.animate!==void 0&&(f.zoom=i({animate:f.animate},f.zoom),f.pan=i({animate:f.animate,duration:f.duration},f.pan));var p=this._zoom!==l?this._tryAnimatedZoom&&this._tryAnimatedZoom(s,l,f.zoom):this._tryAnimatedPan(s,f.pan);if(p)return clearTimeout(this._sizeTimer),this}return this._resetView(s,l,f.pan&&f.pan.noMoveStart),this},setZoom:function(s,l){return this._loaded?this.setView(this.getCenter(),s,{zoom:l}):(this._zoom=s,this)},zoomIn:function(s,l){return s=s||(se.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+s,l)},zoomOut:function(s,l){return s=s||(se.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-s,l)},setZoomAround:function(s,l,f){var p=this.getZoomScale(l),_=this.getSize().divideBy(2),I=s instanceof K?s:this.latLngToContainerPoint(s),O=I.subtract(_).multiplyBy(1-1/p),$=this.containerPointToLatLng(_.add(O));return this.setView($,l,{zoom:f})},_getBoundsCenterZoom:function(s,l){l=l||{},s=s.getBounds?s.getBounds():_e(s);var f=X(l.paddingTopLeft||l.padding||[0,0]),p=X(l.paddingBottomRight||l.padding||[0,0]),_=this.getBoundsZoom(s,!1,f.add(p));if(_=typeof l.maxZoom=="number"?Math.min(l.maxZoom,_):_,_===1/0)return{center:s.getCenter(),zoom:_};var I=p.subtract(f).divideBy(2),O=this.project(s.getSouthWest(),_),$=this.project(s.getNorthEast(),_),Z=this.unproject(O.add($).divideBy(2).add(I),_);return{center:Z,zoom:_}},fitBounds:function(s,l){if(s=_e(s),!s.isValid())throw new Error("Bounds are not valid.");var f=this._getBoundsCenterZoom(s,l);return this.setView(f.center,f.zoom,l)},fitWorld:function(s){return this.fitBounds([[-90,-180],[90,180]],s)},panTo:function(s,l){return this.setView(s,this._zoom,{pan:l})},panBy:function(s,l){if(s=X(s).round(),l=l||{},!s.x&&!s.y)return this.fire("moveend");if(l.animate!==!0&&!this.getSize().contains(s))return this._resetView(this.unproject(this.project(this.getCenter()).add(s)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new dc,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),l.noMoveStart||this.fire("movestart"),l.animate!==!1){re(this._mapPane,"leaflet-pan-anim");var f=this._getMapPanePos().subtract(s).round();this._panAnim.run(this._mapPane,f,l.duration||.25,l.easeLinearity)}else this._rawPanBy(s),this.fire("move").fire("moveend");return this},flyTo:function(s,l,f){if(f=f||{},f.animate===!1||!se.any3d)return this.setView(s,l,f);this._stop();var p=this.project(this.getCenter()),_=this.project(s),I=this.getSize(),O=this._zoom;s=de(s),l=l===void 0?O:l;var $=Math.max(I.x,I.y),Z=$*this.getZoomScale(O,l),ee=_.distanceTo(p)||1,pe=1.42,Se=pe*pe;function Ve(Ft){var Rd=Ft?-1:1,DP=Ft?Z:$,MP=Z*Z-$*$+Rd*Se*Se*ee*ee,OP=2*DP*Se*ee,qm=MP/OP,d0=Math.sqrt(qm*qm+1)-qm,VP=d0<1e-9?-18:Math.log(d0);return VP}function bn(Ft){return(Math.exp(Ft)-Math.exp(-Ft))/2}function Qt(Ft){return(Math.exp(Ft)+Math.exp(-Ft))/2}function _r(Ft){return bn(Ft)/Qt(Ft)}var Dn=Ve(0);function Ua(Ft){return $*(Qt(Dn)/Qt(Dn+pe*Ft))}function CP(Ft){return $*(Qt(Dn)*_r(Dn+pe*Ft)-bn(Dn))/Se}function RP(Ft){return 1-Math.pow(1-Ft,1.5)}var jP=Date.now(),c0=(Ve(1)-Dn)/pe,LP=f.duration?1e3*f.duration:1e3*c0*.8;function u0(){var Ft=(Date.now()-jP)/LP,Rd=RP(Ft)*c0;Ft<=1?(this._flyToFrame=V(u0,this),this._move(this.unproject(p.add(_.subtract(p).multiplyBy(CP(Rd)/ee)),O),this.getScaleZoom($/Ua(Rd),O),{flyTo:!0})):this._move(s,l)._moveEnd(!0)}return this._moveStart(!0,f.noMoveStart),u0.call(this),this},flyToBounds:function(s,l){var f=this._getBoundsCenterZoom(s,l);return this.flyTo(f.center,f.zoom,l)},setMaxBounds:function(s){return s=_e(s),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),s.isValid()?(this.options.maxBounds=s,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(s){var l=this.options.minZoom;return this.options.minZoom=s,this._loaded&&l!==s&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(s):this},setMaxZoom:function(s){var l=this.options.maxZoom;return this.options.maxZoom=s,this._loaded&&l!==s&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(s):this},panInsideBounds:function(s,l){this._enforcingBounds=!0;var f=this.getCenter(),p=this._limitCenter(f,this._zoom,_e(s));return f.equals(p)||this.panTo(p,l),this._enforcingBounds=!1,this},panInside:function(s,l){l=l||{};var f=X(l.paddingTopLeft||l.padding||[0,0]),p=X(l.paddingBottomRight||l.padding||[0,0]),_=this.project(this.getCenter()),I=this.project(s),O=this.getPixelBounds(),$=ue([O.min.add(f),O.max.subtract(p)]),Z=$.getSize();if(!$.contains(I)){this._enforcingBounds=!0;var ee=I.subtract($.getCenter()),pe=$.extend(I).getSize().subtract(Z);_.x+=ee.x<0?-pe.x:pe.x,_.y+=ee.y<0?-pe.y:pe.y,this.panTo(this.unproject(_),l),this._enforcingBounds=!1}return this},invalidateSize:function(s){if(!this._loaded)return this;s=i({animate:!1,pan:!0},s===!0?{animate:!0}:s);var l=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var f=this.getSize(),p=l.divideBy(2).round(),_=f.divideBy(2).round(),I=p.subtract(_);return!I.x&&!I.y?this:(s.animate&&s.pan?this.panBy(I):(s.pan&&this._rawPanBy(I),this.fire("move"),s.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(a(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:l,newSize:f}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(s){if(s=this._locateOptions=i({timeout:1e4,watch:!1},s),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var l=a(this._handleGeolocationResponse,this),f=a(this._handleGeolocationError,this);return s.watch?this._locationWatchId=navigator.geolocation.watchPosition(l,f,s):navigator.geolocation.getCurrentPosition(l,f,s),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(s){if(this._container._leaflet_id){var l=s.code,f=s.message||(l===1?"permission denied":l===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:l,message:"Geolocation error: "+f+"."})}},_handleGeolocationResponse:function(s){if(this._container._leaflet_id){var l=s.coords.latitude,f=s.coords.longitude,p=new fe(l,f),_=p.toBounds(s.coords.accuracy*2),I=this._locateOptions;if(I.setView){var O=this.getBoundsZoom(_);this.setView(p,I.maxZoom?Math.min(O,I.maxZoom):O)}var $={latlng:p,bounds:_,timestamp:s.timestamp};for(var Z in s.coords)typeof s.coords[Z]=="number"&&($[Z]=s.coords[Z]);this.fire("locationfound",$)}},addHandler:function(s,l){if(!l)return this;var f=this[s]=new l(this);return this._handlers.push(f),this.options[s]&&f.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),et(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(U(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var s;for(s in this._layers)this._layers[s].remove();for(s in this._panes)et(this._panes[s]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(s,l){var f="leaflet-pane"+(s?" leaflet-"+s.replace("Pane","")+"-pane":""),p=Me("div",f,l||this._mapPane);return s&&(this._panes[s]=p),p},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var s=this.getPixelBounds(),l=this.unproject(s.getBottomLeft()),f=this.unproject(s.getTopRight());return new me(l,f)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(s,l,f){s=_e(s),f=X(f||[0,0]);var p=this.getZoom()||0,_=this.getMinZoom(),I=this.getMaxZoom(),O=s.getNorthWest(),$=s.getSouthEast(),Z=this.getSize().subtract(f),ee=ue(this.project($,p),this.project(O,p)).getSize(),pe=se.any3d?this.options.zoomSnap:1,Se=Z.x/ee.x,Ve=Z.y/ee.y,bn=l?Math.max(Se,Ve):Math.min(Se,Ve);return p=this.getScaleZoom(bn,p),pe&&(p=Math.round(p/(pe/100))*(pe/100),p=l?Math.ceil(p/pe)*pe:Math.floor(p/pe)*pe),Math.max(_,Math.min(I,p))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new K(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(s,l){var f=this._getTopLeftPoint(s,l);return new we(f,f.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(s){return this.options.crs.getProjectedBounds(s===void 0?this.getZoom():s)},getPane:function(s){return typeof s=="string"?this._panes[s]:s},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(s,l){var f=this.options.crs;return l=l===void 0?this._zoom:l,f.scale(s)/f.scale(l)},getScaleZoom:function(s,l){var f=this.options.crs;l=l===void 0?this._zoom:l;var p=f.zoom(s*f.scale(l));return isNaN(p)?1/0:p},project:function(s,l){return l=l===void 0?this._zoom:l,this.options.crs.latLngToPoint(de(s),l)},unproject:function(s,l){return l=l===void 0?this._zoom:l,this.options.crs.pointToLatLng(X(s),l)},layerPointToLatLng:function(s){var l=X(s).add(this.getPixelOrigin());return this.unproject(l)},latLngToLayerPoint:function(s){var l=this.project(de(s))._round();return l._subtract(this.getPixelOrigin())},wrapLatLng:function(s){return this.options.crs.wrapLatLng(de(s))},wrapLatLngBounds:function(s){return this.options.crs.wrapLatLngBounds(_e(s))},distance:function(s,l){return this.options.crs.distance(de(s),de(l))},containerPointToLayerPoint:function(s){return X(s).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(s){return X(s).add(this._getMapPanePos())},containerPointToLatLng:function(s){var l=this.containerPointToLayerPoint(X(s));return this.layerPointToLatLng(l)},latLngToContainerPoint:function(s){return this.layerPointToContainerPoint(this.latLngToLayerPoint(de(s)))},mouseEventToContainerPoint:function(s){return Sa(s,this._container)},mouseEventToLayerPoint:function(s){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(s))},mouseEventToLatLng:function(s){return this.layerPointToLatLng(this.mouseEventToLayerPoint(s))},_initContainer:function(s){var l=this._container=_s(s);if(l){if(l._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");ke(l,"scroll",this._onScroll,this),this._containerId=h(l)},_initLayout:function(){var s=this._container;this._fadeAnimated=this.options.fadeAnimation&&se.any3d,re(s,"leaflet-container"+(se.touch?" leaflet-touch":"")+(se.retina?" leaflet-retina":"")+(se.ielt9?" leaflet-oldie":"")+(se.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var l=Dr(s,"position");l!=="absolute"&&l!=="relative"&&l!=="fixed"&&l!=="sticky"&&(s.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var s=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Ne(this._mapPane,new K(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(re(s.markerPane,"leaflet-zoom-hide"),re(s.shadowPane,"leaflet-zoom-hide"))},_resetView:function(s,l,f){Ne(this._mapPane,new K(0,0));var p=!this._loaded;this._loaded=!0,l=this._limitZoom(l),this.fire("viewprereset");var _=this._zoom!==l;this._moveStart(_,f)._move(s,l)._moveEnd(_),this.fire("viewreset"),p&&this.fire("load")},_moveStart:function(s,l){return s&&this.fire("zoomstart"),l||this.fire("movestart"),this},_move:function(s,l,f,p){l===void 0&&(l=this._zoom);var _=this._zoom!==l;return this._zoom=l,this._lastCenter=s,this._pixelOrigin=this._getNewPixelOrigin(s),p?f&&f.pinch&&this.fire("zoom",f):((_||f&&f.pinch)&&this.fire("zoom",f),this.fire("move",f)),this},_moveEnd:function(s){return s&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return U(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(s){Ne(this._mapPane,this._getMapPanePos().subtract(s))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(s){this._targets={},this._targets[h(this._container)]=this;var l=s?st:ke;l(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&l(window,"resize",this._onResize,this),se.any3d&&this.options.transform3DLimit&&(s?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){U(this._resizeRequest),this._resizeRequest=V(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var s=this._getMapPanePos();Math.max(Math.abs(s.x),Math.abs(s.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(s,l){for(var f=[],p,_=l==="mouseout"||l==="mouseover",I=s.target||s.srcElement,O=!1;I;){if(p=this._targets[h(I)],p&&(l==="click"||l==="preclick")&&this._draggableMoved(p)){O=!0;break}if(p&&p.listens(l,!0)&&(_&&!uc(I,s)||(f.push(p),_))||I===this._container)break;I=I.parentNode}return!f.length&&!O&&!_&&this.listens(l,!0)&&(f=[this]),f},_isClickDisabled:function(s){for(;s&&s!==this._container;){if(s._leaflet_disable_click)return!0;s=s.parentNode}},_handleDOMEvent:function(s){var l=s.target||s.srcElement;if(!(!this._loaded||l._leaflet_disable_events||s.type==="click"&&this._isClickDisabled(l))){var f=s.type;f==="mousedown"&&Si(l),this._fireDOMEvent(s,f)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(s,l,f){if(s.type==="click"){var p=i({},s);p.type="preclick",this._fireDOMEvent(p,p.type,f)}var _=this._findEventTargets(s,l);if(f){for(var I=[],O=0;O<f.length;O++)f[O].listens(l,!0)&&I.push(f[O]);_=I.concat(_)}if(_.length){l==="contextmenu"&&It(s);var $=_[0],Z={originalEvent:s};if(s.type!=="keypress"&&s.type!=="keydown"&&s.type!=="keyup"){var ee=$.getLatLng&&(!$._radius||$._radius<=10);Z.containerPoint=ee?this.latLngToContainerPoint($.getLatLng()):this.mouseEventToContainerPoint(s),Z.layerPoint=this.containerPointToLayerPoint(Z.containerPoint),Z.latlng=ee?$.getLatLng():this.layerPointToLatLng(Z.layerPoint)}for(O=0;O<_.length;O++)if(_[O].fire(l,Z,!0),Z.originalEvent._stopped||_[O].options.bubblingMouseEvents===!1&&z(this._mouseEvents,l)!==-1)return}},_draggableMoved:function(s){return s=s.dragging&&s.dragging.enabled()?s:this,s.dragging&&s.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var s=0,l=this._handlers.length;s<l;s++)this._handlers[s].disable()},whenReady:function(s,l){return this._loaded?s.call(l||this,{target:this}):this.on("load",s,l),this},_getMapPanePos:function(){return Rn(this._mapPane)||new K(0,0)},_moved:function(){var s=this._getMapPanePos();return s&&!s.equals([0,0])},_getTopLeftPoint:function(s,l){var f=s&&l!==void 0?this._getNewPixelOrigin(s,l):this.getPixelOrigin();return f.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(s,l){var f=this.getSize()._divideBy(2);return this.project(s,l)._subtract(f)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(s,l,f){var p=this._getNewPixelOrigin(f,l);return this.project(s,l)._subtract(p)},_latLngBoundsToNewLayerBounds:function(s,l,f){var p=this._getNewPixelOrigin(f,l);return ue([this.project(s.getSouthWest(),l)._subtract(p),this.project(s.getNorthWest(),l)._subtract(p),this.project(s.getSouthEast(),l)._subtract(p),this.project(s.getNorthEast(),l)._subtract(p)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(s){return this.latLngToLayerPoint(s).subtract(this._getCenterLayerPoint())},_limitCenter:function(s,l,f){if(!f)return s;var p=this.project(s,l),_=this.getSize().divideBy(2),I=new we(p.subtract(_),p.add(_)),O=this._getBoundsOffset(I,f,l);return Math.abs(O.x)<=1&&Math.abs(O.y)<=1?s:this.unproject(p.add(O),l)},_limitOffset:function(s,l){if(!l)return s;var f=this.getPixelBounds(),p=new we(f.min.add(s),f.max.add(s));return s.add(this._getBoundsOffset(p,l))},_getBoundsOffset:function(s,l,f){var p=ue(this.project(l.getNorthEast(),f),this.project(l.getSouthWest(),f)),_=p.min.subtract(s.min),I=p.max.subtract(s.max),O=this._rebound(_.x,-I.x),$=this._rebound(_.y,-I.y);return new K(O,$)},_rebound:function(s,l){return s+l>0?Math.round(s-l)/2:Math.max(0,Math.ceil(s))-Math.max(0,Math.floor(l))},_limitZoom:function(s){var l=this.getMinZoom(),f=this.getMaxZoom(),p=se.any3d?this.options.zoomSnap:1;return p&&(s=Math.round(s/p)*p),Math.max(l,Math.min(f,s))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){ge(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(s,l){var f=this._getCenterOffset(s)._trunc();return(l&&l.animate)!==!0&&!this.getSize().contains(f)?!1:(this.panBy(f,l),!0)},_createAnimProxy:function(){var s=this._proxy=Me("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(s),this.on("zoomanim",function(l){var f=ti,p=this._proxy.style[f];fr(this._proxy,this.project(l.center,l.zoom),this.getZoomScale(l.zoom,1)),p===this._proxy.style[f]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){et(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var s=this.getCenter(),l=this.getZoom();fr(this._proxy,this.project(s,l),this.getZoomScale(l,1))},_catchTransitionEnd:function(s){this._animatingZoom&&s.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(s,l,f){if(this._animatingZoom)return!0;if(f=f||{},!this._zoomAnimated||f.animate===!1||this._nothingToAnimate()||Math.abs(l-this._zoom)>this.options.zoomAnimationThreshold)return!1;var p=this.getZoomScale(l),_=this._getCenterOffset(s)._divideBy(1-1/p);return f.animate!==!0&&!this.getSize().contains(_)?!1:(V(function(){this._moveStart(!0,f.noMoveStart||!1)._animateZoom(s,l,!0)},this),!0)},_animateZoom:function(s,l,f,p){this._mapPane&&(f&&(this._animatingZoom=!0,this._animateToCenter=s,this._animateToZoom=l,re(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:s,zoom:l,noUpdate:p}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(a(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&ge(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Pa(s,l){return new Be(s,l)}var Ln=le.extend({options:{position:"topright"},initialize:function(s){P(this,s)},getPosition:function(){return this.options.position},setPosition:function(s){var l=this._map;return l&&l.removeControl(this),this.options.position=s,l&&l.addControl(this),this},getContainer:function(){return this._container},addTo:function(s){this.remove(),this._map=s;var l=this._container=this.onAdd(s),f=this.getPosition(),p=s._controlCorners[f];return re(l,"leaflet-control"),f.indexOf("bottom")!==-1?p.insertBefore(l,p.firstChild):p.appendChild(l),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(et(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(s){this._map&&s&&s.screenX>0&&s.screenY>0&&this._map.getContainer().focus()}}),wn=function(s){return new Ln(s)};Be.include({addControl:function(s){return s.addTo(this),this},removeControl:function(s){return s.remove(),this},_initControlPos:function(){var s=this._controlCorners={},l="leaflet-",f=this._controlContainer=Me("div",l+"control-container",this._container);function p(_,I){var O=l+_+" "+l+I;s[_+I]=Me("div",O,f)}p("top","left"),p("top","right"),p("bottom","left"),p("bottom","right")},_clearControlPos:function(){for(var s in this._controlCorners)et(this._controlCorners[s]);et(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var hc=Ln.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(s,l,f,p){return f<p?-1:p<f?1:0}},initialize:function(s,l,f){P(this,f),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var p in s)this._addLayer(s[p],p);for(p in l)this._addLayer(l[p],p,!0)},onAdd:function(s){this._initLayout(),this._update(),this._map=s,s.on("zoomend",this._checkDisabledLayers,this);for(var l=0;l<this._layers.length;l++)this._layers[l].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(s){return Ln.prototype.addTo.call(this,s),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var s=0;s<this._layers.length;s++)this._layers[s].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(s,l){return this._addLayer(s,l),this._map?this._update():this},addOverlay:function(s,l){return this._addLayer(s,l,!0),this._map?this._update():this},removeLayer:function(s){s.off("add remove",this._onLayerChange,this);var l=this._getLayer(h(s));return l&&this._layers.splice(this._layers.indexOf(l),1),this._map?this._update():this},expand:function(){re(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var s=this._map.getSize().y-(this._container.offsetTop+50);return s<this._section.clientHeight?(re(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=s+"px"):ge(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return ge(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var s="leaflet-control-layers",l=this._container=Me("div",s),f=this.options.collapsed;l.setAttribute("aria-haspopup",!0),ws(l),xs(l);var p=this._section=Me("section",s+"-list");f&&(this._map.on("click",this.collapse,this),ke(l,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var _=this._layersLink=Me("a",s+"-toggle",l);_.href="#",_.title="Layers",_.setAttribute("role","button"),ke(_,{keydown:function(I){I.keyCode===13&&this._expandSafely()},click:function(I){It(I),this._expandSafely()}},this),f||this.expand(),this._baseLayersList=Me("div",s+"-base",p),this._separator=Me("div",s+"-separator",p),this._overlaysList=Me("div",s+"-overlays",p),l.appendChild(p)},_getLayer:function(s){for(var l=0;l<this._layers.length;l++)if(this._layers[l]&&h(this._layers[l].layer)===s)return this._layers[l]},_addLayer:function(s,l,f){this._map&&s.on("add remove",this._onLayerChange,this),this._layers.push({layer:s,name:l,overlay:f}),this.options.sortLayers&&this._layers.sort(a(function(p,_){return this.options.sortFunction(p.layer,_.layer,p.name,_.name)},this)),this.options.autoZIndex&&s.setZIndex&&(this._lastZIndex++,s.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;ri(this._baseLayersList),ri(this._overlaysList),this._layerControlInputs=[];var s,l,f,p,_=0;for(f=0;f<this._layers.length;f++)p=this._layers[f],this._addItem(p),l=l||p.overlay,s=s||!p.overlay,_+=p.overlay?0:1;return this.options.hideSingleBase&&(s=s&&_>1,this._baseLayersList.style.display=s?"":"none"),this._separator.style.display=l&&s?"":"none",this},_onLayerChange:function(s){this._handlingClick||this._update();var l=this._getLayer(h(s.target)),f=l.overlay?s.type==="add"?"overlayadd":"overlayremove":s.type==="add"?"baselayerchange":null;f&&this._map.fire(f,l)},_createRadioElement:function(s,l){var f='<input type="radio" class="leaflet-control-layers-selector" name="'+s+'"'+(l?' checked="checked"':"")+"/>",p=document.createElement("div");return p.innerHTML=f,p.firstChild},_addItem:function(s){var l=document.createElement("label"),f=this._map.hasLayer(s.layer),p;s.overlay?(p=document.createElement("input"),p.type="checkbox",p.className="leaflet-control-layers-selector",p.defaultChecked=f):p=this._createRadioElement("leaflet-base-layers_"+h(this),f),this._layerControlInputs.push(p),p.layerId=h(s.layer),ke(p,"click",this._onInputClick,this);var _=document.createElement("span");_.innerHTML=" "+s.name;var I=document.createElement("span");l.appendChild(I),I.appendChild(p),I.appendChild(_);var O=s.overlay?this._overlaysList:this._baseLayersList;return O.appendChild(l),this._checkDisabledLayers(),l},_onInputClick:function(){if(!this._preventClick){var s=this._layerControlInputs,l,f,p=[],_=[];this._handlingClick=!0;for(var I=s.length-1;I>=0;I--)l=s[I],f=this._getLayer(l.layerId).layer,l.checked?p.push(f):l.checked||_.push(f);for(I=0;I<_.length;I++)this._map.hasLayer(_[I])&&this._map.removeLayer(_[I]);for(I=0;I<p.length;I++)this._map.hasLayer(p[I])||this._map.addLayer(p[I]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var s=this._layerControlInputs,l,f,p=this._map.getZoom(),_=s.length-1;_>=0;_--)l=s[_],f=this._getLayer(l.layerId).layer,l.disabled=f.options.minZoom!==void 0&&p<f.options.minZoom||f.options.maxZoom!==void 0&&p>f.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var s=this._section;this._preventClick=!0,ke(s,"click",It),this.expand();var l=this;setTimeout(function(){st(s,"click",It),l._preventClick=!1})}}),Om=function(s,l,f){return new hc(s,l,f)},Pi=Ln.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(s){var l="leaflet-control-zoom",f=Me("div",l+" leaflet-bar"),p=this.options;return this._zoomInButton=this._createButton(p.zoomInText,p.zoomInTitle,l+"-in",f,this._zoomIn),this._zoomOutButton=this._createButton(p.zoomOutText,p.zoomOutTitle,l+"-out",f,this._zoomOut),this._updateDisabled(),s.on("zoomend zoomlevelschange",this._updateDisabled,this),f},onRemove:function(s){s.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(s){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(s.shiftKey?3:1))},_zoomOut:function(s){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(s.shiftKey?3:1))},_createButton:function(s,l,f,p,_){var I=Me("a",f,p);return I.innerHTML=s,I.href="#",I.title=l,I.setAttribute("role","button"),I.setAttribute("aria-label",l),ws(I),ke(I,"click",Yn),ke(I,"click",_,this),ke(I,"click",this._refocusOnMap,this),I},_updateDisabled:function(){var s=this._map,l="leaflet-disabled";ge(this._zoomInButton,l),ge(this._zoomOutButton,l),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||s._zoom===s.getMinZoom())&&(re(this._zoomOutButton,l),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||s._zoom===s.getMaxZoom())&&(re(this._zoomInButton,l),this._zoomInButton.setAttribute("aria-disabled","true"))}});Be.mergeOptions({zoomControl:!0}),Be.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Pi,this.addControl(this.zoomControl))});var yd=function(s){return new Pi(s)},Na=Ln.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(s){var l="leaflet-control-scale",f=Me("div",l),p=this.options;return this._addScales(p,l+"-line",f),s.on(p.updateWhenIdle?"moveend":"move",this._update,this),s.whenReady(this._update,this),f},onRemove:function(s){s.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(s,l,f){s.metric&&(this._mScale=Me("div",l,f)),s.imperial&&(this._iScale=Me("div",l,f))},_update:function(){var s=this._map,l=s.getSize().y/2,f=s.distance(s.containerPointToLatLng([0,l]),s.containerPointToLatLng([this.options.maxWidth,l]));this._updateScales(f)},_updateScales:function(s){this.options.metric&&s&&this._updateMetric(s),this.options.imperial&&s&&this._updateImperial(s)},_updateMetric:function(s){var l=this._getRoundNum(s),f=l<1e3?l+" m":l/1e3+" km";this._updateScale(this._mScale,f,l/s)},_updateImperial:function(s){var l=s*3.2808399,f,p,_;l>5280?(f=l/5280,p=this._getRoundNum(f),this._updateScale(this._iScale,p+" mi",p/f)):(_=this._getRoundNum(l),this._updateScale(this._iScale,_+" ft",_/l))},_updateScale:function(s,l,f){s.style.width=Math.round(this.options.maxWidth*f)+"px",s.innerHTML=l},_getRoundNum:function(s){var l=Math.pow(10,(Math.floor(s)+"").length-1),f=s/l;return f=f>=10?10:f>=5?5:f>=3?3:f>=2?2:1,l*f}}),Aa=function(s){return new Na(s)},_d='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',bs=Ln.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(se.inlineSvg?_d+" ":"")+"Leaflet</a>"},initialize:function(s){P(this,s),this._attributions={}},onAdd:function(s){s.attributionControl=this,this._container=Me("div","leaflet-control-attribution"),ws(this._container);for(var l in s._layers)s._layers[l].getAttribution&&this.addAttribution(s._layers[l].getAttribution());return this._update(),s.on("layeradd",this._addAttribution,this),this._container},onRemove:function(s){s.off("layeradd",this._addAttribution,this)},_addAttribution:function(s){s.layer.getAttribution&&(this.addAttribution(s.layer.getAttribution()),s.layer.once("remove",function(){this.removeAttribution(s.layer.getAttribution())},this))},setPrefix:function(s){return this.options.prefix=s,this._update(),this},addAttribution:function(s){return s?(this._attributions[s]||(this._attributions[s]=0),this._attributions[s]++,this._update(),this):this},removeAttribution:function(s){return s?(this._attributions[s]&&(this._attributions[s]--,this._update()),this):this},_update:function(){if(this._map){var s=[];for(var l in this._attributions)this._attributions[l]&&s.push(l);var f=[];this.options.prefix&&f.push(this.options.prefix),s.length&&f.push(s.join(", ")),this._container.innerHTML=f.join(' <span aria-hidden="true">|</span> ')}}});Be.mergeOptions({attributionControl:!0}),Be.addInitHook(function(){this.options.attributionControl&&new bs().addTo(this)});var Vm=function(s){return new bs(s)};Ln.Layers=hc,Ln.Zoom=Pi,Ln.Scale=Na,Ln.Attribution=bs,wn.layers=Om,wn.zoom=yd,wn.scale=Aa,wn.attribution=Vm;var Jn=le.extend({initialize:function(s){this._map=s},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Jn.addTo=function(s,l){return s.addHandler(l,this),this};var xo={Events:Ce},fc=se.touch?"touchstart mousedown":"mousedown",Or=Re.extend({options:{clickTolerance:3},initialize:function(s,l,f,p){P(this,p),this._element=s,this._dragStartTarget=l||s,this._preventOutline=f},enable:function(){this._enabled||(ke(this._dragStartTarget,fc,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Or._dragging===this&&this.finishDrag(!0),st(this._dragStartTarget,fc,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(s){if(this._enabled&&(this._moved=!1,!ne(this._element,"leaflet-zoom-anim"))){if(s.touches&&s.touches.length!==1){Or._dragging===this&&this.finishDrag();return}if(!(Or._dragging||s.shiftKey||s.which!==1&&s.button!==1&&!s.touches)&&(Or._dragging=this,this._preventOutline&&Si(this._element),rc(),jn(),!this._moving)){this.fire("down");var l=s.touches?s.touches[0]:s,f=oc(this._element);this._startPoint=new K(l.clientX,l.clientY),this._startPos=Rn(this._element),this._parentScale=ka(f);var p=s.type==="mousedown";ke(document,p?"mousemove":"touchmove",this._onMove,this),ke(document,p?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(s){if(this._enabled){if(s.touches&&s.touches.length>1){this._moved=!0;return}var l=s.touches&&s.touches.length===1?s.touches[0]:s,f=new K(l.clientX,l.clientY)._subtract(this._startPoint);!f.x&&!f.y||Math.abs(f.x)+Math.abs(f.y)<this.options.clickTolerance||(f.x/=this._parentScale.x,f.y/=this._parentScale.y,It(s),this._moved||(this.fire("dragstart"),this._moved=!0,re(document.body,"leaflet-dragging"),this._lastTarget=s.target||s.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),re(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(f),this._moving=!0,this._lastEvent=s,this._updatePosition())}},_updatePosition:function(){var s={originalEvent:this._lastEvent};this.fire("predrag",s),Ne(this._element,this._newPos),this.fire("drag",s)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(s){ge(document.body,"leaflet-dragging"),this._lastTarget&&(ge(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),st(document,"mousemove touchmove",this._onMove,this),st(document,"mouseup touchend touchcancel",this._onUp,this),ic(),Mr();var l=this._moved&&this._moving;this._moving=!1,Or._dragging=!1,l&&this.fire("dragend",{noInertia:s,distance:this._newPos.distanceTo(this._startPos)})}});function Ca(s,l,f){var p,_=[1,4,2,8],I,O,$,Z,ee,pe,Se,Ve;for(I=0,pe=s.length;I<pe;I++)s[I]._code=ii(s[I],l);for($=0;$<4;$++){for(Se=_[$],p=[],I=0,pe=s.length,O=pe-1;I<pe;O=I++)Z=s[I],ee=s[O],Z._code&Se?ee._code&Se||(Ve=Zt(ee,Z,Se,l,f),Ve._code=ii(Ve,l),p.push(Ve)):(ee._code&Se&&(Ve=Zt(ee,Z,Se,l,f),Ve._code=ii(Ve,l),p.push(Ve)),p.push(Z));s=p}return s}function Ra(s,l){var f,p,_,I,O,$,Z,ee,pe;if(!s||s.length===0)throw new Error("latlngs not passed");d(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var Se=de([0,0]),Ve=_e(s),bn=Ve.getNorthWest().distanceTo(Ve.getSouthWest())*Ve.getNorthEast().distanceTo(Ve.getNorthWest());bn<1700&&(Se=ja(s));var Qt=s.length,_r=[];for(f=0;f<Qt;f++){var Dn=de(s[f]);_r.push(l.project(de([Dn.lat-Se.lat,Dn.lng-Se.lng])))}for($=Z=ee=0,f=0,p=Qt-1;f<Qt;p=f++)_=_r[f],I=_r[p],O=_.y*I.x-I.y*_.x,Z+=(_.x+I.x)*O,ee+=(_.y+I.y)*O,$+=O*3;$===0?pe=_r[0]:pe=[Z/$,ee/$];var Ua=l.unproject(X(pe));return de([Ua.lat+Se.lat,Ua.lng+Se.lng])}function ja(s){for(var l=0,f=0,p=0,_=0;_<s.length;_++){var I=de(s[_]);l+=I.lat,f+=I.lng,p++}return de([l/p,f/p])}var La={__proto__:null,clipPolygon:Ca,polygonCenter:Ra,centroid:ja};function mc(s,l){if(!l||!s.length)return s.slice();var f=l*l;return s=xd(s,f),s=vd(s,f),s}function pc(s,l,f){return Math.sqrt(yr(s,l,f,!0))}function Ni(s,l,f){return yr(s,l,f)}function vd(s,l){var f=s.length,p=typeof Uint8Array<"u"?Uint8Array:Array,_=new p(f);_[0]=_[f-1]=1,Da(s,_,l,0,f-1);var I,O=[];for(I=0;I<f;I++)_[I]&&O.push(s[I]);return O}function Da(s,l,f,p,_){var I=0,O,$,Z;for($=p+1;$<=_-1;$++)Z=yr(s[$],s[p],s[_],!0),Z>I&&(O=$,I=Z);I>f&&(l[O]=1,Da(s,l,f,p,O),Da(s,l,f,O,_))}function xd(s,l){for(var f=[s[0]],p=1,_=0,I=s.length;p<I;p++)wd(s[p],s[_])>l&&(f.push(s[p]),_=p);return _<I-1&&f.push(s[I-1]),f}var gc;function wo(s,l,f,p,_){var I=p?gc:ii(s,f),O=ii(l,f),$,Z,ee;for(gc=O;;){if(!(I|O))return[s,l];if(I&O)return!1;$=I||O,Z=Zt(s,l,$,f,_),ee=ii(Z,f),$===I?(s=Z,I=ee):(l=Z,O=ee)}}function Zt(s,l,f,p,_){var I=l.x-s.x,O=l.y-s.y,$=p.min,Z=p.max,ee,pe;return f&8?(ee=s.x+I*(Z.y-s.y)/O,pe=Z.y):f&4?(ee=s.x+I*($.y-s.y)/O,pe=$.y):f&2?(ee=Z.x,pe=s.y+O*(Z.x-s.x)/I):f&1&&(ee=$.x,pe=s.y+O*($.x-s.x)/I),new K(ee,pe,_)}function ii(s,l){var f=0;return s.x<l.min.x?f|=1:s.x>l.max.x&&(f|=2),s.y<l.min.y?f|=4:s.y>l.max.y&&(f|=8),f}function wd(s,l){var f=l.x-s.x,p=l.y-s.y;return f*f+p*p}function yr(s,l,f,p){var _=l.x,I=l.y,O=f.x-_,$=f.y-I,Z=O*O+$*$,ee;return Z>0&&(ee=((s.x-_)*O+(s.y-I)*$)/Z,ee>1?(_=f.x,I=f.y):ee>0&&(_+=O*ee,I+=$*ee)),O=s.x-_,$=s.y-I,p?O*O+$*$:new K(_,I)}function d(s){return!A(s[0])||typeof s[0][0]!="object"&&typeof s[0][0]<"u"}function g(s){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),d(s)}function x(s,l){var f,p,_,I,O,$,Z,ee;if(!s||s.length===0)throw new Error("latlngs not passed");d(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var pe=de([0,0]),Se=_e(s),Ve=Se.getNorthWest().distanceTo(Se.getSouthWest())*Se.getNorthEast().distanceTo(Se.getNorthWest());Ve<1700&&(pe=ja(s));var bn=s.length,Qt=[];for(f=0;f<bn;f++){var _r=de(s[f]);Qt.push(l.project(de([_r.lat-pe.lat,_r.lng-pe.lng])))}for(f=0,p=0;f<bn-1;f++)p+=Qt[f].distanceTo(Qt[f+1])/2;if(p===0)ee=Qt[0];else for(f=0,I=0;f<bn-1;f++)if(O=Qt[f],$=Qt[f+1],_=O.distanceTo($),I+=_,I>p){Z=(I-p)/_,ee=[$.x-Z*($.x-O.x),$.y-Z*($.y-O.y)];break}var Dn=l.unproject(X(ee));return de([Dn.lat+pe.lat,Dn.lng+pe.lng])}var E={__proto__:null,simplify:mc,pointToSegmentDistance:pc,closestPointOnSegment:Ni,clipSegment:wo,_getEdgeIntersection:Zt,_getBitCode:ii,_sqClosestPointOnSegment:yr,isFlat:d,_flat:g,polylineCenter:x},q={project:function(s){return new K(s.lng,s.lat)},unproject:function(s){return new fe(s.y,s.x)},bounds:new we([-180,-90],[180,90])},Q={R:6378137,R_MINOR:6356752314245179e-9,bounds:new we([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(s){var l=Math.PI/180,f=this.R,p=s.lat*l,_=this.R_MINOR/f,I=Math.sqrt(1-_*_),O=I*Math.sin(p),$=Math.tan(Math.PI/4-p/2)/Math.pow((1-O)/(1+O),I/2);return p=-f*Math.log(Math.max($,1e-10)),new K(s.lng*l*f,p)},unproject:function(s){for(var l=180/Math.PI,f=this.R,p=this.R_MINOR/f,_=Math.sqrt(1-p*p),I=Math.exp(-s.y/f),O=Math.PI/2-2*Math.atan(I),$=0,Z=.1,ee;$<15&&Math.abs(Z)>1e-7;$++)ee=_*Math.sin(O),ee=Math.pow((1-ee)/(1+ee),_/2),Z=Math.PI/2-2*Math.atan(I*ee)-O,O+=Z;return new fe(O*l,s.x*l/f)}},oe={__proto__:null,LonLat:q,Mercator:Q,SphericalMercator:Pt},nt=i({},lt,{code:"EPSG:3395",projection:Q,transformation:function(){var s=.5/(Math.PI*Q.R);return an(s,.5,-s,.5)}()}),Vt=i({},lt,{code:"EPSG:4326",projection:q,transformation:an(1/180,1,-1/180,.5)}),Ge=i({},De,{projection:q,transformation:an(1,0,-1,0),scale:function(s){return Math.pow(2,s)},zoom:function(s){return Math.log(s)/Math.LN2},distance:function(s,l){var f=l.lng-s.lng,p=l.lat-s.lat;return Math.sqrt(f*f+p*p)},infinite:!0});De.Earth=lt,De.EPSG3395=nt,De.EPSG3857=Xe,De.EPSG900913=ft,De.EPSG4326=Vt,De.Simple=Ge;var ot=Re.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(s){return s.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(s){return s&&s.removeLayer(this),this},getPane:function(s){return this._map.getPane(s?this.options[s]||s:this.options.pane)},addInteractiveTarget:function(s){return this._map._targets[h(s)]=this,this},removeInteractiveTarget:function(s){return delete this._map._targets[h(s)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(s){var l=s.target;if(l.hasLayer(this)){if(this._map=l,this._zoomAnimated=l._zoomAnimated,this.getEvents){var f=this.getEvents();l.on(f,this),this.once("remove",function(){l.off(f,this)},this)}this.onAdd(l),this.fire("add"),l.fire("layeradd",{layer:this})}}});Be.include({addLayer:function(s){if(!s._layerAdd)throw new Error("The provided object is not a Layer.");var l=h(s);return this._layers[l]?this:(this._layers[l]=s,s._mapToAdd=this,s.beforeAdd&&s.beforeAdd(this),this.whenReady(s._layerAdd,s),this)},removeLayer:function(s){var l=h(s);return this._layers[l]?(this._loaded&&s.onRemove(this),delete this._layers[l],this._loaded&&(this.fire("layerremove",{layer:s}),s.fire("remove")),s._map=s._mapToAdd=null,this):this},hasLayer:function(s){return h(s)in this._layers},eachLayer:function(s,l){for(var f in this._layers)s.call(l,this._layers[f]);return this},_addLayers:function(s){s=s?A(s)?s:[s]:[];for(var l=0,f=s.length;l<f;l++)this.addLayer(s[l])},_addZoomLimit:function(s){(!isNaN(s.options.maxZoom)||!isNaN(s.options.minZoom))&&(this._zoomBoundLayers[h(s)]=s,this._updateZoomLevels())},_removeZoomLimit:function(s){var l=h(s);this._zoomBoundLayers[l]&&(delete this._zoomBoundLayers[l],this._updateZoomLevels())},_updateZoomLevels:function(){var s=1/0,l=-1/0,f=this._getZoomSpan();for(var p in this._zoomBoundLayers){var _=this._zoomBoundLayers[p].options;s=_.minZoom===void 0?s:Math.min(s,_.minZoom),l=_.maxZoom===void 0?l:Math.max(l,_.maxZoom)}this._layersMaxZoom=l===-1/0?void 0:l,this._layersMinZoom=s===1/0?void 0:s,f!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Tt=ot.extend({initialize:function(s,l){P(this,l),this._layers={};var f,p;if(s)for(f=0,p=s.length;f<p;f++)this.addLayer(s[f])},addLayer:function(s){var l=this.getLayerId(s);return this._layers[l]=s,this._map&&this._map.addLayer(s),this},removeLayer:function(s){var l=s in this._layers?s:this.getLayerId(s);return this._map&&this._layers[l]&&this._map.removeLayer(this._layers[l]),delete this._layers[l],this},hasLayer:function(s){var l=typeof s=="number"?s:this.getLayerId(s);return l in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(s){var l=Array.prototype.slice.call(arguments,1),f,p;for(f in this._layers)p=this._layers[f],p[s]&&p[s].apply(p,l);return this},onAdd:function(s){this.eachLayer(s.addLayer,s)},onRemove:function(s){this.eachLayer(s.removeLayer,s)},eachLayer:function(s,l){for(var f in this._layers)s.call(l,this._layers[f]);return this},getLayer:function(s){return this._layers[s]},getLayers:function(){var s=[];return this.eachLayer(s.push,s),s},setZIndex:function(s){return this.invoke("setZIndex",s)},getLayerId:function(s){return h(s)}}),Is=function(s,l){return new Tt(s,l)},Dt=Tt.extend({addLayer:function(s){return this.hasLayer(s)?this:(s.addEventParent(this),Tt.prototype.addLayer.call(this,s),this.fire("layeradd",{layer:s}))},removeLayer:function(s){return this.hasLayer(s)?(s in this._layers&&(s=this._layers[s]),s.removeEventParent(this),Tt.prototype.removeLayer.call(this,s),this.fire("layerremove",{layer:s})):this},setStyle:function(s){return this.invoke("setStyle",s)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var s=new me;for(var l in this._layers){var f=this._layers[l];s.extend(f.getBounds?f.getBounds():f.getLatLng())}return s}}),Ma=function(s,l){return new Dt(s,l)},si=le.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(s){P(this,s)},createIcon:function(s){return this._createIcon("icon",s)},createShadow:function(s){return this._createIcon("shadow",s)},_createIcon:function(s,l){var f=this._getIconUrl(s);if(!f){if(s==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var p=this._createImg(f,l&&l.tagName==="IMG"?l:null);return this._setIconStyles(p,s),(this.options.crossOrigin||this.options.crossOrigin==="")&&(p.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),p},_setIconStyles:function(s,l){var f=this.options,p=f[l+"Size"];typeof p=="number"&&(p=[p,p]);var _=X(p),I=X(l==="shadow"&&f.shadowAnchor||f.iconAnchor||_&&_.divideBy(2,!0));s.className="leaflet-marker-"+l+" "+(f.className||""),I&&(s.style.marginLeft=-I.x+"px",s.style.marginTop=-I.y+"px"),_&&(s.style.width=_.x+"px",s.style.height=_.y+"px")},_createImg:function(s,l){return l=l||document.createElement("img"),l.src=s,l},_getIconUrl:function(s){return se.retina&&this.options[s+"RetinaUrl"]||this.options[s+"Url"]}});function hP(s){return new si(s)}var yc=si.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(s){return typeof yc.imagePath!="string"&&(yc.imagePath=this._detectIconPath()),(this.options.imagePath||yc.imagePath)+si.prototype._getIconUrl.call(this,s)},_stripUrl:function(s){var l=function(f,p,_){var I=p.exec(f);return I&&I[_]};return s=l(s,/^url\((['"])?(.+)\1\)$/,2),s&&l(s,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var s=Me("div","leaflet-default-icon-path",document.body),l=Dr(s,"background-image")||Dr(s,"backgroundImage");if(document.body.removeChild(s),l=this._stripUrl(l),l)return l;var f=document.querySelector('link[href$="leaflet.css"]');return f?f.href.substring(0,f.href.length-11-1):""}}),$v=Jn.extend({initialize:function(s){this._marker=s},addHooks:function(){var s=this._marker._icon;this._draggable||(this._draggable=new Or(s,s,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),re(s,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&ge(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(s){var l=this._marker,f=l._map,p=this._marker.options.autoPanSpeed,_=this._marker.options.autoPanPadding,I=Rn(l._icon),O=f.getPixelBounds(),$=f.getPixelOrigin(),Z=ue(O.min._subtract($).add(_),O.max._subtract($).subtract(_));if(!Z.contains(I)){var ee=X((Math.max(Z.max.x,I.x)-Z.max.x)/(O.max.x-Z.max.x)-(Math.min(Z.min.x,I.x)-Z.min.x)/(O.min.x-Z.min.x),(Math.max(Z.max.y,I.y)-Z.max.y)/(O.max.y-Z.max.y)-(Math.min(Z.min.y,I.y)-Z.min.y)/(O.min.y-Z.min.y)).multiplyBy(p);f.panBy(ee,{animate:!1}),this._draggable._newPos._add(ee),this._draggable._startPos._add(ee),Ne(l._icon,this._draggable._newPos),this._onDrag(s),this._panRequest=V(this._adjustPan.bind(this,s))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(s){this._marker.options.autoPan&&(U(this._panRequest),this._panRequest=V(this._adjustPan.bind(this,s)))},_onDrag:function(s){var l=this._marker,f=l._shadow,p=Rn(l._icon),_=l._map.layerPointToLatLng(p);f&&Ne(f,p),l._latlng=_,s.latlng=_,s.oldLatLng=this._oldLatLng,l.fire("move",s).fire("drag",s)},_onDragEnd:function(s){U(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",s)}}),bd=ot.extend({options:{icon:new yc,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(s,l){P(this,l),this._latlng=de(s)},onAdd:function(s){this._zoomAnimated=this._zoomAnimated&&s.options.markerZoomAnimation,this._zoomAnimated&&s.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(s){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&s.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(s){var l=this._latlng;return this._latlng=de(s),this.update(),this.fire("move",{oldLatLng:l,latlng:this._latlng})},setZIndexOffset:function(s){return this.options.zIndexOffset=s,this.update()},getIcon:function(){return this.options.icon},setIcon:function(s){return this.options.icon=s,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var s=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(s)}return this},_initIcon:function(){var s=this.options,l="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),f=s.icon.createIcon(this._icon),p=!1;f!==this._icon&&(this._icon&&this._removeIcon(),p=!0,s.title&&(f.title=s.title),f.tagName==="IMG"&&(f.alt=s.alt||"")),re(f,l),s.keyboard&&(f.tabIndex="0",f.setAttribute("role","button")),this._icon=f,s.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&ke(f,"focus",this._panOnFocus,this);var _=s.icon.createShadow(this._shadow),I=!1;_!==this._shadow&&(this._removeShadow(),I=!0),_&&(re(_,l),_.alt=""),this._shadow=_,s.opacity<1&&this._updateOpacity(),p&&this.getPane().appendChild(this._icon),this._initInteraction(),_&&I&&this.getPane(s.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&st(this._icon,"focus",this._panOnFocus,this),et(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&et(this._shadow),this._shadow=null},_setPos:function(s){this._icon&&Ne(this._icon,s),this._shadow&&Ne(this._shadow,s),this._zIndex=s.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(s){this._icon&&(this._icon.style.zIndex=this._zIndex+s)},_animateZoom:function(s){var l=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center).round();this._setPos(l)},_initInteraction:function(){if(this.options.interactive&&(re(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),$v)){var s=this.options.draggable;this.dragging&&(s=this.dragging.enabled(),this.dragging.disable()),this.dragging=new $v(this),s&&this.dragging.enable()}},setOpacity:function(s){return this.options.opacity=s,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var s=this.options.opacity;this._icon&&We(this._icon,s),this._shadow&&We(this._shadow,s)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var s=this._map;if(s){var l=this.options.icon.options,f=l.iconSize?X(l.iconSize):X(0,0),p=l.iconAnchor?X(l.iconAnchor):X(0,0);s.panInside(this._latlng,{paddingTopLeft:p,paddingBottomRight:f.subtract(p)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function fP(s,l){return new bd(s,l)}var Ts=ot.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(s){this._renderer=s.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(s){return P(this,s),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&s&&Object.prototype.hasOwnProperty.call(s,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Id=Ts.extend({options:{fill:!0,radius:10},initialize:function(s,l){P(this,l),this._latlng=de(s),this._radius=this.options.radius},setLatLng:function(s){var l=this._latlng;return this._latlng=de(s),this.redraw(),this.fire("move",{oldLatLng:l,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(s){return this.options.radius=this._radius=s,this.redraw()},getRadius:function(){return this._radius},setStyle:function(s){var l=s&&s.radius||this._radius;return Ts.prototype.setStyle.call(this,s),this.setRadius(l),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var s=this._radius,l=this._radiusY||s,f=this._clickTolerance(),p=[s+f,l+f];this._pxBounds=new we(this._point.subtract(p),this._point.add(p))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(s){return s.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function mP(s,l){return new Id(s,l)}var Fm=Id.extend({initialize:function(s,l,f){if(typeof l=="number"&&(l=i({},f,{radius:l})),P(this,l),this._latlng=de(s),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(s){return this._mRadius=s,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var s=[this._radius,this._radiusY||this._radius];return new me(this._map.layerPointToLatLng(this._point.subtract(s)),this._map.layerPointToLatLng(this._point.add(s)))},setStyle:Ts.prototype.setStyle,_project:function(){var s=this._latlng.lng,l=this._latlng.lat,f=this._map,p=f.options.crs;if(p.distance===lt.distance){var _=Math.PI/180,I=this._mRadius/lt.R/_,O=f.project([l+I,s]),$=f.project([l-I,s]),Z=O.add($).divideBy(2),ee=f.unproject(Z).lat,pe=Math.acos((Math.cos(I*_)-Math.sin(l*_)*Math.sin(ee*_))/(Math.cos(l*_)*Math.cos(ee*_)))/_;(isNaN(pe)||pe===0)&&(pe=I/Math.cos(Math.PI/180*l)),this._point=Z.subtract(f.getPixelOrigin()),this._radius=isNaN(pe)?0:Z.x-f.project([ee,s-pe]).x,this._radiusY=Z.y-O.y}else{var Se=p.unproject(p.project(this._latlng).subtract([this._mRadius,0]));this._point=f.latLngToLayerPoint(this._latlng),this._radius=this._point.x-f.latLngToLayerPoint(Se).x}this._updateBounds()}});function pP(s,l,f){return new Fm(s,l,f)}var Ai=Ts.extend({options:{smoothFactor:1,noClip:!1},initialize:function(s,l){P(this,l),this._setLatLngs(s)},getLatLngs:function(){return this._latlngs},setLatLngs:function(s){return this._setLatLngs(s),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(s){for(var l=1/0,f=null,p=yr,_,I,O=0,$=this._parts.length;O<$;O++)for(var Z=this._parts[O],ee=1,pe=Z.length;ee<pe;ee++){_=Z[ee-1],I=Z[ee];var Se=p(s,_,I,!0);Se<l&&(l=Se,f=p(s,_,I))}return f&&(f.distance=Math.sqrt(l)),f},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return x(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(s,l){return l=l||this._defaultShape(),s=de(s),l.push(s),this._bounds.extend(s),this.redraw()},_setLatLngs:function(s){this._bounds=new me,this._latlngs=this._convertLatLngs(s)},_defaultShape:function(){return d(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(s){for(var l=[],f=d(s),p=0,_=s.length;p<_;p++)f?(l[p]=de(s[p]),this._bounds.extend(l[p])):l[p]=this._convertLatLngs(s[p]);return l},_project:function(){var s=new we;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,s),this._bounds.isValid()&&s.isValid()&&(this._rawPxBounds=s,this._updateBounds())},_updateBounds:function(){var s=this._clickTolerance(),l=new K(s,s);this._rawPxBounds&&(this._pxBounds=new we([this._rawPxBounds.min.subtract(l),this._rawPxBounds.max.add(l)]))},_projectLatlngs:function(s,l,f){var p=s[0]instanceof fe,_=s.length,I,O;if(p){for(O=[],I=0;I<_;I++)O[I]=this._map.latLngToLayerPoint(s[I]),f.extend(O[I]);l.push(O)}else for(I=0;I<_;I++)this._projectLatlngs(s[I],l,f)},_clipPoints:function(){var s=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}var l=this._parts,f,p,_,I,O,$,Z;for(f=0,_=0,I=this._rings.length;f<I;f++)for(Z=this._rings[f],p=0,O=Z.length;p<O-1;p++)$=wo(Z[p],Z[p+1],s,p,!0),$&&(l[_]=l[_]||[],l[_].push($[0]),($[1]!==Z[p+1]||p===O-2)&&(l[_].push($[1]),_++))}},_simplifyPoints:function(){for(var s=this._parts,l=this.options.smoothFactor,f=0,p=s.length;f<p;f++)s[f]=mc(s[f],l)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(s,l){var f,p,_,I,O,$,Z=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(f=0,I=this._parts.length;f<I;f++)for($=this._parts[f],p=0,O=$.length,_=O-1;p<O;_=p++)if(!(!l&&p===0)&&pc(s,$[_],$[p])<=Z)return!0;return!1}});function gP(s,l){return new Ai(s,l)}Ai._flat=g;var Oa=Ai.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ra(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(s){var l=Ai.prototype._convertLatLngs.call(this,s),f=l.length;return f>=2&&l[0]instanceof fe&&l[0].equals(l[f-1])&&l.pop(),l},_setLatLngs:function(s){Ai.prototype._setLatLngs.call(this,s),d(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return d(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var s=this._renderer._bounds,l=this.options.weight,f=new K(l,l);if(s=new we(s.min.subtract(f),s.max.add(f)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}for(var p=0,_=this._rings.length,I;p<_;p++)I=Ca(this._rings[p],s,!0),I.length&&this._parts.push(I)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(s){var l=!1,f,p,_,I,O,$,Z,ee;if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(I=0,Z=this._parts.length;I<Z;I++)for(f=this._parts[I],O=0,ee=f.length,$=ee-1;O<ee;$=O++)p=f[O],_=f[$],p.y>s.y!=_.y>s.y&&s.x<(_.x-p.x)*(s.y-p.y)/(_.y-p.y)+p.x&&(l=!l);return l||Ai.prototype._containsPoint.call(this,s,!0)}});function yP(s,l){return new Oa(s,l)}var Ci=Dt.extend({initialize:function(s,l){P(this,l),this._layers={},s&&this.addData(s)},addData:function(s){var l=A(s)?s:s.features,f,p,_;if(l){for(f=0,p=l.length;f<p;f++)_=l[f],(_.geometries||_.geometry||_.features||_.coordinates)&&this.addData(_);return this}var I=this.options;if(I.filter&&!I.filter(s))return this;var O=Td(s,I);return O?(O.feature=Sd(s),O.defaultOptions=O.options,this.resetStyle(O),I.onEachFeature&&I.onEachFeature(s,O),this.addLayer(O)):this},resetStyle:function(s){return s===void 0?this.eachLayer(this.resetStyle,this):(s.options=i({},s.defaultOptions),this._setLayerStyle(s,this.options.style),this)},setStyle:function(s){return this.eachLayer(function(l){this._setLayerStyle(l,s)},this)},_setLayerStyle:function(s,l){s.setStyle&&(typeof l=="function"&&(l=l(s.feature)),s.setStyle(l))}});function Td(s,l){var f=s.type==="Feature"?s.geometry:s,p=f?f.coordinates:null,_=[],I=l&&l.pointToLayer,O=l&&l.coordsToLatLng||Um,$,Z,ee,pe;if(!p&&!f)return null;switch(f.type){case"Point":return $=O(p),Hv(I,s,$,l);case"MultiPoint":for(ee=0,pe=p.length;ee<pe;ee++)$=O(p[ee]),_.push(Hv(I,s,$,l));return new Dt(_);case"LineString":case"MultiLineString":return Z=Ed(p,f.type==="LineString"?0:1,O),new Ai(Z,l);case"Polygon":case"MultiPolygon":return Z=Ed(p,f.type==="Polygon"?1:2,O),new Oa(Z,l);case"GeometryCollection":for(ee=0,pe=f.geometries.length;ee<pe;ee++){var Se=Td({geometry:f.geometries[ee],type:"Feature",properties:s.properties},l);Se&&_.push(Se)}return new Dt(_);case"FeatureCollection":for(ee=0,pe=f.features.length;ee<pe;ee++){var Ve=Td(f.features[ee],l);Ve&&_.push(Ve)}return new Dt(_);default:throw new Error("Invalid GeoJSON object.")}}function Hv(s,l,f,p){return s?s(l,f):new bd(f,p&&p.markersInheritOptions&&p)}function Um(s){return new fe(s[1],s[0],s[2])}function Ed(s,l,f){for(var p=[],_=0,I=s.length,O;_<I;_++)O=l?Ed(s[_],l-1,f):(f||Um)(s[_]),p.push(O);return p}function Bm(s,l){return s=de(s),s.alt!==void 0?[w(s.lng,l),w(s.lat,l),w(s.alt,l)]:[w(s.lng,l),w(s.lat,l)]}function kd(s,l,f,p){for(var _=[],I=0,O=s.length;I<O;I++)_.push(l?kd(s[I],d(s[I])?0:l-1,f,p):Bm(s[I],p));return!l&&f&&_.length>0&&_.push(_[0].slice()),_}function Va(s,l){return s.feature?i({},s.feature,{geometry:l}):Sd(l)}function Sd(s){return s.type==="Feature"||s.type==="FeatureCollection"?s:{type:"Feature",properties:{},geometry:s}}var zm={toGeoJSON:function(s){return Va(this,{type:"Point",coordinates:Bm(this.getLatLng(),s)})}};bd.include(zm),Fm.include(zm),Id.include(zm),Ai.include({toGeoJSON:function(s){var l=!d(this._latlngs),f=kd(this._latlngs,l?1:0,!1,s);return Va(this,{type:(l?"Multi":"")+"LineString",coordinates:f})}}),Oa.include({toGeoJSON:function(s){var l=!d(this._latlngs),f=l&&!d(this._latlngs[0]),p=kd(this._latlngs,f?2:l?1:0,!0,s);return l||(p=[p]),Va(this,{type:(f?"Multi":"")+"Polygon",coordinates:p})}}),Tt.include({toMultiPoint:function(s){var l=[];return this.eachLayer(function(f){l.push(f.toGeoJSON(s).geometry.coordinates)}),Va(this,{type:"MultiPoint",coordinates:l})},toGeoJSON:function(s){var l=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(l==="MultiPoint")return this.toMultiPoint(s);var f=l==="GeometryCollection",p=[];return this.eachLayer(function(_){if(_.toGeoJSON){var I=_.toGeoJSON(s);if(f)p.push(I.geometry);else{var O=Sd(I);O.type==="FeatureCollection"?p.push.apply(p,O.features):p.push(O)}}}),f?Va(this,{geometries:p,type:"GeometryCollection"}):{type:"FeatureCollection",features:p}}});function Wv(s,l){return new Ci(s,l)}var _P=Wv,Pd=ot.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(s,l,f){this._url=s,this._bounds=_e(l),P(this,f)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(re(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){et(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(s){return this.options.opacity=s,this._image&&this._updateOpacity(),this},setStyle:function(s){return s.opacity&&this.setOpacity(s.opacity),this},bringToFront:function(){return this._map&&j(this._image),this},bringToBack:function(){return this._map&&Y(this._image),this},setUrl:function(s){return this._url=s,this._image&&(this._image.src=s),this},setBounds:function(s){return this._bounds=_e(s),this._map&&this._reset(),this},getEvents:function(){var s={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var s=this._url.tagName==="IMG",l=this._image=s?this._url:Me("img");if(re(l,"leaflet-image-layer"),this._zoomAnimated&&re(l,"leaflet-zoom-animated"),this.options.className&&re(l,this.options.className),l.onselectstart=v,l.onmousemove=v,l.onload=a(this.fire,this,"load"),l.onerror=a(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(l.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),s){this._url=l.src;return}l.src=this._url,l.alt=this.options.alt},_animateZoom:function(s){var l=this._map.getZoomScale(s.zoom),f=this._map._latLngBoundsToNewLayerBounds(this._bounds,s.zoom,s.center).min;fr(this._image,f,l)},_reset:function(){var s=this._image,l=new we(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),f=l.getSize();Ne(s,l.min),s.style.width=f.x+"px",s.style.height=f.y+"px"},_updateOpacity:function(){We(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var s=this.options.errorOverlayUrl;s&&this._url!==s&&(this._url=s,this._image.src=s)},getCenter:function(){return this._bounds.getCenter()}}),vP=function(s,l,f){return new Pd(s,l,f)},Gv=Pd.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var s=this._url.tagName==="VIDEO",l=this._image=s?this._url:Me("video");if(re(l,"leaflet-image-layer"),this._zoomAnimated&&re(l,"leaflet-zoom-animated"),this.options.className&&re(l,this.options.className),l.onselectstart=v,l.onmousemove=v,l.onloadeddata=a(this.fire,this,"load"),s){for(var f=l.getElementsByTagName("source"),p=[],_=0;_<f.length;_++)p.push(f[_].src);this._url=f.length>0?p:[l.src];return}A(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(l.style,"objectFit")&&(l.style.objectFit="fill"),l.autoplay=!!this.options.autoplay,l.loop=!!this.options.loop,l.muted=!!this.options.muted,l.playsInline=!!this.options.playsInline;for(var I=0;I<this._url.length;I++){var O=Me("source");O.src=this._url[I],l.appendChild(O)}}});function xP(s,l,f){return new Gv(s,l,f)}var Kv=Pd.extend({_initImage:function(){var s=this._image=this._url;re(s,"leaflet-image-layer"),this._zoomAnimated&&re(s,"leaflet-zoom-animated"),this.options.className&&re(s,this.options.className),s.onselectstart=v,s.onmousemove=v}});function wP(s,l,f){return new Kv(s,l,f)}var oi=ot.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(s,l){s&&(s instanceof fe||A(s))?(this._latlng=de(s),P(this,l)):(P(this,s),this._source=l),this.options.content&&(this._content=this.options.content)},openOn:function(s){return s=arguments.length?s:this._source._map,s.hasLayer(this)||s.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(s){return this._map?this.close():(arguments.length?this._source=s:s=this._source,this._prepareOpen(),this.openOn(s._map)),this},onAdd:function(s){this._zoomAnimated=s._zoomAnimated,this._container||this._initLayout(),s._fadeAnimated&&We(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),s._fadeAnimated&&We(this._container,1),this.bringToFront(),this.options.interactive&&(re(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(s){s._fadeAnimated?(We(this._container,0),this._removeTimeout=setTimeout(a(et,void 0,this._container),200)):et(this._container),this.options.interactive&&(ge(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(s){return this._latlng=de(s),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(s){return this._content=s,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var s={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&j(this._container),this},bringToBack:function(){return this._map&&Y(this._container),this},_prepareOpen:function(s){var l=this._source;if(!l._map)return!1;if(l instanceof Dt){l=null;var f=this._source._layers;for(var p in f)if(f[p]._map){l=f[p];break}if(!l)return!1;this._source=l}if(!s)if(l.getCenter)s=l.getCenter();else if(l.getLatLng)s=l.getLatLng();else if(l.getBounds)s=l.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(s),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var s=this._contentNode,l=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof l=="string")s.innerHTML=l;else{for(;s.hasChildNodes();)s.removeChild(s.firstChild);s.appendChild(l)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var s=this._map.latLngToLayerPoint(this._latlng),l=X(this.options.offset),f=this._getAnchor();this._zoomAnimated?Ne(this._container,s.add(f)):l=l.add(s).add(f);var p=this._containerBottom=-l.y,_=this._containerLeft=-Math.round(this._containerWidth/2)+l.x;this._container.style.bottom=p+"px",this._container.style.left=_+"px"}},_getAnchor:function(){return[0,0]}});Be.include({_initOverlay:function(s,l,f,p){var _=l;return _ instanceof s||(_=new s(p).setContent(l)),f&&_.setLatLng(f),_}}),ot.include({_initOverlay:function(s,l,f,p){var _=f;return _ instanceof s?(P(_,p),_._source=this):(_=l&&!p?l:new s(p,this),_.setContent(f)),_}});var Nd=oi.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(s){return s=arguments.length?s:this._source._map,!s.hasLayer(this)&&s._popup&&s._popup.options.autoClose&&s.removeLayer(s._popup),s._popup=this,oi.prototype.openOn.call(this,s)},onAdd:function(s){oi.prototype.onAdd.call(this,s),s.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Ts||this._source.on("preclick",gr))},onRemove:function(s){oi.prototype.onRemove.call(this,s),s.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Ts||this._source.off("preclick",gr))},getEvents:function(){var s=oi.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(s.preclick=this.close),this.options.keepInView&&(s.moveend=this._adjustPan),s},_initLayout:function(){var s="leaflet-popup",l=this._container=Me("div",s+" "+(this.options.className||"")+" leaflet-zoom-animated"),f=this._wrapper=Me("div",s+"-content-wrapper",l);if(this._contentNode=Me("div",s+"-content",f),ws(l),xs(this._contentNode),ke(l,"contextmenu",gr),this._tipContainer=Me("div",s+"-tip-container",l),this._tip=Me("div",s+"-tip",this._tipContainer),this.options.closeButton){var p=this._closeButton=Me("a",s+"-close-button",l);p.setAttribute("role","button"),p.setAttribute("aria-label","Close popup"),p.href="#close",p.innerHTML='<span aria-hidden="true">&#215;</span>',ke(p,"click",function(_){It(_),this.close()},this)}},_updateLayout:function(){var s=this._contentNode,l=s.style;l.width="",l.whiteSpace="nowrap";var f=s.offsetWidth;f=Math.min(f,this.options.maxWidth),f=Math.max(f,this.options.minWidth),l.width=f+1+"px",l.whiteSpace="",l.height="";var p=s.offsetHeight,_=this.options.maxHeight,I="leaflet-popup-scrolled";_&&p>_?(l.height=_+"px",re(s,I)):ge(s,I),this._containerWidth=this._container.offsetWidth},_animateZoom:function(s){var l=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center),f=this._getAnchor();Ne(this._container,l.add(f))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var s=this._map,l=parseInt(Dr(this._container,"marginBottom"),10)||0,f=this._container.offsetHeight+l,p=this._containerWidth,_=new K(this._containerLeft,-f-this._containerBottom);_._add(Rn(this._container));var I=s.layerPointToContainerPoint(_),O=X(this.options.autoPanPadding),$=X(this.options.autoPanPaddingTopLeft||O),Z=X(this.options.autoPanPaddingBottomRight||O),ee=s.getSize(),pe=0,Se=0;I.x+p+Z.x>ee.x&&(pe=I.x+p-ee.x+Z.x),I.x-pe-$.x<0&&(pe=I.x-$.x),I.y+f+Z.y>ee.y&&(Se=I.y+f-ee.y+Z.y),I.y-Se-$.y<0&&(Se=I.y-$.y),(pe||Se)&&(this.options.keepInView&&(this._autopanning=!0),s.fire("autopanstart").panBy([pe,Se]))}},_getAnchor:function(){return X(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),bP=function(s,l){return new Nd(s,l)};Be.mergeOptions({closePopupOnClick:!0}),Be.include({openPopup:function(s,l,f){return this._initOverlay(Nd,s,l,f).openOn(this),this},closePopup:function(s){return s=arguments.length?s:this._popup,s&&s.close(),this}}),ot.include({bindPopup:function(s,l){return this._popup=this._initOverlay(Nd,this._popup,s,l),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(s){return this._popup&&(this instanceof Dt||(this._popup._source=this),this._popup._prepareOpen(s||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(s){return this._popup&&this._popup.setContent(s),this},getPopup:function(){return this._popup},_openPopup:function(s){if(!(!this._popup||!this._map)){Yn(s);var l=s.layer||s.target;if(this._popup._source===l&&!(l instanceof Ts)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(s.latlng);return}this._popup._source=l,this.openPopup(s.latlng)}},_movePopup:function(s){this._popup.setLatLng(s.latlng)},_onKeyPress:function(s){s.originalEvent.keyCode===13&&this._openPopup(s)}});var Ad=oi.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(s){oi.prototype.onAdd.call(this,s),this.setOpacity(this.options.opacity),s.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(s){oi.prototype.onRemove.call(this,s),s.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var s=oi.prototype.getEvents.call(this);return this.options.permanent||(s.preclick=this.close),s},_initLayout:function(){var s="leaflet-tooltip",l=s+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Me("div",l),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+h(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(s){var l,f,p=this._map,_=this._container,I=p.latLngToContainerPoint(p.getCenter()),O=p.layerPointToContainerPoint(s),$=this.options.direction,Z=_.offsetWidth,ee=_.offsetHeight,pe=X(this.options.offset),Se=this._getAnchor();$==="top"?(l=Z/2,f=ee):$==="bottom"?(l=Z/2,f=0):$==="center"?(l=Z/2,f=ee/2):$==="right"?(l=0,f=ee/2):$==="left"?(l=Z,f=ee/2):O.x<I.x?($="right",l=0,f=ee/2):($="left",l=Z+(pe.x+Se.x)*2,f=ee/2),s=s.subtract(X(l,f,!0)).add(pe).add(Se),ge(_,"leaflet-tooltip-right"),ge(_,"leaflet-tooltip-left"),ge(_,"leaflet-tooltip-top"),ge(_,"leaflet-tooltip-bottom"),re(_,"leaflet-tooltip-"+$),Ne(_,s)},_updatePosition:function(){var s=this._map.latLngToLayerPoint(this._latlng);this._setPosition(s)},setOpacity:function(s){this.options.opacity=s,this._container&&We(this._container,s)},_animateZoom:function(s){var l=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center);this._setPosition(l)},_getAnchor:function(){return X(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),IP=function(s,l){return new Ad(s,l)};Be.include({openTooltip:function(s,l,f){return this._initOverlay(Ad,s,l,f).openOn(this),this},closeTooltip:function(s){return s.close(),this}}),ot.include({bindTooltip:function(s,l){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Ad,this._tooltip,s,l),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(s){if(!(!s&&this._tooltipHandlersAdded)){var l=s?"off":"on",f={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?f.add=this._openTooltip:(f.mouseover=this._openTooltip,f.mouseout=this.closeTooltip,f.click=this._openTooltip,this._map?this._addFocusListeners():f.add=this._addFocusListeners),this._tooltip.options.sticky&&(f.mousemove=this._moveTooltip),this[l](f),this._tooltipHandlersAdded=!s}},openTooltip:function(s){return this._tooltip&&(this instanceof Dt||(this._tooltip._source=this),this._tooltip._prepareOpen(s)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(s){return this._tooltip&&this._tooltip.setContent(s),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(s){var l=typeof s.getElement=="function"&&s.getElement();l&&(ke(l,"focus",function(){this._tooltip._source=s,this.openTooltip()},this),ke(l,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(s){var l=typeof s.getElement=="function"&&s.getElement();l&&l.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(s){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var l=this;this._map.once("moveend",function(){l._openOnceFlag=!1,l._openTooltip(s)});return}this._tooltip._source=s.layer||s.target,this.openTooltip(this._tooltip.options.sticky?s.latlng:void 0)}},_moveTooltip:function(s){var l=s.latlng,f,p;this._tooltip.options.sticky&&s.originalEvent&&(f=this._map.mouseEventToContainerPoint(s.originalEvent),p=this._map.containerPointToLayerPoint(f),l=this._map.layerPointToLatLng(p)),this._tooltip.setLatLng(l)}});var Zv=si.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(s){var l=s&&s.tagName==="DIV"?s:document.createElement("div"),f=this.options;if(f.html instanceof Element?(ri(l),l.appendChild(f.html)):l.innerHTML=f.html!==!1?f.html:"",f.bgPos){var p=X(f.bgPos);l.style.backgroundPosition=-p.x+"px "+-p.y+"px"}return this._setIconStyles(l,"icon"),l},createShadow:function(){return null}});function TP(s){return new Zv(s)}si.Default=yc;var _c=ot.extend({options:{tileSize:256,opacity:1,updateWhenIdle:se.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(s){P(this,s)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(s){s._addZoomLimit(this)},onRemove:function(s){this._removeAllTiles(),et(this._container),s._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(j(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Y(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(s){return this.options.opacity=s,this._updateOpacity(),this},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var s=this._clampZoom(this._map.getZoom());s!==this._tileZoom&&(this._tileZoom=s,this._updateLevels()),this._update()}return this},getEvents:function(){var s={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=m(this._onMoveEnd,this.options.updateInterval,this)),s.move=this._onMove),this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},createTile:function(){return document.createElement("div")},getTileSize:function(){var s=this.options.tileSize;return s instanceof K?s:new K(s,s)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(s){for(var l=this.getPane().children,f=-s(-1/0,1/0),p=0,_=l.length,I;p<_;p++)I=l[p].style.zIndex,l[p]!==this._container&&I&&(f=s(f,+I));isFinite(f)&&(this.options.zIndex=f+s(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!se.ielt9){We(this._container,this.options.opacity);var s=+new Date,l=!1,f=!1;for(var p in this._tiles){var _=this._tiles[p];if(!(!_.current||!_.loaded)){var I=Math.min(1,(s-_.loaded)/200);We(_.el,I),I<1?l=!0:(_.active?f=!0:this._onOpaqueTile(_),_.active=!0)}}f&&!this._noPrune&&this._pruneTiles(),l&&(U(this._fadeFrame),this._fadeFrame=V(this._updateOpacity,this))}},_onOpaqueTile:v,_initContainer:function(){this._container||(this._container=Me("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var s=this._tileZoom,l=this.options.maxZoom;if(s!==void 0){for(var f in this._levels)f=Number(f),this._levels[f].el.children.length||f===s?(this._levels[f].el.style.zIndex=l-Math.abs(s-f),this._onUpdateLevel(f)):(et(this._levels[f].el),this._removeTilesAtZoom(f),this._onRemoveLevel(f),delete this._levels[f]);var p=this._levels[s],_=this._map;return p||(p=this._levels[s]={},p.el=Me("div","leaflet-tile-container leaflet-zoom-animated",this._container),p.el.style.zIndex=l,p.origin=_.project(_.unproject(_.getPixelOrigin()),s).round(),p.zoom=s,this._setZoomTransform(p,_.getCenter(),_.getZoom()),v(p.el.offsetWidth),this._onCreateLevel(p)),this._level=p,p}},_onUpdateLevel:v,_onRemoveLevel:v,_onCreateLevel:v,_pruneTiles:function(){if(this._map){var s,l,f=this._map.getZoom();if(f>this.options.maxZoom||f<this.options.minZoom){this._removeAllTiles();return}for(s in this._tiles)l=this._tiles[s],l.retain=l.current;for(s in this._tiles)if(l=this._tiles[s],l.current&&!l.active){var p=l.coords;this._retainParent(p.x,p.y,p.z,p.z-5)||this._retainChildren(p.x,p.y,p.z,p.z+2)}for(s in this._tiles)this._tiles[s].retain||this._removeTile(s)}},_removeTilesAtZoom:function(s){for(var l in this._tiles)this._tiles[l].coords.z===s&&this._removeTile(l)},_removeAllTiles:function(){for(var s in this._tiles)this._removeTile(s)},_invalidateAll:function(){for(var s in this._levels)et(this._levels[s].el),this._onRemoveLevel(Number(s)),delete this._levels[s];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(s,l,f,p){var _=Math.floor(s/2),I=Math.floor(l/2),O=f-1,$=new K(+_,+I);$.z=+O;var Z=this._tileCoordsToKey($),ee=this._tiles[Z];return ee&&ee.active?(ee.retain=!0,!0):(ee&&ee.loaded&&(ee.retain=!0),O>p?this._retainParent(_,I,O,p):!1)},_retainChildren:function(s,l,f,p){for(var _=2*s;_<2*s+2;_++)for(var I=2*l;I<2*l+2;I++){var O=new K(_,I);O.z=f+1;var $=this._tileCoordsToKey(O),Z=this._tiles[$];if(Z&&Z.active){Z.retain=!0;continue}else Z&&Z.loaded&&(Z.retain=!0);f+1<p&&this._retainChildren(_,I,f+1,p)}},_resetView:function(s){var l=s&&(s.pinch||s.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),l,l)},_animateZoom:function(s){this._setView(s.center,s.zoom,!0,s.noUpdate)},_clampZoom:function(s){var l=this.options;return l.minNativeZoom!==void 0&&s<l.minNativeZoom?l.minNativeZoom:l.maxNativeZoom!==void 0&&l.maxNativeZoom<s?l.maxNativeZoom:s},_setView:function(s,l,f,p){var _=Math.round(l);this.options.maxZoom!==void 0&&_>this.options.maxZoom||this.options.minZoom!==void 0&&_<this.options.minZoom?_=void 0:_=this._clampZoom(_);var I=this.options.updateWhenZooming&&_!==this._tileZoom;(!p||I)&&(this._tileZoom=_,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),_!==void 0&&this._update(s),f||this._pruneTiles(),this._noPrune=!!f),this._setZoomTransforms(s,l)},_setZoomTransforms:function(s,l){for(var f in this._levels)this._setZoomTransform(this._levels[f],s,l)},_setZoomTransform:function(s,l,f){var p=this._map.getZoomScale(f,s.zoom),_=s.origin.multiplyBy(p).subtract(this._map._getNewPixelOrigin(l,f)).round();se.any3d?fr(s.el,_,p):Ne(s.el,_)},_resetGrid:function(){var s=this._map,l=s.options.crs,f=this._tileSize=this.getTileSize(),p=this._tileZoom,_=this._map.getPixelWorldBounds(this._tileZoom);_&&(this._globalTileRange=this._pxBoundsToTileRange(_)),this._wrapX=l.wrapLng&&!this.options.noWrap&&[Math.floor(s.project([0,l.wrapLng[0]],p).x/f.x),Math.ceil(s.project([0,l.wrapLng[1]],p).x/f.y)],this._wrapY=l.wrapLat&&!this.options.noWrap&&[Math.floor(s.project([l.wrapLat[0],0],p).y/f.x),Math.ceil(s.project([l.wrapLat[1],0],p).y/f.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(s){var l=this._map,f=l._animatingZoom?Math.max(l._animateToZoom,l.getZoom()):l.getZoom(),p=l.getZoomScale(f,this._tileZoom),_=l.project(s,this._tileZoom).floor(),I=l.getSize().divideBy(p*2);return new we(_.subtract(I),_.add(I))},_update:function(s){var l=this._map;if(l){var f=this._clampZoom(l.getZoom());if(s===void 0&&(s=l.getCenter()),this._tileZoom!==void 0){var p=this._getTiledPixelBounds(s),_=this._pxBoundsToTileRange(p),I=_.getCenter(),O=[],$=this.options.keepBuffer,Z=new we(_.getBottomLeft().subtract([$,-$]),_.getTopRight().add([$,-$]));if(!(isFinite(_.min.x)&&isFinite(_.min.y)&&isFinite(_.max.x)&&isFinite(_.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var ee in this._tiles){var pe=this._tiles[ee].coords;(pe.z!==this._tileZoom||!Z.contains(new K(pe.x,pe.y)))&&(this._tiles[ee].current=!1)}if(Math.abs(f-this._tileZoom)>1){this._setView(s,f);return}for(var Se=_.min.y;Se<=_.max.y;Se++)for(var Ve=_.min.x;Ve<=_.max.x;Ve++){var bn=new K(Ve,Se);if(bn.z=this._tileZoom,!!this._isValidTile(bn)){var Qt=this._tiles[this._tileCoordsToKey(bn)];Qt?Qt.current=!0:O.push(bn)}}if(O.sort(function(Dn,Ua){return Dn.distanceTo(I)-Ua.distanceTo(I)}),O.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var _r=document.createDocumentFragment();for(Ve=0;Ve<O.length;Ve++)this._addTile(O[Ve],_r);this._level.el.appendChild(_r)}}}},_isValidTile:function(s){var l=this._map.options.crs;if(!l.infinite){var f=this._globalTileRange;if(!l.wrapLng&&(s.x<f.min.x||s.x>f.max.x)||!l.wrapLat&&(s.y<f.min.y||s.y>f.max.y))return!1}if(!this.options.bounds)return!0;var p=this._tileCoordsToBounds(s);return _e(this.options.bounds).overlaps(p)},_keyToBounds:function(s){return this._tileCoordsToBounds(this._keyToTileCoords(s))},_tileCoordsToNwSe:function(s){var l=this._map,f=this.getTileSize(),p=s.scaleBy(f),_=p.add(f),I=l.unproject(p,s.z),O=l.unproject(_,s.z);return[I,O]},_tileCoordsToBounds:function(s){var l=this._tileCoordsToNwSe(s),f=new me(l[0],l[1]);return this.options.noWrap||(f=this._map.wrapLatLngBounds(f)),f},_tileCoordsToKey:function(s){return s.x+":"+s.y+":"+s.z},_keyToTileCoords:function(s){var l=s.split(":"),f=new K(+l[0],+l[1]);return f.z=+l[2],f},_removeTile:function(s){var l=this._tiles[s];l&&(et(l.el),delete this._tiles[s],this.fire("tileunload",{tile:l.el,coords:this._keyToTileCoords(s)}))},_initTile:function(s){re(s,"leaflet-tile");var l=this.getTileSize();s.style.width=l.x+"px",s.style.height=l.y+"px",s.onselectstart=v,s.onmousemove=v,se.ielt9&&this.options.opacity<1&&We(s,this.options.opacity)},_addTile:function(s,l){var f=this._getTilePos(s),p=this._tileCoordsToKey(s),_=this.createTile(this._wrapCoords(s),a(this._tileReady,this,s));this._initTile(_),this.createTile.length<2&&V(a(this._tileReady,this,s,null,_)),Ne(_,f),this._tiles[p]={el:_,coords:s,current:!0},l.appendChild(_),this.fire("tileloadstart",{tile:_,coords:s})},_tileReady:function(s,l,f){l&&this.fire("tileerror",{error:l,tile:f,coords:s});var p=this._tileCoordsToKey(s);f=this._tiles[p],f&&(f.loaded=+new Date,this._map._fadeAnimated?(We(f.el,0),U(this._fadeFrame),this._fadeFrame=V(this._updateOpacity,this)):(f.active=!0,this._pruneTiles()),l||(re(f.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:f.el,coords:s})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),se.ielt9||!this._map._fadeAnimated?V(this._pruneTiles,this):setTimeout(a(this._pruneTiles,this),250)))},_getTilePos:function(s){return s.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(s){var l=new K(this._wrapX?y(s.x,this._wrapX):s.x,this._wrapY?y(s.y,this._wrapY):s.y);return l.z=s.z,l},_pxBoundsToTileRange:function(s){var l=this.getTileSize();return new we(s.min.unscaleBy(l).floor(),s.max.unscaleBy(l).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var s in this._tiles)if(!this._tiles[s].loaded)return!1;return!0}});function EP(s){return new _c(s)}var Fa=_c.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(s,l){this._url=s,l=P(this,l),l.detectRetina&&se.retina&&l.maxZoom>0?(l.tileSize=Math.floor(l.tileSize/2),l.zoomReverse?(l.zoomOffset--,l.minZoom=Math.min(l.maxZoom,l.minZoom+1)):(l.zoomOffset++,l.maxZoom=Math.max(l.minZoom,l.maxZoom-1)),l.minZoom=Math.max(0,l.minZoom)):l.zoomReverse?l.minZoom=Math.min(l.maxZoom,l.minZoom):l.maxZoom=Math.max(l.minZoom,l.maxZoom),typeof l.subdomains=="string"&&(l.subdomains=l.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(s,l){return this._url===s&&l===void 0&&(l=!0),this._url=s,l||this.redraw(),this},createTile:function(s,l){var f=document.createElement("img");return ke(f,"load",a(this._tileOnLoad,this,l,f)),ke(f,"error",a(this._tileOnError,this,l,f)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(f.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(f.referrerPolicy=this.options.referrerPolicy),f.alt="",f.src=this.getTileUrl(s),f},getTileUrl:function(s){var l={r:se.retina?"@2x":"",s:this._getSubdomain(s),x:s.x,y:s.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var f=this._globalTileRange.max.y-s.y;this.options.tms&&(l.y=f),l["-y"]=f}return k(this._url,i(l,this.options))},_tileOnLoad:function(s,l){se.ielt9?setTimeout(a(s,this,null,l),0):s(null,l)},_tileOnError:function(s,l,f){var p=this.options.errorTileUrl;p&&l.getAttribute("src")!==p&&(l.src=p),s(f,l)},_onTileRemove:function(s){s.tile.onload=null},_getZoomForUrl:function(){var s=this._tileZoom,l=this.options.maxZoom,f=this.options.zoomReverse,p=this.options.zoomOffset;return f&&(s=l-s),s+p},_getSubdomain:function(s){var l=Math.abs(s.x+s.y)%this.options.subdomains.length;return this.options.subdomains[l]},_abortLoading:function(){var s,l;for(s in this._tiles)if(this._tiles[s].coords.z!==this._tileZoom&&(l=this._tiles[s].el,l.onload=v,l.onerror=v,!l.complete)){l.src=G;var f=this._tiles[s].coords;et(l),delete this._tiles[s],this.fire("tileabort",{tile:l,coords:f})}},_removeTile:function(s){var l=this._tiles[s];if(l)return l.el.setAttribute("src",G),_c.prototype._removeTile.call(this,s)},_tileReady:function(s,l,f){if(!(!this._map||f&&f.getAttribute("src")===G))return _c.prototype._tileReady.call(this,s,l,f)}});function Qv(s,l){return new Fa(s,l)}var Yv=Fa.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(s,l){this._url=s;var f=i({},this.defaultWmsParams);for(var p in l)p in this.options||(f[p]=l[p]);l=P(this,l);var _=l.detectRetina&&se.retina?2:1,I=this.getTileSize();f.width=I.x*_,f.height=I.y*_,this.wmsParams=f},onAdd:function(s){this._crs=this.options.crs||s.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var l=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[l]=this._crs.code,Fa.prototype.onAdd.call(this,s)},getTileUrl:function(s){var l=this._tileCoordsToNwSe(s),f=this._crs,p=ue(f.project(l[0]),f.project(l[1])),_=p.min,I=p.max,O=(this._wmsVersion>=1.3&&this._crs===Vt?[_.y,_.x,I.y,I.x]:[_.x,_.y,I.x,I.y]).join(","),$=Fa.prototype.getTileUrl.call(this,s);return $+F(this.wmsParams,$,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+O},setParams:function(s,l){return i(this.wmsParams,s),l||this.redraw(),this}});function kP(s,l){return new Yv(s,l)}Fa.WMS=Yv,Qv.wms=kP;var Ri=ot.extend({options:{padding:.1},initialize:function(s){P(this,s),h(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),re(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var s={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(s.zoomanim=this._onAnimZoom),s},_onAnimZoom:function(s){this._updateTransform(s.center,s.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(s,l){var f=this._map.getZoomScale(l,this._zoom),p=this._map.getSize().multiplyBy(.5+this.options.padding),_=this._map.project(this._center,l),I=p.multiplyBy(-f).add(_).subtract(this._map._getNewPixelOrigin(s,l));se.any3d?fr(this._container,I,f):Ne(this._container,I)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var s in this._layers)this._layers[s]._reset()},_onZoomEnd:function(){for(var s in this._layers)this._layers[s]._project()},_updatePaths:function(){for(var s in this._layers)this._layers[s]._update()},_update:function(){var s=this.options.padding,l=this._map.getSize(),f=this._map.containerPointToLayerPoint(l.multiplyBy(-s)).round();this._bounds=new we(f,f.add(l.multiplyBy(1+s*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Jv=Ri.extend({options:{tolerance:0},getEvents:function(){var s=Ri.prototype.getEvents.call(this);return s.viewprereset=this._onViewPreReset,s},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Ri.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var s=this._container=document.createElement("canvas");ke(s,"mousemove",this._onMouseMove,this),ke(s,"click dblclick mousedown mouseup contextmenu",this._onClick,this),ke(s,"mouseout",this._handleMouseOut,this),s._leaflet_disable_events=!0,this._ctx=s.getContext("2d")},_destroyContainer:function(){U(this._redrawRequest),delete this._ctx,et(this._container),st(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var s;this._redrawBounds=null;for(var l in this._layers)s=this._layers[l],s._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Ri.prototype._update.call(this);var s=this._bounds,l=this._container,f=s.getSize(),p=se.retina?2:1;Ne(l,s.min),l.width=p*f.x,l.height=p*f.y,l.style.width=f.x+"px",l.style.height=f.y+"px",se.retina&&this._ctx.scale(2,2),this._ctx.translate(-s.min.x,-s.min.y),this.fire("update")}},_reset:function(){Ri.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(s){this._updateDashArray(s),this._layers[h(s)]=s;var l=s._order={layer:s,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=l),this._drawLast=l,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(s){this._requestRedraw(s)},_removePath:function(s){var l=s._order,f=l.next,p=l.prev;f?f.prev=p:this._drawLast=p,p?p.next=f:this._drawFirst=f,delete s._order,delete this._layers[h(s)],this._requestRedraw(s)},_updatePath:function(s){this._extendRedrawBounds(s),s._project(),s._update(),this._requestRedraw(s)},_updateStyle:function(s){this._updateDashArray(s),this._requestRedraw(s)},_updateDashArray:function(s){if(typeof s.options.dashArray=="string"){var l=s.options.dashArray.split(/[, ]+/),f=[],p,_;for(_=0;_<l.length;_++){if(p=Number(l[_]),isNaN(p))return;f.push(p)}s.options._dashArray=f}else s.options._dashArray=s.options.dashArray},_requestRedraw:function(s){this._map&&(this._extendRedrawBounds(s),this._redrawRequest=this._redrawRequest||V(this._redraw,this))},_extendRedrawBounds:function(s){if(s._pxBounds){var l=(s.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new we,this._redrawBounds.extend(s._pxBounds.min.subtract([l,l])),this._redrawBounds.extend(s._pxBounds.max.add([l,l]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var s=this._redrawBounds;if(s){var l=s.getSize();this._ctx.clearRect(s.min.x,s.min.y,l.x,l.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var s,l=this._redrawBounds;if(this._ctx.save(),l){var f=l.getSize();this._ctx.beginPath(),this._ctx.rect(l.min.x,l.min.y,f.x,f.y),this._ctx.clip()}this._drawing=!0;for(var p=this._drawFirst;p;p=p.next)s=p.layer,(!l||s._pxBounds&&s._pxBounds.intersects(l))&&s._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(s,l){if(this._drawing){var f,p,_,I,O=s._parts,$=O.length,Z=this._ctx;if($){for(Z.beginPath(),f=0;f<$;f++){for(p=0,_=O[f].length;p<_;p++)I=O[f][p],Z[p?"lineTo":"moveTo"](I.x,I.y);l&&Z.closePath()}this._fillStroke(Z,s)}}},_updateCircle:function(s){if(!(!this._drawing||s._empty())){var l=s._point,f=this._ctx,p=Math.max(Math.round(s._radius),1),_=(Math.max(Math.round(s._radiusY),1)||p)/p;_!==1&&(f.save(),f.scale(1,_)),f.beginPath(),f.arc(l.x,l.y/_,p,0,Math.PI*2,!1),_!==1&&f.restore(),this._fillStroke(f,s)}},_fillStroke:function(s,l){var f=l.options;f.fill&&(s.globalAlpha=f.fillOpacity,s.fillStyle=f.fillColor||f.color,s.fill(f.fillRule||"evenodd")),f.stroke&&f.weight!==0&&(s.setLineDash&&s.setLineDash(l.options&&l.options._dashArray||[]),s.globalAlpha=f.opacity,s.lineWidth=f.weight,s.strokeStyle=f.color,s.lineCap=f.lineCap,s.lineJoin=f.lineJoin,s.stroke())},_onClick:function(s){for(var l=this._map.mouseEventToLayerPoint(s),f,p,_=this._drawFirst;_;_=_.next)f=_.layer,f.options.interactive&&f._containsPoint(l)&&(!(s.type==="click"||s.type==="preclick")||!this._map._draggableMoved(f))&&(p=f);this._fireEvent(p?[p]:!1,s)},_onMouseMove:function(s){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var l=this._map.mouseEventToLayerPoint(s);this._handleMouseHover(s,l)}},_handleMouseOut:function(s){var l=this._hoveredLayer;l&&(ge(this._container,"leaflet-interactive"),this._fireEvent([l],s,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(s,l){if(!this._mouseHoverThrottled){for(var f,p,_=this._drawFirst;_;_=_.next)f=_.layer,f.options.interactive&&f._containsPoint(l)&&(p=f);p!==this._hoveredLayer&&(this._handleMouseOut(s),p&&(re(this._container,"leaflet-interactive"),this._fireEvent([p],s,"mouseover"),this._hoveredLayer=p)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,s),this._mouseHoverThrottled=!0,setTimeout(a(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(s,l,f){this._map._fireDOMEvent(l,f||l.type,s)},_bringToFront:function(s){var l=s._order;if(l){var f=l.next,p=l.prev;if(f)f.prev=p;else return;p?p.next=f:f&&(this._drawFirst=f),l.prev=this._drawLast,this._drawLast.next=l,l.next=null,this._drawLast=l,this._requestRedraw(s)}},_bringToBack:function(s){var l=s._order;if(l){var f=l.next,p=l.prev;if(p)p.next=f;else return;f?f.prev=p:p&&(this._drawLast=p),l.prev=null,l.next=this._drawFirst,this._drawFirst.prev=l,this._drawFirst=l,this._requestRedraw(s)}}});function Xv(s){return se.canvas?new Jv(s):null}var vc=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(s){return document.createElement("<lvml:"+s+' class="lvml">')}}catch{}return function(s){return document.createElement("<"+s+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),SP={_initContainer:function(){this._container=Me("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Ri.prototype._update.call(this),this.fire("update"))},_initPath:function(s){var l=s._container=vc("shape");re(l,"leaflet-vml-shape "+(this.options.className||"")),l.coordsize="1 1",s._path=vc("path"),l.appendChild(s._path),this._updateStyle(s),this._layers[h(s)]=s},_addPath:function(s){var l=s._container;this._container.appendChild(l),s.options.interactive&&s.addInteractiveTarget(l)},_removePath:function(s){var l=s._container;et(l),s.removeInteractiveTarget(l),delete this._layers[h(s)]},_updateStyle:function(s){var l=s._stroke,f=s._fill,p=s.options,_=s._container;_.stroked=!!p.stroke,_.filled=!!p.fill,p.stroke?(l||(l=s._stroke=vc("stroke")),_.appendChild(l),l.weight=p.weight+"px",l.color=p.color,l.opacity=p.opacity,p.dashArray?l.dashStyle=A(p.dashArray)?p.dashArray.join(" "):p.dashArray.replace(/( *, *)/g," "):l.dashStyle="",l.endcap=p.lineCap.replace("butt","flat"),l.joinstyle=p.lineJoin):l&&(_.removeChild(l),s._stroke=null),p.fill?(f||(f=s._fill=vc("fill")),_.appendChild(f),f.color=p.fillColor||p.color,f.opacity=p.fillOpacity):f&&(_.removeChild(f),s._fill=null)},_updateCircle:function(s){var l=s._point.round(),f=Math.round(s._radius),p=Math.round(s._radiusY||f);this._setPath(s,s._empty()?"M0 0":"AL "+l.x+","+l.y+" "+f+","+p+" 0,"+65535*360)},_setPath:function(s,l){s._path.v=l},_bringToFront:function(s){j(s._container)},_bringToBack:function(s){Y(s._container)}},Cd=se.vml?vc:He,xc=Ri.extend({_initContainer:function(){this._container=Cd("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Cd("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){et(this._container),st(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Ri.prototype._update.call(this);var s=this._bounds,l=s.getSize(),f=this._container;(!this._svgSize||!this._svgSize.equals(l))&&(this._svgSize=l,f.setAttribute("width",l.x),f.setAttribute("height",l.y)),Ne(f,s.min),f.setAttribute("viewBox",[s.min.x,s.min.y,l.x,l.y].join(" ")),this.fire("update")}},_initPath:function(s){var l=s._path=Cd("path");s.options.className&&re(l,s.options.className),s.options.interactive&&re(l,"leaflet-interactive"),this._updateStyle(s),this._layers[h(s)]=s},_addPath:function(s){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(s._path),s.addInteractiveTarget(s._path)},_removePath:function(s){et(s._path),s.removeInteractiveTarget(s._path),delete this._layers[h(s)]},_updatePath:function(s){s._project(),s._update()},_updateStyle:function(s){var l=s._path,f=s.options;l&&(f.stroke?(l.setAttribute("stroke",f.color),l.setAttribute("stroke-opacity",f.opacity),l.setAttribute("stroke-width",f.weight),l.setAttribute("stroke-linecap",f.lineCap),l.setAttribute("stroke-linejoin",f.lineJoin),f.dashArray?l.setAttribute("stroke-dasharray",f.dashArray):l.removeAttribute("stroke-dasharray"),f.dashOffset?l.setAttribute("stroke-dashoffset",f.dashOffset):l.removeAttribute("stroke-dashoffset")):l.setAttribute("stroke","none"),f.fill?(l.setAttribute("fill",f.fillColor||f.color),l.setAttribute("fill-opacity",f.fillOpacity),l.setAttribute("fill-rule",f.fillRule||"evenodd")):l.setAttribute("fill","none"))},_updatePoly:function(s,l){this._setPath(s,zt(s._parts,l))},_updateCircle:function(s){var l=s._point,f=Math.max(Math.round(s._radius),1),p=Math.max(Math.round(s._radiusY),1)||f,_="a"+f+","+p+" 0 1,0 ",I=s._empty()?"M0 0":"M"+(l.x-f)+","+l.y+_+f*2+",0 "+_+-f*2+",0 ";this._setPath(s,I)},_setPath:function(s,l){s._path.setAttribute("d",l)},_bringToFront:function(s){j(s._path)},_bringToBack:function(s){Y(s._path)}});se.vml&&xc.include(SP);function e0(s){return se.svg||se.vml?new xc(s):null}Be.include({getRenderer:function(s){var l=s.options.renderer||this._getPaneRenderer(s.options.pane)||this.options.renderer||this._renderer;return l||(l=this._renderer=this._createRenderer()),this.hasLayer(l)||this.addLayer(l),l},_getPaneRenderer:function(s){if(s==="overlayPane"||s===void 0)return!1;var l=this._paneRenderers[s];return l===void 0&&(l=this._createRenderer({pane:s}),this._paneRenderers[s]=l),l},_createRenderer:function(s){return this.options.preferCanvas&&Xv(s)||e0(s)}});var t0=Oa.extend({initialize:function(s,l){Oa.prototype.initialize.call(this,this._boundsToLatLngs(s),l)},setBounds:function(s){return this.setLatLngs(this._boundsToLatLngs(s))},_boundsToLatLngs:function(s){return s=_e(s),[s.getSouthWest(),s.getNorthWest(),s.getNorthEast(),s.getSouthEast()]}});function PP(s,l){return new t0(s,l)}xc.create=Cd,xc.pointsToPath=zt,Ci.geometryToLayer=Td,Ci.coordsToLatLng=Um,Ci.coordsToLatLngs=Ed,Ci.latLngToCoords=Bm,Ci.latLngsToCoords=kd,Ci.getFeature=Va,Ci.asFeature=Sd,Be.mergeOptions({boxZoom:!0});var n0=Jn.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane,this._resetStateTimeout=0,s.on("unload",this._destroy,this)},addHooks:function(){ke(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){st(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){et(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(s){if(!s.shiftKey||s.which!==1&&s.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),jn(),rc(),this._startPoint=this._map.mouseEventToContainerPoint(s),ke(document,{contextmenu:Yn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(s){this._moved||(this._moved=!0,this._box=Me("div","leaflet-zoom-box",this._container),re(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(s);var l=new we(this._point,this._startPoint),f=l.getSize();Ne(this._box,l.min),this._box.style.width=f.x+"px",this._box.style.height=f.y+"px"},_finish:function(){this._moved&&(et(this._box),ge(this._container,"leaflet-crosshair")),Mr(),ic(),st(document,{contextmenu:Yn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(s){if(!(s.which!==1&&s.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(a(this._resetState,this),0);var l=new me(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(l).fire("boxzoomend",{boxZoomBounds:l})}},_onKeyDown:function(s){s.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Be.addInitHook("addHandler","boxZoom",n0),Be.mergeOptions({doubleClickZoom:!0});var r0=Jn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(s){var l=this._map,f=l.getZoom(),p=l.options.zoomDelta,_=s.originalEvent.shiftKey?f-p:f+p;l.options.doubleClickZoom==="center"?l.setZoom(_):l.setZoomAround(s.containerPoint,_)}});Be.addInitHook("addHandler","doubleClickZoom",r0),Be.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var i0=Jn.extend({addHooks:function(){if(!this._draggable){var s=this._map;this._draggable=new Or(s._mapPane,s._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),s.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),s.on("zoomend",this._onZoomEnd,this),s.whenReady(this._onZoomEnd,this))}re(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){ge(this._map._container,"leaflet-grab"),ge(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var s=this._map;if(s._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var l=_e(this._map.options.maxBounds);this._offsetLimit=ue(this._map.latLngToContainerPoint(l.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(l.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;s.fire("movestart").fire("dragstart"),s.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(s){if(this._map.options.inertia){var l=this._lastTime=+new Date,f=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(f),this._times.push(l),this._prunePositions(l)}this._map.fire("move",s).fire("drag",s)},_prunePositions:function(s){for(;this._positions.length>1&&s-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var s=this._map.getSize().divideBy(2),l=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=l.subtract(s).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(s,l){return s-(s-l)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var s=this._draggable._newPos.subtract(this._draggable._startPos),l=this._offsetLimit;s.x<l.min.x&&(s.x=this._viscousLimit(s.x,l.min.x)),s.y<l.min.y&&(s.y=this._viscousLimit(s.y,l.min.y)),s.x>l.max.x&&(s.x=this._viscousLimit(s.x,l.max.x)),s.y>l.max.y&&(s.y=this._viscousLimit(s.y,l.max.y)),this._draggable._newPos=this._draggable._startPos.add(s)}},_onPreDragWrap:function(){var s=this._worldWidth,l=Math.round(s/2),f=this._initialWorldOffset,p=this._draggable._newPos.x,_=(p-l+f)%s+l-f,I=(p+l+f)%s-l-f,O=Math.abs(_+f)<Math.abs(I+f)?_:I;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=O},_onDragEnd:function(s){var l=this._map,f=l.options,p=!f.inertia||s.noInertia||this._times.length<2;if(l.fire("dragend",s),p)l.fire("moveend");else{this._prunePositions(+new Date);var _=this._lastPos.subtract(this._positions[0]),I=(this._lastTime-this._times[0])/1e3,O=f.easeLinearity,$=_.multiplyBy(O/I),Z=$.distanceTo([0,0]),ee=Math.min(f.inertiaMaxSpeed,Z),pe=$.multiplyBy(ee/Z),Se=ee/(f.inertiaDeceleration*O),Ve=pe.multiplyBy(-Se/2).round();!Ve.x&&!Ve.y?l.fire("moveend"):(Ve=l._limitOffset(Ve,l.options.maxBounds),V(function(){l.panBy(Ve,{duration:Se,easeLinearity:O,noMoveStart:!0,animate:!0})}))}}});Be.addInitHook("addHandler","dragging",i0),Be.mergeOptions({keyboard:!0,keyboardPanDelta:80});var s0=Jn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(s){this._map=s,this._setPanDelta(s.options.keyboardPanDelta),this._setZoomDelta(s.options.zoomDelta)},addHooks:function(){var s=this._map._container;s.tabIndex<=0&&(s.tabIndex="0"),ke(s,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),st(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var s=document.body,l=document.documentElement,f=s.scrollTop||l.scrollTop,p=s.scrollLeft||l.scrollLeft;this._map._container.focus(),window.scrollTo(p,f)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(s){var l=this._panKeys={},f=this.keyCodes,p,_;for(p=0,_=f.left.length;p<_;p++)l[f.left[p]]=[-1*s,0];for(p=0,_=f.right.length;p<_;p++)l[f.right[p]]=[s,0];for(p=0,_=f.down.length;p<_;p++)l[f.down[p]]=[0,s];for(p=0,_=f.up.length;p<_;p++)l[f.up[p]]=[0,-1*s]},_setZoomDelta:function(s){var l=this._zoomKeys={},f=this.keyCodes,p,_;for(p=0,_=f.zoomIn.length;p<_;p++)l[f.zoomIn[p]]=s;for(p=0,_=f.zoomOut.length;p<_;p++)l[f.zoomOut[p]]=-s},_addHooks:function(){ke(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){st(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(s){if(!(s.altKey||s.ctrlKey||s.metaKey)){var l=s.keyCode,f=this._map,p;if(l in this._panKeys){if(!f._panAnim||!f._panAnim._inProgress)if(p=this._panKeys[l],s.shiftKey&&(p=X(p).multiplyBy(3)),f.options.maxBounds&&(p=f._limitOffset(X(p),f.options.maxBounds)),f.options.worldCopyJump){var _=f.wrapLatLng(f.unproject(f.project(f.getCenter()).add(p)));f.panTo(_)}else f.panBy(p)}else if(l in this._zoomKeys)f.setZoom(f.getZoom()+(s.shiftKey?3:1)*this._zoomKeys[l]);else if(l===27&&f._popup&&f._popup.options.closeOnEscapeKey)f.closePopup();else return;Yn(s)}}});Be.addInitHook("addHandler","keyboard",s0),Be.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var o0=Jn.extend({addHooks:function(){ke(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){st(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(s){var l=pd(s),f=this._map.options.wheelDebounceTime;this._delta+=l,this._lastMousePos=this._map.mouseEventToContainerPoint(s),this._startTime||(this._startTime=+new Date);var p=Math.max(f-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(a(this._performZoom,this),p),Yn(s)},_performZoom:function(){var s=this._map,l=s.getZoom(),f=this._map.options.zoomSnap||0;s._stop();var p=this._delta/(this._map.options.wheelPxPerZoomLevel*4),_=4*Math.log(2/(1+Math.exp(-Math.abs(p))))/Math.LN2,I=f?Math.ceil(_/f)*f:_,O=s._limitZoom(l+(this._delta>0?I:-I))-l;this._delta=0,this._startTime=null,O&&(s.options.scrollWheelZoom==="center"?s.setZoom(l+O):s.setZoomAround(this._lastMousePos,l+O))}});Be.addInitHook("addHandler","scrollWheelZoom",o0);var NP=600;Be.mergeOptions({tapHold:se.touchNative&&se.safari&&se.mobile,tapTolerance:15});var a0=Jn.extend({addHooks:function(){ke(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){st(this._map._container,"touchstart",this._onDown,this)},_onDown:function(s){if(clearTimeout(this._holdTimeout),s.touches.length===1){var l=s.touches[0];this._startPos=this._newPos=new K(l.clientX,l.clientY),this._holdTimeout=setTimeout(a(function(){this._cancel(),this._isTapValid()&&(ke(document,"touchend",It),ke(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",l))},this),NP),ke(document,"touchend touchcancel contextmenu",this._cancel,this),ke(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function s(){st(document,"touchend",It),st(document,"touchend touchcancel",s)},_cancel:function(){clearTimeout(this._holdTimeout),st(document,"touchend touchcancel contextmenu",this._cancel,this),st(document,"touchmove",this._onMove,this)},_onMove:function(s){var l=s.touches[0];this._newPos=new K(l.clientX,l.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(s,l){var f=new MouseEvent(s,{bubbles:!0,cancelable:!0,view:window,screenX:l.screenX,screenY:l.screenY,clientX:l.clientX,clientY:l.clientY});f._simulated=!0,l.target.dispatchEvent(f)}});Be.addInitHook("addHandler","tapHold",a0),Be.mergeOptions({touchZoom:se.touch,bounceAtZoomLimits:!0});var l0=Jn.extend({addHooks:function(){re(this._map._container,"leaflet-touch-zoom"),ke(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){ge(this._map._container,"leaflet-touch-zoom"),st(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(s){var l=this._map;if(!(!s.touches||s.touches.length!==2||l._animatingZoom||this._zooming)){var f=l.mouseEventToContainerPoint(s.touches[0]),p=l.mouseEventToContainerPoint(s.touches[1]);this._centerPoint=l.getSize()._divideBy(2),this._startLatLng=l.containerPointToLatLng(this._centerPoint),l.options.touchZoom!=="center"&&(this._pinchStartLatLng=l.containerPointToLatLng(f.add(p)._divideBy(2))),this._startDist=f.distanceTo(p),this._startZoom=l.getZoom(),this._moved=!1,this._zooming=!0,l._stop(),ke(document,"touchmove",this._onTouchMove,this),ke(document,"touchend touchcancel",this._onTouchEnd,this),It(s)}},_onTouchMove:function(s){if(!(!s.touches||s.touches.length!==2||!this._zooming)){var l=this._map,f=l.mouseEventToContainerPoint(s.touches[0]),p=l.mouseEventToContainerPoint(s.touches[1]),_=f.distanceTo(p)/this._startDist;if(this._zoom=l.getScaleZoom(_,this._startZoom),!l.options.bounceAtZoomLimits&&(this._zoom<l.getMinZoom()&&_<1||this._zoom>l.getMaxZoom()&&_>1)&&(this._zoom=l._limitZoom(this._zoom)),l.options.touchZoom==="center"){if(this._center=this._startLatLng,_===1)return}else{var I=f._add(p)._divideBy(2)._subtract(this._centerPoint);if(_===1&&I.x===0&&I.y===0)return;this._center=l.unproject(l.project(this._pinchStartLatLng,this._zoom).subtract(I),this._zoom)}this._moved||(l._moveStart(!0,!1),this._moved=!0),U(this._animRequest);var O=a(l._move,l,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=V(O,this,!0),It(s)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,U(this._animRequest),st(document,"touchmove",this._onTouchMove,this),st(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Be.addInitHook("addHandler","touchZoom",l0),Be.BoxZoom=n0,Be.DoubleClickZoom=r0,Be.Drag=i0,Be.Keyboard=s0,Be.ScrollWheelZoom=o0,Be.TapHold=a0,Be.TouchZoom=l0,n.Bounds=we,n.Browser=se,n.CRS=De,n.Canvas=Jv,n.Circle=Fm,n.CircleMarker=Id,n.Class=le,n.Control=Ln,n.DivIcon=Zv,n.DivOverlay=oi,n.DomEvent=gd,n.DomUtil=fd,n.Draggable=Or,n.Evented=Re,n.FeatureGroup=Dt,n.GeoJSON=Ci,n.GridLayer=_c,n.Handler=Jn,n.Icon=si,n.ImageOverlay=Pd,n.LatLng=fe,n.LatLngBounds=me,n.Layer=ot,n.LayerGroup=Tt,n.LineUtil=E,n.Map=Be,n.Marker=bd,n.Mixin=xo,n.Path=Ts,n.Point=K,n.PolyUtil=La,n.Polygon=Oa,n.Polyline=Ai,n.Popup=Nd,n.PosAnimation=dc,n.Projection=oe,n.Rectangle=t0,n.Renderer=Ri,n.SVG=xc,n.SVGOverlay=Kv,n.TileLayer=Fa,n.Tooltip=Ad,n.Transformation=en,n.Util=M,n.VideoOverlay=Gv,n.bind=a,n.bounds=ue,n.canvas=Xv,n.circle=pP,n.circleMarker=mP,n.control=wn,n.divIcon=TP,n.extend=i,n.featureGroup=Ma,n.geoJSON=Wv,n.geoJson=_P,n.gridLayer=EP,n.icon=hP,n.imageOverlay=vP,n.latLng=de,n.latLngBounds=_e,n.layerGroup=Is,n.map=Pa,n.marker=fP,n.point=X,n.polygon=yP,n.polyline=gP,n.popup=bP,n.rectangle=PP,n.setOptions=P,n.stamp=h,n.svg=e0,n.svgOverlay=wP,n.tileLayer=Qv,n.tooltip=IP,n.transformation=an,n.version=r,n.videoOverlay=xP;var AP=window.L;n.noConflict=function(){return window.L=AP,this},window.L=n})})(hy,hy.exports);var hd=hy.exports;const Dv=Ob(hd);function Mv(t,e,n){return Object.freeze({instance:t,context:e,container:n})}function Ov(t,e){return e==null?function(r,i){const o=B.useRef();return o.current||(o.current=t(r,i)),o}:function(r,i){const o=B.useRef();o.current||(o.current=t(r,i));const a=B.useRef(r),{instance:u}=o.current;return B.useEffect(function(){a.current!==r&&(e(u,r,a.current),a.current=r)},[u,r,i]),o}}function S5(t,e){B.useEffect(function(){return(e.layerContainer??e.map).addLayer(t.instance),function(){var o;(o=e.layerContainer)==null||o.removeLayer(t.instance),e.map.removeLayer(t.instance)}},[e,t])}function J1(t){return function(n){const r=jv(),i=t(Lv(n,r),r);return K1(r.map,n.attribution),Y1(i.current,n.eventHandlers),S5(i.current,r),i}}function P5(t,e){const n=Ov(t,e),r=J1(n);return I5(r)}function N5(t,e){const n=Ov(t),r=k5(n,e);return T5(r)}function A5(t,e){const n=Ov(t,e),r=J1(n);return E5(r)}function C5(t,e,n){const{opacity:r,zIndex:i}=e;r!=null&&r!==n.opacity&&t.setOpacity(r),i!=null&&i!==n.zIndex&&t.setZIndex(i)}function R5(){return jv().map}function fy(){return fy=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},fy.apply(this,arguments)}function j5({bounds:t,boundsOptions:e,center:n,children:r,className:i,id:o,placeholder:a,style:u,whenReady:h,zoom:m,...y},v){const[w]=B.useState({className:i,id:o,style:u}),[S,N]=B.useState(null);B.useImperativeHandle(v,()=>(S==null?void 0:S.map)??null,[S]);const P=B.useCallback(R=>{if(R!==null&&S===null){const k=new hd.Map(R,y);n!=null&&m!=null?k.setView(n,m):t!=null&&k.fitBounds(t,e),h!=null&&k.whenReady(h),N(w5(k))}},[]);B.useEffect(()=>()=>{S==null||S.map.remove()},[S]);const F=S?Mh.createElement(Q1,{value:S},r):a??null;return Mh.createElement("div",fy({},w,{ref:P}),F)}const L5=B.forwardRef(j5),Eb=P5(function({position:e,...n},r){const i=new hd.Marker(e,n);return Mv(i,b5(r,{overlayContainer:i}))},function(e,n,r){n.position!==r.position&&e.setLatLng(n.position),n.icon!=null&&n.icon!==r.icon&&e.setIcon(n.icon),n.zIndexOffset!=null&&n.zIndexOffset!==r.zIndexOffset&&e.setZIndexOffset(n.zIndexOffset),n.opacity!=null&&n.opacity!==r.opacity&&e.setOpacity(n.opacity),e.dragging!=null&&n.draggable!==r.draggable&&(n.draggable===!0?e.dragging.enable():e.dragging.disable())}),kb=N5(function(e,n){const r=new hd.Popup(e,n.overlayContainer);return Mv(r,n)},function(e,n,{position:r},i){B.useEffect(function(){const{instance:a}=e;function u(m){m.popup===a&&(a.update(),i(!0))}function h(m){m.popup===a&&i(!1)}return n.map.on({popupopen:u,popupclose:h}),n.overlayContainer==null?(r!=null&&a.setLatLng(r),a.openOn(n.map)):n.overlayContainer.bindPopup(a),function(){var y;n.map.off({popupopen:u,popupclose:h}),(y=n.overlayContainer)==null||y.unbindPopup(),n.map.removeLayer(a)}},[e,n,i,r])}),D5=A5(function({url:e,...n},r){const i=new hd.TileLayer(e,Lv(n,r));return Mv(i,r)},function(e,n,r){C5(e,n,r);const{url:i}=n;i!=null&&i!==r.url&&e.setUrl(i)});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var M5={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O5=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Ie=(t,e)=>{const n=B.forwardRef(({color:r="currentColor",size:i=24,strokeWidth:o=2,absoluteStrokeWidth:a,className:u="",children:h,...m},y)=>B.createElement("svg",{ref:y,...M5,width:i,height:i,stroke:r,strokeWidth:a?Number(o)*24/Number(i):o,className:["lucide",`lucide-${O5(t)}`,u].join(" "),...m},[...e.map(([v,w])=>B.createElement(v,w)),...Array.isArray(h)?h:[h]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X1=Ie("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vv=Ie("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jh=Ie("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sb=Ie("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eP=Ie("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V5=Ie("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F5=Ie("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U5=Ie("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B5=Ie("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z5=Ie("Cookie",[["path",{d:"M12 2a10 10 0 1 0 10 10 4 4 0 0 1-5-5 4 4 0 0 1-5-5",key:"laymnq"}],["path",{d:"M8.5 8.5v.01",key:"ue8clq"}],["path",{d:"M16 15.5v.01",key:"14dtrp"}],["path",{d:"M12 12v.01",key:"u5ubse"}],["path",{d:"M11 17v.01",key:"1hyl5a"}],["path",{d:"M7 14v.01",key:"uct60s"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fv=Ie("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pb=Ie("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jm=Ie("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lm=Ie("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q5=Ie("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uv=Ie("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nb=Ie("Feather",[["path",{d:"M20.24 12.24a6 6 0 0 0-8.49-8.49L5 10.5V19h8.5z",key:"u4sw5n"}],["line",{x1:"16",x2:"2",y1:"8",y2:"22",key:"1c47m2"}],["line",{x1:"17.5",x2:"9",y1:"15",y2:"15",key:"2fj3pr"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $5=Ie("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H5=Ie("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tP=Ie("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lh=Ie("ImagePlus",[["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7",key:"31hg93"}],["line",{x1:"16",x2:"22",y1:"5",y2:"5",key:"ez7e4s"}],["line",{x1:"19",x2:"19",y1:"2",y2:"8",key:"1gkr8c"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dh=Ie("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W5=Ie("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gr=Ie("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ab=Ie("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bv=Ie("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $l=Ie("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G5=Ie("Map",[["polygon",{points:"3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21",key:"ok2ie8"}],["line",{x1:"9",x2:"9",y1:"3",y2:"18",key:"w34qz5"}],["line",{x1:"15",x2:"15",y1:"6",y2:"21",key:"volv9a"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K5=Ie("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nP=Ie("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z5=Ie("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jf=Ie("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q5=Ie("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y5=Ie("PartyPopper",[["path",{d:"M5.8 11.3 2 22l10.7-3.79",key:"gwxi1d"}],["path",{d:"M4 3h.01",key:"1vcuye"}],["path",{d:"M22 8h.01",key:"1mrtc2"}],["path",{d:"M15 2h.01",key:"1cjtqr"}],["path",{d:"M22 20h.01",key:"1mrys2"}],["path",{d:"m22 2-2.24.75a2.9 2.9 0 0 0-1.96 3.12v0c.1.86-.57 1.63-1.45 1.63h-.38c-.86 0-1.6.6-1.76 1.44L14 10",key:"bpx1uq"}],["path",{d:"m22 13-.82-.33c-.86-.34-1.82.2-1.98 1.11v0c-.11.7-.72 1.22-1.43 1.22H17",key:"1pd0s7"}],["path",{d:"m11 2 .33.82c.34.86-.2 1.82-1.11 1.98v0C9.52 4.9 9 5.52 9 6.23V7",key:"zq5xbz"}],["path",{d:"M11 13c1.93 1.93 2.83 4.17 2 5-.83.83-3.07-.07-5-2-1.93-1.93-2.83-4.17-2-5 .83-.83 3.07.07 5 2Z",key:"4kbmks"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J5=Ie("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rP=Ie("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X5=Ie("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e3=Ie("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iP=Ie("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sP=Ie("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oP=Ie("ShieldAlert",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t3=Ie("ShieldCheck",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aP=Ie("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n3=Ie("Shirt",[["path",{d:"M20.38 3.46 16 2a4 4 0 0 1-8 0L3.62 3.46a2 2 0 0 0-1.34 2.23l.58 3.47a1 1 0 0 0 .99.84H6v10c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2V10h2.15a1 1 0 0 0 .99-.84l.58-3.47a2 2 0 0 0-1.34-2.23z",key:"1wgbhj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r3=Ie("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zv=Ie("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lP=Ie("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cP=Ie("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=Ie("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i3=Ie("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uP=Ie("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oi=Ie("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s3=Ie("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dP=Ie("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fa=Ie("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qv=Ie("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);delete Dv.Icon.Default.prototype._getIconUrl;Dv.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-shadow.png"});const Cb=t=>Dv.divIcon({className:"custom-marker",html:`<div style="background-color: ${t}; width: 24px; height: 24px; border-radius: 50% 50% 50% 0; transform: rotate(-45deg); border: 2px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.3);"></div>`,iconSize:[24,24],iconAnchor:[12,24],popupAnchor:[0,-24]}),Dc={accommodation:{label:"Accommodation",color:"#3B82F6",icon:tP},costume:{label:"Costume Pickup",color:"#F59E0B",icon:n3},fete:{label:"Fete Location",color:"#EC4899",icon:Y5},meetup:{label:"Meetup Spot",color:"#10B981",icon:Oi},scraped:{label:"Live Events",color:"#8B5CF6",icon:$l}};function o3({center:t,zoom:e}){const n=R5();return B.useEffect(()=>{t&&n.setView(t,e||13)},[t,e,n]),null}function a3(t,e,n,r){const o=(n-t)*Math.PI/180,a=(r-e)*Math.PI/180,u=Math.sin(o/2)*Math.sin(o/2)+Math.cos(t*Math.PI/180)*Math.cos(n*Math.PI/180)*Math.sin(a/2)*Math.sin(a/2);return 6371*(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)))}const Rb={trinidad:{center:[10.6918,-61.2225],zoom:11,country:"Trinidad & Tobago"},"stkitts-sugar-mas":{center:[17.3026,-62.7177],zoom:12,country:"St. Kitts"},stcroix:{center:[17.7246,-64.8348],zoom:11,country:"St. Croix, USVI"},dominica:{center:[15.415,-61.371],zoom:11,country:"Dominica"},aruba:{center:[12.5211,-69.9683],zoom:12,country:"Aruba"},"guyana-mashramani":{center:[6.8013,-58.1551],zoom:12,country:"Guyana"},guyana:{center:[6.8013,-58.1551],zoom:12,country:"Guyana"},"guyana-independence":{center:[6.8013,-58.1551],zoom:12,country:"Guyana"},jamaica:{center:[18.0179,-76.8099],zoom:11,country:"Jamaica"},stmaarten:{center:[18.0425,-63.0548],zoom:12,country:"St. Maarten"},bahamas:{center:[25.0343,-77.3963],zoom:12,country:"Bahamas"},bermuda:{center:[32.3078,-64.7505],zoom:13,country:"Bermuda"},vincymas:{center:[13.1587,-61.2248],zoom:12,country:"St. Vincent"},antigua:{center:[17.1274,-61.8468],zoom:12,country:"Antigua"},stlucia:{center:[14.0101,-60.987],zoom:11,country:"St. Lucia"},tobago:{center:[11.1889,-60.732],zoom:11,country:"Tobago"},nottinghill:{center:[51.5156,-.205],zoom:14,country:"London, UK"},miami:{center:[25.7617,-80.1918],zoom:11,country:"Miami, FL"},tampa:{center:[27.9506,-82.4572],zoom:12,country:"Tampa, FL"},"cayman-batabano":{center:[19.2869,-81.3674],zoom:13,country:"Cayman Islands"},stthomas:{center:[18.3358,-64.8963],zoom:13,country:"St. Thomas, USVI"},atlanta:{center:[33.749,-84.388],zoom:12,country:"Atlanta, GA"},hollywood:{center:[34.0928,-118.3287],zoom:13,country:"Hollywood, CA"},caymas:{center:[19.2869,-81.3674],zoom:13,country:"Cayman Islands"},toronto:{center:[43.65107,-79.347015],zoom:12,country:"Toronto, Canada"},barbados:{center:[13.1939,-59.5432],zoom:12,country:"Barbados"},nevis:{center:[17.15,-62.58],zoom:12,country:"Nevis"},grenada:{center:[12.0529,-61.7523],zoom:12,country:"Grenada"},"ny-labor-day":{center:[40.6782,-73.9442],zoom:13,country:"Brooklyn, NY"},japan:{center:[35.6762,139.6503],zoom:10,country:"Tokyo, Japan"}};function l3({locations:t=[],scrapedEvents:e=[],onLocationsChange:n,carnivalName:r,carnivalId:i}){const[o,a]=B.useState(!1),[u,h]=B.useState({name:"",type:"fete",lat:"",lng:""}),[m,y]=B.useState(""),[v,w]=B.useState([]),[S,N]=B.useState(!1),P=t.find(T=>T.type==="accommodation"),F=Rb[i]||Rb.trinidad,R=B.useMemo(()=>{if(P)return[P.lat,P.lng];if(t.length>0)return[t[0].lat,t[0].lng];const T=e.find(b=>b.lat&&b.lng);return T?[T.lat,T.lng]:F.center},[t,P,F,e]),k=async()=>{if(m.trim()){N(!0);try{const b=await(await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(m)}`)).json();w(b.slice(0,5))}catch(T){console.error("Search error:",T)}N(!1)}},A=T=>{h({...u,lat:parseFloat(T.lat),lng:parseFloat(T.lon),name:u.name||T.display_name.split(",")[0]}),w([]),y("")},z=()=>{if(!u.name||!u.lat||!u.lng)return;const T={id:Date.now().toString(),name:u.name,type:u.type,lat:parseFloat(u.lat),lng:parseFloat(u.lng)};n([...t,T]),h({name:"",type:"fete",lat:"",lng:""}),a(!1)},G=T=>{n(t.filter(b=>b.id!==T))},W=T=>{if(!P||T.type==="accommodation")return null;const b=a3(P.lat,P.lng,T.lat,T.lng);return b<1?`${Math.round(b*1e3)}m`:`${b.toFixed(1)}km`};return c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsxs("h3",{className:"text-lg font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[c.jsx($l,{className:"w-5 h-5 text-purple-500"}),"Fete Map - ",r]}),c.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 ml-7",children:[" ",F.country]})]}),c.jsxs("button",{onClick:()=>a(!o),className:"flex items-center gap-1 px-3 py-1.5 bg-purple-600 text-white text-sm rounded-lg hover:bg-purple-700 transition",children:[c.jsx(rP,{className:"w-4 h-4"}),"Add Pin"]})]}),o&&c.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 space-y-3",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsx("input",{type:"text",placeholder:"Location name",value:u.name,onChange:T=>h({...u,name:T.target.value}),className:"px-3 py-2 border rounded-lg dark:bg-gray-600 dark:border-gray-500 dark:text-white"}),c.jsx("select",{value:u.type,onChange:T=>h({...u,type:T.target.value}),className:"px-3 py-2 border rounded-lg dark:bg-gray-600 dark:border-gray-500 dark:text-white",children:Object.entries(Dc).map(([T,{label:b}])=>c.jsx("option",{value:T,children:b},T))})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("input",{type:"text",placeholder:"Search for a place...",value:m,onChange:T=>y(T.target.value),onKeyPress:T=>T.key==="Enter"&&k(),className:"flex-1 px-3 py-2 border rounded-lg dark:bg-gray-600 dark:border-gray-500 dark:text-white"}),c.jsx("button",{onClick:k,disabled:S,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:S?"...":"Search"})]}),v.length>0&&c.jsx("ul",{className:"bg-white dark:bg-gray-600 border dark:border-gray-500 rounded-lg max-h-40 overflow-y-auto",children:v.map((T,b)=>c.jsx("li",{onClick:()=>A(T),className:"px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-500 cursor-pointer text-sm truncate dark:text-white",children:T.display_name},b))}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsx("input",{type:"number",step:"any",placeholder:"Latitude",value:u.lat,onChange:T=>h({...u,lat:T.target.value}),className:"px-3 py-2 border rounded-lg dark:bg-gray-600 dark:border-gray-500 dark:text-white"}),c.jsx("input",{type:"number",step:"any",placeholder:"Longitude",value:u.lng,onChange:T=>h({...u,lng:T.target.value}),className:"px-3 py-2 border rounded-lg dark:bg-gray-600 dark:border-gray-500 dark:text-white"})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:z,disabled:!u.name||!u.lat||!u.lng,className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Add Location"}),c.jsx("button",{onClick:()=>a(!1),className:"px-4 py-2 bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-white rounded-lg hover:bg-gray-400",children:"Cancel"})]})]}),c.jsx("div",{className:"h-[400px] rounded-xl overflow-hidden border-2 border-gray-200 dark:border-gray-600",children:c.jsxs(L5,{center:R,zoom:F.zoom,style:{height:"100%",width:"100%"},children:[c.jsx(D5,{attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),c.jsx(o3,{center:R,zoom:F.zoom}),t.map(T=>{var b,C;return c.jsx(Eb,{position:[T.lat,T.lng],icon:Cb(((b=Dc[T.type])==null?void 0:b.color)||"#6B7280"),children:c.jsxs(kb,{children:[c.jsx("div",{className:"font-medium",children:T.name}),c.jsx("div",{className:"text-xs text-gray-500",children:(C=Dc[T.type])==null?void 0:C.label}),W(T)&&c.jsxs("div",{className:"text-xs text-blue-600 flex items-center gap-1 mt-1",children:[c.jsx(Q5,{className:"w-3 h-3"}),W(T)," from accommodation"]})]})},T.id)}),e.filter(T=>T.lat&&T.lng).map(T=>c.jsx(Eb,{position:[T.lat,T.lng],icon:Cb(Dc.scraped.color),children:c.jsxs(kb,{children:[c.jsx("div",{className:"font-medium",children:T.title}),c.jsx("div",{className:"text-xs text-purple-600 font-bold mb-1",children:"Live Event"}),T.venue&&c.jsx("div",{className:"text-xs text-gray-500 mb-2",children:T.venue}),c.jsx("a",{href:T.url,target:"_blank",rel:"noopener noreferrer",className:"block text-center px-2 py-1 bg-purple-100 text-purple-700 text-[10px] font-bold rounded uppercase hover:bg-purple-200 transition",children:"Find Tickets"})]})},T.id))]})}),t.length>0&&c.jsxs("div",{className:"space-y-2",children:[c.jsx("h4",{className:"text-sm font-semibold text-gray-600 dark:text-gray-300",children:"Saved Locations"}),c.jsx("div",{className:"grid gap-2",children:t.map(T=>{const b=Dc[T.type],C=(b==null?void 0:b.icon)||$l,D=W(T);return c.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{backgroundColor:(b==null?void 0:b.color)||"#6B7280"},children:c.jsx(C,{className:"w-4 h-4 text-white"})}),c.jsxs("div",{children:[c.jsx("div",{className:"font-medium text-gray-800 dark:text-white",children:T.name}),c.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[b==null?void 0:b.label,D&&`  ${D} from stay`]})]})]}),c.jsx("button",{onClick:()=>G(T.id),className:"p-2 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition",children:c.jsx(rs,{className:"w-4 h-4"})})]},T.id)})})]}),!P&&t.length===0&&c.jsxs("div",{className:"text-center py-6 text-gray-500 dark:text-gray-400",children:[c.jsx(tP,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),c.jsx("p",{children:"Start by adding your accommodation location"}),c.jsx("p",{className:"text-sm",children:"Then add fetes, costume pickup, and meetup spots"})]})]})}let So=[{id:"1",text:"Who's ready for the road?! ",senderId:"2",senderName:"Soca Junkie",createdAt:new Date(Date.now()-864e5).toISOString(),isBot:!1},{id:"2",text:"My costume is ready! The Monarch section looks fire ",senderId:"3",senderName:"Fete King",createdAt:new Date(Date.now()-8e7).toISOString(),isBot:!1},{id:"3",text:"Just waiting on my flight confirmation.",senderId:"4",senderName:"Carnival Baby",createdAt:new Date(Date.now()-7e7).toISOString(),isBot:!1},{id:"4",text:"Welcome to Trinidad! I'm your Carnival Concierge. Ask me anything about fete locations, transport, or safety tips!",senderId:"bot",senderName:"Carnival Concierge",createdAt:new Date(Date.now()-6e4).toISOString(),isBot:!0}];const c3=(t,e,n)=>{if(e)return n(So),()=>{};if(!t)return()=>{};const r=En(Ue,"squads",t,"messages"),i=Tm(r,hv("createdAt","asc"),QS(50));return $i(i,a=>{const u=a.docs.map(h=>{var m;return{id:h.id,...h.data(),createdAt:(m=h.data().createdAt)!=null&&m.toDate?h.data().createdAt.toDate().toISOString():new Date().toISOString()}});n(u)},a=>{console.error(" Chat subscription error:",a)})},u3=async(t,e,n,r,i,o)=>{let a=null;if(r)if(i)a=URL.createObjectURL(r);else try{const h=zl(ql,`squads/${t}/${Date.now()}_${r.name}`),m=await Nm(h,r);a=await Am(m.ref)}catch(h){console.error("Image upload failed:",h)}const u={text:n,imageUrl:a,expiresAt:new Date(Date.now()+24*60*60*1e3).toISOString(),senderId:e.uid||"demo-user",senderName:e.displayName||"Me",senderPhoto:e.photoURL||null,createdAt:i?new Date().toISOString():yv(),isBot:!1};if(i){const h={id:Date.now().toString(),...u};So=[...So,h],o([...So]),setTimeout(()=>{const m=d3(n||(r?"Nice photo! ":"...")),y={id:(Date.now()+1).toString(),text:m,senderId:"bot",senderName:"Carnival Concierge",senderPhoto:null,createdAt:new Date().toISOString(),isBot:!0};So=[...So,y],o([...So])},1500);return}t&&await ud(En(Ue,"squads",t,"messages"),u)},d3=t=>{const e=t.toLowerCase();return e.includes("fete")||e.includes("party")?"Based on your schedule, I recommend 'Phuket' on Friday night. It's close to your Airbnb in Woodbrook and tickets are running low! ":e.includes("food")||e.includes("hungry")||e.includes("eat")?"You have to try 'Sauce Doubles' in Curepe! Or if you're near the Savannah, check out the corn soup vendor near the exit. ":e.includes("transport")||e.includes("taxi")||e.includes("uber")?"Rideshare apps like TT RideShare are reliable. For late nights, I recommend pre-booking a driver for your squad. Safety first! ":e.includes("costume")||e.includes("mas")?"Costume pickup for Tribe is at the Queen's Park Savannah. Don't forget your distribution slip and ID! ":"That sounds like a vibe! Remember to stay hydrated . Need help with transport or fete tickets?"};function h3({squadId:t,user:e,isDemoMode:n}){const[r,i]=B.useState([]),[o,a]=B.useState(""),[u,h]=B.useState(null),[m,y]=B.useState(null),v=B.useRef(null),w=B.useRef(null);B.useEffect(()=>{const F=c3(n?"demo-squad":t,n,R=>{i(R)});return()=>F()},[t,n]),B.useEffect(()=>{var P;(P=v.current)==null||P.scrollIntoView({behavior:"smooth"})},[r]),B.useEffect(()=>()=>{m&&URL.revokeObjectURL(m)},[m]);const S=P=>{if(P.target.files&&P.target.files[0]){const F=P.target.files[0];h(F),y(URL.createObjectURL(F))}},N=async P=>{if(P.preventDefault(),!o.trim()&&!u)return;const F=o,R=u;a(""),h(null),y(null);try{await u3(n?"demo-squad":t,e,F,R,n,i)}catch(k){console.error("Failed to send:",k),a(F)}};return c.jsxs("div",{className:"flex flex-col h-[600px] bg-white dark:bg-gray-800 rounded-2xl shadow-xl overflow-hidden border border-gray-100 dark:border-gray-700",children:[c.jsxs("div",{className:"p-4 bg-gradient-to-r from-purple-600 to-indigo-600 text-white flex justify-between items-center shadow-md z-10",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2 bg-white/20 rounded-full backdrop-blur-sm",children:c.jsx(Sb,{className:"w-5 h-5 text-white"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-bold text-lg",children:"Squad Chat"}),c.jsxs("p",{className:"text-xs text-purple-100 opacity-90 flex items-center gap-1",children:[c.jsx("span",{className:"w-2 h-2 bg-emerald-400 rounded-full animate-pulse"}),"Carnival Concierge Active"]})]})]}),n&&c.jsx("span",{className:"px-2 py-1 text-[10px] font-black tracking-widest bg-yellow-400 text-yellow-900 rounded uppercase",children:"Demo"})]}),c.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50 dark:bg-gray-900/50",children:[r.map(P=>{const F=P.senderId===((e==null?void 0:e.uid)||"demo-user"),R=P.isBot;let k=!1,A=null;return P.expiresAt&&(A=new Date(P.expiresAt),new Date>A&&(k=!0)),c.jsx("div",{className:`flex w-full ${F?"justify-end":"justify-start"}`,children:c.jsxs("div",{className:`flex max-w-[80%] gap-2 ${F?"flex-row-reverse":"flex-row"}`,children:[c.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center shadow-sm 
                    ${R?"bg-gradient-to-br from-pink-500 to-orange-400":"bg-gray-300 dark:bg-gray-700"}`,children:R?c.jsx(Sb,{className:"w-4 h-4 text-white"}):c.jsx(uP,{className:"w-4 h-4 text-white"})}),c.jsxs("div",{className:`flex flex-col ${F?"items-end":"items-start"}`,children:[c.jsx("span",{className:"text-[10px] text-gray-400 mb-1 ml-1",children:P.senderName}),c.jsxs("div",{className:`px-4 py-3 rounded-2xl shadow-sm text-sm leading-relaxed relative
                        ${F?"bg-blue-600 text-white rounded-tr-none":R?"bg-white dark:bg-gray-800 border-l-4 border-pink-500 text-gray-800 dark:text-gray-100 rounded-tl-none":"bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-100 rounded-tl-none"}
                    `,children:[P.imageUrl&&c.jsx("div",{className:"mb-2",children:k?c.jsxs("div",{className:"w-48 h-32 bg-gray-200 dark:bg-gray-700 rounded-lg flex flex-col items-center justify-center text-gray-500",children:[c.jsx(Dh,{className:"w-8 h-8 mb-1 opacity-50"}),c.jsx("span",{className:"text-xs italic",children:"Image expired"})]}):c.jsxs("div",{className:"relative group",children:[c.jsx("img",{src:P.imageUrl,alt:"Shared",className:"w-48 h-48 object-cover rounded-lg cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>window.open(P.imageUrl,"_blank")}),c.jsx("span",{className:"absolute top-2 right-2 bg-black/50 text-white text-[10px] px-1.5 py-0.5 rounded backdrop-blur-sm",children:" 24h"})]})}),P.text]}),c.jsx("span",{className:"text-[10px] text-gray-400 mt-1 opacity-50",children:new Date(P.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})},P.id)}),c.jsx("div",{ref:v})]}),c.jsxs("form",{onSubmit:N,className:"p-4 bg-white dark:bg-gray-800 border-t border-gray-100 dark:border-gray-700",children:[m&&c.jsxs("div",{className:"mb-3 relative inline-block",children:[c.jsx("img",{src:m,alt:"Preview",className:"h-20 w-20 object-cover rounded-lg border border-purple-200"}),c.jsx("button",{type:"button",onClick:()=>{h(null),y(null)},className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 shadow-md hover:bg-red-600",children:c.jsx(fa,{className:"w-3 h-3"})})]}),c.jsxs("div",{className:"flex gap-2 items-center",children:[c.jsx("input",{type:"file",ref:w,onChange:S,accept:"image/*",className:"hidden"}),c.jsx("button",{type:"button",onClick:()=>{var P;return(P=w.current)==null?void 0:P.click()},className:"p-3 text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded-xl transition-colors",title:"Upload Image (Expires in 24h)",children:c.jsx(eP,{className:"w-5 h-5"})}),c.jsx("input",{type:"text",value:o,onChange:P=>a(P.target.value),placeholder:u?"Add a caption...":"Ask Concierge or chat with squad...",className:"flex-1 px-4 py-3 bg-gray-100 dark:bg-gray-900 border-0 rounded-xl focus:ring-2 focus:ring-purple-500 dark:text-white placeholder-gray-400 transition-all"}),c.jsx("button",{type:"submit",disabled:!o.trim()&&!u,className:"p-3 bg-purple-600 text-white rounded-xl hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors shadow-lg shadow-purple-500/30",children:c.jsx(sP,{className:"w-5 h-5"})})]})]})]})}const my={ticket:{label:"Ticket",icon:zv,color:"#F59E0B"},photo:{label:"Photo",icon:Lh,color:"#3B82F6"}};function f3({files:t=[],onFilesChange:e,carnivalName:n,carnivalId:r,userId:i}){const[o,a]=B.useState(!1),[u,h]=B.useState(""),[m,y]=B.useState(null),[v,w]=B.useState("ticket"),[S,N]=B.useState(""),P=B.useRef(null),F=async G=>{const W=G.target.files[0];if(!W)return;const T=10*1024*1024;if(W.size>T){alert("File too large. Maximum size is 10MB.");return}if(!["image/jpeg","image/png","image/gif","image/webp","application/pdf"].includes(W.type)){alert("Invalid file type. Please upload an image (JPG, PNG, GIF, WebP) or PDF.");return}a(!0),h("Uploading...");try{const C=Date.now(),D=W.name.split(".").pop(),V=`users/${i}/carnivals/${r}/${C}.${D}`,U=zl(ql,V);await Nm(U,W);const M=await Am(U),le={id:C.toString(),name:S||W.name.split(".")[0],type:v,url:M,storagePath:V,originalName:W.name,uploadedAt:new Date().toISOString(),fileType:W.type};e([...t,le]),N(""),h(""),P.current&&(P.current.value="")}catch(C){console.error("Upload error:",C),alert("Failed to upload file. Please try again.")}a(!1)},R=async G=>{if(confirm("Are you sure you want to delete this file?"))try{const W=zl(ql,G.storagePath);await b1(W),e(t.filter(T=>T.id!==G.id))}catch(W){console.error("Delete error:",W),e(t.filter(T=>T.id!==G.id))}},k=G=>{const W=document.createElement("a");W.href=G.url,W.download=G.originalName||G.name,W.target="_blank",document.body.appendChild(W),W.click(),document.body.removeChild(W)},A=t.filter(G=>G.type==="ticket"),z=t.filter(G=>G.type==="photo");return c.jsxs("div",{className:"space-y-6",children:[c.jsx("div",{className:"flex items-center justify-between",children:c.jsxs("div",{children:[c.jsxs("h3",{className:"text-xl font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[c.jsx(Lh,{className:"w-5 h-5 text-purple-500"}),"Media Vault"]}),c.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Store your tickets, photos, and important documents for ",n]})]})}),c.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 rounded-xl p-4 border border-purple-100 dark:border-purple-800",children:[c.jsx("h4",{className:"font-semibold text-gray-800 dark:text-white mb-3",children:"Upload New File"}),c.jsxs("div",{className:"grid gap-3",children:[c.jsxs("div",{className:"flex gap-3",children:[c.jsx("input",{type:"text",placeholder:"File label (e.g., 'Tribe Costume Receipt')",value:S,onChange:G=>N(G.target.value),className:"flex-1 px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white"}),c.jsx("select",{value:v,onChange:G=>w(G.target.value),className:"px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white",children:Object.entries(my).map(([G,{label:W}])=>c.jsx("option",{value:G,children:W},G))})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("input",{ref:P,type:"file",accept:"image/*,.pdf",onChange:F,className:"hidden",id:"file-upload"}),c.jsx("label",{htmlFor:"file-upload",className:`flex-1 flex items-center justify-center gap-2 px-4 py-3 border-2 border-dashed rounded-lg cursor-pointer transition ${o?"border-gray-300 bg-gray-50 dark:bg-gray-800 cursor-not-allowed":"border-purple-300 hover:border-purple-500 hover:bg-purple-50 dark:hover:bg-purple-900/20"}`,children:o?c.jsxs(c.Fragment,{children:[c.jsx(Gr,{className:"w-5 h-5 animate-spin text-purple-500"}),c.jsx("span",{className:"text-purple-600 dark:text-purple-400",children:u})]}):c.jsxs(c.Fragment,{children:[c.jsx(i3,{className:"w-5 h-5 text-purple-500"}),c.jsx("span",{className:"text-purple-600 dark:text-purple-400 font-medium",children:"Click to upload image or PDF (max 10MB)"})]})})]})]})]}),A.length>0&&c.jsxs("div",{children:[c.jsxs("h4",{className:"font-semibold text-gray-800 dark:text-white mb-3 flex items-center gap-2",children:[c.jsx(zv,{className:"w-4 h-4 text-yellow-500"}),"Tickets (",A.length,")"]}),c.jsx("div",{className:"grid gap-3",children:A.map(G=>c.jsx(m3,{file:G,onView:y,onDownload:k,onDelete:R},G.id))})]}),z.length>0&&c.jsxs("div",{children:[c.jsxs("h4",{className:"font-semibold text-gray-800 dark:text-white mb-3 flex items-center gap-2",children:[c.jsx(Lh,{className:"w-4 h-4 text-blue-500"}),"Photos (",z.length,")"]}),c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:z.map(G=>c.jsx(p3,{file:G,onView:y,onDownload:k,onDelete:R},G.id))})]}),t.length===0&&c.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[c.jsx(Lh,{className:"w-16 h-16 mx-auto mb-3 opacity-30"}),c.jsx("p",{className:"font-medium",children:"No files uploaded yet"}),c.jsx("p",{className:"text-sm",children:"Upload your tickets, costume receipts, and travel photos"})]}),m&&c.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4",onClick:()=>y(null),children:c.jsxs("div",{className:"relative max-w-4xl max-h-[90vh] w-full",onClick:G=>G.stopPropagation(),children:[c.jsx("button",{onClick:()=>y(null),className:"absolute -top-12 right-0 text-white hover:text-gray-300",children:c.jsx(fa,{className:"w-8 h-8"})}),m.fileType==="application/pdf"?c.jsx("iframe",{src:m.url,className:"w-full h-[80vh] rounded-lg"}):c.jsx("img",{src:m.url,alt:m.name,className:"max-w-full max-h-[80vh] mx-auto rounded-lg"}),c.jsx("p",{className:"text-white text-center mt-4 font-medium",children:m.name})]})})]})}function m3({file:t,onView:e,onDownload:n,onDelete:r}){const i=my[t.type]||my.ticket,o=i.icon;return c.jsxs("div",{className:"flex items-center justify-between p-3 bg-white dark:bg-gray-700 rounded-lg border border-gray-100 dark:border-gray-600 shadow-sm",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:{backgroundColor:`${i.color}20`},children:c.jsx(o,{className:"w-5 h-5",style:{color:i.color}})}),c.jsxs("div",{children:[c.jsx("p",{className:"font-medium text-gray-800 dark:text-white",children:t.name}),c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:new Date(t.uploadedAt).toLocaleDateString()})]})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("button",{onClick:()=>e(t),className:"p-2 text-gray-500 hover:text-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition",children:c.jsx(Uv,{className:"w-4 h-4"})}),c.jsx("button",{onClick:()=>n(t),className:"p-2 text-gray-500 hover:text-green-500 hover:bg-green-50 dark:hover:bg-green-900/20 rounded-lg transition",children:c.jsx(jm,{className:"w-4 h-4"})}),c.jsx("button",{onClick:()=>r(t),className:"p-2 text-gray-500 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition",children:c.jsx(rs,{className:"w-4 h-4"})})]})]})}function p3({file:t,onView:e,onDownload:n,onDelete:r}){return c.jsxs("div",{className:"relative group rounded-lg overflow-hidden border border-gray-200 dark:border-gray-600",children:[c.jsx("img",{src:t.url,alt:t.name,className:"w-full h-32 object-cover cursor-pointer",onClick:()=>e(t)}),c.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2",children:[c.jsx("button",{onClick:()=>e(t),className:"p-2 bg-white/20 hover:bg-white/30 rounded-full text-white transition",children:c.jsx(Uv,{className:"w-4 h-4"})}),c.jsx("button",{onClick:()=>n(t),className:"p-2 bg-white/20 hover:bg-white/30 rounded-full text-white transition",children:c.jsx(jm,{className:"w-4 h-4"})}),c.jsx("button",{onClick:()=>r(t),className:"p-2 bg-red-500/50 hover:bg-red-500/70 rounded-full text-white transition",children:c.jsx(rs,{className:"w-4 h-4"})})]}),c.jsx("p",{className:"absolute bottom-0 left-0 right-0 bg-black/60 text-white text-xs p-2 truncate",children:t.name})]})}const oh={trinidad:"https://open.spotify.com/embed/playlist/2H61cIhlAeFVmreSMqvui3",jamaica:"https://open.spotify.com/embed/playlist/37i9dQZF1DX82pCGH5USnM",miami:"https://open.spotify.com/embed/playlist/37i9dQZF1DXS1X4r7p38D5",stlucia:"https://open.spotify.com/embed/playlist/37i9dQZF1DX62XscWx9t6h",barbados:"https://open.spotify.com/embed/playlist/37i9dQZF1DX23V8kYg8jC2",stkitts:"https://open.spotify.com/embed/playlist/37i9dQZF1E4v6hGc9x5z4y",stcroix:"https://open.spotify.com/embed/playlist/37i9dQZF1E4v6hGc9x5z4y",stthomas:"https://open.spotify.com/embed/playlist/37i9dQZF1E4v6hGc9x5z4y",default:"https://open.spotify.com/embed/playlist/28bCuQ5IhyPbmvJx30ZMea"};function g3({activeCarnivalId:t,isPremium:e}){const[n,r]=B.useState(!1),[i,o]=B.useState(!1),[a,u]=B.useState(!1),h=()=>{if(!t)return{key:"default",url:oh.default};const v=Object.keys(oh).find(S=>t.toLowerCase().includes(S)),w=oh[v]||oh.default;return{key:v||"default (fallback)",url:w}},{key:m,url:y}=h();return n?c.jsxs("div",{className:`fixed z-40 transition-all duration-300 shadow-2xl overflow-hidden bg-black/90 backdrop-blur-md border border-white/20 rounded-t-2xl sm:rounded-2xl
      ${i?"bottom-24 right-4 w-64 h-16 rounded-full":"bottom-0 sm:bottom-24 right-0 sm:right-4 w-full sm:w-80 h-[400px]"}`,children:[c.jsxs("div",{className:`flex items-center justify-between p-3 bg-gradient-to-r from-pink-600 to-purple-700 text-white
        ${i?"h-full":""}`,children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(jf,{className:"w-5 h-5 animate-pulse"}),c.jsxs("div",{className:"flex flex-col",children:[c.jsx("span",{className:"font-bold text-sm",children:i?"Carnival Vibes":a?"Team Soca Live":"Soca Vibes Player"}),!i&&c.jsx("button",{onClick:()=>u(!a),className:"text-[10px] bg-white/20 px-2 py-0.5 rounded-full hover:bg-white/30 transition text-left w-fit",children:a?"Switch to Playlist":"Switch to Live Radio"})]})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[i?c.jsx("button",{onClick:()=>o(!1),className:"p-1 hover:bg-white/20 rounded",children:c.jsx(K5,{className:"w-4 h-4"})}):c.jsx("button",{onClick:()=>o(!0),className:"p-1 hover:bg-white/20 rounded",children:c.jsx(Z5,{className:"w-4 h-4"})}),c.jsx("button",{onClick:()=>r(!1),className:"p-1 hover:bg-white/20 rounded",children:c.jsx(fa,{className:"w-4 h-4"})})]})]}),!i&&c.jsxs("div",{className:"h-[calc(100%-48px)] bg-black relative",children:[!e&&!a&&c.jsx("div",{className:"absolute top-0 left-0 right-0 z-10 bg-yellow-500/90 text-black text-xs font-bold px-2 py-1 text-center",children:"Upgrade directly in Spotify for ad-free listening"}),a?c.jsx("iframe",{src:"https://ice23.securenetsystems.net/TSDC",width:"100%",height:"100%",frameBorder:"0",allow:"autoplay; encrypted-media;",title:"Team Soca Live"}):c.jsx("iframe",{style:{borderRadius:"12px"},src:y,width:"100%",height:"100%",frameBorder:"0",allowFullScreen:"",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Soca Playlist"})]})]}):c.jsx("button",{onClick:()=>r(!0),className:"fixed bottom-24 right-4 z-40 bg-gradient-to-r from-pink-500 to-purple-600 text-white p-3 rounded-full shadow-lg hover:scale-110 transition-transform animate-bounce-slow","aria-label":"Open Vibes Player",children:c.jsx(jf,{className:"w-6 h-6"})})}const jb=[{id:"default-fete-map-banner",title:"Unlock Interactive Fete Map",imageUrl:"/images/promo/premium_fete_map_promo_banner.png",placement:"banner",mediaType:"image",linkUrl:null,isDefault:!0},{id:"default-media-vault-banner",title:"Store Your Tickets & Photos",imageUrl:"/images/promo/premium_media_vault_promo_banner.png",placement:"banner",mediaType:"image",linkUrl:null,isDefault:!0},{id:"default-offline-banner",title:"Plan Offline, Anywhere",imageUrl:"/images/promo/premium_offline_mode_promo_banner.png",placement:"banner",mediaType:"image",linkUrl:null,isDefault:!0},{id:"default-premium-banner",title:"Go Premium - Ad Free Experience",imageUrl:"/images/promo/premium_subscription_promo_banner.png",placement:"banner",mediaType:"image",linkUrl:null,isDefault:!0},{id:"default-fete-map-inline",title:"Unlock Interactive Fete Map",imageUrl:"/images/promo/premium_fete_map_promo_banner.png",placement:"inline",mediaType:"image",linkUrl:null,isDefault:!0},{id:"default-media-vault-inline",title:"Store Your Tickets & Photos",imageUrl:"/images/promo/premium_media_vault_promo_banner.png",placement:"inline",mediaType:"image",linkUrl:null,isDefault:!0},{id:"default-offline-inline",title:"Plan Offline, Anywhere",imageUrl:"/images/promo/premium_offline_mode_promo_banner.png",placement:"inline",mediaType:"image",linkUrl:null,isDefault:!0},{id:"default-premium-inline",title:"Go Premium - Ad Free Experience",imageUrl:"/images/promo/premium_subscription_promo_banner.png",placement:"inline",mediaType:"image",linkUrl:null,isDefault:!0},{id:"madd-colors-banner",title:"Madd Colors Carnival - Atlanta",imageUrl:"https://cdn.pixabay.com/video/2022/12/12/142646-780654162_large.mp4",placement:"banner",mediaType:"video",linkUrl:"https://maddcolorscarnival.com/",isDefault:!0},{id:"madd-colors-inline",title:"Madd Colors Carnival - Atlanta",imageUrl:"https://cdn.pixabay.com/video/2022/12/12/142646-780654162_large.mp4",placement:"inline",mediaType:"video",linkUrl:"https://maddcolorscarnival.com/",isDefault:!0}];function ah({placement:t="banner",className:e="",onUpgradeClick:n}){const[r,i]=B.useState([]),[o,a]=B.useState(0),[u,h]=B.useState(!1),[m,y]=B.useState(!0),[v,w]=B.useState(null);if(B.useEffect(()=>{y(!0),w(null);const k=En(Ue,"promoAds"),A=Tm(k,ZS("active","==",!0)),z=$i(A,G=>{const W=[];G.forEach(b=>{W.push({id:b.id,...b.data()})});const T=W.filter(b=>b.placement===t);if(T.length>0)i(T);else{const b=jb.filter(C=>C.placement===t);i(b)}a(0),y(!1)},G=>{console.error(`PromoAd [${t}] error:`,G);const W=jb.filter(T=>T.placement===t);i(W),w(null),y(!1)});return()=>z()},[t]),B.useEffect(()=>{if(r.length<=1)return;const k=setInterval(()=>{a(A=>(A+1)%r.length)},8e3);return()=>clearInterval(k)},[r.length]),m||u||r.length===0)return null;const S=Math.min(o,r.length-1),N=r[S];if(!N||!N.imageUrl)return null;const P=N.mediaType==="video",F=N.isDefault,R=()=>{F&&n?n():N.linkUrl&&window.open(N.linkUrl,"_blank","noopener,noreferrer")};return c.jsx("div",{className:`p-4 relative ${e}`,children:c.jsxs("div",{onClick:R,className:`relative overflow-hidden rounded-lg shadow-md ${N.linkUrl||F?"cursor-pointer hover:shadow-lg transition-shadow":""}`,children:[P?c.jsx("video",{src:N.imageUrl,className:"w-full h-auto object-cover",style:{maxHeight:t==="banner"?"120px":"250px"},autoPlay:!0,muted:!0,loop:!0,playsInline:!0,onError:k=>console.error("Video load error:",k)}):c.jsx("img",{src:N.imageUrl,alt:N.title||"Promotion",className:"w-full h-auto object-cover",style:{maxHeight:t==="banner"?"120px":"250px"},onError:k=>{console.error("Image load error:",N.imageUrl),k.target.style.display="none"}}),N.title&&c.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/70 to-transparent p-3",children:[c.jsx("p",{className:"text-white text-sm font-bold truncate",children:N.title}),F&&c.jsx("p",{className:"text-yellow-300 text-xs font-medium",children:"Tap to upgrade to Premium"})]}),c.jsx("div",{className:"absolute top-1 left-1 bg-black/50 text-white text-[10px] px-1.5 py-0.5 rounded",children:F?"PREMIUM":"AD"}),c.jsx("button",{onClick:k=>{k.stopPropagation(),h(!0)},className:"absolute top-1 right-1 p-1 bg-black/50 hover:bg-black/70 text-white rounded-full transition",children:c.jsx(fa,{className:"w-3 h-3"})}),r.length>1&&c.jsx("div",{className:"absolute bottom-2 right-2 flex gap-1",children:r.map((k,A)=>c.jsx("div",{className:`w-1.5 h-1.5 rounded-full transition ${A===o?"bg-white":"bg-white/50"}`},A))})]})})}const Lb=[{id:"banner",label:"Top Banner"},{id:"sidebar",label:"Sidebar"},{id:"inline",label:"Inline (Between Sections)"}];function y3(){const[t,e]=B.useState([]),[n,r]=B.useState(!1),[i,o]=B.useState(""),[a,u]=B.useState(!1),[h,m]=B.useState({title:"",linkUrl:"",placement:"banner"}),y=B.useRef(null);B.useEffect(()=>{const N=En(Ue,"promoAds"),P=$i(N,F=>{const R=[];F.forEach(k=>{R.push({id:k.id,...k.data()})}),R.sort((k,A)=>(A.createdAt||0)-(k.createdAt||0)),e(R)});return()=>P()},[]);const v=async N=>{const P=N.target.files[0];if(!P)return;const F=P.type.startsWith("video/"),R=F?10*1024*1024:5*1024*1024;if(P.size>R){alert(`File too large. Maximum size is ${F?"10MB for videos":"5MB for images"}.`);return}const k=["image/jpeg","image/png","image/gif","image/webp"],A=["video/mp4","video/webm"];if(![...k,...A].includes(P.type)){alert("Invalid file type. Please upload JPG, PNG, GIF, WebP, MP4, or WebM.");return}r(!0),o("Preparing upload...");const G=setTimeout(()=>{r(!1),o(""),alert("Upload timed out after 60 seconds. Please check your connection and try again."),y.current&&(y.current.value="")},6e4);try{const W=Date.now(),T=P.name.split(".").pop(),b=`promoAds/${W}.${T}`,C=zl(ql,b);o("Uploading to storage..."),console.log("Uploading file to Storage...",b),await Nm(C,P),o("Getting download URL...");const D=await Am(C);console.log("File uploaded, URL:",D);const V=P.type.startsWith("video/"),U={title:h.title||"",linkUrl:h.linkUrl||"",placement:h.placement,imageUrl:D,mediaType:V?"video":"image",storagePath:b,active:!0,createdAt:W};o("Saving ad data..."),console.log("Saving ad metadata to Firestore...",U);const M=await ud(En(Ue,"promoAds"),U);console.log("Ad saved to Firestore successfully, ID:",M.id),clearTimeout(G),alert("Ad uploaded successfully!"),m({title:"",linkUrl:"",placement:"banner"}),u(!1),y.current&&(y.current.value="")}catch(W){clearTimeout(G),console.error("Upload error:",W),console.error("Error code:",W.code),console.error("Error message:",W.message),console.error("Full error:",JSON.stringify(W,null,2)),W.code==="storage/unauthorized"?alert("Upload failed: You do not have permission to upload ads. Make sure you are logged in with the admin account (djkrss1@gmail.com)."):W.code==="storage/canceled"?alert("Upload was cancelled."):W.code==="permission-denied"?alert("Firestore permission denied: You do not have permission to save ad metadata. Make sure you are logged in with the admin account (djkrss1@gmail.com)."):alert(`Failed to upload ad: ${W.code||"Unknown error"} - ${W.message||"Please try again."}`)}r(!1),o("")},w=async N=>{try{await zu(ut(Ue,"promoAds",N.id),{active:!N.active})}catch(P){console.error("Toggle error:",P)}},S=async N=>{if(confirm("Delete this ad?"))try{if(N.storagePath){const P=zl(ql,N.storagePath);await b1(P).catch(()=>{})}await gv(ut(Ue,"promoAds",N.id))}catch(P){console.error("Delete error:",P)}};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsxs("h3",{className:"text-xl font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[c.jsx(Dh,{className:"w-5 h-5 text-orange-500"}),"Ad Manager"]}),c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Upload promotional ads and flyers for free users"})]}),c.jsxs("button",{onClick:()=>u(!a),className:"flex items-center gap-1 px-3 py-1.5 bg-orange-600 text-white text-sm rounded-lg hover:bg-orange-700 transition",children:[c.jsx(rP,{className:"w-4 h-4"}),"New Ad"]})]}),a&&c.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/20 rounded-xl p-4 border border-orange-200 dark:border-orange-800 space-y-3",children:[c.jsxs("div",{className:"grid gap-3",children:[c.jsx("input",{type:"text",placeholder:"Ad title (optional)",value:h.title,onChange:N=>m({...h,title:N.target.value}),className:"px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white"}),c.jsx("input",{type:"url",placeholder:"Link URL (optional) - where to go when clicked",value:h.linkUrl,onChange:N=>m({...h,linkUrl:N.target.value}),className:"px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white"}),c.jsx("select",{value:h.placement,onChange:N=>m({...h,placement:N.target.value}),className:"px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white",children:Lb.map(N=>c.jsx("option",{value:N.id,children:N.label},N.id))})]}),c.jsx("input",{ref:y,type:"file",accept:"image/*,video/mp4,video/webm",onChange:v,className:"hidden",id:"ad-upload"}),c.jsx("label",{htmlFor:"ad-upload",className:`flex flex-col items-center justify-center gap-2 px-4 py-4 border-2 border-dashed rounded-lg cursor-pointer transition ${n?"border-gray-300 bg-gray-50 cursor-not-allowed":"border-orange-300 hover:border-orange-500 hover:bg-orange-50 dark:hover:bg-orange-900/30"}`,children:n?c.jsxs(c.Fragment,{children:[c.jsx(Gr,{className:"w-5 h-5 animate-spin text-orange-500"}),c.jsx("span",{className:"text-orange-600",children:i||"Uploading..."})]}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Dh,{className:"w-5 h-5 text-orange-500"}),c.jsx(s3,{className:"w-5 h-5 text-orange-500"})]}),c.jsx("span",{className:"text-orange-600 font-medium",children:"Click to upload image or video"}),c.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Images: max 5MB (1200x300 recommended) | Videos: max 10MB (MP4, WebM)"})]})})]}),t.length>0?c.jsx("div",{className:"space-y-3",children:t.map(N=>{var P;return c.jsxs("div",{className:`flex items-center gap-4 p-3 rounded-lg border transition ${N.active?"bg-white dark:bg-gray-700 border-gray-200 dark:border-gray-600":"bg-gray-100 dark:bg-gray-800 border-gray-200 dark:border-gray-700 opacity-60"}`,children:[N.mediaType==="video"?c.jsx("video",{src:N.imageUrl,className:"w-20 h-14 object-cover rounded",muted:!0}):c.jsx("img",{src:N.imageUrl,alt:N.title||"Ad",className:"w-20 h-14 object-cover rounded"}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("p",{className:"font-medium text-gray-800 dark:text-white truncate",children:N.title||"Untitled Ad"}),c.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[((P=Lb.find(F=>F.id===N.placement))==null?void 0:P.label)||N.placement,N.linkUrl&&"  Has link"]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:()=>w(N),className:`p-2 rounded-lg transition ${N.active?"text-green-600 hover:bg-green-50":"text-gray-400 hover:bg-gray-100"}`,title:N.active?"Active - Click to disable":"Inactive - Click to enable",children:N.active?c.jsx(cP,{className:"w-5 h-5"}):c.jsx(lP,{className:"w-5 h-5"})}),N.linkUrl&&c.jsx("a",{href:N.linkUrl,target:"_blank",rel:"noopener noreferrer",className:"p-2 text-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition",children:c.jsx(Lm,{className:"w-4 h-4"})}),c.jsx("button",{onClick:()=>S(N),className:"p-2 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition",children:c.jsx(rs,{className:"w-4 h-4"})})]})]},N.id)})}):c.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[c.jsx(Dh,{className:"w-16 h-16 mx-auto mb-3 opacity-30"}),c.jsx("p",{className:"font-medium",children:"No ads uploaded yet"}),c.jsx("p",{className:"text-sm",children:"Upload flyers and promotions to show to free users"})]})]})}function _3({users:t,onDeleteUser:e,onDeleteAll:n,onClose:r}){const[i,o]=B.useState(new Set),[a,u]=B.useState(!1),h=B.useMemo(()=>t.filter(w=>{var P,F;const S=((P=w.profile)==null?void 0:P.email)&&w.profile.email.trim()!=="",N=((F=w.profile)==null?void 0:F.displayName)&&w.profile.displayName.trim()!==""&&w.profile.displayName!=="User";return!S&&!N}),[t]),m=w=>{const S=new Set(i);S.has(w)?S.delete(w):S.add(w),o(S)},y=()=>{i.size===h.length?o(new Set):o(new Set(h.map(w=>w.id)))},v=()=>{a?(n(Array.from(i)),u(!1),o(new Set)):u(!0)};return c.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 shadow-xl overflow-hidden animate-fadeIn",children:[c.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center bg-red-50 dark:bg-red-900/10",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2 bg-red-100 dark:bg-red-900/30 rounded-lg text-red-600 dark:text-red-400",children:c.jsx(oP,{className:"w-5 h-5"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-100",children:"Database Cleanup"}),c.jsxs("p",{className:"text-xs text-red-600 dark:text-red-400 font-medium",children:["Found ",h.length," incomplete records"]})]})]}),c.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-lg transition",children:c.jsx(fa,{className:"w-5 h-5 text-gray-500"})})]}),c.jsx("div",{className:"p-4",children:h.length===0?c.jsxs("div",{className:"text-center py-12 text-gray-500",children:[c.jsx(F5,{className:"w-12 h-12 mx-auto mb-3 text-green-500 opacity-50"}),c.jsx("p",{children:"Database is clean! No incomplete users found."})]}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"checkbox",checked:i.size>0&&i.size===h.length,onChange:y,className:"rounded border-gray-300 text-red-600 focus:ring-red-500"}),c.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Select All (",h.length,")"]})]}),i.size>0&&c.jsxs("button",{onClick:v,className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold transition ${a?"bg-red-600 text-white hover:bg-red-700":"bg-red-100 text-red-700 hover:bg-red-200 dark:bg-red-900/30 dark:text-red-300"}`,children:[c.jsx(rs,{className:"w-4 h-4"}),a?"CONFIRM DELETION":`Delete (${i.size})`]})]}),c.jsx("div",{className:"max-h-[300px] overflow-y-auto border border-gray-200 dark:border-gray-700 rounded-lg",children:c.jsxs("table",{className:"w-full text-sm text-left",children:[c.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50 text-xs uppercase text-gray-500 font-medium sticky top-0 backdrop-blur-sm",children:c.jsxs("tr",{children:[c.jsx("th",{className:"p-3 w-10"}),c.jsx("th",{className:"p-3",children:"User ID"}),c.jsx("th",{className:"p-3",children:"Created"}),c.jsx("th",{className:"p-3 text-right",children:"Actions"})]})}),c.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:h.map(w=>{var S;return c.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/30 transition",children:[c.jsx("td",{className:"p-3",children:c.jsx("input",{type:"checkbox",checked:i.has(w.id),onChange:()=>m(w.id),className:"rounded border-gray-300 text-red-600 focus:ring-red-500"})}),c.jsx("td",{className:"p-3 font-mono text-xs text-gray-500",children:w.id}),c.jsx("td",{className:"p-3 text-gray-600 dark:text-gray-300",children:(S=w.createdAt)!=null&&S.toDate?w.createdAt.toDate().toLocaleDateString():"Unknown"}),c.jsx("td",{className:"p-3 text-right",children:c.jsx("button",{onClick:()=>e(w.id),className:"text-gray-400 hover:text-red-500 transition",title:"Delete single user",children:c.jsx(rs,{className:"w-4 h-4"})})})]},w.id)})})]})})]})}),h.length>0&&c.jsxs("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900/10 border-t border-yellow-100 dark:border-yellow-900/20 flex items-start gap-3 text-xs text-yellow-800 dark:text-yellow-200",children:[c.jsx(X1,{className:"w-4 h-4 shrink-0 mt-0.5"}),c.jsxs("p",{children:[c.jsx("strong",{children:"Warning:"})," Deleting users is permanent. This will remove their record from the 'users' collection. If they sign in again, a new record will be created."]})]})]})}const Mc="carnival-planner-v1",v3=["djkrss1@gmail.com"],x3=ci(On);function w3(){const[t,e]=B.useState([]),[n,r]=B.useState(!0),[i,o]=B.useState(null),[a,u]=B.useState(""),[h,m]=B.useState(null),[y,v]=B.useState({total:0,premium:0,free:0}),[w,S]=B.useState(!1),[N,P]=B.useState(!1),[F,R]=B.useState(null),[k,A]=B.useState(!1),[z,G]=B.useState(!1),W=async le=>{if(confirm("Are you sure you want to delete this user? This cannot be undone."))try{await Cg(async()=>{const{deleteDoc:Ee}=await Promise.resolve().then(()=>ab);return{deleteDoc:Ee}},void 0).then(({deleteDoc:Ee})=>{Ee(ut(Ue,"users",le))}),e(Ee=>Ee.filter(Ce=>Ce.id!==le)),v(Ee=>({...Ee,total:Ee.total-1,free:Ee.free-1}))}catch(Ee){console.error("Delete error:",Ee),alert("Failed to delete user: "+Ee.message)}},T=async le=>{try{const{deleteDoc:Ee}=await Cg(async()=>{const{deleteDoc:Re}=await Promise.resolve().then(()=>ab);return{deleteDoc:Re}},void 0);let Ce=0;for(const Re of le)await Ee(ut(Ue,"users",Re)),Ce++;e(Re=>Re.filter(K=>!le.includes(K.id))),v(Re=>({...Re,total:Re.total-Ce,free:Re.free-Ce})),alert(`Successfully deleted ${Ce} users.`)}catch(Ee){console.error("Batch delete error:",Ee),alert("Batch delete failed partially: "+Ee.message)}},b=async()=>{A(!0),R("Migrating users from Firebase Auth...");try{const Ee=await ui(x3,"migrateAuthUsers")({});R(Ee.data.message),await D()}catch(le){console.error("Auth migration error:",le),R(`Auth migration failed: ${le.message}`)}A(!1)},C=async()=>{var le,Ee,Ce,Re,K,ce,X,we,ue,me,_e,fe,de,De,lt,Gn;P(!0),R("Starting migration...");try{const Pt=new Map;let en=[];try{const Xe=await Ya(En(Ue,"user-activity"));console.log("[Migration] Found",Xe.size,"user-activity records"),en.push(`${Xe.size} activity records`);for(const ft of Xe.docs){const He=ft.data(),zt=He.uid;if(zt)if(!Pt.has(zt))Pt.set(zt,{createdAt:He.loginAt,lastLoginAt:He.loginAt,email:He.email||null,displayName:He.displayName||null});else{const mt=Pt.get(zt);((Ee=(le=He.loginAt)==null?void 0:le.toMillis)==null?void 0:Ee.call(le))<((Re=(Ce=mt.createdAt)==null?void 0:Ce.toMillis)==null?void 0:Re.call(Ce))&&(mt.createdAt=He.loginAt),((ce=(K=He.loginAt)==null?void 0:K.toMillis)==null?void 0:ce.call(K))>((we=(X=mt.lastLoginAt)==null?void 0:X.toMillis)==null?void 0:we.call(X))&&(mt.lastLoginAt=He.loginAt),!mt.email&&He.email&&(mt.email=He.email),!mt.displayName&&He.displayName&&(mt.displayName=He.displayName)}}}catch(Xe){console.log("[Migration] Could not fetch user-activity:",Xe.message)}try{const Xe=await Ya(En(Ue,"artifacts",Mc,"users"));console.log("[Migration] Found",Xe.size,"artifact users"),en.push(`${Xe.size} artifact users`);for(const ft of Xe.docs){const He=ft.id,zt=ft.data();Pt.has(He)||Pt.set(He,{createdAt:zt.createdAt||Ze.now(),lastLoginAt:zt.lastLoginAt||Ze.now(),email:null,displayName:null})}}catch(Xe){console.log("[Migration] Could not fetch artifacts:",Xe.message)}R(`Found ${Pt.size} unique users (${en.join(", ")})...`);let an=0;for(const[Xe,ft]of Pt)try{const He=ut(Ue,"users",Xe),zt=await Mo(He);if(!zt.exists())await qr(He,ft),an++;else{const mt=zt.data(),_n={};ft.createdAt&&(!mt.createdAt||((me=(ue=ft.createdAt).toMillis)==null?void 0:me.call(ue))<((fe=(_e=mt.createdAt)==null?void 0:_e.toMillis)==null?void 0:fe.call(_e)))&&(_n.createdAt=ft.createdAt),ft.lastLoginAt&&(!mt.lastLoginAt||((De=(de=ft.lastLoginAt).toMillis)==null?void 0:De.call(de))>((Gn=(lt=mt.lastLoginAt)==null?void 0:lt.toMillis)==null?void 0:Gn.call(lt)))&&(_n.lastLoginAt=ft.lastLoginAt),!mt.email&&ft.email&&(_n.email=ft.email),!mt.displayName&&ft.displayName&&(_n.displayName=ft.displayName),Object.keys(_n).length>0&&(await qr(He,_n,{merge:!0}),an++)}}catch(He){console.error(`Failed to migrate user ${Xe}:`,He)}R(`Migration complete! Migrated ${an} users.`),await D()}catch(Pt){console.error("Migration error:",Pt),R(`Migration failed: ${Pt.message}`)}P(!1)},D=async()=>{var le,Ee,Ce,Re,K;r(!0),o(null);try{console.log("[AdminAnalytics] Fetching users...");const ce=new Map;try{console.log("[AdminAnalytics] Attempting to fetch users collection...");const ue=await Ya(En(Ue,"users"));console.log("[AdminAnalytics] SUCCESS: Found",ue.size,"user documents in users collection"),ue.docs.forEach(me=>console.log("[AdminAnalytics] User doc:",me.id,me.data()));for(const me of ue.docs){const _e=me.id,fe=me.data();ce.set(_e,{id:_e,createdAt:fe.createdAt,lastLoginAt:fe.lastLoginAt,profile:{email:fe.email||null,displayName:fe.displayName||null},source:"users"})}}catch(ue){console.log("[AdminAnalytics] Could not fetch users collection:",ue.message)}try{console.log("[AdminAnalytics] Attempting to fetch user-activity collection...");const ue=await Ya(En(Ue,"user-activity"));console.log("[AdminAnalytics] SUCCESS: Found",ue.size,"activity records");for(const me of ue.docs){const _e=me.data(),fe=_e.uid;if(fe&&!ce.has(fe))ce.set(fe,{id:fe,createdAt:_e.loginAt||null,lastLoginAt:_e.loginAt||null,profile:{email:_e.email||null,displayName:_e.displayName||null},source:"user-activity"});else if(fe&&ce.has(fe)){const de=ce.get(fe);_e.loginAt&&(!de.lastLoginAt||((Ee=(le=_e.loginAt).toMillis)==null?void 0:Ee.call(le))>((Re=(Ce=de.lastLoginAt).toMillis)==null?void 0:Re.call(Ce)))&&(de.lastLoginAt=_e.loginAt),!de.profile.email&&_e.email&&(de.profile.email=_e.email)}}}catch(ue){console.log("[AdminAnalytics] Could not fetch user-activity collection:",ue.message)}try{console.log("[AdminAnalytics] Attempting to fetch artifacts collection...");const ue=await Ya(En(Ue,"artifacts",Mc,"users"));console.log("[AdminAnalytics] SUCCESS: Found",ue.size,"users in artifacts collection");for(const me of ue.docs){const _e=me.id;if(!ce.has(_e)){const fe=me.data();ce.set(_e,{id:_e,createdAt:fe.createdAt||null,lastLoginAt:fe.lastLoginAt||null,profile:{email:null,displayName:null},source:"artifacts"})}}}catch(ue){console.log("[AdminAnalytics] Could not fetch artifacts collection:",ue.message)}const X=[];for(const[ue,me]of ce){try{const fe=ut(Ue,"users",ue,"profile","info"),de=await Mo(fe);if(de.exists()){const De=de.data();me.profile={...me.profile,...De,email:De.email||me.profile.email,displayName:De.displayName||me.profile.displayName}}}catch{}me.isPremium=!1,me.carnivalCount=0;try{const fe=ut(Ue,"users",ue,"apps",Mc),de=await Mo(fe);if(de.exists()){const De=de.data();me.isPremium=!!De.premiumActive,De.selectedCarnivals&&(me.carnivalCount=Object.keys(De.selectedCarnivals).length)}}catch{try{const de=ut(Ue,"artifacts",Mc,"users",ue),De=await Mo(de);if(De.exists()){const lt=De.data();me.isPremium=!!lt.premiumActive,lt.selectedCarnivals&&(me.carnivalCount=Object.keys(lt.selectedCarnivals).length)}}catch{}}const _e=((K=me.profile)==null?void 0:K.email)||"";_e&&v3.includes(_e.toLowerCase())&&(me.isPremium=!0,me.premiumOverride=!0),X.push(me)}console.log("[AdminAnalytics] Total unique users found:",X.length),X.sort((ue,me)=>{var de,De,lt,Gn;const _e=((De=(de=ue.createdAt)==null?void 0:de.toDate)==null?void 0:De.call(de))||new Date(0);return(((Gn=(lt=me.createdAt)==null?void 0:lt.toDate)==null?void 0:Gn.call(lt))||new Date(0))-_e}),e(X);const we=X.filter(ue=>ue.isPremium).length;v({total:X.length,premium:we,free:X.length-we})}catch(ce){console.error("Error fetching users:",ce),o(ce.message||"Failed to fetch users")}r(!1)};B.useEffect(()=>{D()},[]);const V=async()=>{S(!0),await D(),S(!1)},U=async(le,Ee,Ce)=>{if(Ce){alert("This user has premium via email override. Cannot toggle manually.");return}try{const Re=ut(Ue,"users",le,"apps",Mc);await qr(Re,{premiumActive:!Ee,premiumUpdatedAt:Ze.now(),premiumUpdatedBy:"admin-manual"},{merge:!0}),e(K=>K.map(ce=>ce.id===le?{...ce,isPremium:!Ee}:ce)),v(K=>({...K,premium:Ee?K.premium-1:K.premium+1,free:Ee?K.free+1:K.free-1})),alert(`Premium ${Ee?"disabled":"enabled"} for user.`)}catch(Re){console.error("Error toggling premium:",Re),alert("Failed to update premium status: "+Re.message)}},M=t.filter(le=>{var K,ce;const Ee=((K=le.profile)==null?void 0:K.email)||le.id,Ce=((ce=le.profile)==null?void 0:ce.displayName)||"",Re=a.toLowerCase();return Ee.toLowerCase().includes(Re)||Ce.toLowerCase().includes(Re)});return n?c.jsxs("div",{className:"flex items-center justify-center py-12",children:[c.jsx(Gr,{className:"w-8 h-8 animate-spin text-blue-500"}),c.jsx("span",{className:"ml-2 text-gray-500 dark:text-gray-400",children:"Loading user data..."})]}):i?c.jsxs("div",{className:"text-center py-12",children:[c.jsx("p",{className:"text-red-500 mb-4",children:i}),c.jsx("button",{onClick:V,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Try Again"})]}):c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsxs("h3",{className:"text-xl font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[c.jsx(Oi,{className:"w-5 h-5 text-blue-500"}),"User Analytics"]}),c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"View and manage registered users"})]}),c.jsxs("div",{className:"flex gap-2 flex-wrap",children:[c.jsxs("button",{onClick:b,disabled:k,className:"flex items-center gap-1 px-3 py-1.5 bg-purple-600 text-white text-sm rounded-lg hover:bg-purple-700 transition disabled:opacity-50",children:[k?c.jsx(Gr,{className:"w-4 h-4 animate-spin"}):c.jsx(jm,{className:"w-4 h-4"}),"Migrate Auth Users"]}),c.jsxs("button",{onClick:C,disabled:N,className:"flex items-center gap-1 px-3 py-1.5 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700 transition disabled:opacity-50",children:[N?c.jsx(Gr,{className:"w-4 h-4 animate-spin"}):c.jsx(Oi,{className:"w-4 h-4"}),"Migrate Data"]}),c.jsxs("button",{onClick:()=>G(!z),className:`flex items-center gap-1 px-3 py-1.5 text-sm rounded-lg transition ${z?"bg-red-600 text-white hover:bg-red-700":"bg-white border border-gray-200 text-gray-700 hover:bg-gray-50 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200"}`,children:[c.jsx(oP,{className:"w-4 h-4"}),z?"Close Cleanup":"Cleanup Tool"]}),c.jsxs("button",{onClick:V,disabled:w,className:"flex items-center gap-1 px-3 py-1.5 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 transition disabled:opacity-50",children:[c.jsx(X5,{className:`w-4 h-4 ${w?"animate-spin":""}`}),"Refresh"]})]})]}),z&&c.jsx(_3,{users:t,onDeleteUser:W,onDeleteAll:T,onClose:()=>G(!1)}),F&&c.jsx("div",{className:`p-3 rounded-lg text-sm ${F.includes("failed")?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400"}`,children:F}),c.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[c.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl p-4 text-white",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[c.jsx(Oi,{className:"w-5 h-5 opacity-80"}),c.jsx("span",{className:"text-sm font-medium opacity-80",children:"Total Users"})]}),c.jsx("p",{className:"text-3xl font-bold",children:y.total})]}),c.jsxs("div",{className:"bg-gradient-to-br from-yellow-500 to-orange-500 rounded-xl p-4 text-white",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[c.jsx(Pb,{className:"w-5 h-5 opacity-80"}),c.jsx("span",{className:"text-sm font-medium opacity-80",children:"Premium"})]}),c.jsx("p",{className:"text-3xl font-bold",children:y.premium})]}),c.jsxs("div",{className:"bg-gradient-to-br from-gray-500 to-gray-600 rounded-xl p-4 text-white",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[c.jsx(Oi,{className:"w-5 h-5 opacity-80"}),c.jsx("span",{className:"text-sm font-medium opacity-80",children:"Free"})]}),c.jsx("p",{className:"text-3xl font-bold",children:y.free})]})]}),c.jsxs("div",{className:"relative",children:[c.jsx(iP,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),c.jsx("input",{type:"text",placeholder:"Search by email or name...",value:a,onChange:le=>u(le.target.value),className:"w-full pl-10 pr-4 py-3 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white"})]}),c.jsx("div",{className:"space-y-2",children:M.length===0?c.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:a?"No users match your search":"No users found"}):M.map(le=>{var Ee,Ce,Re,K;return c.jsxs("div",{className:"bg-white dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600 overflow-hidden",children:[c.jsxs("div",{className:"flex items-center gap-3 p-3 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-600",onClick:()=>m(h===le.id?null:le.id),children:[(Ee=le.profile)!=null&&Ee.avatarUrl?c.jsx("img",{src:le.profile.avatarUrl,alt:"",className:"w-10 h-10 rounded-full object-cover"}):c.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-200 dark:bg-gray-500 flex items-center justify-center",children:c.jsx(Oi,{className:"w-5 h-5 text-gray-400 dark:text-gray-300"})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("p",{className:"font-medium text-gray-800 dark:text-white truncate",children:((Ce=le.profile)==null?void 0:Ce.displayName)||"No name"}),le.isPremium&&c.jsxs("span",{className:`px-1.5 py-0.5 text-xs rounded-full flex items-center gap-1 ${le.premiumOverride?"bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-400":"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400"}`,children:[c.jsx(Pb,{className:"w-3 h-3"}),le.premiumOverride?"Admin":"Premium"]})]}),c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate",children:((Re=le.profile)==null?void 0:Re.email)||le.id})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[le.carnivalCount>0&&c.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400 flex items-center gap-1",children:[c.jsx($l,{className:"w-4 h-4"}),le.carnivalCount," carnival",le.carnivalCount!==1?"s":""]}),h===le.id?c.jsx(B5,{className:"w-5 h-5 text-gray-400"}):c.jsx(U5,{className:"w-5 h-5 text-gray-400"})]})]}),h===le.id&&c.jsxs("div",{className:"px-4 pb-4 pt-2 border-t border-gray-100 dark:border-gray-600 bg-gray-50 dark:bg-gray-800",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"User ID"}),c.jsx("p",{className:"text-sm font-mono text-gray-700 dark:text-gray-300 truncate",children:le.id})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Bio"}),c.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:((K=le.profile)==null?void 0:K.bio)||"No bio"})]})]}),c.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-gray-200 dark:border-gray-600",children:[c.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Premium Status"}),c.jsx("button",{onClick:ce=>{ce.stopPropagation(),U(le.id,le.isPremium,le.premiumOverride)},className:`flex items-center gap-2 px-3 py-1.5 rounded-lg transition ${le.isPremium?"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"}`,children:le.isPremium?c.jsxs(c.Fragment,{children:[c.jsx(cP,{className:"w-5 h-5"}),c.jsx("span",{children:"Premium Active"})]}):c.jsxs(c.Fragment,{children:[c.jsx(lP,{className:"w-5 h-5"}),c.jsx("span",{children:"Free User"})]})})]})]})]},le.id)})}),c.jsxs("p",{className:"text-xs text-gray-400 dark:text-gray-500 text-center",children:["Showing ",M.length," of ",t.length," users"]})]})}const b3=[{name:"TRIBE Carnival",carnivalId:"trinidad",type:"mas",website:"https://tribecarnival.com",tags:["Premium","High Energy","Popular"]},{name:"The Lost Tribe",carnivalId:"trinidad",type:"mas",website:"https://losttribecarnival.com",tags:["Creative","Thematic","Premium"]},{name:"Bliss Carnival",carnivalId:"trinidad",type:"mas",website:"https://blisscarnival.com",tags:["Premium","Exclusive"]},{name:"YUMA Vibe",carnivalId:"trinidad",type:"mas",website:"https://yumavibe.com",tags:["Young","Energetic","Party"]},{name:"Harts Carnival",carnivalId:"trinidad",type:"mas",website:"https://hartscarnival.com",tags:["Traditional","Family","Fun"]},{name:"Pure Carnival",carnivalId:"trinidad",type:"mas",website:"https://pure.carnival-tribe.com",tags:["Fun","All Inclusive"]},{name:"Paparazzi Carnival",carnivalId:"trinidad",type:"mas",website:"https://paparazzicarnival.com",tags:["Thematic","Design"]},{name:"Ronnie and Caro",carnivalId:"trinidad",type:"mas",website:"https://ronnieandcaro.com",tags:["Big Band","Winner"]},{name:"K2K Alliance",carnivalId:"trinidad",type:"mas",website:"https://k2k-alliance.com",tags:["Artistic","Couture"]},{name:"Resonate Carnival",carnivalId:"trinidad",type:"mas",tags:["New","Vibes"]},{name:"Showtime Carnival",carnivalId:"trinidad",type:"mas",tags:["Affordable","Fun"]},{name:"Spirit Mas",carnivalId:"trinidad",type:"mas",tags:["Inaugural","Exciting"]},{name:"Exousia Mas",carnivalId:"trinidad",type:"mas",tags:["Small Band","Detailed"]},{name:"Just Wee and Friends",carnivalId:"trinidad",type:"mas",tags:["J'ouvert","Fun"]},{name:"Xodus Carnival",carnivalId:"jamaica",type:"mas",website:"https://xoduscarnival.com",tags:["Premium","Big Band"]},{name:"Bacchanal Jamaica",carnivalId:"jamaica",type:"mas",website:"https://bacchanaljamaica.com",tags:["Legacy","Big Band"]},{name:"Xaymaca International",carnivalId:"jamaica",type:"mas",website:"https://xaymacainternational.com",tags:["Premium","Vibes"]},{name:"Yardmas Carnival",carnivalId:"jamaica",type:"mas",website:"https://yardmas.com",tags:["New","Local"]},{name:"GenX Jamaica",carnivalId:"jamaica",type:"mas",website:"https://genxcarnival.com",tags:["Miami Link","Fun"]},{name:"Ocho Rios Carnival",carnivalId:"jamaica",type:"mas",tags:["North Coast","Holiday"]},{name:"GenX Carnival",carnivalId:"miami",type:"mas",website:"https://genx.carnival-tribe.com",tags:["Big Band","Winner"]},{name:"Ramajay Mas",carnivalId:"miami",type:"mas",website:"https://ramajaymas.com",tags:["Vibes","Party"]},{name:"Revel Nation",carnivalId:"miami",type:"mas",tags:["Premium","Service"]},{name:"One Island Band",carnivalId:"miami",type:"mas",website:"https://oneislandband.com",tags:["Big Band","Fun"]},{name:"Freaks Mas",carnivalId:"miami",type:"mas",website:"https://freaksmas.com",tags:["Energy","New York Link"]},{name:"Dingolay Mas",carnivalId:"miami",type:"mas",tags:["Vibrant","Fun"]},{name:"K-Paya",carnivalId:"miami",type:"mas",tags:["Party","Vibes"]},{name:"Savage Mas",carnivalId:"miami",type:"mas",tags:["Sexy","Fun"]},{name:"Euphoria Mas",carnivalId:"miami",type:"mas",tags:["Service","Quality"]},{name:"UCOM (United Colours of Mas)",carnivalId:"nottinghill",type:"mas",website:"https://unitedcoloursofmas.com",tags:["Modern","Premium"]},{name:"Chocolate Nation",carnivalId:"nottinghill",type:"mas",website:"https://chocolatenationmas.com",tags:["Vibes","Service"]},{name:"Mangrove Carnival",carnivalId:"nottinghill",type:"mas",tags:["Traditional","Community"]},{name:"Gemz Mas",carnivalId:"nottinghill",type:"mas",tags:["Sexy","Fun"]},{name:"Caribbean Sessions",carnivalId:"nottinghill",type:"mas",tags:["Party","Inclusive"]},{name:"Colours Carnival",carnivalId:"nottinghill",type:"mas",tags:["Colourful","Fun"]},{name:"Saldenah Carnival",carnivalId:"toronto",type:"mas",website:"https://saldenahcarnival.com",tags:["Legendary","Big Band","Winner"]},{name:"Carnival Nationz",carnivalId:"toronto",type:"mas",website:"https://carnivalnationz.com",tags:["Big Band","Vibes"]},{name:"Toronto Revellers",carnivalId:"toronto",type:"mas",website:"https://torontorevellers.com",tags:["Community","Fun"]},{name:"Tribal Carnival",carnivalId:"toronto",type:"mas",tags:["Culture","Mas"]},{name:"Venom Mas",carnivalId:"toronto",type:"mas",tags:["Sexy","Party"]},{name:"Fantazia",carnivalId:"toronto",type:"mas",tags:["Fun","Service"]},{name:"Krave The Band",carnivalId:"barbados",type:"mas",website:"https://kravetheband.com",tags:["Premium","Luxury"]},{name:"Aura Experience",carnivalId:"barbados",type:"mas",website:"https://auraexperience.com",tags:["Rihanna","Vibes"]},{name:"Zulu International",carnivalId:"barbados",type:"mas",tags:["Fun","Party"]},{name:"Baje International",carnivalId:"barbados",type:"mas",tags:["Legacy","Service"]},{name:"Erup The Band",carnivalId:"barbados",type:"mas",tags:["Energy","Soca"]},{name:"Oro Luxury Carnival",carnivalId:"grenada",type:"mas",tags:["Premium","Luxury"]},{name:"Xtravo",carnivalId:"grenada",type:"mas",tags:["Party","Vibes"]},{name:"Lavish The Band",carnivalId:"grenada",type:"mas",tags:["Service","Costumes"]},{name:"Legends Carnival",carnivalId:"stlucia",type:"mas",tags:["Big Band","Fun"]},{name:"Xuovo",carnivalId:"stlucia",type:"mas",tags:["Vibes","Party"]},{name:"Fuzion Mas",carnivalId:"stlucia",type:"mas",tags:["Premium","Service"]},{name:"Insane Carnival",carnivalId:"antigua",type:"mas",tags:["Fun","Party"]},{name:"Myst Carnival",carnivalId:"antigua",type:"mas",tags:["Sexy","Vibes"]},{name:"Seaduced",carnivalId:"antigua",type:"mas",tags:["Luxury","Premium"]},{name:"Madd Colors Carnival",carnivalId:"atlanta",type:"mas",website:"https://maddcolorscarnival.com/",tags:["Premium","#1 Band"]},{name:"We Kinda Ting",carnivalId:"atlanta",type:"mas",tags:["Fun","Local"]},{name:"Savage Mas",carnivalId:"atlanta",type:"mas",tags:["Sexy","Vibes"]},{name:"Panache",carnivalId:"atlanta",type:"mas",tags:["Service","Costumes"]}];function I3({carnivalId:t}){const[e,n]=B.useState(""),[r,i]=B.useState("all"),o=B.useMemo(()=>b3.filter(u=>{if(t&&u.carnivalId!==t)return!1;const h=e.toLowerCase(),m=u.name.toLowerCase().includes(h)||u.tags.some(v=>v.toLowerCase().includes(h)),y=r==="all"||u.type===r;return m&&y}),[t,e,r]),a=u=>{switch(u){case"trinidad":return"Trinidad";case"jamaica":return"Jamaica";case"miami":return"Miami";case"nottinghill":return"London";case"toronto":return"Toronto";case"barbados":return"Barbados";case"grenada":return"Grenada";case"antigua":return"Antigua";case"stlucia":return"St. Lucia";case"atlanta":return"Atlanta";default:return u}};return c.jsxs("div",{className:"space-y-6 animate-fadeIn",children:[c.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:c.jsxs("div",{className:"flex flex-col md:flex-row gap-4 justify-between items-center",children:[c.jsxs("div",{children:[c.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 text-gray-800 dark:text-white",children:[c.jsx(Nb,{className:"w-5 h-5 text-purple-500"}),"Costume Bands"]}),c.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Find your perfect fit for ",t?a(t):"Carnival"]})]}),c.jsxs("div",{className:"relative w-full md:w-64",children:[c.jsx(iP,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),c.jsx("input",{type:"text",placeholder:"Search bands...",value:e,onChange:u=>n(u.target.value),className:"w-full pl-9 pr-4 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-sm focus:ring-2 focus:ring-purple-500 transition"})]})]})}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o.map((u,h)=>c.jsxs("div",{className:"group bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-5 hover:shadow-lg transition-all duration-300 hover:border-purple-300 dark:hover:border-purple-700",children:[c.jsxs("div",{className:"flex justify-between items-start mb-3",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"font-bold text-lg text-gray-900 dark:text-white group-hover:text-purple-600 dark:group-hover:text-purple-400 transition-colors",children:u.name}),!t&&c.jsxs("span",{className:"text-xs font-medium text-gray-500 flex items-center gap-1 mt-1",children:[c.jsx($l,{className:"w-3 h-3"}),a(u.carnivalId)]})]}),u.website&&c.jsx("a",{href:u.website,target:"_blank",rel:"noopener noreferrer",className:"p-2 bg-gray-50 dark:bg-gray-700 rounded-full hover:bg-purple-100 hover:text-purple-600 dark:hover:bg-purple-900/40 dark:hover:text-purple-400 transition",children:c.jsx(Lm,{className:"w-4 h-4"})})]}),c.jsx("div",{className:"flex flex-wrap gap-2 mt-4",children:u.tags.map((m,y)=>c.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-purple-50 text-purple-600 dark:bg-purple-900/20 dark:text-purple-300 rounded-md",children:m},y))})]},h))}),o.length===0&&c.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[c.jsx(Nb,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),c.jsx("p",{children:"No bands found matching your search."})]})]})}function T3({onGetStarted:t,logo:e,onTryDemo:n}){const[r,i]=B.useState(0),[o,a]=B.useState({x:0,y:0});return B.useEffect(()=>{const u=()=>i(window.scrollY),h=m=>a({x:m.clientX,y:m.clientY});return window.addEventListener("scroll",u),window.addEventListener("mousemove",h),()=>{window.removeEventListener("scroll",u),window.removeEventListener("mousemove",h)}},[]),c.jsxs("div",{className:"min-h-screen bg-black text-white overflow-x-hidden selection:bg-pink-500 selection:text-white font-sans",children:[c.jsxs("div",{className:"fixed inset-0 pointer-events-none z-0",children:[c.jsx("div",{className:"absolute w-[800px] h-[800px] bg-indigo-600/20 rounded-full blur-[120px] mix-blend-screen transition-transform duration-100 ease-out",style:{top:-200,left:-200,transform:`translate(${o.x*.02}px, ${o.y*.02}px)`}}),c.jsx("div",{className:"absolute w-[600px] h-[600px] bg-pink-600/20 rounded-full blur-[100px] mix-blend-screen transition-transform duration-100 ease-out",style:{bottom:-100,right:-100,transform:`translate(${o.x*-.03}px, ${o.y*-.03}px)`}})]}),c.jsx("nav",{className:"fixed top-0 w-full z-50 px-6 py-4 backdrop-blur-md border-b border-white/5 bg-black/50",children:c.jsxs("div",{className:"max-w-7xl mx-auto flex justify-between items-center",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-pink-500 to-indigo-600 flex items-center justify-center font-bold text-sm",children:"CP"}),c.jsx("span",{className:"font-bold tracking-tight text-white/90",children:"Carnival Planner"})]}),c.jsx("button",{onClick:t,className:"px-4 py-2 bg-white/10 hover:bg-white/20 border border-white/10 rounded-full text-sm font-semibold transition-all",children:"Log In"})]})}),c.jsxs("section",{className:"relative z-10 pt-40 pb-20 px-6 max-w-7xl mx-auto flex flex-col items-center text-center",children:[c.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/5 border border-white/10 backdrop-blur-sm mb-8 animate-fadeIn",children:[c.jsxs("span",{className:"relative flex h-2 w-2",children:[c.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"}),c.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-green-500"})]}),c.jsx("span",{className:"text-xs font-medium text-gray-400 tracking-wide uppercase",children:"V2.0 Now Live"})]}),c.jsxs("h1",{className:"text-6xl md:text-8xl font-black tracking-tighter mb-8 bg-clip-text text-transparent bg-gradient-to-b from-white via-white to-gray-500 leading-tight",children:["The Operating System",c.jsx("br",{}),c.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-pink-500 via-purple-500 to-indigo-500",children:"For Carnival."})]}),c.jsx("p",{className:"text-xl text-gray-400 max-w-2xl mb-12 leading-relaxed",children:"The all-in-one workspace for your next carnival. Budget, schedule, squad sync, and ticketing  seamlessly integrated."}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[c.jsxs("button",{onClick:t,className:"group relative px-8 py-4 bg-white text-black rounded-full font-bold text-lg shadow-[0_0_40px_-10px_rgba(255,255,255,0.3)] hover:shadow-[0_0_60px_-10px_rgba(255,255,255,0.5)] transition-all transform hover:scale-105",children:["Start Planning For Free",c.jsx(jh,{className:"inline-block ml-2 w-5 h-5 group-hover:translate-x-1 transition-transform"})]}),c.jsx("button",{onClick:n,className:"px-8 py-4 bg-white/10 hover:bg-white/20 border border-white/10 text-white rounded-full font-bold text-lg backdrop-blur-sm transition-all transform hover:scale-105",children:"Try Live Demo"})]}),c.jsxs("div",{className:"mt-20 relative w-full max-w-5xl aspect-[16/9] bg-gray-900/50 rounded-xl border border-white/10 backdrop-blur-sm overflow-hidden shadow-2xl group",children:[c.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-white/5 to-transparent pointer-events-none"}),c.jsxs("div",{className:"absolute top-4 left-4 right-4 h-4 flex gap-2",children:[c.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500/50"}),c.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-500/50"}),c.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500/50"})]}),c.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:c.jsxs("div",{className:"text-center space-y-4",children:[c.jsx("div",{className:"inline-block p-4 rounded-2xl bg-gradient-to-br from-purple-600 to-pink-600 shadow-xl mb-4 group-hover:scale-110 transition-transform duration-500",children:c.jsx(qv,{className:"w-12 h-12 text-white"})}),c.jsx("div",{className:"text-2xl font-bold text-white/50",children:"Mission Control"})]})})]})]}),c.jsx("div",{className:"w-full bg-white/5 border-y border-white/5 py-4 overflow-hidden relative z-10 backdrop-blur-sm",children:c.jsxs("div",{className:"flex animate-marquee whitespace-nowrap gap-12 text-sm font-medium text-gray-400 uppercase tracking-widest",children:[c.jsx("span",{children:"  350+ Live Squads"}),c.jsx("span",{children:"  Trinidad 2026 Ready"}),c.jsx("span",{children:"  Expense Tracking"}),c.jsx("span",{children:"  Soca Included"}),c.jsx("span",{children:"  Passport Sync Active"}),c.jsx("span",{children:"  Global Carnival Database"}),c.jsx("span",{children:"  350+ Live Squads"}),c.jsx("span",{children:"  Trinidad 2026 Ready"}),c.jsx("span",{children:"  Expense Tracking"}),c.jsx("span",{children:"  Soca Included"}),c.jsx("span",{children:"  Passport Sync Active"}),c.jsx("span",{children:"  Global Carnival Database"})]})}),c.jsxs("section",{className:"relative z-10 py-32 px-6 max-w-7xl mx-auto",children:[c.jsx("div",{className:"mb-16",children:c.jsxs("h2",{className:"text-4xl md:text-5xl font-black mb-6",children:["Everything you need.",c.jsx("br",{}),"Nothing you don't."]})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 auto-rows-[300px]",children:[c.jsxs("div",{className:"md:col-span-2 relative group overflow-hidden rounded-3xl bg-gray-900 border border-white/10 hover:border-white/20 transition-all p-8 flex flex-col justify-between",children:[c.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-20 group-hover:opacity-40 transition-opacity",children:c.jsx(Oi,{className:"w-48 h-48 text-indigo-500 transform rotate-12 translate-x-12 -translate-y-12"})}),c.jsxs("div",{children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-indigo-500/20 flex items-center justify-center mb-4 text-indigo-400",children:c.jsx(Oi,{})}),c.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Squad Sync"}),c.jsx("p",{className:"text-gray-400 max-w-sm",children:"Real-time collaboration. See when your friends add events, update budgets, or get road ready."})]}),c.jsxs("div",{className:"flex -space-x-4 mt-8",children:[[1,2,3,4].map(u=>c.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-800 border-4 border-gray-900 flex items-center justify-center text-xs font-bold text-gray-500 transform transition-transform group-hover:translate-x-2",style:{transitionDelay:`${u*50}ms`},children:"User"},u)),c.jsx("div",{className:"w-12 h-12 rounded-full bg-indigo-600 border-4 border-gray-900 flex items-center justify-center text-xs font-bold text-white z-10",children:"+3"})]})]}),c.jsxs("div",{className:"md:row-span-2 relative group overflow-hidden rounded-3xl bg-gray-900 border border-white/10 hover:border-white/20 transition-all p-8 flex flex-col",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-green-500/20 flex items-center justify-center mb-4 text-green-400",children:c.jsx(dP,{})}),c.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Smart Budget"}),c.jsx("p",{className:"text-gray-400 mb-8",children:"Track every costume payment, fete ticket, and flight."}),c.jsxs("div",{className:"mt-auto space-y-4",children:[c.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 group-hover:bg-gray-750 transition-colors",children:[c.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[c.jsx("span",{children:"Costume Deposit"}),c.jsx("span",{className:"font-mono text-green-400",children:"-$300"})]}),c.jsx("div",{className:"w-full bg-gray-700 h-1.5 rounded-full overflow-hidden",children:c.jsx("div",{className:"bg-green-500 w-3/4 h-full rounded-full"})})]}),c.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 group-hover:bg-gray-750 transition-colors",children:[c.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[c.jsx("span",{children:"Flight (MIA  POS)"}),c.jsx("span",{className:"font-mono text-green-400",children:"-$850"})]}),c.jsx("div",{className:"w-full bg-gray-700 h-1.5 rounded-full overflow-hidden",children:c.jsx("div",{className:"bg-green-500 w-full h-full rounded-full"})})]})]})]}),c.jsxs("div",{className:"relative group overflow-hidden rounded-3xl bg-gray-900 border border-white/10 hover:border-white/20 transition-all p-8",children:[c.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-transparent to-black/80 z-10"}),c.jsx("div",{className:"absolute inset-0 opacity-30 grayscale group-hover:grayscale-0 transition-all duration-700",style:{backgroundImage:"radial-gradient(circle at 2px 2px, rgba(255,255,255,0.15) 1px, transparent 0)",backgroundSize:"24px 24px"}}),c.jsxs("div",{className:"relative z-20 h-full flex flex-col justify-end",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-purple-500/20 flex items-center justify-center mb-4 text-purple-400",children:c.jsx(G5,{})}),c.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Live Map"}),c.jsx("p",{className:"text-gray-400",children:"Discover events near your AirBnb."})]})]}),c.jsxs("div",{className:"col-span-1 md:col-span-2 relative group overflow-hidden rounded-3xl bg-gradient-to-br from-teal-900 to-gray-900 border border-white/10 hover:border-teal-500/30 transition-all p-8 flex items-center justify-between",children:[c.jsxs("div",{className:"max-w-xs",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-teal-500/20 flex items-center justify-center mb-4 text-teal-400",children:c.jsx(Fv,{})}),c.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Soca Passport"}),c.jsx("p",{className:"text-gray-400",children:"Your digital carnival identity. Syncs seamlessly with the Soca Passport app."})]}),c.jsxs("div",{className:"hidden sm:block relative w-64 h-40 bg-white/10 backdrop-blur-md rounded-xl border border-white/20 shadow-2xl transform rotate-3 group-hover:rotate-0 transition-transform duration-500",children:[c.jsx("div",{className:"absolute top-4 left-4 w-8 h-8 rounded-full bg-teal-500"}),c.jsx("div",{className:"absolute top-4 right-4 text-[10px] font-mono opacity-50",children:"9438-2910"}),c.jsx("div",{className:"absolute bottom-4 left-4 text-xs font-bold",children:"FEBUARY 2026"})]})]})]})]}),c.jsxs("section",{className:"relative z-10 py-32 text-center px-6",children:[c.jsx("h2",{className:"text-5xl md:text-7xl font-black mb-8",children:"Ready to jump?"}),c.jsx("button",{onClick:t,className:"px-10 py-5 bg-white text-black rounded-full font-bold text-xl hover:scale-105 transition-transform shadow-2xl",children:"Get Started Now"}),c.jsxs("div",{className:"mt-16 text-sm text-gray-500 flex flex-col md:flex-row items-center justify-center gap-8",children:[c.jsxs("span",{className:"flex items-center gap-2",children:[c.jsx(H5,{className:"w-4 h-4"})," Global Support"]}),c.jsxs("span",{className:"flex items-center gap-2",children:[c.jsx(aP,{className:"w-4 h-4"})," Secure Data"]}),c.jsxs("span",{className:"flex items-center gap-2",children:[c.jsx(jf,{className:"w-4 h-4"})," Vibes Included"]})]})]}),c.jsx("div",{className:"w-full border-t border-white/10 p-8 text-center text-gray-600 text-sm",children:" 2026 Carnival Planner. Built for the culture."})]})}const Vs="Carnival Planner",Fn="support@carnival-planner.com",Dm="December 12, 2025";function E3({onBack:t,logo:e}){return c.jsxs(Mm,{title:"Privacy Policy",icon:aP,onBack:t,logo:e,children:[c.jsxs("p",{className:"text-gray-400 mb-6",children:["Last Updated: ",Dm]}),c.jsx(Fe,{title:"1. Introduction",children:c.jsxs("p",{children:[Vs,' ("we," "our," or "us") is committed to protecting your privacy. This Privacy Policy explains how we collect, use, disclose, and safeguard your information when you use our mobile application and website (collectively, the "Service").']})}),c.jsxs(Fe,{title:"2. Information We Collect",children:[c.jsx("h4",{className:"font-semibold text-white mb-2",children:"2.1 Personal Information"}),c.jsx("p",{className:"mb-4",children:"When you sign in with Google, we collect:"}),c.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[c.jsx("li",{children:"Email address"}),c.jsx("li",{children:"Display name"}),c.jsx("li",{children:"Profile picture URL"}),c.jsx("li",{children:"Google account unique identifier"})]}),c.jsx("h4",{className:"font-semibold text-white mb-2",children:"2.2 User-Generated Content"}),c.jsx("p",{className:"mb-4",children:"Information you voluntarily provide includes:"}),c.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[c.jsx("li",{children:"Carnival planning data (budgets, schedules, packing lists)"}),c.jsx("li",{children:"Costume and band information"}),c.jsx("li",{children:"Squad member names and coordination data"}),c.jsx("li",{children:"Uploaded media files (tickets, photos, documents)"}),c.jsx("li",{children:"Map pins and location notes"})]}),c.jsx("h4",{className:"font-semibold text-white mb-2",children:"2.3 Payment Information"}),c.jsx("p",{children:"For premium subscriptions, payment processing is handled securely by Stripe. We do not store your credit card numbers. We receive only transaction confirmation, subscription status, and billing email from Stripe."})]}),c.jsx(Fe,{title:"3. How We Use Your Information",children:c.jsxs("ul",{className:"list-disc list-inside space-y-2",children:[c.jsx("li",{children:"To provide and maintain the Service"}),c.jsx("li",{children:"To authenticate your identity via Google Sign-In"}),c.jsx("li",{children:"To process premium subscription payments via Stripe"}),c.jsx("li",{children:"To sync your carnival planning data across devices"}),c.jsx("li",{children:"To send push notifications for squad alerts (if enabled)"}),c.jsx("li",{children:"To improve and optimize our Service"}),c.jsx("li",{children:"To respond to your inquiries and support requests"})]})}),c.jsxs(Fe,{title:"4. Data Storage and Security",children:[c.jsx("p",{className:"mb-4",children:"Your data is stored using Firebase services provided by Google:"}),c.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Firebase Authentication:"})," Manages secure sign-in"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Cloud Firestore:"})," Stores your planning data"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Firebase Storage:"})," Stores uploaded media files"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Firebase Cloud Messaging:"})," Delivers push notifications"]})]}),c.jsx("p",{children:"We implement industry-standard security measures including encryption in transit (TLS) and at rest. Firebase services are SOC 2 and ISO 27001 certified."})]}),c.jsxs(Fe,{title:"5. Third-Party Services",children:[c.jsx("p",{className:"mb-4",children:"We use the following third-party services:"}),c.jsxs("ul",{className:"list-disc list-inside space-y-2",children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Google (Firebase):"})," Authentication, database, storage, and hosting. ",c.jsx("a",{href:"https://firebase.google.com/support/privacy",className:"text-pink-400 hover:underline",target:"_blank",rel:"noopener noreferrer",children:"Firebase Privacy Policy"})]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Stripe:"})," Payment processing. ",c.jsx("a",{href:"https://stripe.com/privacy",className:"text-pink-400 hover:underline",target:"_blank",rel:"noopener noreferrer",children:"Stripe Privacy Policy"})]}),c.jsxs("li",{children:[c.jsx("strong",{children:"OpenStreetMap:"})," Map tiles for the Fete Map feature. ",c.jsx("a",{href:"https://wiki.osmfoundation.org/wiki/Privacy_Policy",className:"text-pink-400 hover:underline",target:"_blank",rel:"noopener noreferrer",children:"OSM Privacy Policy"})]})]})]}),c.jsxs(Fe,{title:"6. Your Rights (GDPR/CCPA)",children:[c.jsx("p",{className:"mb-4",children:"Depending on your location, you may have the following rights:"}),c.jsxs("ul",{className:"list-disc list-inside space-y-2",children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Access:"})," Request a copy of your personal data"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Rectification:"})," Correct inaccurate personal data"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Erasure:"})," Request deletion of your personal data"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Portability:"})," Receive your data in a portable format"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Opt-out:"})," Opt out of certain data processing"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Non-discrimination:"})," We will not discriminate against you for exercising your rights"]})]}),c.jsxs("p",{className:"mt-4",children:["To exercise these rights, contact us at ",c.jsx("a",{href:`mailto:${Fn}`,className:"text-pink-400 hover:underline",children:Fn}),"."]})]}),c.jsx(Fe,{title:"7. Data Retention",children:c.jsx("p",{children:"We retain your personal data for as long as your account is active. If you delete your account, we will delete your data within 30 days, except where we are legally required to retain it."})}),c.jsx(Fe,{title:"8. Children's Privacy",children:c.jsx("p",{children:"Our Service is not intended for children under 13. We do not knowingly collect personal information from children under 13. If you believe we have collected such information, please contact us immediately."})}),c.jsx(Fe,{title:"9. Changes to This Policy",children:c.jsx("p",{children:'We may update this Privacy Policy from time to time. We will notify you of any changes by posting the new Privacy Policy on this page and updating the "Last Updated" date.'})}),c.jsxs(Fe,{title:"10. Contact Us",children:[c.jsx("p",{children:"If you have questions about this Privacy Policy, please contact us at:"}),c.jsx("p",{className:"mt-2",children:c.jsx("a",{href:`mailto:${Fn}`,className:"text-pink-400 hover:underline",children:Fn})})]})]})}function k3({onBack:t,logo:e}){return c.jsxs(Mm,{title:"Terms of Service",icon:$5,onBack:t,logo:e,children:[c.jsxs("p",{className:"text-gray-400 mb-6",children:["Last Updated: ",Dm]}),c.jsx(Fe,{title:"1. Acceptance of Terms",children:c.jsxs("p",{children:["By accessing or using ",Vs,' ("the Service"), you agree to be bound by these Terms of Service. If you do not agree to these terms, please do not use the Service.']})}),c.jsx(Fe,{title:"2. Description of Service",children:c.jsxs("p",{children:[Vs," is a Progressive Web App that helps users plan and organize Caribbean carnival events. The Service includes free features (budget planning, scheduling, squad coordination) and premium subscription features (interactive maps, media vault, offline mode)."]})}),c.jsxs(Fe,{title:"3. User Accounts",children:[c.jsx("h4",{className:"font-semibold text-white mb-2",children:"3.1 Registration"}),c.jsx("p",{className:"mb-4",children:"You must sign in with a valid Google account to use the Service. You are responsible for maintaining the security of your account."}),c.jsx("h4",{className:"font-semibold text-white mb-2",children:"3.2 Account Responsibilities"}),c.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[c.jsx("li",{children:"You must provide accurate information"}),c.jsx("li",{children:"You are responsible for all activities under your account"}),c.jsx("li",{children:"You must notify us immediately of any unauthorized use"})]})]}),c.jsxs(Fe,{title:"4. Premium Subscriptions",children:[c.jsx("h4",{className:"font-semibold text-white mb-2",children:"4.1 Subscription Plans"}),c.jsx("p",{className:"mb-4",children:"We offer monthly ($4.99/month) and yearly ($39.99/year) subscription plans. Prices are subject to change with reasonable notice."}),c.jsx("h4",{className:"font-semibold text-white mb-2",children:"4.2 Billing"}),c.jsx("p",{className:"mb-4",children:"Subscriptions are billed in advance on a recurring basis. Payment is processed through Stripe. Your subscription will automatically renew unless you cancel before the renewal date."}),c.jsx("h4",{className:"font-semibold text-white mb-2",children:"4.3 Cancellation"}),c.jsx("p",{children:"You may cancel your subscription at any time. You will continue to have access to premium features until the end of your current billing period. See our Refund Policy for details."})]}),c.jsxs(Fe,{title:"5. User Content",children:[c.jsx("h4",{className:"font-semibold text-white mb-2",children:"5.1 Your Content"}),c.jsx("p",{className:"mb-4",children:"You retain ownership of all content you upload to the Service (schedules, media, notes). By uploading content, you grant us a limited license to store, display, and process it to provide the Service."}),c.jsx("h4",{className:"font-semibold text-white mb-2",children:"5.2 Content Restrictions"}),c.jsx("p",{className:"mb-2",children:"You agree not to upload content that:"}),c.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[c.jsx("li",{children:"Is illegal, harmful, or offensive"}),c.jsx("li",{children:"Infringes on intellectual property rights"}),c.jsx("li",{children:"Contains malware or malicious code"}),c.jsx("li",{children:"Violates others' privacy"})]})]}),c.jsxs(Fe,{title:"6. Acceptable Use",children:[c.jsx("p",{className:"mb-2",children:"You agree not to:"}),c.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[c.jsx("li",{children:"Use the Service for any unlawful purpose"}),c.jsx("li",{children:"Attempt to gain unauthorized access to our systems"}),c.jsx("li",{children:"Interfere with or disrupt the Service"}),c.jsx("li",{children:"Reverse engineer or decompile the Service"}),c.jsx("li",{children:"Use automated systems to access the Service without permission"})]})]}),c.jsx(Fe,{title:"7. Intellectual Property",children:c.jsxs("p",{children:["The Service, including its design, features, and content (excluding user content), is owned by ",Vs," and protected by intellectual property laws. You may not copy, modify, or distribute our intellectual property without permission."]})}),c.jsx(Fe,{title:"8. Disclaimer of Warranties",children:c.jsx("p",{children:'THE SERVICE IS PROVIDED "AS IS" WITHOUT WARRANTIES OF ANY KIND, EXPRESS OR IMPLIED. WE DO NOT GUARANTEE THAT THE SERVICE WILL BE UNINTERRUPTED, ERROR-FREE, OR SECURE. YOUR USE OF THE SERVICE IS AT YOUR OWN RISK.'})}),c.jsx(Fe,{title:"9. Limitation of Liability",children:c.jsxs("p",{children:["TO THE MAXIMUM EXTENT PERMITTED BY LAW, ",Vs.toUpperCase()," SHALL NOT BE LIABLE FOR ANY INDIRECT, INCIDENTAL, SPECIAL, CONSEQUENTIAL, OR PUNITIVE DAMAGES ARISING FROM YOUR USE OF THE SERVICE, EVEN IF WE HAVE BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES."]})}),c.jsx(Fe,{title:"10. Termination",children:c.jsx("p",{children:"We may terminate or suspend your account at any time for violation of these Terms. You may delete your account at any time. Upon termination, your right to use the Service will immediately cease."})}),c.jsx(Fe,{title:"11. Governing Law",children:c.jsxs("p",{children:["These Terms shall be governed by the laws of the jurisdiction in which ",Vs," operates, without regard to conflict of law principles."]})}),c.jsx(Fe,{title:"12. Changes to Terms",children:c.jsx("p",{children:"We may modify these Terms at any time. We will notify you of significant changes via email or in-app notification. Continued use of the Service after changes constitutes acceptance of the new Terms."})}),c.jsx(Fe,{title:"13. Contact",children:c.jsxs("p",{children:["For questions about these Terms, contact us at ",c.jsx("a",{href:`mailto:${Fn}`,className:"text-pink-400 hover:underline",children:Fn}),"."]})})]})}function S3({onBack:t,logo:e}){return c.jsxs(Mm,{title:"Cookie Policy",icon:z5,onBack:t,logo:e,children:[c.jsxs("p",{className:"text-gray-400 mb-6",children:["Last Updated: ",Dm]}),c.jsx(Fe,{title:"1. What Are Cookies",children:c.jsx("p",{children:"Cookies are small text files stored on your device when you visit a website. They help websites remember your preferences and improve your experience."})}),c.jsxs(Fe,{title:"2. How We Use Cookies",children:[c.jsxs("p",{className:"mb-4",children:[Vs," uses cookies and similar technologies for the following purposes:"]}),c.jsx("h4",{className:"font-semibold text-white mb-2",children:"2.1 Essential Cookies (Required)"}),c.jsx("p",{className:"mb-4",children:"These cookies are necessary for the Service to function and cannot be disabled:"}),c.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Firebase Authentication:"})," Maintains your signed-in session securely"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Session Management:"})," Remembers your authentication state"]})]}),c.jsx("h4",{className:"font-semibold text-white mb-2",children:"2.2 Functional Cookies"}),c.jsx("p",{className:"mb-4",children:"These cookies enhance your experience:"}),c.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Preferences:"})," Remembers your dark mode setting"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Local Storage:"})," Caches carnival data for offline access (Premium feature)"]})]}),c.jsx("h4",{className:"font-semibold text-white mb-2",children:"2.3 Third-Party Cookies"}),c.jsx("p",{className:"mb-2",children:"Our third-party services may set their own cookies:"}),c.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Firebase/Google:"})," Authentication and analytics"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Stripe:"})," Payment processing security"]})]})]}),c.jsx(Fe,{title:"3. Cookie Details",children:c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full text-left text-sm mb-4",children:[c.jsx("thead",{children:c.jsxs("tr",{className:"border-b border-gray-700",children:[c.jsx("th",{className:"py-2 pr-4",children:"Cookie Name"}),c.jsx("th",{className:"py-2 pr-4",children:"Purpose"}),c.jsx("th",{className:"py-2 pr-4",children:"Duration"}),c.jsx("th",{className:"py-2",children:"Type"})]})}),c.jsxs("tbody",{className:"text-gray-400",children:[c.jsxs("tr",{className:"border-b border-gray-800",children:[c.jsx("td",{className:"py-2 pr-4",children:"firebase-auth"}),c.jsx("td",{className:"py-2 pr-4",children:"User authentication"}),c.jsx("td",{className:"py-2 pr-4",children:"Session"}),c.jsx("td",{className:"py-2",children:"Essential"})]}),c.jsxs("tr",{className:"border-b border-gray-800",children:[c.jsx("td",{className:"py-2 pr-4",children:"__stripe_mid"}),c.jsx("td",{className:"py-2 pr-4",children:"Fraud prevention"}),c.jsx("td",{className:"py-2 pr-4",children:"1 year"}),c.jsx("td",{className:"py-2",children:"Essential"})]}),c.jsxs("tr",{className:"border-b border-gray-800",children:[c.jsx("td",{className:"py-2 pr-4",children:"darkMode"}),c.jsx("td",{className:"py-2 pr-4",children:"Theme preference"}),c.jsx("td",{className:"py-2 pr-4",children:"Persistent"}),c.jsx("td",{className:"py-2",children:"Functional"})]})]})]})})}),c.jsxs(Fe,{title:"4. Local Storage",children:[c.jsx("p",{className:"mb-4",children:"In addition to cookies, we use browser local storage for:"}),c.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[c.jsx("li",{children:"Caching carnival data for offline access (Premium)"}),c.jsx("li",{children:"Storing FCM tokens for push notifications"}),c.jsx("li",{children:"Temporary UI state"})]})]}),c.jsxs(Fe,{title:"5. Managing Cookies",children:[c.jsx("p",{className:"mb-4",children:"You can manage cookies through your browser settings:"}),c.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Chrome:"})," Settings  Privacy and security  Cookies"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Firefox:"})," Settings  Privacy & Security  Cookies"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Safari:"})," Preferences  Privacy  Cookies"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Edge:"})," Settings  Cookies and site permissions"]})]}),c.jsx("p",{className:"mt-4 text-yellow-400",children:"Note: Disabling essential cookies may prevent you from using the Service."})]}),c.jsx(Fe,{title:"6. Updates to This Policy",children:c.jsx("p",{children:"We may update this Cookie Policy to reflect changes in our practices or for legal reasons. Check this page periodically for updates."})}),c.jsx(Fe,{title:"7. Contact",children:c.jsxs("p",{children:["For questions about our use of cookies, contact us at ",c.jsx("a",{href:`mailto:${Fn}`,className:"text-pink-400 hover:underline",children:Fn}),"."]})})]})}function P3({onBack:t,logo:e}){return c.jsxs(Mm,{title:"Refund Policy",icon:Fv,onBack:t,logo:e,children:[c.jsxs("p",{className:"text-gray-400 mb-6",children:["Last Updated: ",Dm]}),c.jsx(Fe,{title:"1. Premium Subscription",children:c.jsxs("p",{children:[Vs," offers premium subscriptions at $4.99/month or $39.99/year. This policy explains our refund terms for these subscriptions."]})}),c.jsxs(Fe,{title:"2. Subscription Cancellation",children:[c.jsx("h4",{className:"font-semibold text-white mb-2",children:"2.1 How to Cancel"}),c.jsx("p",{className:"mb-4",children:"You can cancel your subscription at any time by:"}),c.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[c.jsxs("li",{children:["Contacting us at ",c.jsx("a",{href:`mailto:${Fn}`,className:"text-pink-400 hover:underline",children:Fn})]}),c.jsx("li",{children:"Managing your subscription through Stripe's customer portal (link provided in your confirmation email)"})]}),c.jsx("h4",{className:"font-semibold text-white mb-2",children:"2.2 Effect of Cancellation"}),c.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[c.jsx("li",{children:"Your premium access continues until the end of your current billing period"}),c.jsx("li",{children:"You will not be charged again after cancellation"}),c.jsx("li",{children:"No partial refunds are provided for unused time in the current billing period"})]})]}),c.jsxs(Fe,{title:"3. Refund Eligibility",children:[c.jsx("h4",{className:"font-semibold text-white mb-2",children:"3.1 Eligible for Refund"}),c.jsx("p",{className:"mb-2",children:"We offer refunds in the following situations:"}),c.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Technical Issues:"})," If the Service was unavailable or significantly impaired for an extended period"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Accidental Purchase:"})," If you accidentally subscribed and request a refund within 48 hours, without using premium features"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Duplicate Charges:"})," If you were charged multiple times for the same subscription period"]})]}),c.jsx("h4",{className:"font-semibold text-white mb-2",children:"3.2 Not Eligible for Refund"}),c.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[c.jsx("li",{children:"Change of mind after using premium features"}),c.jsx("li",{children:"Requests made after 30 days from the charge date"}),c.jsx("li",{children:"Failure to cancel before renewal (you must cancel before renewal to avoid charges)"}),c.jsx("li",{children:"Issues caused by your device, browser, or internet connection"})]})]}),c.jsxs(Fe,{title:"4. How to Request a Refund",children:[c.jsx("p",{className:"mb-4",children:"To request a refund:"}),c.jsxs("ol",{className:"list-decimal list-inside space-y-2",children:[c.jsxs("li",{children:["Email us at ",c.jsx("a",{href:`mailto:${Fn}`,className:"text-pink-400 hover:underline",children:Fn})]}),c.jsx("li",{children:"Include your account email and the date of the charge"}),c.jsx("li",{children:"Explain the reason for your refund request"})]}),c.jsx("p",{className:"mt-4",children:"We will review your request and respond within 5 business days."})]}),c.jsxs(Fe,{title:"5. Refund Processing",children:[c.jsx("p",{className:"mb-4",children:"If your refund is approved:"}),c.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[c.jsx("li",{children:"Refunds are processed through Stripe to your original payment method"}),c.jsx("li",{children:"Allow 5-10 business days for the refund to appear on your statement"}),c.jsx("li",{children:"Your premium access will be revoked upon refund"})]})]}),c.jsx(Fe,{title:"6. Free Trial",children:c.jsx("p",{children:"We do not currently offer free trials. All core features are free to use. Premium features require a paid subscription."})}),c.jsx(Fe,{title:"7. Price Changes",children:c.jsx("p",{children:"If we increase subscription prices, existing subscribers will be notified at least 30 days in advance. You may cancel before the new price takes effect to avoid being charged at the higher rate."})}),c.jsx(Fe,{title:"8. Contact",children:c.jsxs("p",{children:["For refund requests or questions about this policy, contact us at ",c.jsx("a",{href:`mailto:${Fn}`,className:"text-pink-400 hover:underline",children:Fn}),"."]})})]})}function Mm({title:t,icon:e,onBack:n,logo:r,children:i}){return c.jsxs("div",{className:"min-h-screen bg-slate-950 text-white",children:[c.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[c.jsx("div",{className:"absolute w-[600px] h-[600px] bg-gradient-to-r from-pink-500/20 to-purple-500/20 rounded-full blur-3xl -top-48 -right-48"}),c.jsx("div",{className:"absolute w-[400px] h-[400px] bg-gradient-to-r from-blue-500/15 to-cyan-500/15 rounded-full blur-3xl bottom-0 left-0"})]}),c.jsxs("div",{className:"relative max-w-4xl mx-auto px-6 py-12",children:[c.jsxs("button",{onClick:n,className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors mb-8",children:[c.jsx(Vv,{className:"w-5 h-5"}),"Back"]}),c.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[r&&c.jsx("img",{src:r,alt:"Logo",className:"w-12 h-12 rounded-xl"}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-pink-500/30 to-purple-500/30 rounded-xl flex items-center justify-center",children:c.jsx(e,{className:"w-6 h-6 text-pink-400"})}),c.jsx("h1",{className:"text-3xl md:text-4xl font-bold",children:t})]})]}),c.jsx("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 rounded-2xl p-6 md:p-8",children:i}),c.jsx("footer",{className:"mt-12 text-center text-gray-500 text-sm",children:c.jsx("p",{children:"Carnival Planner - Plan your Mas. Track your Fetes. Coordinate your Squad."})})]})]})}function Fe({title:t,children:e}){return c.jsxs("div",{className:"mb-8",children:[c.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:t}),c.jsx("div",{className:"text-gray-300 leading-relaxed",children:e})]})}function N3(){const[t,e]=B.useState(null),[n,r]=B.useState(!1),[i,o]=B.useState(!1),[a,u]=B.useState(!1);B.useEffect(()=>{if(window.matchMedia("(display-mode: standalone)").matches){o(!0);return}const y=localStorage.getItem("pwa-install-dismissed");y&&(Date.now()-parseInt(y))/864e5<7&&u(!0);const v=S=>{S.preventDefault(),e(S),a||r(!0)},w=()=>{o(!0),r(!1),e(null)};return window.addEventListener("beforeinstallprompt",v),window.addEventListener("appinstalled",w),()=>{window.removeEventListener("beforeinstallprompt",v),window.removeEventListener("appinstalled",w)}},[a]);const h=async()=>{if(!t)return;t.prompt();const{outcome:y}=await t.userChoice;y==="accepted"&&o(!0),e(null),r(!1)},m=()=>{r(!1),u(!0),localStorage.setItem("pwa-install-dismissed",Date.now().toString())};return!n||i?null:c.jsx("div",{className:"fixed bottom-20 left-4 right-4 z-40 animate-slideUp md:left-auto md:right-4 md:max-w-sm safe-bottom",children:c.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 rounded-2xl shadow-2xl p-4 text-white",children:[c.jsx("button",{onClick:m,className:"absolute top-2 right-2 p-1 hover:bg-white/20 rounded-full transition-colors",children:c.jsx(fa,{className:"w-5 h-5"})}),c.jsxs("div",{className:"flex items-start gap-4",children:[c.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center flex-shrink-0",children:c.jsx(r3,{className:"w-6 h-6"})}),c.jsxs("div",{className:"flex-1 pr-6",children:[c.jsx("h3",{className:"font-bold text-lg mb-1",children:"Add to Home Screen"}),c.jsx("p",{className:"text-white/80 text-sm mb-3",children:"Install Carnival Planner for quick access and offline use!"}),c.jsxs("button",{onClick:h,className:"flex items-center gap-2 px-4 py-2 bg-white text-purple-600 font-bold rounded-lg hover:bg-gray-100 transition-colors",children:[c.jsx(jm,{className:"w-4 h-4"}),"Install App"]})]})]})]})})}function A3({onBack:t,logo:e,user:n}){const[r,i]=B.useState(""),[o,a]=B.useState(""),[u,h]=B.useState((n==null?void 0:n.email)||""),[m,y]=B.useState(!1),[v,w]=B.useState(!1),[S,N]=B.useState(""),P=async F=>{if(F.preventDefault(),!o.trim()||!u.trim()){N("Please fill in all required fields");return}y(!0),N("");try{await ud(En(Ue,"support-requests"),{email:u.trim(),subject:r.trim()||"General Inquiry",message:o.trim(),userId:(n==null?void 0:n.uid)||null,userName:(n==null?void 0:n.displayName)||null,status:"new",createdAt:Ze.now()}),w(!0),i(""),a("")}catch(R){console.error("Error submitting support request:",R),N("Failed to send message. Please try again.")}finally{y(!1)}};return v?c.jsx("div",{className:"min-h-screen bg-slate-950 text-white flex items-center justify-center p-6",children:c.jsxs("div",{className:"text-center max-w-md",children:[c.jsx("div",{className:"w-20 h-20 bg-green-500/20 rounded-full flex items-center justify-center mx-auto mb-6",children:c.jsx(V5,{className:"w-10 h-10 text-green-400"})}),c.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Message Sent!"}),c.jsx("p",{className:"text-gray-400 mb-8",children:"Thank you for reaching out. We'll get back to you as soon as possible."}),c.jsx("button",{onClick:t,className:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-500 rounded-xl font-bold hover:opacity-90 transition-opacity",children:"Back to App"})]})}):c.jsxs("div",{className:"min-h-screen bg-slate-950 text-white",children:[c.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[c.jsx("div",{className:"absolute w-[600px] h-[600px] bg-gradient-to-r from-pink-500/20 to-purple-500/20 rounded-full blur-3xl -top-48 -right-48"}),c.jsx("div",{className:"absolute w-[400px] h-[400px] bg-gradient-to-r from-blue-500/15 to-cyan-500/15 rounded-full blur-3xl bottom-0 left-0"})]}),c.jsxs("div",{className:"relative max-w-2xl mx-auto px-6 py-12",children:[c.jsxs("button",{onClick:t,className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors mb-8",children:[c.jsx(Vv,{className:"w-5 h-5"}),"Back"]}),c.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e&&c.jsx("img",{src:e,alt:"Logo",className:"w-12 h-12 rounded-xl"}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-pink-500/30 to-purple-500/30 rounded-xl flex items-center justify-center",children:c.jsx(nP,{className:"w-6 h-6 text-pink-400"})}),c.jsx("h1",{className:"text-3xl md:text-4xl font-bold",children:"Contact Support"})]})]}),c.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 rounded-2xl p-6 md:p-8",children:[c.jsx("p",{className:"text-gray-400 mb-6",children:"Have a question, feedback, or need help? Send us a message and we'll get back to you as soon as possible."}),c.jsxs("form",{onSubmit:P,className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email Address *"}),c.jsxs("div",{className:"relative",children:[c.jsx(Bv,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),c.jsx("input",{type:"email",value:u,onChange:F=>h(F.target.value),placeholder:"your@email.com",required:!0,className:"w-full pl-10 pr-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:border-pink-500 transition-colors"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Subject"}),c.jsxs("select",{value:r,onChange:F=>i(F.target.value),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white focus:outline-none focus:border-pink-500 transition-colors",children:[c.jsx("option",{value:"",className:"bg-gray-900",children:"Select a topic..."}),c.jsx("option",{value:"General Question",className:"bg-gray-900",children:"General Question"}),c.jsx("option",{value:"Premium Subscription",className:"bg-gray-900",children:"Premium Subscription"}),c.jsx("option",{value:"Technical Issue",className:"bg-gray-900",children:"Technical Issue"}),c.jsx("option",{value:"Feature Request",className:"bg-gray-900",children:"Feature Request"}),c.jsx("option",{value:"Refund Request",className:"bg-gray-900",children:"Refund Request"}),c.jsx("option",{value:"Account Issue",className:"bg-gray-900",children:"Account Issue"}),c.jsx("option",{value:"Other",className:"bg-gray-900",children:"Other"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Message *"}),c.jsx("textarea",{value:o,onChange:F=>a(F.target.value),placeholder:"How can we help you?",required:!0,rows:6,className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:border-pink-500 transition-colors resize-none"})]}),S&&c.jsx("p",{className:"text-red-400 text-sm",children:S}),c.jsx("button",{type:"submit",disabled:m,className:"w-full flex items-center justify-center gap-2 px-6 py-4 bg-gradient-to-r from-pink-500 to-purple-500 rounded-xl font-bold text-lg hover:opacity-90 transition-opacity disabled:opacity-50",children:m?c.jsxs(c.Fragment,{children:[c.jsx(Gr,{className:"w-5 h-5 animate-spin"}),"Sending..."]}):c.jsxs(c.Fragment,{children:[c.jsx(sP,{className:"w-5 h-5"}),"Send Message"]})})]})]}),c.jsxs("p",{className:"text-gray-500 text-sm text-center mt-8",children:["You can also email us directly at"," ",c.jsx("a",{href:"mailto:support@carnival-planner.com",className:"text-pink-400 hover:underline",children:"support@carnival-planner.com"})]})]})]})}function C3(){const[t,e]=B.useState([]),[n,r]=B.useState(!0);B.useEffect(()=>{const o=Tm(En(Ue,"support-requests"),hv("createdAt","desc")),a=$i(o,u=>{const h=u.docs.map(m=>({id:m.id,...m.data()}));e(h),r(!1)});return()=>a()},[]);const i=async o=>{confirm("Delete this support request?")&&await gv(ut(Ue,"support-requests",o))};return n?c.jsx("div",{className:"text-center py-8 text-gray-500",children:c.jsx(Gr,{className:"w-6 h-6 animate-spin mx-auto"})}):c.jsxs("div",{className:"mt-6 border-t border-gray-200 dark:border-gray-700 pt-6",children:[c.jsxs("h3",{className:"font-bold text-lg mb-4 text-gray-800 dark:text-white flex items-center gap-2",children:[c.jsx(nP,{className:"w-5 h-5"}),"Support Requests (",t.length,")"]}),t.length===0?c.jsx("p",{className:"text-gray-500 text-center py-4",children:"No support requests yet"}):c.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:t.map(o=>{var a,u;return c.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700",children:[c.jsxs("div",{className:"flex justify-between items-start mb-2",children:[c.jsxs("div",{children:[c.jsx("span",{className:"font-medium text-gray-800 dark:text-white",children:o.email}),c.jsx("span",{className:"mx-2 text-gray-400",children:"|"}),c.jsx("span",{className:"text-sm text-gray-500",children:o.subject||"General"})]}),c.jsx("button",{onClick:()=>i(o.id),className:"p-1 text-gray-400 hover:text-red-500 transition-colors",children:c.jsx(rs,{className:"w-4 h-4"})})]}),c.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm whitespace-pre-wrap",children:o.message}),c.jsx("p",{className:"text-xs text-gray-400 mt-2",children:((u=(a=o.createdAt)==null?void 0:a.toDate)==null?void 0:u.call(a).toLocaleString())||"Unknown date"})]},o.id)})})]})}function R3({user:t,onClose:e}){const[n,r]=B.useState(!1),[i,o]=B.useState(""),[a,u]=B.useState(!1),[h,m]=B.useState(""),[y,v]=B.useState({displayName:"",bio:"",avatarUrl:""}),[w,S]=B.useState(!1),[N,P]=B.useState(!1),[F,R]=B.useState(!1),[k,A]=B.useState(""),z=B.useRef(null);B.useEffect(()=>{if(!t)return;(async()=>{try{const C=ut(Ue,"users",t.uid,"profile","info"),D=await Mo(C);if(D.exists()){const V=D.data();v({displayName:V.displayName||t.displayName||"",bio:V.bio||"",avatarUrl:V.avatarUrl||t.photoURL||""})}else v({displayName:t.displayName||"",bio:"",avatarUrl:t.photoURL||""})}catch(C){console.log("Could not load profile:",C)}})()},[t]);const G=async()=>{if(t){P(!0),m("");try{const b=ut(Ue,"users",t.uid,"profile","info");await qr(b,{displayName:y.displayName,bio:y.bio,avatarUrl:y.avatarUrl,updatedAt:Ze.now()},{merge:!0}),S(!1),A("Profile saved!"),setTimeout(()=>A(""),3e3)}catch(b){console.error("Error saving profile:",b),m("Could not save profile. Please try again.")}finally{P(!1)}}},W=async b=>{const C=b.target.files[0];if(!C||!t)return;if(C.size>2*1024*1024){m("Image too large. Max 2MB.");return}if(!["image/jpeg","image/png","image/gif","image/webp"].includes(C.type)){m("Please upload a JPG, PNG, GIF, or WebP image.");return}R(!0),m("");try{const V=Date.now(),U=C.name.split(".").pop(),M=`avatars/${t.uid}/${V}.${U}`,le=zl(ql,M);await Nm(le,C);const Ee=await Am(le);v(Re=>({...Re,avatarUrl:Ee}));const Ce=ut(Ue,"users",t.uid,"profile","info");await qr(Ce,{avatarUrl:Ee,updatedAt:Ze.now()},{merge:!0}),A("Avatar updated!"),setTimeout(()=>A(""),3e3)}catch(V){console.error("Avatar upload error:",V),m("Could not upload avatar. Please try again.")}finally{R(!1),z.current&&(z.current.value="")}},T=async()=>{if(i!=="DELETE"){m("Please type DELETE to confirm");return}u(!0),m("");try{const b=ci(On);await ui(b,"deleteUserAccount")(),await DE(zs),window.location.reload()}catch(b){console.error("Error deleting account:",b),m(b.message||"Failed to delete account. Please try again."),u(!1)}};return c.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 border border-gray-200 dark:border-gray-700",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsx("h3",{className:"text-lg font-bold text-gray-800 dark:text-white",children:"Account Settings"}),e&&c.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:c.jsx(fa,{className:"w-5 h-5"})})]}),k&&c.jsx("div",{className:"mb-4 p-3 bg-green-100 dark:bg-green-900/30 border border-green-200 dark:border-green-800 rounded-lg text-green-700 dark:text-green-400 text-sm",children:k}),h&&c.jsx("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg text-red-700 dark:text-red-400 text-sm",children:h}),c.jsxs("div",{className:"space-y-6",children:[c.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-xl p-5",children:c.jsxs("div",{className:"flex items-start gap-4",children:[c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"w-20 h-20 rounded-full overflow-hidden bg-gray-200 dark:bg-gray-600 flex items-center justify-center",children:y.avatarUrl?c.jsx("img",{src:y.avatarUrl,alt:"Avatar",className:"w-full h-full object-cover"}):c.jsx(uP,{className:"w-10 h-10 text-gray-400"})}),c.jsx("input",{ref:z,type:"file",accept:"image/*",onChange:W,className:"hidden",id:"avatar-upload"}),c.jsx("label",{htmlFor:"avatar-upload",className:"absolute -bottom-1 -right-1 p-1.5 bg-blue-600 rounded-full text-white cursor-pointer hover:bg-blue-700 transition",children:F?c.jsx(Gr,{className:"w-4 h-4 animate-spin"}):c.jsx(eP,{className:"w-4 h-4"})})]}),c.jsx("div",{className:"flex-1",children:w?c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Display Name"}),c.jsx("input",{type:"text",value:y.displayName,onChange:b=>v(C=>({...C,displayName:b.target.value})),placeholder:"Your name",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",maxLength:50})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Bio"}),c.jsx("textarea",{value:y.bio,onChange:b=>v(C=>({...C,bio:b.target.value})),placeholder:"Tell us about yourself...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm resize-none",rows:3,maxLength:200}),c.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[y.bio.length,"/200"]})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsxs("button",{onClick:G,disabled:N,className:"flex items-center gap-1.5 px-3 py-1.5 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[N?c.jsx(Gr,{className:"w-4 h-4 animate-spin"}):c.jsx(e3,{className:"w-4 h-4"}),"Save"]}),c.jsx("button",{onClick:()=>S(!1),className:"px-3 py-1.5 bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300 text-sm rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500",children:"Cancel"})]})]}):c.jsxs("div",{children:[c.jsx("h4",{className:"font-bold text-gray-800 dark:text-white mb-1",children:y.displayName||"No name set"}),c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:t==null?void 0:t.email}),y.bio&&c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-3",children:y.bio}),c.jsxs("button",{onClick:()=>S(!0),className:"flex items-center gap-1.5 px-3 py-1.5 bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 text-sm rounded-lg hover:bg-blue-200 dark:hover:bg-blue-900/50 transition",children:[c.jsx(J5,{className:"w-4 h-4"}),"Edit Profile"]})]})})]})}),c.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-6",children:[c.jsxs("h4",{className:"text-red-600 dark:text-red-400 font-bold mb-2 flex items-center gap-2",children:[c.jsx(X1,{className:"w-5 h-5"}),"Danger Zone"]}),c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:"Permanently delete your account and all associated data. This action cannot be undone."}),n?c.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-4",children:[c.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mb-3",children:"This will permanently delete:"}),c.jsxs("ul",{className:"text-sm text-red-500 dark:text-red-400 list-disc list-inside mb-4 space-y-1",children:[c.jsx("li",{children:"All your carnival plans and data"}),c.jsx("li",{children:"Uploaded photos and documents"}),c.jsx("li",{children:"Squad memberships"}),c.jsx("li",{children:"Your account and login"})]}),c.jsxs("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Type ",c.jsx("span",{className:"font-mono bg-gray-200 dark:bg-gray-700 px-1 rounded",children:"DELETE"})," to confirm:"]}),c.jsx("input",{type:"text",value:i,onChange:b=>o(b.target.value),placeholder:"Type DELETE",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white mb-3"}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx("button",{onClick:()=>{r(!1),o(""),m("")},disabled:a,className:"flex-1 px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors disabled:opacity-50",children:"Cancel"}),c.jsx("button",{onClick:T,disabled:a||i!=="DELETE",className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50",children:a?c.jsxs(c.Fragment,{children:[c.jsx(Gr,{className:"w-4 h-4 animate-spin"}),"Deleting..."]}):c.jsxs(c.Fragment,{children:[c.jsx(rs,{className:"w-4 h-4"}),"Delete Forever"]})})]})]}):c.jsxs("button",{onClick:()=>r(!0),className:"flex items-center gap-2 px-4 py-2 bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 rounded-lg hover:bg-red-200 dark:hover:bg-red-900/50 transition-colors",children:[c.jsx(rs,{className:"w-4 h-4"}),"Delete My Account"]})]})]})]})}function j3({user:t,activeCarnivalId:e}){const n=`http://localhost:5001/socapassport?uid=${(t==null?void 0:t.uid)||""}&carnival=${e||""}`;return c.jsxs("div",{className:"flex flex-col min-h-[500px] bg-white dark:bg-gray-800 rounded-2xl overflow-hidden border border-gray-100 dark:border-gray-700 shadow-xl transition-all duration-300",children:[c.jsxs("div",{className:"p-8 bg-gradient-to-br from-teal-600 via-teal-500 to-emerald-500 text-white relative overflow-hidden",children:[c.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full -mr-20 -mt-20 blur-3xl"}),c.jsx("div",{className:"absolute bottom-0 left-0 w-32 h-32 bg-emerald-400/20 rounded-full -ml-10 -mb-10 blur-2xl"}),c.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row md:items-center justify-between gap-6",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:"p-3 bg-white/20 backdrop-blur-md rounded-2xl shadow-inner group transition-transform hover:scale-105",children:c.jsx(Fv,{className:"w-8 h-8"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-2xl font-black tracking-tight",children:"SOCA PASSPORT"}),c.jsx("p",{className:"text-teal-50 font-medium opacity-90",children:"Your Digital Carnival Identity"})]})]}),c.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-white/20 backdrop-blur-sm rounded-full text-[10px] font-bold uppercase tracking-widest border border-white/30",children:[c.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-300 animate-pulse"}),"Bridge Active"]})]})]}),c.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-8 text-center space-y-8",children:[c.jsxs("div",{className:"relative group cursor-pointer",onClick:()=>window.open(n,"_blank"),children:[c.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-teal-500 to-emerald-500 rounded-3xl blur opacity-25 group-hover:opacity-100 transition duration-1000 group-hover:duration-200"}),c.jsxs("div",{className:"relative p-10 bg-white dark:bg-gray-900 rounded-3xl border border-gray-100 dark:border-gray-800 shadow-sm flex flex-col items-center gap-4 transition-transform hover:scale-[1.02]",children:[c.jsx("div",{className:"w-20 h-20 bg-teal-50 dark:bg-teal-900/30 rounded-full flex items-center justify-center mb-2",children:c.jsx(qv,{className:"w-10 h-10 text-teal-500"})}),c.jsx("h4",{className:"text-xl font-bold text-gray-800 dark:text-white",children:"Ready to Sync?"}),c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 max-w-xs leading-relaxed",children:"Open your Soca Passport to view your digital credentials, collection, and vibes."}),c.jsxs("button",{onClick:r=>{r.stopPropagation(),window.open(n,"_blank")},className:"mt-4 group flex items-center gap-3 px-8 py-4 bg-teal-600 hover:bg-teal-700 text-white rounded-2xl font-bold shadow-lg shadow-teal-600/20 transition-all hover:-translate-y-1 active:scale-95",children:["LAUNCH PASSPORT",c.jsx(Lm,{className:"w-5 h-5 group-hover:translate-x-1 group-hover:-translate-y-1 transition-transform"})]})]})]}),c.jsxs("div",{className:"max-w-md p-4 bg-gray-50 dark:bg-gray-700/50 rounded-2xl border border-gray-200 dark:border-gray-600 flex gap-4 text-left",children:[c.jsx("div",{className:"flex-shrink-0 mt-0.5",children:c.jsx(W5,{className:"w-5 h-5 text-gray-400"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-xs font-bold text-gray-700 dark:text-gray-300 mb-1",children:"Secure Bridge "}),c.jsx("p",{className:"text-[11px] leading-relaxed text-gray-500 dark:text-gray-400",children:`For your security, Soca Passport opens in a protected environment. We've automatically passed your credentials to ensure a seamless "hand-in-hand" experience.`})]})]})]}),c.jsxs("div",{className:"px-8 py-6 bg-gray-50 dark:bg-gray-900/80 border-t border-gray-100 dark:border-gray-800 flex flex-col sm:flex-row items-center justify-between gap-4 grayscale opacity-70 hover:grayscale-0 hover:opacity-100 transition-all",children:[c.jsxs("div",{className:"flex items-center gap-6",children:[c.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-black tracking-widest uppercase text-gray-400",children:[c.jsx(t3,{className:"w-3.5 h-3.5"}),"Encryption Active"]}),c.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-black tracking-widest uppercase text-gray-400",children:[c.jsx(jf,{className:"w-3.5 h-3.5 text-teal-500"}),"Sound Sync: ON"]})]}),c.jsx("p",{className:"text-[10px] font-bold text-gray-300 dark:text-gray-600 italic",children:"SOCA AUTHENTICATION SERVICE v2.4"})]})]})}function Db({user:t,activeCarnivalId:e,carnivalData:n,scrapedEvents:r=[],squadMembers:i=[],budgetTotal:o=0,budgetSpent:a=0,isPremium:u,onAction:h}){var S;const m=B.useMemo(()=>{if(e)return n.find(R=>R.name.toLowerCase().includes(e.replace(/-/g," ")))||n[0];const N=new Date,P=[...n].sort((F,R)=>new Date(F.date)-new Date(R.date));return P.find(F=>new Date(F.date)>=N)||P[0]},[e,n]),[y,v]=B.useState({days:0,hours:0});B.useEffect(()=>{if(!m)return;const N=()=>{const k=new Date(m.date+"T00:00:00")-new Date;if(k>0){const A=Math.floor(k/864e5),z=Math.floor(k/(1e3*60*60)%24);v({days:A,hours:z})}else v({days:0,hours:0})};N();const P=setInterval(N,6e4);return()=>clearInterval(P)},[m]);const w=B.useMemo(()=>r.length>0?r.slice(0,5):[{id:"t1",title:"Soca Brainwash",venue:"Queens Park Oval"},{id:"t2",title:"Soaka Arts & Music",venue:"O2 Park"},{id:"t3",title:"Phuket All Inclusive",venue:"Anchorage"}],[r]);return c.jsxs("div",{className:"space-y-6 mb-8 animate-fadeIn",children:[c.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 shadow-2xl text-white",children:[c.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full blur-3xl -mr-16 -mt-16"}),c.jsx("div",{className:"absolute bottom-0 left-0 w-48 h-48 bg-pink-500/20 rounded-full blur-3xl -ml-10 -mb-10 animate-pulse"}),c.jsxs("div",{className:"relative z-10 p-6 sm:p-8",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx("span",{className:"px-2 py-1 rounded-full bg-white/20 backdrop-blur-sm text-[10px] font-bold uppercase tracking-widest border border-white/10",children:e?"CURRENT MISSION":"UP NEXT"}),u&&c.jsxs("span",{className:"flex items-center px-2 py-1 rounded-full bg-yellow-400/20 text-yellow-300 text-[10px] font-bold uppercase tracking-widest",children:[c.jsx(qv,{className:"w-3 h-3 mr-1"})," Premium"]})]}),c.jsx("h2",{className:"text-3xl sm:text-4xl font-black tracking-tight leading-none mb-1",children:((S=m==null?void 0:m.name)==null?void 0:S.split("(")[0].trim())||"Carnival"}),c.jsx("p",{className:"text-white/80 text-sm font-medium",children:"Get ready for the road."})]}),c.jsxs("div",{className:"flex items-center gap-3 bg-white/10 backdrop-blur-md rounded-2xl p-4 border border-white/10",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("span",{className:"block text-2xl sm:text-3xl font-black",children:y.days}),c.jsx("span",{className:"text-[10px] uppercase opacity-70",children:"Days"})]}),c.jsx("div",{className:"h-8 w-px bg-white/20"}),c.jsxs("div",{className:"text-center",children:[c.jsx("span",{className:"block text-2xl sm:text-3xl font-black",children:y.hours}),c.jsx("span",{className:"text-[10px] uppercase opacity-70",children:"Hrs"})]})]})]}),c.jsxs("div",{className:"mt-8 flex items-center gap-3 bg-black/20 rounded-xl p-2.5 backdrop-blur-sm overflow-hidden",children:[c.jsxs("div",{className:"flex-shrink-0 flex items-center gap-1.5 px-2 py-0.5 bg-red-500 rounded text-[10px] font-bold uppercase animate-pulse",children:[c.jsx("div",{className:"w-1.5 h-1.5 bg-white rounded-full"}),"Live"]}),c.jsx("div",{className:"flex-1 overflow-hidden whitespace-nowrap",children:c.jsx("div",{className:"inline-block animate-marquee text-xs font-medium",children:w.map((N,P)=>c.jsxs("span",{className:"mr-8",children:[" ",c.jsx("span",{className:"font-bold text-pink-200",children:N.title}),N.venue&&c.jsxs("span",{className:"opacity-75",children:[" @ ",N.venue]}),N.price&&c.jsxs("span",{className:"text-green-300 ml-1",children:["($",N.price,")"]})]},N.id||P))})})]})]})]}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsxs("div",{onClick:()=>h("Budget"),className:"bg-white dark:bg-gray-800 p-4 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 cursor-pointer hover:shadow-md transition-all group",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/30 rounded-lg text-blue-600 dark:text-blue-400",children:c.jsx(dP,{className:"w-5 h-5"})}),c.jsx(jh,{className:"w-4 h-4 text-gray-300 group-hover:text-blue-500 transition-colors"})]}),c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium",children:"Budget Spent"}),c.jsxs("p",{className:"text-lg font-bold text-gray-800 dark:text-white mt-0.5",children:["$",a.toLocaleString(),c.jsxs("span",{className:"text-xs text-gray-400 font-normal ml-1",children:["/ $",o.toLocaleString()]})]}),o>0&&c.jsx("div",{className:"w-full h-1.5 bg-gray-100 dark:bg-gray-700 rounded-full mt-2",children:c.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:`${Math.min(a/o*100,100)}%`}})})]}),c.jsxs("div",{onClick:()=>h("Squad"),className:"bg-white dark:bg-gray-800 p-4 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 cursor-pointer hover:shadow-md transition-all group",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/30 rounded-lg text-green-600 dark:text-green-400",children:c.jsx(Oi,{className:"w-5 h-5"})}),c.jsx(jh,{className:"w-4 h-4 text-gray-300 group-hover:text-green-500 transition-colors"})]}),c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium",children:"Squad Online"}),c.jsxs("p",{className:"text-lg font-bold text-gray-800 dark:text-white mt-0.5",children:[i.length+1,c.jsx("span",{className:"text-xs text-gray-400 font-normal ml-1",children:"members"})]}),c.jsx("div",{className:"flex -space-x-2 mt-2",children:[...Array(Math.min(i.length+1,4))].map((N,P)=>c.jsx("div",{className:"w-6 h-6 rounded-full bg-gray-200 dark:bg-gray-600 border-2 border-white dark:border-gray-800"},P))})]}),c.jsxs("div",{onClick:()=>h("Map"),className:"bg-white dark:bg-gray-800 p-4 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 cursor-pointer hover:shadow-md transition-all group",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-900/30 rounded-lg text-purple-600 dark:text-purple-400",children:c.jsx($l,{className:"w-5 h-5"})}),c.jsx(jh,{className:"w-4 h-4 text-gray-300 group-hover:text-purple-500 transition-colors"})]}),c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium",children:"Live Events"}),c.jsx("p",{className:"text-lg font-bold text-gray-800 dark:text-white mt-0.5",children:r.length||"30+"}),c.jsx("p",{className:"text-[10px] text-purple-500 font-bold mt-1",children:" View Map"})]}),c.jsxs("div",{onClick:()=>h("Passport"),className:"bg-gradient-to-br from-teal-500 to-emerald-600 p-4 rounded-2xl shadow-sm shadow-teal-500/20 cursor-pointer hover:shadow-md hover:scale-[1.02] transition-all group",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("div",{className:"p-2 bg-white/20 rounded-lg text-white",children:c.jsx(zv,{className:"w-5 h-5"})}),c.jsx(Lm,{className:"w-4 h-4 text-white/70 group-hover:text-white transition-colors"})]}),c.jsx("p",{className:"text-xs text-teal-100 font-medium",children:"Identity"}),c.jsx("p",{className:"text-lg font-bold text-white mt-0.5",children:"Passport"}),c.jsx("p",{className:"text-[10px] text-white/80 font-bold mt-1",children:"Launch App"})]})]})]})}function L3({onBack:t,onSuccess:e}){const[n,r]=B.useState("login"),[i,o]=B.useState(""),[a,u]=B.useState(""),[h,m]=B.useState(""),[y,v]=B.useState(!1),[w,S]=B.useState(!1),[N,P]=B.useState(""),[F,R]=B.useState(""),k=T=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(T),A=T=>{switch(T){case"auth/email-already-in-use":return"This email is already registered. Try logging in instead.";case"auth/invalid-email":return"Please enter a valid email address.";case"auth/weak-password":return"Password should be at least 6 characters.";case"auth/user-not-found":return"No account found with this email.";case"auth/wrong-password":return"Incorrect password. Please try again.";case"auth/invalid-credential":return"Invalid email or password. Please check and try again.";case"auth/too-many-requests":return"Too many attempts. Please try again later.";default:return"Something went wrong. Please try again."}},z=async T=>{if(T.preventDefault(),P(""),R(""),!k(i)){P("Please enter a valid email address.");return}if(a.length<6){P("Password must be at least 6 characters.");return}if(a!==h){P("Passwords do not match.");return}S(!0);try{const b=await BR(zs,i,a);await LE(b.user),R("Account created! Please check your email to verify your account."),e&&e(b.user)}catch(b){console.error("Sign up error:",b),P(A(b.code))}finally{S(!1)}},G=async T=>{if(T.preventDefault(),P(""),R(""),!k(i)){P("Please enter a valid email address.");return}if(!a){P("Please enter your password.");return}S(!0);try{const b=await zR(zs,i,a);e&&e(b.user)}catch(b){console.error("Login error:",b),P(A(b.code))}finally{S(!1)}},W=async()=>{if(P(""),R(""),!k(i)){P("Please enter your email address first.");return}S(!0);try{await UR(zs,i),R("Password reset email sent! Check your inbox.")}catch(T){console.error("Password reset error:",T),P(A(T.code))}finally{S(!1)}};return c.jsxs("div",{className:"w-full max-w-md mx-auto",children:[c.jsxs("button",{onClick:t,className:"flex items-center gap-2 text-gray-400 hover:text-white mb-6 transition-colors",children:[c.jsx(Vv,{className:"w-4 h-4"}),"Back"]}),c.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 rounded-2xl p-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-white mb-6 text-center",children:n==="login"?"Welcome Back":"Create Account"}),N&&c.jsx("div",{className:"mb-4 p-3 bg-red-500/20 border border-red-500/30 rounded-lg text-red-300 text-sm",children:N}),F&&c.jsx("div",{className:"mb-4 p-3 bg-green-500/20 border border-green-500/30 rounded-lg text-green-300 text-sm",children:F}),c.jsxs("form",{onSubmit:n==="login"?G:z,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Email"}),c.jsxs("div",{className:"relative",children:[c.jsx(Bv,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),c.jsx("input",{type:"email",value:i,onChange:T=>o(T.target.value),placeholder:"your@email.com",className:"w-full pl-10 pr-4 py-3 bg-gray-900/80 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:border-pink-500 focus:ring-2 focus:ring-pink-500/20 transition-colors",disabled:w})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Password"}),c.jsxs("div",{className:"relative",children:[c.jsx(Ab,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),c.jsx("input",{type:y?"text":"password",value:a,onChange:T=>u(T.target.value),placeholder:"Enter your password",className:"w-full pl-10 pr-12 py-3 bg-gray-900/80 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:border-pink-500 focus:ring-2 focus:ring-pink-500/20 transition-colors",disabled:w}),c.jsx("button",{type:"button",onClick:()=>v(!y),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-300",children:y?c.jsx(q5,{className:"w-5 h-5"}):c.jsx(Uv,{className:"w-5 h-5"})})]})]}),n==="signup"&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Confirm Password"}),c.jsxs("div",{className:"relative",children:[c.jsx(Ab,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),c.jsx("input",{type:y?"text":"password",value:h,onChange:T=>m(T.target.value),placeholder:"Confirm your password",className:"w-full pl-10 pr-4 py-3 bg-gray-900/80 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:border-pink-500 focus:ring-2 focus:ring-pink-500/20 transition-colors",disabled:w})]})]}),n==="login"&&c.jsx("div",{className:"text-right",children:c.jsx("button",{type:"button",onClick:W,className:"text-sm text-pink-400 hover:text-pink-300 transition-colors",disabled:w,children:"Forgot password?"})}),c.jsx("button",{type:"submit",disabled:w,className:"w-full py-3 bg-gradient-to-r from-pink-500 to-orange-500 rounded-xl font-bold text-white hover:opacity-90 transition-opacity disabled:opacity-50 flex items-center justify-center gap-2",children:w?c.jsxs(c.Fragment,{children:[c.jsx(Gr,{className:"w-5 h-5 animate-spin"}),n==="login"?"Signing in...":"Creating account..."]}):n==="login"?"Sign In":"Create Account"})]}),c.jsx("div",{className:"mt-6 text-center",children:c.jsxs("p",{className:"text-gray-400 text-sm",children:[n==="login"?"Don't have an account?":"Already have an account?",c.jsx("button",{onClick:()=>{r(n==="login"?"signup":"login"),P(""),R("")},className:"ml-2 text-pink-400 hover:text-pink-300 font-semibold transition-colors",children:n==="login"?"Sign Up":"Sign In"})]})})]})]})}function D3({user:t,onResend:e}){const[n,r]=B.useState(!1),[i,o]=B.useState(!1);if(!t||t.emailVerified||!t.email)return null;const a=async()=>{r(!0);try{await LE(t),o(!0),setTimeout(()=>o(!1),5e3)}catch(u){console.error("Error sending verification:",u)}finally{r(!1)}};return c.jsxs("div",{className:"bg-yellow-500/20 border border-yellow-500/30 text-yellow-200 px-4 py-3 flex items-center justify-between gap-4 flex-wrap",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Bv,{className:"w-5 h-5"}),c.jsx("span",{className:"text-sm",children:"Please verify your email address to access all features."})]}),c.jsx("button",{onClick:a,disabled:n||i,className:"text-sm font-semibold bg-yellow-500/30 hover:bg-yellow-500/40 px-3 py-1 rounded-lg transition-colors disabled:opacity-50",children:i?"Email Sent!":n?"Sending...":"Resend Email"})]})}const M3=()=>Math.random().toString(36).substring(2,8).toUpperCase(),O3=async(t,e,n)=>{if(!t)throw new Error("User not authenticated");const r=M3(),i={name:e,leaderId:t.uid,leaderName:t.displayName||t.email,members:[t.uid],memberDetails:{[t.uid]:{name:t.displayName||t.email,role:"leader",photoURL:t.photoURL||null,joinedAt:new Date().toISOString()}},carnivalId:n,inviteCode:r,createdAt:yv(),sharedItinerary:[]};console.log("Attempting to create squad doc...",i);const o=await ud(En(Ue,"squads"),i);console.log("Squad doc created with ID:",o.id);const a=ut(Ue,"users",t.uid);return console.log("Updating user profile for squad:",t.uid),await qr(a,{currentSquadId:o.id},{merge:!0}),console.log("User profile updated."),{id:o.id,...i}},V3=async(t,e)=>{if(!t||!e)return;const n=ut(Ue,"squads",e),r=ut(Ue,"users",t.uid);await zu(n,{members:i1(t.uid)}),await zu(r,{currentSquadId:null})},lh="carnival-planner-v1",F3="price_1SanHUJR9xpdRiXijLesRPVt",U3="price_1SanMhJR9xpdRiXinv2F9knM",Mb={trinidad:[{title:"Soca Brainwash",note:"The main event. Bring drinks."},{title:"AM Bush",note:"J'ouvert style. Wear old clothes."},{title:"Phuket",note:"All inclusive."},{title:"Soaka Street Festival",note:"Iron park."}],stlucia:[{title:"Remedy",note:"Beachside."},{title:"Mess",note:"Paint and Powder."},{title:"Indulgence",note:"Breakfast fete."}],default:[{title:"Catamaran Cruise",note:"Boat ride."},{title:"J'ouvert",note:"Paint and powder."},{title:"Monday Mas",note:"On the road."}]};function B3(){var ni,ys,_s,Dr,Me,et,ri;const[t,e]=B.useState(null),[n,r]=B.useState(!1),[i,o]=B.useState({}),[a,u]=B.useState(null),[h,m]=B.useState("Budget"),[y,v]=B.useState(!1),[w,S]=B.useState(!0),[N,P]=B.useState(!1),[F,R]=B.useState(!0),[k,A]=B.useState(!1),[z,G]=B.useState(""),[W,T]=B.useState(""),[b,C]=B.useState(""),[D,V]=B.useState(""),[U,M]=B.useState(""),[le,Ee]=B.useState(""),[Ce,Re]=B.useState(""),[K,ce]=B.useState({band:"",section:"",total:"",paid:""}),[X,we]=B.useState(""),[ue,me]=B.useState(""),[_e,fe]=B.useState([]),[de,De]=B.useState(null),[lt,Gn]=B.useState(!1),[Pt,en]=B.useState(!1),[an,Xe]=B.useState(""),[ft,He]=B.useState(""),zt=async()=>{const{DEMO_USER:j,DEMO_CARNIVALS:Y,DEMO_SQUAD:ne}=await Cg(async()=>{const{DEMO_USER:re,DEMO_CARNIVALS:ge,DEMO_SQUAD:Qe}=await import("./demoData-59eL2sCn.js");return{DEMO_USER:re,DEMO_CARNIVALS:ge,DEMO_SQUAD:Qe}},[]);r(!0),e(j),o(Y),u("trinidad"),fe(ne),v(!0),S(!1),Kt(Y.trinidad)},mt=()=>{r(!1),e(null),o({}),u(null),fe([]),v(!1),S(!0),Kt(null)};B.useEffect(()=>{new URLSearchParams(window.location.search).get("demo")==="true"&&zt()},[]);const _n=async()=>{if(n){alert("This feature is simulated in Demo Mode.");return}if(t){Gn(!0),Xe("");try{const j=await O3(t,`${t.displayName||"User"}'s Squad`,a);De(j),we(j.inviteCode),Pr("Only Premium users can lead a squad!")}catch(j){console.error("Error creating squad:",j),Xe(`Failed: ${j.message}`)}finally{Gn(!1)}}},ma=async()=>{if(n){alert("Joining squads is simulated in Demo Mode.");return}if(!t||!ue)return;const j=ue.trim().toUpperCase();en(!0),Xe(""),console.log("HandleJoinSquad: Attempting to join with code:",j);try{const Y=await vo(t,j);if(console.log("HandleJoinSquad: Join success. Squad result:",Y),!Y)throw new Error("Join successful but no squad data returned");He(`Joined ${Y.name||"Squad"}!`),me("")}catch(Y){console.error("Error joining squad:",Y),Xe(Y.message||"Invalid code")}finally{en(!1)}},ls=async()=>{if(n){confirm("Exit Demo Mode?")&&mt();return}!t||!de||confirm("Are you sure you want to leave this squad?")&&(await V3(t,de.id),De(null),fe([]))},[Zr,Pr]=B.useState(null),[Ii,mo]=B.useState(!0),[po,wt]=B.useState(!1),[Nt,Qr]=B.useState(navigator.onLine);B.useEffect(()=>{const j=()=>Qr(!0),Y=()=>Qr(!1);return window.addEventListener("online",j),window.addEventListener("offline",Y),()=>{window.removeEventListener("online",j),window.removeEventListener("offline",Y)}},[]);const[go,Cn]=B.useState(null),[pa,Nr]=B.useState(!1),[Ar,Cr]=B.useState([]),[cs,ga]=B.useState(!1),[Yr,us]=B.useState(null),ya=[{id:"stkitts-sugar-mas",name:"St. Kitts (Sugar Mas)",monthIndex:0},{id:"stcroix",name:"St. Croix Carnival",monthIndex:0},{id:"trinidad",name:"Trinidad Carnival",monthIndex:1},{id:"dominica",name:"Dominica (Mas Domnik)",monthIndex:1},{id:"jamaica",name:"Jamaica Carnival",monthIndex:3},{id:"tampa",name:"Tampa Bay Carnival",monthIndex:3},{id:"stmaarten",name:"St. Maarten Carnival",monthIndex:3},{id:"cayman-batabano",name:"Cayman Batabano",monthIndex:4},{id:"stthomas",name:"St. Thomas Carnival",monthIndex:4},{id:"atlanta",name:"Atlanta Caribbean Carnival",monthIndex:4},{id:"guyana",name:"Guyana Independence",monthIndex:4},{id:"bahamas",name:"Bahamas Carnival",monthIndex:5},{id:"bermuda",name:"Bermuda Carnival",monthIndex:5},{id:"hollywood",name:"Hollywood Carnival",monthIndex:5},{id:"caymas",name:"Caymas Carnival",monthIndex:5},{id:"vincymas",name:"St. Vincent (Vincy Mas)",monthIndex:6},{id:"stlucia",name:"St. Lucia Carnival",monthIndex:6},{id:"toronto",name:"Toronto (Caribana)",monthIndex:7},{id:"barbados",name:"Barbados Crop Over",monthIndex:7},{id:"nevis",name:"Nevis Culturama",monthIndex:7},{id:"antigua",name:"Antigua Carnival",monthIndex:7},{id:"grenada",name:"Grenada Spicemas",monthIndex:7},{id:"ny-labor-day",name:"New York Carnival",monthIndex:8},{id:"japan",name:"Japan Caribbean",monthIndex:8},{id:"miami",name:"Miami Carnival",monthIndex:9},{id:"tobago",name:"Tobago Carnival",monthIndex:10}],ds=["bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500","bg-gradient-to-r from-green-400 to-blue-500","bg-gradient-to-r from-yellow-400 via-red-500 to-pink-500","bg-gradient-to-r from-teal-400 to-cyan-500","bg-gradient-to-r from-red-500 via-orange-500 to-yellow-500","bg-gradient-to-r from-purple-600 to-indigo-600"],Rr=["January","February","March","April","May","June","July","August","September","October","November","December"];B.useEffect(()=>{F?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[F]),B.useEffect(()=>{if(!t||n)return;(async()=>{try{const Y=ut(Ue,"users",t.uid,"preferences","theme"),ne=await Mo(Y);if(ne.exists()){const re=ne.data();typeof re.darkMode=="boolean"&&R(re.darkMode)}}catch(Y){console.log("Could not load theme preference:",Y)}})()},[t,n]);const hs=async j=>{if(!(!t||n))try{const Y=ut(Ue,"users",t.uid,"preferences","theme");await qr(Y,{darkMode:j,updatedAt:Ze.now()},{merge:!0})}catch(Y){console.log("Could not save theme preference:",Y)}},yo=()=>{const j=!F;R(j),hs(j)};B.useEffect(()=>{if(n)return;const j=HR(zs,async Y=>{if(e(Y),Y){console.log("[Analytics] Creating/updating user doc for:",Y.uid,Y.email);try{const ne=ut(Ue,"users",Y.uid);await qr(ne,{lastLoginAt:Ze.now(),email:Y.email||null,displayName:Y.displayName||null},{merge:!0}),console.log("[Analytics] User document updated successfully"),navigator.geolocation&&navigator.geolocation.getCurrentPosition(re=>{const{latitude:ge,longitude:Qe}=re.coords;qr(ne,{lastLocation:{lat:ge,lng:Qe},lastLocationAt:Ze.now()},{merge:!0}).then(()=>console.log("Location saved")).catch(je=>console.error("Loc save error",je))},re=>{console.log("Geolocation denied/error:",re.message)})}catch(ne){console.error("[Analytics] Failed to update user doc:",ne.code,ne.message)}}});return()=>j()},[n]),B.useEffect(()=>{if(!t){n||(De(null),fe([]));return}if(n)return;const j=$i(ut(Ue,"users",t.uid),Y=>{const ne=Y.data();ne!=null&&ne.currentSquadId?$i(ut(Ue,"squads",ne.currentSquadId),re=>{if(re.exists()){const ge=re.data();De({id:re.id,...ge}),Kt(ge);const Qe=Object.values(ge.memberDetails||{});fe(Qe),we(ge.inviteCode)}else De(null),Kt(null),fe([])}):(De(null),fe([]))});return()=>j()},[t,n]),B.useEffect(()=>{if(!t){n||v(!1);return}if(n){v(!0);return}const j=["djkrss1@gmail.com","maikacooke@gmail.com"];j.includes(t.email)&&v(!0);const Y=ut(Ue,"users",t.uid,"apps",lh),ne=$i(Y,re=>{if(j.includes(t.email)){v(!0);return}if(re.exists()){const ge=re.data();v(!!ge.premiumActive)}else v(!1)});return()=>ne()},[t,n]),B.useEffect(()=>{if(!t){n||(o({}),u(null));return}if(n)return;const j=En(Ue,"users",t.uid,"apps",lh,"carnivals"),Y=$i(j,ne=>{const re={};ne.forEach(ge=>{re[ge.id]=ge.data()}),o(re),!a&&ne.docs.length>0&&u(ne.docs[0].id)});return()=>Y()},[t,n]),B.useEffect(()=>{n||_j(zs).catch(j=>console.error(j))},[n]),B.useEffect(()=>{if(!t||n)return;(async()=>{try{const ne=await _5("BLbW7EjHjQ9_YjKrRbJwgBgRqnkSmZsXMnEWTQZpqYwSRbVgYLmXW5RvXA2_aS3vH9XJpCxHu4VmXnZL2wQxMvI");if(ne){const re=ci(On);await ui(re,"saveFcmToken")({fcmToken:ne}),console.log("FCM token saved")}}catch(Y){console.log("Error setting up notifications:",Y)}})(),v5(Y=>{var ne,re;console.log("Foreground message:",Y),Pr({title:((ne=Y.notification)==null?void 0:ne.title)||"Squad Alert",body:((re=Y.notification)==null?void 0:re.body)||"Someone in your squad is Road Ready!"}),setTimeout(()=>Pr(null),5e3)})},[t,n]);const jr=async()=>{const j=new Mi;try{await dj(zs,j)}catch(Y){console.error("Sign in error:",Y)}},_a=async()=>{if(n){mt();return}await DE(zs),S(!0),P(!1),m("Budget"),R(!0)},Ti=async j=>{if(n){alert("Subscriptions are disabled in Demo Mode.");return}if(!t){alert("You must be signed in to subscribe.");return}const Y=j==="yearly"?"yearly":"monthly",ne=Y==="yearly"?U3:F3;A(!0);try{const re=ci(On),ge=ui(re,"createCheckoutSession");console.log(`Starting checkout... Interval: ${Y}, PriceID: ${ne}`);const Qe=await ge({priceId:ne,success_url:window.location.origin,cancel_url:window.location.origin}),{data:je}=Qe||{};je&&(je.url||je.checkoutUrl)?window.location.href=je.url||je.checkoutUrl:(console.error("No checkout URL returned:",je),alert("Unable to start checkout. Please try again."))}catch(re){console.error("Error starting checkout:",re),alert("There was a problem starting your checkout: "+re.message)}finally{A(!1)}},va=async(j,Y)=>{if(t){if(u(j),n){i[j]?j==="trinidad"&&i.trinidad?Kt(i.trinidad):Kt(null):(o(ne=>({...ne,[j]:{name:Y,budget:[],schedule:[],packing:[],squad:[],costume:null,createdAt:new Date().toISOString()}})),Kt(null));return}if(!i[j])try{const ne=ut(Ue,"users",t.uid,"apps",lh,"carnivals",j);await qr(ne,{name:Y,budget:[],schedule:[],packing:[],squad:[],costume:null,createdAt:Ze.now()},{merge:!0})}catch(ne){console.error(ne)}}},vn=(ni=i[a])==null?void 0:ni.sharedPlanId,bt=!!vn,[ct,Kt]=B.useState(null),[Jr,Xr]=B.useState(!1),xn=async()=>{if(!n){if(!vn||!t){Kt(null);return}Xr(!0);try{const j=ci(On),ne=await ui(j,"getSharedCarnivalData")({planId:vn,uid:t.uid});Kt(ne.data)}catch(j){console.log("Could not load shared carnival data:",j.message),Kt(null)}finally{Xr(!1)}}};B.useEffect(()=>{vn&&!n?xn():n||Kt(null)},[vn,t,n]);const se=async(j,Y,ne="set")=>{var ge;if(!t||!a)return;if(n){const Qe=je=>{let We=Y;return ne==="add"&&Array.isArray(je[j])?We=[...je[j]||[],...Y]:ne==="remove"&&Array.isArray(je[j])?We=(je[j]||[]).filter(qt=>qt.id!==Y.id):ne==="update"&&Array.isArray(je[j])&&Y.id!==void 0&&(We=(je[j]||[]).map(qt=>qt.id===Y.id?{...qt,...Y}:qt)),ne==="set"&&(We=Y),{...je,[j]:We}};bt?(Kt(je=>Qe(je)),o(je=>({...je,[a]:Qe(je[a])}))):o(je=>({...je,[a]:Qe(je[a])}));return}if(vn&&["budget","schedule","packing","costume","squad"].includes(j))try{const Qe=ci(On),We=await ui(Qe,"updateSharedCarnivalData")({planId:vn,field:j,data:Y,action:ne,uid:t.uid,userEmail:t.email});(ge=We.data)!=null&&ge.data&&Kt(We.data.data);return}catch(Qe){console.error("Error updating shared data:",Qe)}const re=ut(Ue,"users",t.uid,"apps",lh,"carnivals",a);await zu(re,{[j]:Y})};B.useEffect(()=>{if(!t||!a||!y){Cr([]);return}(async()=>{var Y;ga(!0);try{const ne=ci(On),ge=await ui(ne,"getScrapedEvents")({carnivalId:a});(Y=ge.data)!=null&&Y.success?(Cr(ge.data.events||[]),us(ge.data.lastScrapedAt)):(Cr([]),us(null))}catch(ne){console.log("Error fetching scraped events:",ne),Cr([])}finally{ga(!1)}})()},[t,a,y]);const Lr=async()=>{var j,Y;if(P(!0),y&&Ii&&Pe){wt(!0);try{const ne=ci(On),ge=await ui(ne,"sendRoadReadyAlert")({carnivalId:a,carnivalName:Pe.name,userName:(t==null?void 0:t.displayName)||((j=t==null?void 0:t.email)==null?void 0:j.split("@")[0])||"Squad Member"});((Y=ge.data)==null?void 0:Y.notified)>0&&(Pr({title:"Squad Notified!",body:`${ge.data.notified} squad member(s) alerted that you're Road Ready!`}),setTimeout(()=>Pr(null),5e3))}catch(ne){console.log("Error sending Road Ready alert:",ne)}finally{wt(!1)}}},xa=()=>{var Y;if(!z.trim()||!W)return;const j={id:Date.now().toString(),name:z.trim(),cost:parseFloat(W)};if(bt)se("budget",[j],"add");else{const ne=((Y=i[a])==null?void 0:Y.budget)||[];se("budget",[...ne,j])}G(""),T("")},wa=j=>{var Y;if(bt)se("budget",{id:j},"remove");else{const ne=((Y=i[a])==null?void 0:Y.budget)||[];se("budget",ne.filter(re=>re.id!==j))}},Ei=()=>{var Y;if(!b.trim()||!D)return;const j={id:Date.now().toString(),title:b.trim(),datetime:D,note:U.trim()};if(bt)se("schedule",[j],"add");else{const ne=((Y=i[a])==null?void 0:Y.schedule)||[];se("schedule",[...ne,j])}C(""),V(""),M("")},fs=j=>{var Y;if(bt)se("schedule",{id:j},"remove");else{const ne=((Y=i[a])==null?void 0:Y.schedule)||[];se("schedule",ne.filter(re=>re.id!==j))}},ki=j=>{var ge;const Y=new Date;Y.setDate(Y.getDate()+1),Y.setHours(12,0,0,0);const ne=Y.toISOString().slice(0,16),re={id:Date.now().toString(),title:j.title,datetime:ne,note:j.note||"Added from curated list"};if(bt)se("schedule",[re],"add");else{const Qe=((ge=i[a])==null?void 0:ge.schedule)||[];se("schedule",[...Qe,re])}},Kn=()=>{var Y;if(!le.trim())return;const j={id:Date.now().toString(),item:le.trim(),checked:!1};if(bt)se("packing",[j],"add");else{const ne=((Y=i[a])==null?void 0:Y.packing)||[];se("packing",[...ne,j])}Ee("")},Zn=j=>{var re;const Y=bt?(ct==null?void 0:ct.packing)||[]:((re=i[a])==null?void 0:re.packing)||[],ne=Y.find(ge=>ge.id===j);ne&&(bt?se("packing",{id:j,checked:!ne.checked},"update"):se("packing",Y.map(ge=>ge.id===j?{...ge,checked:!ge.checked}:ge)))},ba=j=>{var Y;if(bt)se("packing",{id:j},"remove");else{const ne=((Y=i[a])==null?void 0:Y.packing)||[];se("packing",ne.filter(re=>re.id!==j))}},Ia=()=>{var Y;if(!Ce.trim())return;const j={id:Date.now().toString(),name:Ce.trim()};if(bt)se("squad",[j],"add");else{const ne=((Y=i[a])==null?void 0:Y.squad)||[];se("squad",[...ne,j])}Re("")},_o=j=>{var Y;if(bt)se("squad",{id:j},"remove");else{const ne=((Y=i[a])==null?void 0:Y.squad)||[];se("squad",ne.filter(re=>re.id!==j))}};B.useEffect(()=>{const j=a?i[a]:null;j!=null&&j.shareCode?we(j.shareCode):we("")},[a,i]);const ms=async()=>{var Y;const j=a?i[a]:null;if(!(j!=null&&j.sharedPlanId)||!t){fe([]);return}try{const ne=ci(On),ge=await ui(ne,"getSharedPlanData")({planId:j.sharedPlanId,uid:t.uid});(Y=ge.data)!=null&&Y.members&&fe(ge.data.members)}catch(ne){console.log("Could not fetch squad members:",ne.message),fe([])}};B.useEffect(()=>{a&&t&&ms()},[a,i,t]);const vo=async()=>{if(!ue.trim()||ue.length!==6){Xe("Please enter a valid 6-character code");return}en(!0),Xe("");try{const j=ci(On),ne=await ui(j,"joinSquadByCode")({shareCode:ue.toUpperCase(),uid:t.uid,email:t.email});He(`Joined ${ne.data.carnivalName} squad!`),me(""),ne.data.planId&&se("sharedPlanId",ne.data.planId),setTimeout(()=>{ms()},500),setTimeout(()=>He(""),3e3)}catch(j){console.error("Error joining squad:",j),Xe(j.message||"Failed to join squad")}finally{en(!1)}},Ta=()=>{X&&(navigator.clipboard.writeText(X),He("Code copied to clipboard!"),setTimeout(()=>He(""),2e3))},ps=()=>{se("costume",{...K,total:parseFloat(K.total)||0,paid:parseFloat(K.paid)||0,updatedAt:Date.now()}),alert("Costume details saved!")},gs=()=>{if(!Pe)return;const j=[];j.push(`CARNIVAL PLANNER: ${Pe.name}`),j.push(`==========================================
`),j.push("-- SQUAD --"),(Pe.squad||[]).forEach(Qe=>j.push(`- ${Qe.name}`)),j.push(`
`),j.push("-- COSTUME --"),Pe.costume?(j.push(`Band: ${Pe.costume.band}`),j.push(`Section: ${Pe.costume.section}`),j.push(`Balance Due: $${((Pe.costume.total||0)-(Pe.costume.paid||0)).toFixed(2)}`)):j.push("No costume details."),j.push(`
`),j.push("-- SCHEDULE --"),(Pe.schedule||[]).slice().sort((Qe,je)=>new Date(Qe.datetime)-new Date(je.datetime)).forEach(Qe=>j.push(`${new Date(Qe.datetime).toLocaleString()} | ${Qe.title}`));const ne=new Blob([j.join(`
`)],{type:"text/plain"}),re=URL.createObjectURL(ne),ge=document.createElement("a");ge.href=re,ge.download=`${Pe.name.replace(/\s+/g,"_")}_Plan.txt`,ge.click()},ur=a?i[a]:null,Pe=ur?{...ur,...bt&&ct?{budget:ct.budget||ur.budget||[],schedule:ct.schedule||ur.schedule||[],packing:ct.packing||ur.packing||[],costume:ct.costume||ur.costume,squad:ct.squad||ur.squad||[]}:{}}:null,ei=((ys=Pe==null?void 0:Pe.budget)==null?void 0:ys.reduce((j,Y)=>j+(Y.cost||0),0))||0,dr=Pe!=null&&Pe.costume?Pe.costume.total-Pe.costume.paid:0,ti=Pe?Mb[a]||Mb.default:[];if(go){const j={onBack:()=>Cn(null),logo:sh};switch(go){case"privacy":return c.jsx(E3,{...j});case"terms":return c.jsx(k3,{...j});case"cookies":return c.jsx(S3,{...j});case"refund":return c.jsx(P3,{...j});case"contact":return c.jsx(A3,{...j,user:t});default:Cn(null)}}if(w&&!t)return c.jsx(T3,{onGetStarted:()=>S(!1),logo:sh,onLegalPage:Cn,onTryDemo:zt});if(t&&N&&Pe){const j=(Pe.schedule||[]).slice().sort((Y,ne)=>new Date(Y.datetime)-new Date(ne.datetime)).find(Y=>new Date(Y.datetime)>new Date);return c.jsxs("div",{className:"min-h-screen bg-gray-900 text-white p-6 flex flex-col",children:[c.jsxs("div",{className:"flex justify-between items-center mb-8",children:[c.jsx("h1",{className:"text-2xl font-bold italic",children:"ROAD MODE"}),c.jsx("button",{onClick:()=>P(!1),className:"text-sm bg-gray-800 px-3 py-1 rounded",children:"Exit"})]}),c.jsxs("div",{className:"flex-1 flex flex-col gap-6",children:[c.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-blue-600 p-6 rounded-2xl shadow-lg",children:[c.jsx("h2",{className:"text-sm font-bold opacity-75 uppercase tracking-wider mb-1",children:"Up Next"}),j?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"text-3xl font-black mb-1",children:j.title}),c.jsx("div",{className:"text-xl opacity-90",children:new Date(j.datetime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),c.jsx("div",{className:"mt-2 text-sm bg-white/20 inline-block px-2 py-1 rounded",children:j.note||"No notes"})]}):c.jsx("div",{className:"text-xl italic opacity-75",children:"No more fetes scheduled! Sleep time?"})]}),c.jsxs("div",{className:"bg-gray-800 p-6 rounded-2xl border border-gray-700",children:[c.jsx("h2",{className:"text-sm font-bold opacity-75 uppercase tracking-wider mb-2",children:"Costume Pickup"}),Pe.costume?c.jsxs("div",{children:[c.jsx("div",{className:"text-xl font-bold text-yellow-400",children:Pe.costume.band}),c.jsxs("div",{className:"text-gray-400",children:["Section: ",Pe.costume.section]}),dr>0&&c.jsxs("div",{className:"text-red-400 font-bold mt-1",children:["Balance Due: $",dr]})]}):c.jsx("div",{className:"text-gray-500 italic",children:"No costume details saved."})]})]})]})}return c.jsxs("div",{className:"min-h-screen flex flex-col bg-gray-50 dark:bg-gray-900 transition-colors duration-200",children:[Zr&&c.jsx("div",{className:"fixed top-4 right-4 z-50 animate-slideIn",children:c.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 text-white p-4 rounded-xl shadow-2xl max-w-sm",children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx("span",{className:"text-2xl",children:""}),c.jsxs("div",{children:[c.jsx("p",{className:"font-bold",children:Zr.title}),c.jsx("p",{className:"text-sm opacity-90",children:Zr.body})]}),c.jsx("button",{onClick:()=>Pr(null),className:"ml-2 text-white/70 hover:text-white",children:""})]})})}),c.jsx(N3,{}),c.jsxs("header",{className:"bg-white dark:bg-gray-800 shadow-sm py-4 px-4 flex justify-between items-center sticky top-0 z-20 transition-colors",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("img",{src:sh,alt:"Logo",className:"w-8 h-8"}),c.jsx("h1",{className:"text-lg font-bold text-gray-800 dark:text-white hidden sm:block",children:"Carnival Planner"})]}),t&&c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("button",{onClick:yo,className:"p-2 rounded-full bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-yellow-300",children:F?"":""}),n&&c.jsx("button",{onClick:mt,className:"px-3 py-1 text-xs font-bold rounded-full bg-red-100 text-red-700 hover:bg-red-200 border border-red-200 transition-colors",children:"EXIT DEMO"}),Pe&&c.jsx("button",{onClick:Lr,disabled:po,className:"px-3 py-1 text-xs font-bold rounded-full transition bg-purple-100 text-purple-700 hover:bg-purple-200 dark:bg-purple-900 dark:text-purple-200 disabled:opacity-50",children:po?"...":"GO ROAD READY"}),y?c.jsx("span",{className:"px-2 py-1 text-xs bg-yellow-100 text-yellow-800 rounded-full font-bold",children:"Premium"}):c.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500",children:"Free Plan"}),c.jsxs("div",{className:`flex items-center gap-1.5 px-2 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider ${Nt?"bg-green-100 text-green-700 dark:bg-green-900/40 dark:text-green-300":"bg-orange-100 text-orange-700 dark:bg-orange-900/40 dark:text-orange-300"}`,children:[c.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${Nt?"bg-green-500":"bg-orange-500 animate-pulse"}`}),Nt?"Online":"Offline Mode"]}),c.jsx("button",{onClick:_a,className:"text-sm font-medium text-gray-500 hover:text-red-500 dark:text-gray-400",children:"Sign Out"})]})]}),t&&c.jsx(D3,{user:t}),c.jsx("main",{className:"flex-1 p-4 max-w-4xl mx-auto w-full",children:t?c.jsxs("div",{children:[c.jsx("div",{className:"mb-8",children:c.jsx("div",{className:"flex gap-4 overflow-x-auto pb-4 snap-x",children:ya.map((j,Y)=>{const ne=a===j.id,re=ds[Y%ds.length],Qe={"stkitts-sugar-mas":"Sugar Mas",stcroix:"St. Croix Carnival",trinidad:"Trinidad Carnival",dominica:"Mas Domnik",jamaica:"Jamaica Carnival",tampa:"Tampa Bay Carnival",stmaarten:"St. Maarten Carnival","cayman-batabano":"Cayman Carnival Batabano",stthomas:"St. Thomas Carnival",atlanta:"Atlanta Caribbean Carnival",guyana:"Guyana Independence",bahamas:"Bahamas Carnival",bermuda:"Bermuda Carnival",hollywood:"Hollywood Carnival",caymas:"Caymas Carnival",vincymas:"Vincy Mas",stlucia:"Saint Lucia Carnival",toronto:"Toronto Caribbean Carnival",barbados:"Crop Over",nevis:"Nevis Culturama",antigua:"Antigua Carnival",grenada:"Spice Mas","ny-labor-day":"New York Carnival",japan:"Japan Caribbean Carnival",miami:"Miami Carnival",tobago:"Tobago Carnival"}[j.id]||j.name,je=Op.find(qt=>qt.name.toLowerCase().includes(Qe.toLowerCase())||Qe.toLowerCase().includes(qt.name.split("(")[0].trim().toLowerCase()));let We=null;if(je){const qt=new Date,hr=new Date(qt.getFullYear(),qt.getMonth(),qt.getDate()),[fr,Ne,Rn]=je.date.split("-").map(Number),jn=new Date(fr,Ne-1,Rn);jn>=hr&&(We=Math.round((jn-hr)/(1e3*60*60*24)))}return c.jsx("div",{onClick:()=>va(j.id,`${j.name} - ${Rr[j.monthIndex]}`),className:`snap-center min-w-[200px] cursor-pointer rounded-2xl p-5 shadow-lg relative overflow-hidden transition-all duration-300 ${ne?"ring-4 ring-offset-2 ring-blue-400 scale-105":"hover:scale-105 opacity-90"} ${re}`,children:c.jsxs("div",{className:"relative z-10 text-white",children:[c.jsx("h4",{className:"font-bold text-lg leading-tight mb-1",children:j.name}),c.jsx("p",{className:"text-xs font-medium uppercase tracking-wider opacity-90",children:Rr[j.monthIndex]}),je&&c.jsx("p",{className:"text-xs font-medium opacity-80 mt-1",children:new Date(je.date+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),We!==null&&c.jsxs("div",{className:"mt-2 bg-white/20 backdrop-blur-sm rounded-lg px-2 py-1 inline-block",children:[c.jsx("span",{className:"text-lg font-black",children:We}),c.jsx("span",{className:"text-xs ml-1 opacity-90",children:"days"})]})]})},j.id)})})}),Pe?c.jsxs(c.Fragment,{children:[c.jsx(Db,{user:t,activeCarnivalId:a,carnivalData:Op,scrapedEvents:Ar,squadMembers:_e,budgetTotal:2e4,budgetSpent:ei,isPremium:y,onAction:m}),c.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-100 dark:border-gray-700 overflow-hidden transition-colors",children:[!y&&c.jsxs("div",{className:"bg-gradient-to-r from-yellow-400 via-orange-500 to-pink-500 p-4 flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("span",{className:"text-2xl",children:""}),c.jsxs("div",{children:[c.jsx("p",{className:"text-white font-bold text-sm",children:"Unlock Premium Features"}),c.jsx("p",{className:"text-white/80 text-xs",children:"Go ad-free and get a Premium badge!"})]})]}),c.jsx("button",{onClick:()=>m("Info"),className:"px-4 py-2 bg-white text-orange-600 font-bold text-sm rounded-full hover:bg-gray-100 transition",children:"Upgrade"})]}),!y&&c.jsx("div",{className:"border-b border-gray-100 dark:border-gray-700",children:c.jsx(ah,{placement:"banner",onUpgradeClick:()=>m("Info")})}),c.jsx("div",{className:"flex border-b border-gray-100 dark:border-gray-700 overflow-x-auto scrollbar-hide",children:["Budget","Costume","Bands","Schedule","Squad","Passport","Packing","Map","Media","Info"].filter(j=>y||!["Map","Media","Passport"].includes(j)).map(j=>c.jsxs("button",{onClick:()=>{console.log("Switching to tab:",j,"isPremium:",y),m(j)},className:`flex-shrink-0 px-3 sm:px-4 py-3 sm:py-4 text-xs sm:text-sm font-medium transition-colors relative whitespace-nowrap ${h===j?"text-blue-600 dark:text-blue-400 bg-blue-50/50 dark:bg-blue-900/20":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"}`,children:[j,["Map","Media","Passport"].includes(j)&&c.jsx("span",{className:"ml-1 text-xs text-yellow-500",children:""}),h===j&&c.jsx("div",{className:"absolute bottom-0 left-0 w-full h-0.5 bg-blue-600 dark:bg-blue-400"})]},j))}),bt&&c.jsxs("div",{className:"bg-gradient-to-r from-green-500 to-teal-500 px-4 py-2 flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-white text-lg",children:""}),c.jsxs("div",{children:[c.jsx("p",{className:"text-white font-medium text-sm",children:"Squad Mode Active"}),c.jsxs("p",{className:"text-white/80 text-xs",children:["Changes sync with ",_e.length," squad member(s)"]})]})]}),c.jsx("button",{onClick:xn,disabled:Jr,className:"px-3 py-1 bg-white/20 text-white text-xs font-medium rounded-full hover:bg-white/30 transition disabled:opacity-50",children:Jr?"Syncing...":"Refresh"})]}),c.jsxs("div",{className:"p-6",children:[h==="Budget"&&c.jsxs("div",{className:"animate-fadeIn",children:[c.jsxs("div",{className:"flex justify-between items-end mb-6",children:[c.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-white",children:"Budget"}),c.jsxs("div",{className:"text-right",children:[c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total Estimate"}),c.jsxs("p",{className:"text-2xl font-black text-green-600 dark:text-green-400",children:["$",ei.toFixed(2)]})]})]}),c.jsx("div",{className:"space-y-3 mb-6",children:(Pe.budget||[]).map(j=>{var Y;return c.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 dark:bg-gray-700 rounded-lg group hover:bg-gray-100 dark:hover:bg-gray-600",children:[c.jsxs("div",{children:[c.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-200",children:j.name}),j.addedBy&&bt&&c.jsxs("span",{className:"ml-2 text-xs text-gray-400 dark:text-gray-500",children:["by ",((Y=j.addedBy.email)==null?void 0:Y.split("@")[0])||"squad member"]})]}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("span",{className:"font-bold text-gray-900 dark:text-white",children:["$",j.cost.toFixed(2)]}),c.jsx("button",{onClick:()=>wa(j.id),className:"text-gray-400 hover:text-red-500",children:""})]})]},j.id)})}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[c.jsxs("div",{className:"flex gap-2 flex-1",children:[c.jsx("input",{type:"text",placeholder:"Item",value:z,onChange:j=>G(j.target.value),className:"flex-[2] p-3 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm"}),c.jsx("input",{type:"number",placeholder:"0.00",value:W,onChange:j=>T(j.target.value),className:"flex-1 p-3 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm"})]}),c.jsx("button",{onClick:xa,className:"w-full sm:w-auto px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium",children:"Add"})]}),!y&&c.jsx("div",{className:"mt-6 pt-4 border-t border-gray-100 dark:border-gray-700",children:c.jsx(ah,{placement:"inline",onUpgradeClick:()=>m("Info")})})]}),h==="Bands"&&c.jsx("div",{className:"animate-fadeIn",children:c.jsx(I3,{carnivalId:a})}),h==="Costume"&&c.jsxs("div",{className:"animate-fadeIn",children:[c.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-white mb-4",children:"Mas Costume"}),c.jsxs("div",{className:"bg-pink-50 dark:bg-pink-900/20 p-6 rounded-xl border border-pink-100 dark:border-pink-900 mb-4",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-bold text-pink-800 dark:text-pink-300 uppercase mb-1",children:"Band Name"}),c.jsx("input",{type:"text",className:"w-full p-2 border border-pink-200 dark:border-pink-800 rounded dark:bg-gray-700 dark:text-white",value:K.band||((_s=Pe.costume)==null?void 0:_s.band)||"",onChange:j=>ce({...K,band:j.target.value}),placeholder:"e.g. Tribe, Bliss..."})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-bold text-pink-800 dark:text-pink-300 uppercase mb-1",children:"Section"}),c.jsx("input",{type:"text",className:"w-full p-2 border border-pink-200 dark:border-pink-800 rounded dark:bg-gray-700 dark:text-white",value:K.section||((Dr=Pe.costume)==null?void 0:Dr.section)||"",onChange:j=>ce({...K,section:j.target.value}),placeholder:"e.g. The Monarch"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-bold text-pink-800 dark:text-pink-300 uppercase mb-1",children:"Total Cost"}),c.jsx("input",{type:"number",className:"w-full p-2 border border-pink-200 dark:border-pink-800 rounded dark:bg-gray-700 dark:text-white",value:K.total||((Me=Pe.costume)==null?void 0:Me.total)||"",onChange:j=>ce({...K,total:j.target.value}),placeholder:"0.00"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-bold text-pink-800 dark:text-pink-300 uppercase mb-1",children:"Amount Paid"}),c.jsx("input",{type:"number",className:"w-full p-2 border border-pink-200 dark:border-pink-800 rounded dark:bg-gray-700 dark:text-white",value:K.paid||((et=Pe.costume)==null?void 0:et.paid)||"",onChange:j=>ce({...K,paid:j.target.value}),placeholder:"0.00"})]})]}),c.jsx("button",{onClick:ps,className:"mt-4 w-full py-2 bg-pink-600 text-white font-bold rounded hover:bg-pink-700",children:"Save Details"})]})]}),h==="Schedule"&&c.jsxs("div",{className:"animate-fadeIn",children:[c.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-white mb-4",children:"Itinerary"}),ti.length>0&&c.jsxs("div",{className:"mb-6",children:[c.jsx("p",{className:"text-xs font-bold text-gray-400 uppercase mb-2",children:"Popular Events (Click to Add)"}),c.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:ti.map((j,Y)=>c.jsxs("button",{onClick:()=>ki(j),className:"min-w-[140px] p-3 text-left rounded-lg border transition bg-blue-50 dark:bg-blue-900/30 border-blue-100 dark:border-blue-800 hover:bg-blue-100 dark:hover:bg-blue-800",children:[c.jsx("div",{className:"font-bold text-blue-900 dark:text-blue-300 text-sm",children:j.title}),c.jsx("div",{className:"text-xs text-blue-700 dark:text-blue-400 opacity-75 truncate",children:j.note})]},Y))})]}),y?c.jsxs("div",{className:"mb-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsxs("p",{className:"text-xs font-bold text-emerald-600 dark:text-emerald-400 uppercase flex items-center gap-1",children:[c.jsx("span",{className:"inline-block w-2 h-2 bg-emerald-500 rounded-full animate-pulse"}),"Live Events from Fete Sites"]}),Yr&&c.jsxs("span",{className:"text-xs text-gray-400",children:["Updated: ",new Date(Yr).toLocaleDateString()]})]}),cs?c.jsxs("div",{className:"text-center py-4 text-gray-500 dark:text-gray-400",children:[c.jsx("div",{className:"animate-spin inline-block w-5 h-5 border-2 border-emerald-500 border-t-transparent rounded-full mb-2"}),c.jsx("p",{className:"text-sm",children:"Loading live events..."})]}):Ar.length>0?c.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:Ar.slice(0,10).map((j,Y)=>c.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gradient-to-r from-emerald-50 to-teal-50 dark:from-emerald-900/20 dark:to-teal-900/20 border border-emerald-200 dark:border-emerald-800 rounded-lg hover:shadow-md transition",children:[j.image&&c.jsx("img",{src:j.image,alt:"",className:"w-12 h-12 rounded object-cover flex-shrink-0"}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("h5",{className:"font-bold text-emerald-900 dark:text-emerald-300 text-sm truncate",children:j.title}),j.date&&c.jsxs("p",{className:"text-xs text-emerald-700 dark:text-emerald-400",children:[new Date(j.date+"T00:00:00").toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"}),j.time&&` at ${j.time}`]}),j.venue&&c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:j.venue}),c.jsxs("p",{className:"text-xs text-gray-400",children:["via ",j.source]})]}),c.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[j.url&&c.jsx("a",{href:j.url,target:"_blank",rel:"noopener noreferrer",className:"px-2 py-1 text-xs bg-emerald-600 text-white rounded hover:bg-emerald-700",children:"Tickets"}),c.jsx("button",{onClick:()=>ki({title:j.title,note:j.venue||`via ${j.source}`}),className:"px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700",children:"+ Add"})]})]},j.id||Y))}):c.jsxs("div",{className:"text-center py-4 bg-emerald-50 dark:bg-emerald-900/20 rounded-lg border border-emerald-200 dark:border-emerald-800",children:[c.jsx("p",{className:"text-sm text-emerald-700 dark:text-emerald-400",children:"No live events found for this carnival yet."}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Events are updated daily from fetelist.com & frontlineticketing.com"})]})]}):c.jsx("div",{className:"mb-6 p-4 bg-gradient-to-r from-amber-50 to-orange-50 dark:from-amber-900/20 dark:to-orange-900/20 border border-amber-200 dark:border-amber-800 rounded-xl",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("span",{className:"text-2xl",children:""}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"font-bold text-amber-900 dark:text-amber-300",children:"Unlock Live Event Listings"}),c.jsx("p",{className:"text-xs text-amber-700 dark:text-amber-400",children:"Premium members get daily-updated fete listings from fetelist.com & frontlineticketing.com"})]}),c.jsx("button",{onClick:()=>m("Info"),className:"px-3 py-2 bg-gradient-to-r from-amber-500 to-orange-500 text-white text-sm font-bold rounded-lg hover:opacity-90 flex-shrink-0",children:"Upgrade"})]})}),c.jsx("div",{className:"space-y-4 mb-6",children:(Pe.schedule||[]).map(j=>{var Y;return c.jsxs("div",{className:"flex gap-4 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg border-l-4 border-blue-400 relative group",children:[c.jsxs("div",{className:"text-center min-w-[60px]",children:[c.jsx("span",{className:"block text-xs font-bold text-gray-500 dark:text-gray-400 uppercase",children:new Date(j.datetime).toLocaleDateString(void 0,{month:"short"})}),c.jsx("span",{className:"block text-xl font-black text-gray-800 dark:text-white",children:new Date(j.datetime).getDate()}),c.jsx("span",{className:"block text-xs text-gray-500 dark:text-gray-400",children:new Date(j.datetime).toLocaleTimeString(void 0,{hour:"numeric",minute:"2-digit"})})]}),c.jsxs("div",{className:"flex-1",children:[c.jsx("h4",{className:"font-bold text-gray-800 dark:text-white",children:j.title}),j.note&&c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-1",children:j.note}),j.addedBy&&bt&&c.jsxs("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:["Added by ",((Y=j.addedBy.email)==null?void 0:Y.split("@")[0])||"squad member"]})]}),c.jsx("button",{onClick:()=>fs(j.id),className:"absolute top-2 right-2 text-gray-400 hover:text-red-500 opacity-0 group-hover:opacity-100",children:""})]},j.id)})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 bg-gray-50 dark:bg-gray-700 p-4 rounded-xl",children:[c.jsx("input",{type:"text",placeholder:"Event Name",value:b,onChange:j=>C(j.target.value),className:"p-2 border rounded dark:bg-gray-800 dark:border-gray-600 dark:text-white"}),c.jsx("input",{type:"datetime-local",value:D,onChange:j=>V(j.target.value),className:"p-2 border rounded dark:bg-gray-800 dark:border-gray-600 dark:text-white"}),c.jsx("input",{type:"text",placeholder:"Notes",value:U,onChange:j=>M(j.target.value),className:"p-2 border rounded md:col-span-2 dark:bg-gray-800 dark:border-gray-600 dark:text-white"}),c.jsx("button",{onClick:Ei,className:"md:col-span-2 py-2 bg-blue-600 text-white rounded font-medium hover:bg-blue-700",children:"Add Event"})]})]}),h==="Squad"&&c.jsxs("div",{className:"animate-fadeIn",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-white",children:"Your Squad"}),c.jsxs("span",{className:"text-sm bg-purple-100 text-purple-800 px-2 py-1 rounded-full",children:[((ri=Pe.squad)==null?void 0:ri.length)||0," members"]})]}),c.jsxs("div",{className:"bg-gradient-to-r from-gray-900 to-gray-800 text-white rounded-xl p-4 mb-6 shadow-lg border border-gray-700",children:[c.jsxs("div",{className:"flex justify-between items-start mb-4",children:[c.jsxs("div",{children:[c.jsxs("h4",{className:"font-bold text-lg flex items-center gap-2",children:[c.jsx("span",{children:""})," Road Mode: Offline Chat"]}),c.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Secure, offline mesh chat for when cell service dies."})]}),c.jsx("span",{className:"bg-blue-600 text-[10px] font-bold px-2 py-1 rounded uppercase tracking-wider",children:"No Data Needed"})]}),!a||!de?c.jsx("div",{className:"text-center py-4 bg-white/5 rounded-lg border border-white/10",children:c.jsx("p",{className:"text-sm text-gray-300",children:"Create or join a squad to enable offline comms."})}):c.jsx("div",{children:(()=>{const Y=`#CP-${de.id.slice(0,8).toUpperCase()}`,ne=`bitchat://join?channel=${Y}`,re=encodeURIComponent(ne);return c.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 items-center",children:[c.jsxs("div",{className:"flex-1 w-full space-y-3",children:[c.jsxs("div",{className:"bg-black/30 p-3 rounded-lg border border-white/10",children:[c.jsx("p",{className:"text-[10px] uppercase text-gray-400 font-bold mb-1",children:"Squad Channel"}),c.jsx("p",{className:"font-mono text-xl font-bold text-blue-400 tracking-wider select-all",children:Y})]}),c.jsx("a",{href:ne,className:"block w-full text-center py-3 bg-blue-600 hover:bg-blue-500 text-white font-bold rounded-lg transition-colors shadow-lg shadow-blue-900/50",children:"Launch Offline Chat"}),c.jsxs("p",{className:"text-[10px] text-center text-gray-500",children:["Requires ",c.jsx("a",{href:"#",className:"underline text-gray-400 hover:text-white",children:"Bitchat App"})," installed."]})]}),c.jsx("div",{className:"bg-white p-2 rounded-lg shrink-0",children:c.jsx("img",{src:`https://api.qrserver.com/v1/create-qr-code/?size=120x120&data=${re}&bgcolor=ffffff&color=000000&margin=0`,alt:"Join Channel QR",className:"w-24 h-24"})})]})})()})]}),c.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 border border-purple-200 dark:border-purple-800 rounded-xl p-4 mb-4",children:[c.jsxs("h4",{className:"font-bold text-purple-800 dark:text-purple-300 mb-3 flex items-center gap-2",children:[c.jsx("span",{children:""})," Squad Sharing"]}),an&&c.jsx("div",{className:"mb-3 p-2 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 rounded text-sm",children:an}),ft&&c.jsx("div",{className:"mb-3 p-2 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 rounded text-sm",children:ft}),c.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-3",children:[c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Share your carnival plan with friends:"}),X?c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-2xl font-mono font-bold text-purple-600 dark:text-purple-400 tracking-wider",children:X}),c.jsx("button",{onClick:Ta,className:"text-sm bg-purple-100 dark:bg-purple-900/50 text-purple-700 dark:text-purple-300 px-3 py-1 rounded hover:bg-purple-200",children:"Copy"})]}):c.jsx("button",{onClick:_n,disabled:lt,className:"w-full py-2 bg-purple-600 text-white rounded font-medium hover:bg-purple-700 disabled:opacity-50",children:lt?"Creating...":"Start a Squad"})]}),c.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-3",children:[c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Join a friend's squad:"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("input",{type:"text",placeholder:"Enter 6-digit code",value:ue,onChange:j=>me(j.target.value.toUpperCase().slice(0,6)),className:"flex-1 p-2 border rounded font-mono text-center tracking-wider uppercase dark:bg-gray-700 dark:border-gray-600 dark:text-white",maxLength:6}),c.jsx("button",{onClick:ma,disabled:Pt||ue.length!==6,className:"bg-pink-600 text-white px-4 rounded hover:bg-pink-700 disabled:opacity-50",children:Pt?"...":"Join"})]})]})]}),de&&c.jsx("div",{className:"mt-4 text-center",children:c.jsx("button",{onClick:ls,className:"text-sm text-red-500 hover:text-red-700 underline",children:"Leave Squad"})})]}),y&&c.jsx("div",{className:"mt-4 pt-4 border-t border-purple-200 dark:border-purple-700",children:c.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[c.jsx("input",{type:"checkbox",checked:Ii,onChange:j=>mo(j.target.checked),className:"w-5 h-5 text-purple-600 rounded"}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium text-purple-800 dark:text-purple-300",children:"Notify squad when I go Road Ready"}),c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Send push notification to squad members"})]}),c.jsx("span",{className:"ml-auto text-xs bg-yellow-100 text-yellow-800 px-2 py-0.5 rounded-full",children:"Premium"})]})}),_e.length>0&&c.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-green-200 dark:border-green-800 rounded-xl p-4 mb-4",children:[c.jsx("div",{className:"flex items-center justify-between mb-3",children:c.jsxs("h4",{className:"font-medium text-green-700 dark:text-green-400 flex items-center gap-2",children:[c.jsx("span",{children:""})," Connected Squad Members"]})}),c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-3",children:'These users joined using your share code and can see this carnival plan. Click "Refresh" to check for new members.'}),c.jsx("div",{className:"flex flex-wrap gap-2",children:_e.map((j,Y)=>{var ne;return c.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 rounded-full border ${j.role==="owner"?"bg-yellow-50 dark:bg-yellow-900/30 border-yellow-200 dark:border-yellow-800":"bg-green-50 dark:bg-green-900/30 border-green-200 dark:border-green-800"}`,children:[c.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-white text-sm font-bold",children:(j.email||j.uid||"?").charAt(0).toUpperCase()}),c.jsxs("div",{className:"flex flex-col",children:[c.jsx("span",{className:`font-medium text-sm ${j.role==="owner"?"text-yellow-800 dark:text-yellow-300":"text-green-800 dark:text-green-300"}`,children:j.email||`User ${(ne=j.uid)==null?void 0:ne.slice(0,6)}...`}),c.jsx("span",{className:`text-xs ${j.role==="owner"?"text-yellow-600 dark:text-yellow-400":"text-green-600 dark:text-green-400"}`,children:j.role==="owner"?" Owner":" Member"})]})]},j.uid||Y)})})]}),c.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl p-4 mb-4",children:[c.jsx("h4",{className:"font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Quick Add (Offline List)"}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-4",children:[c.jsx("input",{type:"text",placeholder:"Add friend's name",value:Ce,onChange:j=>Re(j.target.value),className:"flex-1 p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm"}),c.jsx("button",{onClick:Ia,className:"w-full sm:w-auto bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700 font-medium",children:"Add"})]}),c.jsxs("div",{className:"flex flex-wrap gap-2",children:[(Pe.squad||[]).map(j=>c.jsxs("div",{className:"flex items-center gap-2 bg-purple-50 dark:bg-purple-900/30 px-3 py-1 rounded-full border border-purple-100 dark:border-purple-800",children:[c.jsx("span",{className:"text-purple-900 dark:text-purple-200 font-medium",children:j.name}),c.jsx("button",{onClick:()=>_o(j.id),className:"text-purple-400 hover:text-red-500 text-xs font-bold",children:""})]},j.id)),(Pe.squad||[]).length===0&&c.jsx("p",{className:"text-gray-400 italic text-sm",children:"No squad members added yet. Riding solo?"})]})]}),c.jsx("div",{className:"mt-8 mb-8",children:c.jsx(h3,{squadId:de==null?void 0:de.id,user:t,isDemoMode:n})}),!y&&c.jsx("div",{className:"mt-4",children:c.jsx(ah,{placement:"inline",onUpgradeClick:()=>m("Info")})})]}),h==="Packing"&&c.jsxs("div",{className:"animate-fadeIn",children:[c.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-white mb-4",children:"Packing List"}),c.jsx("div",{className:"space-y-2 mb-6",children:(Pe.packing||[]).map(j=>c.jsxs("div",{className:"flex items-center justify-between p-3 bg-white dark:bg-gray-700 border border-gray-100 dark:border-gray-600 shadow-sm rounded-lg",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("input",{type:"checkbox",checked:j.checked,onChange:()=>Zn(j.id),className:"w-5 h-5 text-blue-600 rounded"}),c.jsx("span",{className:`text-gray-700 dark:text-gray-200 ${j.checked?"line-through opacity-50":""}`,children:j.item})]}),c.jsx("button",{onClick:()=>ba(j.id),className:"text-gray-400 hover:text-red-500",children:""})]},j.id))}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[c.jsx("input",{type:"text",placeholder:"Item",value:le,onChange:j=>Ee(j.target.value),className:"flex-1 p-3 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm"}),c.jsx("button",{onClick:Kn,className:"w-full sm:w-auto px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium",children:"Add"})]}),!y&&c.jsx("div",{className:"mt-6 pt-4 border-t border-gray-100 dark:border-gray-700",children:c.jsx(ah,{placement:"inline",onUpgradeClick:()=>m("Info")})})]}),h==="Map"&&y&&c.jsx("div",{className:"animate-fadeIn",children:c.jsx(l3,{locations:Pe.mapLocations||[],scrapedEvents:Ar,onLocationsChange:j=>se("mapLocations",j),carnivalName:Pe.name,carnivalId:a})}),h==="Passport"&&y&&c.jsx("div",{className:"animate-fadeIn",children:c.jsx(j3,{user:t,activeCarnivalId:a})}),h==="Media"&&y&&c.jsx("div",{className:"animate-fadeIn",children:c.jsx(f3,{files:Pe.mediaFiles||[],onFilesChange:j=>se("mediaFiles",j),carnivalName:Pe.name,carnivalId:a,userId:t.uid})}),h==="Info"&&c.jsxs("div",{className:"animate-fadeIn text-center",children:[c.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-gray-800 text-white rounded-2xl p-8 mb-6 shadow-xl",children:[c.jsx("img",{src:sh,alt:"Logo",className:"w-20 h-20 mx-auto mb-4"}),c.jsx("h2",{className:"text-2xl font-bold mb-2",children:y?"Premium Supporter":"Support the App"}),c.jsx("p",{className:"text-gray-400 mb-6",children:y?"Thank you for supporting Carnival Planner!":"All features are free! Premium removes ads and shows your support."}),c.jsxs("button",{onClick:gs,className:"flex items-center justify-center gap-2 mx-auto px-6 py-3 rounded-full font-bold transition-colors bg-white text-gray-900 hover:bg-gray-100",children:[c.jsx("span",{children:""})," Export Itinerary"]})]}),!y&&c.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/10 border border-yellow-200 dark:border-yellow-800 rounded-xl p-6",children:[c.jsx("h3",{className:"font-bold text-yellow-800 dark:text-yellow-400 mb-2",children:"Become a Premium Supporter"}),c.jsx("p",{className:"text-yellow-700 dark:text-yellow-500 text-sm mb-4",children:"Get an ad-free experience and a Premium badge to show your support!"}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[c.jsx("button",{onClick:()=>Ti("monthly"),disabled:k,className:"px-4 py-2 bg-blue-600 text-white font-bold rounded shadow hover:bg-blue-700 disabled:opacity-50",children:k?"Loading...":"Monthly - $4.99"}),c.jsx("button",{onClick:()=>Ti("yearly"),disabled:k,className:"px-4 py-2 bg-yellow-400 text-yellow-900 font-bold rounded shadow hover:bg-yellow-500 disabled:opacity-50",children:k?"Loading...":"Yearly - $39.99"})]})]}),c.jsx("div",{className:"mt-6",children:c.jsx(R3,{user:t})}),(t==null?void 0:t.email)==="djkrss1@gmail.com"&&c.jsxs("div",{className:"mt-6 text-left space-y-8",children:[c.jsx(y3,{}),c.jsx(C3,{}),c.jsx(w3,{})]})]})]})]})]}):c.jsx(Db,{user:t,activeCarnivalId:null,carnivalData:Op,scrapedEvents:Ar,squadMembers:[],budgetTotal:0,budgetSpent:0,isPremium:y,onAction:m})]}):c.jsx("div",{className:"flex flex-col items-center justify-center min-h-[60vh] text-center px-4",children:pa?c.jsx(L3,{onBack:()=>Nr(!1),onSuccess:()=>Nr(!1)}):c.jsxs(c.Fragment,{children:[c.jsx("h2",{className:"text-3xl font-bold mb-6 text-gray-800 dark:text-white",children:"Welcome Back"}),c.jsxs("div",{className:"space-y-3 w-full max-w-sm",children:[c.jsxs("button",{onClick:jr,className:"w-full flex items-center justify-center px-6 py-3 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-lg shadow-sm hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-800 dark:text-white transition-colors",children:[c.jsx("img",{src:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg",className:"w-5 h-5 mr-3",alt:"G"}),"Continue with Google"]}),c.jsxs("div",{className:"flex items-center gap-3 text-gray-400 dark:text-gray-500",children:[c.jsx("div",{className:"flex-1 h-px bg-gray-300 dark:bg-gray-600"}),c.jsx("span",{className:"text-sm",children:"or"}),c.jsx("div",{className:"flex-1 h-px bg-gray-300 dark:bg-gray-600"})]}),c.jsx("button",{onClick:()=>Nr(!0),className:"w-full flex items-center justify-center px-6 py-3 bg-gradient-to-r from-pink-500 to-orange-500 rounded-lg shadow-sm hover:opacity-90 text-white font-semibold transition-opacity",children:"Continue with Email"})]}),c.jsx("button",{onClick:()=>S(!0),className:"mt-6 text-sm text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300",children:"Back to home"})]})})}),c.jsx("footer",{className:"bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 py-6 px-4 mt-auto",children:c.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[c.jsxs("div",{className:"flex flex-wrap justify-center gap-3 text-sm text-gray-500 dark:text-gray-400",children:[c.jsx("button",{onClick:()=>Cn("privacy"),className:"hover:text-gray-900 dark:hover:text-white transition-colors",children:"Privacy"}),c.jsx("span",{children:"|"}),c.jsx("button",{onClick:()=>Cn("terms"),className:"hover:text-gray-900 dark:hover:text-white transition-colors",children:"Terms"}),c.jsx("span",{children:"|"}),c.jsx("button",{onClick:()=>Cn("cookies"),className:"hover:text-gray-900 dark:hover:text-white transition-colors",children:"Cookies"}),c.jsx("span",{children:"|"}),c.jsx("button",{onClick:()=>Cn("refund"),className:"hover:text-gray-900 dark:hover:text-white transition-colors",children:"Refunds"}),c.jsx("span",{children:"|"}),c.jsx("button",{onClick:()=>Cn("contact"),className:"hover:text-gray-900 dark:hover:text-white transition-colors",children:"Contact"})]}),c.jsxs("p",{className:"text-gray-400 dark:text-gray-500 text-xs mt-3",children:[" ",new Date().getFullYear()," Carnival Planner"]})]})}),t&&c.jsx(g3,{activeCarnivalId:a,isPremium:y})]})}Vp.createRoot(document.getElementById("root")).render(c.jsx(Mh.StrictMode,{children:c.jsx(B3,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(t=>{console.log("SW registered:",t.scope)}).catch(t=>{console.log("SW registration failed:",t)})});
